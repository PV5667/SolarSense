{"version":3,"file":"flat-geojson-to-binary.js","names":["_polygon","require","_createForOfIteratorHelper","o","allowArrayLike","it","Symbol","iterator","Array","isArray","_unsupportedIterableToArray","length","i","F","s","n","done","value","e","_e","f","TypeError","normalCompletion","didErr","err","call","step","next","_e2","return","minLen","_arrayLikeToArray","Object","prototype","toString","slice","constructor","name","from","test","arr","len","arr2","ownKeys","object","enumerableOnly","keys","getOwnPropertySymbols","symbols","filter","sym","getOwnPropertyDescriptor","enumerable","push","apply","_objectSpread","target","arguments","source","forEach","key","_defineProperty2","default","getOwnPropertyDescriptors","defineProperties","defineProperty","flatGeojsonToBinary","features","geometryInfo","options","propArrayTypes","extractNumericPropTypes","numericPropKeys","k","fillArrays","PositionDataType","Float32Array","triangulate","TEST_EXPORTS","exports","_iterator","_step","feature","properties","val","deduceArrayType","pointPositionsCount","pointFeaturesCount","linePositionsCount","linePathsCount","lineFeaturesCount","polygonPositionsCount","polygonObjectsCount","polygonRingsCount","polygonFeaturesCount","coordLength","_options$numericPropK","_options$PositionData","_options$triangulate","hasGlobalId","GlobalFeatureIdsDataType","Uint32Array","Uint16Array","points","type","positions","globalFeatureIds","featureIds","numericProps","fields","lines","pathIndices","polygons","polygonIndices","primitivePolygonIndices","triangles","_i","_arr","_iterator2","_step2","propName","T","indexMap","pointPosition","pointFeature","linePosition","linePath","lineFeature","polygonPosition","polygonObject","polygonRing","polygonFeature","_iterator3","_step3","geometry","handlePoint","keepStringProperties","id","handleLineString","handlePolygon","Error","makeAccessorObjects","set","data","nPositions","fillNumericProperties","fill","il","indices","start","end","l","ll","startPosition","areas","nextIndices","undefined","endPosition","triangulatePolygon","_ref","polygonPositions","subarray","offset","holes","map","earcut","t","tl","wrapProps","obj","size","returnObj","binaryFeatures","index","numericPropName","numericKeys","props","includes","x","Number","isFinite","Float64Array","Math","fround"],"sources":["../../../src/lib/flat-geojson-to-binary.ts"],"sourcesContent":["/* eslint-disable indent */\nimport {earcut} from '@math.gl/polygon';\nimport type {\n  BinaryAttribute,\n  BinaryFeatures,\n  BinaryPolygonFeatures,\n  FlatFeature,\n  FlatPoint,\n  FlatLineString,\n  FlatPolygon,\n  GeojsonGeometryInfo,\n  TypedArray\n} from '@loaders.gl/schema';\nimport {PropArrayConstructor, Lines, Points, Polygons} from './flat-geojson-to-binary-types';\n\n/**\n * Convert binary features to flat binary arrays. Similar to\n * `geojsonToBinary` helper function, except that it expects\n * a binary representation of the feature data, which enables\n * 2X-3X speed increase in parse speed, compared to using\n * geoJSON. See `binary-vector-tile/VectorTileFeature` for\n * data format detais\n *\n * @param features\n * @param geometryInfo\n * @param options\n * @returns filled arrays\n */\nexport function flatGeojsonToBinary(\n  features: FlatFeature[],\n  geometryInfo: GeojsonGeometryInfo,\n  options?: FlatGeojsonToBinaryOptions\n) {\n  const propArrayTypes = extractNumericPropTypes(features);\n  const numericPropKeys = Object.keys(propArrayTypes).filter((k) => propArrayTypes[k] !== Array);\n  return fillArrays(\n    features,\n    {\n      propArrayTypes,\n      ...geometryInfo\n    },\n    {\n      numericPropKeys: (options && options.numericPropKeys) || numericPropKeys,\n      PositionDataType: options ? options.PositionDataType : Float32Array,\n      triangulate: options ? options.triangulate : true\n    }\n  );\n}\n\n/**\n * Options for `flatGeojsonToBinary`\n */\nexport type FlatGeojsonToBinaryOptions = {\n  numericPropKeys?: string[];\n  PositionDataType?: Float32ArrayConstructor | Float64ArrayConstructor;\n  triangulate?: boolean;\n};\n\nexport const TEST_EXPORTS = {\n  extractNumericPropTypes\n};\n\n/**\n * Extracts properties that are always numeric\n *\n * @param features\n * @returns object with numeric types\n */\nfunction extractNumericPropTypes(features: FlatFeature[]): {\n  [key: string]: PropArrayConstructor;\n} {\n  const propArrayTypes = {};\n  for (const feature of features) {\n    if (feature.properties) {\n      for (const key in feature.properties) {\n        // If property has not been seen before, or if property has been numeric\n        // in all previous features, check if numeric in this feature\n        // If not numeric, Array is stored to prevent rechecking in the future\n        // Additionally, detects if 64 bit precision is required\n        const val = feature.properties[key];\n        propArrayTypes[key] = deduceArrayType(val, propArrayTypes[key]);\n      }\n    }\n  }\n\n  return propArrayTypes;\n}\n\n/**\n * Fills coordinates into pre-allocated typed arrays\n *\n * @param features\n * @param geometryInfo\n * @param options\n * @returns an accessor object with value and size keys\n */\n// eslint-disable-next-line complexity\nfunction fillArrays(\n  features: FlatFeature[],\n  geometryInfo: GeojsonGeometryInfo & {\n    propArrayTypes: {[key: string]: PropArrayConstructor};\n  },\n  options: FlatGeojsonToBinaryOptions\n) {\n  const {\n    pointPositionsCount,\n    pointFeaturesCount,\n    linePositionsCount,\n    linePathsCount,\n    lineFeaturesCount,\n    polygonPositionsCount,\n    polygonObjectsCount,\n    polygonRingsCount,\n    polygonFeaturesCount,\n    propArrayTypes,\n    coordLength\n  } = geometryInfo;\n  const {numericPropKeys = [], PositionDataType = Float32Array, triangulate = true} = options;\n  const hasGlobalId = features[0] && 'id' in features[0];\n  const GlobalFeatureIdsDataType = features.length > 65535 ? Uint32Array : Uint16Array;\n  const points: Points = {\n    type: 'Point',\n    positions: new PositionDataType(pointPositionsCount * coordLength),\n    globalFeatureIds: new GlobalFeatureIdsDataType(pointPositionsCount),\n    featureIds:\n      pointFeaturesCount > 65535\n        ? new Uint32Array(pointPositionsCount)\n        : new Uint16Array(pointPositionsCount),\n    numericProps: {},\n    properties: [],\n    fields: []\n  };\n  const lines: Lines = {\n    type: 'LineString',\n    pathIndices:\n      linePositionsCount > 65535\n        ? new Uint32Array(linePathsCount + 1)\n        : new Uint16Array(linePathsCount + 1),\n    positions: new PositionDataType(linePositionsCount * coordLength),\n    globalFeatureIds: new GlobalFeatureIdsDataType(linePositionsCount),\n    featureIds:\n      lineFeaturesCount > 65535\n        ? new Uint32Array(linePositionsCount)\n        : new Uint16Array(linePositionsCount),\n    numericProps: {},\n    properties: [],\n    fields: []\n  };\n  const polygons: Polygons = {\n    type: 'Polygon',\n    polygonIndices:\n      polygonPositionsCount > 65535\n        ? new Uint32Array(polygonObjectsCount + 1)\n        : new Uint16Array(polygonObjectsCount + 1),\n    primitivePolygonIndices:\n      polygonPositionsCount > 65535\n        ? new Uint32Array(polygonRingsCount + 1)\n        : new Uint16Array(polygonRingsCount + 1),\n    positions: new PositionDataType(polygonPositionsCount * coordLength),\n    globalFeatureIds: new GlobalFeatureIdsDataType(polygonPositionsCount),\n    featureIds:\n      polygonFeaturesCount > 65535\n        ? new Uint32Array(polygonPositionsCount)\n        : new Uint16Array(polygonPositionsCount),\n    numericProps: {},\n    properties: [],\n    fields: []\n  };\n\n  if (triangulate) {\n    polygons.triangles = [];\n  }\n\n  // Instantiate numeric properties arrays; one value per vertex\n  for (const object of [points, lines, polygons]) {\n    for (const propName of numericPropKeys) {\n      // If property has been numeric in all previous features in which the property existed, check\n      // if numeric in this feature\n      const T = propArrayTypes[propName];\n      object.numericProps[propName] = new T(object.positions.length / coordLength) as TypedArray;\n    }\n  }\n\n  // Set last element of path/polygon indices as positions length\n  lines.pathIndices[linePathsCount] = linePositionsCount;\n  polygons.polygonIndices[polygonObjectsCount] = polygonPositionsCount;\n  polygons.primitivePolygonIndices[polygonRingsCount] = polygonPositionsCount;\n\n  const indexMap = {\n    pointPosition: 0,\n    pointFeature: 0,\n    linePosition: 0,\n    linePath: 0,\n    lineFeature: 0,\n    polygonPosition: 0,\n    polygonObject: 0,\n    polygonRing: 0,\n    polygonFeature: 0,\n    feature: 0\n  };\n\n  for (const feature of features) {\n    const geometry = feature.geometry;\n    const properties = feature.properties || {};\n\n    switch (geometry.type) {\n      case 'Point':\n        handlePoint(geometry, points, indexMap, coordLength, properties);\n        points.properties.push(keepStringProperties(properties, numericPropKeys));\n        if (hasGlobalId) {\n          points.fields.push({id: feature.id});\n        }\n        indexMap.pointFeature++;\n        break;\n      case 'LineString':\n        handleLineString(geometry, lines, indexMap, coordLength, properties);\n        lines.properties.push(keepStringProperties(properties, numericPropKeys));\n        if (hasGlobalId) {\n          lines.fields.push({id: feature.id});\n        }\n        indexMap.lineFeature++;\n        break;\n      case 'Polygon':\n        handlePolygon(geometry, polygons, indexMap, coordLength, properties);\n        polygons.properties.push(keepStringProperties(properties, numericPropKeys));\n        if (hasGlobalId) {\n          polygons.fields.push({id: feature.id});\n        }\n        indexMap.polygonFeature++;\n        break;\n      default:\n        throw new Error('Invalid geometry type');\n    }\n\n    indexMap.feature++;\n  }\n\n  // Wrap each array in an accessor object with value and size keys\n  return makeAccessorObjects(points, lines, polygons, coordLength);\n}\n\n/**\n * Fills (Multi)Point coordinates into points object of arrays\n *\n * @param geometry\n * @param points\n * @param indexMap\n * @param coordLength\n * @param properties\n */\nfunction handlePoint(\n  geometry: FlatPoint,\n  points: Points,\n  indexMap: {\n    pointPosition: number;\n    pointFeature: number;\n    linePosition?: number;\n    linePath?: number;\n    lineFeature?: number;\n    polygonPosition?: number;\n    polygonObject?: number;\n    polygonRing?: number;\n    polygonFeature?: number;\n    feature: number;\n  },\n  coordLength: number,\n  properties: {[x: string]: string | number | boolean | null}\n): void {\n  points.positions.set(geometry.data, indexMap.pointPosition * coordLength);\n\n  const nPositions = geometry.data.length / coordLength;\n  fillNumericProperties(points, properties, indexMap.pointPosition, nPositions);\n  points.globalFeatureIds.fill(\n    indexMap.feature,\n    indexMap.pointPosition,\n    indexMap.pointPosition + nPositions\n  );\n  points.featureIds.fill(\n    indexMap.pointFeature,\n    indexMap.pointPosition,\n    indexMap.pointPosition + nPositions\n  );\n\n  indexMap.pointPosition += nPositions;\n}\n\n/**\n * Fills (Multi)LineString coordinates into lines object of arrays\n *\n * @param geometry\n * @param lines\n * @param indexMap\n * @param coordLength\n * @param properties\n */\nfunction handleLineString(\n  geometry: FlatLineString,\n  lines: Lines,\n  indexMap: {\n    pointPosition?: number;\n    pointFeature?: number;\n    linePosition: number;\n    linePath: number;\n    lineFeature: number;\n    polygonPosition?: number;\n    polygonObject?: number;\n    polygonRing?: number;\n    polygonFeature?: number;\n    feature: number;\n  },\n  coordLength: number,\n  properties: {[x: string]: string | number | boolean | null}\n): void {\n  lines.positions.set(geometry.data, indexMap.linePosition * coordLength);\n\n  const nPositions = geometry.data.length / coordLength;\n  fillNumericProperties(lines, properties, indexMap.linePosition, nPositions);\n\n  lines.globalFeatureIds.fill(\n    indexMap.feature,\n    indexMap.linePosition,\n    indexMap.linePosition + nPositions\n  );\n  lines.featureIds.fill(\n    indexMap.lineFeature,\n    indexMap.linePosition,\n    indexMap.linePosition + nPositions\n  );\n\n  for (let i = 0, il = geometry.indices.length; i < il; ++i) {\n    // Extract range of data we are working with, defined by start\n    // and end indices (these index into the geometry.data array)\n    const start = geometry.indices[i];\n    const end =\n      i === il - 1\n        ? geometry.data.length // last line, so read to end of data\n        : geometry.indices[i + 1]; // start index for next line\n\n    lines.pathIndices[indexMap.linePath++] = indexMap.linePosition;\n    indexMap.linePosition += (end - start) / coordLength;\n  }\n}\n\n/**\n * Fills (Multi)Polygon coordinates into polygons object of arrays\n *\n * @param geometry\n * @param polygons\n * @param indexMap\n * @param coordLength\n * @param properties\n */\nfunction handlePolygon(\n  geometry: FlatPolygon,\n  polygons: Polygons,\n  indexMap: {\n    pointPosition?: number;\n    pointFeature?: number;\n    linePosition?: number;\n    linePath?: number;\n    lineFeature?: number;\n    polygonPosition: number;\n    polygonObject: number;\n    polygonRing: number;\n    polygonFeature: number;\n    feature: number;\n  },\n  coordLength: number,\n  properties: {[x: string]: string | number | boolean | null}\n): void {\n  polygons.positions.set(geometry.data, indexMap.polygonPosition * coordLength);\n\n  const nPositions = geometry.data.length / coordLength;\n  fillNumericProperties(polygons, properties, indexMap.polygonPosition, nPositions);\n  polygons.globalFeatureIds.fill(\n    indexMap.feature,\n    indexMap.polygonPosition,\n    indexMap.polygonPosition + nPositions\n  );\n  polygons.featureIds.fill(\n    indexMap.polygonFeature,\n    indexMap.polygonPosition,\n    indexMap.polygonPosition + nPositions\n  );\n\n  // Unlike Point & LineString geometry.indices is a 2D array\n  for (let l = 0, ll = geometry.indices.length; l < ll; ++l) {\n    const startPosition = indexMap.polygonPosition;\n    polygons.polygonIndices[indexMap.polygonObject++] = startPosition;\n\n    const areas = geometry.areas[l];\n    const indices = geometry.indices[l];\n    const nextIndices = geometry.indices[l + 1];\n\n    for (let i = 0, il = indices.length; i < il; ++i) {\n      const start = indices[i];\n      const end =\n        i === il - 1\n          ? // last line, so either read to:\n            nextIndices === undefined\n            ? geometry.data.length // end of data (no next indices)\n            : nextIndices[0] // start of first line in nextIndices\n          : indices[i + 1]; // start index for next line\n\n      polygons.primitivePolygonIndices[indexMap.polygonRing++] = indexMap.polygonPosition;\n      indexMap.polygonPosition += (end - start) / coordLength;\n    }\n\n    const endPosition = indexMap.polygonPosition;\n    triangulatePolygon(polygons, areas, indices, {startPosition, endPosition, coordLength});\n  }\n}\n\n/**\n * Triangulate polygon using earcut\n *\n * @param polygons\n * @param areas\n * @param indices\n * @param param3\n */\nfunction triangulatePolygon(\n  polygons: Polygons,\n  areas: number[],\n  indices: number[],\n  {\n    startPosition,\n    endPosition,\n    coordLength\n  }: {startPosition: number; endPosition: number; coordLength: number}\n): void {\n  if (!polygons.triangles) {\n    return;\n  }\n\n  const start = startPosition * coordLength;\n  const end = endPosition * coordLength;\n\n  // Extract positions and holes for just this polygon\n  const polygonPositions = polygons.positions.subarray(start, end);\n\n  // Holes are referenced relative to outer polygon\n  const offset = indices[0];\n  const holes = indices.slice(1).map((n: number) => (n - offset) / coordLength);\n\n  // Compute triangulation\n  // @ts-expect-error TODO can earcut handle binary arrays? Add tests?\n  const triangles = earcut(polygonPositions, holes, coordLength, areas);\n\n  // Indices returned by triangulation are relative to start\n  // of polygon, so we need to offset\n  for (let t = 0, tl = triangles.length; t < tl; ++t) {\n    polygons.triangles.push(startPosition + triangles[t]);\n  }\n}\n\n/**\n * Wraps an object containing array into accessors\n *\n * @param obj\n * @param size\n */\nfunction wrapProps(\n  obj: {[key: string]: TypedArray},\n  size: number\n): {[key: string]: BinaryAttribute} {\n  const returnObj = {};\n  for (const key in obj) {\n    returnObj[key] = {value: obj[key], size};\n  }\n  return returnObj;\n}\n\n/**\n * Wrap each array in an accessor object with value and size keys\n *\n * @param points\n * @param lines\n * @param polygons\n * @param coordLength\n * @returns object\n */\nfunction makeAccessorObjects(\n  points: Points,\n  lines: Lines,\n  polygons: Polygons,\n  coordLength: number\n): BinaryFeatures {\n  const binaryFeatures = {\n    points: {\n      ...points,\n      positions: {value: points.positions, size: coordLength},\n      globalFeatureIds: {value: points.globalFeatureIds, size: 1},\n      featureIds: {value: points.featureIds, size: 1},\n      numericProps: wrapProps(points.numericProps, 1)\n    },\n    lines: {\n      ...lines,\n      positions: {value: lines.positions, size: coordLength},\n      pathIndices: {value: lines.pathIndices, size: 1},\n      globalFeatureIds: {value: lines.globalFeatureIds, size: 1},\n      featureIds: {value: lines.featureIds, size: 1},\n      numericProps: wrapProps(lines.numericProps, 1)\n    },\n    polygons: {\n      ...polygons,\n      positions: {value: polygons.positions, size: coordLength},\n      polygonIndices: {value: polygons.polygonIndices, size: 1},\n      primitivePolygonIndices: {value: polygons.primitivePolygonIndices, size: 1},\n      globalFeatureIds: {value: polygons.globalFeatureIds, size: 1},\n      featureIds: {value: polygons.featureIds, size: 1},\n      numericProps: wrapProps(polygons.numericProps, 1)\n    } as BinaryPolygonFeatures\n  };\n\n  if (polygons.triangles) {\n    binaryFeatures.polygons.triangles = {value: new Uint32Array(polygons.triangles), size: 1};\n  }\n\n  return binaryFeatures;\n}\n\n/**\n * Add numeric properties to object\n *\n * @param object\n * @param properties\n * @param index\n * @param length\n */\nfunction fillNumericProperties(\n  object: Points | Lines | Polygons,\n  properties: {[x: string]: string | number | boolean | null},\n  index: number,\n  length: number\n): void {\n  for (const numericPropName in object.numericProps) {\n    if (numericPropName in properties) {\n      const value = properties[numericPropName] as number;\n      object.numericProps[numericPropName].fill(value, index, index + length);\n    }\n  }\n}\n\n/**\n * Keep string properties in object\n *\n * @param properties\n * @param numericKeys\n * @returns object\n */\nfunction keepStringProperties(\n  properties: {[x: string]: string | number | boolean | null},\n  numericKeys: string[]\n) {\n  const props = {};\n  for (const key in properties) {\n    if (!numericKeys.includes(key)) {\n      props[key] = properties[key];\n    }\n  }\n  return props;\n}\n\n/**\n *\n * Deduce correct array constructor to use for a given value\n *\n * @param x value to test\n * @param constructor previous constructor deduced\n * @returns PropArrayConstructor\n */\nfunction deduceArrayType(x: any, constructor: PropArrayConstructor): PropArrayConstructor {\n  if (constructor === Array || !Number.isFinite(x)) {\n    return Array;\n  }\n\n  // If this or previous value required 64bits use Float64Array\n  return constructor === Float64Array || Math.fround(x) !== x ? Float64Array : Float32Array;\n}\n"],"mappings":"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"}
function lz(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const o=Object.getOwnPropertyDescriptor(r,i);o&&Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();var Ya=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _A(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function ti(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var mK={exports:{}},vO={},AK={exports:{}},ci={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wE=Symbol.for("react.element"),Lpe=Symbol.for("react.portal"),Dpe=Symbol.for("react.fragment"),Bpe=Symbol.for("react.strict_mode"),Npe=Symbol.for("react.profiler"),Fpe=Symbol.for("react.provider"),kpe=Symbol.for("react.context"),zpe=Symbol.for("react.forward_ref"),Upe=Symbol.for("react.suspense"),Gpe=Symbol.for("react.memo"),jpe=Symbol.for("react.lazy"),sV=Symbol.iterator;function Vpe(t){return t===null||typeof t!="object"?null:(t=sV&&t[sV]||t["@@iterator"],typeof t=="function"?t:null)}var _K={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},yK=Object.assign,vK={};function O1(t,e,n){this.props=t,this.context=e,this.refs=vK,this.updater=n||_K}O1.prototype.isReactComponent={};O1.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};O1.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function xK(){}xK.prototype=O1.prototype;function uz(t,e,n){this.props=t,this.context=e,this.refs=vK,this.updater=n||_K}var cz=uz.prototype=new xK;cz.constructor=uz;yK(cz,O1.prototype);cz.isPureReactComponent=!0;var aV=Array.isArray,bK=Object.prototype.hasOwnProperty,fz={current:null},wK={key:!0,ref:!0,__self:!0,__source:!0};function EK(t,e,n){var r,i={},o=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(o=""+e.key),e)bK.call(e,r)&&!wK.hasOwnProperty(r)&&(i[r]=e[r]);var s=arguments.length-2;if(s===1)i.children=n;else if(1<s){for(var u=Array(s),d=0;d<s;d++)u[d]=arguments[d+2];i.children=u}if(t&&t.defaultProps)for(r in s=t.defaultProps,s)i[r]===void 0&&(i[r]=s[r]);return{$$typeof:wE,type:t,key:o,ref:a,props:i,_owner:fz.current}}function $pe(t,e){return{$$typeof:wE,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function hz(t){return typeof t=="object"&&t!==null&&t.$$typeof===wE}function Hpe(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var lV=/\/+/g;function aD(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Hpe(""+t.key):e.toString(36)}function WT(t,e,n,r,i){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case wE:case Lpe:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+aD(a,0):r,aV(i)?(n="",t!=null&&(n=t.replace(lV,"$&/")+"/"),WT(i,e,n,"",function(d){return d})):i!=null&&(hz(i)&&(i=$pe(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(lV,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",aV(t))for(var s=0;s<t.length;s++){o=t[s];var u=r+aD(o,s);a+=WT(o,e,n,u,i)}else if(u=Vpe(t),typeof u=="function")for(t=u.call(t),s=0;!(o=t.next()).done;)o=o.value,u=r+aD(o,s++),a+=WT(o,e,n,u,i);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function uS(t,e,n){if(t==null)return t;var r=[],i=0;return WT(t,r,"","",function(o){return e.call(n,o,i++)}),r}function Wpe(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var iu={current:null},qT={transition:null},qpe={ReactCurrentDispatcher:iu,ReactCurrentBatchConfig:qT,ReactCurrentOwner:fz};ci.Children={map:uS,forEach:function(t,e,n){uS(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return uS(t,function(){e++}),e},toArray:function(t){return uS(t,function(e){return e})||[]},only:function(t){if(!hz(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ci.Component=O1;ci.Fragment=Dpe;ci.Profiler=Npe;ci.PureComponent=uz;ci.StrictMode=Bpe;ci.Suspense=Upe;ci.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qpe;ci.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=yK({},t.props),i=t.key,o=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,a=fz.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(u in e)bK.call(e,u)&&!wK.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&s!==void 0?s[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){s=Array(u);for(var d=0;d<u;d++)s[d]=arguments[d+2];r.children=s}return{$$typeof:wE,type:t.type,key:i,ref:o,props:r,_owner:a}};ci.createContext=function(t){return t={$$typeof:kpe,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Fpe,_context:t},t.Consumer=t};ci.createElement=EK;ci.createFactory=function(t){var e=EK.bind(null,t);return e.type=t,e};ci.createRef=function(){return{current:null}};ci.forwardRef=function(t){return{$$typeof:zpe,render:t}};ci.isValidElement=hz;ci.lazy=function(t){return{$$typeof:jpe,_payload:{_status:-1,_result:t},_init:Wpe}};ci.memo=function(t,e){return{$$typeof:Gpe,type:t,compare:e===void 0?null:e}};ci.startTransition=function(t){var e=qT.transition;qT.transition={};try{t()}finally{qT.transition=e}};ci.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ci.useCallback=function(t,e){return iu.current.useCallback(t,e)};ci.useContext=function(t){return iu.current.useContext(t)};ci.useDebugValue=function(){};ci.useDeferredValue=function(t){return iu.current.useDeferredValue(t)};ci.useEffect=function(t,e){return iu.current.useEffect(t,e)};ci.useId=function(){return iu.current.useId()};ci.useImperativeHandle=function(t,e,n){return iu.current.useImperativeHandle(t,e,n)};ci.useInsertionEffect=function(t,e){return iu.current.useInsertionEffect(t,e)};ci.useLayoutEffect=function(t,e){return iu.current.useLayoutEffect(t,e)};ci.useMemo=function(t,e){return iu.current.useMemo(t,e)};ci.useReducer=function(t,e,n){return iu.current.useReducer(t,e,n)};ci.useRef=function(t){return iu.current.useRef(t)};ci.useState=function(t){return iu.current.useState(t)};ci.useSyncExternalStore=function(t,e,n){return iu.current.useSyncExternalStore(t,e,n)};ci.useTransition=function(){return iu.current.useTransition()};ci.version="18.2.0";AK.exports=ci;var Ee=AK.exports;const ut=_A(Ee),MP=lz({__proto__:null,default:ut},[Ee]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xpe=Ee,Zpe=Symbol.for("react.element"),Ype=Symbol.for("react.fragment"),Qpe=Object.prototype.hasOwnProperty,Kpe=Xpe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Jpe={key:!0,ref:!0,__self:!0,__source:!0};function SK(t,e,n){var r,i={},o=null,a=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)Qpe.call(e,r)&&!Jpe.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Zpe,type:t,key:o,ref:a,props:i,_owner:Kpe.current}}vO.Fragment=Ype;vO.jsx=SK;vO.jsxs=SK;mK.exports=vO;var Un=mK.exports,BN={},TK={exports:{}},Pc={},CK={exports:{}},PK={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(be,De){var Re=be.length;be.push(De);e:for(;0<Re;){var qe=Re-1>>>1,ct=be[qe];if(0<i(ct,De))be[qe]=De,be[Re]=ct,Re=qe;else break e}}function n(be){return be.length===0?null:be[0]}function r(be){if(be.length===0)return null;var De=be[0],Re=be.pop();if(Re!==De){be[0]=Re;e:for(var qe=0,ct=be.length,Ct=ct>>>1;qe<Ct;){var Dt=2*(qe+1)-1,In=be[Dt],Mn=Dt+1,Tn=be[Mn];if(0>i(In,Re))Mn<ct&&0>i(Tn,In)?(be[qe]=Tn,be[Mn]=Re,qe=Mn):(be[qe]=In,be[Dt]=Re,qe=Dt);else if(Mn<ct&&0>i(Tn,Re))be[qe]=Tn,be[Mn]=Re,qe=Mn;else break e}}return De}function i(be,De){var Re=be.sortIndex-De.sortIndex;return Re!==0?Re:be.id-De.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,s=a.now();t.unstable_now=function(){return a.now()-s}}var u=[],d=[],g=1,_=null,E=3,P=!1,O=!1,D=!1,V=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,F=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function z(be){for(var De=n(d);De!==null;){if(De.callback===null)r(d);else if(De.startTime<=be)r(d),De.sortIndex=De.expirationTime,e(u,De);else break;De=n(d)}}function X(be){if(D=!1,z(be),!O)if(n(u)!==null)O=!0,at(Y);else{var De=n(d);De!==null&&yt(X,De.startTime-be)}}function Y(be,De){O=!1,D&&(D=!1,k(ue),ue=-1),P=!0;var Re=E;try{for(z(De),_=n(u);_!==null&&(!(_.expirationTime>De)||be&&!se());){var qe=_.callback;if(typeof qe=="function"){_.callback=null,E=_.priorityLevel;var ct=qe(_.expirationTime<=De);De=t.unstable_now(),typeof ct=="function"?_.callback=ct:_===n(u)&&r(u),z(De)}else r(u);_=n(u)}if(_!==null)var Ct=!0;else{var Dt=n(d);Dt!==null&&yt(X,Dt.startTime-De),Ct=!1}return Ct}finally{_=null,E=Re,P=!1}}var J=!1,re=null,ue=-1,ie=5,ce=-1;function se(){return!(t.unstable_now()-ce<ie)}function me(){if(re!==null){var be=t.unstable_now();ce=be;var De=!0;try{De=re(!0,be)}finally{De?Ce():(J=!1,re=null)}}else J=!1}var Ce;if(typeof F=="function")Ce=function(){F(me)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,Ye=we.port2;we.port1.onmessage=me,Ce=function(){Ye.postMessage(null)}}else Ce=function(){V(me,0)};function at(be){re=be,J||(J=!0,Ce())}function yt(be,De){ue=V(function(){be(t.unstable_now())},De)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(be){be.callback=null},t.unstable_continueExecution=function(){O||P||(O=!0,at(Y))},t.unstable_forceFrameRate=function(be){0>be||125<be?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ie=0<be?Math.floor(1e3/be):5},t.unstable_getCurrentPriorityLevel=function(){return E},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(be){switch(E){case 1:case 2:case 3:var De=3;break;default:De=E}var Re=E;E=De;try{return be()}finally{E=Re}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(be,De){switch(be){case 1:case 2:case 3:case 4:case 5:break;default:be=3}var Re=E;E=be;try{return De()}finally{E=Re}},t.unstable_scheduleCallback=function(be,De,Re){var qe=t.unstable_now();switch(typeof Re=="object"&&Re!==null?(Re=Re.delay,Re=typeof Re=="number"&&0<Re?qe+Re:qe):Re=qe,be){case 1:var ct=-1;break;case 2:ct=250;break;case 5:ct=1073741823;break;case 4:ct=1e4;break;default:ct=5e3}return ct=Re+ct,be={id:g++,callback:De,priorityLevel:be,startTime:Re,expirationTime:ct,sortIndex:-1},Re>qe?(be.sortIndex=Re,e(d,be),n(u)===null&&be===n(d)&&(D?(k(ue),ue=-1):D=!0,yt(X,Re-qe))):(be.sortIndex=ct,e(u,be),O||P||(O=!0,at(Y))),be},t.unstable_shouldYield=se,t.unstable_wrapCallback=function(be){var De=E;return function(){var Re=E;E=De;try{return be.apply(this,arguments)}finally{E=Re}}}})(PK);CK.exports=PK;var ege=CK.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IK=Ee,vc=ege;function vn(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var MK=new Set,bw={};function a_(t,e){Mv(t,e),Mv(t+"Capture",e)}function Mv(t,e){for(bw[t]=e,t=0;t<e.length;t++)MK.add(e[t])}var rg=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),NN=Object.prototype.hasOwnProperty,tge=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uV={},cV={};function nge(t){return NN.call(cV,t)?!0:NN.call(uV,t)?!1:tge.test(t)?cV[t]=!0:(uV[t]=!0,!1)}function rge(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function ige(t,e,n,r){if(e===null||typeof e>"u"||rge(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ou(t,e,n,r,i,o,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=a}var Ka={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ka[t]=new ou(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ka[e]=new ou(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ka[t]=new ou(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ka[t]=new ou(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ka[t]=new ou(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ka[t]=new ou(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ka[t]=new ou(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ka[t]=new ou(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ka[t]=new ou(t,5,!1,t.toLowerCase(),null,!1,!1)});var dz=/[\-:]([a-z])/g;function pz(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(dz,pz);Ka[e]=new ou(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(dz,pz);Ka[e]=new ou(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(dz,pz);Ka[e]=new ou(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ka[t]=new ou(t,1,!1,t.toLowerCase(),null,!1,!1)});Ka.xlinkHref=new ou("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ka[t]=new ou(t,1,!1,t.toLowerCase(),null,!0,!0)});function gz(t,e,n,r){var i=Ka.hasOwnProperty(e)?Ka[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(ige(e,n,i,r)&&(n=null),r||i===null?nge(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var bg=IK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cS=Symbol.for("react.element"),$y=Symbol.for("react.portal"),Hy=Symbol.for("react.fragment"),mz=Symbol.for("react.strict_mode"),FN=Symbol.for("react.profiler"),OK=Symbol.for("react.provider"),RK=Symbol.for("react.context"),Az=Symbol.for("react.forward_ref"),kN=Symbol.for("react.suspense"),zN=Symbol.for("react.suspense_list"),_z=Symbol.for("react.memo"),xm=Symbol.for("react.lazy"),LK=Symbol.for("react.offscreen"),fV=Symbol.iterator;function Jx(t){return t===null||typeof t!="object"?null:(t=fV&&t[fV]||t["@@iterator"],typeof t=="function"?t:null)}var ls=Object.assign,lD;function Hb(t){if(lD===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);lD=e&&e[1]||""}return`
`+lD+t}var uD=!1;function cD(t,e){if(!t||uD)return"";uD=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var i=d.stack.split(`
`),o=r.stack.split(`
`),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(a!==1||s!==1)do if(a--,s--,0>s||i[a]!==o[s]){var u=`
`+i[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=s);break}}}finally{uD=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Hb(t):""}function oge(t){switch(t.tag){case 5:return Hb(t.type);case 16:return Hb("Lazy");case 13:return Hb("Suspense");case 19:return Hb("SuspenseList");case 0:case 2:case 15:return t=cD(t.type,!1),t;case 11:return t=cD(t.type.render,!1),t;case 1:return t=cD(t.type,!0),t;default:return""}}function UN(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Hy:return"Fragment";case $y:return"Portal";case FN:return"Profiler";case mz:return"StrictMode";case kN:return"Suspense";case zN:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case RK:return(t.displayName||"Context")+".Consumer";case OK:return(t._context.displayName||"Context")+".Provider";case Az:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case _z:return e=t.displayName||null,e!==null?e:UN(t.type)||"Memo";case xm:e=t._payload,t=t._init;try{return UN(t(e))}catch{}}return null}function sge(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return UN(e);case 8:return e===mz?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Zm(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function DK(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function age(t){var e=DK(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,o.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function fS(t){t._valueTracker||(t._valueTracker=age(t))}function BK(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=DK(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function OP(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function GN(t,e){var n=e.checked;return ls({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function hV(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Zm(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function NK(t,e){e=e.checked,e!=null&&gz(t,"checked",e,!1)}function jN(t,e){NK(t,e);var n=Zm(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?VN(t,e.type,n):e.hasOwnProperty("defaultValue")&&VN(t,e.type,Zm(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function dV(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function VN(t,e,n){(e!=="number"||OP(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Wb=Array.isArray;function dv(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Zm(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function $N(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(vn(91));return ls({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function pV(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(vn(92));if(Wb(n)){if(1<n.length)throw Error(vn(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Zm(n)}}function FK(t,e){var n=Zm(e.value),r=Zm(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function gV(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function kK(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function HN(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?kK(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var hS,zK=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(hS=hS||document.createElement("div"),hS.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=hS.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ww(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var rw={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},lge=["Webkit","ms","Moz","O"];Object.keys(rw).forEach(function(t){lge.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),rw[e]=rw[t]})});function UK(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||rw.hasOwnProperty(t)&&rw[t]?(""+e).trim():e+"px"}function GK(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=UK(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var uge=ls({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function WN(t,e){if(e){if(uge[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(vn(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(vn(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(vn(61))}if(e.style!=null&&typeof e.style!="object")throw Error(vn(62))}}function qN(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var XN=null;function yz(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var ZN=null,pv=null,gv=null;function mV(t){if(t=TE(t)){if(typeof ZN!="function")throw Error(vn(280));var e=t.stateNode;e&&(e=SO(e),ZN(t.stateNode,t.type,e))}}function jK(t){pv?gv?gv.push(t):gv=[t]:pv=t}function VK(){if(pv){var t=pv,e=gv;if(gv=pv=null,mV(t),e)for(t=0;t<e.length;t++)mV(e[t])}}function $K(t,e){return t(e)}function HK(){}var fD=!1;function WK(t,e,n){if(fD)return t(e,n);fD=!0;try{return $K(t,e,n)}finally{fD=!1,(pv!==null||gv!==null)&&(HK(),VK())}}function Ew(t,e){var n=t.stateNode;if(n===null)return null;var r=SO(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(vn(231,e,typeof n));return n}var YN=!1;if(rg)try{var eb={};Object.defineProperty(eb,"passive",{get:function(){YN=!0}}),window.addEventListener("test",eb,eb),window.removeEventListener("test",eb,eb)}catch{YN=!1}function cge(t,e,n,r,i,o,a,s,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(g){this.onError(g)}}var iw=!1,RP=null,LP=!1,QN=null,fge={onError:function(t){iw=!0,RP=t}};function hge(t,e,n,r,i,o,a,s,u){iw=!1,RP=null,cge.apply(fge,arguments)}function dge(t,e,n,r,i,o,a,s,u){if(hge.apply(this,arguments),iw){if(iw){var d=RP;iw=!1,RP=null}else throw Error(vn(198));LP||(LP=!0,QN=d)}}function l_(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function qK(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function AV(t){if(l_(t)!==t)throw Error(vn(188))}function pge(t){var e=t.alternate;if(!e){if(e=l_(t),e===null)throw Error(vn(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return AV(i),t;if(o===r)return AV(i),e;o=o.sibling}throw Error(vn(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,s=i.child;s;){if(s===n){a=!0,n=i,r=o;break}if(s===r){a=!0,r=i,n=o;break}s=s.sibling}if(!a){for(s=o.child;s;){if(s===n){a=!0,n=o,r=i;break}if(s===r){a=!0,r=o,n=i;break}s=s.sibling}if(!a)throw Error(vn(189))}}if(n.alternate!==r)throw Error(vn(190))}if(n.tag!==3)throw Error(vn(188));return n.stateNode.current===n?t:e}function XK(t){return t=pge(t),t!==null?ZK(t):null}function ZK(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=ZK(t);if(e!==null)return e;t=t.sibling}return null}var YK=vc.unstable_scheduleCallback,_V=vc.unstable_cancelCallback,gge=vc.unstable_shouldYield,mge=vc.unstable_requestPaint,Ss=vc.unstable_now,Age=vc.unstable_getCurrentPriorityLevel,vz=vc.unstable_ImmediatePriority,QK=vc.unstable_UserBlockingPriority,DP=vc.unstable_NormalPriority,_ge=vc.unstable_LowPriority,KK=vc.unstable_IdlePriority,xO=null,Nd=null;function yge(t){if(Nd&&typeof Nd.onCommitFiberRoot=="function")try{Nd.onCommitFiberRoot(xO,t,void 0,(t.current.flags&128)===128)}catch{}}var Ah=Math.clz32?Math.clz32:bge,vge=Math.log,xge=Math.LN2;function bge(t){return t>>>=0,t===0?32:31-(vge(t)/xge|0)|0}var dS=64,pS=4194304;function qb(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function BP(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,o=t.pingedLanes,a=n&268435455;if(a!==0){var s=a&~i;s!==0?r=qb(s):(o&=a,o!==0&&(r=qb(o)))}else a=n&~i,a!==0?r=qb(a):o!==0&&(r=qb(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ah(e),i=1<<n,r|=t[n],e&=~i;return r}function wge(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ege(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,o=t.pendingLanes;0<o;){var a=31-Ah(o),s=1<<a,u=i[a];u===-1?(!(s&n)||s&r)&&(i[a]=wge(s,e)):u<=e&&(t.expiredLanes|=s),o&=~s}}function KN(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function JK(){var t=dS;return dS<<=1,!(dS&4194240)&&(dS=64),t}function hD(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function EE(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ah(e),t[e]=n}function Sge(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Ah(n),o=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~o}}function xz(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ah(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ki=0;function eJ(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var tJ,bz,nJ,rJ,iJ,JN=!1,gS=[],Dm=null,Bm=null,Nm=null,Sw=new Map,Tw=new Map,Em=[],Tge="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yV(t,e){switch(t){case"focusin":case"focusout":Dm=null;break;case"dragenter":case"dragleave":Bm=null;break;case"mouseover":case"mouseout":Nm=null;break;case"pointerover":case"pointerout":Sw.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Tw.delete(e.pointerId)}}function tb(t,e,n,r,i,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=TE(e),e!==null&&bz(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function Cge(t,e,n,r,i){switch(e){case"focusin":return Dm=tb(Dm,t,e,n,r,i),!0;case"dragenter":return Bm=tb(Bm,t,e,n,r,i),!0;case"mouseover":return Nm=tb(Nm,t,e,n,r,i),!0;case"pointerover":var o=i.pointerId;return Sw.set(o,tb(Sw.get(o)||null,t,e,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Tw.set(o,tb(Tw.get(o)||null,t,e,n,r,i)),!0}return!1}function oJ(t){var e=x0(t.target);if(e!==null){var n=l_(e);if(n!==null){if(e=n.tag,e===13){if(e=qK(n),e!==null){t.blockedOn=e,iJ(t.priority,function(){nJ(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function XT(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=eF(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);XN=r,n.target.dispatchEvent(r),XN=null}else return e=TE(n),e!==null&&bz(e),t.blockedOn=n,!1;e.shift()}return!0}function vV(t,e,n){XT(t)&&n.delete(e)}function Pge(){JN=!1,Dm!==null&&XT(Dm)&&(Dm=null),Bm!==null&&XT(Bm)&&(Bm=null),Nm!==null&&XT(Nm)&&(Nm=null),Sw.forEach(vV),Tw.forEach(vV)}function nb(t,e){t.blockedOn===e&&(t.blockedOn=null,JN||(JN=!0,vc.unstable_scheduleCallback(vc.unstable_NormalPriority,Pge)))}function Cw(t){function e(i){return nb(i,t)}if(0<gS.length){nb(gS[0],t);for(var n=1;n<gS.length;n++){var r=gS[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Dm!==null&&nb(Dm,t),Bm!==null&&nb(Bm,t),Nm!==null&&nb(Nm,t),Sw.forEach(e),Tw.forEach(e),n=0;n<Em.length;n++)r=Em[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Em.length&&(n=Em[0],n.blockedOn===null);)oJ(n),n.blockedOn===null&&Em.shift()}var mv=bg.ReactCurrentBatchConfig,NP=!0;function Ige(t,e,n,r){var i=Ki,o=mv.transition;mv.transition=null;try{Ki=1,wz(t,e,n,r)}finally{Ki=i,mv.transition=o}}function Mge(t,e,n,r){var i=Ki,o=mv.transition;mv.transition=null;try{Ki=4,wz(t,e,n,r)}finally{Ki=i,mv.transition=o}}function wz(t,e,n,r){if(NP){var i=eF(t,e,n,r);if(i===null)bD(t,e,r,FP,n),yV(t,r);else if(Cge(i,t,e,n,r))r.stopPropagation();else if(yV(t,r),e&4&&-1<Tge.indexOf(t)){for(;i!==null;){var o=TE(i);if(o!==null&&tJ(o),o=eF(t,e,n,r),o===null&&bD(t,e,r,FP,n),o===i)break;i=o}i!==null&&r.stopPropagation()}else bD(t,e,r,null,n)}}var FP=null;function eF(t,e,n,r){if(FP=null,t=yz(r),t=x0(t),t!==null)if(e=l_(t),e===null)t=null;else if(n=e.tag,n===13){if(t=qK(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return FP=t,null}function sJ(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Age()){case vz:return 1;case QK:return 4;case DP:case _ge:return 16;case KK:return 536870912;default:return 16}default:return 16}}var Cm=null,Ez=null,ZT=null;function aJ(){if(ZT)return ZT;var t,e=Ez,n=e.length,r,i="value"in Cm?Cm.value:Cm.textContent,o=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[o-r];r++);return ZT=i.slice(t,1<r?1-r:void 0)}function YT(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function mS(){return!0}function xV(){return!1}function Ic(t){function e(n,r,i,o,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=a,this.currentTarget=null;for(var s in t)t.hasOwnProperty(s)&&(n=t[s],this[s]=n?n(o):o[s]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?mS:xV,this.isPropagationStopped=xV,this}return ls(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=mS)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=mS)},persist:function(){},isPersistent:mS}),e}var R1={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sz=Ic(R1),SE=ls({},R1,{view:0,detail:0}),Oge=Ic(SE),dD,pD,rb,bO=ls({},SE,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Tz,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==rb&&(rb&&t.type==="mousemove"?(dD=t.screenX-rb.screenX,pD=t.screenY-rb.screenY):pD=dD=0,rb=t),dD)},movementY:function(t){return"movementY"in t?t.movementY:pD}}),bV=Ic(bO),Rge=ls({},bO,{dataTransfer:0}),Lge=Ic(Rge),Dge=ls({},SE,{relatedTarget:0}),gD=Ic(Dge),Bge=ls({},R1,{animationName:0,elapsedTime:0,pseudoElement:0}),Nge=Ic(Bge),Fge=ls({},R1,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),kge=Ic(Fge),zge=ls({},R1,{data:0}),wV=Ic(zge),Uge={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Gge={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jge={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Vge(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=jge[t])?!!e[t]:!1}function Tz(){return Vge}var $ge=ls({},SE,{key:function(t){if(t.key){var e=Uge[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=YT(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Gge[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Tz,charCode:function(t){return t.type==="keypress"?YT(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?YT(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),Hge=Ic($ge),Wge=ls({},bO,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),EV=Ic(Wge),qge=ls({},SE,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Tz}),Xge=Ic(qge),Zge=ls({},R1,{propertyName:0,elapsedTime:0,pseudoElement:0}),Yge=Ic(Zge),Qge=ls({},bO,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),Kge=Ic(Qge),Jge=[9,13,27,32],Cz=rg&&"CompositionEvent"in window,ow=null;rg&&"documentMode"in document&&(ow=document.documentMode);var eme=rg&&"TextEvent"in window&&!ow,lJ=rg&&(!Cz||ow&&8<ow&&11>=ow),SV=String.fromCharCode(32),TV=!1;function uJ(t,e){switch(t){case"keyup":return Jge.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cJ(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Wy=!1;function tme(t,e){switch(t){case"compositionend":return cJ(e);case"keypress":return e.which!==32?null:(TV=!0,SV);case"textInput":return t=e.data,t===SV&&TV?null:t;default:return null}}function nme(t,e){if(Wy)return t==="compositionend"||!Cz&&uJ(t,e)?(t=aJ(),ZT=Ez=Cm=null,Wy=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return lJ&&e.locale!=="ko"?null:e.data;default:return null}}var rme={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function CV(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!rme[t.type]:e==="textarea"}function fJ(t,e,n,r){jK(r),e=kP(e,"onChange"),0<e.length&&(n=new Sz("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var sw=null,Pw=null;function ime(t){bJ(t,0)}function wO(t){var e=Zy(t);if(BK(e))return t}function ome(t,e){if(t==="change")return e}var hJ=!1;if(rg){var mD;if(rg){var AD="oninput"in document;if(!AD){var PV=document.createElement("div");PV.setAttribute("oninput","return;"),AD=typeof PV.oninput=="function"}mD=AD}else mD=!1;hJ=mD&&(!document.documentMode||9<document.documentMode)}function IV(){sw&&(sw.detachEvent("onpropertychange",dJ),Pw=sw=null)}function dJ(t){if(t.propertyName==="value"&&wO(Pw)){var e=[];fJ(e,Pw,t,yz(t)),WK(ime,e)}}function sme(t,e,n){t==="focusin"?(IV(),sw=e,Pw=n,sw.attachEvent("onpropertychange",dJ)):t==="focusout"&&IV()}function ame(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return wO(Pw)}function lme(t,e){if(t==="click")return wO(e)}function ume(t,e){if(t==="input"||t==="change")return wO(e)}function cme(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var xh=typeof Object.is=="function"?Object.is:cme;function Iw(t,e){if(xh(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!NN.call(e,i)||!xh(t[i],e[i]))return!1}return!0}function MV(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function OV(t,e){var n=MV(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=MV(n)}}function pJ(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?pJ(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function gJ(){for(var t=window,e=OP();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=OP(t.document)}return e}function Pz(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function fme(t){var e=gJ(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&pJ(n.ownerDocument.documentElement,n)){if(r!==null&&Pz(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!t.extend&&o>r&&(i=r,r=o,o=i),i=OV(n,o);var a=OV(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),o>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var hme=rg&&"documentMode"in document&&11>=document.documentMode,qy=null,tF=null,aw=null,nF=!1;function RV(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;nF||qy==null||qy!==OP(r)||(r=qy,"selectionStart"in r&&Pz(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),aw&&Iw(aw,r)||(aw=r,r=kP(tF,"onSelect"),0<r.length&&(e=new Sz("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=qy)))}function AS(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Xy={animationend:AS("Animation","AnimationEnd"),animationiteration:AS("Animation","AnimationIteration"),animationstart:AS("Animation","AnimationStart"),transitionend:AS("Transition","TransitionEnd")},_D={},mJ={};rg&&(mJ=document.createElement("div").style,"AnimationEvent"in window||(delete Xy.animationend.animation,delete Xy.animationiteration.animation,delete Xy.animationstart.animation),"TransitionEvent"in window||delete Xy.transitionend.transition);function EO(t){if(_D[t])return _D[t];if(!Xy[t])return t;var e=Xy[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in mJ)return _D[t]=e[n];return t}var AJ=EO("animationend"),_J=EO("animationiteration"),yJ=EO("animationstart"),vJ=EO("transitionend"),xJ=new Map,LV="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function yA(t,e){xJ.set(t,e),a_(e,[t])}for(var yD=0;yD<LV.length;yD++){var vD=LV[yD],dme=vD.toLowerCase(),pme=vD[0].toUpperCase()+vD.slice(1);yA(dme,"on"+pme)}yA(AJ,"onAnimationEnd");yA(_J,"onAnimationIteration");yA(yJ,"onAnimationStart");yA("dblclick","onDoubleClick");yA("focusin","onFocus");yA("focusout","onBlur");yA(vJ,"onTransitionEnd");Mv("onMouseEnter",["mouseout","mouseover"]);Mv("onMouseLeave",["mouseout","mouseover"]);Mv("onPointerEnter",["pointerout","pointerover"]);Mv("onPointerLeave",["pointerout","pointerover"]);a_("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));a_("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));a_("onBeforeInput",["compositionend","keypress","textInput","paste"]);a_("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));a_("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));a_("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xb="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),gme=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xb));function DV(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,dge(r,e,void 0,t),t.currentTarget=null}function bJ(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var a=r.length-1;0<=a;a--){var s=r[a],u=s.instance,d=s.currentTarget;if(s=s.listener,u!==o&&i.isPropagationStopped())break e;DV(i,s,d),o=u}else for(a=0;a<r.length;a++){if(s=r[a],u=s.instance,d=s.currentTarget,s=s.listener,u!==o&&i.isPropagationStopped())break e;DV(i,s,d),o=u}}}if(LP)throw t=QN,LP=!1,QN=null,t}function Po(t,e){var n=e[aF];n===void 0&&(n=e[aF]=new Set);var r=t+"__bubble";n.has(r)||(wJ(e,t,2,!1),n.add(r))}function xD(t,e,n){var r=0;e&&(r|=4),wJ(n,t,r,e)}var _S="_reactListening"+Math.random().toString(36).slice(2);function Mw(t){if(!t[_S]){t[_S]=!0,MK.forEach(function(n){n!=="selectionchange"&&(gme.has(n)||xD(n,!1,t),xD(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[_S]||(e[_S]=!0,xD("selectionchange",!1,e))}}function wJ(t,e,n,r){switch(sJ(e)){case 1:var i=Ige;break;case 4:i=Mge;break;default:i=wz}n=i.bind(null,e,n,t),i=void 0,!YN||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function bD(t,e,n,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var s=r.stateNode.containerInfo;if(s===i||s.nodeType===8&&s.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===i||u.nodeType===8&&u.parentNode===i))return;a=a.return}for(;s!==null;){if(a=x0(s),a===null)return;if(u=a.tag,u===5||u===6){r=o=a;continue e}s=s.parentNode}}r=r.return}WK(function(){var d=o,g=yz(n),_=[];e:{var E=xJ.get(t);if(E!==void 0){var P=Sz,O=t;switch(t){case"keypress":if(YT(n)===0)break e;case"keydown":case"keyup":P=Hge;break;case"focusin":O="focus",P=gD;break;case"focusout":O="blur",P=gD;break;case"beforeblur":case"afterblur":P=gD;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":P=bV;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":P=Lge;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":P=Xge;break;case AJ:case _J:case yJ:P=Nge;break;case vJ:P=Yge;break;case"scroll":P=Oge;break;case"wheel":P=Kge;break;case"copy":case"cut":case"paste":P=kge;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":P=EV}var D=(e&4)!==0,V=!D&&t==="scroll",k=D?E!==null?E+"Capture":null:E;D=[];for(var F=d,z;F!==null;){z=F;var X=z.stateNode;if(z.tag===5&&X!==null&&(z=X,k!==null&&(X=Ew(F,k),X!=null&&D.push(Ow(F,X,z)))),V)break;F=F.return}0<D.length&&(E=new P(E,O,null,n,g),_.push({event:E,listeners:D}))}}if(!(e&7)){e:{if(E=t==="mouseover"||t==="pointerover",P=t==="mouseout"||t==="pointerout",E&&n!==XN&&(O=n.relatedTarget||n.fromElement)&&(x0(O)||O[ig]))break e;if((P||E)&&(E=g.window===g?g:(E=g.ownerDocument)?E.defaultView||E.parentWindow:window,P?(O=n.relatedTarget||n.toElement,P=d,O=O?x0(O):null,O!==null&&(V=l_(O),O!==V||O.tag!==5&&O.tag!==6)&&(O=null)):(P=null,O=d),P!==O)){if(D=bV,X="onMouseLeave",k="onMouseEnter",F="mouse",(t==="pointerout"||t==="pointerover")&&(D=EV,X="onPointerLeave",k="onPointerEnter",F="pointer"),V=P==null?E:Zy(P),z=O==null?E:Zy(O),E=new D(X,F+"leave",P,n,g),E.target=V,E.relatedTarget=z,X=null,x0(g)===d&&(D=new D(k,F+"enter",O,n,g),D.target=z,D.relatedTarget=V,X=D),V=X,P&&O)t:{for(D=P,k=O,F=0,z=D;z;z=dy(z))F++;for(z=0,X=k;X;X=dy(X))z++;for(;0<F-z;)D=dy(D),F--;for(;0<z-F;)k=dy(k),z--;for(;F--;){if(D===k||k!==null&&D===k.alternate)break t;D=dy(D),k=dy(k)}D=null}else D=null;P!==null&&BV(_,E,P,D,!1),O!==null&&V!==null&&BV(_,V,O,D,!0)}}e:{if(E=d?Zy(d):window,P=E.nodeName&&E.nodeName.toLowerCase(),P==="select"||P==="input"&&E.type==="file")var Y=ome;else if(CV(E))if(hJ)Y=ume;else{Y=ame;var J=sme}else(P=E.nodeName)&&P.toLowerCase()==="input"&&(E.type==="checkbox"||E.type==="radio")&&(Y=lme);if(Y&&(Y=Y(t,d))){fJ(_,Y,n,g);break e}J&&J(t,E,d),t==="focusout"&&(J=E._wrapperState)&&J.controlled&&E.type==="number"&&VN(E,"number",E.value)}switch(J=d?Zy(d):window,t){case"focusin":(CV(J)||J.contentEditable==="true")&&(qy=J,tF=d,aw=null);break;case"focusout":aw=tF=qy=null;break;case"mousedown":nF=!0;break;case"contextmenu":case"mouseup":case"dragend":nF=!1,RV(_,n,g);break;case"selectionchange":if(hme)break;case"keydown":case"keyup":RV(_,n,g)}var re;if(Cz)e:{switch(t){case"compositionstart":var ue="onCompositionStart";break e;case"compositionend":ue="onCompositionEnd";break e;case"compositionupdate":ue="onCompositionUpdate";break e}ue=void 0}else Wy?uJ(t,n)&&(ue="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(ue="onCompositionStart");ue&&(lJ&&n.locale!=="ko"&&(Wy||ue!=="onCompositionStart"?ue==="onCompositionEnd"&&Wy&&(re=aJ()):(Cm=g,Ez="value"in Cm?Cm.value:Cm.textContent,Wy=!0)),J=kP(d,ue),0<J.length&&(ue=new wV(ue,t,null,n,g),_.push({event:ue,listeners:J}),re?ue.data=re:(re=cJ(n),re!==null&&(ue.data=re)))),(re=eme?tme(t,n):nme(t,n))&&(d=kP(d,"onBeforeInput"),0<d.length&&(g=new wV("onBeforeInput","beforeinput",null,n,g),_.push({event:g,listeners:d}),g.data=re))}bJ(_,e)})}function Ow(t,e,n){return{instance:t,listener:e,currentTarget:n}}function kP(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Ew(t,n),o!=null&&r.unshift(Ow(t,o,i)),o=Ew(t,e),o!=null&&r.push(Ow(t,o,i))),t=t.return}return r}function dy(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function BV(t,e,n,r,i){for(var o=e._reactName,a=[];n!==null&&n!==r;){var s=n,u=s.alternate,d=s.stateNode;if(u!==null&&u===r)break;s.tag===5&&d!==null&&(s=d,i?(u=Ew(n,o),u!=null&&a.unshift(Ow(n,u,s))):i||(u=Ew(n,o),u!=null&&a.push(Ow(n,u,s)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var mme=/\r\n?/g,Ame=/\u0000|\uFFFD/g;function NV(t){return(typeof t=="string"?t:""+t).replace(mme,`
`).replace(Ame,"")}function yS(t,e,n){if(e=NV(e),NV(t)!==e&&n)throw Error(vn(425))}function zP(){}var rF=null,iF=null;function oF(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var sF=typeof setTimeout=="function"?setTimeout:void 0,_me=typeof clearTimeout=="function"?clearTimeout:void 0,FV=typeof Promise=="function"?Promise:void 0,yme=typeof queueMicrotask=="function"?queueMicrotask:typeof FV<"u"?function(t){return FV.resolve(null).then(t).catch(vme)}:sF;function vme(t){setTimeout(function(){throw t})}function wD(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Cw(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Cw(e)}function Fm(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function kV(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var L1=Math.random().toString(36).slice(2),Pd="__reactFiber$"+L1,Rw="__reactProps$"+L1,ig="__reactContainer$"+L1,aF="__reactEvents$"+L1,xme="__reactListeners$"+L1,bme="__reactHandles$"+L1;function x0(t){var e=t[Pd];if(e)return e;for(var n=t.parentNode;n;){if(e=n[ig]||n[Pd]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=kV(t);t!==null;){if(n=t[Pd])return n;t=kV(t)}return e}t=n,n=t.parentNode}return null}function TE(t){return t=t[Pd]||t[ig],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zy(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(vn(33))}function SO(t){return t[Rw]||null}var lF=[],Yy=-1;function vA(t){return{current:t}}function Io(t){0>Yy||(t.current=lF[Yy],lF[Yy]=null,Yy--)}function xo(t,e){Yy++,lF[Yy]=t.current,t.current=e}var Ym={},Cl=vA(Ym),Cu=vA(!1),M0=Ym;function Ov(t,e){var n=t.type.contextTypes;if(!n)return Ym;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in n)i[o]=e[o];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function Pu(t){return t=t.childContextTypes,t!=null}function UP(){Io(Cu),Io(Cl)}function zV(t,e,n){if(Cl.current!==Ym)throw Error(vn(168));xo(Cl,e),xo(Cu,n)}function EJ(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(vn(108,sge(t)||"Unknown",i));return ls({},n,r)}function GP(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Ym,M0=Cl.current,xo(Cl,t),xo(Cu,Cu.current),!0}function UV(t,e,n){var r=t.stateNode;if(!r)throw Error(vn(169));n?(t=EJ(t,e,M0),r.__reactInternalMemoizedMergedChildContext=t,Io(Cu),Io(Cl),xo(Cl,t)):Io(Cu),xo(Cu,n)}var jp=null,TO=!1,ED=!1;function SJ(t){jp===null?jp=[t]:jp.push(t)}function wme(t){TO=!0,SJ(t)}function xA(){if(!ED&&jp!==null){ED=!0;var t=0,e=Ki;try{var n=jp;for(Ki=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}jp=null,TO=!1}catch(i){throw jp!==null&&(jp=jp.slice(t+1)),YK(vz,xA),i}finally{Ki=e,ED=!1}}return null}var Qy=[],Ky=0,jP=null,VP=0,af=[],lf=0,O0=null,qp=1,Xp="";function A0(t,e){Qy[Ky++]=VP,Qy[Ky++]=jP,jP=t,VP=e}function TJ(t,e,n){af[lf++]=qp,af[lf++]=Xp,af[lf++]=O0,O0=t;var r=qp;t=Xp;var i=32-Ah(r)-1;r&=~(1<<i),n+=1;var o=32-Ah(e)+i;if(30<o){var a=i-i%5;o=(r&(1<<a)-1).toString(32),r>>=a,i-=a,qp=1<<32-Ah(e)+i|n<<i|r,Xp=o+t}else qp=1<<o|n<<i|r,Xp=t}function Iz(t){t.return!==null&&(A0(t,1),TJ(t,1,0))}function Mz(t){for(;t===jP;)jP=Qy[--Ky],Qy[Ky]=null,VP=Qy[--Ky],Qy[Ky]=null;for(;t===O0;)O0=af[--lf],af[lf]=null,Xp=af[--lf],af[lf]=null,qp=af[--lf],af[lf]=null}var hc=null,lc=null,ko=!1,lh=null;function CJ(t,e){var n=ff(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function GV(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,hc=t,lc=Fm(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,hc=t,lc=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=O0!==null?{id:qp,overflow:Xp}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=ff(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,hc=t,lc=null,!0):!1;default:return!1}}function uF(t){return(t.mode&1)!==0&&(t.flags&128)===0}function cF(t){if(ko){var e=lc;if(e){var n=e;if(!GV(t,e)){if(uF(t))throw Error(vn(418));e=Fm(n.nextSibling);var r=hc;e&&GV(t,e)?CJ(r,n):(t.flags=t.flags&-4097|2,ko=!1,hc=t)}}else{if(uF(t))throw Error(vn(418));t.flags=t.flags&-4097|2,ko=!1,hc=t}}}function jV(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;hc=t}function vS(t){if(t!==hc)return!1;if(!ko)return jV(t),ko=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!oF(t.type,t.memoizedProps)),e&&(e=lc)){if(uF(t))throw PJ(),Error(vn(418));for(;e;)CJ(t,e),e=Fm(e.nextSibling)}if(jV(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(vn(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){lc=Fm(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}lc=null}}else lc=hc?Fm(t.stateNode.nextSibling):null;return!0}function PJ(){for(var t=lc;t;)t=Fm(t.nextSibling)}function Rv(){lc=hc=null,ko=!1}function Oz(t){lh===null?lh=[t]:lh.push(t)}var Eme=bg.ReactCurrentBatchConfig;function sh(t,e){if(t&&t.defaultProps){e=ls({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var $P=vA(null),HP=null,Jy=null,Rz=null;function Lz(){Rz=Jy=HP=null}function Dz(t){var e=$P.current;Io($P),t._currentValue=e}function fF(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Av(t,e){HP=t,Rz=Jy=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Eu=!0),t.firstContext=null)}function _f(t){var e=t._currentValue;if(Rz!==t)if(t={context:t,memoizedValue:e,next:null},Jy===null){if(HP===null)throw Error(vn(308));Jy=t,HP.dependencies={lanes:0,firstContext:t}}else Jy=Jy.next=t;return e}var b0=null;function Bz(t){b0===null?b0=[t]:b0.push(t)}function IJ(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,Bz(e)):(n.next=i.next,i.next=n),e.interleaved=n,og(t,r)}function og(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var bm=!1;function Nz(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function MJ(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Qp(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function km(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,vi&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,og(t,n)}return i=r.interleaved,i===null?(e.next=e,Bz(r)):(e.next=i.next,i.next=e),r.interleaved=e,og(t,n)}function QT(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,xz(t,n)}}function VV(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?i=o=a:o=o.next=a,n=n.next}while(n!==null);o===null?i=o=e:o=o.next=e}else i=o=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function WP(t,e,n,r){var i=t.updateQueue;bm=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(s!==null){i.shared.pending=null;var u=s,d=u.next;u.next=null,a===null?o=d:a.next=d,a=u;var g=t.alternate;g!==null&&(g=g.updateQueue,s=g.lastBaseUpdate,s!==a&&(s===null?g.firstBaseUpdate=d:s.next=d,g.lastBaseUpdate=u))}if(o!==null){var _=i.baseState;a=0,g=d=u=null,s=o;do{var E=s.lane,P=s.eventTime;if((r&E)===E){g!==null&&(g=g.next={eventTime:P,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var O=t,D=s;switch(E=e,P=n,D.tag){case 1:if(O=D.payload,typeof O=="function"){_=O.call(P,_,E);break e}_=O;break e;case 3:O.flags=O.flags&-65537|128;case 0:if(O=D.payload,E=typeof O=="function"?O.call(P,_,E):O,E==null)break e;_=ls({},_,E);break e;case 2:bm=!0}}s.callback!==null&&s.lane!==0&&(t.flags|=64,E=i.effects,E===null?i.effects=[s]:E.push(s))}else P={eventTime:P,lane:E,tag:s.tag,payload:s.payload,callback:s.callback,next:null},g===null?(d=g=P,u=_):g=g.next=P,a|=E;if(s=s.next,s===null){if(s=i.shared.pending,s===null)break;E=s,s=E.next,E.next=null,i.lastBaseUpdate=E,i.shared.pending=null}}while(1);if(g===null&&(u=_),i.baseState=u,i.firstBaseUpdate=d,i.lastBaseUpdate=g,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);L0|=a,t.lanes=a,t.memoizedState=_}}function $V(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(vn(191,i));i.call(r)}}}var OJ=new IK.Component().refs;function hF(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ls({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var CO={isMounted:function(t){return(t=t._reactInternals)?l_(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Zl(),i=Um(t),o=Qp(r,i);o.payload=e,n!=null&&(o.callback=n),e=km(t,o,i),e!==null&&(_h(e,t,i,r),QT(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Zl(),i=Um(t),o=Qp(r,i);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=km(t,o,i),e!==null&&(_h(e,t,i,r),QT(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Zl(),r=Um(t),i=Qp(n,r);i.tag=2,e!=null&&(i.callback=e),e=km(t,i,r),e!==null&&(_h(e,t,r,n),QT(e,t,r))}};function HV(t,e,n,r,i,o,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,o,a):e.prototype&&e.prototype.isPureReactComponent?!Iw(n,r)||!Iw(i,o):!0}function RJ(t,e,n){var r=!1,i=Ym,o=e.contextType;return typeof o=="object"&&o!==null?o=_f(o):(i=Pu(e)?M0:Cl.current,r=e.contextTypes,o=(r=r!=null)?Ov(t,i):Ym),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=CO,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=o),e}function WV(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&CO.enqueueReplaceState(e,e.state,null)}function dF(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs=OJ,Nz(t);var o=e.contextType;typeof o=="object"&&o!==null?i.context=_f(o):(o=Pu(e)?M0:Cl.current,i.context=Ov(t,o)),i.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(hF(t,e,o,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&CO.enqueueReplaceState(i,i.state,null),WP(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function ib(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(vn(309));var r=n.stateNode}if(!r)throw Error(vn(147,t));var i=r,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(a){var s=i.refs;s===OJ&&(s=i.refs={}),a===null?delete s[o]:s[o]=a},e._stringRef=o,e)}if(typeof t!="string")throw Error(vn(284));if(!n._owner)throw Error(vn(290,t))}return t}function xS(t,e){throw t=Object.prototype.toString.call(e),Error(vn(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function qV(t){var e=t._init;return e(t._payload)}function LJ(t){function e(k,F){if(t){var z=k.deletions;z===null?(k.deletions=[F],k.flags|=16):z.push(F)}}function n(k,F){if(!t)return null;for(;F!==null;)e(k,F),F=F.sibling;return null}function r(k,F){for(k=new Map;F!==null;)F.key!==null?k.set(F.key,F):k.set(F.index,F),F=F.sibling;return k}function i(k,F){return k=Gm(k,F),k.index=0,k.sibling=null,k}function o(k,F,z){return k.index=z,t?(z=k.alternate,z!==null?(z=z.index,z<F?(k.flags|=2,F):z):(k.flags|=2,F)):(k.flags|=1048576,F)}function a(k){return t&&k.alternate===null&&(k.flags|=2),k}function s(k,F,z,X){return F===null||F.tag!==6?(F=OD(z,k.mode,X),F.return=k,F):(F=i(F,z),F.return=k,F)}function u(k,F,z,X){var Y=z.type;return Y===Hy?g(k,F,z.props.children,X,z.key):F!==null&&(F.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===xm&&qV(Y)===F.type)?(X=i(F,z.props),X.ref=ib(k,F,z),X.return=k,X):(X=rC(z.type,z.key,z.props,null,k.mode,X),X.ref=ib(k,F,z),X.return=k,X)}function d(k,F,z,X){return F===null||F.tag!==4||F.stateNode.containerInfo!==z.containerInfo||F.stateNode.implementation!==z.implementation?(F=RD(z,k.mode,X),F.return=k,F):(F=i(F,z.children||[]),F.return=k,F)}function g(k,F,z,X,Y){return F===null||F.tag!==7?(F=P0(z,k.mode,X,Y),F.return=k,F):(F=i(F,z),F.return=k,F)}function _(k,F,z){if(typeof F=="string"&&F!==""||typeof F=="number")return F=OD(""+F,k.mode,z),F.return=k,F;if(typeof F=="object"&&F!==null){switch(F.$$typeof){case cS:return z=rC(F.type,F.key,F.props,null,k.mode,z),z.ref=ib(k,null,F),z.return=k,z;case $y:return F=RD(F,k.mode,z),F.return=k,F;case xm:var X=F._init;return _(k,X(F._payload),z)}if(Wb(F)||Jx(F))return F=P0(F,k.mode,z,null),F.return=k,F;xS(k,F)}return null}function E(k,F,z,X){var Y=F!==null?F.key:null;if(typeof z=="string"&&z!==""||typeof z=="number")return Y!==null?null:s(k,F,""+z,X);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case cS:return z.key===Y?u(k,F,z,X):null;case $y:return z.key===Y?d(k,F,z,X):null;case xm:return Y=z._init,E(k,F,Y(z._payload),X)}if(Wb(z)||Jx(z))return Y!==null?null:g(k,F,z,X,null);xS(k,z)}return null}function P(k,F,z,X,Y){if(typeof X=="string"&&X!==""||typeof X=="number")return k=k.get(z)||null,s(F,k,""+X,Y);if(typeof X=="object"&&X!==null){switch(X.$$typeof){case cS:return k=k.get(X.key===null?z:X.key)||null,u(F,k,X,Y);case $y:return k=k.get(X.key===null?z:X.key)||null,d(F,k,X,Y);case xm:var J=X._init;return P(k,F,z,J(X._payload),Y)}if(Wb(X)||Jx(X))return k=k.get(z)||null,g(F,k,X,Y,null);xS(F,X)}return null}function O(k,F,z,X){for(var Y=null,J=null,re=F,ue=F=0,ie=null;re!==null&&ue<z.length;ue++){re.index>ue?(ie=re,re=null):ie=re.sibling;var ce=E(k,re,z[ue],X);if(ce===null){re===null&&(re=ie);break}t&&re&&ce.alternate===null&&e(k,re),F=o(ce,F,ue),J===null?Y=ce:J.sibling=ce,J=ce,re=ie}if(ue===z.length)return n(k,re),ko&&A0(k,ue),Y;if(re===null){for(;ue<z.length;ue++)re=_(k,z[ue],X),re!==null&&(F=o(re,F,ue),J===null?Y=re:J.sibling=re,J=re);return ko&&A0(k,ue),Y}for(re=r(k,re);ue<z.length;ue++)ie=P(re,k,ue,z[ue],X),ie!==null&&(t&&ie.alternate!==null&&re.delete(ie.key===null?ue:ie.key),F=o(ie,F,ue),J===null?Y=ie:J.sibling=ie,J=ie);return t&&re.forEach(function(se){return e(k,se)}),ko&&A0(k,ue),Y}function D(k,F,z,X){var Y=Jx(z);if(typeof Y!="function")throw Error(vn(150));if(z=Y.call(z),z==null)throw Error(vn(151));for(var J=Y=null,re=F,ue=F=0,ie=null,ce=z.next();re!==null&&!ce.done;ue++,ce=z.next()){re.index>ue?(ie=re,re=null):ie=re.sibling;var se=E(k,re,ce.value,X);if(se===null){re===null&&(re=ie);break}t&&re&&se.alternate===null&&e(k,re),F=o(se,F,ue),J===null?Y=se:J.sibling=se,J=se,re=ie}if(ce.done)return n(k,re),ko&&A0(k,ue),Y;if(re===null){for(;!ce.done;ue++,ce=z.next())ce=_(k,ce.value,X),ce!==null&&(F=o(ce,F,ue),J===null?Y=ce:J.sibling=ce,J=ce);return ko&&A0(k,ue),Y}for(re=r(k,re);!ce.done;ue++,ce=z.next())ce=P(re,k,ue,ce.value,X),ce!==null&&(t&&ce.alternate!==null&&re.delete(ce.key===null?ue:ce.key),F=o(ce,F,ue),J===null?Y=ce:J.sibling=ce,J=ce);return t&&re.forEach(function(me){return e(k,me)}),ko&&A0(k,ue),Y}function V(k,F,z,X){if(typeof z=="object"&&z!==null&&z.type===Hy&&z.key===null&&(z=z.props.children),typeof z=="object"&&z!==null){switch(z.$$typeof){case cS:e:{for(var Y=z.key,J=F;J!==null;){if(J.key===Y){if(Y=z.type,Y===Hy){if(J.tag===7){n(k,J.sibling),F=i(J,z.props.children),F.return=k,k=F;break e}}else if(J.elementType===Y||typeof Y=="object"&&Y!==null&&Y.$$typeof===xm&&qV(Y)===J.type){n(k,J.sibling),F=i(J,z.props),F.ref=ib(k,J,z),F.return=k,k=F;break e}n(k,J);break}else e(k,J);J=J.sibling}z.type===Hy?(F=P0(z.props.children,k.mode,X,z.key),F.return=k,k=F):(X=rC(z.type,z.key,z.props,null,k.mode,X),X.ref=ib(k,F,z),X.return=k,k=X)}return a(k);case $y:e:{for(J=z.key;F!==null;){if(F.key===J)if(F.tag===4&&F.stateNode.containerInfo===z.containerInfo&&F.stateNode.implementation===z.implementation){n(k,F.sibling),F=i(F,z.children||[]),F.return=k,k=F;break e}else{n(k,F);break}else e(k,F);F=F.sibling}F=RD(z,k.mode,X),F.return=k,k=F}return a(k);case xm:return J=z._init,V(k,F,J(z._payload),X)}if(Wb(z))return O(k,F,z,X);if(Jx(z))return D(k,F,z,X);xS(k,z)}return typeof z=="string"&&z!==""||typeof z=="number"?(z=""+z,F!==null&&F.tag===6?(n(k,F.sibling),F=i(F,z),F.return=k,k=F):(n(k,F),F=OD(z,k.mode,X),F.return=k,k=F),a(k)):n(k,F)}return V}var Lv=LJ(!0),DJ=LJ(!1),CE={},Fd=vA(CE),Lw=vA(CE),Dw=vA(CE);function w0(t){if(t===CE)throw Error(vn(174));return t}function Fz(t,e){switch(xo(Dw,e),xo(Lw,t),xo(Fd,CE),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:HN(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=HN(e,t)}Io(Fd),xo(Fd,e)}function Dv(){Io(Fd),Io(Lw),Io(Dw)}function BJ(t){w0(Dw.current);var e=w0(Fd.current),n=HN(e,t.type);e!==n&&(xo(Lw,t),xo(Fd,n))}function kz(t){Lw.current===t&&(Io(Fd),Io(Lw))}var Ko=vA(0);function qP(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var SD=[];function zz(){for(var t=0;t<SD.length;t++)SD[t]._workInProgressVersionPrimary=null;SD.length=0}var KT=bg.ReactCurrentDispatcher,TD=bg.ReactCurrentBatchConfig,R0=0,as=null,ra=null,xa=null,XP=!1,lw=!1,Bw=0,Sme=0;function pl(){throw Error(vn(321))}function Uz(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!xh(t[n],e[n]))return!1;return!0}function Gz(t,e,n,r,i,o){if(R0=o,as=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,KT.current=t===null||t.memoizedState===null?Ime:Mme,t=n(r,i),lw){o=0;do{if(lw=!1,Bw=0,25<=o)throw Error(vn(301));o+=1,xa=ra=null,e.updateQueue=null,KT.current=Ome,t=n(r,i)}while(lw)}if(KT.current=ZP,e=ra!==null&&ra.next!==null,R0=0,xa=ra=as=null,XP=!1,e)throw Error(vn(300));return t}function jz(){var t=Bw!==0;return Bw=0,t}function xd(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xa===null?as.memoizedState=xa=t:xa=xa.next=t,xa}function yf(){if(ra===null){var t=as.alternate;t=t!==null?t.memoizedState:null}else t=ra.next;var e=xa===null?as.memoizedState:xa.next;if(e!==null)xa=e,ra=t;else{if(t===null)throw Error(vn(310));ra=t,t={memoizedState:ra.memoizedState,baseState:ra.baseState,baseQueue:ra.baseQueue,queue:ra.queue,next:null},xa===null?as.memoizedState=xa=t:xa=xa.next=t}return xa}function Nw(t,e){return typeof e=="function"?e(t):e}function CD(t){var e=yf(),n=e.queue;if(n===null)throw Error(vn(311));n.lastRenderedReducer=t;var r=ra,i=r.baseQueue,o=n.pending;if(o!==null){if(i!==null){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(i!==null){o=i.next,r=r.baseState;var s=a=null,u=null,d=o;do{var g=d.lane;if((R0&g)===g)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var _={lane:g,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(s=u=_,a=r):u=u.next=_,as.lanes|=g,L0|=g}d=d.next}while(d!==null&&d!==o);u===null?a=r:u.next=s,xh(r,e.memoizedState)||(Eu=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do o=i.lane,as.lanes|=o,L0|=o,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function PD(t){var e=yf(),n=e.queue;if(n===null)throw Error(vn(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,o=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do o=t(o,a.action),a=a.next;while(a!==i);xh(o,e.memoizedState)||(Eu=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,r]}function NJ(){}function FJ(t,e){var n=as,r=yf(),i=e(),o=!xh(r.memoizedState,i);if(o&&(r.memoizedState=i,Eu=!0),r=r.queue,Vz(UJ.bind(null,n,r,t),[t]),r.getSnapshot!==e||o||xa!==null&&xa.memoizedState.tag&1){if(n.flags|=2048,Fw(9,zJ.bind(null,n,r,i,e),void 0,null),Pa===null)throw Error(vn(349));R0&30||kJ(n,e,i)}return i}function kJ(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=as.updateQueue,e===null?(e={lastEffect:null,stores:null},as.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function zJ(t,e,n,r){e.value=n,e.getSnapshot=r,GJ(e)&&jJ(t)}function UJ(t,e,n){return n(function(){GJ(e)&&jJ(t)})}function GJ(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!xh(t,n)}catch{return!0}}function jJ(t){var e=og(t,1);e!==null&&_h(e,t,1,-1)}function XV(t){var e=xd();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nw,lastRenderedState:t},e.queue=t,t=t.dispatch=Pme.bind(null,as,t),[e.memoizedState,t]}function Fw(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=as.updateQueue,e===null?(e={lastEffect:null,stores:null},as.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function VJ(){return yf().memoizedState}function JT(t,e,n,r){var i=xd();as.flags|=t,i.memoizedState=Fw(1|e,n,void 0,r===void 0?null:r)}function PO(t,e,n,r){var i=yf();r=r===void 0?null:r;var o=void 0;if(ra!==null){var a=ra.memoizedState;if(o=a.destroy,r!==null&&Uz(r,a.deps)){i.memoizedState=Fw(e,n,o,r);return}}as.flags|=t,i.memoizedState=Fw(1|e,n,o,r)}function ZV(t,e){return JT(8390656,8,t,e)}function Vz(t,e){return PO(2048,8,t,e)}function $J(t,e){return PO(4,2,t,e)}function HJ(t,e){return PO(4,4,t,e)}function WJ(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function qJ(t,e,n){return n=n!=null?n.concat([t]):null,PO(4,4,WJ.bind(null,e,t),n)}function $z(){}function XJ(t,e){var n=yf();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Uz(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function ZJ(t,e){var n=yf();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&Uz(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function YJ(t,e,n){return R0&21?(xh(n,e)||(n=JK(),as.lanes|=n,L0|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Eu=!0),t.memoizedState=n)}function Tme(t,e){var n=Ki;Ki=n!==0&&4>n?n:4,t(!0);var r=TD.transition;TD.transition={};try{t(!1),e()}finally{Ki=n,TD.transition=r}}function QJ(){return yf().memoizedState}function Cme(t,e,n){var r=Um(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},KJ(t))JJ(e,n);else if(n=IJ(t,e,n,r),n!==null){var i=Zl();_h(n,t,r,i),eee(n,e,r)}}function Pme(t,e,n){var r=Um(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(KJ(t))JJ(e,i);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var a=e.lastRenderedState,s=o(a,n);if(i.hasEagerState=!0,i.eagerState=s,xh(s,a)){var u=e.interleaved;u===null?(i.next=i,Bz(e)):(i.next=u.next,u.next=i),e.interleaved=i;return}}catch{}finally{}n=IJ(t,e,i,r),n!==null&&(i=Zl(),_h(n,t,r,i),eee(n,e,r))}}function KJ(t){var e=t.alternate;return t===as||e!==null&&e===as}function JJ(t,e){lw=XP=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function eee(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,xz(t,n)}}var ZP={readContext:_f,useCallback:pl,useContext:pl,useEffect:pl,useImperativeHandle:pl,useInsertionEffect:pl,useLayoutEffect:pl,useMemo:pl,useReducer:pl,useRef:pl,useState:pl,useDebugValue:pl,useDeferredValue:pl,useTransition:pl,useMutableSource:pl,useSyncExternalStore:pl,useId:pl,unstable_isNewReconciler:!1},Ime={readContext:_f,useCallback:function(t,e){return xd().memoizedState=[t,e===void 0?null:e],t},useContext:_f,useEffect:ZV,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,JT(4194308,4,WJ.bind(null,e,t),n)},useLayoutEffect:function(t,e){return JT(4194308,4,t,e)},useInsertionEffect:function(t,e){return JT(4,2,t,e)},useMemo:function(t,e){var n=xd();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=xd();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Cme.bind(null,as,t),[r.memoizedState,t]},useRef:function(t){var e=xd();return t={current:t},e.memoizedState=t},useState:XV,useDebugValue:$z,useDeferredValue:function(t){return xd().memoizedState=t},useTransition:function(){var t=XV(!1),e=t[0];return t=Tme.bind(null,t[1]),xd().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=as,i=xd();if(ko){if(n===void 0)throw Error(vn(407));n=n()}else{if(n=e(),Pa===null)throw Error(vn(349));R0&30||kJ(r,e,n)}i.memoizedState=n;var o={value:n,getSnapshot:e};return i.queue=o,ZV(UJ.bind(null,r,o,t),[t]),r.flags|=2048,Fw(9,zJ.bind(null,r,o,n,e),void 0,null),n},useId:function(){var t=xd(),e=Pa.identifierPrefix;if(ko){var n=Xp,r=qp;n=(r&~(1<<32-Ah(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Bw++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Sme++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},Mme={readContext:_f,useCallback:XJ,useContext:_f,useEffect:Vz,useImperativeHandle:qJ,useInsertionEffect:$J,useLayoutEffect:HJ,useMemo:ZJ,useReducer:CD,useRef:VJ,useState:function(){return CD(Nw)},useDebugValue:$z,useDeferredValue:function(t){var e=yf();return YJ(e,ra.memoizedState,t)},useTransition:function(){var t=CD(Nw)[0],e=yf().memoizedState;return[t,e]},useMutableSource:NJ,useSyncExternalStore:FJ,useId:QJ,unstable_isNewReconciler:!1},Ome={readContext:_f,useCallback:XJ,useContext:_f,useEffect:Vz,useImperativeHandle:qJ,useInsertionEffect:$J,useLayoutEffect:HJ,useMemo:ZJ,useReducer:PD,useRef:VJ,useState:function(){return PD(Nw)},useDebugValue:$z,useDeferredValue:function(t){var e=yf();return ra===null?e.memoizedState=t:YJ(e,ra.memoizedState,t)},useTransition:function(){var t=PD(Nw)[0],e=yf().memoizedState;return[t,e]},useMutableSource:NJ,useSyncExternalStore:FJ,useId:QJ,unstable_isNewReconciler:!1};function Bv(t,e){try{var n="",r=e;do n+=oge(r),r=r.return;while(r);var i=n}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:i,digest:null}}function ID(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function pF(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var Rme=typeof WeakMap=="function"?WeakMap:Map;function tee(t,e,n){n=Qp(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){QP||(QP=!0,EF=r),pF(t,e)},n}function nee(t,e,n){n=Qp(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){pF(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){pF(t,e),typeof r!="function"&&(zm===null?zm=new Set([this]):zm.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function YV(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new Rme;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=Wme.bind(null,t,e,n),e.then(t,t))}function QV(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function KV(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Qp(-1,1),e.tag=2,km(n,e,1))),n.lanes|=1),t)}var Lme=bg.ReactCurrentOwner,Eu=!1;function Hl(t,e,n,r){e.child=t===null?DJ(e,null,n,r):Lv(e,t.child,n,r)}function JV(t,e,n,r,i){n=n.render;var o=e.ref;return Av(e,i),r=Gz(t,e,n,r,o,i),n=jz(),t!==null&&!Eu?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,sg(t,e,i)):(ko&&n&&Iz(e),e.flags|=1,Hl(t,e,r,i),e.child)}function e9(t,e,n,r,i){if(t===null){var o=n.type;return typeof o=="function"&&!Kz(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,ree(t,e,o,r,i)):(t=rC(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&i)){var a=o.memoizedProps;if(n=n.compare,n=n!==null?n:Iw,n(a,r)&&t.ref===e.ref)return sg(t,e,i)}return e.flags|=1,t=Gm(o,r),t.ref=e.ref,t.return=e,e.child=t}function ree(t,e,n,r,i){if(t!==null){var o=t.memoizedProps;if(Iw(o,r)&&t.ref===e.ref)if(Eu=!1,e.pendingProps=r=o,(t.lanes&i)!==0)t.flags&131072&&(Eu=!0);else return e.lanes=t.lanes,sg(t,e,i)}return gF(t,e,n,r,i)}function iee(t,e,n){var r=e.pendingProps,i=r.children,o=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},xo(tv,sc),sc|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,xo(tv,sc),sc|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:n,xo(tv,sc),sc|=r}else o!==null?(r=o.baseLanes|n,e.memoizedState=null):r=n,xo(tv,sc),sc|=r;return Hl(t,e,i,n),e.child}function oee(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function gF(t,e,n,r,i){var o=Pu(n)?M0:Cl.current;return o=Ov(e,o),Av(e,i),n=Gz(t,e,n,r,o,i),r=jz(),t!==null&&!Eu?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,sg(t,e,i)):(ko&&r&&Iz(e),e.flags|=1,Hl(t,e,n,i),e.child)}function t9(t,e,n,r,i){if(Pu(n)){var o=!0;GP(e)}else o=!1;if(Av(e,i),e.stateNode===null)eC(t,e),RJ(e,n,r),dF(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,s=e.memoizedProps;a.props=s;var u=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=_f(d):(d=Pu(n)?M0:Cl.current,d=Ov(e,d));var g=n.getDerivedStateFromProps,_=typeof g=="function"||typeof a.getSnapshotBeforeUpdate=="function";_||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==r||u!==d)&&WV(e,a,r,d),bm=!1;var E=e.memoizedState;a.state=E,WP(e,r,a,i),u=e.memoizedState,s!==r||E!==u||Cu.current||bm?(typeof g=="function"&&(hF(e,n,g,r),u=e.memoizedState),(s=bm||HV(e,n,s,r,E,u,d))?(_||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=d,r=s):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,MJ(t,e),s=e.memoizedProps,d=e.type===e.elementType?s:sh(e.type,s),a.props=d,_=e.pendingProps,E=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=_f(u):(u=Pu(n)?M0:Cl.current,u=Ov(e,u));var P=n.getDerivedStateFromProps;(g=typeof P=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(s!==_||E!==u)&&WV(e,a,r,u),bm=!1,E=e.memoizedState,a.state=E,WP(e,r,a,i);var O=e.memoizedState;s!==_||E!==O||Cu.current||bm?(typeof P=="function"&&(hF(e,n,P,r),O=e.memoizedState),(d=bm||HV(e,n,d,r,E,O,u)||!1)?(g||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,O,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,O,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&E===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&E===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=O),a.props=r,a.state=O,a.context=u,r=d):(typeof a.componentDidUpdate!="function"||s===t.memoizedProps&&E===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||s===t.memoizedProps&&E===t.memoizedState||(e.flags|=1024),r=!1)}return mF(t,e,n,r,o,i)}function mF(t,e,n,r,i,o){oee(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&UV(e,n,!1),sg(t,e,o);r=e.stateNode,Lme.current=e;var s=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Lv(e,t.child,null,o),e.child=Lv(e,null,s,o)):Hl(t,e,s,o),e.memoizedState=r.state,i&&UV(e,n,!0),e.child}function see(t){var e=t.stateNode;e.pendingContext?zV(t,e.pendingContext,e.pendingContext!==e.context):e.context&&zV(t,e.context,!1),Fz(t,e.containerInfo)}function n9(t,e,n,r,i){return Rv(),Oz(i),e.flags|=256,Hl(t,e,n,r),e.child}var AF={dehydrated:null,treeContext:null,retryLane:0};function _F(t){return{baseLanes:t,cachePool:null,transitions:null}}function aee(t,e,n){var r=e.pendingProps,i=Ko.current,o=!1,a=(e.flags&128)!==0,s;if((s=a)||(s=t!==null&&t.memoizedState===null?!1:(i&2)!==0),s?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),xo(Ko,i&1),t===null)return cF(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,o?(r=e.mode,o=e.child,a={mode:"hidden",children:a},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=a):o=OO(a,r,0,null),t=P0(t,r,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=_F(n),e.memoizedState=AF,t):Hz(e,a));if(i=t.memoizedState,i!==null&&(s=i.dehydrated,s!==null))return Dme(t,e,a,r,s,i,n);if(o){o=r.fallback,a=e.mode,i=t.child,s=i.sibling;var u={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=Gm(i,u),r.subtreeFlags=i.subtreeFlags&14680064),s!==null?o=Gm(s,o):(o=P0(o,a,n,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,a=t.child.memoizedState,a=a===null?_F(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},o.memoizedState=a,o.childLanes=t.childLanes&~n,e.memoizedState=AF,r}return o=t.child,t=o.sibling,r=Gm(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Hz(t,e){return e=OO({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function bS(t,e,n,r){return r!==null&&Oz(r),Lv(e,t.child,null,n),t=Hz(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function Dme(t,e,n,r,i,o,a){if(n)return e.flags&256?(e.flags&=-257,r=ID(Error(vn(422))),bS(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=OO({mode:"visible",children:r.children},i,0,null),o=P0(o,i,a,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&Lv(e,t.child,null,a),e.child.memoizedState=_F(a),e.memoizedState=AF,o);if(!(e.mode&1))return bS(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var s=r.dgst;return r=s,o=Error(vn(419)),r=ID(o,r,void 0),bS(t,e,a,r)}if(s=(a&t.childLanes)!==0,Eu||s){if(r=Pa,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,og(t,i),_h(r,t,i,-1))}return Qz(),r=ID(Error(vn(421))),bS(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=qme.bind(null,t),i._reactRetry=e,null):(t=o.treeContext,lc=Fm(i.nextSibling),hc=e,ko=!0,lh=null,t!==null&&(af[lf++]=qp,af[lf++]=Xp,af[lf++]=O0,qp=t.id,Xp=t.overflow,O0=e),e=Hz(e,r.children),e.flags|=4096,e)}function r9(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),fF(t.return,e,n)}function MD(t,e,n,r,i){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=i)}function lee(t,e,n){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Hl(t,e,r.children,n),r=Ko.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&r9(t,n,e);else if(t.tag===19)r9(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(xo(Ko,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&qP(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),MD(e,!1,i,n,o);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&qP(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}MD(e,!0,n,null,o);break;case"together":MD(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function eC(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function sg(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),L0|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(vn(153));if(e.child!==null){for(t=e.child,n=Gm(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Gm(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function Bme(t,e,n){switch(e.tag){case 3:see(e),Rv();break;case 5:BJ(e);break;case 1:Pu(e.type)&&GP(e);break;case 4:Fz(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;xo($P,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(xo(Ko,Ko.current&1),e.flags|=128,null):n&e.child.childLanes?aee(t,e,n):(xo(Ko,Ko.current&1),t=sg(t,e,n),t!==null?t.sibling:null);xo(Ko,Ko.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return lee(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),xo(Ko,Ko.current),r)break;return null;case 22:case 23:return e.lanes=0,iee(t,e,n)}return sg(t,e,n)}var uee,yF,cee,fee;uee=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};yF=function(){};cee=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,w0(Fd.current);var o=null;switch(n){case"input":i=GN(t,i),r=GN(t,r),o=[];break;case"select":i=ls({},i,{value:void 0}),r=ls({},r,{value:void 0}),o=[];break;case"textarea":i=$N(t,i),r=$N(t,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=zP)}WN(n,r);var a;n=null;for(d in i)if(!r.hasOwnProperty(d)&&i.hasOwnProperty(d)&&i[d]!=null)if(d==="style"){var s=i[d];for(a in s)s.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(bw.hasOwnProperty(d)?o||(o=[]):(o=o||[]).push(d,null));for(d in r){var u=r[d];if(s=i!=null?i[d]:void 0,r.hasOwnProperty(d)&&u!==s&&(u!=null||s!=null))if(d==="style")if(s){for(a in s)!s.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&s[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(o||(o=[]),o.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,s=s?s.__html:void 0,u!=null&&s!==u&&(o=o||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(o=o||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(bw.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Po("scroll",t),o||s===u||(o=[])):(o=o||[]).push(d,u))}n&&(o=o||[]).push("style",n);var d=o;(e.updateQueue=d)&&(e.flags|=4)}};fee=function(t,e,n,r){n!==r&&(e.flags|=4)};function ob(t,e){if(!ko)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function gl(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function Nme(t,e,n){var r=e.pendingProps;switch(Mz(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return gl(e),null;case 1:return Pu(e.type)&&UP(),gl(e),null;case 3:return r=e.stateNode,Dv(),Io(Cu),Io(Cl),zz(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(vS(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,lh!==null&&(CF(lh),lh=null))),yF(t,e),gl(e),null;case 5:kz(e);var i=w0(Dw.current);if(n=e.type,t!==null&&e.stateNode!=null)cee(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(vn(166));return gl(e),null}if(t=w0(Fd.current),vS(e)){r=e.stateNode,n=e.type;var o=e.memoizedProps;switch(r[Pd]=e,r[Rw]=o,t=(e.mode&1)!==0,n){case"dialog":Po("cancel",r),Po("close",r);break;case"iframe":case"object":case"embed":Po("load",r);break;case"video":case"audio":for(i=0;i<Xb.length;i++)Po(Xb[i],r);break;case"source":Po("error",r);break;case"img":case"image":case"link":Po("error",r),Po("load",r);break;case"details":Po("toggle",r);break;case"input":hV(r,o),Po("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Po("invalid",r);break;case"textarea":pV(r,o),Po("invalid",r)}WN(n,o),i=null;for(var a in o)if(o.hasOwnProperty(a)){var s=o[a];a==="children"?typeof s=="string"?r.textContent!==s&&(o.suppressHydrationWarning!==!0&&yS(r.textContent,s,t),i=["children",s]):typeof s=="number"&&r.textContent!==""+s&&(o.suppressHydrationWarning!==!0&&yS(r.textContent,s,t),i=["children",""+s]):bw.hasOwnProperty(a)&&s!=null&&a==="onScroll"&&Po("scroll",r)}switch(n){case"input":fS(r),dV(r,o,!0);break;case"textarea":fS(r),gV(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=zP)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=kK(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Pd]=e,t[Rw]=r,uee(t,e,!1,!1),e.stateNode=t;e:{switch(a=qN(n,r),n){case"dialog":Po("cancel",t),Po("close",t),i=r;break;case"iframe":case"object":case"embed":Po("load",t),i=r;break;case"video":case"audio":for(i=0;i<Xb.length;i++)Po(Xb[i],t);i=r;break;case"source":Po("error",t),i=r;break;case"img":case"image":case"link":Po("error",t),Po("load",t),i=r;break;case"details":Po("toggle",t),i=r;break;case"input":hV(t,r),i=GN(t,r),Po("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=ls({},r,{value:void 0}),Po("invalid",t);break;case"textarea":pV(t,r),i=$N(t,r),Po("invalid",t);break;default:i=r}WN(n,i),s=i;for(o in s)if(s.hasOwnProperty(o)){var u=s[o];o==="style"?GK(t,u):o==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&zK(t,u)):o==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&ww(t,u):typeof u=="number"&&ww(t,""+u):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(bw.hasOwnProperty(o)?u!=null&&o==="onScroll"&&Po("scroll",t):u!=null&&gz(t,o,u,a))}switch(n){case"input":fS(t),dV(t,r,!1);break;case"textarea":fS(t),gV(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Zm(r.value));break;case"select":t.multiple=!!r.multiple,o=r.value,o!=null?dv(t,!!r.multiple,o,!1):r.defaultValue!=null&&dv(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=zP)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return gl(e),null;case 6:if(t&&e.stateNode!=null)fee(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(vn(166));if(n=w0(Dw.current),w0(Fd.current),vS(e)){if(r=e.stateNode,n=e.memoizedProps,r[Pd]=e,(o=r.nodeValue!==n)&&(t=hc,t!==null))switch(t.tag){case 3:yS(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&yS(r.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Pd]=e,e.stateNode=r}return gl(e),null;case 13:if(Io(Ko),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ko&&lc!==null&&e.mode&1&&!(e.flags&128))PJ(),Rv(),e.flags|=98560,o=!1;else if(o=vS(e),r!==null&&r.dehydrated!==null){if(t===null){if(!o)throw Error(vn(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(vn(317));o[Pd]=e}else Rv(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;gl(e),o=!1}else lh!==null&&(CF(lh),lh=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ko.current&1?oa===0&&(oa=3):Qz())),e.updateQueue!==null&&(e.flags|=4),gl(e),null);case 4:return Dv(),yF(t,e),t===null&&Mw(e.stateNode.containerInfo),gl(e),null;case 10:return Dz(e.type._context),gl(e),null;case 17:return Pu(e.type)&&UP(),gl(e),null;case 19:if(Io(Ko),o=e.memoizedState,o===null)return gl(e),null;if(r=(e.flags&128)!==0,a=o.rendering,a===null)if(r)ob(o,!1);else{if(oa!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=qP(t),a!==null){for(e.flags|=128,ob(o,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)o=n,t=r,o.flags&=14680066,a=o.alternate,a===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=a.childLanes,o.lanes=a.lanes,o.child=a.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=a.memoizedProps,o.memoizedState=a.memoizedState,o.updateQueue=a.updateQueue,o.type=a.type,t=a.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return xo(Ko,Ko.current&1|2),e.child}t=t.sibling}o.tail!==null&&Ss()>Nv&&(e.flags|=128,r=!0,ob(o,!1),e.lanes=4194304)}else{if(!r)if(t=qP(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ob(o,!0),o.tail===null&&o.tailMode==="hidden"&&!a.alternate&&!ko)return gl(e),null}else 2*Ss()-o.renderingStartTime>Nv&&n!==1073741824&&(e.flags|=128,r=!0,ob(o,!1),e.lanes=4194304);o.isBackwards?(a.sibling=e.child,e.child=a):(n=o.last,n!==null?n.sibling=a:e.child=a,o.last=a)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=Ss(),e.sibling=null,n=Ko.current,xo(Ko,r?n&1|2:n&1),e):(gl(e),null);case 22:case 23:return Yz(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?sc&1073741824&&(gl(e),e.subtreeFlags&6&&(e.flags|=8192)):gl(e),null;case 24:return null;case 25:return null}throw Error(vn(156,e.tag))}function Fme(t,e){switch(Mz(e),e.tag){case 1:return Pu(e.type)&&UP(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Dv(),Io(Cu),Io(Cl),zz(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return kz(e),null;case 13:if(Io(Ko),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(vn(340));Rv()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Io(Ko),null;case 4:return Dv(),null;case 10:return Dz(e.type._context),null;case 22:case 23:return Yz(),null;case 24:return null;default:return null}}var wS=!1,xl=!1,kme=typeof WeakSet=="function"?WeakSet:Set,Zn=null;function ev(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){As(t,e,r)}else n.current=null}function vF(t,e,n){try{n()}catch(r){As(t,e,r)}}var i9=!1;function zme(t,e){if(rF=NP,t=gJ(),Pz(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var a=0,s=-1,u=-1,d=0,g=0,_=t,E=null;t:for(;;){for(var P;_!==n||i!==0&&_.nodeType!==3||(s=a+i),_!==o||r!==0&&_.nodeType!==3||(u=a+r),_.nodeType===3&&(a+=_.nodeValue.length),(P=_.firstChild)!==null;)E=_,_=P;for(;;){if(_===t)break t;if(E===n&&++d===i&&(s=a),E===o&&++g===r&&(u=a),(P=_.nextSibling)!==null)break;_=E,E=_.parentNode}_=P}n=s===-1||u===-1?null:{start:s,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(iF={focusedElem:t,selectionRange:n},NP=!1,Zn=e;Zn!==null;)if(e=Zn,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Zn=t;else for(;Zn!==null;){e=Zn;try{var O=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(O!==null){var D=O.memoizedProps,V=O.memoizedState,k=e.stateNode,F=k.getSnapshotBeforeUpdate(e.elementType===e.type?D:sh(e.type,D),V);k.__reactInternalSnapshotBeforeUpdate=F}break;case 3:var z=e.stateNode.containerInfo;z.nodeType===1?z.textContent="":z.nodeType===9&&z.documentElement&&z.removeChild(z.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(vn(163))}}catch(X){As(e,e.return,X)}if(t=e.sibling,t!==null){t.return=e.return,Zn=t;break}Zn=e.return}return O=i9,i9=!1,O}function uw(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var o=i.destroy;i.destroy=void 0,o!==void 0&&vF(e,n,o)}i=i.next}while(i!==r)}}function IO(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function xF(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function hee(t){var e=t.alternate;e!==null&&(t.alternate=null,hee(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Pd],delete e[Rw],delete e[aF],delete e[xme],delete e[bme])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function dee(t){return t.tag===5||t.tag===3||t.tag===4}function o9(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||dee(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function bF(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=zP));else if(r!==4&&(t=t.child,t!==null))for(bF(t,e,n),t=t.sibling;t!==null;)bF(t,e,n),t=t.sibling}function wF(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(wF(t,e,n),t=t.sibling;t!==null;)wF(t,e,n),t=t.sibling}var $a=null,ah=!1;function am(t,e,n){for(n=n.child;n!==null;)pee(t,e,n),n=n.sibling}function pee(t,e,n){if(Nd&&typeof Nd.onCommitFiberUnmount=="function")try{Nd.onCommitFiberUnmount(xO,n)}catch{}switch(n.tag){case 5:xl||ev(n,e);case 6:var r=$a,i=ah;$a=null,am(t,e,n),$a=r,ah=i,$a!==null&&(ah?(t=$a,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):$a.removeChild(n.stateNode));break;case 18:$a!==null&&(ah?(t=$a,n=n.stateNode,t.nodeType===8?wD(t.parentNode,n):t.nodeType===1&&wD(t,n),Cw(t)):wD($a,n.stateNode));break;case 4:r=$a,i=ah,$a=n.stateNode.containerInfo,ah=!0,am(t,e,n),$a=r,ah=i;break;case 0:case 11:case 14:case 15:if(!xl&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,a=o.destroy;o=o.tag,a!==void 0&&(o&2||o&4)&&vF(n,e,a),i=i.next}while(i!==r)}am(t,e,n);break;case 1:if(!xl&&(ev(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){As(n,e,s)}am(t,e,n);break;case 21:am(t,e,n);break;case 22:n.mode&1?(xl=(r=xl)||n.memoizedState!==null,am(t,e,n),xl=r):am(t,e,n);break;default:am(t,e,n)}}function s9(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new kme),e.forEach(function(r){var i=Xme.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function rh(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var o=t,a=e,s=a;e:for(;s!==null;){switch(s.tag){case 5:$a=s.stateNode,ah=!1;break e;case 3:$a=s.stateNode.containerInfo,ah=!0;break e;case 4:$a=s.stateNode.containerInfo,ah=!0;break e}s=s.return}if($a===null)throw Error(vn(160));pee(o,a,i),$a=null,ah=!1;var u=i.alternate;u!==null&&(u.return=null),i.return=null}catch(d){As(i,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)gee(e,t),e=e.sibling}function gee(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(rh(e,t),fd(t),r&4){try{uw(3,t,t.return),IO(3,t)}catch(D){As(t,t.return,D)}try{uw(5,t,t.return)}catch(D){As(t,t.return,D)}}break;case 1:rh(e,t),fd(t),r&512&&n!==null&&ev(n,n.return);break;case 5:if(rh(e,t),fd(t),r&512&&n!==null&&ev(n,n.return),t.flags&32){var i=t.stateNode;try{ww(i,"")}catch(D){As(t,t.return,D)}}if(r&4&&(i=t.stateNode,i!=null)){var o=t.memoizedProps,a=n!==null?n.memoizedProps:o,s=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{s==="input"&&o.type==="radio"&&o.name!=null&&NK(i,o),qN(s,a);var d=qN(s,o);for(a=0;a<u.length;a+=2){var g=u[a],_=u[a+1];g==="style"?GK(i,_):g==="dangerouslySetInnerHTML"?zK(i,_):g==="children"?ww(i,_):gz(i,g,_,d)}switch(s){case"input":jN(i,o);break;case"textarea":FK(i,o);break;case"select":var E=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var P=o.value;P!=null?dv(i,!!o.multiple,P,!1):E!==!!o.multiple&&(o.defaultValue!=null?dv(i,!!o.multiple,o.defaultValue,!0):dv(i,!!o.multiple,o.multiple?[]:"",!1))}i[Rw]=o}catch(D){As(t,t.return,D)}}break;case 6:if(rh(e,t),fd(t),r&4){if(t.stateNode===null)throw Error(vn(162));i=t.stateNode,o=t.memoizedProps;try{i.nodeValue=o}catch(D){As(t,t.return,D)}}break;case 3:if(rh(e,t),fd(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Cw(e.containerInfo)}catch(D){As(t,t.return,D)}break;case 4:rh(e,t),fd(t);break;case 13:rh(e,t),fd(t),i=t.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(Xz=Ss())),r&4&&s9(t);break;case 22:if(g=n!==null&&n.memoizedState!==null,t.mode&1?(xl=(d=xl)||g,rh(e,t),xl=d):rh(e,t),fd(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!g&&t.mode&1)for(Zn=t,g=t.child;g!==null;){for(_=Zn=g;Zn!==null;){switch(E=Zn,P=E.child,E.tag){case 0:case 11:case 14:case 15:uw(4,E,E.return);break;case 1:ev(E,E.return);var O=E.stateNode;if(typeof O.componentWillUnmount=="function"){r=E,n=E.return;try{e=r,O.props=e.memoizedProps,O.state=e.memoizedState,O.componentWillUnmount()}catch(D){As(r,n,D)}}break;case 5:ev(E,E.return);break;case 22:if(E.memoizedState!==null){l9(_);continue}}P!==null?(P.return=E,Zn=P):l9(_)}g=g.sibling}e:for(g=null,_=t;;){if(_.tag===5){if(g===null){g=_;try{i=_.stateNode,d?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(s=_.stateNode,u=_.memoizedProps.style,a=u!=null&&u.hasOwnProperty("display")?u.display:null,s.style.display=UK("display",a))}catch(D){As(t,t.return,D)}}}else if(_.tag===6){if(g===null)try{_.stateNode.nodeValue=d?"":_.memoizedProps}catch(D){As(t,t.return,D)}}else if((_.tag!==22&&_.tag!==23||_.memoizedState===null||_===t)&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===t)break e;for(;_.sibling===null;){if(_.return===null||_.return===t)break e;g===_&&(g=null),_=_.return}g===_&&(g=null),_.sibling.return=_.return,_=_.sibling}}break;case 19:rh(e,t),fd(t),r&4&&s9(t);break;case 21:break;default:rh(e,t),fd(t)}}function fd(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(dee(n)){var r=n;break e}n=n.return}throw Error(vn(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ww(i,""),r.flags&=-33);var o=o9(t);wF(t,o,i);break;case 3:case 4:var a=r.stateNode.containerInfo,s=o9(t);bF(t,s,a);break;default:throw Error(vn(161))}}catch(u){As(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function Ume(t,e,n){Zn=t,mee(t)}function mee(t,e,n){for(var r=(t.mode&1)!==0;Zn!==null;){var i=Zn,o=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||wS;if(!a){var s=i.alternate,u=s!==null&&s.memoizedState!==null||xl;s=wS;var d=xl;if(wS=a,(xl=u)&&!d)for(Zn=i;Zn!==null;)a=Zn,u=a.child,a.tag===22&&a.memoizedState!==null?u9(i):u!==null?(u.return=a,Zn=u):u9(i);for(;o!==null;)Zn=o,mee(o),o=o.sibling;Zn=i,wS=s,xl=d}a9(t)}else i.subtreeFlags&8772&&o!==null?(o.return=i,Zn=o):a9(t)}}function a9(t){for(;Zn!==null;){var e=Zn;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:xl||IO(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!xl)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:sh(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&$V(e,o,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}$V(e,a,n)}break;case 5:var s=e.stateNode;if(n===null&&e.flags&4){n=s;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var g=d.memoizedState;if(g!==null){var _=g.dehydrated;_!==null&&Cw(_)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(vn(163))}xl||e.flags&512&&xF(e)}catch(E){As(e,e.return,E)}}if(e===t){Zn=null;break}if(n=e.sibling,n!==null){n.return=e.return,Zn=n;break}Zn=e.return}}function l9(t){for(;Zn!==null;){var e=Zn;if(e===t){Zn=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Zn=n;break}Zn=e.return}}function u9(t){for(;Zn!==null;){var e=Zn;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{IO(4,e)}catch(u){As(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(u){As(e,i,u)}}var o=e.return;try{xF(e)}catch(u){As(e,o,u)}break;case 5:var a=e.return;try{xF(e)}catch(u){As(e,a,u)}}}catch(u){As(e,e.return,u)}if(e===t){Zn=null;break}var s=e.sibling;if(s!==null){s.return=e.return,Zn=s;break}Zn=e.return}}var Gme=Math.ceil,YP=bg.ReactCurrentDispatcher,Wz=bg.ReactCurrentOwner,pf=bg.ReactCurrentBatchConfig,vi=0,Pa=null,Vs=null,Qa=0,sc=0,tv=vA(0),oa=0,kw=null,L0=0,MO=0,qz=0,cw=null,bu=null,Xz=0,Nv=1/0,Gp=null,QP=!1,EF=null,zm=null,ES=!1,Pm=null,KP=0,fw=0,SF=null,tC=-1,nC=0;function Zl(){return vi&6?Ss():tC!==-1?tC:tC=Ss()}function Um(t){return t.mode&1?vi&2&&Qa!==0?Qa&-Qa:Eme.transition!==null?(nC===0&&(nC=JK()),nC):(t=Ki,t!==0||(t=window.event,t=t===void 0?16:sJ(t.type)),t):1}function _h(t,e,n,r){if(50<fw)throw fw=0,SF=null,Error(vn(185));EE(t,n,r),(!(vi&2)||t!==Pa)&&(t===Pa&&(!(vi&2)&&(MO|=n),oa===4&&Sm(t,Qa)),Iu(t,r),n===1&&vi===0&&!(e.mode&1)&&(Nv=Ss()+500,TO&&xA()))}function Iu(t,e){var n=t.callbackNode;Ege(t,e);var r=BP(t,t===Pa?Qa:0);if(r===0)n!==null&&_V(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&_V(n),e===1)t.tag===0?wme(c9.bind(null,t)):SJ(c9.bind(null,t)),yme(function(){!(vi&6)&&xA()}),n=null;else{switch(eJ(r)){case 1:n=vz;break;case 4:n=QK;break;case 16:n=DP;break;case 536870912:n=KK;break;default:n=DP}n=Eee(n,Aee.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function Aee(t,e){if(tC=-1,nC=0,vi&6)throw Error(vn(327));var n=t.callbackNode;if(_v()&&t.callbackNode!==n)return null;var r=BP(t,t===Pa?Qa:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=JP(t,r);else{e=r;var i=vi;vi|=2;var o=yee();(Pa!==t||Qa!==e)&&(Gp=null,Nv=Ss()+500,C0(t,e));do try{$me();break}catch(s){_ee(t,s)}while(1);Lz(),YP.current=o,vi=i,Vs!==null?e=0:(Pa=null,Qa=0,e=oa)}if(e!==0){if(e===2&&(i=KN(t),i!==0&&(r=i,e=TF(t,i))),e===1)throw n=kw,C0(t,0),Sm(t,r),Iu(t,Ss()),n;if(e===6)Sm(t,r);else{if(i=t.current.alternate,!(r&30)&&!jme(i)&&(e=JP(t,r),e===2&&(o=KN(t),o!==0&&(r=o,e=TF(t,o))),e===1))throw n=kw,C0(t,0),Sm(t,r),Iu(t,Ss()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(vn(345));case 2:_0(t,bu,Gp);break;case 3:if(Sm(t,r),(r&130023424)===r&&(e=Xz+500-Ss(),10<e)){if(BP(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Zl(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=sF(_0.bind(null,t,bu,Gp),e);break}_0(t,bu,Gp);break;case 4:if(Sm(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-Ah(r);o=1<<a,a=e[a],a>i&&(i=a),r&=~o}if(r=i,r=Ss()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Gme(r/1960))-r,10<r){t.timeoutHandle=sF(_0.bind(null,t,bu,Gp),r);break}_0(t,bu,Gp);break;case 5:_0(t,bu,Gp);break;default:throw Error(vn(329))}}}return Iu(t,Ss()),t.callbackNode===n?Aee.bind(null,t):null}function TF(t,e){var n=cw;return t.current.memoizedState.isDehydrated&&(C0(t,e).flags|=256),t=JP(t,e),t!==2&&(e=bu,bu=n,e!==null&&CF(e)),t}function CF(t){bu===null?bu=t:bu.push.apply(bu,t)}function jme(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],o=i.getSnapshot;i=i.value;try{if(!xh(o(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Sm(t,e){for(e&=~qz,e&=~MO,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ah(e),r=1<<n;t[n]=-1,e&=~r}}function c9(t){if(vi&6)throw Error(vn(327));_v();var e=BP(t,0);if(!(e&1))return Iu(t,Ss()),null;var n=JP(t,e);if(t.tag!==0&&n===2){var r=KN(t);r!==0&&(e=r,n=TF(t,r))}if(n===1)throw n=kw,C0(t,0),Sm(t,e),Iu(t,Ss()),n;if(n===6)throw Error(vn(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,_0(t,bu,Gp),Iu(t,Ss()),null}function Zz(t,e){var n=vi;vi|=1;try{return t(e)}finally{vi=n,vi===0&&(Nv=Ss()+500,TO&&xA())}}function D0(t){Pm!==null&&Pm.tag===0&&!(vi&6)&&_v();var e=vi;vi|=1;var n=pf.transition,r=Ki;try{if(pf.transition=null,Ki=1,t)return t()}finally{Ki=r,pf.transition=n,vi=e,!(vi&6)&&xA()}}function Yz(){sc=tv.current,Io(tv)}function C0(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,_me(n)),Vs!==null)for(n=Vs.return;n!==null;){var r=n;switch(Mz(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&UP();break;case 3:Dv(),Io(Cu),Io(Cl),zz();break;case 5:kz(r);break;case 4:Dv();break;case 13:Io(Ko);break;case 19:Io(Ko);break;case 10:Dz(r.type._context);break;case 22:case 23:Yz()}n=n.return}if(Pa=t,Vs=t=Gm(t.current,null),Qa=sc=e,oa=0,kw=null,qz=MO=L0=0,bu=cw=null,b0!==null){for(e=0;e<b0.length;e++)if(n=b0[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,o=n.pending;if(o!==null){var a=o.next;o.next=i,r.next=a}n.pending=r}b0=null}return t}function _ee(t,e){do{var n=Vs;try{if(Lz(),KT.current=ZP,XP){for(var r=as.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}XP=!1}if(R0=0,xa=ra=as=null,lw=!1,Bw=0,Wz.current=null,n===null||n.return===null){oa=1,kw=e,Vs=null;break}e:{var o=t,a=n.return,s=n,u=e;if(e=Qa,s.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,g=s,_=g.tag;if(!(g.mode&1)&&(_===0||_===11||_===15)){var E=g.alternate;E?(g.updateQueue=E.updateQueue,g.memoizedState=E.memoizedState,g.lanes=E.lanes):(g.updateQueue=null,g.memoizedState=null)}var P=QV(a);if(P!==null){P.flags&=-257,KV(P,a,s,o,e),P.mode&1&&YV(o,d,e),e=P,u=d;var O=e.updateQueue;if(O===null){var D=new Set;D.add(u),e.updateQueue=D}else O.add(u);break e}else{if(!(e&1)){YV(o,d,e),Qz();break e}u=Error(vn(426))}}else if(ko&&s.mode&1){var V=QV(a);if(V!==null){!(V.flags&65536)&&(V.flags|=256),KV(V,a,s,o,e),Oz(Bv(u,s));break e}}o=u=Bv(u,s),oa!==4&&(oa=2),cw===null?cw=[o]:cw.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var k=tee(o,u,e);VV(o,k);break e;case 1:s=u;var F=o.type,z=o.stateNode;if(!(o.flags&128)&&(typeof F.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(zm===null||!zm.has(z)))){o.flags|=65536,e&=-e,o.lanes|=e;var X=nee(o,s,e);VV(o,X);break e}}o=o.return}while(o!==null)}xee(n)}catch(Y){e=Y,Vs===n&&n!==null&&(Vs=n=n.return);continue}break}while(1)}function yee(){var t=YP.current;return YP.current=ZP,t===null?ZP:t}function Qz(){(oa===0||oa===3||oa===2)&&(oa=4),Pa===null||!(L0&268435455)&&!(MO&268435455)||Sm(Pa,Qa)}function JP(t,e){var n=vi;vi|=2;var r=yee();(Pa!==t||Qa!==e)&&(Gp=null,C0(t,e));do try{Vme();break}catch(i){_ee(t,i)}while(1);if(Lz(),vi=n,YP.current=r,Vs!==null)throw Error(vn(261));return Pa=null,Qa=0,oa}function Vme(){for(;Vs!==null;)vee(Vs)}function $me(){for(;Vs!==null&&!gge();)vee(Vs)}function vee(t){var e=wee(t.alternate,t,sc);t.memoizedProps=t.pendingProps,e===null?xee(t):Vs=e,Wz.current=null}function xee(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=Fme(n,e),n!==null){n.flags&=32767,Vs=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{oa=6,Vs=null;return}}else if(n=Nme(n,e,sc),n!==null){Vs=n;return}if(e=e.sibling,e!==null){Vs=e;return}Vs=e=t}while(e!==null);oa===0&&(oa=5)}function _0(t,e,n){var r=Ki,i=pf.transition;try{pf.transition=null,Ki=1,Hme(t,e,n,r)}finally{pf.transition=i,Ki=r}return null}function Hme(t,e,n,r){do _v();while(Pm!==null);if(vi&6)throw Error(vn(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(vn(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(Sge(t,o),t===Pa&&(Vs=Pa=null,Qa=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ES||(ES=!0,Eee(DP,function(){return _v(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=pf.transition,pf.transition=null;var a=Ki;Ki=1;var s=vi;vi|=4,Wz.current=null,zme(t,n),gee(n,t),fme(iF),NP=!!rF,iF=rF=null,t.current=n,Ume(n),mge(),vi=s,Ki=a,pf.transition=o}else t.current=n;if(ES&&(ES=!1,Pm=t,KP=i),o=t.pendingLanes,o===0&&(zm=null),yge(n.stateNode),Iu(t,Ss()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(QP)throw QP=!1,t=EF,EF=null,t;return KP&1&&t.tag!==0&&_v(),o=t.pendingLanes,o&1?t===SF?fw++:(fw=0,SF=t):fw=0,xA(),null}function _v(){if(Pm!==null){var t=eJ(KP),e=pf.transition,n=Ki;try{if(pf.transition=null,Ki=16>t?16:t,Pm===null)var r=!1;else{if(t=Pm,Pm=null,KP=0,vi&6)throw Error(vn(331));var i=vi;for(vi|=4,Zn=t.current;Zn!==null;){var o=Zn,a=o.child;if(Zn.flags&16){var s=o.deletions;if(s!==null){for(var u=0;u<s.length;u++){var d=s[u];for(Zn=d;Zn!==null;){var g=Zn;switch(g.tag){case 0:case 11:case 15:uw(8,g,o)}var _=g.child;if(_!==null)_.return=g,Zn=_;else for(;Zn!==null;){g=Zn;var E=g.sibling,P=g.return;if(hee(g),g===d){Zn=null;break}if(E!==null){E.return=P,Zn=E;break}Zn=P}}}var O=o.alternate;if(O!==null){var D=O.child;if(D!==null){O.child=null;do{var V=D.sibling;D.sibling=null,D=V}while(D!==null)}}Zn=o}}if(o.subtreeFlags&2064&&a!==null)a.return=o,Zn=a;else e:for(;Zn!==null;){if(o=Zn,o.flags&2048)switch(o.tag){case 0:case 11:case 15:uw(9,o,o.return)}var k=o.sibling;if(k!==null){k.return=o.return,Zn=k;break e}Zn=o.return}}var F=t.current;for(Zn=F;Zn!==null;){a=Zn;var z=a.child;if(a.subtreeFlags&2064&&z!==null)z.return=a,Zn=z;else e:for(a=F;Zn!==null;){if(s=Zn,s.flags&2048)try{switch(s.tag){case 0:case 11:case 15:IO(9,s)}}catch(Y){As(s,s.return,Y)}if(s===a){Zn=null;break e}var X=s.sibling;if(X!==null){X.return=s.return,Zn=X;break e}Zn=s.return}}if(vi=i,xA(),Nd&&typeof Nd.onPostCommitFiberRoot=="function")try{Nd.onPostCommitFiberRoot(xO,t)}catch{}r=!0}return r}finally{Ki=n,pf.transition=e}}return!1}function f9(t,e,n){e=Bv(n,e),e=tee(t,e,1),t=km(t,e,1),e=Zl(),t!==null&&(EE(t,1,e),Iu(t,e))}function As(t,e,n){if(t.tag===3)f9(t,t,n);else for(;e!==null;){if(e.tag===3){f9(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(zm===null||!zm.has(r))){t=Bv(n,t),t=nee(e,t,1),e=km(e,t,1),t=Zl(),e!==null&&(EE(e,1,t),Iu(e,t));break}}e=e.return}}function Wme(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Zl(),t.pingedLanes|=t.suspendedLanes&n,Pa===t&&(Qa&n)===n&&(oa===4||oa===3&&(Qa&130023424)===Qa&&500>Ss()-Xz?C0(t,0):qz|=n),Iu(t,e)}function bee(t,e){e===0&&(t.mode&1?(e=pS,pS<<=1,!(pS&130023424)&&(pS=4194304)):e=1);var n=Zl();t=og(t,e),t!==null&&(EE(t,e,n),Iu(t,n))}function qme(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),bee(t,n)}function Xme(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(vn(314))}r!==null&&r.delete(e),bee(t,n)}var wee;wee=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Cu.current)Eu=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Eu=!1,Bme(t,e,n);Eu=!!(t.flags&131072)}else Eu=!1,ko&&e.flags&1048576&&TJ(e,VP,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;eC(t,e),t=e.pendingProps;var i=Ov(e,Cl.current);Av(e,n),i=Gz(null,e,r,t,i,n);var o=jz();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pu(r)?(o=!0,GP(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Nz(e),i.updater=CO,e.stateNode=i,i._reactInternals=e,dF(e,r,t,n),e=mF(null,e,r,!0,o,n)):(e.tag=0,ko&&o&&Iz(e),Hl(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(eC(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Yme(r),t=sh(r,t),i){case 0:e=gF(null,e,r,t,n);break e;case 1:e=t9(null,e,r,t,n);break e;case 11:e=JV(null,e,r,t,n);break e;case 14:e=e9(null,e,r,sh(r.type,t),n);break e}throw Error(vn(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:sh(r,i),gF(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:sh(r,i),t9(t,e,r,i,n);case 3:e:{if(see(e),t===null)throw Error(vn(387));r=e.pendingProps,o=e.memoizedState,i=o.element,MJ(t,e),WP(e,r,null,n);var a=e.memoizedState;if(r=a.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=Bv(Error(vn(423)),e),e=n9(t,e,r,n,i);break e}else if(r!==i){i=Bv(Error(vn(424)),e),e=n9(t,e,r,n,i);break e}else for(lc=Fm(e.stateNode.containerInfo.firstChild),hc=e,ko=!0,lh=null,n=DJ(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Rv(),r===i){e=sg(t,e,n);break e}Hl(t,e,r,n)}e=e.child}return e;case 5:return BJ(e),t===null&&cF(e),r=e.type,i=e.pendingProps,o=t!==null?t.memoizedProps:null,a=i.children,oF(r,i)?a=null:o!==null&&oF(r,o)&&(e.flags|=32),oee(t,e),Hl(t,e,a,n),e.child;case 6:return t===null&&cF(e),null;case 13:return aee(t,e,n);case 4:return Fz(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Lv(e,null,r,n):Hl(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:sh(r,i),JV(t,e,r,i,n);case 7:return Hl(t,e,e.pendingProps,n),e.child;case 8:return Hl(t,e,e.pendingProps.children,n),e.child;case 12:return Hl(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,a=i.value,xo($P,r._currentValue),r._currentValue=a,o!==null)if(xh(o.value,a)){if(o.children===i.children&&!Cu.current){e=sg(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var s=o.dependencies;if(s!==null){a=o.child;for(var u=s.firstContext;u!==null;){if(u.context===r){if(o.tag===1){u=Qp(-1,n&-n),u.tag=2;var d=o.updateQueue;if(d!==null){d=d.shared;var g=d.pending;g===null?u.next=u:(u.next=g.next,g.next=u),d.pending=u}}o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),fF(o.return,n,e),s.lanes|=n;break}u=u.next}}else if(o.tag===10)a=o.type===e.type?null:o.child;else if(o.tag===18){if(a=o.return,a===null)throw Error(vn(341));a.lanes|=n,s=a.alternate,s!==null&&(s.lanes|=n),fF(a,n,e),a=o.sibling}else a=o.child;if(a!==null)a.return=o;else for(a=o;a!==null;){if(a===e){a=null;break}if(o=a.sibling,o!==null){o.return=a.return,a=o;break}a=a.return}o=a}Hl(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Av(e,n),i=_f(i),r=r(i),e.flags|=1,Hl(t,e,r,n),e.child;case 14:return r=e.type,i=sh(r,e.pendingProps),i=sh(r.type,i),e9(t,e,r,i,n);case 15:return ree(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:sh(r,i),eC(t,e),e.tag=1,Pu(r)?(t=!0,GP(e)):t=!1,Av(e,n),RJ(e,r,i),dF(e,r,i,n),mF(null,e,r,!0,t,n);case 19:return lee(t,e,n);case 22:return iee(t,e,n)}throw Error(vn(156,e.tag))};function Eee(t,e){return YK(t,e)}function Zme(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ff(t,e,n,r){return new Zme(t,e,n,r)}function Kz(t){return t=t.prototype,!(!t||!t.isReactComponent)}function Yme(t){if(typeof t=="function")return Kz(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Az)return 11;if(t===_z)return 14}return 2}function Gm(t,e){var n=t.alternate;return n===null?(n=ff(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function rC(t,e,n,r,i,o){var a=2;if(r=t,typeof t=="function")Kz(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case Hy:return P0(n.children,i,o,e);case mz:a=8,i|=8;break;case FN:return t=ff(12,n,e,i|2),t.elementType=FN,t.lanes=o,t;case kN:return t=ff(13,n,e,i),t.elementType=kN,t.lanes=o,t;case zN:return t=ff(19,n,e,i),t.elementType=zN,t.lanes=o,t;case LK:return OO(n,i,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case OK:a=10;break e;case RK:a=9;break e;case Az:a=11;break e;case _z:a=14;break e;case xm:a=16,r=null;break e}throw Error(vn(130,t==null?t:typeof t,""))}return e=ff(a,n,e,i),e.elementType=t,e.type=r,e.lanes=o,e}function P0(t,e,n,r){return t=ff(7,t,r,e),t.lanes=n,t}function OO(t,e,n,r){return t=ff(22,t,r,e),t.elementType=LK,t.lanes=n,t.stateNode={isHidden:!1},t}function OD(t,e,n){return t=ff(6,t,null,e),t.lanes=n,t}function RD(t,e,n){return e=ff(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Qme(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hD(0),this.expirationTimes=hD(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hD(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Jz(t,e,n,r,i,o,a,s,u){return t=new Qme(t,e,n,s,u),e===1?(e=1,o===!0&&(e|=8)):e=0,o=ff(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Nz(o),t}function Kme(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:$y,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function See(t){if(!t)return Ym;t=t._reactInternals;e:{if(l_(t)!==t||t.tag!==1)throw Error(vn(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Pu(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(vn(171))}if(t.tag===1){var n=t.type;if(Pu(n))return EJ(t,n,e)}return e}function Tee(t,e,n,r,i,o,a,s,u){return t=Jz(n,r,!0,t,i,o,a,s,u),t.context=See(null),n=t.current,r=Zl(),i=Um(n),o=Qp(r,i),o.callback=e??null,km(n,o,i),t.current.lanes=i,EE(t,i,r),Iu(t,r),t}function RO(t,e,n,r){var i=e.current,o=Zl(),a=Um(i);return n=See(n),e.context===null?e.context=n:e.pendingContext=n,e=Qp(o,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=km(i,e,a),t!==null&&(_h(t,i,a,o),QT(t,i,a)),a}function eI(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function h9(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function e5(t,e){h9(t,e),(t=t.alternate)&&h9(t,e)}function Jme(){return null}var Cee=typeof reportError=="function"?reportError:function(t){console.error(t)};function t5(t){this._internalRoot=t}LO.prototype.render=t5.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(vn(409));RO(t,e,null,null)};LO.prototype.unmount=t5.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;D0(function(){RO(null,t,null,null)}),e[ig]=null}};function LO(t){this._internalRoot=t}LO.prototype.unstable_scheduleHydration=function(t){if(t){var e=rJ();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Em.length&&e!==0&&e<Em[n].priority;n++);Em.splice(n,0,t),n===0&&oJ(t)}};function n5(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function DO(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function d9(){}function eAe(t,e,n,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var d=eI(a);o.call(d)}}var a=Tee(e,r,t,0,null,!1,!1,"",d9);return t._reactRootContainer=a,t[ig]=a.current,Mw(t.nodeType===8?t.parentNode:t),D0(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var s=r;r=function(){var d=eI(u);s.call(d)}}var u=Jz(t,0,!1,null,null,!1,!1,"",d9);return t._reactRootContainer=u,t[ig]=u.current,Mw(t.nodeType===8?t.parentNode:t),D0(function(){RO(e,u,n,r)}),u}function BO(t,e,n,r,i){var o=n._reactRootContainer;if(o){var a=o;if(typeof i=="function"){var s=i;i=function(){var u=eI(a);s.call(u)}}RO(e,a,t,i)}else a=eAe(n,e,t,i,r);return eI(a)}tJ=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=qb(e.pendingLanes);n!==0&&(xz(e,n|1),Iu(e,Ss()),!(vi&6)&&(Nv=Ss()+500,xA()))}break;case 13:D0(function(){var r=og(t,1);if(r!==null){var i=Zl();_h(r,t,1,i)}}),e5(t,1)}};bz=function(t){if(t.tag===13){var e=og(t,134217728);if(e!==null){var n=Zl();_h(e,t,134217728,n)}e5(t,134217728)}};nJ=function(t){if(t.tag===13){var e=Um(t),n=og(t,e);if(n!==null){var r=Zl();_h(n,t,e,r)}e5(t,e)}};rJ=function(){return Ki};iJ=function(t,e){var n=Ki;try{return Ki=t,e()}finally{Ki=n}};ZN=function(t,e,n){switch(e){case"input":if(jN(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=SO(r);if(!i)throw Error(vn(90));BK(r),jN(r,i)}}}break;case"textarea":FK(t,n);break;case"select":e=n.value,e!=null&&dv(t,!!n.multiple,e,!1)}};$K=Zz;HK=D0;var tAe={usingClientEntryPoint:!1,Events:[TE,Zy,SO,jK,VK,Zz]},sb={findFiberByHostInstance:x0,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nAe={bundleType:sb.bundleType,version:sb.version,rendererPackageName:sb.rendererPackageName,rendererConfig:sb.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bg.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=XK(t),t===null?null:t.stateNode},findFiberByHostInstance:sb.findFiberByHostInstance||Jme,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var SS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!SS.isDisabled&&SS.supportsFiber)try{xO=SS.inject(nAe),Nd=SS}catch{}}Pc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tAe;Pc.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!n5(e))throw Error(vn(200));return Kme(t,e,null,n)};Pc.createRoot=function(t,e){if(!n5(t))throw Error(vn(299));var n=!1,r="",i=Cee;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Jz(t,1,!1,null,null,n,!1,r,i),t[ig]=e.current,Mw(t.nodeType===8?t.parentNode:t),new t5(e)};Pc.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(vn(188)):(t=Object.keys(t).join(","),Error(vn(268,t)));return t=XK(e),t=t===null?null:t.stateNode,t};Pc.flushSync=function(t){return D0(t)};Pc.hydrate=function(t,e,n){if(!DO(e))throw Error(vn(200));return BO(null,t,e,!0,n)};Pc.hydrateRoot=function(t,e,n){if(!n5(t))throw Error(vn(405));var r=n!=null&&n.hydratedSources||null,i=!1,o="",a=Cee;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=Tee(e,null,t,1,n??null,i,!1,o,a),t[ig]=e.current,Mw(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new LO(e)};Pc.render=function(t,e,n){if(!DO(e))throw Error(vn(200));return BO(null,t,e,!1,n)};Pc.unmountComponentAtNode=function(t){if(!DO(t))throw Error(vn(40));return t._reactRootContainer?(D0(function(){BO(null,null,t,!1,function(){t._reactRootContainer=null,t[ig]=null})}),!0):!1};Pc.unstable_batchedUpdates=Zz;Pc.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!DO(n))throw Error(vn(200));if(t==null||t._reactInternals===void 0)throw Error(vn(38));return BO(t,e,n,!1,r)};Pc.version="18.2.0-next-9e3b772b8-20220608";function Pee(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Pee)}catch(t){console.error(t)}}Pee(),TK.exports=Pc;var PE=TK.exports,p9=PE;BN.createRoot=p9.createRoot,BN.hydrateRoot=p9.hydrateRoot;function co(t,e){if(!t)throw new Error(e||"loader assertion failed.")}const NO=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),g9=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);g9&&parseFloat(g9[1]);function rAe(t,e){const n={...t};for(const[r,i]of Object.entries(e))i&&typeof i=="object"?(n[r]=n[r]||{},Object.assign(n[r],e[r])):n[r]=e[r];return n}const iAe="3.4.14";function Gd(t,e){if(!t)throw new Error(e||"loaders.gl assertion failed.")}const LD={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document},oAe=LD.global||LD.self||LD.window||{},Kp=typeof process!="object"||String(process)!=="[object process]"||process.browser,r5=typeof importScripts=="function",sAe=typeof window<"u"&&typeof window.orientation<"u",m9=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);m9&&parseFloat(m9[1]);function zw(t){"@babel/helpers - typeof";return zw=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zw(t)}function aAe(t,e){if(zw(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(zw(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lAe(t){var e=aAe(t,"string");return zw(e)==="symbol"?e:String(e)}function q(t,e,n){return e=lAe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}class uAe{constructor(e,n){q(this,"name",void 0),q(this,"workerThread",void 0),q(this,"isRunning",!0),q(this,"result",void 0),q(this,"_resolve",()=>{}),q(this,"_reject",()=>{}),this.name=e,this.workerThread=n,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,n){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:n})}done(e){Gd(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){Gd(this.isRunning),this.isRunning=!1,this._reject(e)}}let DD=class{terminate(){}};const BD=new Map;function cAe(t){Gd(t.source&&!t.url||!t.source&&t.url);let e=BD.get(t.source||t.url);return e||(t.url&&(e=fAe(t.url),BD.set(t.url,e)),t.source&&(e=Iee(t.source),BD.set(t.source,e))),Gd(e),e}function fAe(t){if(!t.startsWith("http"))return t;const e=hAe(t);return Iee(e)}function Iee(t){const e=new Blob([t],{type:"application/javascript"});return URL.createObjectURL(e)}function hAe(t){return`try {
  importScripts('`.concat(t,`');
} catch (error) {
  console.error(error);
  throw error;
}`)}function Mee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2?arguments[2]:void 0;const r=n||new Set;if(t){if(A9(t))r.add(t);else if(A9(t.buffer))r.add(t.buffer);else if(!ArrayBuffer.isView(t)){if(e&&typeof t=="object")for(const i in t)Mee(t[i],e,r)}}return n===void 0?Array.from(r):[]}function A9(t){return t?t instanceof ArrayBuffer||typeof MessagePort<"u"&&t instanceof MessagePort||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas:!1}const ND=()=>{};class PF{static isSupported(){return typeof Worker<"u"&&Kp||typeof DD<"u"&&!Kp}constructor(e){q(this,"name",void 0),q(this,"source",void 0),q(this,"url",void 0),q(this,"terminated",!1),q(this,"worker",void 0),q(this,"onMessage",void 0),q(this,"onError",void 0),q(this,"_loadableURL","");const{name:n,source:r,url:i}=e;Gd(r||i),this.name=n,this.source=r,this.url=i,this.onMessage=ND,this.onError=o=>console.log(o),this.worker=Kp?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=ND,this.onError=ND,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,n){n=n||Mee(e),this.worker.postMessage(e,n)}_getErrorFromErrorEvent(e){let n="Failed to load ";return n+="worker ".concat(this.name," from ").concat(this.url,". "),e.message&&(n+="".concat(e.message," in ")),e.lineno&&(n+=":".concat(e.lineno,":").concat(e.colno)),new Error(n)}_createBrowserWorker(){this._loadableURL=cAe({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=n=>{n.data?this.onMessage(n.data):this.onError(new Error("No data received"))},e.onerror=n=>{this.onError(this._getErrorFromErrorEvent(n)),this.terminated=!0},e.onmessageerror=n=>console.error(n),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:"./".concat(this.url);e=new DD(r,{eval:!1})}else if(this.source)e=new DD(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",n=>{this.onMessage(n)}),e.on("error",n=>{this.onError(n)}),e.on("exit",n=>{}),e}}class dAe{static isSupported(){return PF.isSupported()}constructor(e){q(this,"name","unnamed"),q(this,"source",void 0),q(this,"url",void 0),q(this,"maxConcurrency",1),q(this,"maxMobileConcurrency",1),q(this,"onDebug",()=>{}),q(this,"reuseWorkers",!0),q(this,"props",{}),q(this,"jobQueue",[]),q(this,"idleQueue",[]),q(this,"count",0),q(this,"isDestroyed",!1),this.source=e.source,this.url=e.url,this.setProps(e)}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(o,a,s)=>o.done(s),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(o,a)=>o.error(a);const i=new Promise(o=>(this.jobQueue.push({name:e,onMessage:n,onError:r,onStart:o}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const n=this.jobQueue.shift();if(n){this.onDebug({message:"Starting job",name:n.name,workerThread:e,backlog:this.jobQueue.length});const r=new uAe(n.name,e);e.onMessage=i=>n.onMessage(r,i.type,i.payload),e.onError=i=>n.onError(r,i),n.onStart(r);try{await r.result}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e="".concat(this.name.toLowerCase()," (#").concat(this.count," of ").concat(this.maxConcurrency,")");return new PF({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return sAe?this.maxMobileConcurrency:this.maxConcurrency}}const pAe={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class $p{static isSupported(){return PF.isSupported()}static getWorkerFarm(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return $p._workerFarm=$p._workerFarm||new $p({}),$p._workerFarm.setProps(e),$p._workerFarm}constructor(e){q(this,"props",void 0),q(this,"workerPools",new Map),this.props={...pAe},this.setProps(e),this.workerPools=new Map}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const n of this.workerPools.values())n.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:n,source:r,url:i}=e;let o=this.workerPools.get(n);return o||(o=new dAe({name:n,source:r,url:i}),o.setProps(this._getWorkerPoolProps()),this.workerPools.set(n,o)),o}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}q($p,"_workerFarm",void 0);const gAe="latest";function mAe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=e[t.id]||{},r="".concat(t.id,"-worker.js");let i=n.workerUrl;if(!i&&t.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&(i="modules/".concat(t.module,"/dist/").concat(r)),!i){let o=t.version;o==="latest"&&(o=gAe);const a=o?"@".concat(o):"";i="https://unpkg.com/@loaders.gl/".concat(t.module).concat(a,"/dist/").concat(r)}return Gd(i),i}function AAe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:iAe;Gd(t,"no worker provided");const n=t.version;return!(!e||!n)}const _Ae=null,yAe=null,IF=null,Oee=null,vAe=Object.freeze(Object.defineProperty({__proto__:null,readFileAsArrayBuffer:_Ae,readFileAsText:yAe,requireFromFile:IF,requireFromString:Oee},Symbol.toStringTag,{value:"Module"})),xAe="3.4.14",FD={};async function I0(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e&&(t=bAe(t,e,n)),FD[t]=FD[t]||wAe(t),await FD[t]}function bAe(t,e,n){if(t.startsWith("http"))return t;const r=n.modules||{};return r[t]?r[t]:Kp?n.CDN?(Gd(n.CDN.startsWith("http")),"".concat(n.CDN,"/").concat(e,"@").concat(xAe,"/dist/libs/").concat(t)):r5?"../src/libs/".concat(t):"modules/".concat(e,"/src/libs/").concat(t):"modules/".concat(e,"/dist/libs/").concat(t)}async function wAe(t){if(t.endsWith("wasm"))return await(await fetch(t)).arrayBuffer();if(!Kp)try{return vAe&&IF&&await IF(t)}catch{return null}if(r5)return importScripts(t);const n=await(await fetch(t)).text();return EAe(n,t)}function EAe(t,e){if(!Kp)return Oee;if(r5)return eval.call(oAe,t),null;const n=document.createElement("script");n.id=e;try{n.appendChild(document.createTextNode(t))}catch{n.text=t}return document.body.appendChild(n),null}function SAe(t,e){return!$p.isSupported()||!Kp&&!(e!=null&&e._nodeWorkers)?!1:t.worker&&(e==null?void 0:e.worker)}async function TAe(t,e,n,r,i){const o=t.id,a=mAe(t,n),u=$p.getWorkerFarm(n).getWorkerPool({name:o,url:a});n=JSON.parse(JSON.stringify(n)),r=JSON.parse(JSON.stringify(r||{}));const d=await u.startJob("process-on-worker",CAe.bind(null,i));return d.postMessage("process",{input:e,options:n,context:r}),await(await d.result).result}async function CAe(t,e,n,r){switch(n){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:o,options:a}=r;try{const s=await t(o,a);e.postMessage("done",{id:i,result:s})}catch(s){const u=s instanceof Error?s.message:"unknown error";e.postMessage("error",{id:i,error:u})}break;default:console.warn("parse-with-worker unknown message ".concat(n))}}function PAe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?_9(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?_9(t,0,e):""}function _9(t,e,n){if(t.byteLength<=e+n)return"";const r=new DataView(t);let i="";for(let o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(e+o));return i}function IAe(t){try{return JSON.parse(t)}catch{throw new Error('Failed to parse JSON from data starting with "'.concat(PAe(t),'"'))}}function MAe(t,e,n){if(n=n||t.byteLength,t.byteLength<n||e.byteLength<n)return!1;const r=new Uint8Array(t),i=new Uint8Array(e);for(let o=0;o<r.length;++o)if(r[o]!==i[o])return!1;return!0}function OAe(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e.map(s=>s instanceof ArrayBuffer?new Uint8Array(s):s),i=r.reduce((s,u)=>s+u.byteLength,0),o=new Uint8Array(i);let a=0;for(const s of r)o.set(s,a),a+=s.byteLength;return o.buffer}function kD(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const r=e,i=r&&r.length>1&&r[0].constructor||null;if(!i)throw new Error('"concatenateTypedArrays" - incorrect quantity of arguments or arguments have incompatible data types');const o=r.reduce((u,d)=>u+d.length,0),a=new i(o);let s=0;for(const u of r)a.set(u,s),s+=u.length;return a}function i5(t,e,n){const r=n!==void 0?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}function IE(t,e){return co(t>=0),co(e>0),t+(e-1)&~(e-1)}function RAe(t,e,n){let r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{const i=t.byteOffset,o=t.byteLength;r=new Uint8Array(t.buffer||t.arrayBuffer,i,o)}return e.set(r,n),n+IE(r.byteLength,4)}async function LAe(t){const e=[];for await(const n of t)e.push(n);return OAe(...e)}function y9(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let v9=class{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=y9(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(y9()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},DAe=class{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof v9?i=e:i=new v9(n,r),this.stats[n]=i),i}};const BAe="Queued Requests",NAe="Active Requests",FAe="Cancelled Requests",kAe="Queued Requests Ever",zAe="Active Requests Ever",UAe={id:"request-scheduler",throttleRequests:!0,maxRequests:6};class Ree{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};q(this,"props",void 0),q(this,"stats",void 0),q(this,"activeRequestCount",0),q(this,"requestQueue",[]),q(this,"requestMap",new Map),q(this,"deferredUpdate",null),this.props={...UAe,...e},this.stats=new DAe({id:this.props.id}),this.stats.get(BAe),this.stats.get(NAe),this.stats.get(FAe),this.stats.get(kAe),this.stats.get(zAe)}scheduleRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>0;if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(e))return this.requestMap.get(e);const r={handle:e,priority:0,getPriority:n},i=new Promise(o=>(r.resolve=o,r));return this.requestQueue.push(r),this.requestMap.set(e,i),this._issueNewRequests(),i}_issueRequest(e){const{handle:n,resolve:r}=e;let i=!1;const o=()=>{i||(i=!0,this.requestMap.delete(n),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,r?r({done:o}):Promise.resolve({done:o})}_issueNewRequests(){this.deferredUpdate||(this.deferredUpdate=setTimeout(()=>this._issueNewRequestsAsync(),0))}_issueNewRequestsAsync(){this.deferredUpdate=null;const e=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(e!==0){this._updateAllRequests();for(let n=0;n<e;++n){const r=this.requestQueue.shift();r&&this._issueRequest(r)}}}_updateAllRequests(){const e=this.requestQueue;for(let n=0;n<e.length;++n){const r=e[n];this._updateRequest(r)||(e.splice(n,1),this.requestMap.delete(r.handle),n--)}e.sort((n,r)=>n.priority-r.priority)}_updateRequest(e){return e.priority=e.getPriority(e.handle),e.priority<0?(e.resolve(null),!1):!0}}let GAe="";const x9={};function jAe(t){for(const e in x9)if(t.startsWith(e)){const n=x9[e];t=t.replace(e,n)}return!t.startsWith("http://")&&!t.startsWith("https://")&&(t="".concat(GAe).concat(t)),t}function VAe(t){return t&&typeof t=="object"&&t.isBuffer}function Lee(t){if(VAe(t))return t;if(t instanceof ArrayBuffer)return t;if(ArrayBuffer.isView(t))return t.byteOffset===0&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength);if(typeof t=="string"){const e=t;return new TextEncoder().encode(e).buffer}if(t&&typeof t=="object"&&t._toArrayBuffer)return t._toArrayBuffer();throw new Error("toArrayBuffer")}function Dee(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(e+1):""}function o5(t){const e=t?t.lastIndexOf("/"):-1;return e>=0?t.substr(0,e):""}const $Ae=t=>typeof t=="boolean",hw=t=>typeof t=="function",ME=t=>t!==null&&typeof t=="object",b9=t=>ME(t)&&t.constructor==={}.constructor,HAe=t=>t&&typeof t[Symbol.iterator]=="function",WAe=t=>t&&typeof t[Symbol.asyncIterator]=="function",u_=t=>typeof Response<"u"&&t instanceof Response||t&&t.arrayBuffer&&t.text&&t.json,c_=t=>typeof Blob<"u"&&t instanceof Blob,qAe=t=>t&&typeof t=="object"&&t.isBuffer,XAe=t=>typeof ReadableStream<"u"&&t instanceof ReadableStream||ME(t)&&hw(t.tee)&&hw(t.cancel)&&hw(t.getReader),ZAe=t=>ME(t)&&hw(t.read)&&hw(t.pipe)&&$Ae(t.readable),Bee=t=>XAe(t)||ZAe(t),YAe=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,QAe=/^([-\w.]+\/[-\w.+]+)/;function KAe(t){const e=QAe.exec(t);return e?e[1]:t}function w9(t){const e=YAe.exec(t);return e?e[1]:""}const Nee=/\?.*/;function JAe(t){const e=t.match(Nee);return e&&e[0]}function s5(t){return t.replace(Nee,"")}function FO(t){return u_(t)?t.url:c_(t)?t.name||"":typeof t=="string"?t:""}function a5(t){if(u_(t)){const e=t,n=e.headers.get("content-type")||"",r=s5(e.url);return KAe(n)||w9(r)}return c_(t)?t.type||"":typeof t=="string"?w9(t):""}function e0e(t){return u_(t)?t.headers["content-length"]||-1:c_(t)?t.size:typeof t=="string"?t.length:t instanceof ArrayBuffer||ArrayBuffer.isView(t)?t.byteLength:-1}async function Fee(t){if(u_(t))return t;const e={},n=e0e(t);n>=0&&(e["content-length"]=String(n));const r=FO(t),i=a5(t);i&&(e["content-type"]=i);const o=await r0e(t);o&&(e["x-first-bytes"]=o),typeof t=="string"&&(t=new TextEncoder().encode(t));const a=new Response(t,{headers:e});return Object.defineProperty(a,"url",{value:r}),a}async function t0e(t){if(!t.ok){const e=await n0e(t);throw new Error(e)}}async function n0e(t){let e="Failed to fetch resource ".concat(t.url," (").concat(t.status,"): ");try{const n=t.headers.get("Content-Type");let r=t.statusText;n.includes("application/json")&&(r+=" ".concat(await t.text())),e+=r,e=e.length>60?"".concat(e.slice(0,60),"..."):e}catch{}return e}async function r0e(t){if(typeof t=="string")return"data:,".concat(t.slice(0,5));if(t instanceof Blob){const n=t.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=o=>{var a;return r(o==null||(a=o.target)===null||a===void 0?void 0:a.result)},i.readAsDataURL(n)})}if(t instanceof ArrayBuffer){const n=t.slice(0,5),r=i0e(n);return"data:base64,".concat(r)}return null}function i0e(t){let e="";const n=new Uint8Array(t);for(let r=0;r<n.byteLength;r++)e+=String.fromCharCode(n[r]);return btoa(e)}async function E9(t,e){if(typeof t=="string"){t=jAe(t);let n=e;return e!=null&&e.fetch&&typeof(e==null?void 0:e.fetch)!="function"&&(n=e.fetch),await fetch(t,n)}return await Fee(t)}function o0e(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function OE(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||o0e()}const TS=globalThis.window||globalThis.self||globalThis.global,ab=globalThis.process||{},kee=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";OE();function s0e(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}let a0e=class{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";this.storage=void 0,this.id=void 0,this.config=void 0,this.storage=s0e(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}};function l0e(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function u0e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function zD(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const o=t.width*n,a=t.height*n,s=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),s]}let tI;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(tI||(tI={}));const c0e=10;function S9(t){return typeof t!="string"?t:(t=t.toUpperCase(),tI[t]||tI.WHITE)}function f0e(t,e,n){if(!OE&&typeof t=="string"){if(e){const r=S9(e);t="\x1B[".concat(r,"m").concat(t,"\x1B[39m")}if(n){const r=S9(n);t="\x1B[".concat(r+c0e,"m").concat(t,"\x1B[49m")}}return t}function h0e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n),i=t;for(const o of r){const a=i[o];typeof a=="function"&&(e.find(s=>o===s)||(i[o]=a.bind(t)))}}function nI(t,e){if(!t)throw new Error(e||"Assertion failed")}function py(){let t;if(OE()&&TS.performance){var e,n;t=TS==null||(e=TS.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in ab){var r;const i=ab==null||(r=ab.hrtime)===null||r===void 0?void 0:r.call(ab);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const gy={debug:OE()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},d0e={enabled:!0,level:0};function of(){}const T9={},C9={once:!0};let l5=class{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};this.id=void 0,this.VERSION=kee,this._startTs=py(),this._deltaTs=py(),this._storage=void 0,this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new a0e("__probe-".concat(this.id,"__"),d0e),this.timeStamp("".concat(this.id," started")),h0e(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((py()-this._startTs).toPrecision(10))}getDelta(){return Number((py()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){nI(e,n)}warn(e){return this._getLogFunction(0,e,gy.warn,arguments,C9)}error(e){return this._getLogFunction(0,e,gy.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,gy.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,gy.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){return this._getLogFunction(e,n,gy.debug||gy.info,arguments,C9)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||of,r&&[r],{tag:A0e(n)}):of}image(e){let{logLevel:n,priority:r,image:i,message:o="",scale:a=1}=e;return this._shouldLog(n||r)?OE()?m0e({image:i,message:o,scale:a}):g0e():of}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||of)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=P9({logLevel:e,message:n,opts:r}),{collapsed:o}=r;return i.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||of)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=zee(e)}_getLogFunction(e,n,r,i,o){if(this._shouldLog(e)){o=P9({logLevel:e,message:n,args:i,opts:o}),r=r||o.method,nI(r),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=py();const a=o.tag||o.message;if(o.once&&a)if(!T9[a])T9[a]=py();else return of;return n=p0e(this.id,o.message,o),r.bind(console,n,...o.args)}return of}};l5.VERSION=kee;function zee(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return nI(Number.isFinite(e)&&e>=0),e}function P9(t){const{logLevel:e,message:n}=t;t.logLevel=zee(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return nI(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function p0e(t,e,n){if(typeof e=="string"){const r=n.time?u0e(l0e(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=f0e(e,n.color,n.background)}return e}function g0e(t){return console.warn("removed"),of}function m0e(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const o=new Image;return o.onload=()=>{const a=zD(o,n,r);console.log(...a)},o.src=e,of}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...zD(e,n,r)),of;if(i.toLowerCase()==="canvas"){const o=new Image;return o.onload=()=>console.log(...zD(o,n,r)),o.src=e.toDataURL(),of}return of}function A0e(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const I9=new l5({id:"loaders.gl"});class _0e{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class y0e{constructor(){q(this,"console",void 0),this.console=console}log(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.log.bind(this.console,...n)}info(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.info.bind(this.console,...n)}warn(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.warn.bind(this.console,...n)}error(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return this.console.error.bind(this.console,...n)}}const Uee={fetch:null,mimeType:void 0,nothrow:!1,log:new y0e,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:NO,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},v0e={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Gee(){globalThis.loaders=globalThis.loaders||{};const{loaders:t}=globalThis;return t._state=t._state||{},t._state}const jee=()=>{const t=Gee();return t.globalOptions=t.globalOptions||{...Uee},t.globalOptions};function x0e(t,e,n,r){return n=n||[],n=Array.isArray(n)?n:[n],b0e(t,n),E0e(e,t,r)}function b0e(t,e){M9(t,null,Uee,v0e,e);for(const n of e){const r=t&&t[n.id]||{},i=n.options&&n.options[n.id]||{},o=n.deprecatedOptions&&n.deprecatedOptions[n.id]||{};M9(r,n.id,i,o,e)}}function M9(t,e,n,r,i){const o=e||"Top level",a=e?"".concat(e,"."):"";for(const s in t){const u=!e&&ME(t[s]),d=s==="baseUri"&&!e,g=s==="workerUrl"&&e;if(!(s in n)&&!d&&!g){if(s in r)I9.warn("".concat(o," loader option '").concat(a).concat(s,"' no longer supported, use '").concat(r[s],"'"))();else if(!u){const _=w0e(s,i);I9.warn("".concat(o," loader option '").concat(a).concat(s,"' not recognized. ").concat(_))()}}}}function w0e(t,e){const n=t.toLowerCase();let r="";for(const i of e)for(const o in i.options){if(t===o)return"Did you mean '".concat(i.id,".").concat(o,"'?");const a=o.toLowerCase();(n.startsWith(a)||a.startsWith(n))&&(r=r||"Did you mean '".concat(i.id,".").concat(o,"'?"))}return r}function E0e(t,e,n){const i={...t.options||{}};return S0e(i,n),i.log===null&&(i.log=new _0e),O9(i,jee()),O9(i,e),i}function O9(t,e){for(const n in e)if(n in e){const r=e[n];b9(r)&&b9(t[n])?t[n]={...t[n],...e[n]}:t[n]=e[n]}}function S0e(t,e){e&&!("baseUri"in t)&&(t.baseUri=e)}function u5(t){var e;return t?(Array.isArray(t)&&(t=t[0]),Array.isArray((e=t)===null||e===void 0?void 0:e.extensions)):!1}function c5(t){var e,n;co(t,"null loader"),co(u5(t),"invalid loader");let r;return Array.isArray(t)&&(r=t[1],t=t[0],t={...t,options:{...t.options,...r}}),((e=t)!==null&&e!==void 0&&e.parseTextSync||(n=t)!==null&&n!==void 0&&n.parseText)&&(t.text=!0),t.text||(t.binary=!0),t}const Vee=()=>{const t=Gee();return t.loaderRegistry=t.loaderRegistry||[],t.loaderRegistry};function T0e(t){const e=Vee();t=Array.isArray(t)?t:[t];for(const n of t){const r=c5(n);e.find(i=>r===i)||e.unshift(r)}}function C0e(){return Vee()}const P0e=new l5({id:"loaders.gl"}),I0e=/\.([^.]+)$/;async function M0e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!$ee(t))return null;let i=R9(t,e,{...n,nothrow:!0},r);if(i)return i;if(c_(t)&&(t=await t.slice(0,10).arrayBuffer(),i=R9(t,e,n,r)),!i&&!(n!=null&&n.nothrow))throw new Error(Hee(t));return i}function R9(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(!$ee(t))return null;if(e&&!Array.isArray(e))return c5(e);let i=[];e&&(i=i.concat(e)),n!=null&&n.ignoreRegisteredLoaders||i.push(...C0e()),R0e(i);const o=O0e(t,i,n,r);if(!o&&!(n!=null&&n.nothrow))throw new Error(Hee(t));return o}function O0e(t,e,n,r){const i=FO(t),o=a5(t),a=s5(i)||(r==null?void 0:r.url);let s=null,u="";if(n!=null&&n.mimeType&&(s=UD(e,n==null?void 0:n.mimeType),u="match forced by supplied MIME type ".concat(n==null?void 0:n.mimeType)),s=s||L0e(e,a),u=u||(s?"matched url ".concat(a):""),s=s||UD(e,o),u=u||(s?"matched MIME type ".concat(o):""),s=s||B0e(e,t),u=u||(s?"matched initial data ".concat(Wee(t)):""),s=s||UD(e,n==null?void 0:n.fallbackMimeType),u=u||(s?"matched fallback MIME type ".concat(o):""),u){var d;P0e.log(1,"selectLoader selected ".concat((d=s)===null||d===void 0?void 0:d.name,": ").concat(u,"."))}return s}function $ee(t){return!(t instanceof Response&&t.status===204)}function Hee(t){const e=FO(t),n=a5(t);let r="No valid loader found (";r+=e?"".concat(Dee(e),", "):"no url provided, ",r+="MIME type: ".concat(n?'"'.concat(n,'"'):"not provided",", ");const i=t?Wee(t):"";return r+=i?' first bytes: "'.concat(i,'"'):"first bytes: not available",r+=")",r}function R0e(t){for(const e of t)c5(e)}function L0e(t,e){const n=e&&I0e.exec(e),r=n&&n[1];return r?D0e(t,r):null}function D0e(t,e){e=e.toLowerCase();for(const n of t)for(const r of n.extensions)if(r.toLowerCase()===e)return n;return null}function UD(t,e){for(const n of t)if(n.mimeTypes&&n.mimeTypes.includes(e)||e==="application/x.".concat(n.id))return n;return null}function B0e(t,e){if(!e)return null;for(const n of t)if(typeof e=="string"){if(N0e(e,n))return n}else if(ArrayBuffer.isView(e)){if(L9(e.buffer,e.byteOffset,n))return n}else if(e instanceof ArrayBuffer&&L9(e,0,n))return n;return null}function N0e(t,e){return e.testText?e.testText(t):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>t.startsWith(r))}function L9(t,e,n){return(Array.isArray(n.tests)?n.tests:[n.tests]).some(i=>F0e(t,e,n,i))}function F0e(t,e,n,r){if(r instanceof ArrayBuffer)return MAe(r,t,r.byteLength);switch(typeof r){case"function":return r(t,n);case"string":const i=MF(t,e,r.length);return r===i;default:return!1}}function Wee(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof t=="string"?t.slice(0,e):ArrayBuffer.isView(t)?MF(t.buffer,t.byteOffset,e):t instanceof ArrayBuffer?MF(t,0,e):""}function MF(t,e,n){if(t.byteLength<e+n)return"";const r=new DataView(t);let i="";for(let o=0;o<n;o++)i+=String.fromCharCode(r.getUint8(e+o));return i}const k0e=256*1024;function*z0e(t,e){const n=(e==null?void 0:e.chunkSize)||k0e;let r=0;const i=new TextEncoder;for(;r<t.length;){const o=Math.min(t.length-r,n),a=t.slice(r,r+o);r+=o,yield i.encode(a)}}const U0e=256*1024;function G0e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:n=U0e}=e;let r=0;for(;r<t.byteLength;){const i=Math.min(t.byteLength-r,n),o=new ArrayBuffer(i),a=new Uint8Array(t,r,i);new Uint8Array(o).set(a),r+=i,yield o}}()}const j0e=1024*1024;async function*V0e(t,e){const n=(e==null?void 0:e.chunkSize)||j0e;let r=0;for(;r<t.size;){const i=r+n,o=await t.slice(r,i).arrayBuffer();r=i,yield o}}function D9(t,e){return NO?$0e(t,e):H0e(t)}async function*$0e(t,e){const n=t.getReader();let r;try{for(;;){const i=r||n.read();e!=null&&e._streamReadAhead&&(r=n.read());const{done:o,value:a}=await i;if(o)return;yield Lee(a)}}catch{n.releaseLock()}}async function*H0e(t,e){for await(const n of t)yield Lee(n)}function W0e(t,e){if(typeof t=="string")return z0e(t,e);if(t instanceof ArrayBuffer)return G0e(t,e);if(c_(t))return V0e(t,e);if(Bee(t))return D9(t,e);if(u_(t))return D9(t.body,e);throw new Error("makeIterator")}const qee="Cannot convert supplied data type";function q0e(t,e,n){if(e.text&&typeof t=="string")return t;if(qAe(t)&&(t=t.buffer),t instanceof ArrayBuffer){const r=t;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(t)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(t);let r=t.buffer;const i=t.byteLength||t.length;return(t.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(t.byteOffset,t.byteOffset+i)),r}throw new Error(qee)}async function X0e(t,e,n){const r=t instanceof ArrayBuffer||ArrayBuffer.isView(t);if(typeof t=="string"||r)return q0e(t,e);if(c_(t)&&(t=await Fee(t)),u_(t)){const i=t;return await t0e(i),e.binary?await i.arrayBuffer():await i.text()}if(Bee(t)&&(t=W0e(t,n)),HAe(t)||WAe(t))return LAe(t);throw new Error(qee)}function Xee(t,e){const n=jee(),r=t||n;return typeof r.fetch=="function"?r.fetch:ME(r.fetch)?i=>E9(i,r):e!=null&&e.fetch?e==null?void 0:e.fetch:E9}function Z0e(t,e,n){if(n)return n;const r={fetch:Xee(e,t),...t};if(r.url){const i=s5(r.url);r.baseUrl=i,r.queryString=JAe(r.url),r.filename=Dee(i),r.baseUrl=o5(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function Y0e(t,e){if(!e&&t&&!Array.isArray(t))return t;let n;if(t&&(n=Array.isArray(t)?t:[t]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];n=n?[...n,...r]:r}return n&&n.length?n:null}async function f5(t,e,n,r){Gd(!r||typeof r=="object"),e&&!Array.isArray(e)&&!u5(e)&&(r=void 0,n=e,e=void 0),t=await t,n=n||{};const i=FO(t),a=Y0e(e,r),s=await M0e(t,a,n);return s?(n=x0e(n,s,a,i),r=Z0e({url:i,parse:f5,loaders:a},n,r||null),await Q0e(s,t,n,r)):null}async function Q0e(t,e,n,r){if(AAe(t),u_(e)){const i=e,{ok:o,redirected:a,status:s,statusText:u,type:d,url:g}=i,_=Object.fromEntries(i.headers.entries());r.response={headers:_,ok:o,redirected:a,status:s,statusText:u,type:d,url:g}}if(e=await X0e(e,t,n),t.parseTextSync&&typeof e=="string")return n.dataType="text",t.parseTextSync(e,n,r,t);if(SAe(t,n))return await TAe(t,e,n,r,f5);if(t.parseText&&typeof e=="string")return await t.parseText(e,n,r,t);if(t.parse)return await t.parse(e,n,r,t);throw Gd(!t.parseSync),new Error("".concat(t.id," loader - no parser found and worker is disabled"))}async function ag(t,e,n,r){!Array.isArray(e)&&!u5(e)&&(n=e,e=void 0);const i=Xee(n);let o=t;return typeof t=="string"&&(o=await i(t)),c_(t)&&(o=await i(t)),await f5(o,e,n)}const K0e="3.4.14",{_parseImageNode:J0e}=globalThis,OF=typeof Image<"u",RF=typeof ImageBitmap<"u",e_e=!!J0e,LF=NO?!0:e_e;function t_e(t){switch(t){case"auto":return RF||OF||LF;case"imagebitmap":return RF;case"image":return OF;case"data":return LF;default:throw new Error("@loaders.gl/images: image ".concat(t," not supported in this environment"))}}function n_e(){if(RF)return"imagebitmap";if(OF)return"image";if(LF)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function r_e(t){const e=o_e(t);if(!e)throw new Error("Not an image");return e}function i_e(t){switch(r_e(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");if(!n)throw new Error("getImageData");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:throw new Error("getImageData")}}function o_e(t){return typeof ImageBitmap<"u"&&t instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&t instanceof Image?"image":t&&typeof t=="object"&&t.data&&t.width&&t.height?"data":null}const s_e=/^data:image\/svg\+xml/,a_e=/\.svg((\?|#).*)?$/;function h5(t){return t&&(s_e.test(t)||a_e.test(t))}function l_e(t,e){if(h5(e)){let r=new TextDecoder().decode(t);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(o){throw new Error(o.message)}return"data:image/svg+xml;base64,".concat(btoa(r))}return Zee(t,e)}function Zee(t,e){if(h5(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(t)])}async function Yee(t,e,n){const r=l_e(t,n),i=self.URL||self.webkitURL,o=typeof r!="string"&&i.createObjectURL(r);try{return await u_e(o||r,e)}finally{o&&i.revokeObjectURL(o)}}async function u_e(t,e){const n=new Image;return n.src=t,e.image&&e.image.decode&&n.decode?(await n.decode(),n):await new Promise((r,i)=>{try{n.onload=()=>r(n),n.onerror=o=>i(new Error("Could not load image ".concat(t,": ").concat(o)))}catch(o){i(o)}})}const c_e={};let B9=!0;async function f_e(t,e,n){let r;h5(n)?r=await Yee(t,e,n):r=Zee(t,n);const i=e&&e.imagebitmap;return await h_e(r,i)}async function h_e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((d_e(e)||!B9)&&(e=null),e)try{return await createImageBitmap(t,e)}catch(n){console.warn(n),B9=!1}return await createImageBitmap(t)}function d_e(t){for(const e in t||c_e)return!1;return!0}function p_e(t){return!__e(t,"ftyp",4)||!(t[8]&96)?null:g_e(t)}function g_e(t){switch(m_e(t,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function m_e(t,e,n){return String.fromCharCode(...t.slice(e,n))}function A_e(t){return[...t].map(e=>e.charCodeAt(0))}function __e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=A_e(e);for(let i=0;i<r.length;++i)if(r[i]!==t[i+n])return!1;return!0}const Id=!1,dw=!0;function d5(t){const e=RE(t);return v_e(e)||w_e(e)||x_e(e)||b_e(e)||y_e(e)}function y_e(t){const e=new Uint8Array(t instanceof DataView?t.buffer:t),n=p_e(e);return n?{mimeType:n.mimeType,width:0,height:0}:null}function v_e(t){const e=RE(t);return e.byteLength>=24&&e.getUint32(0,Id)===2303741511?{mimeType:"image/png",width:e.getUint32(16,Id),height:e.getUint32(20,Id)}:null}function x_e(t){const e=RE(t);return e.byteLength>=10&&e.getUint32(0,Id)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,dw),height:e.getUint16(8,dw)}:null}function b_e(t){const e=RE(t);return e.byteLength>=14&&e.getUint16(0,Id)===16973&&e.getUint32(2,dw)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,dw),height:e.getUint32(22,dw)}:null}function w_e(t){const e=RE(t);if(!(e.byteLength>=3&&e.getUint16(0,Id)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=E_e();let o=2;for(;o+9<e.byteLength;){const a=e.getUint16(o,Id);if(i.has(a))return{mimeType:"image/jpeg",height:e.getUint16(o+5,Id),width:e.getUint16(o+7,Id)};if(!r.has(a))return null;o+=2,o+=e.getUint16(o,Id)}return null}function E_e(){const t=new Set([65499,65476,65484,65501,65534]);for(let n=65504;n<65520;++n)t.add(n);return{tableMarkers:t,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function RE(t){if(t instanceof DataView)return t;if(ArrayBuffer.isView(t))return new DataView(t.buffer);if(t instanceof ArrayBuffer)return new DataView(t);throw new Error("toDataView")}async function S_e(t,e){const{mimeType:n}=d5(t)||{},r=globalThis._parseImageNode;return co(r),await r(t,n)}async function T_e(t,e,n){e=e||{};const i=(e.image||{}).type||"auto",{url:o}=n||{},a=C_e(i);let s;switch(a){case"imagebitmap":s=await f_e(t,e,o);break;case"image":s=await Yee(t,e,o);break;case"data":s=await S_e(t);break;default:co(!1)}return i==="data"&&(s=i_e(s)),s}function C_e(t){switch(t){case"auto":case"data":return n_e();default:return t_e(t),t}}const P_e=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],I_e=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],M_e={image:{type:"auto",decode:!0}},Uw={id:"image",module:"images",name:"Images",version:K0e,mimeTypes:I_e,extensions:P_e,parse:T_e,tests:[t=>!!d5(new DataView(t))],options:M_e},GD={};function O_e(t){if(GD[t]===void 0){const e=NO?L_e(t):R_e(t);GD[t]=e}return GD[t]}function R_e(t){const e=["image/png","image/jpeg","image/gif"],{_parseImageNode:n,_imageFormatsNode:r=e}=globalThis;return!!n&&r.includes(t)}function L_e(t){switch(t){case"image/avif":case"image/webp":return D_e(t);default:return!0}}function D_e(t){try{return document.createElement("canvas").toDataURL(t).indexOf("data:".concat(t))===0}catch{return!1}}function Qee(t){if(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron)return!0;const e=typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent,n=t||e;return!!(n&&n.indexOf("Electron")>=0)}function wg(){return!(typeof process=="object"&&String(process)==="[object process]"&&!process.browser)||Qee()}const iC={self:typeof self<"u"&&self,window:typeof window<"u"&&window,global:typeof global<"u"&&global,document:typeof document<"u"&&document,process:typeof process=="object"&&process},CS=iC.window||iC.self||iC.global,lb=iC.process||{},Kee=typeof __VERSION__<"u"?__VERSION__:"untranspiled source";wg();const jD=globalThis;function Jee(t){if(!t&&!wg())return"Node";if(Qee(t))return"Electron";const n=t||(typeof navigator<"u"?navigator:{}).userAgent||"";if(n.indexOf("Edge")>-1)return"Edge";const r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i?"IE":jD.chrome?"Chrome":jD.safari?"Safari":jD.mozInnerScreenX?"Firefox":"Unknown"}function B_e(t){try{const e=window[t],n="__storage_test__";return e.setItem(n,n),e.removeItem(n),e}catch{return null}}class N_e{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"sessionStorage";q(this,"storage",void 0),q(this,"id",void 0),q(this,"config",void 0),this.storage=B_e(r),this.id=e,this.config=n,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const n=JSON.stringify(this.config);this.storage.setItem(this.id,n)}}_loadConfiguration(){let e={};if(this.storage){const n=this.storage.getItem(this.id);e=n?JSON.parse(n):{}}return Object.assign(this.config,e),this}}function F_e(t){let e;return t<10?e="".concat(t.toFixed(2),"ms"):t<100?e="".concat(t.toFixed(1),"ms"):t<1e3?e="".concat(t.toFixed(0),"ms"):e="".concat((t/1e3).toFixed(2),"s"),e}function k_e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:8;const n=Math.max(e-t.length,0);return"".concat(" ".repeat(n)).concat(t)}function VD(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:600;const i=t.src.replace(/\(/g,"%28").replace(/\)/g,"%29");t.width>r&&(n=Math.min(n,r/t.width));const o=t.width*n,a=t.height*n,s=["font-size:1px;","padding:".concat(Math.floor(a/2),"px ").concat(Math.floor(o/2),"px;"),"line-height:".concat(a,"px;"),"background:url(".concat(i,");"),"background-size:".concat(o,"px ").concat(a,"px;"),"color:transparent;"].join("");return["".concat(e," %c+"),s]}let rI;(function(t){t[t.BLACK=30]="BLACK",t[t.RED=31]="RED",t[t.GREEN=32]="GREEN",t[t.YELLOW=33]="YELLOW",t[t.BLUE=34]="BLUE",t[t.MAGENTA=35]="MAGENTA",t[t.CYAN=36]="CYAN",t[t.WHITE=37]="WHITE",t[t.BRIGHT_BLACK=90]="BRIGHT_BLACK",t[t.BRIGHT_RED=91]="BRIGHT_RED",t[t.BRIGHT_GREEN=92]="BRIGHT_GREEN",t[t.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",t[t.BRIGHT_BLUE=94]="BRIGHT_BLUE",t[t.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",t[t.BRIGHT_CYAN=96]="BRIGHT_CYAN",t[t.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(rI||(rI={}));function N9(t){return typeof t=="string"?rI[t.toUpperCase()]||rI.WHITE:t}function z_e(t,e,n){return!wg&&typeof t=="string"&&(e&&(e=N9(e),t="\x1B[".concat(e,"m").concat(t,"\x1B[39m")),n&&(e=N9(n),t="\x1B[".concat(n+10,"m").concat(t,"\x1B[49m"))),t}function U_e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:["constructor"];const n=Object.getPrototypeOf(t),r=Object.getOwnPropertyNames(n);for(const i of r)typeof t[i]=="function"&&(e.find(o=>i===o)||(t[i]=t[i].bind(t)))}function iI(t,e){if(!t)throw new Error(e||"Assertion failed")}function my(){let t;if(wg&&"performance"in CS){var e,n;t=CS==null||(e=CS.performance)===null||e===void 0||(n=e.now)===null||n===void 0?void 0:n.call(e)}else if("hrtime"in lb){var r;const i=lb==null||(r=lb.hrtime)===null||r===void 0?void 0:r.call(lb);t=i[0]*1e3+i[1]/1e6}else t=Date.now();return t}const Ay={debug:wg&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},G_e={enabled:!0,level:0};function sf(){}const F9={},k9={once:!0};class p5{constructor(){let{id:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{id:""};q(this,"id",void 0),q(this,"VERSION",Kee),q(this,"_startTs",my()),q(this,"_deltaTs",my()),q(this,"_storage",void 0),q(this,"userData",{}),q(this,"LOG_THROTTLE_TIMEOUT",0),this.id=e,this.userData={},this._storage=new N_e("__probe-".concat(this.id,"__"),G_e),this.timeStamp("".concat(this.id," started")),U_e(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((my()-this._startTs).toPrecision(10))}getDelta(){return Number((my()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,n){this._storage.setConfiguration({[e]:n})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,n){iI(e,n)}warn(e){return this._getLogFunction(0,e,Ay.warn,arguments,k9)}error(e){return this._getLogFunction(0,e,Ay.error,arguments)}deprecated(e,n){return this.warn("`".concat(e,"` is deprecated and will be removed in a later version. Use `").concat(n,"` instead"))}removed(e,n){return this.error("`".concat(e,"` has been removed. Use `").concat(n,"` instead"))}probe(e,n){return this._getLogFunction(e,n,Ay.log,arguments,{time:!0,once:!0})}log(e,n){return this._getLogFunction(e,n,Ay.debug,arguments)}info(e,n){return this._getLogFunction(e,n,console.info,arguments)}once(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return this._getLogFunction(e,n,Ay.debug||Ay.info,arguments,k9)}table(e,n,r){return n?this._getLogFunction(e,n,console.table||sf,r&&[r],{tag:H_e(n)}):sf}image(e){let{logLevel:n,priority:r,image:i,message:o="",scale:a=1}=e;return this._shouldLog(n||r)?wg?$_e({image:i,message:o,scale:a}):V_e():sf}time(e,n){return this._getLogFunction(e,n,console.time?console.time:console.info)}timeEnd(e,n){return this._getLogFunction(e,n,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,n){return this._getLogFunction(e,n,console.timeStamp||sf)}group(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{collapsed:!1};const i=z9({logLevel:e,message:n,opts:r}),{collapsed:o}=r;return i.method=(o?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.group(e,n,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||sf)}withGroup(e,n,r){this.group(e,n)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=ete(e)}_getLogFunction(e,n,r,i,o){if(this._shouldLog(e)){o=z9({logLevel:e,message:n,args:i,opts:o}),r=r||o.method,iI(r),o.total=this.getTotal(),o.delta=this.getDelta(),this._deltaTs=my();const a=o.tag||o.message;if(o.once)if(!F9[a])F9[a]=my();else return sf;return n=j_e(this.id,o.message,o),r.bind(console,n,...o.args)}return sf}}q(p5,"VERSION",Kee);function ete(t){if(!t)return 0;let e;switch(typeof t){case"number":e=t;break;case"object":e=t.logLevel||t.priority||0;break;default:return 0}return iI(Number.isFinite(e)&&e>=0),e}function z9(t){const{logLevel:e,message:n}=t;t.logLevel=ete(e);const r=t.args?Array.from(t.args):[];for(;r.length&&r.shift()!==n;);switch(typeof e){case"string":case"function":n!==void 0&&r.unshift(n),t.message=e;break;case"object":Object.assign(t,e);break}typeof t.message=="function"&&(t.message=t.message());const i=typeof t.message;return iI(i==="string"||i==="object"),Object.assign(t,{args:r},t.opts)}function j_e(t,e,n){if(typeof e=="string"){const r=n.time?k_e(F_e(n.total)):"";e=n.time?"".concat(t,": ").concat(r,"  ").concat(e):"".concat(t,": ").concat(e),e=z_e(e,n.color,n.background)}return e}function V_e(t){return console.warn("removed"),sf}function $_e(t){let{image:e,message:n="",scale:r=1}=t;if(typeof e=="string"){const o=new Image;return o.onload=()=>{const a=VD(o,n,r);console.log(...a)},o.src=e,sf}const i=e.nodeName||"";if(i.toLowerCase()==="img")return console.log(...VD(e,n,r)),sf;if(i.toLowerCase()==="canvas"){const o=new Image;return o.onload=()=>console.log(...VD(o,n,r)),o.src=e.toDataURL(),sf}return sf}function H_e(t){for(const e in t)for(const n in t[e])return n||"untitled";return"empty"}const Or=new p5({id:"deck"});let DF={};function W_e(t){DF=t}function _l(t,e,n,r){Or.level>0&&DF[t]&&DF[t].call(null,e,n,r)}function q_e(t){const e=t[0],n=t[t.length-1];return e==="{"&&n==="}"||e==="["&&n==="]"}const X_e={id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:q_e,parseTextSync:JSON.parse};function Z_e(){const t="8.9.32",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==t)throw new Error("deck.gl - multiple versions detected: ".concat(e," vs ").concat(t));return e||(Or.log(1,"deck.gl ".concat(t))(),globalThis.deck={...globalThis.deck,VERSION:t,version:t,log:Or,_registerLoggers:W_e},T0e([X_e,[Uw,{imagebitmap:{premultiplyAlpha:"none"}}]])),t}const tte=Z_e(),Br={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Br,"IDENTITY",{get:()=>(Or.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const hh={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Bu={common:0,meters:1,pixels:2},U9={click:{handler:"onClick"},panstart:{handler:"onDragStart"},panmove:{handler:"onDrag"},panend:{handler:"onDragEnd"}},Y_e={DRAW:"draw",MASK:"mask",TERRAIN:"terrain"},Yn=new p5({id:"luma.gl"});function Wl(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}const Q_e="Invalid WebGLRenderingContext",K_e="Requires WebGL2";function LE(t){return typeof WebGLRenderingContext<"u"&&t instanceof WebGLRenderingContext||typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&Number.isFinite(t._version))}function Hr(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function J_e(t){return Hr(t)?t:null}function kO(t){return Wl(LE(t),Q_e),t}function Xa(t){return Wl(Hr(t),K_e),t}const Zb={};function eye(t){globalThis.console&&globalThis.console.error&&globalThis.console.error(t)}function tye(t){globalThis.console&&globalThis.console.log&&globalThis.console.log(t)}function nye(t,e){Zb[t]=!0,e!==void 0&&eye(e)}function rye(t){const e=t.getError;t.getError=function(){let r;do r=e.apply(t),r!==0&&(Zb[r]=!0);while(r!==0);for(r in Zb)if(Zb[r])return delete Zb[r],parseInt(r,10);return 0}}const DE=function t(e){const n=e.gl;this.ext=e,this.isAlive=!0,this.hasBeenBound=!1,this.elementArrayBuffer=null,this.attribs=new Array(e.maxVertexAttribs);for(let r=0;r<this.attribs.length;r++){const i=new t.VertexAttrib(n);this.attribs[r]=i}this.maxAttrib=0};DE.VertexAttrib=function(e){this.enabled=!1,this.buffer=null,this.size=4,this.type=5126,this.normalized=!1,this.stride=16,this.offset=0,this.cached="",this.recache()};DE.VertexAttrib.prototype.recache=function(){this.cached=[this.size,this.type,this.normalized,this.stride,this.offset].join(":")};const f_=function(e){const n=this;this.gl=e,rye(e);const r=this.original={getParameter:e.getParameter,enableVertexAttribArray:e.enableVertexAttribArray,disableVertexAttribArray:e.disableVertexAttribArray,bindBuffer:e.bindBuffer,getVertexAttrib:e.getVertexAttrib,vertexAttribPointer:e.vertexAttribPointer};e.getParameter=function(o){return o===n.VERTEX_ARRAY_BINDING_OES?n.currentVertexArrayObject===n.defaultVertexArrayObject?null:n.currentVertexArrayObject:r.getParameter.apply(this,arguments)},e.enableVertexAttribArray=function(o){const a=n.currentVertexArrayObject;a.maxAttrib=Math.max(a.maxAttrib,o);const s=a.attribs[o];return s.enabled=!0,r.enableVertexAttribArray.apply(this,arguments)},e.disableVertexAttribArray=function(o){const a=n.currentVertexArrayObject;a.maxAttrib=Math.max(a.maxAttrib,o);const s=a.attribs[o];return s.enabled=!1,r.disableVertexAttribArray.apply(this,arguments)},e.bindBuffer=function(o,a){switch(o){case 34962:n.currentArrayBuffer=a;break;case 34963:n.currentVertexArrayObject.elementArrayBuffer=a;break}return r.bindBuffer.apply(this,arguments)},e.getVertexAttrib=function(o,a){const u=n.currentVertexArrayObject.attribs[o];switch(a){case 34975:return u.buffer;case 34338:return u.enabled;case 34339:return u.size;case 34340:return u.stride;case 34341:return u.type;case 34922:return u.normalized;default:return r.getVertexAttrib.apply(this,arguments)}},e.vertexAttribPointer=function(o,a,s,u,d,g){const _=n.currentVertexArrayObject;_.maxAttrib=Math.max(_.maxAttrib,o);const E=_.attribs[o];return E.buffer=n.currentArrayBuffer,E.size=a,E.type=s,E.normalized=u,E.stride=d,E.offset=g,E.recache(),r.vertexAttribPointer.apply(this,arguments)},e.instrumentExtension&&e.instrumentExtension(this,"OES_vertex_array_object"),e.canvas&&e.canvas.addEventListener("webglcontextrestored",()=>{tye("OESVertexArrayObject emulation library context restored"),n.reset_()},!0),this.reset_()};f_.prototype.VERTEX_ARRAY_BINDING_OES=34229;f_.prototype.reset_=function(){if(this.vertexArrayObjects!==void 0)for(let r=0;r<this.vertexArrayObjects.length;++r)this.vertexArrayObjects.isAlive=!1;const n=this.gl;this.maxVertexAttribs=n.getParameter(34921),this.defaultVertexArrayObject=new DE(this),this.currentVertexArrayObject=null,this.currentArrayBuffer=null,this.vertexArrayObjects=[this.defaultVertexArrayObject],this.bindVertexArrayOES(null)};f_.prototype.createVertexArrayOES=function(){const e=new DE(this);return this.vertexArrayObjects.push(e),e};f_.prototype.deleteVertexArrayOES=function(e){e.isAlive=!1,this.vertexArrayObjects.splice(this.vertexArrayObjects.indexOf(e),1),this.currentVertexArrayObject===e&&this.bindVertexArrayOES(null)};f_.prototype.isVertexArrayOES=function(e){return!!(e&&e instanceof DE&&e.hasBeenBound&&e.ext===this)};f_.prototype.bindVertexArrayOES=function(e){const n=this.gl;if(e&&!e.isAlive){nye(1282,"bindVertexArrayOES: attempt to bind deleted arrayObject");return}const r=this.original,i=this.currentVertexArrayObject;this.currentVertexArrayObject=e||this.defaultVertexArrayObject,this.currentVertexArrayObject.hasBeenBound=!0;const o=this.currentVertexArrayObject;if(i===o)return;(!i||o.elementArrayBuffer!==i.elementArrayBuffer)&&r.bindBuffer.call(n,34963,o.elementArrayBuffer);let a=this.currentArrayBuffer;const s=Math.max(i?i.maxAttrib:0,o.maxAttrib);for(let u=0;u<=s;u++){const d=o.attribs[u],g=i?i.attribs[u]:null;if((!i||d.enabled!==g.enabled)&&(d.enabled?r.enableVertexAttribArray.call(n,u):r.disableVertexAttribArray.call(n,u)),d.enabled){let _=!1;(!i||d.buffer!==g.buffer)&&(a!==d.buffer&&(r.bindBuffer.call(n,34962,d.buffer),a=d.buffer),_=!0),(_||d.cached!==g.cached)&&r.vertexAttribPointer.call(n,u,d.size,d.type,d.normalized,d.stride,d.offset)}}this.currentArrayBuffer!==a&&r.bindBuffer.call(n,34962,this.currentArrayBuffer)};function iye(t){if(typeof t.createVertexArray=="function")return;const e=t.getSupportedExtensions;t.getSupportedExtensions=function(){const i=e.call(this)||[];return i.indexOf("OES_vertex_array_object")<0&&i.push("OES_vertex_array_object"),i};const n=t.getExtension;t.getExtension=function(i){const o=n.call(this,i);return o||(i!=="OES_vertex_array_object"?null:(t.__OESVertexArrayObject||(this.__OESVertexArrayObject=new f_(this)),this.__OESVertexArrayObject))}}const G9="OES_element_index",j9="WEBGL_draw_buffers",oye="EXT_disjoint_timer_query",sye="EXT_disjoint_timer_query_webgl2",aye="EXT_texture_filter_anisotropic",V9="WEBGL_debug_renderer_info",lye=35723,uye=4352,cye=36795,fye=34047,hye=37445,dye=37446,yo=t=>Hr(t)?void 0:0,pye={3074:t=>Hr(t)?void 0:36064,[lye]:t=>Hr(t)?void 0:uye,35977:yo,32937:yo,[cye]:(t,e)=>{const n=Hr(t)?t.getExtension(sye):t.getExtension(oye);return n&&n.GPU_DISJOINT_EXT?e(n.GPU_DISJOINT_EXT):0},[hye]:(t,e)=>{const n=t.getExtension(V9);return e(n&&n.UNMASKED_VENDOR_WEBGL||7936)},[dye]:(t,e)=>{const n=t.getExtension(V9);return e(n&&n.UNMASKED_RENDERER_WEBGL||7937)},[fye]:(t,e)=>{const n=t.luma.extensions[aye];return n?e(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):1},32883:yo,35071:yo,37447:yo,36063:(t,e)=>{if(!Hr(t)){const n=t.getExtension(j9);return n?e(n.MAX_COLOR_ATTACHMENTS_WEBGL):0}},35379:yo,35374:yo,35377:yo,34852:t=>{if(!Hr(t)){const e=t.getExtension(j9);return e?e.MAX_DRAW_BUFFERS_WEBGL:0}},36203:t=>t.getExtension(G9)?2147483647:65535,33001:t=>t.getExtension(G9)?16777216:65535,33e3:t=>16777216,37157:yo,35373:yo,35657:yo,36183:yo,37137:yo,34045:yo,35978:yo,35979:yo,35968:yo,35376:yo,35375:yo,35659:yo,37154:yo,35371:yo,35658:yo,35076:yo,35077:yo,35380:yo};function gye(t,e,n){const r=pye[n],i=typeof r=="function"?r(t,e,n):r;return i!==void 0?i:e(n)}const mye="OES_vertex_array_object",nte="ANGLE_instanced_arrays",Aye="WEBGL_draw_buffers",_ye="EXT_disjoint_timer_query",yye="EXT_texture_filter_anisotropic",vye="VertexArray requires WebGL2 or OES_vertex_array_object extension";function xye(t,e){return{webgl2:Hr(t),ext:t.getExtension(e)}}const rte={[mye]:{meta:{suffix:"OES"},createVertexArray:()=>{Wl(!1,vye)},deleteVertexArray:()=>{},bindVertexArray:()=>{},isVertexArray:()=>!1},[nte]:{meta:{suffix:"ANGLE"},vertexAttribDivisor(t,e){Wl(e===0,"WebGL instanced rendering not supported")},drawElementsInstanced:()=>{},drawArraysInstanced:()=>{}},[Aye]:{meta:{suffix:"WEBGL"},drawBuffers:()=>{Wl(!1)}},[_ye]:{meta:{suffix:"EXT"},createQuery:()=>{Wl(!1)},deleteQuery:()=>{Wl(!1)},beginQuery:()=>{Wl(!1)},endQuery:()=>{},getQuery(t,e){return this.getQueryObject(t,e)},getQueryParameter(t,e){return this.getQueryObject(t,e)},getQueryObject:()=>{}}},$D={readBuffer:(t,e,n)=>{Hr(t)&&e(n)},getVertexAttrib:(t,e,n,r)=>{const{webgl2:i,ext:o}=xye(t,nte);let a;switch(r){case 35069:a=i?void 0:!1;break;case 35070:a=!i&&!o?0:void 0;break}return a!==void 0?a:e(n,r)},getProgramParameter:(t,e,n,r)=>{if(!Hr(t))switch(r){case 35967:return 35981;case 35971:return 0;case 35382:return 0}return e(n,r)},getInternalformatParameter:(t,e,n,r,i)=>{if(!Hr(t))switch(i){case 32937:return new Int32Array([0])}return t.getInternalformatParameter(n,r,i)},getTexParameter(t,e,n,r){switch(r){case 34046:const{extensions:i}=t.luma,o=i[yye];r=o&&o.TEXTURE_MAX_ANISOTROPY_EXT||34046;break}return e(n,r)},getParameter:gye,hint(t,e,n,r){return e(n,r)}};function bye(t){t.luma=t.luma||{};const{luma:e}=t;return e.polyfilled||(iye(t),wye(t),Sye(t,rte),Eye(t,{target:e,target2:t}),e.polyfilled=!0),t}globalThis.polyfillContext=bye;function wye(t){t.luma.extensions={};const e=t.getSupportedExtensions()||[];for(const n of e)t.luma[n]=t.getExtension(n)}function Eye(t,e){let{target:n,target2:r}=e;Object.keys($D).forEach(i=>{if(typeof $D[i]=="function"){const o=t[i]?t[i].bind(t):()=>{},a=$D[i].bind(null,t,o);n[i]=a,r[i]=a}})}function Sye(t,e){for(const n of Object.getOwnPropertyNames(e))n!=="overrides"&&Tye(t,{extension:n,target:t.luma,target2:t})}function Tye(t,e){let{extension:n,target:r,target2:i}=e;const o=rte[n];Wl(o);const{meta:a={}}=o,{suffix:s=""}=a,u=t.getExtension(n);for(const d of Object.keys(o)){const g="".concat(d).concat(s);let _=null;d==="meta"||typeof t[d]=="function"||(u&&typeof u[g]=="function"?_=function(){return u[g](...arguments)}:typeof o[d]=="function"&&(_=o[d].bind(r))),_&&(r[d]=_,i[d]=_)}}const g5={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,36006:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],3333:4,3317:4,37440:!1,37441:!1,37443:37444,35723:4352,36010:null,35977:!1,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},lm=(t,e,n)=>e?t.enable(n):t.disable(n),$9=(t,e,n)=>t.hint(n,e),tc=(t,e,n)=>t.pixelStorei(n,e),Cye=(t,e)=>{const n=Hr(t)?36009:36160;return t.bindFramebuffer(n,e)},Pye=(t,e)=>t.bindFramebuffer(36008,e);function ub(t){return Array.isArray(t)||ArrayBuffer.isView(t)}const Iye={3042:lm,32773:(t,e)=>t.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(t,e)=>t.clearColor(...e),3107:(t,e)=>t.colorMask(...e),2884:lm,2885:(t,e)=>t.cullFace(e),2929:lm,2931:(t,e)=>t.clearDepth(e),2932:(t,e)=>t.depthFunc(e),2928:(t,e)=>t.depthRange(...e),2930:(t,e)=>t.depthMask(e),3024:lm,35723:$9,36006:Cye,2886:(t,e)=>t.frontFace(e),33170:$9,2849:(t,e)=>t.lineWidth(e),32823:lm,32824:"polygonOffset",10752:"polygonOffset",35977:lm,32938:"sampleCoverage",32939:"sampleCoverage",3089:lm,3088:(t,e)=>t.scissor(...e),2960:lm,2961:(t,e)=>t.clearStencil(e),2968:(t,e)=>t.stencilMaskSeparate(1028,e),36005:(t,e)=>t.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(t,e)=>t.viewport(...e),3333:tc,3317:tc,37440:tc,37441:tc,37443:tc,3330:tc,3332:tc,3331:tc,36010:Pye,3314:tc,32878:tc,3316:tc,3315:tc,32877:tc,framebuffer:(t,e)=>{const n=e&&"handle"in e?e.handle:e;return t.bindFramebuffer(36160,n)},blend:(t,e)=>e?t.enable(3042):t.disable(3042),blendColor:(t,e)=>t.blendColor(...e),blendEquation:(t,e)=>{e=ub(e)?e:[e,e],t.blendEquationSeparate(...e)},blendFunc:(t,e)=>{e=ub(e)&&e.length===2?[...e,...e]:e,t.blendFuncSeparate(...e)},clearColor:(t,e)=>t.clearColor(...e),clearDepth:(t,e)=>t.clearDepth(e),clearStencil:(t,e)=>t.clearStencil(e),colorMask:(t,e)=>t.colorMask(...e),cull:(t,e)=>e?t.enable(2884):t.disable(2884),cullFace:(t,e)=>t.cullFace(e),depthTest:(t,e)=>e?t.enable(2929):t.disable(2929),depthFunc:(t,e)=>t.depthFunc(e),depthMask:(t,e)=>t.depthMask(e),depthRange:(t,e)=>t.depthRange(...e),dither:(t,e)=>e?t.enable(3024):t.disable(3024),derivativeHint:(t,e)=>{t.hint(35723,e)},frontFace:(t,e)=>t.frontFace(e),mipmapHint:(t,e)=>t.hint(33170,e),lineWidth:(t,e)=>t.lineWidth(e),polygonOffsetFill:(t,e)=>e?t.enable(32823):t.disable(32823),polygonOffset:(t,e)=>t.polygonOffset(...e),sampleCoverage:(t,e)=>t.sampleCoverage(...e),scissorTest:(t,e)=>e?t.enable(3089):t.disable(3089),scissor:(t,e)=>t.scissor(...e),stencilTest:(t,e)=>e?t.enable(2960):t.disable(2960),stencilMask:(t,e)=>{e=ub(e)?e:[e,e];const[n,r]=e;t.stencilMaskSeparate(1028,n),t.stencilMaskSeparate(1029,r)},stencilFunc:(t,e)=>{e=ub(e)&&e.length===3?[...e,...e]:e;const[n,r,i,o,a,s]=e;t.stencilFuncSeparate(1028,n,r,i),t.stencilFuncSeparate(1029,o,a,s)},stencilOp:(t,e)=>{e=ub(e)&&e.length===3?[...e,...e]:e;const[n,r,i,o,a,s]=e;t.stencilOpSeparate(1028,n,r,i),t.stencilOpSeparate(1029,o,a,s)},viewport:(t,e)=>t.viewport(...e)};function ps(t,e,n){return e[t]!==void 0?e[t]:n[t]}const Mye={blendEquation:(t,e,n)=>t.blendEquationSeparate(ps(32777,e,n),ps(34877,e,n)),blendFunc:(t,e,n)=>t.blendFuncSeparate(ps(32969,e,n),ps(32968,e,n),ps(32971,e,n),ps(32970,e,n)),polygonOffset:(t,e,n)=>t.polygonOffset(ps(32824,e,n),ps(10752,e,n)),sampleCoverage:(t,e,n)=>t.sampleCoverage(ps(32938,e,n),ps(32939,e,n)),stencilFuncFront:(t,e,n)=>t.stencilFuncSeparate(1028,ps(2962,e,n),ps(2967,e,n),ps(2963,e,n)),stencilFuncBack:(t,e,n)=>t.stencilFuncSeparate(1029,ps(34816,e,n),ps(36003,e,n),ps(36004,e,n)),stencilOpFront:(t,e,n)=>t.stencilOpSeparate(1028,ps(2964,e,n),ps(2965,e,n),ps(2966,e,n)),stencilOpBack:(t,e,n)=>t.stencilOpSeparate(1029,ps(34817,e,n),ps(34818,e,n),ps(34819,e,n))},H9={enable:(t,e)=>t({[e]:!0}),disable:(t,e)=>t({[e]:!1}),pixelStorei:(t,e,n)=>t({[e]:n}),hint:(t,e,n)=>t({[e]:n}),bindFramebuffer:(t,e,n)=>{switch(e){case 36160:return t({36006:n,36010:n});case 36009:return t({36006:n});case 36008:return t({36010:n});default:return null}},blendColor:(t,e,n,r,i)=>t({32773:new Float32Array([e,n,r,i])}),blendEquation:(t,e)=>t({32777:e,34877:e}),blendEquationSeparate:(t,e,n)=>t({32777:e,34877:n}),blendFunc:(t,e,n)=>t({32969:e,32968:n,32971:e,32970:n}),blendFuncSeparate:(t,e,n,r,i)=>t({32969:e,32968:n,32971:r,32970:i}),clearColor:(t,e,n,r,i)=>t({3106:new Float32Array([e,n,r,i])}),clearDepth:(t,e)=>t({2931:e}),clearStencil:(t,e)=>t({2961:e}),colorMask:(t,e,n,r,i)=>t({3107:[e,n,r,i]}),cullFace:(t,e)=>t({2885:e}),depthFunc:(t,e)=>t({2932:e}),depthRange:(t,e,n)=>t({2928:new Float32Array([e,n])}),depthMask:(t,e)=>t({2930:e}),frontFace:(t,e)=>t({2886:e}),lineWidth:(t,e)=>t({2849:e}),polygonOffset:(t,e,n)=>t({32824:e,10752:n}),sampleCoverage:(t,e,n)=>t({32938:e,32939:n}),scissor:(t,e,n,r,i)=>t({3088:new Int32Array([e,n,r,i])}),stencilMask:(t,e)=>t({2968:e,36005:e}),stencilMaskSeparate:(t,e,n)=>t({[e===1028?2968:36005]:n}),stencilFunc:(t,e,n,r)=>t({2962:e,2967:n,2963:r,34816:e,36003:n,36004:r}),stencilFuncSeparate:(t,e,n,r,i)=>t({[e===1028?2962:34816]:n,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(t,e,n,r)=>t({2964:e,2965:n,2966:r,34817:e,34818:n,34819:r}),stencilOpSeparate:(t,e,n,r,i)=>t({[e===1028?2964:34817]:n,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(t,e,n,r,i)=>t({2978:[e,n,r,i]})},hd=(t,e)=>t.isEnabled(e),W9={3042:hd,2884:hd,2929:hd,3024:hd,32823:hd,32926:hd,32928:hd,3089:hd,2960:hd,35977:hd};function ite(t){for(const e in t)return!1;return!0}function Oye(t,e){if(t===e)return!0;const n=Array.isArray(t)||ArrayBuffer.isView(t),r=Array.isArray(e)||ArrayBuffer.isView(e);if(n&&r&&t.length===e.length){for(let i=0;i<t.length;++i)if(t[i]!==e[i])return!1;return!0}return!1}function q9(t,e){const n=t[e].bind(t);t[e]=function(){const i=arguments.length<=0?void 0:arguments[0];return i in t.state.cache?t.state.enable?t.state.cache[i]:n(...arguments):n(...arguments)},Object.defineProperty(t[e],"name",{value:"".concat(e,"-from-cache"),configurable:!1})}function Rye(t,e,n){const r=t[e].bind(t);t[e]=function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];const{valueChanged:u,oldValue:d}=n(t.state._updateCache,...a);return u&&r(...a),d},Object.defineProperty(t[e],"name",{value:"".concat(e,"-to-cache"),configurable:!1})}function Lye(t){const e=t.useProgram.bind(t);t.useProgram=function(r){t.state.program!==r&&(e(r),t.state.program=r)}}class Dye{constructor(e){let{copyState:n=!1,log:r=()=>{}}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.program=null,this.stateStack=[],this.enable=!0,this.cache=n?ste(e):Object.assign({},g5),this.log=r,this._updateCache=this._updateCache.bind(this),Object.seal(this)}push(){this.stateStack.push({})}pop(){Wl(this.stateStack.length>0);const e=this.stateStack[this.stateStack.length-1];bh(this.gl,e),this.stateStack.pop()}_updateCache(e){let n=!1,r;const i=this.stateStack.length>0&&this.stateStack[this.stateStack.length-1];for(const o in e){Wl(o!==void 0);const a=e[o],s=this.cache[o];Oye(a,s)||(n=!0,r=s,i&&!(o in i)&&(i[o]=s),this.cache[o]=a)}return{valueChanged:n,oldValue:r}}}function ote(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{enable:n=!0,copyState:r}=e;if(Wl(r!==void 0),!t.state){const{polyfillContext:i}=globalThis;i&&i(t),t.state=new Dye(t,{copyState:r}),Lye(t);for(const o in H9){const a=H9[o];Rye(t,o,a)}q9(t,"getParameter"),q9(t,"isEnabled")}return t.state.enable=n,t}function Bye(t){t.state||ote(t,{copyState:!1}),t.state.push()}function X9(t){Wl(t.state),t.state.pop()}function bh(t,e){if(Wl(LE(t),"setParameters requires a WebGL context"),ite(e))return;const n={};for(const i in e){const o=Number(i),a=Iye[i];a&&(typeof a=="string"?n[a]=!0:a(t,e[i],o))}const r=t.state&&t.state.cache;if(r)for(const i in n){const o=Mye[i];o(t,e,r)}}function ste(t,e){if(e=e||g5,typeof e=="number"){const i=e,o=W9[i];return o?o(t,i):t.getParameter(i)}const n=Array.isArray(e)?e:Object.keys(e),r={};for(const i of n){const o=W9[i];r[i]=o?o(t,Number(i)):t.getParameter(Number(i))}return r}function ate(t){bh(t,g5)}function Mu(t,e,n){if(ite(e))return n(t);const{nocatch:r=!0}=e;Bye(t),bh(t,e);let i;if(r)i=n(t),X9(t);else try{i=n(t)}finally{X9(t)}return i}function B0(t){const{luma:e}=t;if(t.canvas&&e){const n=e.canvasSizeInfo,r="clientWidth"in n?n.clientWidth:t.canvas.clientWidth;return r?t.drawingBufferWidth/r:1}return 1}function oC(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=B0(t),i=t.drawingBufferWidth,o=t.drawingBufferHeight;return Fye(e,r,i,o,n)}function Nye(t){const e=typeof window>"u"?1:window.devicePixelRatio||1;return Number.isFinite(t)?t<=0?1:t:t?e:1}function Fye(t,e,n,r,i){const o=Z9(t[0],e,n);let a=Y9(t[1],e,r,i),s=Z9(t[0]+1,e,n);const u=s===n-1?s:s-1;s=Y9(t[1]+1,e,r,i);let d;return i?(s=s===0?s:s+1,d=a,a=s):d=s===r-1?s:s-1,{x:o,y:a,width:Math.max(u-o+1,1),height:Math.max(d-a+1,1)}}function Z9(t,e,n){return Math.min(Math.round(t*e),n-1)}function Y9(t,e,n,r){return r?Math.max(0,n-1-Math.round(t*e)):Math.min(Math.round(t*e),n-1)}const m5=wg(),kye=m5&&typeof document<"u",lte={webgl2:!0,webgl1:!0,throwOnError:!0,manageState:!0,canvas:null,debug:!1,width:800,height:600};function A5(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Wl(m5,`createGLContext only available in the browser.
Create your own headless context or use 'createHeadlessContext' from @luma.gl/test-utils`),t=Object.assign({},lte,t);const{width:e,height:n}=t;function r(s){if(t.throwOnError)throw new Error(s);return console.error(s),null}t.onError=r;let i;const{canvas:o}=t,a=jye({canvas:o,width:e,height:n,onError:r});return i=Gye(a,t),i?(i=zO(i,t),Vye(i),i):null}function zO(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t||t._instrumented)return t;t._version=t._version||$ye(t),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{},e=Object.assign({},lte,e);const{manageState:n,debug:r}=e;return n&&ote(t,{copyState:!1,log:function(){for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return Yn.log(1,...o)()}}),m5&&r&&(globalThis.makeDebugContext?(t=globalThis.makeDebugContext(t,e),Yn.level=Math.max(Yn.level,1)):Yn.warn('WebGL debug mode not activated. import "@luma.gl/debug" to enable.')()),t._instrumented=!0,t}function zye(t){const e=t.getParameter(7936),n=t.getParameter(7937),r=t.getExtension("WEBGL_debug_renderer_info"),i=r&&t.getParameter(r.UNMASKED_VENDOR_WEBGL||7936),o=r&&t.getParameter(r.UNMASKED_RENDERER_WEBGL||7937);return{vendor:i||e,renderer:o||n,vendorMasked:e,rendererMasked:n,version:t.getParameter(7938),shadingLanguageVersion:t.getParameter(35724)}}function Uye(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t.canvas){const r=Nye(e.useDevicePixels);Hye(t,r,e);return}const n=t.getExtension("STACKGL_resize_drawingbuffer");n&&"width"in e&&"height"in e&&n.resize(e.width,e.height)}function Gye(t,e){const{onError:n}=e;let r=null;const i=u=>r=u.statusMessage||r;t.addEventListener("webglcontextcreationerror",i,!1);const{webgl1:o=!0,webgl2:a=!0}=e;let s=null;return a&&(s=s||t.getContext("webgl2",e),s=s||t.getContext("experimental-webgl2",e)),o&&(s=s||t.getContext("webgl",e),s=s||t.getContext("experimental-webgl",e)),t.removeEventListener("webglcontextcreationerror",i,!1),s?(e.onContextLost&&t.addEventListener("webglcontextlost",e.onContextLost,!1),e.onContextRestored&&t.addEventListener("webglcontextrestored",e.onContextRestored,!1),s):n("Failed to create ".concat(a&&!o?"WebGL2":"WebGL"," context: ").concat(r||"Unknown error"))}function jye(t){let{canvas:e,width:n=800,height:r=600,onError:i}=t,o;return typeof e=="string"?(kye&&document.readyState==="complete"||i("createGLContext called on canvas '".concat(e,"' before page was loaded")),o=document.getElementById(e)):e?o=e:(o=document.createElement("canvas"),o.id="lumagl-canvas",o.style.width=Number.isFinite(n)?"".concat(n,"px"):"100%",o.style.height=Number.isFinite(r)?"".concat(r,"px"):"100%",document.body.insertBefore(o,document.body.firstChild)),o}function Vye(t){const e=Hr(t)?"WebGL2":"WebGL1",n=zye(t),r=n?"(".concat(n.vendor,",").concat(n.renderer,")"):"",i=t.debug?" debug":"";Yn.info(1,"".concat(e).concat(i," context ").concat(r))()}function $ye(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?2:1}function Hye(t,e,n){let r="width"in n?n.width:t.canvas.clientWidth,i="height"in n?n.height:t.canvas.clientHeight;(!r||!i)&&(Yn.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=t.canvas.width||1,i=t.canvas.height||1),t.luma=t.luma||{},t.luma.canvasSizeInfo=t.luma.canvasSizeInfo||{};const o=t.luma.canvasSizeInfo;if(o.clientWidth!==r||o.clientHeight!==i||o.devicePixelRatio!==e){let a=e;const s=Math.floor(r*a),u=Math.floor(i*a);t.canvas.width=s,t.canvas.height=u,(t.drawingBufferWidth!==s||t.drawingBufferHeight!==u)&&(Yn.warn("Device pixel ratio clamped")(),a=Math.min(t.drawingBufferWidth/r,t.drawingBufferHeight/i),t.canvas.width=Math.floor(r*a),t.canvas.height=Math.floor(i*a)),Object.assign(t.luma.canvasSizeInfo,{clientWidth:r,clientHeight:i,devicePixelRatio:e})}}function Q9(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}let K9=class{constructor(e,n){q(this,"name",void 0),q(this,"type",void 0),q(this,"sampleSize",1),q(this,"time",void 0),q(this,"count",void 0),q(this,"samples",void 0),q(this,"lastTiming",void 0),q(this,"lastSampleTime",void 0),q(this,"lastSampleCount",void 0),q(this,"_count",0),q(this,"_time",0),q(this,"_samples",0),q(this,"_startTime",0),q(this,"_timerPending",!1),this.name=e,this.type=n,this.reset()}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Q9(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Q9()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}},_5=class{constructor(e){q(this,"id",void 0),q(this,"stats",{}),this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e in this.stats)this.stats[e].reset();return this}forEach(e){for(const n in this.stats)e(this.stats[n])}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){if(!e||!e.name)return null;const{name:n,type:r}=e;return this.stats[n]||(e instanceof K9?this.stats[n]=e:this.stats[n]=new K9(n,r)),this.stats[n]}};const pw="8.5.21",Wye="set luma.log.level=1 (or higher) to trace rendering";class qye{constructor(){this.stats=new Map}get(e){return this.stats.has(e)||this.stats.set(e,new _5({id:e})),this.stats.get(e)}}const Im=new qye;if(globalThis.luma&&globalThis.luma.VERSION!==pw)throw new Error("luma.gl - multiple VERSIONs detected: ".concat(globalThis.luma.VERSION," vs ").concat(pw));globalThis.luma||(wg()&&Yn.log(1,"luma.gl ".concat(pw," - ").concat(Wye))(),globalThis.luma=globalThis.luma||{VERSION:pw,version:pw,log:Yn,stats:Im,globals:{modules:{},nodeIO:{}}});function Xye(t){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(t):setTimeout(t,1e3/60)}function Zye(t){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(t):clearTimeout(t)}function Nn(t,e){if(!t)throw new Error(e||"luma.gl: assertion failed.")}function HD(t,e){if(typeof e!="string")return e;const n=Number(e);if(!isNaN(n))return n;e=e.replace(/^.*\./,"");const r=t[e];return Nn(r!==void 0,"Accessing undefined constant GL.".concat(e)),r}function jm(t,e){e=Number(e);for(const n in t)if(t[n]===e)return"GL.".concat(n);return String(e)}const WD={};function Ma(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"id";WD[t]=WD[t]||1;const e=WD[t]++;return"".concat(t,"-").concat(e)}function J9(t){return Nn(typeof t=="number","Input must be a number"),t&&(t&t-1)===0}function Fv(t){let e=!0;for(const n in t){e=!1;break}return e}function ute(t,e,n,r){const i="See luma.gl ".concat(n," Upgrade Guide at https://luma.gl/docs/upgrade-guide"),o=Object.getPrototypeOf(t);r.forEach(a=>{o.methodName||(o[a]=()=>{throw Yn.removed("Calling removed method ".concat(e,".").concat(a,": "),i)(),new Error(a)})})}const _y="Resource subclass must define virtual methods";let Eg=class{get[Symbol.toStringTag](){return"Resource"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};kO(e);const{id:r,userData:i={}}=n;this.gl=e,this.gl2=e,this.id=r||Ma(this[Symbol.toStringTag]),this.userData=i,this._bound=!1,this._handle=n.handle,this._handle===void 0&&(this._handle=this._createHandle()),this.byteLength=0,this._addStats()}toString(){return"".concat(this[Symbol.toStringTag]||this.constructor.name,"(").concat(this.id,")")}get handle(){return this._handle}delete(){let{deleteChildren:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._handle&&this._deleteHandle(this._handle);return this._handle&&this._removeStats(),this._handle=null,n&&e&&n.filter(Boolean).forEach(r=>r.delete()),this}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.handle;if(typeof e!="function")return this._bindHandle(e),this;let n;return this._bound?n=e():(this._bindHandle(this.handle),this._bound=!0,n=e(),this._bound=!1,this._bindHandle(null)),n}unbind(){this.bind(null)}getParameter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e=HD(this.gl,e),Nn(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const o=Hr(this.gl);if(!((!("webgl2"in i)||o)&&(!("extension"in i)||this.gl.getExtension(i.extension)))){const s=i.webgl1,u="webgl2"in i?i.webgl2:i.webgl1;return o?u:s}}return this._getParameter(e,n)}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{parameters:n,keys:r}=e,i=this.constructor.PARAMETERS||{},o=Hr(this.gl),a={},s=n||Object.keys(i);for(const u of s){const d=i[u];if(d&&(!("webgl2"in d)||o)&&(!("extension"in d)||this.gl.getExtension(d.extension))){const _=r?jm(this.gl,u):u;a[_]=this.getParameter(u,e),r&&d.type==="GLenum"&&(a[_]=jm(this.gl,a[_]))}}return a}setParameter(e,n){e=HD(this.gl,e),Nn(e);const i=(this.constructor.PARAMETERS||{})[e];if(i){const o=Hr(this.gl);if(!((!("webgl2"in i)||o)&&(!("extension"in i)||this.gl.getExtension(i.extension))))throw new Error("Parameter not available on this platform");i.type==="GLenum"&&(n=HD(n))}return this._setParameter(e,n),this}setParameters(e){for(const n in e)this.setParameter(n,e[n]);return this}stubRemovedMethods(e,n,r){return ute(this,e,n,r)}initialize(e){}_createHandle(){throw new Error(_y)}_deleteHandle(){throw new Error(_y)}_bindHandle(e){throw new Error(_y)}_getOptsFromHandle(){throw new Error(_y)}_getParameter(e,n){throw new Error(_y)}_setParameter(e,n){throw new Error(_y)}_context(){return this.gl.luma=this.gl.luma||{},this.gl.luma}_addStats(){const e=this[Symbol.toStringTag],n=Im.get("Resource Counts");n.get("Resources Created").incrementCount(),n.get("".concat(e,"s Created")).incrementCount(),n.get("".concat(e,"s Active")).incrementCount()}_removeStats(){const e=this[Symbol.toStringTag];Im.get("Resource Counts").get("".concat(e,"s Active")).decrementCount()}_trackAllocatedMemory(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag];this._trackAllocatedMemoryForContext(e,n),this._trackAllocatedMemoryForContext(e,n,this.gl.canvas&&this.gl.canvas.id),this.byteLength=e}_trackAllocatedMemoryForContext(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this[Symbol.toStringTag],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";const i=Im.get("Memory Usage".concat(r));i.get("GPU Memory").addCount(e),i.get("".concat(n," Memory")).addCount(e)}_trackDeallocatedMemory(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag];this._trackDeallocatedMemoryForContext(e),this._trackDeallocatedMemoryForContext(e,this.gl.canvas&&this.gl.canvas.id),this.byteLength=0}_trackDeallocatedMemoryForContext(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this[Symbol.toStringTag],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=Im.get("Memory Usage".concat(n));r.get("GPU Memory").subtractCount(this.byteLength),r.get("".concat(e," Memory")).subtractCount(this.byteLength)}};const Yye="Failed to deduce GL constant from typed array";function BF(t){switch(ArrayBuffer.isView(t)?t.constructor:t){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(Yye)}}function Gw(t){let{clamped:e=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};switch(t){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return e?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Qye(t){let{data:e,width:n,height:r,bytesPerPixel:i=4,temp:o}=t;const a=n*i;o=o||new Uint8Array(a);for(let s=0;s<r/2;++s){const u=s*a,d=(r-s-1)*a;o.set(e.subarray(u,u+a)),e.copyWithin(u,d,d+a),e.set(o,d)}}function Kye(t){let{data:e,width:n,height:r}=t;const i=Math.round(n/2),o=Math.round(r/2),a=new Uint8Array(i*o*4);for(let s=0;s<o;s++)for(let u=0;u<i;u++)for(let d=0;d<4;d++)a[(s*i+u)*4+d]=e[(s*2*n+u*2)*4+d];return{data:a,width:i,height:o}}function NF(t,e,n){const{removedProps:r={},deprecatedProps:i={},replacedProps:o={}}=n;for(const s in r)if(s in e){const d=r[s]?"".concat(t,".").concat(r[s]):"N/A";Yn.removed("".concat(t,".").concat(s),d)()}for(const s in i)if(s in e){const u=i[s];Yn.deprecated("".concat(t,".").concat(s),"".concat(t,".").concat(u))()}let a=null;for(const s in o)if(s in e){const u=o[s];Yn.deprecated("".concat(t,".").concat(s),"".concat(t,".").concat(u))(),a=a||Object.assign({},e),a[u]=e[s],delete a[s]}return a||e}const Jye={offset:0,stride:0,type:5126,size:1,divisor:0,normalized:!1,integer:!1},eve={deprecatedProps:{instanced:"divisor",isInstanced:"divisor"}};class wu{static getBytesPerElement(e){return Gw(e.type||5126).BYTES_PER_ELEMENT}static getBytesPerVertex(e){return Nn(e.size),Gw(e.type||5126).BYTES_PER_ELEMENT*e.size}static resolve(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return new wu(Jye,...n)}constructor(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];n.forEach(i=>this._assign(i)),Object.freeze(this)}toString(){return JSON.stringify(this)}get BYTES_PER_ELEMENT(){return wu.getBytesPerElement(this)}get BYTES_PER_VERTEX(){return wu.getBytesPerVertex(this)}_assign(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e=NF("Accessor",e,eve),e.type!==void 0&&(this.type=e.type,(e.type===5124||e.type===5125)&&(this.integer=!0)),e.size!==void 0&&(this.size=e.size),e.offset!==void 0&&(this.offset=e.offset),e.stride!==void 0&&(this.stride=e.stride),e.normalized!==void 0&&(this.normalized=e.normalized),e.integer!==void 0&&(this.integer=e.integer),e.divisor!==void 0&&(this.divisor=e.divisor),e.buffer!==void 0&&(this.buffer=e.buffer),e.index!==void 0&&(typeof e.index=="boolean"?this.index=e.index?1:0:this.index=e.index),e.instanced!==void 0&&(this.divisor=e.instanced?1:0),e.isInstanced!==void 0&&(this.divisor=e.isInstanced?1:0),this}}const e$=10,cte={offset:"accessor.offset",stride:"accessor.stride",type:"accessor.type",size:"accessor.size",divisor:"accessor.divisor",normalized:"accessor.normalized",integer:"accessor.integer",instanced:"accessor.divisor",isInstanced:"accessor.divisor"},tve={removedProps:{},replacedProps:{bytes:"byteLength"},deprecatedProps:cte},nve={removedProps:cte};class ji extends Eg{get[Symbol.toStringTag](){return"Buffer"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Buffer","v6.0",["layout","setLayout","getIndexedParameter"]),this.target=n.target||(this.gl.webgl2?36662:34962),this.initialize(n),Object.seal(this)}getElementCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/wu.getBytesPerElement(e))}getVertexCount(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.accessor;return Math.round(this.byteLength/wu.getBytesPerVertex(e))}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return ArrayBuffer.isView(e)&&(e={data:e}),Number.isFinite(e)&&(e={byteLength:e}),e=NF("Buffer",e,tve),this.usage=e.usage||35044,this.debugData=null,this.setAccessor(Object.assign({},e,e.accessor)),e.data?this._setData(e.data,e.offset,e.byteLength):this._setByteLength(e.byteLength||0),this}setProps(e){return e=NF("Buffer",e,nve),"accessor"in e&&this.setAccessor(e.accessor),this}setAccessor(e){return e=Object.assign({},e),delete e.buffer,this.accessor=new wu(e),this}reallocate(e){return e>this.byteLength?(this._setByteLength(e),!0):(this.bytesUsed=e,!1)}setData(e){return this.initialize(e)}subData(e){ArrayBuffer.isView(e)&&(e={data:e});const{data:n,offset:r=0,srcOffset:i=0}=e,o=e.byteLength||e.length;Nn(n);const a=this.gl.webgl2?36663:this.target;return this.gl.bindBuffer(a,this.handle),i!==0||o!==void 0?(Xa(this.gl),this.gl.bufferSubData(this.target,r,n,i,o)):this.gl.bufferSubData(a,r,n),this.gl.bindBuffer(a,null),this.debugData=null,this._inferType(n),this}copyData(e){let{sourceBuffer:n,readOffset:r=0,writeOffset:i=0,size:o}=e;const{gl:a}=this;return Xa(a),a.bindBuffer(36662,n.handle),a.bindBuffer(36663,this.handle),a.copyBufferSubData(36662,36663,r,i,o),a.bindBuffer(36662,null),a.bindBuffer(36663,null),this.debugData=null,this}getData(){let{dstData:e=null,srcByteOffset:n=0,dstOffset:r=0,length:i=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Xa(this.gl);const o=Gw(this.accessor.type||5126,{clamped:!1}),a=this._getAvailableElementCount(n),s=r;let u,d;e?(d=e.length,u=d-s):(u=Math.min(a,i||a),d=s+u);const g=Math.min(a,u);return i=i||g,Nn(i<=g),e=e||new o(d),this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,n,e,r,i),this.gl.bindBuffer(36662,null),e}bind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index,offset:r=0,size:i}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?i!==void 0?this.gl.bindBufferRange(e,n,this.handle,r,i):(Nn(r===0),this.gl.bindBufferBase(e,n,this.handle)):this.gl.bindBuffer(e,this.handle),this}unbind(){let{target:e=this.target,index:n=this.accessor&&this.accessor.index}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return e===35345||e===35982?this.gl.bindBufferBase(e,n,null):this.gl.bindBuffer(e,null),this}getDebugData(){return this.debugData?{data:this.debugData,changed:!1}:(this.debugData=this.getData({length:Math.min(e$,this.byteLength)}),{data:this.debugData,changed:!0})}invalidateDebugData(){this.debugData=null}_setData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e.byteLength+n;Nn(ArrayBuffer.isView(e)),this._trackDeallocatedMemory();const i=this._getTarget();this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.usage),this.gl.bufferSubData(i,n,e),this.gl.bindBuffer(i,null),this.debugData=e.slice(0,e$),this.bytesUsed=r,this._trackAllocatedMemory(r);const o=BF(e);return Nn(o),this.setAccessor(new wu(this.accessor,{type:o})),this}_setByteLength(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.usage;Nn(e>=0),this._trackDeallocatedMemory();let r=e;e===0&&(r=new Float32Array(0));const i=this._getTarget();return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,n),this.gl.bindBuffer(i,null),this.usage=n,this.debugData=null,this.bytesUsed=e,this._trackAllocatedMemory(e),this}_getTarget(){return this.gl.webgl2?36663:this.target}_getAvailableElementCount(e){const n=Gw(this.accessor.type||5126,{clamped:!1}),r=e/n.BYTES_PER_ELEMENT;return this.getElementCount()-r}_inferType(e){this.accessor.type||this.setAccessor(new wu(this.accessor,{type:BF(e)}))}_createHandle(){return this.gl.createBuffer()}_deleteHandle(){this.gl.deleteBuffer(this.handle),this._trackDeallocatedMemory()}_getParameter(e){this.gl.bindBuffer(this.target,this.handle);const n=this.gl.getBufferParameter(this.target,e);return this.gl.bindBuffer(this.target,null),n}get type(){return Yn.deprecated("Buffer.type","Buffer.accessor.type")(),this.accessor.type}get bytes(){return Yn.deprecated("Buffer.bytes","Buffer.byteLength")(),this.byteLength}setByteLength(e){return Yn.deprecated("setByteLength","reallocate")(),this.reallocate(e)}updateAccessor(e){return Yn.deprecated("updateAccessor(...)","setAccessor(new Accessor(buffer.accessor, ...)")(),this.accessor=new wu(this.accessor,e),this}}const y5={6407:{dataFormat:6407,types:[5121,33635]},6408:{dataFormat:6408,types:[5121,32819,32820]},6406:{dataFormat:6406,types:[5121]},6409:{dataFormat:6409,types:[5121]},6410:{dataFormat:6410,types:[5121]},33326:{dataFormat:6403,types:[5126],gl2:!0},33328:{dataFormat:33319,types:[5126],gl2:!0},34837:{dataFormat:6407,types:[5126],gl2:!0},34836:{dataFormat:6408,types:[5126],gl2:!0}},fte={6403:1,36244:1,33319:2,33320:2,6407:3,36248:3,6408:4,36249:4,6402:1,34041:1,6406:1,6409:1,6410:2},hte={5126:4,5125:4,5124:4,5123:2,5122:2,5131:2,5120:1,5121:1};function rve(t,e){const n=y5[e];if(!n)return!1;if(n.gl1===void 0&&n.gl2===void 0)return!0;const r=Hr(t)&&n.gl2||n.gl1;return typeof r=="string"?t.getExtension(r):r}function ive(t,e){const n=y5[e];switch(n&&n.types[0]){case 5126:return t.getExtension("OES_texture_float_linear");case 5131:return t.getExtension("OES_texture_half_float_linear");default:return!0}}const ove=[9729,9728],t$=globalThis.WebGLBuffer||function(){};class N0 extends Eg{get[Symbol.toStringTag](){return"Texture"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{format:r,linearFiltering:i}=n;let o=!0;return r&&(o=o&&rve(e,r),o=o&&(!i||ive(e,r))),o}constructor(e,n){const{id:r=Ma("texture"),handle:i,target:o}=n;super(e,{id:r,handle:i}),this.target=o,this.textureUnit=void 0,this.loaded=!1,this.width=void 0,this.height=void 0,this.depth=void 0,this.format=void 0,this.type=void 0,this.dataFormat=void 0,this.border=void 0,this.textureUnit=void 0,this.mipmaps=void 0}toString(){return"Texture(".concat(this.id,",").concat(this.width,"x").concat(this.height,")")}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.data;if(n instanceof Promise)return n.then(F=>this.initialize(Object.assign({},e,{pixels:F,data:F}))),this;const r=typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement;if(r&&n.readyState<HTMLVideoElement.HAVE_METADATA)return this._video=null,n.addEventListener("loadeddata",()=>this.initialize(e)),this;const{pixels:i=null,format:o=6408,border:a=0,recreate:s=!1,parameters:u={},pixelStore:d={},textureUnit:g=void 0}=e;n||(n=i);let{width:_,height:E,dataFormat:P,type:O,compressed:D=!1,mipmaps:V=!0}=e;const{depth:k=0}=e;return{width:_,height:E,compressed:D,dataFormat:P,type:O}=this._deduceParameters({format:o,type:O,dataFormat:P,compressed:D,data:n,width:_,height:E}),this.width=_,this.height=E,this.depth=k,this.format=o,this.type=O,this.dataFormat=P,this.border=a,this.textureUnit=g,Number.isFinite(this.textureUnit)&&(this.gl.activeTexture(33984+this.textureUnit),this.gl.bindTexture(this.target,this.handle)),V&&this._isNPOT()&&(Yn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),V=!1,this._updateForNPOT(u)),this.mipmaps=V,this.setImageData({data:n,width:_,height:E,depth:k,format:o,type:O,dataFormat:P,border:a,mipmaps:V,parameters:d,compressed:D}),V&&this.generateMipmap(),this.setParameters(u),s&&(this.data=n),r&&(this._video={video:n,parameters:u,lastTime:n.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?n.currentTime:-1}),this}update(){if(this._video){const{video:e,parameters:n,lastTime:r}=this._video;if(r===e.currentTime||e.readyState<HTMLVideoElement.HAVE_CURRENT_DATA)return;this.setSubImageData({data:e,parameters:n}),this.mipmaps&&this.generateMipmap(),this._video.lastTime=e.currentTime}}resize(e){let{height:n,width:r,mipmaps:i=!1}=e;return r!==this.width||n!==this.height?this.initialize({width:r,height:n,format:this.format,type:this.type,dataFormat:this.dataFormat,border:this.border,mipmaps:i}):this}generateMipmap(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isNPOT()?(Yn.warn("texture: ".concat(this," is Non-Power-Of-Two, disabling mipmaping"))(),this):(this.mipmaps=!0,this.gl.bindTexture(this.target,this.handle),Mu(this.gl,e,()=>{this.gl.generateMipmap(this.target)}),this.gl.bindTexture(this.target,null),this)}setImageData(e){this._trackDeallocatedMemory("Texture");const{target:n=this.target,pixels:r=null,level:i=0,format:o=this.format,border:a=this.border,offset:s=0,parameters:u={}}=e;let{data:d=null,type:g=this.type,width:_=this.width,height:E=this.height,dataFormat:P=this.dataFormat,compressed:O=!1}=e;d||(d=r),{type:g,dataFormat:P,compressed:O,width:_,height:E}=this._deduceParameters({format:o,type:g,dataFormat:P,compressed:O,data:d,width:_,height:E});const{gl:D}=this;D.bindTexture(this.target,this.handle);let V=null;({data:d,dataType:V}=this._getDataType({data:d,compressed:O}));let k,F=0;if(Mu(this.gl,u,()=>{switch(V){case"null":D.texImage2D(n,i,o,_,E,a,P,g,d);break;case"typed-array":D.texImage2D(n,i,o,_,E,a,P,g,d,s);break;case"buffer":k=Xa(D),k.bindBuffer(35052,d.handle||d),k.texImage2D(n,i,o,_,E,a,P,g,s),k.bindBuffer(35052,null);break;case"browser-object":Hr(D)?D.texImage2D(n,i,o,_,E,a,P,g,d):D.texImage2D(n,i,o,P,g,d);break;case"compressed":for(const[z,X]of d.entries())D.compressedTexImage2D(n,z,X.format,X.width,X.height,a,X.data),F+=X.levelSize;break;default:Nn(!1,"Unknown image data type")}}),V==="compressed")this._trackAllocatedMemory(F,"Texture");else if(d&&d.byteLength)this._trackAllocatedMemory(d.byteLength,"Texture");else{const z=fte[this.dataFormat]||4,X=hte[this.type]||1;this._trackAllocatedMemory(this.width*this.height*z*X,"Texture")}return this.loaded=!0,this}setSubImageData(e){let{target:n=this.target,pixels:r=null,data:i=null,x:o=0,y:a=0,width:s=this.width,height:u=this.height,level:d=0,format:g=this.format,type:_=this.type,dataFormat:E=this.dataFormat,compressed:P=!1,offset:O=0,border:D=this.border,parameters:V={}}=e;if({type:_,dataFormat:E,compressed:P,width:s,height:u}=this._deduceParameters({format:g,type:_,dataFormat:E,compressed:P,data:i,width:s,height:u}),Nn(this.depth===0,"texSubImage not supported for 3D textures"),i||(i=r),i&&i.data){const k=i;i=k.data,s=k.shape[0],u=k.shape[1]}i instanceof ji&&(i=i.handle),this.gl.bindTexture(this.target,this.handle),Mu(this.gl,V,()=>{if(P)this.gl.compressedTexSubImage2D(n,d,o,a,s,u,g,i);else if(i===null)this.gl.texSubImage2D(n,d,o,a,s,u,E,_,null);else if(ArrayBuffer.isView(i))this.gl.texSubImage2D(n,d,o,a,s,u,E,_,i,O);else if(i instanceof t$){const k=Xa(this.gl);k.bindBuffer(35052,i),k.texSubImage2D(n,d,o,a,s,u,E,_,O),k.bindBuffer(35052,null)}else Hr(this.gl)?Xa(this.gl).texSubImage2D(n,d,o,a,s,u,E,_,i):this.gl.texSubImage2D(n,d,o,a,E,_,i)}),this.gl.bindTexture(this.target,null)}copyFramebuffer(){return Yn.error("Texture.copyFramebuffer({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,this.handle),e}unbind(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.textureUnit;const{gl:n}=this;return e!==void 0&&(this.textureUnit=e,n.activeTexture(33984+e)),n.bindTexture(this.target,null),e}_getDataType(e){let{data:n,compressed:r=!1}=e;return r?{data:n,dataType:"compressed"}:n===null?{data:n,dataType:"null"}:ArrayBuffer.isView(n)?{data:n,dataType:"typed-array"}:n instanceof ji?{data:n.handle,dataType:"buffer"}:n instanceof t$?{data:n,dataType:"buffer"}:{data:n,dataType:"browser-object"}}_deduceParameters(e){const{format:n,data:r}=e;let{width:i,height:o,dataFormat:a,type:s,compressed:u}=e;const d=y5[n];return a=a||d&&d.dataFormat,s=s||d&&d.types[0],u=u||d&&d.compressed,{width:i,height:o}=this._deduceImageSize(r,i,o),{dataFormat:a,type:s,compressed:u,width:i,height:o,format:n,data:r}}_deduceImageSize(e,n,r){let i;return typeof ImageData<"u"&&e instanceof ImageData?i={width:e.width,height:e.height}:typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement?i={width:e.naturalWidth,height:e.naturalHeight}:typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement?i={width:e.width,height:e.height}:typeof ImageBitmap<"u"&&e instanceof ImageBitmap?i={width:e.width,height:e.height}:typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?i={width:e.videoWidth,height:e.videoHeight}:e?i={width:n,height:r}:i={width:n>=0?n:1,height:r>=0?r:1},Nn(i,"Could not deduced texture size"),Nn(n===void 0||i.width===n,"Deduced texture width does not match supplied width"),Nn(r===void 0||i.height===r,"Deduced texture height does not match supplied height"),i}_createHandle(){return this.gl.createTexture()}_deleteHandle(){this.gl.deleteTexture(this.handle),this._trackDeallocatedMemory("Texture")}_getParameter(e){switch(e){case 4096:return this.width;case 4097:return this.height;default:this.gl.bindTexture(this.target,this.handle);const n=this.gl.getTexParameter(this.target,e);return this.gl.bindTexture(this.target,null),n}}_setParameter(e,n){switch(this.gl.bindTexture(this.target,this.handle),n=this._getNPOTParam(e,n),e){case 33082:case 33083:this.gl.texParameterf(this.handle,e,n);break;case 4096:case 4097:Nn(!1);break;default:this.gl.texParameteri(this.target,e,n);break}return this.gl.bindTexture(this.target,null),this}_isNPOT(){return Hr(this.gl)||!this.width||!this.height?!1:!J9(this.width)||!J9(this.height)}_updateForNPOT(e){e[this.gl.TEXTURE_MIN_FILTER]===void 0&&(e[this.gl.TEXTURE_MIN_FILTER]=this.gl.LINEAR),e[this.gl.TEXTURE_WRAP_S]===void 0&&(e[this.gl.TEXTURE_WRAP_S]=this.gl.CLAMP_TO_EDGE),e[this.gl.TEXTURE_WRAP_T]===void 0&&(e[this.gl.TEXTURE_WRAP_T]=this.gl.CLAMP_TO_EDGE)}_getNPOTParam(e,n){if(this._isNPOT())switch(e){case 10241:ove.indexOf(n)===-1&&(n=9729);break;case 10242:case 10243:n!==33071&&(n=33071);break}return n}}let sve="";function ave(t,e){return Nn(typeof t=="string"),t=sve+t,new Promise((n,r)=>{try{const i=new Image;i.onload=()=>n(i),i.onerror=()=>r(new Error("Could not load image ".concat(t,"."))),i.crossOrigin=e&&e.crossOrigin||"anonymous",i.src=t}catch(i){r(i)}})}class Pl extends N0{get[Symbol.toStringTag](){return"Texture2D"}static isSupported(e,n){return N0.isSupported(e,n)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};kO(e),(n instanceof Promise||typeof n=="string")&&(n={data:n}),typeof n.data=="string"&&(n=Object.assign({},n,{data:ave(n.data)})),super(e,Object.assign({},n,{target:3553})),this.initialize(n),Object.seal(this)}}const FF=[34069,34070,34071,34072,34073,34074];class v5 extends N0{get[Symbol.toStringTag](){return"TextureCube"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};kO(e),super(e,Object.assign({},n,{target:34067})),this.initialize(n),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{mipmaps:n=!0,parameters:r={}}=e;return this.opts=e,this.setCubeMapImageData(e).then(()=>{this.loaded=!0,n&&this.generateMipmap(e),this.setParameters(r)}),this}subImage(e){let{face:n,data:r,x:i=0,y:o=0,mipmapLevel:a=0}=e;return this._subImage({target:n,data:r,x:i,y:o,mipmapLevel:a})}async setCubeMapImageData(e){let{width:n,height:r,pixels:i,data:o,border:a=0,format:s=6408,type:u=5121}=e;const{gl:d}=this,g=i||o,_=await Promise.all(FF.map(E=>{const P=g[E];return Promise.all(Array.isArray(P)?P:[P])}));this.bind(),FF.forEach((E,P)=>{_[P].length>1&&this.opts.mipmaps!==!1&&Yn.warn("".concat(this.id," has mipmap and multiple LODs."))(),_[P].forEach((O,D)=>{n&&r?d.texImage2D(E,D,s,n,r,a,s,u,O):d.texImage2D(E,D,s,s,u,O)})}),this.unbind()}setImageDataForFace(e){const{face:n,width:r,height:i,pixels:o,data:a,border:s=0,format:u=6408,type:d=5121}=e,{gl:g}=this,_=o||a;return this.bind(),_ instanceof Promise?_.then(E=>this.setImageDataForFace(Object.assign({},e,{face:n,data:E,pixels:E}))):this.width||this.height?g.texImage2D(n,0,u,r,i,s,u,d,_):g.texImage2D(n,0,u,u,d,_),this}}v5.FACES=FF;class dte extends N0{get[Symbol.toStringTag](){return"Texture3D"}static isSupported(e){return Hr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Xa(e),n=Object.assign({depth:1},n,{target:32879,unpackFlipY:!1}),super(e,n),this.initialize(n),Object.seal(this)}setImageData(e){let{level:n=0,dataFormat:r=6408,width:i,height:o,depth:a=1,border:s=0,format:u,type:d=5121,offset:g=0,data:_,parameters:E={}}=e;if(this._trackDeallocatedMemory("Texture"),this.gl.bindTexture(this.target,this.handle),Mu(this.gl,E,()=>{ArrayBuffer.isView(_)&&this.gl.texImage3D(this.target,n,r,i,o,a,s,u,d,_),_ instanceof ji&&(this.gl.bindBuffer(35052,_.handle),this.gl.texImage3D(this.target,n,r,i,o,a,s,u,d,g))}),_&&_.byteLength)this._trackAllocatedMemory(_.byteLength,"Texture");else{const P=fte[this.dataFormat]||4,O=hte[this.type]||1;this._trackAllocatedMemory(this.width*this.height*this.depth*P*O,"Texture")}return this.loaded=!0,this}}const a0="EXT_color_buffer_float",n$={33189:{bpp:2},33190:{gl2:!0,bpp:3},36012:{gl2:!0,bpp:4},36168:{bpp:1},34041:{bpp:4},35056:{gl2:!0,bpp:4},36013:{gl2:!0,bpp:5},32854:{bpp:2},36194:{bpp:2},32855:{bpp:2},33321:{gl2:!0,bpp:1},33330:{gl2:!0,bpp:1},33329:{gl2:!0,bpp:1},33332:{gl2:!0,bpp:2},33331:{gl2:!0,bpp:2},33334:{gl2:!0,bpp:4},33333:{gl2:!0,bpp:4},33323:{gl2:!0,bpp:2},33336:{gl2:!0,bpp:2},33335:{gl2:!0,bpp:2},33338:{gl2:!0,bpp:4},33337:{gl2:!0,bpp:4},33340:{gl2:!0,bpp:8},33339:{gl2:!0,bpp:8},32849:{gl2:!0,bpp:3},32856:{gl2:!0,bpp:4},32857:{gl2:!0,bpp:4},36220:{gl2:!0,bpp:4},36238:{gl2:!0,bpp:4},36975:{gl2:!0,bpp:4},36214:{gl2:!0,bpp:8},36232:{gl2:!0,bpp:8},36226:{gl2:!0,bpp:16},36208:{gl2:!0,bpp:16},33325:{gl2:a0,bpp:2},33327:{gl2:a0,bpp:4},34842:{gl2:a0,bpp:8},33326:{gl2:a0,bpp:4},33328:{gl2:a0,bpp:8},34836:{gl2:a0,bpp:16},35898:{gl2:a0,bpp:4}};function lve(t,e,n){const r=n[e];if(!r)return!1;const i=Hr(t)&&r.gl2||r.gl1;return typeof i=="string"?t.getExtension(i):i}class E0 extends Eg{get[Symbol.toStringTag](){return"Renderbuffer"}static isSupported(e){let{format:n}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{format:null};return!n||lve(e,n,n$)}static getSamplesForFormat(e,n){let{format:r}=n;return e.getInternalformatParameter(36161,r,32937)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.initialize(n),Object.seal(this)}initialize(e){let{format:n,width:r=1,height:i=1,samples:o=0}=e;return Nn(n,"Needs format"),this._trackDeallocatedMemory(),this.gl.bindRenderbuffer(36161,this.handle),o!==0&&Hr(this.gl)?this.gl.renderbufferStorageMultisample(36161,o,n,r,i):this.gl.renderbufferStorage(36161,n,r,i),this.format=n,this.width=r,this.height=i,this.samples=o,this._trackAllocatedMemory(this.width*this.height*(this.samples||1)*n$[this.format].bpp),this}resize(e){let{width:n,height:r}=e;return n!==this.width||r!==this.height?this.initialize({width:n,height:r,format:this.format,samples:this.samples}):this}_createHandle(){return this.gl.createRenderbuffer()}_deleteHandle(){this.gl.deleteRenderbuffer(this.handle),this._trackDeallocatedMemory()}_bindHandle(e){this.gl.bindRenderbuffer(36161,e)}_syncHandle(e){this.format=this.getParameter(36164),this.width=this.getParameter(36162),this.height=this.getParameter(36163),this.samples=this.getParameter(36011)}_getParameter(e){return this.gl.bindRenderbuffer(36161,this.handle),this.gl.getRenderbufferParameter(36161,e)}}const uve=256,cve=1024,fve=16384,r$=6144,i$=6145,o$=6146,s$=34041,pte="clear: bad arguments";function BE(t){let{framebuffer:e=null,color:n=null,depth:r=null,stencil:i=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o={};e&&(o.framebuffer=e);let a=0;n&&(a|=fve,n!==!0&&(o.clearColor=n)),r&&(a|=uve,r!==!0&&(o.clearDepth=r)),i&&(a|=cve,r!==!0&&(o.clearStencil=r)),Nn(a!==0,pte),Mu(t,o,()=>{t.clear(a)})}function hve(t){let{framebuffer:e=null,buffer:n=r$,drawBuffer:r=0,value:i=[0,0,0,0]}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Xa(t),Mu(t,{framebuffer:e},()=>{switch(n){case r$:switch(i.constructor){case Int32Array:t.clearBufferiv(n,r,i);break;case Uint32Array:t.clearBufferuiv(n,r,i);break;case Float32Array:default:t.clearBufferfv(n,r,i)}break;case i$:t.clearBufferfv(i$,0,[i]);break;case o$:t.clearBufferiv(o$,0,[i]);break;case s$:const[o,a]=i;t.clearBufferfi(s$,0,o,a);break;default:Nn(!1,pte)}})}function gte(t){switch(t){case 6406:case 33326:case 6403:return 1;case 33328:case 33319:return 2;case 6407:case 34837:return 3;case 6408:case 34836:return 4;default:return Nn(!1),0}}function dve(t){switch(t){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return Nn(!1),0}}function NE(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408}=e;let{sourceAttachment:o=36064,target:a=null,sourceWidth:s,sourceHeight:u,sourceType:d}=e;const{framebuffer:g,deleteFramebuffer:_}=x5(t);Nn(g);const{gl:E,handle:P,attachments:O}=g;s=s||g.width,u=u||g.height,o===36064&&P===null&&(o=1028),Nn(O[o]),d=d||O[o].type,a=gve(a,d,i,s,u),d=d||BF(a);const D=E.bindFramebuffer(36160,P);return E.readPixels(n,r,s,u,i,d,a),E.bindFramebuffer(36160,D||null),_&&g.delete(),a}function pve(t,e){let{sourceX:n=0,sourceY:r=0,sourceFormat:i=6408,target:o=null,targetByteOffset:a=0,sourceWidth:s,sourceHeight:u,sourceType:d}=e;const{framebuffer:g,deleteFramebuffer:_}=x5(t);Nn(g),s=s||g.width,u=u||g.height;const E=Xa(g.gl);if(d=d||(o?o.type:5121),!o){const P=gte(i),O=dve(d),D=a+s*u*P*O;o=new ji(E,{byteLength:D,accessor:{type:d,size:P}})}return o.bind({target:35051}),Mu(E,{framebuffer:g},()=>{E.readPixels(n,r,s,u,i,d,a)}),o.unbind({target:35051}),_&&g.delete(),o}function a$(t){let{sourceAttachment:e=36064,targetMaxHeight:n=Number.MAX_SAFE_INTEGER}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=NE(t,{sourceAttachment:e}),{width:i,height:o}=t;for(;o>n;)({data:r,width:i,height:o}=Kye({data:r,width:i,height:o}));Qye({data:r,width:i,height:o});const a=document.createElement("canvas");a.width=i,a.height=o;const s=a.getContext("2d"),u=s.createImageData(i,o);return u.data.set(r),s.putImageData(u,0,0),a.toDataURL()}function mte(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{sourceX:r=0,sourceY:i=0,targetMipmaplevel:o=0,targetInternalFormat:a=6408}=n;let{targetX:s,targetY:u,targetZ:d,width:g,height:_}=n;const{framebuffer:E,deleteFramebuffer:P}=x5(t);Nn(E);const{gl:O,handle:D}=E,V=typeof s<"u"||typeof u<"u"||typeof d<"u";s=s||0,u=u||0,d=d||0;const k=O.bindFramebuffer(36160,D);Nn(e);let F=null;if(e instanceof N0&&(F=e,g=Number.isFinite(g)?g:F.width,_=Number.isFinite(_)?_:F.height,F.bind(0),e=F.target),!V)O.copyTexImage2D(e,o,a,r,i,g,_,0);else switch(e){case 3553:case 34067:O.copyTexSubImage2D(e,o,s,u,r,i,g,_);break;case 35866:case 32879:Xa(O).copyTexSubImage3D(e,o,s,u,d,r,i,g,_);break}return F&&F.unbind(),O.bindFramebuffer(36160,k||null),P&&E.delete(),F}function x5(t){return t instanceof Ws?{framebuffer:t,deleteFramebuffer:!1}:{framebuffer:wve(t),deleteFramebuffer:!0}}function gve(t,e,n,r,i){if(t)return t;e=e||5121;const o=Gw(e,{clamped:!1}),a=gte(n);return new o(r*i*a)}const Qi={WEBGL2:"WEBGL2",VERTEX_ARRAY_OBJECT:"VERTEX_ARRAY_OBJECT",TIMER_QUERY:"TIMER_QUERY",INSTANCED_RENDERING:"INSTANCED_RENDERING",MULTIPLE_RENDER_TARGETS:"MULTIPLE_RENDER_TARGETS",ELEMENT_INDEX_UINT32:"ELEMENT_INDEX_UINT32",BLEND_EQUATION_MINMAX:"BLEND_EQUATION_MINMAX",FLOAT_BLEND:"FLOAT_BLEND",COLOR_ENCODING_SRGB:"COLOR_ENCODING_SRGB",TEXTURE_DEPTH:"TEXTURE_DEPTH",TEXTURE_FLOAT:"TEXTURE_FLOAT",TEXTURE_HALF_FLOAT:"TEXTURE_HALF_FLOAT",TEXTURE_FILTER_LINEAR_FLOAT:"TEXTURE_FILTER_LINEAR_FLOAT",TEXTURE_FILTER_LINEAR_HALF_FLOAT:"TEXTURE_FILTER_LINEAR_HALF_FLOAT",TEXTURE_FILTER_ANISOTROPIC:"TEXTURE_FILTER_ANISOTROPIC",COLOR_ATTACHMENT_RGBA32F:"COLOR_ATTACHMENT_RGBA32F",COLOR_ATTACHMENT_FLOAT:"COLOR_ATTACHMENT_FLOAT",COLOR_ATTACHMENT_HALF_FLOAT:"COLOR_ATTACHMENT_HALF_FLOAT",GLSL_FRAG_DATA:"GLSL_FRAG_DATA",GLSL_FRAG_DEPTH:"GLSL_FRAG_DEPTH",GLSL_DERIVATIVES:"GLSL_DERIVATIVES",GLSL_TEXTURE_LOD:"GLSL_TEXTURE_LOD"};function mve(t){const e=new Pl(t,{format:6408,type:5126,dataFormat:6408}),n=new Ws(t,{id:"test-framebuffer",check:!1,attachments:{36064:e}}),r=n.getStatus();return e.delete(),n.delete(),r===36053}const Ate={[Qi.WEBGL2]:[!1,!0],[Qi.VERTEX_ARRAY_OBJECT]:["OES_vertex_array_object",!0],[Qi.TIMER_QUERY]:["EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2"],[Qi.INSTANCED_RENDERING]:["ANGLE_instanced_arrays",!0],[Qi.MULTIPLE_RENDER_TARGETS]:["WEBGL_draw_buffers",!0],[Qi.ELEMENT_INDEX_UINT32]:["OES_element_index_uint",!0],[Qi.BLEND_EQUATION_MINMAX]:["EXT_blend_minmax",!0],[Qi.FLOAT_BLEND]:["EXT_float_blend"],[Qi.COLOR_ENCODING_SRGB]:["EXT_sRGB",!0],[Qi.TEXTURE_DEPTH]:["WEBGL_depth_texture",!0],[Qi.TEXTURE_FLOAT]:["OES_texture_float",!0],[Qi.TEXTURE_HALF_FLOAT]:["OES_texture_half_float",!0],[Qi.TEXTURE_FILTER_LINEAR_FLOAT]:["OES_texture_float_linear"],[Qi.TEXTURE_FILTER_LINEAR_HALF_FLOAT]:["OES_texture_half_float_linear"],[Qi.TEXTURE_FILTER_ANISOTROPIC]:["EXT_texture_filter_anisotropic"],[Qi.COLOR_ATTACHMENT_RGBA32F]:[mve,"EXT_color_buffer_float"],[Qi.COLOR_ATTACHMENT_FLOAT]:[!1,"EXT_color_buffer_float"],[Qi.COLOR_ATTACHMENT_HALF_FLOAT]:["EXT_color_buffer_half_float"],[Qi.GLSL_FRAG_DATA]:["WEBGL_draw_buffers",!0],[Qi.GLSL_FRAG_DEPTH]:["EXT_frag_depth",!0],[Qi.GLSL_DERIVATIVES]:["OES_standard_derivatives",!0],[Qi.GLSL_TEXTURE_LOD]:["EXT_shader_texture_lod",!0]},Ave=2;function FE(t,e){return UO(t,e)}function UO(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>_te(t,n))}function _ve(t){t.luma=t.luma||{},t.luma.caps=t.luma.caps||{};for(const e in Ate)t.luma.caps[e]===void 0&&(t.luma.caps[e]=_te(t,e));return t.luma.caps}function _te(t,e){return t.luma=t.luma||{},t.luma.caps=t.luma.caps||{},t.luma.caps[e]===void 0&&(t.luma.caps[e]=yve(t,e)),t.luma.caps[e]||Yn.log(Ave,"Feature: ".concat(e," not supported"))(),t.luma.caps[e]}function yve(t,e){const n=Ate[e];Nn(n,e);let r;const i=Hr(t)&&n[1]||n[0];if(typeof i=="function")r=i(t);else if(Array.isArray(i)){r=!0;for(const o of i)r=r&&!!t.getExtension(o)}else typeof i=="string"?r=!!t.getExtension(i):typeof i=="boolean"?r=i:Nn(!1);return r}const l$="Multiple render targets not supported";class Ws extends Eg{get[Symbol.toStringTag](){return"Framebuffer"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{colorBufferFloat:r,colorBufferHalfFloat:i}=n;let o=!0;return r&&(o=!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("WEBGL_color_buffer_float")||e.getExtension("OES_texture_float"))),i&&(o=o&&!!(e.getExtension("EXT_color_buffer_float")||e.getExtension("EXT_color_buffer_half_float"))),o}static getDefaultFramebuffer(e){return e.luma=e.luma||{},e.luma.defaultFramebuffer=e.luma.defaultFramebuffer||new Ws(e,{id:"default-framebuffer",handle:null,attachments:{}}),e.luma.defaultFramebuffer}get MAX_COLOR_ATTACHMENTS(){const e=Xa(this.gl);return e.getParameter(e.MAX_COLOR_ATTACHMENTS)}get MAX_DRAW_BUFFERS(){const e=Xa(this.gl);return e.getParameter(e.MAX_DRAW_BUFFERS)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.width=null,this.height=null,this.attachments={},this.readBuffer=36064,this.drawBuffers=[36064],this.ownResources=[],this.initialize(n),Object.seal(this)}get color(){return this.attachments[36064]||null}get texture(){return this.attachments[36064]||null}get depth(){return this.attachments[36096]||this.attachments[33306]||null}get stencil(){return this.attachments[36128]||this.attachments[33306]||null}initialize(e){let{width:n=1,height:r=1,attachments:i=null,color:o=!0,depth:a=!0,stencil:s=!1,check:u=!0,readBuffer:d=void 0,drawBuffers:g=void 0}=e;if(Nn(n>=0&&r>=0,"Width and height need to be integers"),this.width=n,this.height=r,i)for(const _ in i){const E=i[_];(Array.isArray(E)?E[0]:E).resize({width:n,height:r})}else i=this._createDefaultAttachments(o,a,s,n,r);this.update({clearAttachments:!0,attachments:i,readBuffer:d,drawBuffers:g}),i&&u&&this.checkStatus()}delete(){for(const e of this.ownResources)e.delete();return super.delete(),this}update(e){let{attachments:n={},readBuffer:r,drawBuffers:i,clearAttachments:o=!1,resizeAttachments:a=!0}=e;this.attach(n,{clearAttachments:o,resizeAttachments:a});const{gl:s}=this,u=s.bindFramebuffer(36160,this.handle);return r&&this._setReadBuffer(r),i&&this._setDrawBuffers(i),s.bindFramebuffer(36160,u||null),this}resize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{width:n,height:r}=e;if(this.handle===null)return Nn(n===void 0&&r===void 0),this.width=this.gl.drawingBufferWidth,this.height=this.gl.drawingBufferHeight,this;n===void 0&&(n=this.gl.drawingBufferWidth),r===void 0&&(r=this.gl.drawingBufferHeight),n!==this.width&&r!==this.height&&Yn.log(2,"Resizing framebuffer ".concat(this.id," to ").concat(n,"x").concat(r))();for(const i in this.attachments)this.attachments[i].resize({width:n,height:r});return this.width=n,this.height=r,this}attach(e){let{clearAttachments:n=!1,resizeAttachments:r=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i={};n&&Object.keys(this.attachments).forEach(a=>{i[a]=null}),Object.assign(i,e);const o=this.gl.bindFramebuffer(36160,this.handle);for(const a in i){Nn(a!==void 0,"Misspelled framebuffer binding point?");const s=Number(a),u=i[s];let d=u;if(!d)this._unattach(s);else if(d instanceof E0)this._attachRenderbuffer({attachment:s,renderbuffer:d});else if(Array.isArray(u)){const[g,_=0,E=0]=u;d=g,this._attachTexture({attachment:s,texture:g,layer:_,level:E})}else this._attachTexture({attachment:s,texture:d,layer:0,level:0});r&&d&&d.resize({width:this.width,height:this.height})}this.gl.bindFramebuffer(36160,o||null),Object.assign(this.attachments,e),Object.keys(this.attachments).filter(a=>!this.attachments[a]).forEach(a=>{delete this.attachments[a]})}checkStatus(){const e=this.getStatus();if(e!==36053)throw new Error(xve(e));return this}getStatus(){const{gl:e}=this,n=e.bindFramebuffer(36160,this.handle),r=e.checkFramebufferStatus(36160);return e.bindFramebuffer(36160,n||null),r}clear(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{color:n,depth:r,stencil:i,drawBuffers:o=[]}=e,a=this.gl.bindFramebuffer(36160,this.handle);return(n||r||i)&&BE(this.gl,{color:n,depth:r,stencil:i}),o.forEach((s,u)=>{hve(this.gl,{drawBuffer:u,value:s})}),this.gl.bindFramebuffer(36160,a||null),this}readPixels(){return Yn.error("Framebuffer.readPixels() is no logner supported, use readPixelsToArray(framebuffer)")(),null}readPixelsToBuffer(){return Yn.error("Framebuffer.readPixelsToBuffer()is no logner supported, use readPixelsToBuffer(framebuffer)")(),null}copyToDataUrl(){return Yn.error("Framebuffer.copyToDataUrl() is no logner supported, use copyToDataUrl(framebuffer)")(),null}copyToImage(){return Yn.error("Framebuffer.copyToImage() is no logner supported, use copyToImage(framebuffer)")(),null}copyToTexture(){return Yn.error("Framebuffer.copyToTexture({...}) is no logner supported, use copyToTexture(source, target, opts})")(),null}blit(){return Yn.error("Framebuffer.blit({...}) is no logner supported, use blit(source, target, opts)")(),null}invalidate(e){let{attachments:n=[],x:r=0,y:i=0,width:o,height:a}=e;const s=Xa(this.gl),u=s.bindFramebuffer(36008,this.handle);return r===0&&i===0&&o===void 0&&a===void 0?s.invalidateFramebuffer(36008,n):s.invalidateFramebuffer(36008,n,r,i,o,a),s.bindFramebuffer(36008,u),this}getAttachmentParameter(e,n,r){let i=this._getAttachmentParameterFallback(n);return i===null&&(this.gl.bindFramebuffer(36160,this.handle),i=this.gl.getFramebufferAttachmentParameter(36160,e,n),this.gl.bindFramebuffer(36160,null)),r&&i>1e3&&(i=jm(this.gl,i)),i}getAttachmentParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:36064,n=arguments.length>1?arguments[1]:void 0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.constructor.ATTACHMENT_PARAMETERS||[];const i={};for(const o of r){const a=n?jm(this.gl,o):o;i[a]=this.getAttachmentParameter(e,o,n)}return i}getParameters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=Object.keys(this.attachments),r={};for(const i of n){const o=Number(i),a=e?jm(this.gl,o):o;r[a]=this.getAttachmentParameters(o,e)}return r}show(){return typeof window<"u"&&window.open(a$(this),"luma-debug-texture"),this}log(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(e>Yn.level||typeof window>"u")return this;n=n||"Framebuffer ".concat(this.id);const r=a$(this,{targetMaxHeight:100});return Yn.image({logLevel:e,message:n,image:r},n)(),this}bind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,this.handle),this}unbind(){let{target:e=36160}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.gl.bindFramebuffer(e,null),this}_createDefaultAttachments(e,n,r,i,o){let a=null;return e&&(a=a||{},a[36064]=new Pl(this.gl,{id:"".concat(this.id,"-color0"),pixels:null,format:6408,type:5121,width:i,height:o,mipmaps:!1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.ownResources.push(a[36064])),n&&r?(a=a||{},a[33306]=new E0(this.gl,{id:"".concat(this.id,"-depth-stencil"),format:35056,width:i,height:111}),this.ownResources.push(a[33306])):n?(a=a||{},a[36096]=new E0(this.gl,{id:"".concat(this.id,"-depth"),format:33189,width:i,height:o}),this.ownResources.push(a[36096])):r&&Nn(!1),a}_unattach(e){const n=this.attachments[e];n&&(n instanceof E0?this.gl.framebufferRenderbuffer(36160,e,36161,null):this.gl.framebufferTexture2D(36160,e,3553,null,0),delete this.attachments[e])}_attachRenderbuffer(e){let{attachment:n=36064,renderbuffer:r}=e;const{gl:i}=this;i.framebufferRenderbuffer(36160,n,36161,r.handle),this.attachments[n]=r}_attachTexture(e){let{attachment:n=36064,texture:r,layer:i,level:o}=e;const{gl:a}=this;switch(a.bindTexture(r.target,r.handle),r.target){case 35866:case 32879:Xa(a).framebufferTextureLayer(36160,n,r.target,o,i);break;case 34067:const u=vve(i);a.framebufferTexture2D(36160,n,u,r.handle,o);break;case 3553:a.framebufferTexture2D(36160,n,3553,r.handle,o);break;default:Nn(!1,"Illegal texture type")}a.bindTexture(r.target,null),this.attachments[n]=r}_setReadBuffer(e){const n=J_e(this.gl);n?n.readBuffer(e):Nn(e===36064||e===1029,l$),this.readBuffer=e}_setDrawBuffers(e){const{gl:n}=this,r=Xa(n);if(r)r.drawBuffers(e);else{const i=n.getExtension("WEBGL_draw_buffers");i?i.drawBuffersWEBGL(e):Nn(e.length===1&&(e[0]===36064||e[0]===1029),l$)}this.drawBuffers=e}_getAttachmentParameterFallback(e){const n=_ve(this.gl);switch(e){case 36052:return n.WEBGL2?null:0;case 33298:case 33299:case 33300:case 33301:case 33302:case 33303:return n.WEBGL2?null:8;case 33297:return n.WEBGL2?null:5125;case 33296:return!n.WEBGL2&&!n.EXT_sRGB?9729:null;default:return null}}_createHandle(){return this.gl.createFramebuffer()}_deleteHandle(){this.gl.deleteFramebuffer(this.handle)}_bindHandle(e){return this.gl.bindFramebuffer(36160,e)}}function vve(t){return t<34069?t+34069:t}function xve(t){return(Ws.STATUS||{})[t]||"Framebuffer error ".concat(t)}const bve=[36049,36048,33296,33298,33299,33300,33301,33302,33303];Ws.ATTACHMENT_PARAMETERS=bve;function yte(t,e){Nn(t instanceof Pl||t instanceof v5||t instanceof dte);const n=t.constructor,{gl:r,width:i,height:o,format:a,type:s,dataFormat:u,border:d,mipmaps:g}=t,_=Object.assign({width:i,height:o,format:a,type:s,dataFormat:u,border:d,mipmaps:g},e);return new n(r,_)}function wve(t,e){const{gl:n,width:r,height:i,id:o}=t;return new Ws(n,Object.assign({},e,{id:"framebuffer-for-".concat(o),width:r,height:i,attachments:{36064:t}}))}function sC(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"unnamed";const n=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/,r=t.match(n);return r?r[1]:e}const Eve=35632,Sve=35633;function Tve(t){switch(t){case Eve:return"fragment";case Sve:return"vertex";default:return"unknown type"}}function Cve(t,e,n,r){const i=t.split(/\r?\n/),o={},a={},s=r||sC(e)||"(unnamed)",u="".concat(Tve(n)," shader ").concat(s);for(let g=0;g<i.length;g++){const _=i[g];if(_.length<=1)continue;const E=_.split(":"),P=E[0],O=parseInt(E[2],10);if(isNaN(O))throw new Error("GLSL compilation error in ".concat(u,": ").concat(t));P!=="WARNING"?o[O]=_:a[O]=_}const d=Pve(e);return{shaderName:u,errors:u$(o,d),warnings:u$(a,d)}}function u$(t,e){let n="";for(let r=0;r<e.length;r++){const i=e[r];if(!(!t[r+3]&&!t[r+2]&&!t[r+1])&&(n+="".concat(i,`
`),t[r+1])){const o=t[r+1],a=o.split(":",3),s=a[0],u=parseInt(a[1],10)||0,d=o.substring(a.join(":").length+1).trim();n+=vte("^^^ ".concat(s,": ").concat(d,`

`),u)}}return n}function Pve(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:": ";const r=t.split(/\r?\n/),i=String(r.length+e-1).length;return r.map((o,a)=>{const s=String(a+e),u=s.length;return vte(s,i-u)+n+o})}function vte(t,e){let n="";for(let r=0;r<e;++r)n+=" ";return"".concat(n).concat(t)}function xte(t){let e=100;const n=t.match(/[^\s]+/g);if(n.length>=2&&n[0]==="#version"){const r=parseInt(n[1],10);Number.isFinite(r)&&(e=r)}return e}const Ive="Shader: GLSL source code must be a JavaScript string";class jw extends Eg{get[Symbol.toStringTag](){return"Shader"}static getTypeName(e){switch(e){case 35633:return"vertex-shader";case 35632:return"fragment-shader";default:return Nn(!1),"unknown"}}constructor(e,n){kO(e),Nn(typeof n.source=="string",Ive);const r=sC(n.source,null)||n.id||Ma("unnamed ".concat(jw.getTypeName(n.shaderType)));super(e,{id:r}),this.shaderType=n.shaderType,this.source=n.source,this.initialize(n)}initialize(e){let{source:n}=e;const r=sC(n,null);r&&(this.id=Ma(r)),this._compile(n)}getParameter(e){return this.gl.getShaderParameter(this.handle,e)}toString(){return"".concat(jw.getTypeName(this.shaderType),":").concat(this.id)}getName(){return sC(this.source)||"unnamed-shader"}getSource(){return this.gl.getShaderSource(this.handle)}getTranslatedSource(){const e=this.gl.getExtension("WEBGL_debug_shaders");return e?e.getTranslatedShaderSource(this.handle):"No translated source available. WEBGL_debug_shaders not implemented"}_compile(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.source;if(e.startsWith("#version ")||(e=`#version 100
`.concat(e)),this.source=e,this.gl.shaderSource(this.handle,this.source),this.gl.compileShader(this.handle),!this.getParameter(35713)){const r=this.gl.getShaderInfoLog(this.handle),{shaderName:i,errors:o,warnings:a}=Cve(r,this.source,this.shaderType,this.id);throw Yn.error("GLSL compilation errors in ".concat(i,`
`).concat(o))(),Yn.warn("GLSL compilation warnings in ".concat(i,`
`).concat(a))(),new Error("GLSL compilation errors in ".concat(i))}}_deleteHandle(){this.gl.deleteShader(this.handle)}_getOptsFromHandle(){return{type:this.getParameter(35663),source:this.getSource()}}}class aC extends jw{get[Symbol.toStringTag](){return"VertexShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35633}))}_createHandle(){return this.gl.createShader(35633)}}class lC extends jw{get[Symbol.toStringTag](){return"FragmentShader"}constructor(e,n){typeof n=="string"&&(n={source:n}),super(e,Object.assign({},n,{shaderType:35632}))}_createHandle(){return this.gl.createShader(35632)}}const Mve={5126:Co.bind(null,"uniform1fv",nc,1,ml),35664:Co.bind(null,"uniform2fv",nc,2,ml),35665:Co.bind(null,"uniform3fv",nc,3,ml),35666:Co.bind(null,"uniform4fv",nc,4,ml),5124:Co.bind(null,"uniform1iv",um,1,ml),35667:Co.bind(null,"uniform2iv",um,2,ml),35668:Co.bind(null,"uniform3iv",um,3,ml),35669:Co.bind(null,"uniform4iv",um,4,ml),35670:Co.bind(null,"uniform1iv",um,1,ml),35671:Co.bind(null,"uniform2iv",um,2,ml),35672:Co.bind(null,"uniform3iv",um,3,ml),35673:Co.bind(null,"uniform4iv",um,4,ml),35674:Co.bind(null,"uniformMatrix2fv",nc,4,kp),35675:Co.bind(null,"uniformMatrix3fv",nc,9,kp),35676:Co.bind(null,"uniformMatrix4fv",nc,16,kp),35678:Va,35680:Va,5125:Co.bind(null,"uniform1uiv",PS,1,ml),36294:Co.bind(null,"uniform2uiv",PS,2,ml),36295:Co.bind(null,"uniform3uiv",PS,3,ml),36296:Co.bind(null,"uniform4uiv",PS,4,ml),35685:Co.bind(null,"uniformMatrix2x3fv",nc,6,kp),35686:Co.bind(null,"uniformMatrix2x4fv",nc,8,kp),35687:Co.bind(null,"uniformMatrix3x2fv",nc,6,kp),35688:Co.bind(null,"uniformMatrix3x4fv",nc,12,kp),35689:Co.bind(null,"uniformMatrix4x2fv",nc,8,kp),35690:Co.bind(null,"uniformMatrix4x3fv",nc,12,kp),35678:Va,35680:Va,35679:Va,35682:Va,36289:Va,36292:Va,36293:Va,36298:Va,36299:Va,36300:Va,36303:Va,36306:Va,36307:Va,36308:Va,36311:Va},Ove={},Rve={},Lve={},c$=[0];function b5(t,e,n,r){e===1&&typeof t=="boolean"&&(t=t?1:0),Number.isFinite(t)&&(c$[0]=t,t=c$);const i=t.length;if(i%e&&Yn.warn("Uniform size should be multiples of ".concat(e),t)(),t instanceof n)return t;let o=r[i];o||(o=new n(i),r[i]=o);for(let a=0;a<i;a++)o[a]=t[a];return o}function nc(t,e){return b5(t,e,Float32Array,Ove)}function um(t,e){return b5(t,e,Int32Array,Rve)}function PS(t,e){return b5(t,e,Uint32Array,Lve)}function f$(t,e,n){const r=Mve[n.type];if(!r)throw new Error("Unknown GLSL uniform type ".concat(n.type));return r().bind(null,t,e)}function Dve(t){if(t[t.length-1]!=="]")return{name:t,length:1,isArray:!1};const e=/([^[]*)(\[[0-9]+\])?/,n=t.match(e);if(!n||n.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(t));return{name:n[1],length:n[2]||1,isArray:!!n[2]}}function Bve(t,e,n){for(const r in t){const i=t[r];if((!n||!!n[r])&&!Nve(i))throw e=e?"".concat(e," "):"",console.error("".concat(e," Bad uniform ").concat(r),i),new Error("".concat(e," Bad uniform ").concat(r))}return!0}function Nve(t){return Array.isArray(t)||ArrayBuffer.isView(t)?kve(t):isFinite(t)||t===!0||t===!1||t instanceof N0||t instanceof E0?!0:t instanceof Ws?!!t.texture:!1}function Fve(t,e,n){if(Array.isArray(n)||ArrayBuffer.isView(n))if(t[e]){const r=t[e];for(let i=0,o=n.length;i<o;++i)r[i]=n[i]}else t[e]=n.slice();else t[e]=n}function kve(t){if(t.length===0)return!1;const e=Math.min(t.length,16);for(let n=0;n<e;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Va(){let t=null;return(e,n,r)=>{const i=t!==r;return i&&(e.uniform1i(n,r),t=r),i}}function Co(t,e,n,r){let i=null,o=null;return(a,s,u)=>{const d=e(u,n),g=d.length;let _=!1;if(i===null)i=new Float32Array(g),o=g,_=!0;else{Nn(o===g,"Uniform length cannot change.");for(let E=0;E<g;++E)if(d[E]!==i[E]){_=!0;break}}return _&&(r(a,t,s,d),i.set(d)),_}}function ml(t,e,n,r){t[e](n,r)}function kp(t,e,n,r){t[e](n,!1,r)}const zve=5120,Uve=5121,Gve=5122,jve=5123,h$=0,IS=1,Vve=2,$ve=3,MS=4,Hve=5,Wve=6,ea=5126,qve=35664,Xve=35665,Zve=35666,cb=5124,Yve=35667,Qve=35668,Kve=35669,fb=5125,Jve=36294,e1e=36295,t1e=36296,n1e=35670,r1e=35671,i1e=35672,o1e=35673,s1e=35674,a1e=35675,l1e=35676,u1e=35685,c1e=35686,f1e=35687,h1e=35688,d1e=35689,p1e=35690,kF={[ea]:[ea,1,"float"],[qve]:[ea,2,"vec2"],[Xve]:[ea,3,"vec3"],[Zve]:[ea,4,"vec4"],[cb]:[cb,1,"int"],[Yve]:[cb,2,"ivec2"],[Qve]:[cb,3,"ivec3"],[Kve]:[cb,4,"ivec4"],[fb]:[fb,1,"uint"],[Jve]:[fb,2,"uvec2"],[e1e]:[fb,3,"uvec3"],[t1e]:[fb,4,"uvec4"],[n1e]:[ea,1,"bool"],[r1e]:[ea,2,"bvec2"],[i1e]:[ea,3,"bvec3"],[o1e]:[ea,4,"bvec4"],[s1e]:[ea,8,"mat2"],[u1e]:[ea,8,"mat2x3"],[c1e]:[ea,8,"mat2x4"],[a1e]:[ea,12,"mat3"],[f1e]:[ea,12,"mat3x2"],[h1e]:[ea,12,"mat3x4"],[l1e]:[ea,16,"mat4"],[d1e]:[ea,16,"mat4x2"],[p1e]:[ea,16,"mat4x3"]};function g1e(t){switch(t){case h$:return h$;case IS:return IS;case $ve:return IS;case Vve:return IS;case MS:return MS;case Hve:return MS;case Wve:return MS;default:return Nn(!1),0}}function d$(t){const e=kF[t];if(!e)return null;const[n,r]=e;return{type:n,components:r}}function bte(t,e){switch(t){case zve:case Uve:case Gve:case jve:t=ea;break}for(const n in kF){const[r,i,o]=kF[n];if(r===t&&i===e)return{glType:n,name:o}}return null}class m1e{constructor(e){this.id=e.id,this.attributeInfos=[],this.attributeInfosByName={},this.attributeInfosByLocation=[],this.varyingInfos=[],this.varyingInfosByName={},Object.seal(this),this._readAttributesFromProgram(e),this._readVaryingsFromProgram(e)}getAttributeInfo(e){const n=Number(e);return Number.isFinite(n)?this.attributeInfosByLocation[n]:this.attributeInfosByName[e]||null}getAttributeLocation(e){const n=this.getAttributeInfo(e);return n?n.location:-1}getAttributeAccessor(e){const n=this.getAttributeInfo(e);return n?n.accessor:null}getVaryingInfo(e){const n=Number(e);return Number.isFinite(n)?this.varyingInfos[n]:this.varyingInfosByName[e]||null}getVaryingIndex(e){const n=this.getVaryingInfo();return n?n.location:-1}getVaryingAccessor(e){const n=this.getVaryingInfo();return n?n.accessor:null}_readAttributesFromProgram(e){const{gl:n}=e,r=n.getProgramParameter(e.handle,35721);for(let i=0;i<r;i++){const{name:o,type:a,size:s}=n.getActiveAttrib(e.handle,i),u=n.getAttribLocation(e.handle,o);u>=0&&this._addAttribute(u,o,a,s)}this.attributeInfos.sort((i,o)=>i.location-o.location)}_readVaryingsFromProgram(e){const{gl:n}=e;if(!Hr(n))return;const r=n.getProgramParameter(e.handle,35971);for(let i=0;i<r;i++){const{name:o,type:a,size:s}=n.getTransformFeedbackVarying(e.handle,i);this._addVarying(i,o,a,s)}this.varyingInfos.sort((i,o)=>i.location-o.location)}_addAttribute(e,n,r,i){const{type:o,components:a}=d$(r),s={type:o,size:i*a};this._inferProperties(e,n,s);const u={location:e,name:n,accessor:new wu(s)};this.attributeInfos.push(u),this.attributeInfosByLocation[e]=u,this.attributeInfosByName[u.name]=u}_inferProperties(e,n,r){/instance/i.test(n)&&(r.divisor=1)}_addVarying(e,n,r,i){const{type:o,components:a}=d$(r),s=new wu({type:o,size:i*a}),u={location:e,name:n,accessor:s};this.varyingInfos.push(u),this.varyingInfosByName[u.name]=u}}const p$=4,A1e=35981,_1e=["setVertexArray","setAttributes","setBuffers","unsetBuffers","use","getUniformCount","getUniformInfo","getUniformLocation","getUniformValue","getVarying","getFragDataLocation","getAttachedShaders","getAttributeCount","getAttributeLocation","getAttributeInfo"];class w5 extends Eg{get[Symbol.toStringTag](){return"Program"}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.stubRemovedMethods("Program","v6.0",_1e),this._isCached=!1,this.initialize(n),Object.seal(this),this._setId(n.id)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{hash:n,vs:r,fs:i,varyings:o,bufferMode:a=A1e}=e;return this.hash=n||"",this.vs=typeof r=="string"?new aC(this.gl,{id:"".concat(e.id,"-vs"),source:r}):r,this.fs=typeof i=="string"?new lC(this.gl,{id:"".concat(e.id,"-fs"),source:i}):i,Nn(this.vs instanceof aC),Nn(this.fs instanceof lC),this.uniforms={},this._textureUniforms={},o&&o.length>0&&(Xa(this.gl),this.varyings=o,this.gl2.transformFeedbackVaryings(this.handle,o,a)),this._compileAndLink(),this._readUniformLocationsFromLinkedProgram(),this.configuration=new m1e(this),this.setProps(e)}delete(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this._isCached?this:super.delete(e)}setProps(e){return"uniforms"in e&&this.setUniforms(e.uniforms),this}draw(e){let{logPriority:n,drawMode:r=4,vertexCount:i,offset:o=0,start:a,end:s,isIndexed:u=!1,indexType:d=5123,instanceCount:g=0,isInstanced:_=g>0,vertexArray:E=null,transformFeedback:P,framebuffer:O,parameters:D={},uniforms:V,samplers:k}=e;if((V||k)&&(Yn.deprecated("Program.draw({uniforms})","Program.setUniforms(uniforms)")(),this.setUniforms(V||{})),Yn.priority>=n){const F=O?O.id:"default",z="mode=".concat(jm(this.gl,r)," verts=").concat(i," ")+"instances=".concat(g," indexType=").concat(jm(this.gl,d)," ")+"isInstanced=".concat(_," isIndexed=").concat(u," ")+"Framebuffer=".concat(F);Yn.log(n,z)()}return Nn(E),this.gl.useProgram(this.handle),!this._areTexturesRenderable()||i===0||_&&g===0?!1:(E.bindForDraw(i,g,()=>{if(O!==void 0&&(D=Object.assign({},D,{framebuffer:O})),P){const F=g1e(r);P.begin(F)}this._bindTextures(),Mu(this.gl,D,()=>{u&&_?this.gl2.drawElementsInstanced(r,i,d,o,g):u&&Hr(this.gl)&&!isNaN(a)&&!isNaN(s)?this.gl2.drawRangeElements(r,a,s,i,d,o):u?this.gl.drawElements(r,i,d,o):_?this.gl2.drawArraysInstanced(r,o,i,g):this.gl.drawArrays(r,o,i)}),P&&P.end()}),!0)}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Yn.priority>=2&&Bve(e,this.id,this._uniformSetters),this.gl.useProgram(this.handle);for(const n in e){const r=e[n],i=this._uniformSetters[n];if(i){let o=r,a=!1;if(o instanceof Ws&&(o=o.texture),o instanceof N0)if(a=this.uniforms[n]!==r,a){i.textureIndex===void 0&&(i.textureIndex=this._textureIndexCounter++);const s=o,{textureIndex:u}=i;s.bind(u),o=u,this._textureUniforms[n]=s}else o=i.textureIndex;else this._textureUniforms[n]&&delete this._textureUniforms[n];(i(o)||a)&&Fve(this.uniforms,n,r)}}return this}_areTexturesRenderable(){let e=!0;for(const n in this._textureUniforms){const r=this._textureUniforms[n];r.update(),e=e&&r.loaded}return e}_bindTextures(){for(const e in this._textureUniforms){const n=this._uniformSetters[e].textureIndex;this._textureUniforms[e].bind(n)}}_createHandle(){return this.gl.createProgram()}_deleteHandle(){this.gl.deleteProgram(this.handle)}_getOptionsFromHandle(e){const n=this.gl.getAttachedShaders(e),r={};for(const i of n)switch(this.gl.getShaderParameter(this.handle,35663)){case 35633:r.vs=new aC({handle:i});break;case 35632:r.fs=new lC({handle:i});break}return r}_getParameter(e){return this.gl.getProgramParameter(this.handle,e)}_setId(e){if(!e){const n=this._getName();this.id=Ma(n)}}_getName(){let e=this.vs.getName()||this.fs.getName();return e=e.replace(/shader/i,""),e=e?"".concat(e,"-program"):"program",e}_compileAndLink(){const{gl:e}=this;if(e.attachShader(this.handle,this.vs.handle),e.attachShader(this.handle,this.fs.handle),Yn.time(p$,"linkProgram for ".concat(this._getName()))(),e.linkProgram(this.handle),Yn.timeEnd(p$,"linkProgram for ".concat(this._getName()))(),e.debug||Yn.level>0){if(!e.getProgramParameter(this.handle,35714))throw new Error("Error linking: ".concat(e.getProgramInfoLog(this.handle)));if(e.validateProgram(this.handle),!e.getProgramParameter(this.handle,35715))throw new Error("Error validating: ".concat(e.getProgramInfoLog(this.handle)))}}_readUniformLocationsFromLinkedProgram(){const{gl:e}=this;this._uniformSetters={},this._uniformCount=this._getParameter(35718);for(let n=0;n<this._uniformCount;n++){const r=this.gl.getActiveUniform(this.handle,n),{name:i}=Dve(r.name);let o=e.getUniformLocation(this.handle,i);if(this._uniformSetters[i]=f$(e,o,r),r.size>1)for(let a=0;a<r.size;a++)o=e.getUniformLocation(this.handle,"".concat(i,"[").concat(a,"]")),this._uniformSetters["".concat(i,"[").concat(a,"]")]=f$(e,o,r)}this._textureIndexCounter=0}getActiveUniforms(e,n){return this.gl2.getActiveUniforms(this.handle,e,n)}getUniformBlockIndex(e){return this.gl2.getUniformBlockIndex(this.handle,e)}getActiveUniformBlockParameter(e,n){return this.gl2.getActiveUniformBlockParameter(this.handle,e,n)}uniformBlockBinding(e,n){this.gl2.uniformBlockBinding(this.handle,e,n)}}const y1e=34918,v1e=34919,x1e=35007,b1e=36795,w1e=35976,E1e=35887,S1e=36202;class oI extends Eg{get[Symbol.toStringTag](){return"Query"}static isSupported(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=Hr(e),i=UO(e,Qi.TIMER_QUERY);let o=r||i;for(const a of n)switch(a){case"queries":o=o&&r;break;case"timers":o=o&&i;break;default:Nn(!1)}return o}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e,n),this.target=null,this._queryPending=!1,this._pollingPromise=null,Object.seal(this)}beginTimeElapsedQuery(){return this.begin(x1e)}beginOcclusionQuery(){let{conservative:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.begin(e?S1e:E1e)}beginTransformFeedbackQuery(){return this.begin(w1e)}begin(e){return this._queryPending?this:(this.target=e,this.gl2.beginQuery(this.target,this.handle),this)}end(){return this._queryPending?this:(this.target&&(this.gl2.endQuery(this.target),this.target=null,this._queryPending=!0),this)}isResultAvailable(){if(!this._queryPending)return!1;const e=this.gl2.getQueryParameter(this.handle,v1e);return e&&(this._queryPending=!1),e}isTimerDisjoint(){return this.gl2.getParameter(b1e)}getResult(){return this.gl2.getQueryParameter(this.handle,y1e)}getTimerMilliseconds(){return this.getResult()/1e6}createPoll(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Number.POSITIVE_INFINITY;if(this._pollingPromise)return this._pollingPromise;let n=0;return this._pollingPromise=new Promise((r,i)=>{const o=()=>{this.isResultAvailable()?(r(this.getResult()),this._pollingPromise=null):n++>e?(i("Timed out"),this._pollingPromise=null):requestAnimationFrame(o)};requestAnimationFrame(o)}),this._pollingPromise}_createHandle(){return oI.isSupported(this.gl)?this.gl2.createQuery():null}_deleteHandle(){this.gl2.deleteQuery(this.handle)}}class E5 extends Eg{get[Symbol.toStringTag](){return"TransformFeedback"}static isSupported(e){return Hr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Xa(e),super(e,n),this.initialize(n),this.stubRemovedMethods("TransformFeedback","v6.0",["pause","resume"]),Object.seal(this)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.buffers={},this.unused={},this.configuration=null,this.bindOnUse=!0,Fv(this.buffers)||this.bind(()=>this._unbindBuffers()),this.setProps(e),this}setProps(e){"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"bindOnUse"in e&&(e=e.bindOnUse),"buffers"in e&&this.setBuffers(e.buffers)}setBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.bind(()=>{for(const n in e)this.setBuffer(n,e[n])}),this}setBuffer(e,n){const r=this._getVaryingIndex(e),{buffer:i,byteSize:o,byteOffset:a}=this._getBufferParams(n);return r<0?(this.unused[e]=i,Yn.warn("".concat(this.id," unused varying buffer ").concat(e))(),this):(this.buffers[r]=n,this.bindOnUse||this._bindBuffer(r,i,a,o),this)}begin(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.gl.bindTransformFeedback(36386,this.handle),this._bindBuffers(),this.gl.beginTransformFeedback(e),this}end(){return this.gl.endTransformFeedback(),this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null),this}_getBufferParams(e){let n,r,i;return e instanceof ji?i=e:(i=e.buffer,r=e.byteSize,n=e.byteOffset),(n!==void 0||r!==void 0)&&(n=n||0,r=r||i.byteLength-n),{buffer:i,byteOffset:n,byteSize:r}}_getVaryingInfo(e){return this.configuration&&this.configuration.getVaryingInfo(e)}_getVaryingIndex(e){if(this.configuration)return this.configuration.getVaryingInfo(e).location;const n=Number(e);return Number.isFinite(n)?n:-1}_bindBuffers(){if(this.bindOnUse)for(const e in this.buffers){const{buffer:n,byteSize:r,byteOffset:i}=this._getBufferParams(this.buffers[e]);this._bindBuffer(e,n,i,r)}}_unbindBuffers(){if(this.bindOnUse)for(const e in this.buffers)this._bindBuffer(e,null)}_bindBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;const o=n&&n.handle;return!o||i===void 0?this.gl.bindBufferBase(35982,e,o):this.gl.bindBufferRange(35982,e,o,r,i),this}_createHandle(){return this.gl.createTransformFeedback()}_deleteHandle(){this.gl.deleteTransformFeedback(this.handle)}_bindHandle(e){this.gl.bindTransformFeedback(36386,this.handle)}}let OS=null;function T1e(t){return(!OS||OS.byteLength<t)&&(OS=new ArrayBuffer(t)),OS}function C1e(t,e){const n=T1e(t.BYTES_PER_ELEMENT*e);return new t(n,0,e)}function P1e(t){let{target:e,source:n,start:r=0,count:i=1}=t;const o=n.length,a=i*o;let s=0;for(let u=r;s<o;s++)e[u++]=n[s];for(;s<a;)s<a-s?(e.copyWithin(r+s,r,r+s),s*=2):(e.copyWithin(r+s,r,r+a-s),s=a);return e}const I1e="elements must be GL.ELEMENT_ARRAY_BUFFER";class oc extends Eg{get[Symbol.toStringTag](){return"VertexArrayObject"}static isSupported(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}).constantAttributeZero?Hr(e)||Jee()==="Chrome":!0}static getDefaultArray(e){return e.luma=e.luma||{},e.luma.defaultVertexArray||(e.luma.defaultVertexArray=new oc(e,{handle:null,isDefaultArray:!0})),e.luma.defaultVertexArray}static getMaxAttributes(e){return oc.MAX_ATTRIBUTES=oc.MAX_ATTRIBUTES||e.getParameter(34921),oc.MAX_ATTRIBUTES}static setConstant(e,n,r){switch(r.constructor){case Float32Array:oc._setConstantFloatArray(e,n,r);break;case Int32Array:oc._setConstantIntArray(e,n,r);break;case Uint32Array:oc._setConstantUintArray(e,n,r);break;default:Nn(!1)}}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;super(e,Object.assign({},n,{id:r})),this.buffer=null,this.bufferValue=null,this.isDefaultArray=n.isDefaultArray||!1,this.gl2=e,this.initialize(n),Object.seal(this)}delete(){return super.delete(),this.buffer&&this.buffer.delete(),this}get MAX_ATTRIBUTES(){return oc.getMaxAttributes(this.gl)}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.setProps(e)}setProps(e){return this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return Nn(!e||e.target===34963,I1e),this.bind(()=>{this.gl.bindBuffer(34963,e?e.handle:null)}),this}setBuffer(e,n,r){if(n.target===34963)return this.setElementBuffer(n,r);const{size:i,type:o,stride:a,offset:s,normalized:u,integer:d,divisor:g}=r,{gl:_,gl2:E}=this;return e=Number(e),this.bind(()=>{_.bindBuffer(34962,n.handle),d?(Nn(Hr(_)),E.vertexAttribIPointer(e,i,o,a,s)):_.vertexAttribPointer(e,i,o,u,a,s),_.enableVertexAttribArray(e),E.vertexAttribDivisor(e,g||0)}),this}enable(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return!n&&e===0&&!oc.isSupported(this.gl,{constantAttributeZero:!0})||(e=Number(e),this.bind(()=>n?this.gl.enableVertexAttribArray(e):this.gl.disableVertexAttribArray(e))),this}getConstantBuffer(e,n){const r=this._normalizeConstantArrayValue(n),i=r.byteLength*e,o=r.length*e;let a=!this.buffer;if(this.buffer=this.buffer||new ji(this.gl,i),a=a||this.buffer.reallocate(i),a=a||!this._compareConstantArrayValues(r,this.bufferValue),a){const s=C1e(n.constructor,o);P1e({target:s,source:r,start:0,count:o}),this.buffer.subData(s),this.bufferValue=n}return this.buffer}_normalizeConstantArrayValue(e){return Array.isArray(e)?new Float32Array(e):e}_compareConstantArrayValues(e,n){if(!e||!n||e.length!==n.length||e.constructor!==n.constructor)return!1;for(let r=0;r<e.length;++r)if(e[r]!==n[r])return!1;return!0}static _setConstantFloatArray(e,n,r){switch(r.length){case 1:e.vertexAttrib1fv(n,r);break;case 2:e.vertexAttrib2fv(n,r);break;case 3:e.vertexAttrib3fv(n,r);break;case 4:e.vertexAttrib4fv(n,r);break;default:Nn(!1)}}static _setConstantIntArray(e,n,r){switch(Nn(Hr(e)),r.length){case 1:e.vertexAttribI1iv(n,r);break;case 2:e.vertexAttribI2iv(n,r);break;case 3:e.vertexAttribI3iv(n,r);break;case 4:e.vertexAttribI4iv(n,r);break;default:Nn(!1)}}static _setConstantUintArray(e,n,r){switch(Nn(Hr(e)),r.length){case 1:e.vertexAttribI1uiv(n,r);break;case 2:e.vertexAttribI2uiv(n,r);break;case 3:e.vertexAttribI3uiv(n,r);break;case 4:e.vertexAttribI4uiv(n,r);break;default:Nn(!1)}}_createHandle(){return this.gl.createVertexArray()}_deleteHandle(e){return this.gl2.deleteVertexArray(e),[this.elements]}_bindHandle(e){this.gl2.bindVertexArray(e)}_getParameter(e,n){let{location:r}=n;return Nn(Number.isFinite(r)),this.bind(()=>{switch(e){case 34373:return this.gl.getVertexAttribOffset(r,e);default:return this.gl.getVertexAttrib(r,e)}})}}const M1e="VertexArray: attributes must be Buffers or constants (i.e. typed array)",O1e=/^(.+)__LOCATION_([0-9]+)$/,R1e=["setBuffers","setGeneric","clearBindings","setLocations","setGenericValues","setDivisor","enable","disable"];class L1e{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=n.id||n.program&&n.program.id;this.id=r,this.gl=e,this.configuration=null,this.elements=null,this.elementsAccessor=null,this.values=null,this.accessors=null,this.unused=null,this.drawParams=null,this.buffer=null,this.attributes={},this.vertexArrayObject=new oc(e),ute(this,"VertexArray","v6.0",R1e),this.initialize(n),Object.seal(this)}delete(){this.buffer&&this.buffer.delete(),this.vertexArrayObject.delete()}initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return this.reset(),this.configuration=null,this.bindOnUse=!1,this.setProps(e)}reset(){this.elements=null,this.elementsAccessor=null;const{MAX_ATTRIBUTES:e}=this.vertexArrayObject;return this.values=new Array(e).fill(null),this.accessors=new Array(e).fill(null),this.unused={},this.drawParams=null,this}setProps(e){return"program"in e&&(this.configuration=e.program&&e.program.configuration),"configuration"in e&&(this.configuration=e.configuration),"attributes"in e&&this.setAttributes(e.attributes),"elements"in e&&this.setElementBuffer(e.elements),"bindOnUse"in e&&(e=e.bindOnUse),this}clearDrawParams(){this.drawParams=null}getDrawParams(){return this.drawParams=this.drawParams||this._updateDrawParams(),this.drawParams}setAttributes(e){return Object.assign(this.attributes,e),this.vertexArrayObject.bind(()=>{for(const n in e){const r=e[n];this._setAttribute(n,r)}this.gl.bindBuffer(34962,null)}),this}setElementBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.elements=e,this.elementsAccessor=n,this.clearDrawParams(),this.vertexArrayObject.setElementBuffer(e,n),this}setBuffer(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(n.target===34963)return this.setElementBuffer(n,r);const{location:i,accessor:o}=this._resolveLocationAndAccessor(e,n,n.accessor,r);return i>=0&&(this.values[i]=n,this.accessors[i]=o,this.clearDrawParams(),this.vertexArrayObject.setBuffer(i,n,o)),this}setConstant(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const{location:i,accessor:o}=this._resolveLocationAndAccessor(e,n,Object.assign({size:n.length},r));return i>=0&&(n=this.vertexArrayObject._normalizeConstantArrayValue(n),this.values[i]=n,this.accessors[i]=o,this.clearDrawParams(),this.vertexArrayObject.enable(i,!1)),this}unbindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.vertexArrayObject.setElementBuffer(null),this.buffer=this.buffer||new ji(this.gl,{accessor:{size:4}});for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++)this.values[e]instanceof ji&&(this.gl.disableVertexAttribArray(e),this.gl.bindBuffer(34962,this.buffer.handle),this.gl.vertexAttribPointer(e,1,5126,!1,0,0))}),this}bindBuffers(){return this.vertexArrayObject.bind(()=>{this.elements&&this.setElementBuffer(this.elements);for(let e=0;e<this.vertexArrayObject.MAX_ATTRIBUTES;e++){const n=this.values[e];n instanceof ji&&this.setBuffer(e,n)}}),this}bindForDraw(e,n,r){let i;return this.vertexArrayObject.bind(()=>{this._setConstantAttributes(e,n),i=r()}),i}_resolveLocationAndAccessor(e,n,r,i){const o={location:-1,accessor:null},{location:a,name:s}=this._getAttributeIndex(e);if(!Number.isFinite(a)||a<0)return this.unused[e]=n,Yn.once(3,()=>"unused value ".concat(e," in ").concat(this.id))(),o;const u=this._getAttributeInfo(s||a);if(!u)return o;const d=this.accessors[a]||{},g=wu.resolve(u.accessor,d,r,i),{size:_,type:E}=g;return Nn(Number.isFinite(_)&&Number.isFinite(E)),{location:a,accessor:g}}_getAttributeInfo(e){return this.configuration&&this.configuration.getAttributeInfo(e)}_getAttributeIndex(e){const n=Number(e);if(Number.isFinite(n))return{location:n};const r=O1e.exec(e),i=r?r[1]:e,o=r?Number(r[2]):0;return this.configuration?{location:this.configuration.getAttributeLocation(i)+o,name:i}:{location:-1}}_setAttribute(e,n){if(n instanceof ji)this.setBuffer(e,n);else if(Array.isArray(n)&&n.length&&n[0]instanceof ji){const r=n[0],i=n[1];this.setBuffer(e,r,i)}else if(ArrayBuffer.isView(n)||Array.isArray(n)){const r=n;this.setConstant(e,r)}else if(n.buffer instanceof ji){const r=n;this.setBuffer(e,r.buffer,r)}else throw new Error(M1e)}_setConstantAttributes(e,n){const r=Math.max(e|0,n|0);let i=this.values[0];ArrayBuffer.isView(i)&&this._setConstantAttributeZero(i,r);for(let o=1;o<this.vertexArrayObject.MAX_ATTRIBUTES;o++)i=this.values[o],ArrayBuffer.isView(i)&&this._setConstantAttribute(o,i)}_setConstantAttributeZero(e,n){if(oc.isSupported(this.gl,{constantAttributeZero:!0})){this._setConstantAttribute(0,e);return}const r=this.vertexArrayObject.getConstantBuffer(n,e);this.vertexArrayObject.setBuffer(0,r,this.accessors[0])}_setConstantAttribute(e,n){oc.setConstant(this.gl,e,n)}_updateDrawParams(){const e={isIndexed:!1,isInstanced:!1,indexCount:1/0,vertexCount:1/0,instanceCount:1/0};for(let n=0;n<this.vertexArrayObject.MAX_ATTRIBUTES;n++)this._updateDrawParamsForLocation(e,n);return this.elements&&(e.elementCount=this.elements.getElementCount(this.elements.accessor),e.isIndexed=!0,e.indexType=this.elementsAccessor.type||this.elements.accessor.type,e.indexOffset=this.elementsAccessor.offset||0),e.indexCount===1/0&&(e.indexCount=0),e.vertexCount===1/0&&(e.vertexCount=0),e.instanceCount===1/0&&(e.instanceCount=0),e}_updateDrawParamsForLocation(e,n){const r=this.values[n],i=this.accessors[n];if(!r)return;const{divisor:o}=i,a=o>0;if(e.isInstanced=e.isInstanced||a,r instanceof ji){const s=r;if(a){const u=s.getVertexCount(i);e.instanceCount=Math.min(e.instanceCount,u)}else{const u=s.getVertexCount(i);e.vertexCount=Math.min(e.vertexCount,u)}}}setElements(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Yn.deprecated("setElements","setElementBuffer")(),this.setElementBuffer(e,n)}}function D1e(t,e){const{maxElts:n=16,size:r=1}=e;let i="[";for(let a=0;a<t.length&&a<n;++a)a>0&&(i+=",".concat(a%r===0?" ":"")),i+=Vw(t[a],e);const o=t.length>n?"...":"]";return"".concat(i).concat(o)}function Vw(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=1e-16,{isInteger:r=!1}=e;if(Array.isArray(t)||ArrayBuffer.isView(t))return D1e(t,e);if(!Number.isFinite(t))return String(t);if(Math.abs(t)<n)return r?"0":"0.";if(r||Math.abs(t)>100&&Math.abs(t)<1e4)return t.toFixed(0);const i=t.toPrecision(2);return i.indexOf(".0")===i.length-2?i.slice(0,-1):i}function g$(t){let{header:e="Uniforms",program:n,uniforms:r,undefinedOnly:i=!1}=t;Nn(n);const o=".*_.*",a=".*Matrix",s=n._uniformSetters,u={},d=Object.keys(s).sort();let g=0;for(const P of d)!P.match(o)&&!P.match(a)&&qD({table:u,header:e,uniforms:r,uniformName:P,undefinedOnly:i})&&g++;for(const P of d)P.match(a)&&qD({table:u,header:e,uniforms:r,uniformName:P,undefinedOnly:i})&&g++;for(const P of d)u[P]||qD({table:u,header:e,uniforms:r,uniformName:P,undefinedOnly:i})&&g++;let _=0;const E={};if(!i)for(const P in r){const O=r[P];u[P]||(_++,E[P]={Type:"NOT USED: ".concat(O),[e]:Vw(O)})}return{table:u,count:g,unusedTable:E,unusedCount:_}}function qD(t){let{table:e,header:n,uniforms:r,uniformName:i,undefinedOnly:o}=t;const a=r[i],s=B1e(a);return!o||!s?(e[i]={[n]:s?Vw(a):"N/A","Uniform Type":s?a:"NOT PROVIDED"},!0):!1}function B1e(t){return t!=null}function N1e(t){let{vertexArray:e,header:n="Attributes"}=t;if(!e.configuration)return{};const r={};e.elements&&(r.ELEMENT_ARRAY_BUFFER=m$(e,e.elements,null,n));const i=e.values;for(const o in i){const a=e._getAttributeInfo(o);if(a){let s="".concat(o,": ").concat(a.name);const u=e.accessors[a.location];u&&(s="".concat(o,": ").concat(F1e(a.name,u))),r[s]=m$(e,i[o],u,n)}}return r}function m$(t,e,n,r){const{gl:i}=t;if(!e)return{[r]:"null","Format ":"N/A"};let o="NOT PROVIDED",a=1,s=0,u=0,d,g,_;if(n&&(o=n.type,a=n.size,o=String(o).replace("Array",""),d=o.indexOf("nt")!==-1),e instanceof ji){const E=e,{data:P,changed:O}=E.getDebugData();g=O?"*":"",_=P,u=E.byteLength,s=u/P.BYTES_PER_ELEMENT/a;let D;if(n){const V=n.divisor>0;D="".concat(V?"I ":"P "," ").concat(s," (x").concat(a,"=").concat(u," bytes ").concat(jm(i,o),")")}else d=!0,D="".concat(u," bytes");return{[r]:"".concat(g).concat(Vw(_,{size:a,isInteger:d})),"Format ":D}}return _=e,a=e.length,o=String(e.constructor.name).replace("Array",""),d=o.indexOf("nt")!==-1,{[r]:"".concat(Vw(_,{size:a,isInteger:d})," (constant)"),"Format ":"".concat(a,"x").concat(o," (constant)")}}function F1e(t,e){const{type:n,size:r}=e,i=bte(n,r);return i?"".concat(t," (").concat(i.name,")"):t}function k1e(t){const e={},n="Accessors for ".concat(t.id);for(const r of t.attributeInfos)if(r){const i=A$(r);e["in ".concat(i)]={[n]:JSON.stringify(r.accessor)}}for(const r of t.varyingInfos)if(r){const i=A$(r);e["out ".concat(i)]={[n]:JSON.stringify(r.accessor)}}return e}function A$(t){const{type:e,size:n}=t.accessor,r=bte(e,n);return r?"".concat(r.name," ").concat(t.name):t.name}const _$=wg()&&typeof document<"u";let z1e=0;class wte{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{onCreateContext:n=V=>A5(V),onAddHTML:r=null,onInitialize:i=()=>{},onRender:o=()=>{},onFinalize:a=()=>{},onError:s,gl:u=null,glOptions:d={},debug:g=!1,createFramebuffer:_=!1,autoResizeViewport:E=!0,autoResizeDrawingBuffer:P=!0,stats:O=Im.get("animation-loop-".concat(z1e++))}=e;let{useDevicePixels:D=!0}=e;"useDevicePixelRatio"in e&&(Yn.deprecated("useDevicePixelRatio","useDevicePixels")(),D=e.useDevicePixelRatio),this.props={onCreateContext:n,onAddHTML:r,onInitialize:i,onRender:o,onFinalize:a,onError:s,gl:u,glOptions:d,debug:g,createFramebuffer:_},this.gl=u,this.needsRedraw=null,this.timeline=null,this.stats=O,this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this._initialized=!1,this._running=!1,this._animationFrameId=null,this._nextFramePromise=null,this._resolveNextFrame=null,this._cpuStartTime=0,this.setProps({autoResizeViewport:E,autoResizeDrawingBuffer:P,useDevicePixels:D}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._pageLoadPromise=null,this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}delete(){this.stop(),this._setDisplay(null)}setNeedsRedraw(e){return Nn(typeof e=="string"),this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.autoResizeViewport=e.autoResizeViewport),"autoResizeDrawingBuffer"in e&&(this.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer),"useDevicePixels"in e&&(this.useDevicePixels=e.useDevicePixels),this}start(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return this;this._running=!0;const n=this._getPageLoadPromise().then(()=>!this._running||this._initialized?null:(this._createWebGLContext(e),this._createFramebuffer(),this._startEventHandling(),this._initializeCallbackData(),this._updateCallbackData(),this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._gpuTimeQuery=oI.isSupported(this.gl,["timers"])?new oI(this.gl):null,this._initialized=!0,this.onInitialize(this.animationProps))).then(r=>{this._running&&(this._addCallbackData(r||{}),r!==!1&&this._startLoop())});return this.props.onError&&n.catch(this.props.onError),this}redraw(){return this.isContextLost()?this:(this._beginTimers(),this._setupFrame(),this._updateCallbackData(),this._renderFrame(this.animationProps),this._clearNeedsRedraw(),this.offScreen&&this.gl.commit&&this.gl.commit(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endTimers(),this)}stop(){return this._running&&(this._finalizeCallbackData(),this._cancelAnimationFrame(this._animationFrameId),this._nextFramePromise=null,this._resolveNextFrame=null,this._animationFrameId=null,this._running=!1),this}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){return this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.gl.canvas.toDataURL()}isContextLost(){return this.gl.isContextLost()}onCreateContext(){return this.props.onCreateContext(...arguments)}onInitialize(){return this.props.onInitialize(...arguments)}onRender(){return this.props.onRender(...arguments)}onFinalize(){return this.props.onFinalize(...arguments)}getHTMLControlValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;const r=document.getElementById(e);return r?Number(r.value):n}setViewParameters(){return Yn.removed("AnimationLoop.setViewParameters","AnimationLoop.setProps")(),this}_startLoop(){const e=()=>{this._running&&(this.redraw(),this._animationFrameId=this._requestAnimationFrame(e))};this._cancelAnimationFrame(this._animationFrameId),this._animationFrameId=this._requestAnimationFrame(e)}_getPageLoadPromise(){return this._pageLoadPromise||(this._pageLoadPromise=_$?new Promise((e,n)=>{if(_$&&document.readyState==="complete"){e(document);return}window.addEventListener("load",()=>{e(document)})}):Promise.resolve({})),this._pageLoadPromise}_setDisplay(e){this.display&&(this.display.delete(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_cancelAnimationFrame(e){return this.display&&this.display.cancelAnimationFrame?this.display.cancelAnimationFrame(e):Zye(e)}_requestAnimationFrame(e){if(this._running)return this.display&&this.display.requestAnimationFrame?this.display.requestAnimationFrame(e):Xye(e)}_renderFrame(){if(this.display){this.display._renderFrame(...arguments);return}this.onRender(...arguments)}_clearNeedsRedraw(){this.needsRedraw=null}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport(),this._resizeFramebuffer()}_initializeCallbackData(){this.animationProps={gl:this.gl,stop:this.stop,canvas:this.gl.canvas,framebuffer:this.framebuffer,useDevicePixels:this.useDevicePixels,needsRedraw:null,startTime:Date.now(),engineTime:0,tick:0,tock:0,time:0,_timeline:this.timeline,_loop:this,_animationLoop:this,_mousePosition:null}}_updateCallbackData(){const{width:e,height:n,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||n!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=n,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime,this.animationProps._offScreen=this.offScreen}_finalizeCallbackData(){this.onFinalize(this.animationProps)}_addCallbackData(e){typeof e=="object"&&e!==null&&(this.animationProps=Object.assign({},this.animationProps,e))}_createWebGLContext(e){if(this.offScreen=e.canvas&&typeof OffscreenCanvas<"u"&&e.canvas instanceof OffscreenCanvas,e=Object.assign({},e,this.props.glOptions),this.gl=this.props.gl?zO(this.props.gl,e):this.onCreateContext(e),!LE(this.gl))throw new Error("AnimationLoop.onCreateContext - illegal context returned");ate(this.gl),this._createInfoDiv()}_createInfoDiv(){if(this.gl.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const n=document.createElement("div");n.style.position="absolute",n.style.left="10px",n.style.bottom="10px",n.style.width="300px",n.style.background="white",e.appendChild(this.gl.canvas),e.appendChild(n);const r=this.props.onAddHTML(n);r&&(n.innerHTML=r)}}_getSizeAndAspect(){const e=this.gl.drawingBufferWidth,n=this.gl.drawingBufferHeight;let r=1;const{canvas:i}=this.gl;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&n>0&&(r=e/n),{width:e,height:n,aspect:r}}_resizeViewport(){this.autoResizeViewport&&this.gl.viewport(0,0,this.gl.drawingBufferWidth,this.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){this.autoResizeDrawingBuffer&&Uye(this.gl,{useDevicePixels:this.useDevicePixels})}_createFramebuffer(){this.props.createFramebuffer&&(this.framebuffer=new Ws(this.gl))}_resizeFramebuffer(){this.framebuffer&&this.framebuffer.resize({width:this.gl.drawingBufferWidth,height:this.gl.drawingBufferHeight})}_beginTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this._gpuTimeQuery&&this._gpuTimeQuery.isResultAvailable()&&!this._gpuTimeQuery.isTimerDisjoint()&&this.stats.get("GPU Time").addTime(this._gpuTimeQuery.getTimerMilliseconds()),this._gpuTimeQuery&&this._gpuTimeQuery.beginTimeElapsedQuery(),this.cpuTime.timeStart()}_endTimers(){this.cpuTime.timeEnd(),this._gpuTimeQuery&&this._gpuTimeQuery.end()}_startEventHandling(){const{canvas:e}=this.gl;e&&(e.addEventListener("mousemove",this._onMousemove),e.addEventListener("mouseleave",this._onMouseleave))}_onMousemove(e){this.animationProps._mousePosition=[e.offsetX,e.offsetY]}_onMouseleave(e){this.animationProps._mousePosition=null}}const kE="vs",S5="fs";function dc(t,e){if(!t)throw new Error(e||"shadertools: assertion failed.")}const XD={number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},array:{validate(t,e){return Array.isArray(t)||ArrayBuffer.isView(t)}}};function U1e(t){const e={};for(const n in t){const r=t[n],i=G1e(r);e[n]=i}return e}function G1e(t){let e=y$(t);return e==="object"?t?"type"in t?Object.assign({},t,XD[t.type]):"value"in t?(e=y$(t.value),Object.assign({type:e},t,XD[e])):{type:"object",value:t}:{type:"object",value:null}:Object.assign({type:e,value:t},XD[e])}function y$(t){return Array.isArray(t)||ArrayBuffer.isView(t)?"array":typeof t}const j1e="vs",V1e="fs";class zF{constructor(e){let{name:n,vs:r,fs:i,dependencies:o=[],uniforms:a,getUniforms:s,deprecations:u=[],defines:d={},inject:g={},vertexShader:_,fragmentShader:E}=e;dc(typeof n=="string"),this.name=n,this.vs=r||_,this.fs=i||E,this.getModuleUniforms=s,this.dependencies=o,this.deprecations=this._parseDeprecationDefinitions(u),this.defines=d,this.injections=$1e(g),a&&(this.uniforms=U1e(a))}getModuleSource(e){let n;switch(e){case j1e:n=this.vs||"";break;case V1e:n=this.fs||"";break;default:dc(!1)}return"#define MODULE_".concat(this.name.toUpperCase().replace(/[^0-9a-z]/gi,"_"),`
`).concat(n,"// END MODULE_").concat(this.name,`

`)}getUniforms(e,n){return this.getModuleUniforms?this.getModuleUniforms(e,n):this.uniforms?this._defaultGetUniforms(e):{}}getDefines(){return this.defines}checkDeprecations(e,n){this.deprecations.forEach(r=>{r.regex.test(e)&&(r.deprecated?n.deprecated(r.old,r.new)():n.removed(r.old,r.new)())})}_parseDeprecationDefinitions(e){return e.forEach(n=>{switch(n.type){case"function":n.regex=new RegExp("\\b".concat(n.old,"\\("));break;default:n.regex=new RegExp("".concat(n.type," ").concat(n.old,";"))}}),e}_defaultGetUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={},r=this.uniforms;for(const i in r){const o=r[i];i in e&&!o.private?(o.validate&&dc(o.validate(e[i],o),"".concat(this.name,": invalid ").concat(i)),n[i]=e[i]):n[i]=o.value}return n}}function Ete(t){if(!t.normalized&&(t.normalized=!0,t.uniforms&&!t.getUniforms)){const e=new zF(t);t.getUniforms=e.getUniforms.bind(e)}return t}function $1e(t){const e={vs:{},fs:{}};for(const n in t){let r=t[n];const i=n.slice(0,2);typeof r=="string"&&(r={order:0,injection:r}),e[i][n]=r}return e}function H1e(t){return W1e(Tte(t))}function W1e(t){const e={},n={};return Ste({modules:t,level:0,moduleMap:e,moduleDepth:n}),Object.keys(n).sort((r,i)=>n[i]-n[r]).map(r=>e[r])}function Ste(t){let{modules:e,level:n,moduleMap:r,moduleDepth:i}=t;if(n>=5)throw new Error("Possible loop in shader dependency graph");for(const o of e)r[o.name]=o,(i[o.name]===void 0||i[o.name]<n)&&(i[o.name]=n);for(const o of e)o.dependencies&&Ste({modules:o.dependencies,level:n+1,moduleMap:r,moduleDepth:i})}function Tte(t,e){return t.map(n=>(n instanceof zF||(dc(typeof n!="string","Shader module use by name is deprecated. Import shader module '".concat(n,"' and use it directly.")),dc(n.name,"shader module has no name"),n=new zF(n),n.dependencies=Tte(n.dependencies)),n))}function q1e(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=typeof window<"u"?window.navigator||{}:{},n=t.userAgent||e.userAgent||"",r=n.indexOf("MSIE ")!==-1,i=n.indexOf("Trident/")!==-1;return r||i}const X1e=7936,Z1e=7937,Y1e=7938,Q1e=35724,T5={GLSL_FRAG_DATA:["WEBGL_draw_buffers",!0],GLSL_FRAG_DEPTH:["EXT_frag_depth",!0],GLSL_DERIVATIVES:["OES_standard_derivatives",!0],GLSL_TEXTURE_LOD:["EXT_shader_texture_lod",!0]},y0={};Object.keys(T5).forEach(t=>{y0[t]=t});function K1e(t){return typeof WebGL2RenderingContext<"u"&&t instanceof WebGL2RenderingContext?!0:!!(t&&t._version===2)}function J1e(t){const e=t.getExtension("WEBGL_debug_renderer_info"),n=t.getParameter(e&&e.UNMASKED_VENDOR_WEBGL||X1e),r=t.getParameter(e&&e.UNMASKED_RENDERER_WEBGL||Z1e);return{gpuVendor:exe(n,r),vendor:n,renderer:r,version:t.getParameter(Y1e),shadingLanguageVersion:t.getParameter(Q1e)}}function exe(t,e){return t.match(/NVIDIA/i)||e.match(/NVIDIA/i)?"NVIDIA":t.match(/INTEL/i)||e.match(/INTEL/i)?"INTEL":t.match(/AMD/i)||e.match(/AMD/i)||t.match(/ATI/i)||e.match(/ATI/i)?"AMD":"UNKNOWN GPU"}const ZD={};function v$(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=T5[e];if(dc(r,e),!q1e(n))return!0;if(e in ZD)return ZD[e];const i=r[0],o=n.behavior||"enable",a="#extension GL_".concat(i," : ").concat(o,`
void main(void) {}`),s=t.createShader(35633);t.shaderSource(s,a),t.compileShader(s);const u=t.getShaderParameter(s,35713);return t.deleteShader(s),ZD[e]=u,u}function txe(t,e){const n=T5[e];dc(n,e);const r=K1e(t)&&n[1]||n[0],i=typeof r=="string"?!!t.getExtension(r):r;return dc(i===!1||i===!0),i}function RS(t,e){return e=Array.isArray(e)?e:[e],e.every(n=>txe(t,n))}function nxe(t){switch(J1e(t).gpuVendor.toLowerCase()){case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function rxe(t,e,n){let r=`#if (__VERSION__ > 120)

# define FEATURE_GLSL_DERIVATIVES
# define FEATURE_GLSL_DRAW_BUFFERS
# define FEATURE_GLSL_FRAG_DEPTH
# define FEATURE_GLSL_TEXTURE_LOD

// DEPRECATED FLAGS, remove in v9
# define FRAG_DEPTH
# define DERIVATIVES
# define DRAW_BUFFERS
# define TEXTURE_LOD

#endif // __VERSION
`;return RS(t,y0.GLSL_FRAG_DEPTH)&&(r+=`
// FRAG_DEPTH => gl_FragDepth is available
#ifdef GL_EXT_frag_depth
#extension GL_EXT_frag_depth : enable
# define FEATURE_GLSL_FRAG_DEPTH
# define FRAG_DEPTH
# define gl_FragDepth gl_FragDepthEXT
#endif
`),RS(t,y0.GLSL_DERIVATIVES)&&v$(t,y0.GLSL_DERIVATIVES)&&(r+=`
// DERIVATIVES => dxdF, dxdY and fwidth are available
#ifdef GL_OES_standard_derivatives
#extension GL_OES_standard_derivatives : enable
# define FEATURE_GLSL_DERIVATIVES
# define DERIVATIVES
#endif
`),RS(t,y0.GLSL_FRAG_DATA)&&v$(t,y0.GLSL_FRAG_DATA,{behavior:"require"})&&(r+=`
// DRAW_BUFFERS => gl_FragData[] is available
#ifdef GL_EXT_draw_buffers
#extension GL_EXT_draw_buffers : require
#define FEATURE_GLSL_DRAW_BUFFERS
#define DRAW_BUFFERS
#endif
`),RS(t,y0.GLSL_TEXTURE_LOD)&&(r+=`// TEXTURE_LOD => texture2DLod etc are available
#ifdef GL_EXT_shader_texture_lod
#extension GL_EXT_shader_texture_lod : enable

# define FEATURE_GLSL_TEXTURE_LOD
# define TEXTURE_LOD

#endif
`),r}const ixe=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,oxe=`#ifdef MODULE_MATERIAL
  gl_FragColor = material_filterColor(gl_FragColor);
#endif

#ifdef MODULE_LIGHTING
  gl_FragColor = lighting_filterColor(gl_FragColor);
#endif

#ifdef MODULE_FOG
  gl_FragColor = fog_filterColor(gl_FragColor);
#endif

#ifdef MODULE_PICKING
  gl_FragColor = picking_filterHighlightColor(gl_FragColor);
  gl_FragColor = picking_filterPickingColor(gl_FragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,sxe={[kE]:ixe,[S5]:oxe},uC="__LUMA_INJECT_DECLARATIONS__",x$=/void\s+main\s*\([^)]*\)\s*\{\n?/,b$=/}\n?[^{}]*$/,YD=[];function w$(t,e,n){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const i=e===kE;for(const o in n){const a=n[o];a.sort((u,d)=>u.order-d.order),YD.length=a.length;for(let u=0,d=a.length;u<d;++u)YD[u]=a[u].injection;const s="".concat(YD.join(`
`),`
`);switch(o){case"vs:#decl":i&&(t=t.replace(uC,s));break;case"vs:#main-start":i&&(t=t.replace(x$,u=>u+s));break;case"vs:#main-end":i&&(t=t.replace(b$,u=>s+u));break;case"fs:#decl":i||(t=t.replace(uC,s));break;case"fs:#main-start":i||(t=t.replace(x$,u=>u+s));break;case"fs:#main-end":i||(t=t.replace(b$,u=>s+u));break;default:t=t.replace(o,u=>u+s)}}return t=t.replace(uC,""),r&&(t=t.replace(/\}\s*$/,o=>o+sxe[e])),t}function UF(t){const e={};return dc(Array.isArray(t)&&t.length>1),t.forEach(n=>{for(const r in n)e[r]=e[r]?"".concat(e[r],`
`).concat(n[r]):n[r]}),e}function kv(t){return new RegExp("\\b".concat(t,"[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)"),"g")}const Cte=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],axe=[...Cte,[kv("attribute"),"in $1"],[kv("varying"),"out $1"]],lxe=[...Cte,[kv("varying"),"in $1"]],Pte=[[/^#version[ \t]+300[ \t]+es/,"#version 100"],[/\btexture(2D|2DProj|Cube)Lod\(/g,"texture$1LodEXT("],[/\btexture\(/g,"texture2D("],[/\btextureLod\(/g,"texture2DLodEXT("]],uxe=[...Pte,[kv("in"),"attribute $1"],[kv("out"),"varying $1"]],cxe=[...Pte,[kv("in"),"varying $1"]],GF="gl_FragColor",jF=/\bout[ \t]+vec4[ \t]+(\w+)[ \t]*;\n?/,fxe=/void\s+main\s*\([^)]*\)\s*\{\n?/;function hxe(t,e,n){switch(e){case 300:return n?sI(t,axe):dxe(t);case 100:return n?sI(t,uxe):pxe(t);default:throw new Error("unknown GLSL version ".concat(e))}}function sI(t,e){for(const[n,r]of e)t=t.replace(n,r);return t}function dxe(t){t=sI(t,lxe);const e=t.match(jF);if(e){const n=e[1];t=t.replace(new RegExp("\\b".concat(GF,"\\b"),"g"),n)}else{const n="fragmentColor";t=t.replace(fxe,r=>"out vec4 ".concat(n,`;
`).concat(r)).replace(new RegExp("\\b".concat(GF,"\\b"),"g"),n)}return t}function pxe(t){t=sI(t,cxe);const e=t.match(jF);if(e){const n=e[1];t=t.replace(jF,"").replace(new RegExp("\\b".concat(n,"\\b"),"g"),GF)}return t}const gxe=`

`.concat(uC,`

`),Ite={[kE]:"vertex",[S5]:"fragment"},mxe=`precision highp float;

`;function Axe(t,e){const{vs:n,fs:r}=e,i=H1e(e.modules||[]);return{gl:t,vs:E$(t,Object.assign({},e,{source:n,type:kE,modules:i})),fs:E$(t,Object.assign({},e,{source:r,type:S5,modules:i})),getUniforms:_xe(i)}}function E$(t,e){let{id:n,source:r,type:i,modules:o,defines:a={},hookFunctions:s=[],inject:u={},transpileToGLSL100:d=!1,prologue:g=!0,log:_}=e;dc(typeof r=="string","shader source must be a string");const E=i===kE,P=r.split(`
`);let O=100,D="",V=r;P[0].indexOf("#version ")===0?(O=300,D=P[0],V=P.slice(1).join(`
`)):D="#version ".concat(O);const k={};o.forEach(re=>{Object.assign(k,re.getDefines())}),Object.assign(k,a);let F=g?"".concat(D,`
`).concat(vxe({id:n,source:r,type:i}),`
`).concat(yxe({type:i}),`
`).concat(nxe(t),`
`).concat(rxe(t),`
`).concat(xxe(k),`
`).concat(E?"":mxe,`
`):"".concat(D,`
`);const z=wxe(s),X={},Y={},J={};for(const re in u){const ue=typeof u[re]=="string"?{injection:u[re],order:0}:u[re],ie=re.match(/^(v|f)s:(#)?([\w-]+)$/);if(ie){const ce=ie[2],se=ie[3];ce?se==="decl"?Y[re]=[ue]:J[re]=[ue]:X[re]=[ue]}else J[re]=[ue]}for(const re of o){_&&re.checkDeprecations(V,_);const ue=re.getModuleSource(i,O);F+=ue;const ie=re.injections[i];for(const ce in ie){const se=ce.match(/^(v|f)s:#([\w-]+)$/);if(se){const Ce=se[2]==="decl"?Y:J;Ce[ce]=Ce[ce]||[],Ce[ce].push(ie[ce])}else X[ce]=X[ce]||[],X[ce].push(ie[ce])}}return F+=gxe,F=w$(F,i,Y),F+=bxe(z[i],X),F+=V,F=w$(F,i,J),F=hxe(F,d?100:O,E),F}function _xe(t){return function(n){const r={};for(const i of t){const o=i.getUniforms(n,r);Object.assign(r,o)}return r}}function yxe(t){let{type:e}=t;return`
#define SHADER_TYPE_`.concat(Ite[e].toUpperCase(),`
`)}function vxe(t){let{id:e,source:n,type:r}=t;return e&&typeof e=="string"&&n.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME `.concat(e,"_").concat(Ite[r],`

`):""}function xxe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=0,n="";for(const r in t){e===0&&(n+=`
// APPLICATION DEFINES
`),e++;const i=t[r];(i||Number.isFinite(i))&&(n+="#define ".concat(r.toUpperCase()," ").concat(t[r],`
`))}return e===0&&(n+=`
`),n}function bxe(t,e){let n="";for(const r in t){const i=t[r];if(n+="void ".concat(i.signature,` {
`),i.header&&(n+="  ".concat(i.header)),e[r]){const o=e[r];o.sort((a,s)=>a.order-s.order);for(const a of o)n+="  ".concat(a.injection,`
`)}i.footer&&(n+="  ".concat(i.footer)),n+=`}
`}return n}function wxe(t){const e={vs:{},fs:{}};return t.forEach(n=>{let r;typeof n!="string"?(r=n,n=r.hook):r={},n=n.trim();const[i,o]=n.split(":"),a=n.replace(/\(.+/,"");e[i][a]=Object.assign(r,{signature:o})}),e}const Exe="void main() {gl_FragColor = vec4(0);}",Mte=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,Sxe=`#version 300 es
`.concat(Mte);function Ote(t,e){e=Array.isArray(e)?e:[e];const n=t.replace(/^\s+/,"").split(/\s+/),[r,i,o]=n;if(!e.includes(r)||!i||!o)return null;const a=o.split(";")[0];return{qualifier:r,type:i,name:a}}function Rte(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{version:e=100,input:n,inputType:r,output:i}=t;if(!n)return e===300?Sxe:e>300?"#version ".concat(e,`
`).concat(Mte):Exe;const o=Pxe(n,r);return e>=300?"#version ".concat(e," ").concat(e===300?"es":"",`
in `).concat(r," ").concat(n,`;
out vec4 `).concat(i,`;
void main() {
  `).concat(i," = ").concat(o,`;
}`):"varying ".concat(r," ").concat(n,`;
void main() {
  gl_FragColor = `).concat(o,`;
}`)}function Txe(t){switch(t){case"float":return"x";case"vec2":return"xy";case"vec3":return"xyz";case"vec4":return"xyzw";default:return dc(!1),null}}function Cxe(t){switch(t){case"float":return 1;case"vec2":return 2;case"vec3":return 3;case"vec4":return 4;default:return dc(!1),null}}function Pxe(t,e){switch(e){case"float":return"vec4(".concat(t,", 0.0, 0.0, 1.0)");case"vec2":return"vec4(".concat(t,", 0.0, 1.0)");case"vec3":return"vec4(".concat(t,", 1.0)");case"vec4":return t;default:return dc(!1),null}}const Ixe=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01;
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03;
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04;
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06;

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,Lte={name:"fp32",vs:Ixe,fs:null};function C5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=Math.fround(t),i=t-r;return e[n]=r,e[n+1]=i,e}function Dte(t){return t-Math.fround(t)}function Bte(t){const e=new Float32Array(32);for(let n=0;n<4;++n)for(let r=0;r<4;++r){const i=n*4+r;C5(t[r*4+n],e,i*2)}return e}const Mxe=`uniform float ONE;
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * ONE - (t - a);
  float a_lo = a * ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * ONE;
  float err = b - (sum - a) * ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * ONE - a) * ONE;
  float err = (a - (s - v) * ONE) * ONE * ONE * ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * ONE - a) * ONE;
  float err = (a - (s - v) * ONE) * ONE * ONE * ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * ONE + 2.0 * a_fp64.x *
    a_fp64.y * ONE * ONE) + a_fp64.y * a_fp64.y * ONE * ONE * ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,Oxe=`const vec2 E_FP64 = vec2(2.7182817459106445e+00, 8.254840366817007e-08);
const vec2 LOG2_FP64 = vec2(0.6931471824645996e+00, -1.9046542121259336e-09);
const vec2 PI_FP64 = vec2(3.1415927410125732, -8.742278012618954e-8);
const vec2 TWO_PI_FP64 = vec2(6.2831854820251465, -1.7484556025237907e-7);
const vec2 PI_2_FP64 = vec2(1.5707963705062866, -4.371139006309477e-8);
const vec2 PI_4_FP64 = vec2(0.7853981852531433, -2.1855695031547384e-8);
const vec2 PI_16_FP64 = vec2(0.19634954631328583, -5.463923757886846e-9);
const vec2 PI_16_2_FP64 = vec2(0.39269909262657166, -1.0927847515773692e-8);
const vec2 PI_16_3_FP64 = vec2(0.5890486240386963, -1.4906100798128818e-9);
const vec2 PI_180_FP64 = vec2(0.01745329238474369, 1.3519960498364902e-10);

const vec2 SIN_TABLE_0_FP64 = vec2(0.19509032368659973, -1.6704714833615242e-9);
const vec2 SIN_TABLE_1_FP64 = vec2(0.3826834261417389, 6.22335089017767e-9);
const vec2 SIN_TABLE_2_FP64 = vec2(0.5555702447891235, -1.1769521357507529e-8);
const vec2 SIN_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617041793133e-8);

const vec2 COS_TABLE_0_FP64 = vec2(0.9807852506637573, 2.9739473106360492e-8);
const vec2 COS_TABLE_1_FP64 = vec2(0.9238795042037964, 2.8307490351764386e-8);
const vec2 COS_TABLE_2_FP64 = vec2(0.8314695954322815, 1.6870263741530778e-8);
const vec2 COS_TABLE_3_FP64 = vec2(0.7071067690849304, 1.2101617152815436e-8);

const vec2 INVERSE_FACTORIAL_3_FP64 = vec2(1.666666716337204e-01, -4.967053879312289e-09);
const vec2 INVERSE_FACTORIAL_4_FP64 = vec2(4.16666679084301e-02, -1.2417634698280722e-09);
const vec2 INVERSE_FACTORIAL_5_FP64 = vec2(8.333333767950535e-03, -4.34617203337595e-10);
const vec2 INVERSE_FACTORIAL_6_FP64 = vec2(1.3888889225199819e-03, -3.3631094437103215e-11);
const vec2 INVERSE_FACTORIAL_7_FP64 = vec2(1.9841270113829523e-04,  -2.725596874933456e-12);
const vec2 INVERSE_FACTORIAL_8_FP64 = vec2(2.4801587642286904e-05, -3.406996025904184e-13);
const vec2 INVERSE_FACTORIAL_9_FP64 = vec2(2.75573188446287533e-06, 3.7935713937038186e-14);
const vec2 INVERSE_FACTORIAL_10_FP64 = vec2(2.755731998149713e-07, -7.575112367869873e-15);

float nint(float d) {
    if (d == floor(d)) return d;
    return floor(d + 0.5);
}

vec2 nint_fp64(vec2 a) {
    float hi = nint(a.x);
    float lo;
    vec2 tmp;
    if (hi == a.x) {
        lo = nint(a.y);
        tmp = quickTwoSum(hi, lo);
    } else {
        lo = 0.0;
        if (abs(hi - a.x) == 0.5 && a.y < 0.0) {
            hi -= 1.0;
        }
        tmp = vec2(hi, lo);
    }
    return tmp;
}

vec2 exp_fp64(vec2 a) {

  const int k_power = 4;
  const float k = 16.0;

  const float inv_k = 1.0 / k;

  if (a.x <= -88.0) return vec2(0.0, 0.0);
  if (a.x >= 88.0) return vec2(1.0 / 0.0, 1.0 / 0.0);
  if (a.x == 0.0 && a.y == 0.0) return vec2(1.0, 0.0);
  if (a.x == 1.0 && a.y == 0.0) return E_FP64;

  float m = floor(a.x / LOG2_FP64.x + 0.5);
  vec2 r = sub_fp64(a, mul_fp64(LOG2_FP64, vec2(m, 0.0))) * inv_k;
  vec2 s, t, p;

  p = mul_fp64(r, r);
  s = sum_fp64(r, p * 0.5);
  p = mul_fp64(p, r);
  t = mul_fp64(p, INVERSE_FACTORIAL_3_FP64);

  s = sum_fp64(s, t);
  p = mul_fp64(p, r);
  t = mul_fp64(p, INVERSE_FACTORIAL_4_FP64);

  s = sum_fp64(s, t);
  p = mul_fp64(p, r);
  t = mul_fp64(p, INVERSE_FACTORIAL_5_FP64);






  s = sum_fp64(s, t);
  for (int i = 0; i < k_power; i++) {
    s = sum_fp64(s * 2.0, mul_fp64(s, s));
  }

#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)
  s = sum_fp64(s, vec2(ONE, 0.0));
#else
  s = sum_fp64(s, vec2(1.0, 0.0));
#endif

  return s * pow(2.0, m);
}

vec2 log_fp64(vec2 a)
{
  if (a.x == 1.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x <= 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);
  vec2 x = vec2(log(a.x), 0.0);
  vec2 s;
#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)
  s = vec2(ONE, 0.0);
#else
  s = vec2(1.0, 0.0);
#endif

  x = sub_fp64(sum_fp64(x, mul_fp64(a, exp_fp64(-x))), s);
  return x;
}

vec2 sin_taylor_fp64(vec2 a) {
  vec2 r, s, t, x;

  if (a.x == 0.0 && a.y == 0.0) {
    return vec2(0.0, 0.0);
  }

  x = -mul_fp64(a, a);
  s = a;
  r = a;

  r = mul_fp64(r, x);
  t = mul_fp64(r, INVERSE_FACTORIAL_3_FP64);
  s = sum_fp64(s, t);

  r = mul_fp64(r, x);
  t = mul_fp64(r, INVERSE_FACTORIAL_5_FP64);
  s = sum_fp64(s, t);






  return s;
}

vec2 cos_taylor_fp64(vec2 a) {
  vec2 r, s, t, x;

  if (a.x == 0.0 && a.y == 0.0) {
    return vec2(1.0, 0.0);
  }

  x = -mul_fp64(a, a);
  r = x;
  s = sum_fp64(vec2(1.0, 0.0), r * 0.5);

  r = mul_fp64(r, x);
  t = mul_fp64(r, INVERSE_FACTORIAL_4_FP64);
  s = sum_fp64(s, t);

  r = mul_fp64(r, x);
  t = mul_fp64(r, INVERSE_FACTORIAL_6_FP64);
  s = sum_fp64(s, t);






  return s;
}

void sincos_taylor_fp64(vec2 a, out vec2 sin_t, out vec2 cos_t) {
  if (a.x == 0.0 && a.y == 0.0) {
    sin_t = vec2(0.0, 0.0);
    cos_t = vec2(1.0, 0.0);
  }

  sin_t = sin_taylor_fp64(a);
  cos_t = sqrt_fp64(sub_fp64(vec2(1.0, 0.0), mul_fp64(sin_t, sin_t)));
}

vec2 sin_fp64(vec2 a) {
    if (a.x == 0.0 && a.y == 0.0) {
        return vec2(0.0, 0.0);
    }
    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));
    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));

    vec2 t;
    float q = floor(r.x / PI_2_FP64.x + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return vec2(0.0 / 0.0, 0.0 / 0.0);
    }

    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));

    q = floor(t.x / PI_16_FP64.x + 0.5);
    int k = int(q);

    if (k == 0) {
        if (j == 0) {
            return sin_taylor_fp64(t);
        } else if (j == 1) {
            return cos_taylor_fp64(t);
        } else if (j == -1) {
            return -cos_taylor_fp64(t);
        } else {
            return -sin_taylor_fp64(t);
        }
    }

    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return vec2(0.0 / 0.0, 0.0 / 0.0);
    } else {
        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));
    }

    vec2 u = vec2(0.0, 0.0);
    vec2 v = vec2(0.0, 0.0);

#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)
    if (abs(float(abs_k) - 1.0) < 0.5) {
        u = COS_TABLE_0_FP64;
        v = SIN_TABLE_0_FP64;
    } else if (abs(float(abs_k) - 2.0) < 0.5) {
        u = COS_TABLE_1_FP64;
        v = SIN_TABLE_1_FP64;
    } else if (abs(float(abs_k) - 3.0) < 0.5) {
        u = COS_TABLE_2_FP64;
        v = SIN_TABLE_2_FP64;
    } else if (abs(float(abs_k) - 4.0) < 0.5) {
        u = COS_TABLE_3_FP64;
        v = SIN_TABLE_3_FP64;
    }
#else
    if (abs_k == 1) {
        u = COS_TABLE_0_FP64;
        v = SIN_TABLE_0_FP64;
    } else if (abs_k == 2) {
        u = COS_TABLE_1_FP64;
        v = SIN_TABLE_1_FP64;
    } else if (abs_k == 3) {
        u = COS_TABLE_2_FP64;
        v = SIN_TABLE_2_FP64;
    } else if (abs_k == 4) {
        u = COS_TABLE_3_FP64;
        v = SIN_TABLE_3_FP64;
    }
#endif

    vec2 sin_t, cos_t;
    sincos_taylor_fp64(t, sin_t, cos_t);



    vec2 result = vec2(0.0, 0.0);
    if (j == 0) {
        if (k > 0) {
            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));
        } else {
            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));
        }
    } else if (j == 1) {
        if (k > 0) {
            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));
        } else {
            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));
        }
    } else if (j == -1) {
        if (k > 0) {
            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));
        } else {
            result = -sum_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));
        }
    } else {
        if (k > 0) {
            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));
        } else {
            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));
        }
    }

    return result;
}

vec2 cos_fp64(vec2 a) {
    if (a.x == 0.0 && a.y == 0.0) {
        return vec2(1.0, 0.0);
    }
    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));
    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));

    vec2 t;
    float q = floor(r.x / PI_2_FP64.x + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return vec2(0.0 / 0.0, 0.0 / 0.0);
    }

    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));

    q = floor(t.x / PI_16_FP64.x + 0.5);
    int k = int(q);

    if (k == 0) {
        if (j == 0) {
            return cos_taylor_fp64(t);
        } else if (j == 1) {
            return -sin_taylor_fp64(t);
        } else if (j == -1) {
            return sin_taylor_fp64(t);
        } else {
            return -cos_taylor_fp64(t);
        }
    }

    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return vec2(0.0 / 0.0, 0.0 / 0.0);
    } else {
        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));
    }

    vec2 u = vec2(0.0, 0.0);
    vec2 v = vec2(0.0, 0.0);

#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)
    if (abs(float(abs_k) - 1.0) < 0.5) {
        u = COS_TABLE_0_FP64;
        v = SIN_TABLE_0_FP64;
    } else if (abs(float(abs_k) - 2.0) < 0.5) {
        u = COS_TABLE_1_FP64;
        v = SIN_TABLE_1_FP64;
    } else if (abs(float(abs_k) - 3.0) < 0.5) {
        u = COS_TABLE_2_FP64;
        v = SIN_TABLE_2_FP64;
    } else if (abs(float(abs_k) - 4.0) < 0.5) {
        u = COS_TABLE_3_FP64;
        v = SIN_TABLE_3_FP64;
    }
#else
    if (abs_k == 1) {
        u = COS_TABLE_0_FP64;
        v = SIN_TABLE_0_FP64;
    } else if (abs_k == 2) {
        u = COS_TABLE_1_FP64;
        v = SIN_TABLE_1_FP64;
    } else if (abs_k == 3) {
        u = COS_TABLE_2_FP64;
        v = SIN_TABLE_2_FP64;
    } else if (abs_k == 4) {
        u = COS_TABLE_3_FP64;
        v = SIN_TABLE_3_FP64;
    }
#endif

    vec2 sin_t, cos_t;
    sincos_taylor_fp64(t, sin_t, cos_t);

    vec2 result = vec2(0.0, 0.0);
    if (j == 0) {
        if (k > 0) {
            result = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));
        } else {
            result = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));
        }
    } else if (j == 1) {
        if (k > 0) {
            result = -sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));
        } else {
            result = sub_fp64(mul_fp64(v, cos_t), mul_fp64(u, sin_t));
        }
    } else if (j == -1) {
        if (k > 0) {
            result = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));
        } else {
            result = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));
        }
    } else {
        if (k > 0) {
            result = sub_fp64(mul_fp64(v, sin_t), mul_fp64(u, cos_t));
        } else {
            result = -sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));
        }
    }

    return result;
}

vec2 tan_fp64(vec2 a) {
    vec2 sin_a;
    vec2 cos_a;

    if (a.x == 0.0 && a.y == 0.0) {
        return vec2(0.0, 0.0);
    }
    vec2 z = nint_fp64(div_fp64(a, TWO_PI_FP64));
    vec2 r = sub_fp64(a, mul_fp64(TWO_PI_FP64, z));

    vec2 t;
    float q = floor(r.x / PI_2_FP64.x + 0.5);
    int j = int(q);


    if (j < -2 || j > 2) {
        return vec2(0.0 / 0.0, 0.0 / 0.0);
    }

    t = sub_fp64(r, mul_fp64(PI_2_FP64, vec2(q, 0.0)));

    q = floor(t.x / PI_16_FP64.x + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return vec2(0.0 / 0.0, 0.0 / 0.0);
    } else {
        t = sub_fp64(t, mul_fp64(PI_16_FP64, vec2(q, 0.0)));
    }


    vec2 u = vec2(0.0, 0.0);
    vec2 v = vec2(0.0, 0.0);

    vec2 sin_t, cos_t;
    vec2 s, c;
    sincos_taylor_fp64(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
#if defined(NVIDIA_FP64_WORKAROUND) || defined(INTEL_FP64_WORKAROUND)
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0_FP64;
            v = SIN_TABLE_0_FP64;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1_FP64;
            v = SIN_TABLE_1_FP64;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2_FP64;
            v = SIN_TABLE_2_FP64;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3_FP64;
            v = SIN_TABLE_3_FP64;
        }
#else
        if (abs_k == 1) {
            u = COS_TABLE_0_FP64;
            v = SIN_TABLE_0_FP64;
        } else if (abs_k == 2) {
            u = COS_TABLE_1_FP64;
            v = SIN_TABLE_1_FP64;
        } else if (abs_k == 3) {
            u = COS_TABLE_2_FP64;
            v = SIN_TABLE_2_FP64;
        } else if (abs_k == 4) {
            u = COS_TABLE_3_FP64;
            v = SIN_TABLE_3_FP64;
        }
#endif
        if (k > 0) {
            s = sum_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));
            c = sub_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));
        } else {
            s = sub_fp64(mul_fp64(u, sin_t), mul_fp64(v, cos_t));
            c = sum_fp64(mul_fp64(u, cos_t), mul_fp64(v, sin_t));
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return div_fp64(sin_a, cos_a);
}

vec2 radians_fp64(vec2 degree) {
  return mul_fp64(degree, PI_180_FP64);
}

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void vec2_sum_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {
    out_val[0] = sum_fp64(a[0], b[0]);
    out_val[1] = sum_fp64(a[1], b[1]);
}

void vec2_sub_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {
    out_val[0] = sub_fp64(a[0], b[0]);
    out_val[1] = sub_fp64(a[1], b[1]);
}

void vec2_mul_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {
    out_val[0] = mul_fp64(a[0], b[0]);
    out_val[1] = mul_fp64(a[1], b[1]);
}

void vec2_div_fp64(vec2 a[2], vec2 b[2], out vec2 out_val[2]) {
    out_val[0] = div_fp64(a[0], b[0]);
    out_val[1] = div_fp64(a[1], b[1]);
}

void vec2_mix_fp64(vec2 x[2], vec2 y[2], float a, out vec2 out_val[2]) {
  vec2 range[2];
  vec2_sub_fp64(y, x, range);
  vec2 portion[2];
  portion[0] = range[0] * a;
  portion[1] = range[1] * a;
  vec2_sum_fp64(x, portion, out_val);
}

vec2 vec2_length_fp64(vec2 x[2]) {
  return sqrt_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])));
}

void vec2_normalize_fp64(vec2 x[2], out vec2 out_val[2]) {
  vec2 length = vec2_length_fp64(x);
  vec2 length_vec2[2];
  length_vec2[0] = length;
  length_vec2[1] = length;

  vec2_div_fp64(x, length_vec2, out_val);
}

vec2 vec2_distance_fp64(vec2 x[2], vec2 y[2]) {
  vec2 diff[2];
  vec2_sub_fp64(x, y, diff);
  return vec2_length_fp64(diff);
}

vec2 vec2_dot_fp64(vec2 a[2], vec2 b[2]) {
  vec2 v[2];

  v[0] = mul_fp64(a[0], b[0]);
  v[1] = mul_fp64(a[1], b[1]);

  return sum_fp64(v[0], v[1]);
}
void vec3_sub_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {
  for (int i = 0; i < 3; i++) {
    out_val[i] = sum_fp64(a[i], b[i]);
  }
}

void vec3_sum_fp64(vec2 a[3], vec2 b[3], out vec2 out_val[3]) {
  for (int i = 0; i < 3; i++) {
    out_val[i] = sum_fp64(a[i], b[i]);
  }
}

vec2 vec3_length_fp64(vec2 x[3]) {
  return sqrt_fp64(sum_fp64(sum_fp64(mul_fp64(x[0], x[0]), mul_fp64(x[1], x[1])),
    mul_fp64(x[2], x[2])));
}

vec2 vec3_distance_fp64(vec2 x[3], vec2 y[3]) {
  vec2 diff[3];
  vec3_sub_fp64(x, y, diff);
  return vec3_length_fp64(diff);
}
void vec4_fp64(vec4 a, out vec2 out_val[4]) {
  out_val[0].x = a[0];
  out_val[0].y = 0.0;

  out_val[1].x = a[1];
  out_val[1].y = 0.0;

  out_val[2].x = a[2];
  out_val[2].y = 0.0;

  out_val[3].x = a[3];
  out_val[3].y = 0.0;
}

void vec4_scalar_mul_fp64(vec2 a[4], vec2 b, out vec2 out_val[4]) {
  out_val[0] = mul_fp64(a[0], b);
  out_val[1] = mul_fp64(a[1], b);
  out_val[2] = mul_fp64(a[2], b);
  out_val[3] = mul_fp64(a[3], b);
}

void vec4_sum_fp64(vec2 a[4], vec2 b[4], out vec2 out_val[4]) {
  for (int i = 0; i < 4; i++) {
    out_val[i] = sum_fp64(a[i], b[i]);
  }
}

void vec4_dot_fp64(vec2 a[4], vec2 b[4], out vec2 out_val) {
  vec2 v[4];

  v[0] = mul_fp64(a[0], b[0]);
  v[1] = mul_fp64(a[1], b[1]);
  v[2] = mul_fp64(a[2], b[2]);
  v[3] = mul_fp64(a[3], b[3]);

  out_val = sum_fp64(sum_fp64(v[0], v[1]), sum_fp64(v[2], v[3]));
}

void mat4_vec4_mul_fp64(vec2 b[16], vec2 a[4], out vec2 out_val[4]) {
  vec2 tmp[4];

  for (int i = 0; i < 4; i++)
  {
    for (int j = 0; j < 4; j++)
    {
      tmp[j] = b[j + i * 4];
    }
    vec4_dot_fp64(a, tmp, out_val[i]);
  }
}
`,Rxe={ONE:1};function Lxe(){return Rxe}const Dxe={name:"fp64-arithmetic",vs:Mxe,fs:null,getUniforms:Lxe,fp64ify:C5,fp64LowPart:Dte,fp64ifyMatrix4:Bte},Bxe={name:"fp64",vs:Oxe,fs:null,dependencies:[Dxe],fp64ify:C5,fp64LowPart:Dte,fp64ifyMatrix4:Bte};function ac(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}const Nxe=1/Math.PI*180,Fxe=1/180*Math.PI,fo={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function kxe(t){for(const e in t)ac(e in fo),fo[e]=t[e];return fo}function P5(t,{precision:e=fo.precision}={}){return t=qxe(t),"".concat(parseFloat(t.toPrecision(e)))}function wh(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function zxe(t){return"clone"in t?t.clone():t.slice()}function Nte(t){return nv(t)}function Fte(t){return bl(t)}function nv(t,e){return Sg(t,n=>n*Fxe,e)}function bl(t,e){return Sg(t,n=>n*Nxe,e)}function Uxe(t,e){return Sg(t,n=>Math.sin(n),e)}function Gxe(t,e){return Sg(t,n=>Math.cos(n),e)}function jxe(t,e){return Sg(t,n=>Math.tan(n),e)}function Vxe(t,e){return Sg(t,n=>Math.asin(n),e)}function $xe(t,e){return Sg(t,n=>Math.acos(n),e)}function Hxe(t,e){return Sg(t,n=>Math.atan(n),e)}function Wi(t,e,n){return Sg(t,r=>Math.max(e,Math.min(n,r)))}function pc(t,e,n){return wh(t)?t.map((r,i)=>pc(r,e[i],n)):n*e+(1-n)*t}function Sl(t,e,n){const r=fo.EPSILON;n&&(fo.EPSILON=n);try{if(t===e)return!0;if(wh(t)&&wh(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!Sl(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=fo.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{fo.EPSILON=r}}function kte(t,e){if(t===e)return!0;if(t&&typeof t=="object"&&e&&typeof e=="object"){if(t.constructor!==e.constructor)return!1;if(t.exactEquals)return t.exactEquals(e)}if(wh(t)&&wh(e)){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!kte(t[n],e[n]))return!1;return!0}return!1}function Wxe(t,e){const n=fo.EPSILON;fo.EPSILON=t;let r;try{r=e()}finally{fo.EPSILON=n}return r}function qxe(t){return Math.round(t/fo.EPSILON)*fo.EPSILON}function Xxe(t){return t.clone?t.clone():new Array(t.length)}function Sg(t,e,n){if(wh(t)){const r=t;n=n||Xxe(r);for(let i=0;i<n.length&&i<r.length;++i)n[i]=e(t[i],i,n);return n}return e(t)}function Zxe(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class GO extends Zxe(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+n];return this.check()}toArray(e=[],n=0){for(let r=0;r<this.ELEMENTS;++r)e[n+r]=this[r];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:wh(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(fo)}formatString(e){let n="";for(let r=0;r<this.ELEMENTS;++r)n+=(r>0?", ":"")+P5(this[r],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!Sl(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,r){if(r===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const o=e[i];this[i]=o+r*(n[i]-o)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),n[r]);return this.check()}add(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=n[r];return this.check()}subtract(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=n[r];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(fo.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),n);return this.check()}get elements(){return this}}function Yxe(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function Ur(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function gw(t,e,n=""){if(fo.debug&&!Yxe(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}class I5 extends GO{get x(){return this[0]}set x(e){this[0]=Ur(e)}get y(){return this[1]}set y(e){this[1]=Ur(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let n=0;n<this.ELEMENTS;++n)e+=this[n]*this[n];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let n=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];n+=i*i}return Ur(n)}dot(e){let n=0;for(let r=0;r<this.ELEMENTS;++r)n+=this[r]*e[r];return Ur(n)}normalize(){const e=this.magnitude();if(e!==0)for(let n=0;n<this.ELEMENTS;++n)this[n]/=e;return this.check()}multiply(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=n[r];return this.check()}divide(...e){for(const n of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=n[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return ac(e>=0&&e<this.ELEMENTS,"index is out of range"),Ur(this[e])}setComponent(e,n){return ac(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=n,this.check()}addVectors(e,n){return this.copy(e).add(n)}subVectors(e,n){return this.copy(e).subtract(n)}multiplyVectors(e,n){return this.copy(e).multiply(n)}addScaledVector(e,n){return this.add(new this.constructor(e).multiplyScalar(n))}}var Es=1e-6,Eh=typeof Float32Array<"u"?Float32Array:Array;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function Qxe(){var t=new Eh(2);return Eh!=Float32Array&&(t[0]=0,t[1]=0),t}function F0(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Kxe(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Jxe(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function ebe(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function M5(t,e){return t[0]=-e[0],t[1]=-e[1],t}function zte(t,e,n,r){var i=e[0],o=e[1];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t}function tbe(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function nbe(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function Ute(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function Gte(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var rbe=Kxe;(function(){var t=Qxe();return function(e,n,r,i,o,a){var s,u;for(n||(n=2),r||(r=0),i?u=Math.min(i*n+r,e.length):u=e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],o(t,t,a),e[s]=t[0],e[s+1]=t[1];return e}})();function jte(t,e,n){const r=e[0],i=e[1],o=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/o,t[1]=(n[1]*r+n[5]*i)/o,t}function Vte(t,e,n){const r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o||1;return t[0]=(n[0]*r+n[4]*i+n[8]*o)/a,t[1]=(n[1]*r+n[5]*i+n[9]*o)/a,t[2]=(n[2]*r+n[6]*i+n[10]*o)/a,t}function ibe(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}function obe(t,e,n){const r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t[3]=e[3],t}function $te(t,e,n){const r=e[0],i=e[1],o=e[2];return t[0]=n[0]*r+n[3]*i+n[6]*o,t[1]=n[1]*r+n[4]*i+n[7]*o,t[2]=n[2]*r+n[5]*i+n[8]*o,t[3]=e[3],t}class jO extends I5{constructor(e=0,n=0){super(2),wh(e)&&arguments.length===1?this.copy(e):(fo.debug&&(Ur(e),Ur(n)),this[0]=e,this[1]=n)}set(e,n){return this[0]=e,this[1]=n,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this.check()}fromObject(e){return fo.debug&&(Ur(e.x),Ur(e.y)),this[0]=e.x,this[1]=e.y,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Gte(this,this,e),this.check()}transformAsVector(e){return jte(this,this,e),this.check()}transformByMatrix3(e){return Ute(this,this,e),this.check()}transformByMatrix2x3(e){return nbe(this,this,e),this.check()}transformByMatrix2(e){return tbe(this,this,e),this.check()}}function Hte(){var t=new Eh(3);return Eh!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function O5(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function S$(t,e,n){var r=new Eh(3);return r[0]=t,r[1]=e,r[2]=n,r}function sbe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function abe(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function lbe(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function ube(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function cbe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function fbe(t,e){var n=e[0],r=e[1],i=e[2],o=n*n+r*r+i*i;return o>0&&(o=1/Math.sqrt(o)),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t}function R5(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function cC(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2];return t[0]=i*u-o*s,t[1]=o*a-r*u,t[2]=r*s-i*a,t}function hbe(t,e,n,r){var i=e[0],o=e[1],a=e[2];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t}function L5(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[3]*r+n[7]*i+n[11]*o+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*i+n[8]*o+n[12])/a,t[1]=(n[1]*r+n[5]*i+n[9]*o+n[13])/a,t[2]=(n[2]*r+n[6]*i+n[10]*o+n[14])/a,t}function Wte(t,e,n){var r=e[0],i=e[1],o=e[2];return t[0]=r*n[0]+i*n[3]+o*n[6],t[1]=r*n[1]+i*n[4]+o*n[7],t[2]=r*n[2]+i*n[5]+o*n[8],t}function qte(t,e,n){var r=n[0],i=n[1],o=n[2],a=n[3],s=e[0],u=e[1],d=e[2],g=i*d-o*u,_=o*s-r*d,E=r*u-i*s,P=i*E-o*_,O=o*g-r*E,D=r*_-i*g,V=a*2;return g*=V,_*=V,E*=V,P*=2,O*=2,D*=2,t[0]=s+g+P,t[1]=u+_+O,t[2]=d+E+D,t}function dbe(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0],o[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),o[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function pbe(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),o[1]=i[1],o[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function gbe(t,e,n,r){var i=[],o=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],o[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),o[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),o[2]=i[2],t[0]=o[0]+n[0],t[1]=o[1]+n[1],t[2]=o[2]+n[2],t}function mbe(t,e){var n=t[0],r=t[1],i=t[2],o=e[0],a=e[1],s=e[2],u=Math.sqrt(n*n+r*r+i*i),d=Math.sqrt(o*o+a*a+s*s),g=u*d,_=g&&R5(t,e)/g;return Math.acos(Math.min(Math.max(_,-1),1))}var Xte=abe,Abe=lbe,Zte=O5,QD=ube;(function(){var t=Hte();return function(e,n,r,i,o,a){var s,u;for(n||(n=3),r||(r=0),i?u=Math.min(i*n+r,e.length):u=e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}})();const KD=[0,0,0];let LS;class _t extends I5{static get ZERO(){return LS||(LS=new _t(0,0,0),Object.freeze(LS)),LS}constructor(e=0,n=0,r=0){super(-0,-0,-0),arguments.length===1&&wh(e)?this.copy(e):(fo.debug&&(Ur(e),Ur(n),Ur(r)),this[0]=e,this[1]=n,this[2]=r)}set(e,n,r){return this[0]=e,this[1]=n,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return fo.debug&&(Ur(e.x),Ur(e.y),Ur(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=Ur(e)}angle(e){return mbe(this,e)}cross(e){return cC(this,this,e),this.check()}rotateX({radians:e,origin:n=KD}){return dbe(this,this,n,e),this.check()}rotateY({radians:e,origin:n=KD}){return pbe(this,this,n,e),this.check()}rotateZ({radians:e,origin:n=KD}){return gbe(this,this,n,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return L5(this,this,e),this.check()}transformAsVector(e){return Vte(this,this,e),this.check()}transformByMatrix3(e){return Wte(this,this,e),this.check()}transformByMatrix2(e){return ibe(this,this,e),this.check()}transformByQuaternion(e){return qte(this,this,e),this.check()}}let DS;class VO extends I5{static get ZERO(){return DS||(DS=new VO(0,0,0,0),Object.freeze(DS)),DS}constructor(e=0,n=0,r=0,i=0){super(-0,-0,-0,-0),wh(e)&&arguments.length===1?this.copy(e):(fo.debug&&(Ur(e),Ur(n),Ur(r),Ur(i)),this[0]=e,this[1]=n,this[2]=r,this[3]=i)}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}fromObject(e){return fo.debug&&(Ur(e.x),Ur(e.y),Ur(e.z),Ur(e.w)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e.w=this[3],e}get ELEMENTS(){return 4}get z(){return this[2]}set z(e){this[2]=Ur(e)}get w(){return this[3]}set w(e){this[3]=Ur(e)}transform(e){return L5(this,this,e),this.check()}transformByMatrix3(e){return $te(this,this,e),this.check()}transformByMatrix2(e){return obe(this,this,e),this.check()}transformByQuaternion(e){return qte(this,this,e),this.check()}applyMatrix4(e){return e.transform(this,this),this}}class Yte extends GO{toString(){let e="[";if(fo.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let r=0;r<this.RANK;++r)e+=" ".concat(this[r*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,r){return this[n*this.RANK+e]=Ur(r),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[r+i];return n}setColumn(e,n){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=n[i];return this}}function _be(){var t=new Eh(9);return Eh!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function ybe(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function vbe(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],d=e[7],g=e[8],_=g*a-s*d,E=-g*o+s*u,P=d*o-a*u,O=n*_+r*E+i*P;return O?(O=1/O,t[0]=_*O,t[1]=(-g*r+i*d)*O,t[2]=(s*r-i*a)*O,t[3]=E*O,t[4]=(g*n-i*u)*O,t[5]=(-s*n+i*o)*O,t[6]=P*O,t[7]=(-d*n+r*u)*O,t[8]=(a*n-r*o)*O,t):null}function xbe(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],d=t[8];return e*(d*o-a*u)+n*(-d*i+a*s)+r*(u*i-o*s)}function T$(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],d=e[6],g=e[7],_=e[8],E=n[0],P=n[1],O=n[2],D=n[3],V=n[4],k=n[5],F=n[6],z=n[7],X=n[8];return t[0]=E*r+P*a+O*d,t[1]=E*i+P*s+O*g,t[2]=E*o+P*u+O*_,t[3]=D*r+V*a+k*d,t[4]=D*i+V*s+k*g,t[5]=D*o+V*u+k*_,t[6]=F*r+z*a+X*d,t[7]=F*i+z*s+X*g,t[8]=F*o+z*u+X*_,t}function bbe(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],d=e[6],g=e[7],_=e[8],E=n[0],P=n[1];return t[0]=r,t[1]=i,t[2]=o,t[3]=a,t[4]=s,t[5]=u,t[6]=E*r+P*a+d,t[7]=E*i+P*s+g,t[8]=E*o+P*u+_,t}function wbe(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],d=e[6],g=e[7],_=e[8],E=Math.sin(n),P=Math.cos(n);return t[0]=P*r+E*a,t[1]=P*i+E*s,t[2]=P*o+E*u,t[3]=P*a-E*r,t[4]=P*s-E*i,t[5]=P*u-E*o,t[6]=d,t[7]=g,t[8]=_,t}function C$(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Ebe(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,d=n*a,g=r*a,_=r*s,E=i*a,P=i*s,O=i*u,D=o*a,V=o*s,k=o*u;return t[0]=1-_-O,t[3]=g-k,t[6]=E+V,t[1]=g+k,t[4]=1-d-O,t[7]=P-D,t[2]=E-V,t[5]=P+D,t[8]=1-d-_,t}var VF;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(VF||(VF={}));const Sbe=Object.freeze([1,0,0,0,1,0,0,0,1]);class is extends Yte{static get IDENTITY(){return Cbe()}static get ZERO(){return Tbe()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return VF}constructor(e,...n){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):n.length>0?this.copy([e,...n]):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this.check()}identity(){return this.copy(Sbe)}fromObject(e){return this.check()}fromQuaternion(e){return Ebe(this,e),this.check()}set(e,n,r,i,o,a,s,u,d){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=o,this[5]=a,this[6]=s,this[7]=u,this[8]=d,this.check()}setRowMajor(e,n,r,i,o,a,s,u,d){return this[0]=e,this[1]=i,this[2]=s,this[3]=n,this[4]=o,this[5]=u,this[6]=r,this[7]=a,this[8]=d,this.check()}determinant(){return xbe(this)}transpose(){return ybe(this,this),this.check()}invert(){return vbe(this,this),this.check()}multiplyLeft(e){return T$(this,e,this),this.check()}multiplyRight(e){return T$(this,this,e),this.check()}rotate(e){return wbe(this,this,e),this.check()}scale(e){return Array.isArray(e)?C$(this,this,e):C$(this,this,[e,e]),this.check()}translate(e){return bbe(this,this,e),this.check()}transform(e,n){let r;switch(e.length){case 2:r=Ute(n||[-0,-0],e,this);break;case 3:r=Wte(n||[-0,-0,-0],e,this);break;case 4:r=$te(n||[-0,-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return gw(r,e.length),r}transformVector(e,n){return this.transform(e,n)}transformVector2(e,n){return this.transform(e,n)}transformVector3(e,n){return this.transform(e,n)}}let BS,NS;function Tbe(){return BS||(BS=new is([0,0,0,0,0,0,0,0,0]),Object.freeze(BS)),BS}function Cbe(){return NS||(NS=new is,Object.freeze(NS)),NS}function Pbe(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Ibe(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],o=e[6],a=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=o,t[11]=e[14],t[12]=i,t[13]=a,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function aI(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=e[4],s=e[5],u=e[6],d=e[7],g=e[8],_=e[9],E=e[10],P=e[11],O=e[12],D=e[13],V=e[14],k=e[15],F=n*s-r*a,z=n*u-i*a,X=n*d-o*a,Y=r*u-i*s,J=r*d-o*s,re=i*d-o*u,ue=g*D-_*O,ie=g*V-E*O,ce=g*k-P*O,se=_*V-E*D,me=_*k-P*D,Ce=E*k-P*V,we=F*Ce-z*me+X*se+Y*ce-J*ie+re*ue;return we?(we=1/we,t[0]=(s*Ce-u*me+d*se)*we,t[1]=(i*me-r*Ce-o*se)*we,t[2]=(D*re-V*J+k*Y)*we,t[3]=(E*J-_*re-P*Y)*we,t[4]=(u*ce-a*Ce-d*ie)*we,t[5]=(n*Ce-i*ce+o*ie)*we,t[6]=(V*X-O*re-k*z)*we,t[7]=(g*re-E*X+P*z)*we,t[8]=(a*me-s*ce+d*ue)*we,t[9]=(r*ce-n*me-o*ue)*we,t[10]=(O*J-D*X+k*F)*we,t[11]=(_*X-g*J-P*F)*we,t[12]=(s*ie-a*se-u*ue)*we,t[13]=(n*se-r*ie+i*ue)*we,t[14]=(D*z-O*Y-V*F)*we,t[15]=(g*Y-_*z+E*F)*we,t):null}function Mbe(t){var e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],d=t[8],g=t[9],_=t[10],E=t[11],P=t[12],O=t[13],D=t[14],V=t[15],k=e*a-n*o,F=e*s-r*o,z=e*u-i*o,X=n*s-r*a,Y=n*u-i*a,J=r*u-i*s,re=d*O-g*P,ue=d*D-_*P,ie=d*V-E*P,ce=g*D-_*O,se=g*V-E*O,me=_*V-E*D;return k*me-F*se+z*ce+X*ie-Y*ue+J*re}function kd(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=e[4],u=e[5],d=e[6],g=e[7],_=e[8],E=e[9],P=e[10],O=e[11],D=e[12],V=e[13],k=e[14],F=e[15],z=n[0],X=n[1],Y=n[2],J=n[3];return t[0]=z*r+X*s+Y*_+J*D,t[1]=z*i+X*u+Y*E+J*V,t[2]=z*o+X*d+Y*P+J*k,t[3]=z*a+X*g+Y*O+J*F,z=n[4],X=n[5],Y=n[6],J=n[7],t[4]=z*r+X*s+Y*_+J*D,t[5]=z*i+X*u+Y*E+J*V,t[6]=z*o+X*d+Y*P+J*k,t[7]=z*a+X*g+Y*O+J*F,z=n[8],X=n[9],Y=n[10],J=n[11],t[8]=z*r+X*s+Y*_+J*D,t[9]=z*i+X*u+Y*E+J*V,t[10]=z*o+X*d+Y*P+J*k,t[11]=z*a+X*g+Y*O+J*F,z=n[12],X=n[13],Y=n[14],J=n[15],t[12]=z*r+X*s+Y*_+J*D,t[13]=z*i+X*u+Y*E+J*V,t[14]=z*o+X*d+Y*P+J*k,t[15]=z*a+X*g+Y*O+J*F,t}function $w(t,e,n){var r=n[0],i=n[1],o=n[2],a,s,u,d,g,_,E,P,O,D,V,k;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*o+e[12],t[13]=e[1]*r+e[5]*i+e[9]*o+e[13],t[14]=e[2]*r+e[6]*i+e[10]*o+e[14],t[15]=e[3]*r+e[7]*i+e[11]*o+e[15]):(a=e[0],s=e[1],u=e[2],d=e[3],g=e[4],_=e[5],E=e[6],P=e[7],O=e[8],D=e[9],V=e[10],k=e[11],t[0]=a,t[1]=s,t[2]=u,t[3]=d,t[4]=g,t[5]=_,t[6]=E,t[7]=P,t[8]=O,t[9]=D,t[10]=V,t[11]=k,t[12]=a*r+g*i+O*o+e[12],t[13]=s*r+_*i+D*o+e[13],t[14]=u*r+E*i+V*o+e[14],t[15]=d*r+P*i+k*o+e[15]),t}function $O(t,e,n){var r=n[0],i=n[1],o=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Obe(t,e,n,r){var i=r[0],o=r[1],a=r[2],s=Math.hypot(i,o,a),u,d,g,_,E,P,O,D,V,k,F,z,X,Y,J,re,ue,ie,ce,se,me,Ce,we,Ye;return s<Es?null:(s=1/s,i*=s,o*=s,a*=s,u=Math.sin(n),d=Math.cos(n),g=1-d,_=e[0],E=e[1],P=e[2],O=e[3],D=e[4],V=e[5],k=e[6],F=e[7],z=e[8],X=e[9],Y=e[10],J=e[11],re=i*i*g+d,ue=o*i*g+a*u,ie=a*i*g-o*u,ce=i*o*g-a*u,se=o*o*g+d,me=a*o*g+i*u,Ce=i*a*g+o*u,we=o*a*g-i*u,Ye=a*a*g+d,t[0]=_*re+D*ue+z*ie,t[1]=E*re+V*ue+X*ie,t[2]=P*re+k*ue+Y*ie,t[3]=O*re+F*ue+J*ie,t[4]=_*ce+D*se+z*me,t[5]=E*ce+V*se+X*me,t[6]=P*ce+k*se+Y*me,t[7]=O*ce+F*se+J*me,t[8]=_*Ce+D*we+z*Ye,t[9]=E*Ce+V*we+X*Ye,t[10]=P*Ce+k*we+Y*Ye,t[11]=O*Ce+F*we+J*Ye,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Qte(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[4],a=e[5],s=e[6],u=e[7],d=e[8],g=e[9],_=e[10],E=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+d*r,t[5]=a*i+g*r,t[6]=s*i+_*r,t[7]=u*i+E*r,t[8]=d*i-o*r,t[9]=g*i-a*r,t[10]=_*i-s*r,t[11]=E*i-u*r,t}function Rbe(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],d=e[8],g=e[9],_=e[10],E=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-d*r,t[1]=a*i-g*r,t[2]=s*i-_*r,t[3]=u*i-E*r,t[8]=o*r+d*i,t[9]=a*r+g*i,t[10]=s*r+_*i,t[11]=u*r+E*i,t}function Kte(t,e,n){var r=Math.sin(n),i=Math.cos(n),o=e[0],a=e[1],s=e[2],u=e[3],d=e[4],g=e[5],_=e[6],E=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+d*r,t[1]=a*i+g*r,t[2]=s*i+_*r,t[3]=u*i+E*r,t[4]=d*i-o*r,t[5]=g*i-a*r,t[6]=_*i-s*r,t[7]=E*i-u*r,t}function Lbe(t,e){var n=e[0],r=e[1],i=e[2],o=e[4],a=e[5],s=e[6],u=e[8],d=e[9],g=e[10];return t[0]=Math.hypot(n,r,i),t[1]=Math.hypot(o,a,s),t[2]=Math.hypot(u,d,g),t}function Dbe(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n+n,s=r+r,u=i+i,d=n*a,g=r*a,_=r*s,E=i*a,P=i*s,O=i*u,D=o*a,V=o*s,k=o*u;return t[0]=1-_-O,t[1]=g+k,t[2]=E-V,t[3]=0,t[4]=g-k,t[5]=1-d-O,t[6]=P+D,t[7]=0,t[8]=E+V,t[9]=P-D,t[10]=1-d-_,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Bbe(t,e,n,r,i,o,a){var s=1/(n-e),u=1/(i-r),d=1/(o-a);return t[0]=o*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o*2*u,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+r)*u,t[10]=(a+o)*d,t[11]=-1,t[12]=0,t[13]=0,t[14]=a*o*2*d,t[15]=0,t}function Nbe(t,e,n,r,i){var o=1/Math.tan(e/2),a;return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(a=1/(r-i),t[10]=(i+r)*a,t[14]=2*i*r*a):(t[10]=-1,t[14]=-2*r),t}var Jte=Nbe;function Fbe(t,e,n,r,i,o,a){var s=1/(e-n),u=1/(r-i),d=1/(o-a);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*d,t[11]=0,t[12]=(e+n)*s,t[13]=(i+r)*u,t[14]=(a+o)*d,t[15]=1,t}var kbe=Fbe;function zbe(t,e,n,r){var i,o,a,s,u,d,g,_,E,P,O=e[0],D=e[1],V=e[2],k=r[0],F=r[1],z=r[2],X=n[0],Y=n[1],J=n[2];return Math.abs(O-X)<Es&&Math.abs(D-Y)<Es&&Math.abs(V-J)<Es?Pbe(t):(g=O-X,_=D-Y,E=V-J,P=1/Math.hypot(g,_,E),g*=P,_*=P,E*=P,i=F*E-z*_,o=z*g-k*E,a=k*_-F*g,P=Math.hypot(i,o,a),P?(P=1/P,i*=P,o*=P,a*=P):(i=0,o=0,a=0),s=_*a-E*o,u=E*i-g*a,d=g*o-_*i,P=Math.hypot(s,u,d),P?(P=1/P,s*=P,u*=P,d*=P):(s=0,u=0,d=0),t[0]=i,t[1]=s,t[2]=g,t[3]=0,t[4]=o,t[5]=u,t[6]=_,t[7]=0,t[8]=a,t[9]=d,t[10]=E,t[11]=0,t[12]=-(i*O+o*D+a*V),t[13]=-(s*O+u*D+d*V),t[14]=-(g*O+_*D+E*V),t[15]=1,t)}function P$(t,e){var n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],d=t[7],g=t[8],_=t[9],E=t[10],P=t[11],O=t[12],D=t[13],V=t[14],k=t[15],F=e[0],z=e[1],X=e[2],Y=e[3],J=e[4],re=e[5],ue=e[6],ie=e[7],ce=e[8],se=e[9],me=e[10],Ce=e[11],we=e[12],Ye=e[13],at=e[14],yt=e[15];return Math.abs(n-F)<=Es*Math.max(1,Math.abs(n),Math.abs(F))&&Math.abs(r-z)<=Es*Math.max(1,Math.abs(r),Math.abs(z))&&Math.abs(i-X)<=Es*Math.max(1,Math.abs(i),Math.abs(X))&&Math.abs(o-Y)<=Es*Math.max(1,Math.abs(o),Math.abs(Y))&&Math.abs(a-J)<=Es*Math.max(1,Math.abs(a),Math.abs(J))&&Math.abs(s-re)<=Es*Math.max(1,Math.abs(s),Math.abs(re))&&Math.abs(u-ue)<=Es*Math.max(1,Math.abs(u),Math.abs(ue))&&Math.abs(d-ie)<=Es*Math.max(1,Math.abs(d),Math.abs(ie))&&Math.abs(g-ce)<=Es*Math.max(1,Math.abs(g),Math.abs(ce))&&Math.abs(_-se)<=Es*Math.max(1,Math.abs(_),Math.abs(se))&&Math.abs(E-me)<=Es*Math.max(1,Math.abs(E),Math.abs(me))&&Math.abs(P-Ce)<=Es*Math.max(1,Math.abs(P),Math.abs(Ce))&&Math.abs(O-we)<=Es*Math.max(1,Math.abs(O),Math.abs(we))&&Math.abs(D-Ye)<=Es*Math.max(1,Math.abs(D),Math.abs(Ye))&&Math.abs(V-at)<=Es*Math.max(1,Math.abs(V),Math.abs(at))&&Math.abs(k-yt)<=Es*Math.max(1,Math.abs(k),Math.abs(yt))}function Ube(){var t=new Eh(4);return Eh!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Gbe(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function D5(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function jbe(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function Vbe(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function $be(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),t[0]=n*a,t[1]=r*a,t[2]=i*a,t[3]=o*a,t}function Hbe(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Wbe(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3];return t[0]=i+r*(n[0]-i),t[1]=o+r*(n[1]-o),t[2]=a+r*(n[2]-a),t[3]=s+r*(n[3]-s),t}function D1(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*o+n[12]*a,t[1]=n[1]*r+n[5]*i+n[9]*o+n[13]*a,t[2]=n[2]*r+n[6]*i+n[10]*o+n[14]*a,t[3]=n[3]*r+n[7]*i+n[11]*o+n[15]*a,t}function qbe(t,e,n){var r=e[0],i=e[1],o=e[2],a=n[0],s=n[1],u=n[2],d=n[3],g=d*r+s*o-u*i,_=d*i+u*r-a*o,E=d*o+a*i-s*r,P=-a*r-s*i-u*o;return t[0]=g*d+P*-a+_*-u-E*-s,t[1]=_*d+P*-s+E*-a-g*-u,t[2]=E*d+P*-u+g*-s-_*-a,t[3]=e[3],t}(function(){var t=Ube();return function(e,n,r,i,o,a){var s,u;for(n||(n=4),r||(r=0),i?u=Math.min(i*n+r,e.length):u=e.length,s=r;s<u;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],o(t,t,a),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}})();var $F;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})($F||($F={}));const Xbe=45*Math.PI/180,Zbe=1,JD=.1,eB=500,Ybe=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class vr extends Yte{static get IDENTITY(){return Kbe()}static get ZERO(){return Qbe()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return $F}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,r,i,o,a,s,u,d,g,_,E,P,O,D,V){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this[4]=o,this[5]=a,this[6]=s,this[7]=u,this[8]=d,this[9]=g,this[10]=_,this[11]=E,this[12]=P,this[13]=O,this[14]=D,this[15]=V,this.check()}setRowMajor(e,n,r,i,o,a,s,u,d,g,_,E,P,O,D,V){return this[0]=e,this[1]=o,this[2]=d,this[3]=P,this[4]=n,this[5]=a,this[6]=g,this[7]=O,this[8]=r,this[9]=s,this[10]=_,this[11]=D,this[12]=i,this[13]=u,this[14]=E,this[15]=V,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(Ybe)}fromObject(e){return this.check()}fromQuaternion(e){return Dbe(this,e),this.check()}frustum(e){const{left:n,right:r,bottom:i,top:o,near:a=JD,far:s=eB}=e;return s===1/0?Jbe(this,n,r,i,o,a):Bbe(this,n,r,i,o,a,s),this.check()}lookAt(e){const{eye:n,center:r=[0,0,0],up:i=[0,1,0]}=e;return zbe(this,n,r,i),this.check()}ortho(e){const{left:n,right:r,bottom:i,top:o,near:a=JD,far:s=eB}=e;return kbe(this,n,r,i,o,a,s),this.check()}orthographic(e){const{fovy:n=Xbe,aspect:r=Zbe,focalDistance:i=1,near:o=JD,far:a=eB}=e;I$(n);const s=n/2,u=i*Math.tan(s),d=u*r;return this.ortho({left:-d,right:d,bottom:-u,top:u,near:o,far:a})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:r=1,near:i=.1,far:o=500}=e;return I$(n),Jte(this,n,r,i,o),this.check()}determinant(){return Mbe(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],o=1/r[1],a=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*o,e[2]=this[2]*a,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*o,e[6]=this[6]*a,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*o,e[10]=this[10]*a,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const r=this.getScale(n),i=1/r[0],o=1/r[1],a=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*o,e[2]=this[2]*a,e[3]=this[4]*i,e[4]=this[5]*o,e[5]=this[6]*a,e[6]=this[8]*i,e[7]=this[9]*o,e[8]=this[10]*a,e}transpose(){return Ibe(this,this),this.check()}invert(){return aI(this,this),this.check()}multiplyLeft(e){return kd(this,e,this),this.check()}multiplyRight(e){return kd(this,this,e),this.check()}rotateX(e){return Qte(this,this,e),this.check()}rotateY(e){return Rbe(this,this,e),this.check()}rotateZ(e){return Kte(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return Obe(this,this,e,n),this.check()}scale(e){return $O(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return $w(this,this,e),this.check()}transform(e,n){return e.length===4?(n=D1(n||[-0,-0,-0,-0],e,this),gw(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:r}=e;let i;switch(r){case 2:i=Gte(n||[-0,-0],e,this);break;case 3:i=L5(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return gw(i,e.length),i}transformAsVector(e,n){let r;switch(e.length){case 2:r=jte(n||[-0,-0],e,this);break;case 3:r=Vte(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return gw(r,e.length),r}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,r){return this.identity().translate([e,n,r])}}let FS,kS;function Qbe(){return FS||(FS=new vr([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(FS)),FS}function Kbe(){return kS||(kS=new vr,Object.freeze(kS)),kS}function I$(t){if(t>Math.PI*2)throw Error("expected radians")}function Jbe(t,e,n,r,i,o){const a=2*o/(n-e),s=2*o/(i-r),u=(n+e)/(n-e),d=(i+r)/(i-r),g=-1,_=-1,E=-2*o;return t[0]=a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=u,t[9]=d,t[10]=g,t[11]=_,t[12]=0,t[13]=0,t[14]=E,t[15]=0,t}function M$(){var t=new Eh(4);return Eh!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function ewe(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ene(t,e,n){n=n*.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function O$(t,e,n){var r=e[0],i=e[1],o=e[2],a=e[3],s=n[0],u=n[1],d=n[2],g=n[3];return t[0]=r*g+a*s+i*d-o*u,t[1]=i*g+a*u+o*s-r*d,t[2]=o*g+a*d+r*u-i*s,t[3]=a*g-r*s-i*u-o*d,t}function twe(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*s,t[1]=i*u+o*s,t[2]=o*u-i*s,t[3]=a*u-r*s,t}function nwe(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u-o*s,t[1]=i*u+a*s,t[2]=o*u+r*s,t[3]=a*u-i*s,t}function rwe(t,e,n){n*=.5;var r=e[0],i=e[1],o=e[2],a=e[3],s=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*s,t[1]=i*u-r*s,t[2]=o*u+a*s,t[3]=a*u-o*s,t}function iwe(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t}function fC(t,e,n,r){var i=e[0],o=e[1],a=e[2],s=e[3],u=n[0],d=n[1],g=n[2],_=n[3],E,P,O,D,V;return P=i*u+o*d+a*g+s*_,P<0&&(P=-P,u=-u,d=-d,g=-g,_=-_),1-P>Es?(E=Math.acos(P),O=Math.sin(E),D=Math.sin((1-r)*E)/O,V=Math.sin(r*E)/O):(D=1-r,V=r),t[0]=D*i+V*u,t[1]=D*o+V*d,t[2]=D*a+V*g,t[3]=D*s+V*_,t}function owe(t,e){var n=e[0],r=e[1],i=e[2],o=e[3],a=n*n+r*r+i*i+o*o,s=a?1/a:0;return t[0]=-n*s,t[1]=-r*s,t[2]=-i*s,t[3]=o*s,t}function swe(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function tne(t,e){var n=e[0]+e[4]+e[8],r;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var o=(i+1)%3,a=(i+2)%3;r=Math.sqrt(e[i*3+i]-e[o*3+o]-e[a*3+a]+1),t[i]=.5*r,r=.5/r,t[3]=(e[o*3+a]-e[a*3+o])*r,t[o]=(e[o*3+i]+e[i*3+o])*r,t[a]=(e[a*3+i]+e[i*3+a])*r}return t}var awe=Gbe,lwe=D5,uwe=Hbe,cwe=Wbe,fwe=jbe,hwe=Vbe,nne=$be,dwe=function(){var t=Hte(),e=S$(1,0,0),n=S$(0,1,0);return function(r,i,o){var a=R5(i,o);return a<-.999999?(cC(t,e,i),Zte(t)<1e-6&&cC(t,n,i),fbe(t,t),ene(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(cC(t,i,o),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,nne(r,r))}}();(function(){var t=M$(),e=M$();return function(n,r,i,o,a,s){return fC(t,r,a,s),fC(e,i,o,s),fC(n,t,e,2*s*(1-s)),n}})();(function(){var t=_be();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],nne(e,tne(e,t))}})();const pwe=[0,0,0,1];class Qm extends GO{constructor(e=0,n=0,r=0,i=1){super(-0,-0,-0,-0),Array.isArray(e)&&arguments.length===1?this.copy(e):this.set(e,n,r,i)}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this.check()}set(e,n,r,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=i,this.check()}fromObject(e){return this[0]=e.x,this[1]=e.y,this[2]=e.z,this[3]=e.w,this.check()}fromMatrix3(e){return tne(this,e),this.check()}fromAxisRotation(e,n){return ene(this,e,n),this.check()}identity(){return ewe(this),this.check()}setAxisAngle(e,n){return this.fromAxisRotation(e,n)}get ELEMENTS(){return 4}get x(){return this[0]}set x(e){this[0]=Ur(e)}get y(){return this[1]}set y(e){this[1]=Ur(e)}get z(){return this[2]}set z(e){this[2]=Ur(e)}get w(){return this[3]}set w(e){this[3]=Ur(e)}len(){return fwe(this)}lengthSquared(){return hwe(this)}dot(e){return uwe(this,e)}rotationTo(e,n){return dwe(this,e,n),this.check()}add(e){return awe(this,this,e),this.check()}calculateW(){return iwe(this,this),this.check()}conjugate(){return swe(this,this),this.check()}invert(){return owe(this,this),this.check()}lerp(e,n,r){return r===void 0?this.lerp(this,e,n):(cwe(this,e,n,r),this.check())}multiplyRight(e){return O$(this,this,e),this.check()}multiplyLeft(e){return O$(this,e,this),this.check()}normalize(){const e=this.len(),n=e>0?1/e:0;return this[0]=this[0]*n,this[1]=this[1]*n,this[2]=this[2]*n,this[3]=this[3]*n,e===0&&(this[3]=1),this.check()}rotateX(e){return twe(this,this,e),this.check()}rotateY(e){return nwe(this,this,e),this.check()}rotateZ(e){return rwe(this,this,e),this.check()}scale(e){return lwe(this,this,e),this.check()}slerp(e,n,r){let i,o,a;switch(arguments.length){case 1:({start:i=pwe,target:o,ratio:a}=e);break;case 2:i=this,o=e,a=n;break;default:i=e,o=n,a=r}return fC(this,i,o,a),this.check()}transformVector4(e,n=new VO){return qbe(n,e,this),gw(n,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(e,n){return this.setAxisAngle(e,n)}premultiply(e){return this.multiplyLeft(e)}multiply(e){return this.multiplyRight(e)}}const R$=1e-6,gwe=6371e3;class zv{constructor({phi:e=0,theta:n=0,radius:r=1,bearing:i,pitch:o,altitude:a,radiusScale:s=gwe}={}){q(this,"phi",void 0),q(this,"theta",void 0),q(this,"radius",void 0),q(this,"radiusScale",void 0),this.phi=e,this.theta=n,this.radius=r||a||1,this.radiusScale=s||1,i!==void 0&&(this.bearing=i),o!==void 0&&(this.pitch=o),this.check()}toString(){return this.formatString(fo)}formatString({printTypes:e=!1}){const n=P5;return"".concat(e?"Spherical":"","[rho:").concat(n(this.radius),",theta:").concat(n(this.theta),",phi:").concat(n(this.phi),"]")}equals(e){return Sl(this.radius,e.radius)&&Sl(this.theta,e.theta)&&Sl(this.phi,e.phi)}exactEquals(e){return this.radius===e.radius&&this.theta===e.theta&&this.phi===e.phi}get bearing(){return 180-bl(this.phi)}set bearing(e){this.phi=Math.PI-nv(e)}get pitch(){return bl(this.theta)}set pitch(e){this.theta=nv(e)}get longitude(){return bl(this.phi)}get latitude(){return bl(this.theta)}get lng(){return bl(this.phi)}get lat(){return bl(this.theta)}get z(){return(this.radius-1)*this.radiusScale}set(e,n,r){return this.radius=e,this.phi=n,this.theta=r,this.check()}clone(){return new zv().copy(this)}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this.check()}fromLngLatZ([e,n,r]){return this.radius=1+r/this.radiusScale,this.phi=nv(n),this.theta=nv(e),this.check()}fromVector3(e){return this.radius=O5(e),this.radius>0&&(this.theta=Math.atan2(e[0],e[1]),this.phi=Math.acos(Wi(e[2]/this.radius,-1,1))),this.check()}toVector3(){return new _t(0,0,this.radius).rotateX({radians:this.theta}).rotateZ({radians:this.phi})}makeSafe(){return this.phi=Math.max(R$,Math.min(Math.PI-R$,this.phi)),this}check(){if(!Number.isFinite(this.phi)||!Number.isFinite(this.theta)||!(this.radius>0))throw new Error("SphericalCoordinates: some fields set to invalid numbers");return this}}const hC="Unknown Euler angle order",yy=.99999;var ta;(function(t){t[t.ZYX=0]="ZYX",t[t.YXZ=1]="YXZ",t[t.XZY=2]="XZY",t[t.ZXY=3]="ZXY",t[t.YZX=4]="YZX",t[t.XYZ=5]="XYZ"})(ta||(ta={}));class ms extends GO{static get ZYX(){return ta.ZYX}static get YXZ(){return ta.YXZ}static get XZY(){return ta.XZY}static get ZXY(){return ta.ZXY}static get YZX(){return ta.YZX}static get XYZ(){return ta.XYZ}static get RollPitchYaw(){return ta.ZYX}static get DefaultOrder(){return ta.ZYX}static get RotationOrders(){return ta}static rotationOrder(e){return ta[e]}get ELEMENTS(){return 4}constructor(e=0,n=0,r=0,i=ms.DefaultOrder){super(-0,-0,-0,-0),arguments.length>0&&Array.isArray(arguments[0])?this.fromVector3(...arguments):this.set(e,n,r,i)}fromQuaternion(e){const[n,r,i,o]=e,a=r*r,s=-2*(a+i*i)+1,u=2*(n*r+o*i);let d=-2*(n*i-o*r);const g=2*(r*i+o*n),_=-2*(n*n+a)+1;d=d>1?1:d,d=d<-1?-1:d;const E=Math.atan2(g,_),P=Math.asin(d),O=Math.atan2(u,s);return this.set(E,P,O,ms.RollPitchYaw)}fromObject(e){throw new Error("not implemented")}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=Number.isFinite(e[3])||this.order,this.check()}set(e=0,n=0,r=0,i){return this[0]=e,this[1]=n,this[2]=r,this[3]=Number.isFinite(i)?i:this[3],this.check()}validate(){return mwe(this[3])&&Number.isFinite(this[0])&&Number.isFinite(this[1])&&Number.isFinite(this[2])}toArray(e=[],n=0){return e[n]=this[0],e[n+1]=this[1],e[n+2]=this[2],e}toArray4(e=[],n=0){return e[n]=this[0],e[n+1]=this[1],e[n+2]=this[2],e[n+3]=this[3],e}toVector3(e=[-0,-0,-0]){return e[0]=this[0],e[1]=this[1],e[2]=this[2],e}get x(){return this[0]}set x(e){this[0]=Ur(e)}get y(){return this[1]}set y(e){this[1]=Ur(e)}get z(){return this[2]}set z(e){this[2]=Ur(e)}get alpha(){return this[0]}set alpha(e){this[0]=Ur(e)}get beta(){return this[1]}set beta(e){this[1]=Ur(e)}get gamma(){return this[2]}set gamma(e){this[2]=Ur(e)}get phi(){return this[0]}set phi(e){this[0]=Ur(e)}get theta(){return this[1]}set theta(e){this[1]=Ur(e)}get psi(){return this[2]}set psi(e){this[2]=Ur(e)}get roll(){return this[0]}set roll(e){this[0]=Ur(e)}get pitch(){return this[1]}set pitch(e){this[1]=Ur(e)}get yaw(){return this[2]}set yaw(e){this[2]=Ur(e)}get order(){return this[3]}set order(e){this[3]=Awe(e)}fromVector3(e,n){return this.set(e[0],e[1],e[2],Number.isFinite(n)?n:this[3])}fromArray(e,n=0){return this[0]=e[0+n],this[1]=e[1+n],this[2]=e[2+n],e[3]!==void 0&&(this[3]=e[3]),this.check()}fromRollPitchYaw(e,n,r){return this.set(e,n,r,ta.ZYX)}fromRotationMatrix(e,n=ms.DefaultOrder){return this._fromRotationMatrix(e,n),this.check()}getRotationMatrix(e){return this._getRotationMatrix(e)}getQuaternion(){const e=new Qm;switch(this[4]){case ta.XYZ:return e.rotateX(this[0]).rotateY(this[1]).rotateZ(this[2]);case ta.YXZ:return e.rotateY(this[0]).rotateX(this[1]).rotateZ(this[2]);case ta.ZXY:return e.rotateZ(this[0]).rotateX(this[1]).rotateY(this[2]);case ta.ZYX:return e.rotateZ(this[0]).rotateY(this[1]).rotateX(this[2]);case ta.YZX:return e.rotateY(this[0]).rotateZ(this[1]).rotateX(this[2]);case ta.XZY:return e.rotateX(this[0]).rotateZ(this[1]).rotateY(this[2]);default:throw new Error(hC)}}_fromRotationMatrix(e,n=ms.DefaultOrder){const r=e[0],i=e[4],o=e[8],a=e[1],s=e[5],u=e[9],d=e[2],g=e[6],_=e[10];switch(n=n||this[3],n){case ms.XYZ:this[1]=Math.asin(Wi(o,-1,1)),Math.abs(o)<yy?(this[0]=Math.atan2(-u,_),this[2]=Math.atan2(-i,r)):(this[0]=Math.atan2(g,s),this[2]=0);break;case ms.YXZ:this[0]=Math.asin(-Wi(u,-1,1)),Math.abs(u)<yy?(this[1]=Math.atan2(o,_),this[2]=Math.atan2(a,s)):(this[1]=Math.atan2(-d,r),this[2]=0);break;case ms.ZXY:this[0]=Math.asin(Wi(g,-1,1)),Math.abs(g)<yy?(this[1]=Math.atan2(-d,_),this[2]=Math.atan2(-i,s)):(this[1]=0,this[2]=Math.atan2(a,r));break;case ms.ZYX:this[1]=Math.asin(-Wi(d,-1,1)),Math.abs(d)<yy?(this[0]=Math.atan2(g,_),this[2]=Math.atan2(a,r)):(this[0]=0,this[2]=Math.atan2(-i,s));break;case ms.YZX:this[2]=Math.asin(Wi(a,-1,1)),Math.abs(a)<yy?(this[0]=Math.atan2(-u,s),this[1]=Math.atan2(-d,r)):(this[0]=0,this[1]=Math.atan2(o,_));break;case ms.XZY:this[2]=Math.asin(-Wi(i,-1,1)),Math.abs(i)<yy?(this[0]=Math.atan2(g,s),this[1]=Math.atan2(o,r)):(this[0]=Math.atan2(-u,_),this[1]=0);break;default:throw new Error(hC)}return this[3]=n,this}_getRotationMatrix(e){const n=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=this.x,i=this.y,o=this.z,a=Math.cos(r),s=Math.cos(i),u=Math.cos(o),d=Math.sin(r),g=Math.sin(i),_=Math.sin(o);switch(this[3]){case ms.XYZ:{const E=a*u,P=a*_,O=d*u,D=d*_;n[0]=s*u,n[4]=-s*_,n[8]=g,n[1]=P+O*g,n[5]=E-D*g,n[9]=-d*s,n[2]=D-E*g,n[6]=O+P*g,n[10]=a*s;break}case ms.YXZ:{const E=s*u,P=s*_,O=g*u,D=g*_;n[0]=E+D*d,n[4]=O*d-P,n[8]=a*g,n[1]=a*_,n[5]=a*u,n[9]=-d,n[2]=P*d-O,n[6]=D+E*d,n[10]=a*s;break}case ms.ZXY:{const E=s*u,P=s*_,O=g*u,D=g*_;n[0]=E-D*d,n[4]=-a*_,n[8]=O+P*d,n[1]=P+O*d,n[5]=a*u,n[9]=D-E*d,n[2]=-a*g,n[6]=d,n[10]=a*s;break}case ms.ZYX:{const E=a*u,P=a*_,O=d*u,D=d*_;n[0]=s*u,n[4]=O*g-P,n[8]=E*g+D,n[1]=s*_,n[5]=D*g+E,n[9]=P*g-O,n[2]=-g,n[6]=d*s,n[10]=a*s;break}case ms.YZX:{const E=a*s,P=a*g,O=d*s,D=d*g;n[0]=s*u,n[4]=D-E*_,n[8]=O*_+P,n[1]=_,n[5]=a*u,n[9]=-d*u,n[2]=-g*u,n[6]=P*_+O,n[10]=E-D*_;break}case ms.XZY:{const E=a*s,P=a*g,O=d*s,D=d*g;n[0]=s*u,n[4]=-_,n[8]=g*u,n[1]=E*_+D,n[5]=a*u,n[9]=P*_-O,n[2]=O*_-P,n[6]=d*u,n[10]=D*_+E;break}default:throw new Error(hC)}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}toQuaternion(){const e=Math.cos(this.yaw*.5),n=Math.sin(this.yaw*.5),r=Math.cos(this.roll*.5),i=Math.sin(this.roll*.5),o=Math.cos(this.pitch*.5),a=Math.sin(this.pitch*.5),s=e*r*o+n*i*a,u=e*i*o-n*r*a,d=e*r*a+n*i*o,g=n*r*o-e*i*a;return new Qm(u,d,g,s)}}function mwe(t){return t>=0&&t<6}function Awe(t){if(t<0&&t>=6)throw new Error(hC);return t}class L${constructor({x:e=0,y:n=0,z:r=0,roll:i=0,pitch:o=0,yaw:a=0,position:s,orientation:u}={}){q(this,"position",void 0),q(this,"orientation",void 0),Array.isArray(s)&&s.length===3?this.position=new _t(s):this.position=new _t(e,n,r),Array.isArray(u)&&u.length===4?this.orientation=new ms(u,u[3]):this.orientation=new ms(i,o,a,ms.RollPitchYaw)}get x(){return this.position.x}set x(e){this.position.x=e}get y(){return this.position.y}set y(e){this.position.y=e}get z(){return this.position.z}set z(e){this.position.z=e}get roll(){return this.orientation.roll}set roll(e){this.orientation.roll=e}get pitch(){return this.orientation.pitch}set pitch(e){this.orientation.pitch=e}get yaw(){return this.orientation.yaw}set yaw(e){this.orientation.yaw=e}getPosition(){return this.position}getOrientation(){return this.orientation}equals(e){return e?this.position.equals(e.position)&&this.orientation.equals(e.orientation):!1}exactEquals(e){return e?this.position.exactEquals(e.position)&&this.orientation.exactEquals(e.orientation):!1}getTransformationMatrix(){const e=Math.sin(this.roll),n=Math.sin(this.pitch),r=Math.sin(this.yaw),i=Math.cos(this.roll),o=Math.cos(this.pitch),a=Math.cos(this.yaw);return new vr().setRowMajor(a*o,-r*i+a*n*e,r*e+a*n*i,this.x,r*o,a*i+r*n*e,-a*e+r*n*i,this.y,-n,o*e,o*i,this.z,0,0,0,1)}getTransformationMatrixFromPose(e){return new vr().multiplyRight(this.getTransformationMatrix()).multiplyRight(e.getTransformationMatrix().invert())}getTransformationMatrixToPose(e){return new vr().multiplyRight(e.getTransformationMatrix()).multiplyRight(this.getTransformationMatrix().invert())}}const Uv={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:Math.PI*2},tB=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],_we={modelMatrix:tB,viewMatrix:tB,projectionMatrix:tB,cameraPositionWorld:[0,0,0]};function ywe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_we;const e={};return t.modelMatrix!==void 0&&(e.modelMatrix=t.modelMatrix),t.viewMatrix!==void 0&&(e.viewMatrix=t.viewMatrix),t.projectionMatrix!==void 0&&(e.projectionMatrix=t.projectionMatrix),t.cameraPositionWorld!==void 0&&(e.cameraPositionWorld=t.cameraPositionWorld),(t.projectionMatrix!==void 0||t.viewMatrix!==void 0)&&(e.viewProjectionMatrix=new vr(t.projectionMatrix).multiplyRight(t.viewMatrix)),e}const rne=`varying vec4 project_vPositionWorld;
varying vec3 project_vNormalWorld;

vec4 project_getPosition_World() {
  return project_vPositionWorld;
}

vec3 project_getNormal_World() {
  return project_vNormalWorld;
}
`,vwe="".concat(rne,`
uniform mat4 modelMatrix;
uniform mat4 viewMatrix;
uniform mat4 projectionMatrix;
uniform mat4 viewProjectionMatrix;
uniform vec3 cameraPositionWorld;

struct World {
  vec3 position;
  vec3 normal;
};

World world;

void project_setPosition(vec4 position) {
  project_vPositionWorld = position;
}

void project_setNormal(vec3 normal) {
  project_vNormalWorld = normal;
}

void project_setPositionAndNormal_World(vec3 position, vec3 normal) {
  world.position = position;
  world.normal = normal;
}

void project_setPositionAndNormal_Model(vec3 position, vec3 normal) {
  world.position = (modelMatrix * vec4(position, 1.)).xyz;
  world.normal = mat3(modelMatrix) * normal;
}

vec4 project_model_to_clipspace(vec4 position) {
  return viewProjectionMatrix * modelMatrix * position;
}

vec4 project_model_to_clipspace(vec3 position) {
  return viewProjectionMatrix * modelMatrix * vec4(position, 1.);
}

vec4 project_world_to_clipspace(vec3 position) {
  return viewProjectionMatrix * vec4(position, 1.);
}

vec4 project_view_to_clipspace(vec3 position) {
  return projectionMatrix * vec4(position, 1.);
}

vec4 project_to_clipspace(vec3 position) {
  return viewProjectionMatrix * vec4(position, 1.);
}
`),xwe=`
`.concat(rne),ine={name:"project",getUniforms:ywe,vs:vwe,fs:xwe},D$=`#if (defined(SHADER_TYPE_FRAGMENT) && defined(LIGHTING_FRAGMENT)) || (defined(SHADER_TYPE_VERTEX) && defined(LIGHTING_VERTEX))

struct AmbientLight {
 vec3 color;
};

struct PointLight {
 vec3 color;
 vec3 position;
 vec3 attenuation;
};

struct DirectionalLight {
  vec3 color;
  vec3 direction;
};

uniform AmbientLight lighting_uAmbientLight;
uniform PointLight lighting_uPointLight[MAX_LIGHTS];
uniform DirectionalLight lighting_uDirectionalLight[MAX_LIGHTS];
uniform int lighting_uPointLightCount;
uniform int lighting_uDirectionalLightCount;

uniform bool lighting_uEnabled;

float getPointLightAttenuation(PointLight pointLight, float distance) {
  return pointLight.attenuation.x
       + pointLight.attenuation.y * distance
       + pointLight.attenuation.z * distance * distance;
}

#endif
`,bwe={lightSources:{}};function nB(){let{color:t=[0,0,0],intensity:e=1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return t.map(n=>n*e/255)}function wwe(t){let{ambientLight:e,pointLights:n=[],directionalLights:r=[]}=t;const i={};return e?i["lighting_uAmbientLight.color"]=nB(e):i["lighting_uAmbientLight.color"]=[0,0,0],n.forEach((o,a)=>{i["lighting_uPointLight[".concat(a,"].color")]=nB(o),i["lighting_uPointLight[".concat(a,"].position")]=o.position,i["lighting_uPointLight[".concat(a,"].attenuation")]=o.attenuation||[1,0,0]}),i.lighting_uPointLightCount=n.length,r.forEach((o,a)=>{i["lighting_uDirectionalLight[".concat(a,"].color")]=nB(o),i["lighting_uDirectionalLight[".concat(a,"].direction")]=o.direction}),i.lighting_uDirectionalLightCount=r.length,i}function one(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:bwe;if("lightSources"in t){const{ambientLight:e,pointLights:n,directionalLights:r}=t.lightSources||{};return e||n&&n.length>0||r&&r.length>0?Object.assign({},wwe({ambientLight:e,pointLights:n,directionalLights:r}),{lighting_uEnabled:!0}):{lighting_uEnabled:!1}}if("lights"in t){const e={pointLights:[],directionalLights:[]};for(const n of t.lights||[])switch(n.type){case"ambient":e.ambientLight=n;break;case"directional":e.directionalLights.push(n);break;case"point":e.pointLights.push(n);break}return one({lightSources:e})}return{}}const B5={name:"lights",vs:D$,fs:D$,getUniforms:one,defines:{MAX_LIGHTS:3}},Ewe=new Float32Array([1,1,2]),Swe={lightDirection:Ewe};function Twe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Swe;const e={};return t.lightDirection&&(e.dirlight_uLightDirection=t.lightDirection),e}const Cwe=null,Pwe=`uniform vec3 dirlight_uLightDirection;
vec4 dirlight_filterColor(vec4 color) {
  vec3 normal = project_getNormal_World();
  float d = abs(dot(normalize(normal), normalize(dirlight_uLightDirection)));
  return vec4(color.rgb * d, color.a);
}
`,Iwe={name:"dirlight",vs:Cwe,fs:Pwe,getUniforms:Twe,dependencies:[ine]},Mwe=new Uint8Array([0,255,255,255]),Owe={pickingSelectedColor:null,pickingHighlightColor:Mwe,pickingActive:!1,pickingAttribute:!1};function Rwe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Owe;const e={};if(t.pickingSelectedColor!==void 0)if(!t.pickingSelectedColor)e.picking_uSelectedColorValid=0;else{const n=t.pickingSelectedColor.slice(0,3);e.picking_uSelectedColorValid=1,e.picking_uSelectedColor=n}if(t.pickingHighlightColor){const n=Array.from(t.pickingHighlightColor,r=>r/255);Number.isFinite(n[3])||(n[3]=1),e.picking_uHighlightColor=n}return t.pickingActive!==void 0&&(e.picking_uActive=!!t.pickingActive,e.picking_uAttribute=!!t.pickingAttribute),e}const Lwe=`uniform bool picking_uActive;
uniform bool picking_uAttribute;
uniform vec3 picking_uSelectedColor;
uniform bool picking_uSelectedColorValid;

out vec4 picking_vRGBcolor_Avalid;

const float COLOR_SCALE = 1. / 255.;

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.001;
}

bool isVertexPicked(vec3 vertexColor) {
  return
    picking_uSelectedColorValid &&
    !picking_isColorValid(abs(vertexColor - picking_uSelectedColor));
}

void picking_setPickingColor(vec3 pickingColor) {
  if (picking_uActive) {
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!picking_uAttribute) {
      picking_vRGBcolor_Avalid.rgb = pickingColor * COLOR_SCALE;
    }
  } else {
    picking_vRGBcolor_Avalid.a = float(isVertexPicked(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.r = value;
  }
}
void picking_setPickingAttribute(vec2 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}
void picking_setPickingAttribute(vec3 value) {
  if (picking_uAttribute) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,Dwe=`uniform bool picking_uActive;
uniform vec3 picking_uSelectedColor;
uniform vec4 picking_uHighlightColor;

in vec4 picking_vRGBcolor_Avalid;
vec4 picking_filterHighlightColor(vec4 color) {
  if (picking_uActive) {
    return color;
  }
  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    float highLightAlpha = picking_uHighlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking_uHighlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}
vec4 picking_filterPickingColor(vec4 color) {
  if (picking_uActive) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}
vec4 picking_filterColor(vec4 color) {
  vec4 highightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highightColor);
}

`,sne={name:"picking",vs:Lwe,fs:Dwe,getUniforms:Rwe},ane=`
uniform float lighting_uAmbient;
uniform float lighting_uDiffuse;
uniform float lighting_uShininess;
uniform vec3  lighting_uSpecularColor;

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 light_direction, vec3 view_direction, vec3 normal_worldspace, vec3 color) {
    vec3 halfway_direction = normalize(light_direction + view_direction);
    float lambertian = dot(light_direction, normal_worldspace);
    float specular = 0.0;
    if (lambertian > 0.0) {
      float specular_angle = max(dot(normal_worldspace, halfway_direction), 0.0);
      specular = pow(specular_angle, lighting_uShininess);
    }
    lambertian = max(lambertian, 0.0);
    return (lambertian * lighting_uDiffuse * surfaceColor + specular * lighting_uSpecularColor) * color;
}

vec3 lighting_getLightColor(vec3 surfaceColor, vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = surfaceColor;

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);
    lightColor = lighting_uAmbient * surfaceColor * lighting_uAmbientLight.color;

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}

vec3 lighting_getSpecularLightColor(vec3 cameraPosition, vec3 position_worldspace, vec3 normal_worldspace) {
  vec3 lightColor = vec3(0, 0, 0);
  vec3 surfaceColor = vec3(0, 0, 0);

  if (lighting_uEnabled) {
    vec3 view_direction = normalize(cameraPosition - position_worldspace);

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uPointLightCount) {
        break;
      }
      PointLight pointLight = lighting_uPointLight[i];
      vec3 light_position_worldspace = pointLight.position;
      vec3 light_direction = normalize(light_position_worldspace - position_worldspace);
      lightColor += lighting_getLightColor(surfaceColor, light_direction, view_direction, normal_worldspace, pointLight.color);
    }

    for (int i = 0; i < MAX_LIGHTS; i++) {
      if (i >= lighting_uDirectionalLightCount) {
        break;
      }
      DirectionalLight directionalLight = lighting_uDirectionalLight[i];
      lightColor += lighting_getLightColor(surfaceColor, -directionalLight.direction, view_direction, normal_worldspace, directionalLight.color);
    }
  }
  return lightColor;
}
`,Bwe={};function Nwe(t){const{ambient:e=.35,diffuse:n=.6,shininess:r=32,specularColor:i=[30,30,30]}=t;return{lighting_uAmbient:e,lighting_uDiffuse:n,lighting_uShininess:r,lighting_uSpecularColor:i.map(o=>o/255)}}function lne(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Bwe;if(!("material"in t))return{};const{material:e}=t;return e?Nwe(e):{lighting_uEnabled:!1}}const zE={name:"gouraud-lighting",dependencies:[B5],vs:ane,defines:{LIGHTING_VERTEX:1},getUniforms:lne},HO={name:"phong-lighting",dependencies:[B5],fs:ane,defines:{LIGHTING_FRAGMENT:1},getUniforms:lne},Fwe=`uniform mat4 u_MVPMatrix;
uniform mat4 u_ModelMatrix;
uniform mat4 u_NormalMatrix;

varying vec3 pbr_vPosition;
varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
# ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
# else
varying vec3 pbr_vNormal;
# endif
#endif

void pbr_setPositionNormalTangentUV(vec4 position, vec4 normal, vec4 tangent, vec2 uv)
{
  vec4 pos = u_ModelMatrix * position;
  pbr_vPosition = vec3(pos.xyz) / pos.w;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
  vec3 normalW = normalize(vec3(u_NormalMatrix * vec4(normal.xyz, 0.0)));
  vec3 tangentW = normalize(vec3(u_ModelMatrix * vec4(tangent.xyz, 0.0)));
  vec3 bitangentW = cross(normalW, tangentW) * tangent.w;
  pbr_vTBN = mat3(tangentW, bitangentW, normalW);
#else
  pbr_vNormal = normalize(vec3(u_ModelMatrix * vec4(normal.xyz, 0.0)));
#endif
#endif

#ifdef HAS_UV
  pbr_vUV = uv;
#else
  pbr_vUV = vec2(0.,0.);
#endif
}
`,kwe=`#if defined(USE_TEX_LOD) && !defined(FEATURE_GLSL_TEXTURE_LOD)
# error PBR fragment shader: Texture LOD is not available
#endif

#if !defined(HAS_TANGENTS) && !defined(FEATURE_GLSL_DERIVATIVES)
# error PBR fragment shader: Derivatives are not available
#endif


#if (__VERSION__ < 300)
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL1COND; INCR)
#else
  #define SMART_FOR(INIT, WEBGL1COND, WEBGL2COND, INCR) for (INIT; WEBGL2COND; INCR)
#endif

precision highp float;

uniform bool pbr_uUnlit;

#ifdef USE_IBL
uniform samplerCube u_DiffuseEnvSampler;
uniform samplerCube u_SpecularEnvSampler;
uniform sampler2D u_brdfLUT;
uniform vec2 u_ScaleIBLAmbient;
#endif

#ifdef HAS_BASECOLORMAP
uniform sampler2D u_BaseColorSampler;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_NormalSampler;
uniform float u_NormalScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_EmissiveSampler;
uniform vec3 u_EmissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_MetallicRoughnessSampler;
#endif
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_OcclusionSampler;
uniform float u_OcclusionStrength;
#endif

#ifdef ALPHA_CUTOFF
uniform float u_AlphaCutoff;
#endif

uniform vec2 u_MetallicRoughnessValues;
uniform vec4 u_BaseColorFactor;

uniform vec3 u_Camera;
#ifdef PBR_DEBUG
uniform vec4 u_ScaleDiffBaseMR;
uniform vec4 u_ScaleFGDSpec;
#endif

varying vec3 pbr_vPosition;

varying vec2 pbr_vUV;

#ifdef HAS_NORMALS
#ifdef HAS_TANGENTS
varying mat3 pbr_vTBN;
#else
varying vec3 pbr_vNormal;
#endif
#endif


struct PBRInfo
{
  float NdotL;
  float NdotV;
  float NdotH;
  float LdotH;
  float VdotH;
  float perceptualRoughness;
  float metalness;
  vec3 reflectance0;
  vec3 reflectance90;
  float alphaRoughness;
  vec3 diffuseColor;
  vec3 specularColor;
  vec3 n;
  vec3 v;
};

const float M_PI = 3.141592653589793;
const float c_MinRoughness = 0.04;

vec4 SRGBtoLINEAR(vec4 srgbIn)
{
#ifdef MANUAL_SRGB
#ifdef SRGB_FAST_APPROXIMATION
  vec3 linOut = pow(srgbIn.xyz,vec3(2.2));
#else
  vec3 bLess = step(vec3(0.04045),srgbIn.xyz);
  vec3 linOut = mix( srgbIn.xyz/vec3(12.92), pow((srgbIn.xyz+vec3(0.055))/vec3(1.055),vec3(2.4)), bLess );
#endif
  return vec4(linOut,srgbIn.w);;
#else
  return srgbIn;
#endif
}

vec3 getNormal()
{
#ifndef HAS_TANGENTS
  vec3 pos_dx = dFdx(pbr_vPosition);
  vec3 pos_dy = dFdy(pbr_vPosition);
  vec3 tex_dx = dFdx(vec3(pbr_vUV, 0.0));
  vec3 tex_dy = dFdy(vec3(pbr_vUV, 0.0));
  vec3 t = (tex_dy.t * pos_dx - tex_dx.t * pos_dy) / (tex_dx.s * tex_dy.t - tex_dy.s * tex_dx.t);

#ifdef HAS_NORMALS
  vec3 ng = normalize(pbr_vNormal);
#else
  vec3 ng = cross(pos_dx, pos_dy);
#endif

  t = normalize(t - ng * dot(ng, t));
  vec3 b = normalize(cross(ng, t));
  mat3 tbn = mat3(t, b, ng);
#else
  mat3 tbn = pbr_vTBN;
#endif

#ifdef HAS_NORMALMAP
  vec3 n = texture2D(u_NormalSampler, pbr_vUV).rgb;
  n = normalize(tbn * ((2.0 * n - 1.0) * vec3(u_NormalScale, u_NormalScale, 1.0)));
#else
  vec3 n = normalize(tbn[2].xyz);
#endif

  return n;
}


#ifdef USE_IBL
vec3 getIBLContribution(PBRInfo pbrInputs, vec3 n, vec3 reflection)
{
  float mipCount = 9.0;
  float lod = (pbrInputs.perceptualRoughness * mipCount);
  vec3 brdf = SRGBtoLINEAR(texture2D(u_brdfLUT,
    vec2(pbrInputs.NdotV, 1.0 - pbrInputs.perceptualRoughness))).rgb;
  vec3 diffuseLight = SRGBtoLINEAR(textureCube(u_DiffuseEnvSampler, n)).rgb;

#ifdef USE_TEX_LOD
  vec3 specularLight = SRGBtoLINEAR(textureCubeLod(u_SpecularEnvSampler, reflection, lod)).rgb;
#else
  vec3 specularLight = SRGBtoLINEAR(textureCube(u_SpecularEnvSampler, reflection)).rgb;
#endif

  vec3 diffuse = diffuseLight * pbrInputs.diffuseColor;
  vec3 specular = specularLight * (pbrInputs.specularColor * brdf.x + brdf.y);
  diffuse *= u_ScaleIBLAmbient.x;
  specular *= u_ScaleIBLAmbient.y;

  return diffuse + specular;
}
#endif


vec3 diffuse(PBRInfo pbrInputs)
{
  return pbrInputs.diffuseColor / M_PI;
}

vec3 specularReflection(PBRInfo pbrInputs)
{
  return pbrInputs.reflectance0 +
    (pbrInputs.reflectance90 - pbrInputs.reflectance0) *
    pow(clamp(1.0 - pbrInputs.VdotH, 0.0, 1.0), 5.0);
}



float geometricOcclusion(PBRInfo pbrInputs)
{
  float NdotL = pbrInputs.NdotL;
  float NdotV = pbrInputs.NdotV;
  float r = pbrInputs.alphaRoughness;

  float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r * r + (1.0 - r * r) * (NdotL * NdotL)));
  float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r * r + (1.0 - r * r) * (NdotV * NdotV)));
  return attenuationL * attenuationV;
}





float microfacetDistribution(PBRInfo pbrInputs)
{
  float roughnessSq = pbrInputs.alphaRoughness * pbrInputs.alphaRoughness;
  float f = (pbrInputs.NdotH * roughnessSq - pbrInputs.NdotH) * pbrInputs.NdotH + 1.0;
  return roughnessSq / (M_PI * f * f);
}

void PBRInfo_setAmbientLight(inout PBRInfo pbrInputs) {
  pbrInputs.NdotL = 1.0;
  pbrInputs.NdotH = 0.0;
  pbrInputs.LdotH = 0.0;
  pbrInputs.VdotH = 1.0;
}

void PBRInfo_setDirectionalLight(inout PBRInfo pbrInputs, vec3 lightDirection) {
  vec3 n = pbrInputs.n;
  vec3 v = pbrInputs.v;
  vec3 l = normalize(lightDirection);
  vec3 h = normalize(l+v);

  pbrInputs.NdotL = clamp(dot(n, l), 0.001, 1.0);
  pbrInputs.NdotH = clamp(dot(n, h), 0.0, 1.0);
  pbrInputs.LdotH = clamp(dot(l, h), 0.0, 1.0);
  pbrInputs.VdotH = clamp(dot(v, h), 0.0, 1.0);
}

void PBRInfo_setPointLight(inout PBRInfo pbrInputs, PointLight pointLight) {
  vec3 light_direction = normalize(pointLight.position - pbr_vPosition);
  PBRInfo_setDirectionalLight(pbrInputs, light_direction);
}

vec3 calculateFinalColor(PBRInfo pbrInputs, vec3 lightColor) {
  vec3 F = specularReflection(pbrInputs);
  float G = geometricOcclusion(pbrInputs);
  float D = microfacetDistribution(pbrInputs);
  vec3 diffuseContrib = (1.0 - F) * diffuse(pbrInputs);
  vec3 specContrib = F * G * D / (4.0 * pbrInputs.NdotL * pbrInputs.NdotV);
  return pbrInputs.NdotL * lightColor * (diffuseContrib + specContrib);
}

vec4 pbr_filterColor(vec4 colorUnused)
{
#ifdef HAS_BASECOLORMAP
  vec4 baseColor = SRGBtoLINEAR(texture2D(u_BaseColorSampler, pbr_vUV)) * u_BaseColorFactor;
#else
  vec4 baseColor = u_BaseColorFactor;
#endif

#ifdef ALPHA_CUTOFF
  if (baseColor.a < u_AlphaCutoff) {
    discard;
  }
#endif

  vec3 color = vec3(0, 0, 0);

  if(pbr_uUnlit){
    color.rgb = baseColor.rgb;
  }
  else{


    float perceptualRoughness = u_MetallicRoughnessValues.y;
    float metallic = u_MetallicRoughnessValues.x;
#ifdef HAS_METALROUGHNESSMAP

    vec4 mrSample = texture2D(u_MetallicRoughnessSampler, pbr_vUV);
    perceptualRoughness = mrSample.g * perceptualRoughness;
    metallic = mrSample.b * metallic;
#endif
    perceptualRoughness = clamp(perceptualRoughness, c_MinRoughness, 1.0);
    metallic = clamp(metallic, 0.0, 1.0);

    float alphaRoughness = perceptualRoughness * perceptualRoughness;

    vec3 f0 = vec3(0.04);
    vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);
    diffuseColor *= 1.0 - metallic;
    vec3 specularColor = mix(f0, baseColor.rgb, metallic);
    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);



    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);
    vec3 specularEnvironmentR0 = specularColor.rgb;
    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;

    vec3 n = getNormal();
    vec3 v = normalize(u_Camera - pbr_vPosition);

    float NdotV = clamp(abs(dot(n, v)), 0.001, 1.0);
    vec3 reflection = -normalize(reflect(v, n));

    PBRInfo pbrInputs = PBRInfo(
      0.0,
      NdotV,
      0.0,
      0.0,
      0.0,
      perceptualRoughness,
      metallic,
      specularEnvironmentR0,
      specularEnvironmentR90,
      alphaRoughness,
      diffuseColor,
      specularColor,
      n,
      v
    );

#ifdef USE_LIGHTS
    PBRInfo_setAmbientLight(pbrInputs);
    color += calculateFinalColor(pbrInputs, lighting_uAmbientLight.color);
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uDirectionalLightCount, i++) {
      if (i < lighting_uDirectionalLightCount) {
        PBRInfo_setDirectionalLight(pbrInputs, lighting_uDirectionalLight[i].direction);
        color += calculateFinalColor(pbrInputs, lighting_uDirectionalLight[i].color);
      }
    }
    SMART_FOR(int i = 0, i < MAX_LIGHTS, i < lighting_uPointLightCount, i++) {
      if (i < lighting_uPointLightCount) {
        PBRInfo_setPointLight(pbrInputs, lighting_uPointLight[i]);
        float attenuation = getPointLightAttenuation(lighting_uPointLight[i], distance(lighting_uPointLight[i].position, pbr_vPosition));
        color += calculateFinalColor(pbrInputs, lighting_uPointLight[i].color / attenuation);
      }
    }
#endif
#ifdef USE_IBL
    color += getIBLContribution(pbrInputs, n, reflection);
#endif
#ifdef HAS_OCCLUSIONMAP
    float ao = texture2D(u_OcclusionSampler, pbr_vUV).r;
    color = mix(color, color * ao, u_OcclusionStrength);
#endif

#ifdef HAS_EMISSIVEMAP
    vec3 emissive = SRGBtoLINEAR(texture2D(u_EmissiveSampler, pbr_vUV)).rgb * u_EmissiveFactor;
    color += emissive;
#endif

#ifdef PBR_DEBUG





    color = mix(color, baseColor.rgb, u_ScaleDiffBaseMR.y);
    color = mix(color, vec3(metallic), u_ScaleDiffBaseMR.z);
    color = mix(color, vec3(perceptualRoughness), u_ScaleDiffBaseMR.w);
#endif

  }

  return vec4(pow(color,vec3(1.0/2.2)), baseColor.a);
}
`,WO={name:"pbr",vs:Fwe,fs:kwe,defines:{LIGHTING_FRAGMENT:1},dependencies:[B5]},zwe=`attribute float transform_elementID;
vec2 transform_getPixelSizeHalf(vec2 size) {
  return vec2(1.) / (2. * size);
}

vec2 transform_getPixelIndices(vec2 texSize, vec2 pixelSizeHalf) {
  float yIndex = floor((transform_elementID / texSize[0]) + pixelSizeHalf[1]);
  float xIndex = transform_elementID - (yIndex * texSize[0]);
  return vec2(xIndex, yIndex);
}
vec2 transform_getTexCoord(vec2 size) {
  vec2 pixelSizeHalf = transform_getPixelSizeHalf(size);
  vec2 indices = transform_getPixelIndices(size, pixelSizeHalf);
  vec2 coord = indices / size + pixelSizeHalf;
  return coord;
}
vec2 transform_getPos(vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec2 pos = (texCoord * (2.0, 2.0)) - (1., 1.);
  return pos;
}
vec4 transform_getInput(sampler2D texSampler, vec2 size) {
  vec2 texCoord = transform_getTexCoord(size);
  vec4 textureColor = texture2D(texSampler, texCoord);
  return textureColor;
}
`,Uwe={name:"transform",vs:zwe,fs:null};class B1{static getDefaultProgramManager(e){return e.luma=e.luma||{},e.luma.defaultProgramManager=e.luma.defaultProgramManager||new B1(e),e.luma.defaultProgramManager}constructor(e){this.gl=e,this._programCache={},this._getUniforms={},this._registeredModules={},this._hookFunctions=[],this._defaultModules=[],this._hashes={},this._hashCounter=0,this.stateHash=0,this._useCounts={}}addDefaultModule(e){this._defaultModules.find(n=>n.name===e.name)||this._defaultModules.push(e),this.stateHash++}removeDefaultModule(e){const n=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==n),this.stateHash++}addShaderHook(e,n){n&&(e=Object.assign(n,{hook:e})),this._hookFunctions.push(e),this.stateHash++}get(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{vs:n="",fs:r="",defines:i={},inject:o={},varyings:a=[],bufferMode:s=35981,transpileToGLSL100:u=!1}=e,d=this._getModuleList(e.modules),g=this._getHash(n),_=this._getHash(r),E=d.map(z=>this._getHash(z.name)).sort(),P=a.map(z=>this._getHash(z)),O=Object.keys(i).sort(),D=Object.keys(o).sort(),V=[],k=[];for(const z of O)V.push(this._getHash(z)),V.push(this._getHash(i[z]));for(const z of D)k.push(this._getHash(z)),k.push(this._getHash(o[z]));const F="".concat(g,"/").concat(_,"D").concat(V.join("/"),"M").concat(E.join("/"),"I").concat(k.join("/"),"V").concat(P.join("/"),"H").concat(this.stateHash,"B").concat(s).concat(u?"T":"");if(!this._programCache[F]){const z=Axe(this.gl,{vs:n,fs:r,modules:d,inject:o,defines:i,hookFunctions:this._hookFunctions,transpileToGLSL100:u});this._programCache[F]=new w5(this.gl,{hash:F,vs:z.vs,fs:z.fs,varyings:a,bufferMode:s}),this._getUniforms[F]=z.getUniforms||(X=>{}),this._useCounts[F]=0}return this._useCounts[F]++,this._programCache[F]}getUniforms(e){return this._getUniforms[e.hash]||null}release(e){const n=e.hash;this._useCounts[n]--,this._useCounts[n]===0&&(this._programCache[n].delete(),delete this._programCache[n],delete this._getUniforms[n],delete this._useCounts[n])}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}_getModuleList(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const n=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let o=0,a=this._defaultModules.length;o<a;++o){const s=this._defaultModules[o],u=s.name;n[i++]=s,r[u]=!0}for(let o=0,a=e.length;o<a;++o){const s=e[o],u=s.name;r[u]||(n[i++]=s,r[u]=!0)}return n.length=i,n}}const Gwe={POSITION:"positions",NORMAL:"normals",COLOR_0:"colors",TEXCOORD_0:"texCoords",TEXCOORD_1:"texCoords1",TEXCOORD_2:"texCoords2"};function jwe(t,e,n){const r={};let i=e.indices;for(const o in e.attributes){const a=e.attributes[o],s=Vwe(o,n);if(o==="indices")i=a;else if(a.constant)r[s]=a.value;else{const u=a.value,d={...a};delete d.value,r[s]=[new ji(t,u),d],$we(o,d)}}if(i){const o=i.value||i;Nn(o instanceof Uint16Array||o instanceof Uint32Array,'attribute array for "indices" must be of integer type');const a={size:1,isIndexed:i.isIndexed===void 0?!0:i.isIndexed};r.indices=[new ji(t,{data:o,target:34963}),a]}return r}function Vwe(t,e){const{attributeMap:n=Gwe}=e||{};return n&&n[t]||t}function $we(t,e){let n;switch(t){case"texCoords":case"texCoord1":case"texCoord2":case"texCoord3":n="uvs";break;case"vertices":case"positions":case"normals":case"pickingColors":n="vectors";break}switch(n){case"vectors":e.size=e.size||3;break;case"uvs":e.size=e.size||2;break}Nn(Number.isFinite(e.size),"attribute ".concat(t," needs size"))}const vy=2,Hwe=1e4,Wwe="Model needs drawMode and vertexCount",B$=()=>{},qwe={};class Oa{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{id:r=Ma("model")}=n;Nn(LE(e)),this.id=r,this.gl=e,this.id=n.id||Ma("Model"),this.lastLogTime=0,this.animated=!1,this.initialize(n)}initialize(e){this.props={},this.programManager=e.programManager||B1.getDefaultProgramManager(this.gl),this._programManagerState=-1,this._managedProgram=!1;const{program:n=null,vs:r,fs:i,modules:o,defines:a,inject:s,varyings:u,bufferMode:d,transpileToGLSL100:g}=e;this.programProps={program:n,vs:r,fs:i,modules:o,defines:a,inject:s,varyings:u,bufferMode:d,transpileToGLSL100:g},this.program=null,this.vertexArray=null,this._programDirty=!0,this.userData={},this.needsRedraw=!0,this._attributes={},this.attributes={},this.uniforms={},this.pickable=!0,this._checkProgram(),this.setUniforms(Object.assign({},this.getModuleUniforms(e.moduleSettings))),this.drawMode=e.drawMode!==void 0?e.drawMode:4,this.vertexCount=e.vertexCount||0,this.geometryBuffers={},this.isInstanced=e.isInstanced||e.instanced||e.instanceCount>0,this._setModelProps(e),this.geometry={},Nn(this.drawMode!==void 0&&Number.isFinite(this.vertexCount),Wwe)}setProps(e){this._setModelProps(e)}delete(){for(const e in this._attributes)this._attributes[e]!==this.attributes[e]&&this._attributes[e].delete();this._managedProgram&&(this.programManager.release(this.program),this._managedProgram=!1),this.vertexArray.delete(),this._deleteGeometryBuffers()}getDrawMode(){return this.drawMode}getVertexCount(){return this.vertexCount}getInstanceCount(){return this.instanceCount}getAttributes(){return this.attributes}getProgram(){return this.program}setProgram(e){const{program:n,vs:r,fs:i,modules:o,defines:a,inject:s,varyings:u,bufferMode:d,transpileToGLSL100:g}=e;this.programProps={program:n,vs:r,fs:i,modules:o,defines:a,inject:s,varyings:u,bufferMode:d,transpileToGLSL100:g},this._programDirty=!0}getUniforms(){return this.uniforms}setDrawMode(e){return this.drawMode=e,this}setVertexCount(e){return Nn(Number.isFinite(e)),this.vertexCount=e,this}setInstanceCount(e){return Nn(Number.isFinite(e)),this.instanceCount=e,this}setGeometry(e){return this.drawMode=e.drawMode,this.vertexCount=e.getVertexCount(),this._deleteGeometryBuffers(),this.geometryBuffers=jwe(this.gl,e),this.vertexArray.setAttributes(this.geometryBuffers),this}setAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Fv(e))return this;const n={};for(const r in e){const i=e[r];n[r]=i.getValue?i.getValue():i}return this.vertexArray.setAttributes(n),this}setUniforms(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.assign(this.uniforms,e),this}getModuleUniforms(e){this._checkProgram();const n=this.programManager.getUniforms(this.program);return n?n(e):{}}updateModuleSettings(e){const n=this.getModuleUniforms(e||{});return this.setUniforms(n)}clear(e){return BE(this.program.gl,e),this}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._checkProgram();const{moduleSettings:n=null,framebuffer:r,uniforms:i={},attributes:o={},transformFeedback:a=this.transformFeedback,parameters:s={},vertexArray:u=this.vertexArray}=e;this.setAttributes(o),this.updateModuleSettings(n),this.setUniforms(i);let d;Yn.priority>=vy&&(d=this._logDrawCallStart(vy));const g=this.vertexArray.getDrawParams(),{isIndexed:_=g.isIndexed,indexType:E=g.indexType,indexOffset:P=g.indexOffset,vertexArrayInstanced:O=g.isInstanced}=this.props;O&&!this.isInstanced&&Yn.warn("Found instanced attributes on non-instanced model",this.id)();const{isInstanced:D,instanceCount:V}=this,{onBeforeRender:k=B$,onAfterRender:F=B$}=this.props;k(),this.program.setUniforms(this.uniforms);const z=this.program.draw(Object.assign(qwe,e,{logPriority:d,uniforms:null,framebuffer:r,parameters:s,drawMode:this.getDrawMode(),vertexCount:this.getVertexCount(),vertexArray:u,transformFeedback:a,isIndexed:_,indexType:E,isInstanced:D,instanceCount:V,offset:_?P:0}));return F(),Yn.priority>=vy&&this._logDrawCallEnd(d,u,r),z}transform(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{discard:n=!0,feedbackBuffers:r,unbindModels:i=[]}=e;let{parameters:o}=e;r&&this._setFeedbackBuffers(r),n&&(o=Object.assign({},o,{35977:n})),i.forEach(a=>a.vertexArray.unbindBuffers());try{this.draw(Object.assign({},e,{parameters:o}))}finally{i.forEach(a=>a.vertexArray.bindBuffers())}return this}render(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Yn.warn("Model.render() is deprecated. Use Model.setUniforms() and Model.draw()")(),this.setUniforms(e).draw()}_setModelProps(e){Object.assign(this.props,e),"uniforms"in e&&this.setUniforms(e.uniforms),"pickable"in e&&(this.pickable=e.pickable),"instanceCount"in e&&(this.instanceCount=e.instanceCount),"geometry"in e&&this.setGeometry(e.geometry),"attributes"in e&&this.setAttributes(e.attributes),"_feedbackBuffers"in e&&this._setFeedbackBuffers(e._feedbackBuffers)}_checkProgram(){if(!(this._programDirty||this.programManager.stateHash!==this._programManagerState))return;let{program:n}=this.programProps;if(n)this._managedProgram=!1;else{const{vs:r,fs:i,modules:o,inject:a,defines:s,varyings:u,bufferMode:d,transpileToGLSL100:g}=this.programProps;n=this.programManager.get({vs:r,fs:i,modules:o,inject:a,defines:s,varyings:u,bufferMode:d,transpileToGLSL100:g}),this.program&&this._managedProgram&&this.programManager.release(this.program),this._programManagerState=this.programManager.stateHash,this._managedProgram=!0}Nn(n instanceof w5,"Model needs a program"),this._programDirty=!1,n!==this.program&&(this.program=n,this.vertexArray?this.vertexArray.setProps({program:this.program,attributes:this.vertexArray.attributes}):this.vertexArray=new L1e(this.gl,{program:this.program}),this.setUniforms(Object.assign({},this.getModuleUniforms())))}_deleteGeometryBuffers(){for(const e in this.geometryBuffers){const n=this.geometryBuffers[e][0]||this.geometryBuffers[e];n instanceof ji&&n.delete()}}_setAnimationProps(e){this.animated&&Nn(e,"Model.draw(): animated uniforms but no animationProps")}_setFeedbackBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(Fv(e))return this;const{gl:n}=this.program;return this.transformFeedback=this.transformFeedback||new E5(n,{program:this.program}),this.transformFeedback.setBuffers(e),this}_logDrawCallStart(e){const n=e>3?0:Hwe;if(!(Date.now()-this.lastLogTime<n))return this.lastLogTime=Date.now(),Yn.group(vy,">>> DRAWING MODEL ".concat(this.id),{collapsed:Yn.level<=2})(),e}_logDrawCallEnd(e,n,r,i){if(e===void 0)return;const o=N1e({vertexArray:n,header:"".concat(this.id," attributes"),attributes:this._attributes}),{table:a,unusedTable:s,unusedCount:u}=g$({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r)}),{table:d,count:g}=g$({header:"".concat(this.id," uniforms"),program:this.program,uniforms:Object.assign({},this.program.uniforms,r),undefinedOnly:!0});g>0&&Yn.log("MISSING UNIFORMS",Object.keys(d))(),u>0&&Yn.log("UNUSED UNIFORMS",Object.keys(s))();const _=k1e(this.vertexArray.configuration);Yn.table(e,o)(),Yn.table(e,a)(),Yn.table(e+1,_)(),i&&i.log({logLevel:vy,message:"Rendered to ".concat(i.id)}),Yn.groupEnd(vy)()}}class Xwe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.currentIndex=0,this.feedbackMap={},this.varyings=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}setupResources(e){for(const n of this.bindings)this._setupTransformFeedback(n,e)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyings:n}=this;return n.length>0&&(e=Object.assign({},e,{varyings:n})),e}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this.bindings[this.currentIndex],{sourceBuffers:r,transformFeedback:i}=n;return{attributes:Object.assign({},r,e.attributes),transformFeedback:i}}swap(){return this.feedbackMap?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e)}getBuffer(e){const{feedbackBuffers:n}=this.bindings[this.currentIndex],r=e?n[e]:null;return r?r instanceof ji?r:r.buffer:null}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{varyingName:n}=e,r=this.getBuffer(n);return r?r.getData():null}delete(){for(const e in this.resources)this.resources[e].delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupBuffers(e),this.varyings=e.varyings||Object.keys(this.bindings[this.currentIndex].feedbackBuffers),this.varyings.length>0&&Nn(Hr(this.gl))}_getFeedbackBuffers(e){const{sourceBuffers:n={}}=e,r={};if(this.bindings[this.currentIndex]&&Object.assign(r,this.bindings[this.currentIndex].feedbackBuffers),this.feedbackMap)for(const i in this.feedbackMap){const o=this.feedbackMap[i];i in n&&(r[o]=i)}Object.assign(r,e.feedbackBuffers);for(const i in r){const o=r[i];if(typeof o=="string"){const a=n[o],{byteLength:s,usage:u,accessor:d}=a;r[i]=this._createNewBuffer(i,{byteLength:s,usage:u,accessor:d})}}return r}_setupBuffers(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n=null}=e;Object.assign(this.feedbackMap,e.feedbackMap);const r=this._getFeedbackBuffers(e);this._updateBindings({sourceBuffers:n,feedbackBuffers:r})}_setupTransformFeedback(e,n){let{model:r}=n;const{program:i}=r;e.transformFeedback=new E5(this.gl,{program:i,buffers:e.feedbackBuffers})}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this.feedbackMap){const{sourceBuffers:n,feedbackBuffers:r}=this._swapBuffers(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceBuffers:n,feedbackBuffers:r})}}_updateBinding(e,n){return e?(Object.assign(e.sourceBuffers,n.sourceBuffers),Object.assign(e.feedbackBuffers,n.feedbackBuffers),e.transformFeedback&&e.transformFeedback.setBuffers(e.feedbackBuffers),e):{sourceBuffers:Object.assign({},n.sourceBuffers),feedbackBuffers:Object.assign({},n.feedbackBuffers)}}_swapBuffers(e){if(!this.feedbackMap)return null;const n=Object.assign({},e.sourceBuffers),r=Object.assign({},e.feedbackBuffers);for(const i in this.feedbackMap){const o=this.feedbackMap[i];n[i]=e.feedbackBuffers[o],r[o]=e.sourceBuffers[i],Nn(r[o]instanceof ji)}return{sourceBuffers:n,feedbackBuffers:r}}_createNewBuffer(e,n){const r=new ji(this.gl,n);return this.resources[e]&&this.resources[e].delete(),this.resources[e]=r,r}_getNextIndex(){return(this.currentIndex+1)%2}}const Zwe="transform_uSampler_",lI="transform_uSize_",N$="transform_position";function Ywe(t){let{vs:e,sourceTextureMap:n,targetTextureVarying:r,targetTexture:i}=t,a=Object.keys(n).length,s=null;const u={};let d=e,g={};if(a>0||r){const _=d.split(`
`),E=_.slice();if(_.forEach((P,O,D)=>{if(a>0){const V=tEe(P,n);if(V){const{updatedLine:k,inject:F}=V;E[O]=k,g=UF([g,F]),Object.assign(u,V.samplerTextureMap),a--}}r&&!s&&(s=eEe(P,r))}),r){Nn(i);const P="".concat(lI).concat(r),O="uniform vec2 ".concat(P,`;
`),D="     vec2 ".concat(N$," = transform_getPos(").concat(P,`);
     gl_Position = vec4(`).concat(N$,`, 0, 1.);
`);g=UF([g,{"vs:#decl":O,"vs:#main-start":D}])}d=E.join(`
`)}return{vs:d,targetTextureType:s,inject:g,samplerTextureMap:u}}function Qwe(t){let{sourceTextureMap:e,targetTextureVarying:n,targetTexture:r}=t;const i={};let o,a;n&&({width:o,height:a}=r,i["".concat(lI).concat(n)]=[o,a]);for(const s in e)({width:o,height:a}=e[s]),i["".concat(lI).concat(s)]=[o,a];return i}function Kwe(t){return Ote(t,["attribute","in"])}function Jwe(t){const e="".concat(Zwe).concat(t),n="".concat(lI).concat(t),r="  uniform sampler2D ".concat(e,`;
  uniform vec2 `).concat(n,";");return{samplerName:e,sizeName:n,uniformDeclerations:r}}function eEe(t,e){const n=Ote(t,["varying","out"]);return n&&n.name===e?n.type:null}function tEe(t,e){const n={},r=Kwe(t);if(!r)return null;const{type:i,name:o}=r;if(o&&e[o]){const a="// ".concat(t," => Replaced by Transform with a sampler"),{samplerName:s,sizeName:u,uniformDeclerations:d}=Jwe(o),g=Txe(i),_="  ".concat(i," ").concat(o," = transform_getInput(").concat(s,", ").concat(u,").").concat(g,`;
`);return n[s]=o,{updatedLine:a,inject:{"vs:#decl":d,"vs:#main-start":_},samplerTextureMap:n}}return null}const nEe={10241:9728,10240:9728,10242:33071,10243:33071},rEe="transform_output";class iEe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.id=this.currentIndex=0,this._swapTexture=null,this.targetTextureVarying=null,this.targetTextureType=null,this.samplerTextureMap=null,this.bindings=[],this.resources={},this._initialize(n),Object.seal(this)}updateModelProps(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=this._processVertexShader(e);return Object.assign({},e,n)}getDrawOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,sourceTextures:r,framebuffer:i,targetTexture:o}=this.bindings[this.currentIndex],a=Object.assign({},n,e.attributes),s=Object.assign({},e.uniforms),u=Object.assign({},e.parameters);let d=e.discard;if(this.hasSourceTextures||this.hasTargetTexture){a.transform_elementID=this.elementIDBuffer;for(const _ in this.samplerTextureMap){const E=this.samplerTextureMap[_];s[_]=r[E]}this._setSourceTextureParameters();const g=Qwe({sourceTextureMap:r,targetTextureVarying:this.targetTextureVarying,targetTexture:o});Object.assign(s,g)}return this.hasTargetTexture&&(d=!1,u.viewport=[0,0,i.width,i.height]),{attributes:a,framebuffer:i,uniforms:s,discard:d,parameters:u}}swap(){return this._swapTexture?(this.currentIndex=this._getNextIndex(),!0):!1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setupTextures(e)}getTargetTexture(){const{targetTexture:e}=this.bindings[this.currentIndex];return e}getData(){let{packed:e=!1}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{framebuffer:n}=this.bindings[this.currentIndex],r=NE(n);if(!e)return r;const i=r.constructor,o=Cxe(this.targetTextureType),a=new i(r.length*o/4);let s=0;for(let u=0;u<r.length;u+=4)for(let d=0;d<o;d++)a[s++]=r[u+d];return a}getFramebuffer(){return this.bindings[this.currentIndex].framebuffer}delete(){this.ownTexture&&this.ownTexture.delete(),this.elementIDBuffer&&this.elementIDBuffer.delete()}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{_targetTextureVarying:n,_swapTexture:r}=e;this._swapTexture=r,this.targetTextureVarying=n,this.hasTargetTexture=n,this._setupTextures(e)}_createTargetTexture(e){const{sourceTextures:n,textureOrReference:r}=e;if(r instanceof Pl)return r;const i=n[r];return i?(this._targetRefTexName=r,this._createNewTexture(i)):null}_setupTextures(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceBuffers:n,_sourceTextures:r={},_targetTexture:i}=e,o=this._createTargetTexture({sourceTextures:r,textureOrReference:i});this.hasSourceTextures=this.hasSourceTextures||r&&Object.keys(r).length>0,this._updateBindings({sourceBuffers:n,sourceTextures:r,targetTexture:o}),"elementCount"in e&&this._updateElementIDBuffer(e.elementCount)}_updateElementIDBuffer(e){if(typeof e!="number"||this.elementCount>=e)return;const n=new Float32Array(e);n.forEach((r,i,o)=>{o[i]=i}),this.elementIDBuffer?this.elementIDBuffer.setData({data:n}):this.elementIDBuffer=new ji(this.gl,{data:n,accessor:{size:1}}),this.elementCount=e}_updateBindings(e){if(this.bindings[this.currentIndex]=this._updateBinding(this.bindings[this.currentIndex],e),this._swapTexture){const{sourceTextures:n,targetTexture:r}=this._swapTextures(this.bindings[this.currentIndex]),i=this._getNextIndex();this.bindings[i]=this._updateBinding(this.bindings[i],{sourceTextures:n,targetTexture:r})}}_updateBinding(e,n){const{sourceBuffers:r,sourceTextures:i,targetTexture:o}=n;if(e||(e={sourceBuffers:{},sourceTextures:{},targetTexture:null}),Object.assign(e.sourceTextures,i),Object.assign(e.sourceBuffers,r),o){e.targetTexture=o;const{width:a,height:s}=o,{framebuffer:u}=e;u?(u.update({attachments:{36064:o},resizeAttachments:!1}),u.resize({width:a,height:s})):e.framebuffer=new Ws(this.gl,{id:"transform-framebuffer",width:a,height:s,attachments:{36064:o}})}return e}_setSourceTextureParameters(){const e=this.currentIndex,{sourceTextures:n}=this.bindings[e];for(const r in n)n[r].setParameters(nEe)}_swapTextures(e){if(!this._swapTexture)return null;const n=Object.assign({},e.sourceTextures);n[this._swapTexture]=e.targetTexture;const r=e.sourceTextures[this._swapTexture];return{sourceTextures:n,targetTexture:r}}_createNewTexture(e){const n=yte(e,{parameters:{10241:9728,10240:9728,10242:33071,10243:33071},pixelStore:{37440:!1}});return this.ownTexture&&this.ownTexture.delete(),this.ownTexture=n,n}_getNextIndex(){return(this.currentIndex+1)%2}_processVertexShader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{sourceTextures:n,targetTexture:r}=this.bindings[this.currentIndex],{vs:i,uniforms:o,targetTextureType:a,inject:s,samplerTextureMap:u}=Ywe({vs:e.vs,sourceTextureMap:n,targetTextureVarying:this.targetTextureVarying,targetTexture:r}),d=UF([e.inject||{},s]);this.targetTextureType=a,this.samplerTextureMap=u;const g=e._fs||Rte({version:xte(i),input:this.targetTextureVarying,inputType:a,output:rEe}),_=this.hasSourceTextures||this.targetTextureVarying?[Uwe].concat(e.modules||[]):e.modules;return{vs:i,fs:g,modules:_,uniforms:o,inject:d}}}class qO{static isSupported(e){return Hr(e)}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.model=null,this.elementCount=0,this.bufferTransform=null,this.textureTransform=null,this.elementIDBuffer=null,this._initialize(n),Object.seal(this)}delete(){const{model:e,bufferTransform:n,textureTransform:r}=this;e&&e.delete(),n&&n.delete(),r&&r.delete()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{clearRenderTarget:n=!0}=e,r=this._updateDrawOptions(e);n&&r.framebuffer&&r.framebuffer.clear({color:!0}),this.model.transform(r)}swap(){let e=!1;const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)e=e||r.swap();Nn(e,"Nothing to swap")}getBuffer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return this.bufferTransform&&this.bufferTransform.getBuffer(e)}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n){const i=r.getData(e);if(i)return i}return null}getFramebuffer(){return this.textureTransform&&this.textureTransform.getFramebuffer()}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};"elementCount"in e&&this.model.setVertexCount(e.elementCount);const n=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const r of n)r.update(e)}_initialize(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{gl:n}=this;this._buildResourceTransforms(n,e),e=this._updateModelProps(e),this.model=new Oa(n,Object.assign({},e,{fs:e.fs||Rte({version:xte(e.vs)}),id:e.id||"transform-model",drawMode:e.drawMode||0,vertexCount:e.elementCount})),this.bufferTransform&&this.bufferTransform.setupResources({model:this.model})}_updateModelProps(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=i.updateModelProps(n);return n}_buildResourceTransforms(e,n){oEe(n)&&(this.bufferTransform=new Xwe(e,n)),sEe(n)&&(this.textureTransform=new iEe(e,n)),Nn(this.bufferTransform||this.textureTransform,"must provide source/feedback buffers or source/target textures")}_updateDrawOptions(e){let n=Object.assign({},e);const r=[this.bufferTransform,this.textureTransform].filter(Boolean);for(const i of r)n=Object.assign(n,i.getDrawOptions(n));return n}}function oEe(t){return!!(!Fv(t.feedbackBuffers)||!Fv(t.feedbackMap)||t.varyings&&t.varyings.length>0)}function sEe(t){return!!(!Fv(t._sourceTextures)||t._targetTexture||t._targetTextureVarying)}const F$={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6};let Cs=class{static get DRAW_MODE(){return F$}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Ma("geometry"),drawMode:r=F$.TRIANGLES,attributes:i={},indices:o=null,vertexCount:a=null}=e;this.id=n,this.drawMode=r|0,this.attributes={},this.userData={},this._setAttributes(i,o),this.vertexCount=a||this._calculateVertexCount(this.attributes,this.indices)}get mode(){return this.drawMode}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return"Geometry ".concat(this.id," attribute ").concat(e)}_setAttributes(e,n){n&&(this.indices=ArrayBuffer.isView(n)?{value:n,size:1}:n);for(const r in e){let i=e[r];i=ArrayBuffer.isView(i)?{value:i}:i,Nn(ArrayBuffer.isView(i.value),"".concat(this._print(r),": must be typed array or object with value as typed array")),(r==="POSITION"||r==="positions")&&!i.size&&(i.size=3),r==="indices"?(Nn(!this.indices),this.indices=i):this.attributes[r]=i}return this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this}_calculateVertexCount(e,n){if(n)return n.value.length;let r=1/0;for(const i in e){const o=e[i],{value:a,size:s,constant:u}=o;!u&&a&&s>=1&&(r=Math.min(r,a.length/s))}return Nn(Number.isFinite(r)),r}};const aEe={x:[2,0,1],y:[0,1,2],z:[1,2,0]};class N5 extends Cs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Ma("truncated-code-geometry")}=e,{indices:r,attributes:i}=lEe(e);super({...e,id:n,indices:r,attributes:{...i,...e.attributes}})}}function lEe(t){const{bottomRadius:e=0,topRadius:n=0,height:r=1,nradial:i=10,nvertical:o=10,verticalAxis:a="y",topCap:s=!1,bottomCap:u=!1}=t,d=(s?2:0)+(u?2:0),g=(i+1)*(o+1+d),_=Math.atan2(e-n,r),E=Math.sin,P=Math.cos,O=Math.PI,D=P(_),V=E(_),k=s?-2:0,F=o+(u?2:0),z=i+1,X=new Uint16Array(i*(o+d)*6),Y=aEe[a],J=new Float32Array(g*3),re=new Float32Array(g*3),ue=new Float32Array(g*2);let ie=0,ce=0;for(let se=k;se<=F;se++){let me=se/o,Ce=r*me,we;se<0?(Ce=0,me=1,we=e):se>o?(Ce=r,me=1,we=n):we=e+(n-e)*(se/o),(se===-2||se===o+2)&&(we=0,me=0),Ce-=r/2;for(let Ye=0;Ye<z;Ye++){const at=E(Ye*O*2/i),yt=P(Ye*O*2/i);J[ie+Y[0]]=at*we,J[ie+Y[1]]=Ce,J[ie+Y[2]]=yt*we,re[ie+Y[0]]=se<0||se>o?0:at*D,re[ie+Y[1]]=se<0?-1:se>o?1:V,re[ie+Y[2]]=se<0||se>o?0:yt*D,ue[ce+0]=Ye/i,ue[ce+1]=me,ce+=2,ie+=3}}for(let se=0;se<o+d;se++)for(let me=0;me<i;me++){const Ce=(se*i+me)*6;X[Ce+0]=z*(se+0)+0+me,X[Ce+1]=z*(se+0)+1+me,X[Ce+2]=z*(se+1)+1+me,X[Ce+3]=z*(se+0)+0+me,X[Ce+4]=z*(se+1)+1+me,X[Ce+5]=z*(se+1)+0+me}return{indices:X,attributes:{POSITION:{size:3,value:J},NORMAL:{size:3,value:re},TEXCOORD_0:{size:2,value:ue}}}}class uEe extends N5{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Ma("cone-geometry"),radius:r=1,cap:i=!0}=e;super({...e,id:n,topRadius:0,topCap:!!i,bottomCap:!!i,bottomRadius:r})}}const cEe=new Uint16Array([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),fEe=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),hEe=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0]),dEe=new Float32Array([0,0,1,0,1,1,0,1,1,0,1,1,0,1,0,0,0,1,0,0,1,0,1,1,1,1,0,1,0,0,1,0,1,0,1,1,0,1,0,0,0,0,1,0,1,1,0,1]),pEe={POSITION:{size:3,value:new Float32Array(fEe)},NORMAL:{size:3,value:new Float32Array(hEe)},TEXCOORD_0:{size:2,value:new Float32Array(dEe)}};class une extends Cs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Ma("cube-geometry")}=e;super({...e,id:n,indices:{size:1,value:new Uint16Array(cEe)},attributes:{...pEe,...e.attributes}})}}class gEe extends N5{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Ma("cylinder-geometry"),radius:r=1}=e;super({...e,id:n,bottomRadius:r,topRadius:r})}}const mEe=[-1,0,0,0,1,0,0,0,-1,0,0,1,0,-1,0,1,0,0],AEe=[3,4,5,3,5,1,3,1,0,3,0,4,4,0,2,4,2,5,2,0,1,5,2,1];class _Ee extends Cs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Ma("ico-sphere-geometry")}=e,{indices:r,attributes:i}=yEe(e);super({...e,id:n,indices:r,attributes:{...i,...e.attributes}})}}function yEe(t){const{iterations:e=0}=t,n=Math.PI,r=n*2,i=[...mEe];let o=[...AEe];i.push(),o.push();const a=(()=>{const g={};return(_,E)=>{_*=3,E*=3;const P=_<E?_:E,O=_>E?_:E,D="".concat(P,"|").concat(O);if(D in g)return g[D];const V=i[_],k=i[_+1],F=i[_+2],z=i[E],X=i[E+1],Y=i[E+2];let J=(V+z)/2,re=(k+X)/2,ue=(F+Y)/2;const ie=Math.sqrt(J*J+re*re+ue*ue);return J/=ie,re/=ie,ue/=ie,i.push(J,re,ue),g[D]=i.length/3-1}})();for(let g=0;g<e;g++){const _=[];for(let E=0;E<o.length;E+=3){const P=a(o[E+0],o[E+1]),O=a(o[E+1],o[E+2]),D=a(o[E+2],o[E+0]);_.push(D,o[E+0],P,P,o[E+1],O,O,o[E+2],D,P,O,D)}o=_}const s=new Array(i.length),u=new Array(i.length/3*2),d=o.length;for(let g=d-3;g>=0;g-=3){const _=o[g+0],E=o[g+1],P=o[g+2],O=_*3,D=E*3,V=P*3,k=_*2,F=E*2,z=P*2,X=i[O+0],Y=i[O+1],J=i[O+2],re=Math.acos(J/Math.sqrt(X*X+Y*Y+J*J)),ue=Math.atan2(Y,X)+n,ie=re/n,ce=1-ue/r,se=i[D+0],me=i[D+1],Ce=i[D+2],we=Math.acos(Ce/Math.sqrt(se*se+me*me+Ce*Ce)),Ye=Math.atan2(me,se)+n,at=we/n,yt=1-Ye/r,be=i[V+0],De=i[V+1],Re=i[V+2],qe=Math.acos(Re/Math.sqrt(be*be+De*De+Re*Re)),ct=Math.atan2(De,be)+n,Ct=qe/n,Dt=1-ct/r,In=[be-se,De-me,Re-Ce],Mn=[X-se,Y-me,J-Ce],Tn=new _t(In).cross(Mn).normalize();let Nt;(ce===0||yt===0||Dt===0)&&(ce===0||ce>.5)&&(yt===0||yt>.5)&&(Dt===0||Dt>.5)&&(i.push(i[O+0],i[O+1],i[O+2]),Nt=i.length/3-1,o.push(Nt),u[Nt*2+0]=1,u[Nt*2+1]=ie,s[Nt*3+0]=Tn.x,s[Nt*3+1]=Tn.y,s[Nt*3+2]=Tn.z,i.push(i[D+0],i[D+1],i[D+2]),Nt=i.length/3-1,o.push(Nt),u[Nt*2+0]=1,u[Nt*2+1]=at,s[Nt*3+0]=Tn.x,s[Nt*3+1]=Tn.y,s[Nt*3+2]=Tn.z,i.push(i[V+0],i[V+1],i[V+2]),Nt=i.length/3-1,o.push(Nt),u[Nt*2+0]=1,u[Nt*2+1]=Ct,s[Nt*3+0]=Tn.x,s[Nt*3+1]=Tn.y,s[Nt*3+2]=Tn.z),s[O+0]=s[D+0]=s[V+0]=Tn.x,s[O+1]=s[D+1]=s[V+1]=Tn.y,s[O+2]=s[D+2]=s[V+2]=Tn.z,u[k+0]=ce,u[k+1]=ie,u[F+0]=yt,u[F+1]=at,u[z+0]=Dt,u[z+1]=Ct}return{indices:{size:1,value:new Uint16Array(o)},attributes:{POSITION:{size:3,value:new Float32Array(i)},NORMAL:{size:3,value:new Float32Array(s)},TEXCOORD_0:{size:2,value:new Float32Array(u)}}}}function vEe(t){const{indices:e,attributes:n}=t;if(!e)return t;const r=e.value.length,i={};for(const o in n){const a=n[o],{constant:s,value:u,size:d}=a;if(s||!d)continue;const g=new u.constructor(r*d);for(let _=0;_<r;++_){const E=e.value[_];for(let P=0;P<d;P++)g[_*d+P]=u[E*d+P]}i[o]={size:d,value:g}}return{attributes:Object.assign({},n,i)}}class xEe extends Cs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Ma("plane-geometry")}=e,{indices:r,attributes:i}=bEe(e);super({...e,id:n,indices:r,attributes:{...i,...e.attributes}})}}function bEe(t){const{type:e="x,y",offset:n=0,flipCull:r=!1,unpack:i=!1}=t,o=e.split(",");let a=t["".concat(o[0],"len")]||1;const s=t["".concat(o[1],"len")]||1,u=t["n".concat(o[0])]||1,d=t["n".concat(o[1])]||1,g=(u+1)*(d+1),_=new Float32Array(g*3),E=new Float32Array(g*3),P=new Float32Array(g*2);r&&(a=-a);let O=0,D=0;for(let z=0;z<=d;z++)for(let X=0;X<=u;X++){const Y=X/u,J=z/d;switch(P[O+0]=r?1-Y:Y,P[O+1]=J,e){case"x,y":_[D+0]=a*Y-a*.5,_[D+1]=s*J-s*.5,_[D+2]=n,E[D+0]=0,E[D+1]=0,E[D+2]=r?1:-1;break;case"x,z":_[D+0]=a*Y-a*.5,_[D+1]=n,_[D+2]=s*J-s*.5,E[D+0]=0,E[D+1]=r?1:-1,E[D+2]=0;break;case"y,z":_[D+0]=n,_[D+1]=a*Y-a*.5,_[D+2]=s*J-s*.5,E[D+0]=r?1:-1,E[D+1]=0,E[D+2]=0;break;default:throw new Error("PlaneGeometry: unknown type")}O+=2,D+=3}const V=u+1,k=new Uint16Array(u*d*6);for(let z=0;z<d;z++)for(let X=0;X<u;X++){const Y=(z*u+X)*6;k[Y+0]=(z+0)*V+X,k[Y+1]=(z+1)*V+X,k[Y+2]=(z+0)*V+X+1,k[Y+3]=(z+1)*V+X,k[Y+4]=(z+1)*V+X+1,k[Y+5]=(z+0)*V+X+1}const F={indices:{size:1,value:k},attributes:{POSITION:{size:3,value:_},NORMAL:{size:3,value:E},TEXCOORD_0:{size:2,value:P}}};return i?vEe(F):F}class wEe extends Cs{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n=Ma("sphere-geometry")}=e,{indices:r,attributes:i}=EEe(e);super({...e,id:n,indices:r,attributes:{...i,...e.attributes}})}}function EEe(t){const{nlat:e=10,nlong:n=10}=t;let{radius:r=1}=t;const a=Math.PI-0,s=0,d=2*Math.PI-s,g=(e+1)*(n+1);if(typeof r=="number"){const k=r;r=(F,z,X,Y,J)=>k}const _=new Float32Array(g*3),E=new Float32Array(g*3),P=new Float32Array(g*2),O=g>65535?Uint32Array:Uint16Array,D=new O(e*n*6);for(let k=0;k<=e;k++)for(let F=0;F<=n;F++){const z=F/n,X=k/e,Y=F+k*(n+1),J=Y*2,re=Y*3,ue=d*z,ie=a*X,ce=Math.sin(ue),se=Math.cos(ue),me=Math.sin(ie),Ce=Math.cos(ie),we=se*me,Ye=Ce,at=ce*me,yt=r(we,Ye,at,z,X);_[re+0]=yt*we,_[re+1]=yt*Ye,_[re+2]=yt*at,E[re+0]=we,E[re+1]=Ye,E[re+2]=at,P[J+0]=z,P[J+1]=1-X}const V=n+1;for(let k=0;k<n;k++)for(let F=0;F<e;F++){const z=(k*e+F)*6;D[z+0]=F*V+k,D[z+1]=F*V+k+1,D[z+2]=(F+1)*V+k,D[z+3]=(F+1)*V+k,D[z+4]=F*V+k+1,D[z+5]=(F+1)*V+k+1}return{indices:{size:1,value:D},attributes:{POSITION:{size:3,value:_},NORMAL:{size:3,value:E},TEXCOORD_0:{size:2,value:P}}}}let SEe=1,TEe=1;class F5{constructor(){this.time=0,this.channels=new Map,this.animations=new Map,this.playing=!1,this.lastEngineTime=-1}addChannel(e){const{delay:n=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:o=1}=e,a=SEe++,s={time:0,delay:n,duration:r,rate:i,repeat:o};return this._setChannelTime(s,this.time),this.channels.set(a,s),a}removeChannel(e){this.channels.delete(e);for(const[n,r]of this.animations)r.channel===e&&this.detachAnimation(n)}isFinished(e){const n=this.channels.get(e);return n===void 0?!1:this.time>=n.delay+n.duration*n.repeat}getTime(e){if(e===void 0)return this.time;const n=this.channels.get(e);return n===void 0?-1:n.time}setTime(e){this.time=Math.max(0,e);const n=this.channels.values();for(const i of n)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:o,channel:a}=i;o.setTime(this.getTime(a))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,n){const r=TEe++;return this.animations.set(r,{animation:e,channel:n}),e.setTime(this.getTime(n)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,n){const r=n-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}const CEe=`attribute vec2 aClipSpacePosition;
attribute vec2 aTexCoord;
attribute vec2 aCoordinate;

varying vec2 position;
varying vec2 coordinate;
varying vec2 uv;

void main(void) {
  gl_Position = vec4(aClipSpacePosition, 0., 1.);
  position = aClipSpacePosition;
  coordinate = aCoordinate;
  uv = aTexCoord;
}
`,k$=[-1,-1,1,-1,-1,1,1,1];class cne extends Oa{constructor(e,n){const r=k$.map(i=>i===-1?0:i);super(e,Object.assign({},n,{vs:CEe,geometry:new Cs({drawMode:5,vertexCount:4,attributes:{aClipSpacePosition:{size:2,value:new Float32Array(k$)},aTexCoord:{size:2,value:new Float32Array(r)},aCoordinate:{size:2,value:new Float32Array(r)}}})})),this.setVertexCount(4)}}const PEe=Object.freeze(Object.defineProperty({__proto__:null,AnimationLoop:wte,Buffer:ji,ClipSpace:cne,ConeGeometry:uEe,CubeGeometry:une,CylinderGeometry:gEe,FEATURES:Qi,FragmentShader:lC,Framebuffer:Ws,Geometry:Cs,IcoSphereGeometry:_Ee,Model:Oa,PlaneGeometry:xEe,Program:w5,ProgramManager:B1,Renderbuffer:E0,SphereGeometry:wEe,Texture2D:Pl,Texture3D:dte,TextureCube:v5,Timeline:F5,Transform:qO,TransformFeedback:E5,TruncatedConeGeometry:N5,VertexShader:aC,assert:Nn,clear:BE,cloneTextureFrom:yte,copyToTexture:mte,createGLContext:A5,cssToDevicePixels:oC,cssToDeviceRatio:B0,dirlight:Iwe,fp32:Lte,fp64:Bxe,getParameters:ste,gouraudLighting:zE,hasFeature:FE,hasFeatures:UO,instrumentGLContext:zO,isWebGL:LE,isWebGL2:Hr,log:Yn,lumaStats:Im,normalizeShaderModule:Ete,pbr:WO,phongLighting:HO,picking:sne,project:ine,readPixelsToArray:NE,readPixelsToBuffer:pve,resetParameters:ate,setParameters:bh,uid:Ma,withParameters:Mu},Symbol.toStringTag,{value:"Module"})),IEe=[255,255,255],MEe=1;let OEe=0;class fne{constructor(e={}){q(this,"id",void 0),q(this,"color",void 0),q(this,"intensity",void 0),q(this,"type","ambient");const{color:n=IEe}=e,{intensity:r=MEe}=e;this.id=e.id||"ambient-".concat(OEe++),this.color=n,this.intensity=r}}const REe=[255,255,255],LEe=1,DEe=[0,0,-1];let BEe=0;class uI{constructor(e={}){q(this,"id",void 0),q(this,"color",void 0),q(this,"intensity",void 0),q(this,"type","directional"),q(this,"direction",void 0),q(this,"shadow",void 0);const{color:n=REe}=e,{intensity:r=LEe}=e,{direction:i=DEe}=e,{_shadow:o=!1}=e;this.id=e.id||"directional-".concat(BEe++),this.color=n,this.intensity=r,this.type="directional",this.direction=new _t(i).normalize().toArray(),this.shadow=o}getProjectedLight(e){return this}}class hne{constructor(e,n={id:"pass"}){q(this,"id",void 0),q(this,"gl",void 0),q(this,"props",void 0);const{id:r}=n;this.id=r,this.gl=e,this.props={...n}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class XO extends hne{constructor(...e){super(...e),q(this,"_lastRenderIndex",-1)}render(e){const n=this.gl;return bh(n,{framebuffer:e.target}),this._drawLayers(e)}_drawLayers(e){const{target:n,moduleParameters:r,viewports:i,views:o,onViewportActive:a,clearStack:s=!0,clearCanvas:u=!0}=e;e.pass=e.pass||"unknown";const d=this.gl;u&&FEe(d,n),s&&(this._lastRenderIndex=-1);const g=[];for(const _ of i){const E=o&&o[_.id];a==null||a(_);const P=this._getDrawLayerParams(_,e),O=_.subViewports||[_];for(const D of O){const V=this._drawLayersInViewport(d,{target:n,moduleParameters:r,viewport:D,view:E,pass:e.pass,layers:e.layers},P);g.push(V)}}return g}_getDrawLayerParams(e,{layers:n,pass:r,isPicking:i=!1,layerFilter:o,cullRect:a,effects:s,moduleParameters:u},d=!1){const g=[],_=dne(this._lastRenderIndex+1),E={layer:n[0],viewport:e,isPicking:i,renderPass:r,cullRect:a},P={};for(let O=0;O<n.length;O++){const D=n[O],V=this._shouldDrawLayer(D,E,o,P),k={shouldDrawLayer:V};V&&!d&&(k.layerRenderIndex=_(D,V),k.moduleParameters=this._getModuleParameters(D,s,r,u),k.layerParameters=this.getLayerParameters(D,O,e)),g[O]=k}return g}_drawLayersInViewport(e,{layers:n,moduleParameters:r,pass:i,target:o,viewport:a,view:s},u){const d=NEe(e,{moduleParameters:r,target:o,viewport:a});if(s&&s.props.clear){const _=s.props.clear===!0?{color:!0,depth:!0}:s.props.clear;Mu(e,{scissorTest:!0,scissor:d},()=>BE(e,_))}const g={totalCount:n.length,visibleCount:0,compositeCount:0,pickableCount:0};bh(e,{viewport:d});for(let _=0;_<n.length;_++){const E=n[_],{shouldDrawLayer:P,layerRenderIndex:O,moduleParameters:D,layerParameters:V}=u[_];if(P&&E.props.pickable&&g.pickableCount++,E.isComposite)g.compositeCount++;else if(P){g.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,O),D.viewport=a;try{E._drawLayer({moduleParameters:D,uniforms:{layerIndex:O},parameters:V})}catch(k){E.raiseError(k,"drawing ".concat(E," to ").concat(i))}}}return g}shouldDrawLayer(e){return!0}getModuleParameters(e,n){return null}getLayerParameters(e,n,r){return e.props.parameters}_shouldDrawLayer(e,n,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;n.layer=e;let a=e.parent;for(;a;){if(!a.props.visible||!a.filterSubLayer(n))return!1;n.layer=a,a=a.parent}if(r){const s=n.layer.id;if(s in i||(i[s]=r(n)),!i[s])return!1}return e.activateViewport(n.viewport),!0}_getModuleParameters(e,n,r,i){var o;const a=Object.assign(Object.create(((o=e.internalState)===null||o===void 0?void 0:o.propsInTransition)||e.props),{autoWrapLongitude:e.wrapLongitude,viewport:e.context.viewport,mousePosition:e.context.mousePosition,pickingActive:0,devicePixelRatio:B0(this.gl)});if(n)for(const u of n){var s;Object.assign(a,(s=u.getModuleParameters)===null||s===void 0?void 0:s.call(u,e))}return Object.assign(a,this.getModuleParameters(e,n),i)}}function dne(t=0,e={}){const n={},r=(i,o)=>{const a=i.props._offset,s=i.id,u=i.parent&&i.parent.id;let d;if(u&&!(u in e)&&r(i.parent,!1),u in n){const g=n[u]=n[u]||dne(e[u],e);d=g(i,o),n[s]=g}else Number.isFinite(a)?(d=a+(e[u]||0),n[s]=null):d=t;return o&&d>=t&&(t=d+1),e[s]=d,d};return r}function NEe(t,{moduleParameters:e,target:n,viewport:r}){const i=n&&n.id!=="default-framebuffer",o=e&&e.devicePixelRatio||B0(t),a=i?n.height:t.drawingBufferHeight,s=r;return[s.x*o,a-(s.y+s.height)*o,s.width*o,s.height*o]}function FEe(t,e){const n=e?e.width:t.drawingBufferWidth,r=e?e.height:t.drawingBufferHeight;bh(t,{viewport:[0,0,n,r]}),t.clear(16640)}class kEe extends XO{constructor(e,n){super(e,n),q(this,"shadowMap",void 0),q(this,"depthBuffer",void 0),q(this,"fbo",void 0),this.shadowMap=new Pl(e,{width:1,height:1,parameters:{10241:9729,10240:9729,10242:33071,10243:33071}}),this.depthBuffer=new E0(e,{format:33189,width:1,height:1}),this.fbo=new Ws(e,{id:"shadowmap",width:1,height:1,attachments:{36064:this.shadowMap,36096:this.depthBuffer}})}render(e){const n=this.fbo;Mu(this.gl,{depthRange:[0,1],depthTest:!0,blend:!1,clearColor:[1,1,1,1]},()=>{const r=e.viewports[0],i=B0(this.gl),o=r.width*i,a=r.height*i;(o!==n.width||a!==n.height)&&n.resize({width:o,height:a}),super.render({...e,target:n,pass:"shadow"})})}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getModuleParameters(){return{drawToShadowMap:!0}}delete(){this.fbo&&(this.fbo.delete(),this.fbo=null),this.shadowMap&&(this.shadowMap.delete(),this.shadowMap=null),this.depthBuffer&&(this.depthBuffer.delete(),this.depthBuffer=null)}}const pne="#define SMOOTH_EDGE_RADIUS 0.5",zEe=`
`.concat(pne,`

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`),UEe=`
`.concat(pne,`

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`),GEe={name:"geometry",vs:zEe,fs:UEe},jEe=Object.keys(Br).map(t=>"const int COORDINATE_SYSTEM_".concat(t," = ").concat(Br[t],";")).join(""),VEe=Object.keys(hh).map(t=>"const int PROJECTION_MODE_".concat(t," = ").concat(hh[t],";")).join(""),$Ee=Object.keys(Bu).map(t=>"const int UNIT_".concat(t.toUpperCase()," = ").concat(Bu[t],";")).join(""),HEe="".concat(jEe,`
`).concat(VEe,`
`).concat($Ee,`

uniform int project_uCoordinateSystem;
uniform int project_uProjectionMode;
uniform float project_uScale;
uniform bool project_uWrapLongitude;
uniform vec3 project_uCommonUnitsPerMeter;
uniform vec3 project_uCommonUnitsPerWorldUnit;
uniform vec3 project_uCommonUnitsPerWorldUnit2;
uniform vec4 project_uCenter;
uniform mat4 project_uModelMatrix;
uniform mat4 project_uViewProjectionMatrix;
uniform vec2 project_uViewportSize;
uniform float project_uDevicePixelRatio;
uniform float project_uFocalDistance;
uniform vec3 project_uCameraPosition;
uniform vec3 project_uCoordinateOrigin;
uniform vec3 project_uCommonOrigin;
uniform bool project_uPseudoMeters;

const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
  float y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

float project_size() {
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR &&
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
    project_uPseudoMeters == false) {
    
    if (geometry.position.w == 0.0) {
      return project_size_at_latitude(geometry.worldPosition.y);
    }
  
    float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    float y2 = y * y;
    float y4 = y2 * y2;
    float y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

float project_size_at_latitude(float meters, float lat) {
  return meters * project_uCommonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
  return meters * project_uCommonUnitsPerMeter.z * project_size();
}

vec2 project_size(vec2 meters) {
  return meters * project_uCommonUnitsPerMeter.xy * project_size();
}

vec3 project_size(vec3 meters) {
  return meters * project_uCommonUnitsPerMeter * project_size();
}

vec4 project_size(vec4 meters) {
  return vec4(meters.xyz * project_uCommonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
  vec3 uz = normalize(up);
  vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
  vec3 uy = cross(uz, ux);
  return mat3(ux, uy, uz);
}

bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    transform = project_get_orientation_matrix(commonPosition);
    return true;
  }
  return false;
}
vec3 project_normal(vec3 vector) {
  vec4 normal_modelspace = project_uModelMatrix * vec4(vector, 0.0);
  vec3 n = normalize(normal_modelspace.xyz * project_uCommonUnitsPerMeter);
  mat3 rotation;
  if (project_needs_rotation(geometry.position.xyz, rotation)) {
    n = rotation * n;
  }
  return n;
}

vec4 project_offset_(vec4 offset) {
  float dy = offset.y;
  vec3 commonUnitsPerWorldUnit = project_uCommonUnitsPerWorldUnit + project_uCommonUnitsPerWorldUnit2 * dy;
  return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
  float x = lnglat.x;
  if (project_uWrapLongitude) {
    x = mod(x + 180., 360.0) - 180.;
  }
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

vec3 project_globe_(vec3 lnglatz) {
  float lambda = radians(lnglatz.x);
  float phi = radians(lnglatz.y);
  float cosPhi = cos(phi);
  float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;

  return vec3(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
  vec4 position_world = project_uModelMatrix * position;
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_mercator_(position_world.xy),
        project_size_at_latitude(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world.xyz += project_uCoordinateOrigin;
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_GLOBE) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project_uCoordinateOrigin.y) > 0.25) {
        return vec4(
          project_mercator_(position_world.xy) - project_uCommonOrigin.xy,
          project_size(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project_uProjectionMode == PROJECTION_MODE_IDENTITY ||
    (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
    (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
     project_uCoordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world.xyz -= project_uCoordinateOrigin;
  }
  return project_offset_(position_world + project_uModelMatrix * vec4(position64Low, 0.0));
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_LOW);
}

vec3 project_position(vec3 position, vec3 position64Low) {
  vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
  return projected_position.xyz;
}

vec3 project_position(vec3 position) {
  vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

vec2 project_position(vec2 position) {
  vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(position, project_uViewProjectionMatrix, project_uCenter);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / project_uViewportSize * project_uDevicePixelRatio * 2.0;
  return offset * project_uFocalDistance;
}

float project_size_to_pixel(float meters) {
  return project_size(meters) * project_uScale;
}
float project_size_to_pixel(float size, int unit) {
  if (unit == UNIT_METERS) return project_size_to_pixel(size);
  if (unit == UNIT_COMMON) return size * project_uScale;
  return size;
}
float project_pixel_size(float pixels) {
  return pixels / project_uScale;
}
vec2 project_pixel_size(vec2 pixels) {
  return pixels / project_uScale;
}
`);function WEe(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}function N1(t){let e={},n;return r=>{for(const i in r)if(!WEe(r[i],e[i])){n=t(r),e=r;break}return n}}const z$=[0,0,0,0],qEe=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],gne=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],XEe=[0,0,0],mne=[0,0,0],ZEe=N1(QEe);function Ane(t,e,n=mne){n.length<3&&(n=[n[0],n[1],0]);let r=n,i,o=!0;switch(e===Br.LNGLAT_OFFSETS||e===Br.METER_OFFSETS?i=n:i=t.isGeospatial?[Math.fround(t.longitude),Math.fround(t.latitude),0]:null,t.projectionMode){case hh.WEB_MERCATOR:(e===Br.LNGLAT||e===Br.CARTESIAN)&&(i=[0,0,0],o=!1);break;case hh.WEB_MERCATOR_AUTO_OFFSET:e===Br.LNGLAT?r=i:e===Br.CARTESIAN&&(r=[Math.fround(t.center[0]),Math.fround(t.center[1]),0],i=t.unprojectPosition(r),r[0]-=n[0],r[1]-=n[1],r[2]-=n[2]);break;case hh.IDENTITY:r=t.position.map(Math.fround),r[2]=r[2]||0;break;case hh.GLOBE:o=!1,i=null;break;default:o=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:o}}function YEe(t,e,n){const{viewMatrixUncentered:r,projectionMatrix:i}=t;let{viewMatrix:o,viewProjectionMatrix:a}=t,s=z$,u=z$,d=t.cameraPosition;const{geospatialOrigin:g,shaderCoordinateOrigin:_,offsetMode:E}=Ane(t,e,n);return E&&(u=t.projectPosition(g||_),d=[d[0]-u[0],d[1]-u[1],d[2]-u[2]],u[3]=1,s=D1([],u,a),o=r||o,a=kd([],i,o),a=kd([],a,qEe)),{viewMatrix:o,viewProjectionMatrix:a,projectionCenter:s,originCommon:u,cameraPosCommon:d,shaderCoordinateOrigin:_,geospatialOrigin:g}}function _ne({viewport:t,devicePixelRatio:e=1,modelMatrix:n=null,coordinateSystem:r=Br.DEFAULT,coordinateOrigin:i=mne,autoWrapLongitude:o=!1}){r===Br.DEFAULT&&(r=t.isGeospatial?Br.LNGLAT:Br.CARTESIAN);const a=ZEe({viewport:t,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return a.project_uWrapLongitude=o,a.project_uModelMatrix=n||gne,a}function QEe({viewport:t,devicePixelRatio:e,coordinateSystem:n,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:o,originCommon:a,cameraPosCommon:s,shaderCoordinateOrigin:u,geospatialOrigin:d}=YEe(t,n,r),g=t.getDistanceScales(),_=[t.width*e,t.height*e],E=D1([],[0,0,-t.focalDistance,1],t.projectionMatrix)[3]||1,P={project_uCoordinateSystem:n,project_uProjectionMode:t.projectionMode,project_uCoordinateOrigin:u,project_uCommonOrigin:a.slice(0,3),project_uCenter:i,project_uPseudoMeters:!!t._pseudoMeters,project_uViewportSize:_,project_uDevicePixelRatio:e,project_uFocalDistance:E,project_uCommonUnitsPerMeter:g.unitsPerMeter,project_uCommonUnitsPerWorldUnit:g.unitsPerMeter,project_uCommonUnitsPerWorldUnit2:XEe,project_uScale:t.scale,project_uWrapLongitude:!1,project_uViewProjectionMatrix:o,project_uModelMatrix:gne,project_uCameraPosition:s};if(d){const O=t.getDistanceScales(d);switch(n){case Br.METER_OFFSETS:P.project_uCommonUnitsPerWorldUnit=O.unitsPerMeter,P.project_uCommonUnitsPerWorldUnit2=O.unitsPerMeter2;break;case Br.LNGLAT:case Br.LNGLAT_OFFSETS:t._pseudoMeters||(P.project_uCommonUnitsPerMeter=O.unitsPerMeter),P.project_uCommonUnitsPerWorldUnit=O.unitsPerDegree,P.project_uCommonUnitsPerWorldUnit2=O.unitsPerDegree2;break;case Br.CARTESIAN:P.project_uCommonUnitsPerWorldUnit=[1,1,O.unitsPerMeter[2]],P.project_uCommonUnitsPerWorldUnit2=[0,0,O.unitsPerMeter2[2]];break}}return P}const KEe={};function JEe(t=KEe){return"viewport"in t?_ne(t):{}}const ZO={name:"project",dependencies:[Lte,GEe],vs:HEe,getUniforms:JEe};function dC(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function yv(t,e){const n=D1([],e,t);return D5(n,n,1/n[3]),n}function U$(t,e){const n=t%e;return n<0?e+n:n}function e2e(t,e,n){return n*e+(1-n)*t}function HF(t,e,n){return t<e?e:t>n?n:t}function t2e(t){return Math.log(t)*Math.LOG2E}const k5=Math.log2||t2e;function lg(t,e){if(!t)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const dh=Math.PI,yne=dh/4,gf=dh/180,WF=180/dh,Gv=512,cI=4003e4,Yb=85.051129,vne=1.5;function fI(t){return Math.pow(2,t)}function z5(t){return k5(t)}function El(t){const[e,n]=t;lg(Number.isFinite(e)),lg(Number.isFinite(n)&&n>=-90&&n<=90,"invalid latitude");const r=e*gf,i=n*gf,o=Gv*(r+dh)/(2*dh),a=Gv*(dh+Math.log(Math.tan(yne+i*.5)))/(2*dh);return[o,a]}function gc(t){const[e,n]=t,r=e/Gv*(2*dh)-dh,i=2*(Math.atan(Math.exp(n/Gv*(2*dh)-dh))-yne);return[r*WF,i*WF]}function U5(t){const{latitude:e}=t;lg(Number.isFinite(e));const n=Math.cos(e*gf);return z5(cI*n)-9}function pC(t){const e=Math.cos(t*gf);return Gv/cI/e}function Hw(t){const{latitude:e,longitude:n,highPrecision:r=!1}=t;lg(Number.isFinite(e)&&Number.isFinite(n));const i=Gv,o=Math.cos(e*gf),a=i/360,s=a/o,u=i/cI/o,d={unitsPerMeter:[u,u,u],metersPerUnit:[1/u,1/u,1/u],unitsPerDegree:[a,s,u],degreesPerUnit:[1/a,1/s,1/u]};if(r){const g=gf*Math.tan(e*gf)/o,_=a*g/2,E=i/cI*g,P=E/s*u;d.unitsPerDegree2=[0,_,E],d.unitsPerMeter2=[P,0,P]}return d}function G5(t,e){const[n,r,i]=t,[o,a,s]=e,{unitsPerMeter:u,unitsPerMeter2:d}=Hw({longitude:n,latitude:r,highPrecision:!0}),g=El(t);g[0]+=o*(u[0]+d[0]*a),g[1]+=a*(u[1]+d[1]*a);const _=gc(g),E=(i||0)+(s||0);return Number.isFinite(i)||Number.isFinite(s)?[_[0],_[1],E]:_}function j5(t){const{height:e,pitch:n,bearing:r,altitude:i,scale:o,center:a}=t,s=dC();$w(s,s,[0,0,-i]),Qte(s,s,-n*gf),Kte(s,s,r*gf);const u=o/e;return $O(s,s,[u,u,u]),a&&$w(s,s,cbe([],a)),s}function V5(t){const{width:e,height:n,altitude:r,pitch:i=0,offset:o,center:a,scale:s,nearZMultiplier:u=1,farZMultiplier:d=1}=t;let{fovy:g=k0(vne)}=t;r!==void 0&&(g=k0(r));const _=g*gf,E=i*gf,P=UE(g);let O=P;a&&(O+=a[2]*s/Math.cos(E)/n);const D=_*(.5+(o?o[1]:0)/n),V=Math.sin(D)*O/Math.sin(HF(Math.PI/2-E-D,.01,Math.PI-.01)),k=Math.sin(E)*V+O,F=O*10,z=Math.min(k*d,F);return{fov:_,aspect:e/n,focalDistance:P,near:u,far:z}}function xne(t){const{fov:e,aspect:n,near:r,far:i}=V5(t);return Jte([],e,n,r,i)}function k0(t){return 2*Math.atan(.5/t)*WF}function UE(t){return .5/Math.tan(.5*t*gf)}function YO(t,e){const[n,r,i=0]=t;return lg(Number.isFinite(n)&&Number.isFinite(r)&&Number.isFinite(i)),yv(e,[n,r,i,1])}function Km(t,e,n=0){const[r,i,o]=t;if(lg(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(o))return yv(e,[r,i,o,1]);const a=yv(e,[r,i,0,1]),s=yv(e,[r,i,1,1]),u=a[2],d=s[2],g=u===d?0:((n||0)-u)/(d-u);return zte([],a,s,g)}function $5(t){const{width:e,height:n,bounds:r,minExtent:i=0,maxZoom:o=24,offset:a=[0,0]}=t,[[s,u],[d,g]]=r,_=n2e(t.padding),E=El([s,HF(g,-Yb,Yb)]),P=El([d,HF(u,-Yb,Yb)]),O=[Math.max(Math.abs(P[0]-E[0]),i),Math.max(Math.abs(P[1]-E[1]),i)],D=[e-_.left-_.right-Math.abs(a[0])*2,n-_.top-_.bottom-Math.abs(a[1])*2];lg(D[0]>0&&D[1]>0);const V=D[0]/O[0],k=D[1]/O[1],F=(_.right-_.left)/2/V,z=(_.top-_.bottom)/2/k,X=[(P[0]+E[0])/2+F,(P[1]+E[1])/2+z],Y=gc(X),J=Math.min(o,k5(Math.abs(Math.min(V,k))));return lg(Number.isFinite(J)),{longitude:Y[0],latitude:Y[1],zoom:J}}function n2e(t=0){return typeof t=="number"?{top:t,bottom:t,left:t,right:t}:(lg(Number.isFinite(t.top)&&Number.isFinite(t.bottom)&&Number.isFinite(t.left)&&Number.isFinite(t.right)),t)}const G$=Math.PI/180;function H5(t,e=0){const{width:n,height:r,unproject:i}=t,o={targetZ:e},a=i([0,r],o),s=i([n,r],o);let u,d;const g=t.fovy?.5*t.fovy*G$:Math.atan(.5/t.altitude),_=(90-t.pitch)*G$;return g>_-.01?(u=j$(t,0,e),d=j$(t,n,e)):(u=i([0,0],o),d=i([n,0],o)),[a,s,d,u]}function j$(t,e,n){const{pixelUnprojectionMatrix:r}=t,i=yv(r,[e,0,1,1]),o=yv(r,[e,t.height,1,1]),s=(n*t.distanceScales.unitsPerMeter[2]-i[2])/(o[2]-i[2]),u=zte([],i,o,s),d=gc(u);return d.push(n),d}let V$=class qF{constructor(e={width:1,height:1}){q(this,"latitude",void 0),q(this,"longitude",void 0),q(this,"zoom",void 0),q(this,"pitch",void 0),q(this,"bearing",void 0),q(this,"altitude",void 0),q(this,"fovy",void 0),q(this,"meterOffset",void 0),q(this,"center",void 0),q(this,"width",void 0),q(this,"height",void 0),q(this,"scale",void 0),q(this,"distanceScales",void 0),q(this,"viewMatrix",void 0),q(this,"projectionMatrix",void 0),q(this,"viewProjectionMatrix",void 0),q(this,"pixelProjectionMatrix",void 0),q(this,"pixelUnprojectionMatrix",void 0),q(this,"equals",k=>k instanceof qF?k.width===this.width&&k.height===this.height&&P$(k.projectionMatrix,this.projectionMatrix)&&P$(k.viewMatrix,this.viewMatrix):!1),q(this,"project",(k,F={})=>{const{topLeft:z=!0}=F,X=this.projectPosition(k),Y=YO(X,this.pixelProjectionMatrix),[J,re]=Y,ue=z?re:this.height-re;return k.length===2?[J,ue]:[J,ue,Y[2]]}),q(this,"unproject",(k,F={})=>{const{topLeft:z=!0,targetZ:X=void 0}=F,[Y,J,re]=k,ue=z?J:this.height-J,ie=X&&X*this.distanceScales.unitsPerMeter[2],ce=Km([Y,ue,re],this.pixelUnprojectionMatrix,ie),[se,me,Ce]=this.unprojectPosition(ce);return Number.isFinite(re)?[se,me,Ce]:Number.isFinite(X)?[se,me,X]:[se,me]}),q(this,"projectPosition",k=>{const[F,z]=El(k),X=(k[2]||0)*this.distanceScales.unitsPerMeter[2];return[F,z,X]}),q(this,"unprojectPosition",k=>{const[F,z]=gc(k),X=(k[2]||0)*this.distanceScales.metersPerUnit[2];return[F,z,X]});let{width:n,height:r,altitude:i=null,fovy:o=null}=e;const{latitude:a=0,longitude:s=0,zoom:u=0,pitch:d=0,bearing:g=0,position:_=null,nearZMultiplier:E=.02,farZMultiplier:P=1.01}=e;n=n||1,r=r||1,o===null&&i===null?(i=vne,o=k0(i)):o===null?o=k0(i):i===null&&(i=UE(o));const O=fI(u);i=Math.max(.75,i);const D=Hw({longitude:s,latitude:a}),V=El([s,a]);V.push(0),_&&sbe(V,V,Abe([],_,D.unitsPerMeter)),this.projectionMatrix=xne({width:n,height:r,scale:O,center:V,pitch:d,fovy:o,nearZMultiplier:E,farZMultiplier:P}),this.viewMatrix=j5({height:r,scale:O,center:V,pitch:d,bearing:g,altitude:i}),this.width=n,this.height=r,this.scale=O,this.latitude=a,this.longitude=s,this.zoom=u,this.pitch=d,this.bearing=g,this.altitude=i,this.fovy=o,this.center=V,this.meterOffset=_||[0,0,0],this.distanceScales=D,this._initMatrices(),Object.freeze(this)}_initMatrices(){const{width:e,height:n,projectionMatrix:r,viewMatrix:i}=this,o=dC();kd(o,o,r),kd(o,o,i),this.viewProjectionMatrix=o;const a=dC();$O(a,a,[e/2,-n/2,1]),$w(a,a,[1,-1,0]),kd(a,a,o);const s=aI(dC(),a);if(!s)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=a,this.pixelUnprojectionMatrix=s}projectFlat(e){return El(e)}unprojectFlat(e){return gc(e)}getMapCenterByLngLatPosition({lngLat:e,pos:n}){const r=Km(n,this.pixelUnprojectionMatrix),i=El(e),o=F0([],i,M5([],r)),a=F0([],this.center,o);return gc(a)}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:o,latitude:a,zoom:s}=$5(Object.assign({width:r,height:i,bounds:e},n));return new qF({width:r,height:i,longitude:o,latitude:a,zoom:s})}getBounds(e){const n=this.getBoundingRegion(e),r=Math.min(...n.map(s=>s[0])),i=Math.max(...n.map(s=>s[0])),o=Math.min(...n.map(s=>s[1])),a=Math.max(...n.map(s=>s[1]));return[[r,o],[i,a]]}getBoundingRegion(e={}){return H5(this,e.z||0)}getLocationAtPoint({lngLat:e,pos:n}){return this.getMapCenterByLngLatPosition({lngLat:e,pos:n})}};const $$=512;function bne(t){const{width:e,height:n,pitch:r=0}=t;let{longitude:i,latitude:o,zoom:a,bearing:s=0}=t;(i<-180||i>180)&&(i=U$(i+180,360)-180),(s<-180||s>180)&&(s=U$(s+180,360)-180);const u=k5(n/$$);if(a<=u)a=u,o=0;else{const d=n/2/Math.pow(2,a),g=gc([0,d])[1];if(o<g)o=g;else{const _=gc([0,$$-d])[1];o>_&&(o=_)}}return{width:e,height:n,longitude:i,latitude:o,zoom:a,pitch:r,bearing:s}}const wne=.01,r2e=["longitude","latitude","zoom"],Ene={curve:1.414,speed:1.2};function Sne(t,e,n,r){const{startZoom:i,startCenterXY:o,uDelta:a,w0:s,u1:u,S:d,rho:g,rho2:_,r0:E}=Cne(t,e,r);if(u<wne){const X={};for(const Y of r2e){const J=t[Y],re=e[Y];X[Y]=e2e(J,re,n)}return X}const P=n*d,O=Math.cosh(E)/Math.cosh(E+g*P),D=s*((Math.cosh(E)*Math.tanh(E+g*P)-Math.sinh(E))/_)/u,V=1/O,k=i+z5(V),F=Jxe([],a,D);F0(F,F,o);const z=gc(F);return{longitude:z[0],latitude:z[1],zoom:k}}function Tne(t,e,n){const r={...Ene,...n},{screenSpeed:i,speed:o,maxDuration:a}=r,{S:s,rho:u}=Cne(t,e,r),d=1e3*s;let g;return Number.isFinite(i)?g=d/(i/u):g=d/o,Number.isFinite(a)&&g>a?0:g}function Cne(t,e,n){n=Object.assign({},Ene,n);const r=n.curve,i=t.zoom,o=[t.longitude,t.latitude],a=fI(i),s=e.zoom,u=[e.longitude,e.latitude],d=fI(s-i),g=El(o),_=El(u),E=rbe([],_,g),P=Math.max(t.width,t.height),O=P/d,D=ebe(E)*a,V=Math.max(D,wne),k=r*r,F=(O*O-P*P+k*k*V*V)/(2*P*k*V),z=(O*O-P*P-k*k*V*V)/(2*O*k*V),X=Math.log(Math.sqrt(F*F+1)-F),Y=Math.log(Math.sqrt(z*z+1)-z),J=(Y-X)/r;return{startZoom:i,startCenterXY:g,uDelta:E,w0:P,u1:D,S:J,rho:r,rho2:k,r0:X,r1:Y}}const i2e=`
const int max_lights = 2;
uniform mat4 shadow_uViewProjectionMatrices[max_lights];
uniform vec4 shadow_uProjectCenters[max_lights];
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform int shadow_uLightId;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  if (shadow_uDrawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[shadow_uLightId], shadow_uProjectCenters[shadow_uLightId]);
  }
  if (shadow_uUseShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow_uLightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, shadow_uViewProjectionMatrices[i], shadow_uProjectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,o2e=`
const int max_lights = 2;
uniform bool shadow_uDrawShadowMap;
uniform bool shadow_uUseShadowMap;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;
uniform vec4 shadow_uColor;
uniform float shadow_uLightCount;

varying vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture2D(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow_uDrawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow_uUseShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow_uLightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow_uColor.a / shadow_uLightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow_uColor.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,s2e=N1(f2e),a2e=N1(h2e),l2e=[0,0,0,1],u2e=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function c2e(t,e){const[n,r,i]=t,o=Km([n,r,i],e);return Number.isFinite(i)?o:[o[0],o[1],0]}function f2e({viewport:t,center:e}){return new vr(t.viewProjectionMatrix).invert().transform(e)}function h2e({viewport:t,shadowMatrices:e}){const n=[],r=t.pixelUnprojectionMatrix,i=t.isGeospatial?void 0:1,o=[[0,0,i],[t.width,0,i],[0,t.height,i],[t.width,t.height,i],[0,0,-1],[t.width,0,-1],[0,t.height,-1],[t.width,t.height,-1]].map(a=>c2e(a,r));for(const a of e){const s=a.clone().translate(new _t(t.center).negate()),u=o.map(g=>s.transform(g)),d=new vr().ortho({left:Math.min(...u.map(g=>g[0])),right:Math.max(...u.map(g=>g[0])),bottom:Math.min(...u.map(g=>g[1])),top:Math.max(...u.map(g=>g[1])),near:Math.min(...u.map(g=>-g[2])),far:Math.max(...u.map(g=>-g[2]))});n.push(d.multiplyRight(a))}return n}function d2e(t,e){const{shadowEnabled:n=!0}=t;if(!n||!t.shadowMatrices||!t.shadowMatrices.length)return{shadow_uDrawShadowMap:!1,shadow_uUseShadowMap:!1};const r={shadow_uDrawShadowMap:!!t.drawToShadowMap,shadow_uUseShadowMap:t.shadowMaps?t.shadowMaps.length>0:!1,shadow_uColor:t.shadowColor||l2e,shadow_uLightId:t.shadowLightId||0,shadow_uLightCount:t.shadowMatrices.length},i=s2e({viewport:t.viewport,center:e.project_uCenter}),o=[],a=a2e({shadowMatrices:t.shadowMatrices,viewport:t.viewport}).slice();for(let s=0;s<t.shadowMatrices.length;s++){const u=a[s],d=u.clone().translate(new _t(t.viewport.center).negate());e.project_uCoordinateSystem===Br.LNGLAT&&e.project_uProjectionMode===hh.WEB_MERCATOR?(a[s]=d,o[s]=i):(a[s]=u.clone().multiplyRight(u2e),o[s]=d.transform(i))}for(let s=0;s<a.length;s++)r["shadow_uViewProjectionMatrices[".concat(s,"]")]=a[s],r["shadow_uProjectCenters[".concat(s,"]")]=o[s],t.shadowMaps&&t.shadowMaps.length>0?r["shadow_uShadowMap".concat(s)]=t.shadowMaps[s]:r["shadow_uShadowMap".concat(s)]=t.dummyShadowMap;return r}const gC={name:"shadow",dependencies:[ZO],vs:i2e,fs:o2e,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:(t={},e={})=>"viewport"in t&&(t.drawToShadowMap||t.shadowMaps&&t.shadowMaps.length>0)?d2e(t,e):{}},p2e={color:[255,255,255],intensity:1},H$=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],g2e=[0,0,0,200/255];class W5{constructor(e={}){q(this,"id","lighting-effect"),q(this,"props",void 0),q(this,"shadowColor",g2e),q(this,"shadow",void 0),q(this,"ambientLight",void 0),q(this,"directionalLights",void 0),q(this,"pointLights",void 0),q(this,"shadowPasses",[]),q(this,"shadowMaps",[]),q(this,"dummyShadowMap",null),q(this,"programManager",void 0),q(this,"shadowMatrices",void 0),this.setProps(e)}setProps(e){this.ambientLight=null,this.directionalLights=[],this.pointLights=[];for(const n in e){const r=e[n];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(n=>n.shadow),this.props=e}preRender(e,{layers:n,layerFilter:r,viewports:i,onViewportActive:o,views:a}){if(this.shadow){this.shadowMatrices=this._calculateMatrices(),this.shadowPasses.length===0&&this._createShadowPasses(e),this.programManager||(this.programManager=B1.getDefaultProgramManager(e),gC&&this.programManager.addDefaultModule(gC)),this.dummyShadowMap||(this.dummyShadowMap=new Pl(e,{width:1,height:1}));for(let s=0;s<this.shadowPasses.length;s++)this.shadowPasses[s].render({layers:n,layerFilter:r,viewports:i,onViewportActive:o,views:a,moduleParameters:{shadowLightId:s,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}})}}getModuleParameters(e){const n=this.shadow?{shadowMaps:this.shadowMaps,dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{};return n.lightSources={ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(r=>r.getProjectedLight({layer:e})),pointLights:this.pointLights.map(r=>r.getProjectedLight({layer:e}))},n}cleanup(){for(const e of this.shadowPasses)e.delete();this.shadowPasses.length=0,this.shadowMaps.length=0,this.dummyShadowMap&&(this.dummyShadowMap.delete(),this.dummyShadowMap=null),this.shadow&&this.programManager&&(this.programManager.removeDefaultModule(gC),this.programManager=null)}_calculateMatrices(){const e=[];for(const n of this.directionalLights){const r=new vr().lookAt({eye:new _t(n.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let n=0;n<this.directionalLights.length;n++){const r=new kEe(e);this.shadowPasses[n]=r,this.shadowMaps[n]=r.shadowMap}}_applyDefaultLights(){const{ambientLight:e,pointLights:n,directionalLights:r}=this;!e&&n.length===0&&r.length===0&&(this.ambientLight=new fne(p2e),this.directionalLights.push(new uI(H$[0]),new uI(H$[1])))}}class m2e{constructor(e={}){q(this,"_pool",[]),q(this,"opts",{overAlloc:2,poolSize:100}),this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,n,{size:r=1,type:i,padding:o=0,copy:a=!1,initialize:s=!1,maxCount:u}){const d=i||e&&e.constructor||Float32Array,g=n*r+o;if(ArrayBuffer.isView(e)){if(g<=e.length)return e;if(g*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new d(e.buffer,0,g)}let _=1/0;u&&(_=u*r+o);const E=this._allocate(d,g,s,_);return e&&a?E.set(e):s||E.fill(0,0,4),this._release(e),E}release(e){this._release(e)}_allocate(e,n,r,i){let o=Math.max(Math.ceil(n*this.opts.overAlloc),1);o>i&&(o=i);const a=this._pool,s=e.BYTES_PER_ELEMENT*o,u=a.findIndex(d=>d.byteLength>=s);if(u>=0){const d=new e(a.splice(u,1)[0],0,o);return r&&d.fill(0),d}return new e(o)}_release(e){if(!ArrayBuffer.isView(e))return;const n=this._pool,{buffer:r}=e,{byteLength:i}=r,o=n.findIndex(a=>a.byteLength>=i);o<0?n.push(r):(o>0||n.length<this.opts.poolSize)&&n.splice(o,0,r),n.length>this.opts.poolSize&&n.shift()}}const jv=new m2e;function Qb(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function hI(t,e){const n=t%e;return n<0?e+n:n}function A2e(t){return[t[12],t[13],t[14]]}function _2e(t){return{left:xy(t[3]+t[0],t[7]+t[4],t[11]+t[8],t[15]+t[12]),right:xy(t[3]-t[0],t[7]-t[4],t[11]-t[8],t[15]-t[12]),bottom:xy(t[3]+t[1],t[7]+t[5],t[11]+t[9],t[15]+t[13]),top:xy(t[3]-t[1],t[7]-t[5],t[11]-t[9],t[15]-t[13]),near:xy(t[3]+t[2],t[7]+t[6],t[11]+t[10],t[15]+t[14]),far:xy(t[3]-t[2],t[7]-t[6],t[11]-t[10],t[15]-t[14])}}const W$=new _t;function xy(t,e,n,r){W$.set(t,e,n);const i=W$.len();return{distance:r/i,normal:new _t(-t/i,-e/i,-n/i)}}function Pne(t){return t-Math.fround(t)}let hb;function rB(t,e){const{size:n=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:t.length,o=(i-r)/n;hb=jv.allocate(hb,o,{type:Float32Array,size:n*2});let a=r,s=0;for(;a<i;){for(let u=0;u<n;u++){const d=t[a++];hb[s+u]=d,hb[s+u+n]=Pne(d)}s+=n*2}return hb.subarray(0,o*n*2)}function y2e(t){let e=null,n=!1;for(const r of t)r&&(e?(n||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],n=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const v2e=Math.PI/180,x2e=Qb(),q$=[0,0,0],b2e={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function w2e({width:t,height:e,orthographic:n,fovyRadians:r,focalDistance:i,padding:o,near:a,far:s}){const u=t/e,d=n?new vr().orthographic({fovy:r,aspect:u,focalDistance:i,near:a,far:s}):new vr().perspective({fovy:r,aspect:u,near:a,far:s});if(o){const{left:g=0,right:_=0,top:E=0,bottom:P=0}=o,O=Wi((g+t-_)/2,0,t)-t/2,D=Wi((E+e-P)/2,0,e)-e/2;d[8]-=O*2/t,d[9]+=D*2/e}return d}class zh{constructor(e={}){q(this,"id",void 0),q(this,"x",void 0),q(this,"y",void 0),q(this,"width",void 0),q(this,"height",void 0),q(this,"padding",void 0),q(this,"isGeospatial",void 0),q(this,"zoom",void 0),q(this,"focalDistance",void 0),q(this,"position",void 0),q(this,"modelMatrix",void 0),q(this,"distanceScales",void 0),q(this,"scale",void 0),q(this,"center",void 0),q(this,"cameraPosition",void 0),q(this,"projectionMatrix",void 0),q(this,"viewMatrix",void 0),q(this,"viewMatrixUncentered",void 0),q(this,"viewMatrixInverse",void 0),q(this,"viewProjectionMatrix",void 0),q(this,"pixelProjectionMatrix",void 0),q(this,"pixelUnprojectionMatrix",void 0),q(this,"resolution",void 0),q(this,"_frustumPlanes",{}),this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||b2e,this.focalDistance=e.focalDistance||1,this.position=e.position||q$,this.modelMatrix=e.modelMatrix||null;const{longitude:n,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(n),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?hh.WEB_MERCATOR:hh.WEB_MERCATOR_AUTO_OFFSET:hh.IDENTITY}equals(e){return e instanceof zh?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Sl(e.projectionMatrix,this.projectionMatrix)&&Sl(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:n=!0}={}){const r=this.projectPosition(e),i=YO(r,this.pixelProjectionMatrix),[o,a]=i,s=n?a:this.height-a;return e.length===2?[o,s]:[o,s,i[2]]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,o,a]=e,s=n?o:this.height-o,u=r&&r*this.distanceScales.unitsPerMeter[2],d=Km([i,s,a],this.pixelUnprojectionMatrix,u),[g,_,E]=this.unprojectPosition(d);return Number.isFinite(a)?[g,_,E]:Number.isFinite(r)?[g,_,r]:[g,_]}projectPosition(e){const[n,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[n,r,i]}unprojectPosition(e){const[n,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[n,r,i]}projectFlat(e){if(this.isGeospatial){const n=El(e);return n[1]=Wi(n[1],-318,830),n}return e}unprojectFlat(e){return this.isGeospatial?gc(e):e}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,0],n),i=this.unproject([this.width,0],n),o=this.unproject([0,this.height],n),a=this.unproject([this.width,this.height],n);return[Math.min(r[0],i[0],o[0],a[0]),Math.min(r[1],i[1],o[1],a[1]),Math.max(r[0],i[0],o[0],a[0]),Math.max(r[1],i[1],o[1],a[1])]}getDistanceScales(e){return e?Hw({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:n,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&n<this.y+this.height&&this.y<n+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,_2e(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,n){return null}_initProps(e){const n=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=U5({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||Hw({latitude:r,longitude:n}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:o,modelMatrix:a}=e;let s=q$;if(o&&(s=a?new vr(a).transformAsVector(o,[]):o),this.isGeospatial){const u=this.projectPosition([n,r,0]);this.center=new _t(s).scale(this.distanceScales.unitsPerMeter).add(u)}else this.center=this.projectPosition(s)}_initMatrices(e){const{viewMatrix:n=x2e,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:o,fovy:a=75,near:s=.1,far:u=1e3,padding:d=null,focalDistance:g=1}=e;this.viewMatrixUncentered=n,this.viewMatrix=new vr().multiplyRight(n).translate(new _t(this.center).negate()),this.projectionMatrix=r||w2e({width:this.width,height:this.height,orthographic:i,fovyRadians:o||a*v2e,focalDistance:g,padding:d,near:s,far:u});const _=Qb();kd(_,_,this.projectionMatrix),kd(_,_,this.viewMatrix),this.viewProjectionMatrix=_,this.viewMatrixInverse=aI([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=A2e(this.viewMatrixInverse);const E=Qb(),P=Qb();$O(E,E,[this.width/2,-this.height/2,1]),$w(E,E,[1,-1,0]),kd(P,E,this.viewProjectionMatrix),this.pixelProjectionMatrix=P,this.pixelUnprojectionMatrix=aI(Qb(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||Or.warn("Pixel project matrix not invertible")()}}q(zh,"displayName","Viewport");class ug extends zh{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,pitch:o=0,bearing:a=0,nearZMultiplier:s=.1,farZMultiplier:u=1.01,nearZ:d,farZ:g,orthographic:_=!1,projectionMatrix:E,repeat:P=!1,worldOffset:O=0,position:D,padding:V,legacyMeterSizes:k=!1}=e;let{width:F,height:z,altitude:X=1.5}=e;const Y=Math.pow(2,i);F=F||1,z=z||1;let J,re=null;if(E)X=E[5]/2,J=k0(X);else{e.fovy?(J=e.fovy,X=UE(J)):J=k0(X);let ie;if(V){const{top:ce=0,bottom:se=0}=V;ie=[0,Wi((ce+z-se)/2,0,z)-z/2]}re=V5({width:F,height:z,scale:Y,center:D&&[0,0,D[2]*pC(n)],offset:ie,pitch:o,fovy:J,nearZMultiplier:s,farZMultiplier:u}),Number.isFinite(d)&&(re.near=d),Number.isFinite(g)&&(re.far=g)}let ue=j5({height:z,pitch:o,bearing:a,scale:Y,altitude:X});O&&(ue=new vr().translate([512*O,0,0]).multiplyLeft(ue)),super({...e,width:F,height:z,viewMatrix:ue,longitude:r,latitude:n,zoom:i,...re,fovy:J,focalDistance:X}),q(this,"longitude",void 0),q(this,"latitude",void 0),q(this,"pitch",void 0),q(this,"bearing",void 0),q(this,"altitude",void 0),q(this,"fovy",void 0),q(this,"orthographic",void 0),q(this,"_subViewports",void 0),q(this,"_pseudoMeters",void 0),this.latitude=n,this.longitude=r,this.zoom=i,this.pitch=o,this.bearing=a,this.altitude=X,this.fovy=J,this.orthographic=_,this._subViewports=P?[]:null,this._pseudoMeters=k,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),n=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=n;i<=r;i++){const o=i?new ug({...this,worldOffset:i}):this;this._subViewports.push(o)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[n,r]=this.projectFlat(e),i=(e[2]||0)*pC(e[1]);return[n,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[n,r]=this.unprojectFlat(e),i=(e[2]||0)/pC(r);return[n,r,i]}addMetersToLngLat(e,n){return G5(e,n)}panByPosition(e,n){const r=Km(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),o=F0([],i,M5([],r)),a=F0([],this.center,o),[s,u]=this.unprojectFlat(a);return{longitude:s,latitude:u}}getBounds(e={}){const n=H5(this,e.z||0);return[Math.min(n[0][0],n[1][0],n[2][0],n[3][0]),Math.min(n[0][1],n[1][1],n[2][1],n[3][1]),Math.max(n[0][0],n[1][0],n[2][0],n[3][0]),Math.max(n[0][1],n[1][1],n[2][1],n[3][1])]}fitBounds(e,n={}){const{width:r,height:i}=this,{longitude:o,latitude:a,zoom:s}=$5({width:r,height:i,bounds:e,...n});return new ug({width:r,height:i,longitude:o,latitude:a,zoom:s})}}q(ug,"displayName","WebMercatorViewport");const X$=[0,0,0];function iB(t,e,n=!1){const r=e.projectPosition(t);if(n&&e instanceof ug){const[i,o,a=0]=t,s=e.getDistanceScales([i,o]);r[2]=a*s.unitsPerMeter[2]}return r}function E2e(t){const{viewport:e,modelMatrix:n,coordinateOrigin:r}=t;let{coordinateSystem:i,fromCoordinateSystem:o,fromCoordinateOrigin:a}=t;return i===Br.DEFAULT&&(i=e.isGeospatial?Br.LNGLAT:Br.CARTESIAN),o===void 0&&(o=i),a===void 0&&(a=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:n,fromCoordinateSystem:o,fromCoordinateOrigin:a}}function Ine(t,{viewport:e,modelMatrix:n,coordinateSystem:r,coordinateOrigin:i,offsetMode:o}){let[a,s,u=0]=t;switch(n&&([a,s,u]=D1([],[a,s,u,1],n)),r){case Br.LNGLAT:return iB([a,s,u],e,o);case Br.LNGLAT_OFFSETS:return iB([a+i[0],s+i[1],u+(i[2]||0)],e,o);case Br.METER_OFFSETS:return iB(G5(i,[a,s,u]),e,o);case Br.CARTESIAN:default:return e.isGeospatial?[a+i[0],s+i[1],u+i[2]]:e.projectPosition([a,s,u])}}function Mne(t,e){const{viewport:n,coordinateSystem:r,coordinateOrigin:i,modelMatrix:o,fromCoordinateSystem:a,fromCoordinateOrigin:s}=E2e(e),{autoOffset:u=!0}=e,{geospatialOrigin:d=X$,shaderCoordinateOrigin:g=X$,offsetMode:_=!1}=u?Ane(n,r,i):{},E=Ine(t,{viewport:n,modelMatrix:o,coordinateSystem:a,coordinateOrigin:s,offsetMode:_});if(_){const P=n.projectPosition(d||g);Xte(E,E,P)}return E}const S2e=[255,255,255],T2e=1,C2e=[0,0,1],P2e=[0,0,1];let I2e=0;class One{constructor(e={}){q(this,"id",void 0),q(this,"color",void 0),q(this,"intensity",void 0),q(this,"type","point"),q(this,"position",void 0),q(this,"attenuation",void 0),q(this,"projectedLight",void 0);const{color:n=S2e}=e,{intensity:r=T2e}=e,{position:i=P2e}=e;this.id=e.id||"point-".concat(I2e++),this.color=n,this.intensity=r,this.type="point",this.position=i,this.attenuation=M2e(e),this.projectedLight={...this}}getProjectedLight({layer:e}){const{projectedLight:n}=this,r=e.context.viewport,{coordinateSystem:i,coordinateOrigin:o}=e.props,a=Mne(this.position,{viewport:r,coordinateSystem:i,coordinateOrigin:o,fromCoordinateSystem:r.isGeospatial?Br.LNGLAT:Br.CARTESIAN,fromCoordinateOrigin:[0,0,0]});return n.color=this.color,n.intensity=this.intensity,n.position=a,n}}function M2e(t){return t.attenuation?t.attenuation:"intensity"in t?[0,0,t.intensity||0]:C2e}class O2e extends One{getProjectedLight({layer:e}){const{projectedLight:n}=this,r=e.context.viewport,{coordinateSystem:i,coordinateOrigin:o,modelMatrix:a}=e.props,{project_uCameraPosition:s}=_ne({viewport:r,modelMatrix:a,coordinateSystem:i,coordinateOrigin:o});return n.color=this.color,n.intensity=this.intensity,n.position=s,n}}const z0=Math.PI/180,R2e=1e3*60*60*24,L2e=2440588,D2e=2451545,dI=z0*23.4397,B2e=357.5291,N2e=.98560028,F2e=280.147,k2e=360.9856235;function z2e(t,e,n){const r=z0*-n,i=z0*e,o=G2e(t),a=Z2e(o),s=W2e(o,r)-a.rightAscension;return{azimuth:$2e(s,i,a.declination),altitude:H2e(s,i,a.declination)}}function Z$(t,e,n){const{azimuth:r,altitude:i}=z2e(t,e,n);return[Math.sin(r)*Math.cos(i),Math.cos(r)*Math.cos(i),-Math.sin(i)]}function U2e(t){return(typeof t=="number"?t:t.getTime())/R2e-.5+L2e}function G2e(t){return U2e(t)-D2e}function j2e(t,e){const n=t;return Math.atan2(Math.sin(n)*Math.cos(dI)-Math.tan(e)*Math.sin(dI),Math.cos(n))}function V2e(t,e){const n=t;return Math.asin(Math.sin(e)*Math.cos(dI)+Math.cos(e)*Math.sin(dI)*Math.sin(n))}function $2e(t,e,n){const r=t,i=e,o=n;return Math.atan2(Math.sin(r),Math.cos(r)*Math.sin(i)-Math.tan(o)*Math.cos(i))}function H2e(t,e,n){const r=t,i=e,o=n;return Math.asin(Math.sin(i)*Math.sin(o)+Math.cos(i)*Math.cos(o)*Math.cos(r))}function W2e(t,e){return z0*(F2e+k2e*t)-e}function q2e(t){return z0*(B2e+N2e*t)}function X2e(t){const e=t,n=z0*(1.9148*Math.sin(e)+.02*Math.sin(2*e)+3e-4*Math.sin(3*e)),r=z0*102.9372;return e+n+r+Math.PI}function Z2e(t){const e=q2e(t),n=X2e(e);return{declination:V2e(n,0),rightAscension:j2e(n,0)}}class Y2e extends uI{constructor(e){super(e),q(this,"timestamp",void 0),this.timestamp=e.timestamp}getProjectedLight({layer:e}){const{viewport:n}=e.context;if(n.resolution&&n.resolution>0){const[i,o,a]=Z$(this.timestamp,0,0);this.direction=[i,-a,o]}else{const{latitude:i,longitude:o}=n;this.direction=Z$(this.timestamp,i,o)}return this}}class Y$ extends hne{constructor(e,n){super(e,n),q(this,"model",void 0);const{module:r,fs:i,id:o}=n;this.model=new cne(e,{id:o,fs:i,modules:[r]})}render(e){const n=this.gl;bh(n,{viewport:[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}),Mu(n,{framebuffer:e.outputBuffer,clearColor:[0,0,0,0]},()=>this._renderPass(n,e))}delete(){this.model.delete(),this.model=null}_renderPass(e,n){const{inputBuffer:r}=n;BE(e,{color:!0}),this.model.draw({moduleSettings:n.moduleSettings,uniforms:{texture:r,texSize:[r.width,r.height]},parameters:{depthWrite:!1,depthTest:!1}})}}class Q2e{constructor(e,n={}){q(this,"id",void 0),q(this,"props",void 0),q(this,"module",void 0),q(this,"passes",void 0),this.id="".concat(e.name,"-pass"),this.props=n,Ete(e),this.module=e}setProps(e){this.props=e}preRender(){}postRender(e,n){const r=this.passes||K2e(e,this.module,this.id);this.passes=r;const{target:i}=n;let o=n.inputBuffer,a=n.swapBuffer;for(let s=0;s<this.passes.length;s++){i&&s===this.passes.length-1&&(a=i),this.passes[s].render({inputBuffer:o,outputBuffer:a,moduleSettings:this.props});const u=a;a=o,o=u}return o}cleanup(){if(this.passes){for(const e of this.passes)e.delete();this.passes=void 0}}}function K2e(t,e,n){if(!e.passes){const r=Q$(e);return[new Y$(t,{id:n,module:e,fs:r})]}return e.passes.map((r,i)=>{const o=Q$(e,r),a="".concat(n,"-").concat(i);return new Y$(t,{id:a,module:e,fs:o})})}const J2e=t=>`uniform sampler2D texture;
uniform vec2 texSize;

varying vec2 position;
varying vec2 coordinate;
varying vec2 uv;

void main() {
  vec2 texCoord = coordinate;

  gl_FragColor = texture2D(texture, texCoord);
  gl_FragColor = `.concat(t,`(gl_FragColor, texSize, texCoord);
}
`),eSe=t=>`uniform sampler2D texture;
uniform vec2 texSize;

varying vec2 position;
varying vec2 coordinate;
varying vec2 uv;

void main() {
  vec2 texCoord = coordinate;

  gl_FragColor = `.concat(t,`(texture, texSize, texCoord);
}
`);function Q$(t,e=t){if(e.filter){const n=typeof e.filter=="string"?e.filter:"".concat(t.name,"_filterColor");return J2e(n)}if(e.sampler){const n=typeof e.sampler=="string"?e.sampler:"".concat(t.name,"_sampleColor");return eSe(n)}return null}const K$={blendFunc:[1,0,32771,0],blendEquation:32774};class q5 extends XO{constructor(...e){super(...e),q(this,"pickZ",void 0),q(this,"_colorEncoderState",null)}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:o,pickingFBO:a,deviceRect:{x:s,y:u,width:d,height:g},cullRect:_,effects:E,pass:P="picking",pickZ:O,moduleParameters:D}){const V=this.gl;this.pickZ=O;const k=this._resetColorEncoder(O),F=Mu(V,{scissorTest:!0,scissor:[s,u,d,g],clearColor:[0,0,0,0],depthMask:!0,depthTest:!0,depthRange:[0,1],colorMask:[!0,!0,!0,!0],...K$,blend:!O},()=>super.render({target:a,layers:e,layerFilter:n,views:r,viewports:i,onViewportActive:o,cullRect:_,effects:E==null?void 0:E.filter(X=>X.useInPicking),pass:P,isPicking:!0,moduleParameters:D}));return this._colorEncoderState=null,{decodePickingColor:k&&nSe.bind(null,k),stats:F}}shouldDrawLayer(e){const{pickable:n,operation:r}=e.props;return n&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getModuleParameters(){return{pickingActive:1,pickingAttribute:this.pickZ,lightSources:{}}}getLayerParameters(e,n,r){const i={...e.props.parameters},{pickable:o,operation:a}=e.props;return this._colorEncoderState?o&&a.includes("draw")&&(Object.assign(i,K$),i.blend=!0,i.blendColor=tSe(this._colorEncoderState,e,r)):i.blend=!1,a.includes("terrain")&&(i.blend=!1),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function tSe(t,e,n){const{byLayer:r,byAlpha:i}=t;let o,a=r.get(e);return a?(a.viewports.push(n),o=a.a):(o=r.size+1,o<=255?(a={a:o,layer:e,viewports:[n]},r.set(e,a),i[o]=a):(Or.warn("Too many pickable layers, only picking the first 255")(),o=0)),[0,0,0,o/255]}function nSe(t,e){const n=t.byAlpha[e[3]];return n&&{pickedLayer:n.layer,pickedViewports:n.viewports,pickedObjectIndex:n.layer.decodePickingColor(e)}}const zy={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},pI=Symbol.for("component"),Vm=Symbol.for("propTypes"),oB=Symbol.for("deprecatedProps"),vv=Symbol.for("asyncPropDefaults"),U0=Symbol.for("asyncPropOriginal"),Mm=Symbol.for("asyncPropResolved");function GE(t,e=()=>!0){return Array.isArray(t)?Rne(t,e,[]):e(t)?[t]:[]}function Rne(t,e,n){let r=-1;for(;++r<t.length;){const i=t[r];Array.isArray(i)?Rne(i,e,n):e(i)&&n.push(i)}return n}function Lne({target:t,source:e,start:n=0,count:r=1}){const i=e.length,o=r*i;let a=0;for(let s=n;a<i;a++)t[s++]=e[a];for(;a<o;)a<o-a?(t.copyWithin(n+a,n,n+a),a*=2):(t.copyWithin(n+a,n,n+o-a),a=o);return t}class rSe{constructor(e,n,r){q(this,"id",void 0),q(this,"context",void 0),q(this,"isLoaded",void 0),q(this,"persistent",void 0),q(this,"_loadCount",0),q(this,"_subscribers",new Set),q(this,"_data",void 0),q(this,"_loader",void 0),q(this,"_error",void 0),q(this,"_content",void 0),this.id=e,this.context=r,this.setData(n)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,n){if(e===this._data&&!n)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=ag(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(o=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=o)}).catch(o=>{this._loadCount===r&&(this.isLoaded=!0,this._error=o||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const o of this._subscribers)o.onChange(this.getData())}}class iSe{constructor({gl:e,protocol:n}){q(this,"protocol",void 0),q(this,"_context",void 0),q(this,"_resources",void 0),q(this,"_consumers",void 0),q(this,"_pruneRequest",void 0),this.protocol=n||"resource://",this._context={gl:e,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:n,forceUpdate:r=!1,persistent:i=!0}){let o=this._resources[e];o?o.setData(n,r):(o=new rSe(e,n,this._context),this._resources[e]=o),o.persistent=i}remove(e){const n=this._resources[e];n&&(n.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const n=this._consumers[e];if(n){for(const r in n){const i=n[r],o=this._resources[i.resourceId];o&&o.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:n,consumerId:r,requestId:i="default"}){const{_resources:o,protocol:a}=this;e.startsWith(a)&&(e=e.replace(a,""),o[e]||this.add({resourceId:e,data:null,persistent:!1}));const s=o[e];if(this._track(r,i,s,n),s)return s.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,n,r,i){const o=this._consumers,a=o[e]=o[e]||{},s=a[n]||{},u=s.resourceId&&this._resources[s.resourceId];u&&(u.unsubscribe(s),this.prune()),r&&(a[n]=s,s.onChange=i,s.resourceId=r.id,r.subscribe(s))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const n=this._resources[e];!n.persistent&&!n.inUse()&&(n.delete(),delete this._resources[e])}}}const oSe=`
vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,Mc={name:"project32",dependencies:[ZO],vs:oSe},Oc={inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:#decl":`
uniform bool picking_uAttribute;
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}},...sne},sSe=[ZO],aSe=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"];function lSe(t){const e=B1.getDefaultProgramManager(t);for(const n of sSe)e.addDefaultModule(n);for(const n of aSe)e.addShaderHook(n);return e}const uSe="layerManager.setLayers",cSe="layerManager.activateViewport";class Dne{constructor(e,{deck:n,stats:r,viewport:i,timeline:o}={}){q(this,"layers",void 0),q(this,"context",void 0),q(this,"resourceManager",void 0),q(this,"_lastRenderedLayers",[]),q(this,"_needsRedraw",!1),q(this,"_needsUpdate",!1),q(this,"_nextLayers",null),q(this,"_debug",!1),q(this,"activateViewport",a=>{_l(cSe,this,a),a&&(this.context.viewport=a)}),this.layers=[],this.resourceManager=new iSe({gl:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,gl:e,deck:n,programManager:e&&lSe(e),stats:r||new _5({id:"deck.gl"}),viewport:i||new zh({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:o||new F5,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);n=n||i}return n}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(n=>e.find(r=>n.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,n){_l(uSe,this,n,e),this._lastRenderedLayers=e;const r=GE(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw("updating layers: ".concat(e)),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}_handleError(e,n,r){r.raiseError(n,"".concat(e," of ").concat(r))}_updateLayers(e,n){const r={};for(const a of e)r[a.id]?Or.warn("Multiple old layers with same id ".concat(a.id))():r[a.id]=a;const i=[];this._updateSublayersRecursively(n,r,i),this._finalizeOldLayers(r);let o=!1;for(const a of i)if(a.hasUniformTransition()){o="Uniform transition in ".concat(a);break}this._needsUpdate=o,this.layers=i}_updateSublayersRecursively(e,n,r){for(const i of e){i.context=this.context;const o=n[i.id];o===null&&Or.warn("Multiple new layers with same id ".concat(i.id))(),n[i.id]=null;let a=null;try{this._debug&&o!==i&&i.validateProps(),o?(this._transferLayerState(o,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),a=i.isComposite?i.getSubLayers():null}catch(s){this._handleError("matching",s,i)}a&&this._updateSublayersRecursively(a,n,r)}}_finalizeOldLayers(e){for(const n in e){const r=e[n];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=zy.INITIALIZED}catch(n){this._handleError("initialization",n,e)}}_transferLayerState(e,n){n._transferState(e),n.lifecycle=zy.MATCHED,n!==e&&(e.lifecycle=zy.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(n){this._handleError("update",n,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||"finalized ".concat(e),e.lifecycle=zy.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=zy.FINALIZED}catch(n){this._handleError("finalization",n,e)}}}function uc(t,e,n){if(t===e)return!0;if(!n||!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!uc(t[r],e[r],n-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),i=Object.keys(e);if(r.length!==i.length)return!1;for(const o of r)if(!e.hasOwnProperty(o)||!uc(t[o],e[o],n-1))return!1;return!0}return!1}class fSe{constructor(e){q(this,"width",void 0),q(this,"height",void 0),q(this,"views",void 0),q(this,"viewState",void 0),q(this,"controllers",void 0),q(this,"timeline",void 0),q(this,"_viewports",void 0),q(this,"_viewportMap",void 0),q(this,"_isUpdating",void 0),q(this,"_needsRedraw",void 0),q(this,"_needsUpdate",void 0),q(this,"_eventManager",void 0),q(this,"_eventCallbacks",void 0),this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const n=this.controllers[e];n&&n.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const n=this.controllers[e];n&&n.updateTransition()}}getViewports(e){return e?this._viewports.filter(n=>n.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(n=>{e[n.id]=n}),e}getView(e){return this.views.find(n=>n.id===e)}getViewState(e){const n=typeof e=="string"?this.getView(e):e,r=n&&this.viewState[n.getViewStateId()]||this.viewState;return n?n.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,n){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let o=r.length-1;o>=0;--o){const a=r[o];if(a.containsPixel(i)){const s=e.slice();return s[0]-=a.x,s[1]-=a.y,a.unproject(s,n)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,n){(e!==this.width||n!==this.height)&&(this.width=e,this.height=n,this.setNeedsUpdate("Size changed"))}_setViews(e){e=GE(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!uc(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):Or.warn("missing `viewState` or `initialViewState`")()}_onViewStateChange(e,n){this._eventCallbacks.onViewStateChange&&this._eventCallbacks.onViewStateChange({...n,viewId:e})}_createController(e,n){const r=n.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._onViewStateChange.bind(this,n.id),onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:o=>{var a;return(a=this.getView(e.id))===null||a===void 0?void 0:a.makeViewport({viewState:o,width:this.width,height:this.height})}})}_updateController(e,n,r,i){const o=e.controller;if(o&&r){const a={...n,...o,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==o.type)&&(i=this._createController(e,a)),i&&i.setProps(a),i}return null}_rebuildViewports(){const{views:e}=this,n=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const o=e[i],a=this.getViewState(o),s=o.makeViewport({viewState:a,width:this.width,height:this.height});let u=n[o.id];const d=!!o.controller;d&&!u&&(r=!0),(r||!d)&&u&&(u.finalize(),u=null),this.controllers[o.id]=this._updateController(o,a,s,u),s&&this._viewports.unshift(s)}for(const i in n){const o=n[i];o&&!this.controllers[i]&&o.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,n){return e.length!==n.length?!0:e.some((r,i)=>!e[i].equals(n[i]))}}const hSe=/([0-9]+\.?[0-9]*)(%|px)/;function cm(t){switch(typeof t){case"number":return{position:t,relative:!1};case"string":const e=hSe.exec(t);if(e&&e.length>=3){const n=e[2]==="%",r=parseFloat(e[1]);return{position:n?r/100:r,relative:n}}default:throw new Error("Could not parse position string ".concat(t))}}function fm(t,e){return t.relative?Math.round(t.position*e):t.position}function ia(t,e){if(!t)throw new Error(e||"deck.gl: assertion failed.")}class Sh{constructor(e){q(this,"id",void 0),q(this,"viewportInstance",void 0),q(this,"_x",void 0),q(this,"_y",void 0),q(this,"_width",void 0),q(this,"_height",void 0),q(this,"_padding",void 0),q(this,"props",void 0);const{id:n,x:r=0,y:i=0,width:o="100%",height:a="100%",padding:s=null,viewportInstance:u}=e||{};ia(!u||u instanceof zh),this.viewportInstance=u,this.id=n||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=cm(r),this._y=cm(i),this._width=cm(o),this._height=cm(a),this._padding=s&&{left:cm(s.left||0),right:cm(s.right||0),top:cm(s.top||0),bottom:cm(s.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.viewportInstance?e.viewportInstance?this.viewportInstance.equals(e.viewportInstance):!1:this.ViewportType===e.ViewportType&&uc(this.props,e.props,2)}makeViewport({width:e,height:n,viewState:r}){if(this.viewportInstance)return this.viewportInstance;r=this.filterViewState(r);const i=this.getDimensions({width:e,height:n});return!i.height||!i.width?null:new this.ViewportType({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const n={...e};for(const r in this.props.viewState)r!=="id"&&(n[r]=this.props.viewState[r]);return n}return e}getDimensions({width:e,height:n}){const r={x:fm(this._x,e),y:fm(this._y,n),width:fm(this._width,e),height:fm(this._height,n)};return this._padding&&(r.padding={left:fm(this._padding.left,e),top:fm(this._padding.top,n),right:fm(this._padding.right,e),bottom:fm(this._padding.bottom,n)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}let jE=class{constructor(e){q(this,"_inProgress",void 0),q(this,"_handle",void 0),q(this,"_timeline",void 0),q(this,"time",void 0),q(this,"settings",void 0),this._inProgress=!1,this._handle=null,this._timeline=e,this.time=0,this.settings={duration:0}}get inProgress(){return this._inProgress}start(e){var n,r;this.cancel(),this.settings=e,this._inProgress=!0,(n=(r=this.settings).onStart)===null||n===void 0||n.call(r,this)}end(){if(this._inProgress){var e,n;this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(e=(n=this.settings).onEnd)===null||e===void 0||e.call(n,this)}}cancel(){if(this._inProgress){var e,n;(e=(n=this.settings).onInterrupt)===null||e===void 0||e.call(n,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1}}update(){var e,n;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(e=(n=this.settings).onUpdate)===null||e===void 0||e.call(n,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}};const J$=()=>{},gI={BREAK:1,SNAP_TO_END:2,IGNORE:3},dSe=t=>t,pSe=gI.BREAK;class gSe{constructor(e){q(this,"getControllerState",void 0),q(this,"props",void 0),q(this,"propsInTransition",void 0),q(this,"transition",void 0),q(this,"onViewStateChange",void 0),q(this,"onStateChange",void 0),q(this,"_onTransitionUpdate",n=>{const{time:r,settings:{interpolator:i,startProps:o,endProps:a,duration:s,easing:u}}=n,d=u(r/s),g=i.interpolateProps(o,a,d);this.propsInTransition=this.getControllerState({...this.props,...g}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})}),this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new jE(e.timeline),this.onViewStateChange=e.onViewStateChange||J$,this.onStateChange=e.onStateChange||J$}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let n=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:o,endProps:a}=this.transition.settings;i={...r,...o===gI.SNAP_TO_END?a:this.propsInTransition||r}}this._triggerTransition(i,e),n=!0}else this.transition.cancel();return n}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:n,transitionInterpolator:r}=e;return(n>0||n==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,n){return this.transition.inProgress?this.transition.settings.interruption===gI.IGNORE||this._isUpdateDueToCurrentTransition(n):this._isTransitionEnabled(n)?n.transitionInterpolator.arePropsEqual(e,n):!0}_triggerTransition(e,n){const r=this.getControllerState(e),i=this.getControllerState(n).shortestPathFrom(r),o=n.transitionInterpolator,a=o.getDuration?o.getDuration(e,n):n.transitionDuration;if(a===0)return;const s=o.initializeProps(e,i);this.propsInTransition={};const u={duration:a,easing:n.transitionEasing||dSe,interpolator:o,interruption:n.transitionInterruption||pSe,startProps:s.start,endProps:s.end,onStart:n.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(n.onTransitionInterrupt),onEnd:this._onTransitionEnd(n.onTransitionEnd)};this.transition.start(u),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return n=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(n)}}}class X5{constructor(e){q(this,"_propsToCompare",void 0),q(this,"_propsToExtract",void 0),q(this,"_requiredProps",void 0);const{compare:n,extract:r,required:i}=e;this._propsToCompare=n,this._propsToExtract=r||n,this._requiredProps=i}arePropsEqual(e,n){for(const r of this._propsToCompare)if(!(r in e)||!(r in n)||!Sl(e[r],n[r]))return!1;return!0}initializeProps(e,n){const r={},i={};for(const o of this._propsToExtract)(o in e||o in n)&&(r[o]=e[o],i[o]=n[o]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,n){return n.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(n=>{const r=e[n];ia(Number.isFinite(r)||Array.isArray(r),"".concat(n," is required for transition"))})}}const mSe=["longitude","latitude","zoom","bearing","pitch"],ASe=["longitude","latitude","zoom"];class h_ extends X5{constructor(e={}){const n=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(n)?{compare:n,required:n}:n||{compare:mSe,required:ASe},super(r.transitionProps),q(this,"opts",void 0),this.opts=r}initializeProps(e,n){const r=super.initializeProps(e,n),{makeViewport:i,around:o}=this.opts;if(i&&o){const a=i(e),s=i(n),u=a.unproject(o);r.start.around=o,Object.assign(r.end,{around:s.project(u),aroundPosition:u,width:n.width,height:n.height})}return r}interpolateProps(e,n,r){const i={};for(const o of this._propsToExtract)i[o]=pc(e[o]||0,n[o]||0,r);if(n.aroundPosition&&this.opts.makeViewport){const o=this.opts.makeViewport({...n,...i});Object.assign(i,o.panByPosition(n.aroundPosition,pc(e.around,n.around,r)))}return i}}const hm={transitionDuration:0},_Se=300,zS=t=>1-(1-t)*(1-t),by={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],TRIPLE_PAN:["tripanstart","tripanmove","tripanend"],DOUBLE_TAP:["doubletap"],KEYBOARD:["keydown"]},l0={};class F1{constructor(e){q(this,"props",void 0),q(this,"state",{}),q(this,"transitionManager",void 0),q(this,"eventManager",void 0),q(this,"onViewStateChange",void 0),q(this,"onStateChange",void 0),q(this,"makeViewport",void 0),q(this,"_controllerState",void 0),q(this,"_events",{}),q(this,"_interactionState",{isDragging:!1}),q(this,"_customEvents",[]),q(this,"_eventStartBlocked",null),q(this,"_panMove",!1),q(this,"invertPan",!1),q(this,"dragMode","rotate"),q(this,"inertia",0),q(this,"scrollZoom",!0),q(this,"dragPan",!0),q(this,"dragRotate",!0),q(this,"doubleClickZoom",!0),q(this,"touchZoom",!0),q(this,"touchRotate",!1),q(this,"keyboard",!0),this.transitionManager=new gSe({...e,getControllerState:n=>new this.ControllerState(n),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){for(const n in this._events)if(this._events[n]){var e;(e=this.eventManager)===null||e===void 0||e.off(n,this.handleEvent)}this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const n=this._eventStartBlocked;switch(e.type){case"panstart":return n?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return n?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"tripanstart":return n?!1:this._onTriplePanStart(e);case"tripanmove":return this._onTriplePan(e);case"tripanend":return this._onTriplePanEnd(e);case"doubletap":return this._onDoubleTap(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:n,y:r}=this.props,{offsetCenter:i}=e;return[i.x-n,i.y-r]}isPointInBounds(e,n){const{width:r,height:i}=this.props;if(n&&n.handled)return!1;const o=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return o&&n&&n.stopPropagation(),o}isFunctionKeyPressed(e){const{srcEvent:n}=e;return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const n=setTimeout(()=>{this._eventStartBlocked===n&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=n}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:n}=e;this.inertia=Number.isFinite(n)?n:n===!0?_Se:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:o=!0,doubleClickZoom:a=!0,touchZoom:s=!0,touchRotate:u=!1,keyboard:d=!0}=e,g=!!this.onViewStateChange;this.toggleEvents(by.WHEEL,g&&r),this.toggleEvents(by.PAN,g),this.toggleEvents(by.PINCH,g&&(s||u)),this.toggleEvents(by.TRIPLE_PAN,g&&u),this.toggleEvents(by.DOUBLE_TAP,g&&a),this.toggleEvents(by.KEYBOARD,g&&d),this.scrollZoom=r,this.dragPan=i,this.dragRotate=o,this.doubleClickZoom=a,this.touchZoom=s,this.touchRotate=u,this.keyboard=d}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,n){this.eventManager&&e.forEach(r=>{this._events[r]!==n&&(this._events[r]=n,n?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,n=null,r={}){const i={...e.getViewportProps(),...n},o=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),o){const a=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:a})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:n});return this._panMove=r,this.updateViewport(i,hm,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const n=this.getCenter(e),r=this.controllerState.pan({pos:n});return this.updateViewport(r,hm,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:n}=this;if(this.dragPan&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],o=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:zS},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const n=this.getCenter(e),r=this.controllerState.rotate({pos:n});return this.updateViewport(r,hm,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:n}=this;if(this.dragRotate&&n&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*n/2,r[1]+e.velocityY*n/2],o=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:zS},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:o}=e;let a=2/(1+Math.exp(-Math.abs(o*r)));o<0&&a!==0&&(a=1/a);const s=this.controllerState.zoom({pos:n,scale:a});return this.updateViewport(s,{...this._getTransitionProps({around:n}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onTriplePanStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.rotateStart({pos:n});return this.updateViewport(r,hm,{isDragging:!0}),!0}_onTriplePan(e){if(!this.touchRotate||!this.isDragging())return!1;const n=this.getCenter(e);n[0]-=e.deltaX;const r=this.controllerState.rotate({pos:n});return this.updateViewport(r,hm,{isDragging:!0,isRotating:!0}),!0}_onTriplePanEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this;if(this.touchRotate&&n&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*n/2],o=this.controllerState.rotate({pos:i});this.updateViewport(o,{...this._getTransitionProps(),transitionDuration:n,transitionEasing:zS},{isDragging:!1,isRotating:!0}),this.blockEvents(n)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.controllerState.zoomStart({pos:n}).rotateStart({pos:n});return l0._startPinchRotation=e.rotation,l0._lastPinchEvent=e,this.updateViewport(r,hm,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let n=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);n=n.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;n=n.rotate({deltaAngleX:l0._startPinchRotation-r})}return this.updateViewport(n,hm,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),l0._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:n}=this,{_lastPinchEvent:r}=l0;if(this.touchZoom&&n&&r&&e.scale!==r.scale){const i=this.getCenter(e);let o=this.controllerState.rotateEnd();const a=Math.log2(e.scale),s=(a-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),u=Math.pow(2,a+s*n/2);o=o.zoom({pos:i,scale:u}).zoomEnd(),this.updateViewport(o,{...this._getTransitionProps({around:i}),transitionDuration:n,transitionEasing:zS},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(n)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return l0._startPinchRotation=null,l0._lastPinchEvent=null,!0}_onDoubleTap(e){if(!this.doubleClickZoom)return!1;const n=this.getCenter(e);if(!this.isPointInBounds(n,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:n,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:n}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const n=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:o,rotateSpeedY:a}=this.keyboard===!0?{}:this.keyboard,{controllerState:s}=this;let u;const d={};switch(e.srcEvent.code){case"Minus":u=n?s.zoomOut(r).zoomOut(r):s.zoomOut(r),d.isZooming=!0;break;case"Equal":u=n?s.zoomIn(r).zoomIn(r):s.zoomIn(r),d.isZooming=!0;break;case"ArrowLeft":n?(u=s.rotateLeft(o),d.isRotating=!0):(u=s.moveLeft(i),d.isPanning=!0);break;case"ArrowRight":n?(u=s.rotateRight(o),d.isRotating=!0):(u=s.moveRight(i),d.isPanning=!0);break;case"ArrowUp":n?(u=s.rotateUp(a),d.isRotating=!0):(u=s.moveUp(i),d.isPanning=!0);break;case"ArrowDown":n?(u=s.rotateDown(a),d.isRotating=!0):(u=s.moveDown(i),d.isPanning=!0);break;default:return!1}return this.updateViewport(u,this._getTransitionProps(),d),!0}_getTransitionProps(e){const{transition:n}=this;return!n||!n.transitionInterpolator?hm:e?{...n,transitionInterpolator:new h_({...e,...n.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:n}}class Z5{constructor(e,n){q(this,"_viewportProps",void 0),q(this,"_state",void 0),this._viewportProps=this.applyConstraints(e),this._state=n}getViewportProps(){return this._viewportProps}getState(){return this._state}}const eH=5,ySe=1.2;class Bne extends Z5{constructor(e){const{width:n,height:r,latitude:i,longitude:o,zoom:a,bearing:s=0,pitch:u=0,altitude:d=1.5,position:g=[0,0,0],maxZoom:_=20,minZoom:E=0,maxPitch:P=60,minPitch:O=0,startPanLngLat:D,startZoomLngLat:V,startRotatePos:k,startBearing:F,startPitch:z,startZoom:X,normalize:Y=!0}=e;ia(Number.isFinite(o)),ia(Number.isFinite(i)),ia(Number.isFinite(a)),super({width:n,height:r,latitude:i,longitude:o,zoom:a,bearing:s,pitch:u,altitude:d,maxZoom:_,minZoom:E,maxPitch:P,minPitch:O,normalize:Y,position:g},{startPanLngLat:D,startZoomLngLat:V,startRotatePos:k,startBearing:F,startPitch:z,startZoom:X}),q(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:n}){const r=this.getState().startPanLngLat||this._unproject(n);if(!r)return this;const o=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(o)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:o,startPitch:a}=this.getState();if(!i||o===void 0||a===void 0)return this;let s;return e?s=this._getNewRotation(e,i,a,o):s={bearing:o+n,pitch:a+r},this._getUpdatedState(s)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomLngLat:o}=this.getState();if(o||(i=this.getViewportProps().zoom,o=this._unproject(n)||this._unproject(e)),!o)return this;const{maxZoom:a,minZoom:s}=this.getViewportProps();let u=i+Math.log2(r);u=Wi(u,s,a);const d=this.makeViewport({...this.getViewportProps(),zoom:u});return this._getUpdatedState({zoom:u,...d.panByPosition(o,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:o}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(o-n.longitude)>180&&(r.longitude=o<0?o+360:o-360),r}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Wi(i,r,n);const{maxPitch:o,minPitch:a,pitch:s}=e;e.pitch=Wi(s,a,o);const{normalize:u=!0}=e;return u&&Object.assign(e,bne(e)),e}_zoomFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.zoom({pos:[n/2,r/2],scale:e})}_panFromCenter(e){const{width:n,height:r}=this.getViewportProps();return this.pan({startPos:[n/2,r/2],pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_getNewRotation(e,n,r,i){const o=e[0]-n[0],a=e[1]-n[1],s=e[1],u=n[1],{width:d,height:g}=this.getViewportProps(),_=o/d;let E=0;a>0?Math.abs(g-u)>eH&&(E=a/(u-g)*ySe):a<0&&u>eH&&(E=1-s/u),E=Wi(E,-1,1);const{minPitch:P,maxPitch:O}=this.getViewportProps(),D=i+180*_;let V=r;return E>0?V=r+E*(O-r):E<0&&(V=r-E*(P-r)),{pitch:V,bearing:D}}}class Nne extends F1{constructor(...e){super(...e),q(this,"ControllerState",Bne),q(this,"transition",{transitionDuration:300,transitionInterpolator:new h_({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})}),q(this,"dragMode","pan")}setProps(e){e.position=e.position||[0,0,0];const n=this.props;super.setProps(e),(!n||n.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class QO extends Sh{get ViewportType(){return ug}get ControllerType(){return Nne}}q(QO,"displayName","MapView");const vSe=new W5;function xSe(t,e){var n,r;const i=(n=t.order)!==null&&n!==void 0?n:1/0,o=(r=e.order)!==null&&r!==void 0?r:1/0;return i-o}class bSe{constructor(){q(this,"effects",void 0),q(this,"_resolvedEffects",[]),q(this,"_defaultEffects",[]),q(this,"_needsRedraw",void 0),this.effects=[],this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const n=this._defaultEffects;if(!n.find(r=>r.id===e.id)){const r=n.findIndex(i=>xSe(i,e)>0);r<0?n.push(e):n.splice(r,0,e),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(uc(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}getEffects(){return this._resolvedEffects}_setEffects(e){const n={};for(const i of this.effects)n[i.id]=i;const r=[];for(const i of e){const o=n[i.id];o&&o!==i?o.setProps?(o.setProps(i.props),r.push(o)):(o.cleanup(),r.push(i)):r.push(i),delete n[i.id]}for(const i in n)n[i].cleanup();this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof W5)||this._resolvedEffects.push(vSe),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup();this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class wSe extends XO{shouldDrawLayer(e){const{operation:n}=e.props;return n.includes("draw")||n.includes("terrain")}}const ESe="deckRenderer.renderLayers";class Fne{constructor(e){q(this,"gl",void 0),q(this,"layerFilter",void 0),q(this,"drawPickingColors",void 0),q(this,"drawLayersPass",void 0),q(this,"pickLayersPass",void 0),q(this,"renderCount",void 0),q(this,"_needsRedraw",void 0),q(this,"renderBuffers",void 0),q(this,"lastPostProcessEffect",void 0),this.gl=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new wSe(e),this.pickLayersPass=new q5(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const n=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e,target:e.target||Ws.getDefaultFramebuffer(this.gl)};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target,o=n.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,_l(ESe,this,o,e)}needsRedraw(e={clearRedrawFlags:!1}){const n=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),n}finalize(){const{renderBuffers:e}=this;for(const n of e)n.delete();e.length=0}_preRender(e,n){this.lastPostProcessEffect=null,n.preRenderStats=n.preRenderStats||{};for(const r of e)n.preRenderStats[r.id]=r.preRender(this.gl,n),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this;e.length===0&&e.push(new Ws(this.gl),new Ws(this.gl));for(const n of e)n.resize()}_postRender(e,n){const{renderBuffers:r}=this,i={...n,inputBuffer:r[0],swapBuffer:r[1],target:null};for(const o of e)if(o.postRender){if(o.id===this.lastPostProcessEffect){i.target=n.target,o.postRender(this.gl,i);break}const a=o.postRender(this.gl,i);i.inputBuffer=a,i.swapBuffer=a===r[0]?r[1]:r[0]}}}const SSe={pickedColor:null,pickedObjectIndex:-1};function TSe({pickedColors:t,decodePickingColor:e,deviceX:n,deviceY:r,deviceRadius:i,deviceRect:o}){const{x:a,y:s,width:u,height:d}=o;let g=i*i,_=-1,E=0;for(let P=0;P<d;P++){const O=P+s-r,D=O*O;if(D>g)E+=4*u;else for(let V=0;V<u;V++){if(t[E+3]-1>=0){const F=V+a-n,z=F*F+D;z<=g&&(g=z,_=E)}E+=4}}if(_>=0){const P=t.slice(_,_+4),O=e(P);if(O){const D=Math.floor(_/4/u),V=_/4-D*u;return{...O,pickedColor:P,pickedX:a+V,pickedY:s+D}}Or.error("Picked non-existent layer. Is picking buffer corrupt?")()}return SSe}function CSe({pickedColors:t,decodePickingColor:e}){const n=new Map;if(t){for(let r=0;r<t.length;r+=4)if(t[r+3]-1>=0){const o=t.slice(r,r+4),a=o.join(",");if(!n.has(a)){const s=e(o);s?n.set(a,{...s,color:o}):Or.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(n.values())}function kne({pickInfo:t,viewports:e,pixelRatio:n,x:r,y:i,z:o}){let a=e[0];e.length>1&&(a=ISe((t==null?void 0:t.pickedViewports)||e,{x:r,y:i}));let s;if(a){const u=[r-a.x,i-a.y];o!==void 0&&(u[2]=o),s=a.unproject(u)}return{color:null,layer:null,viewport:a,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:s,devicePixel:t&&"pickedX"in t?[t.pickedX,t.pickedY]:void 0,pixelRatio:n}}function PSe(t){const{pickInfo:e,lastPickedInfo:n,mode:r,layers:i}=t,{pickedColor:o,pickedLayer:a,pickedObjectIndex:s}=e,u=a?[a]:[];if(r==="hover"){const _=n.index,E=n.layerId,P=a?a.props.id:null;if(P!==E||s!==_){if(P!==E){const O=i.find(D=>D.props.id===E);O&&u.unshift(O)}n.layerId=P,n.index=s,n.info=null}}const d=kne(t),g=new Map;return g.set(null,d),u.forEach(_=>{let E={...d};_===a&&(E.color=o,E.index=s,E.picked=!0),E=zne({layer:_,info:E,mode:r});const P=E.layer;_===a&&r==="hover"&&(n.info=E),g.set(P.id,E),r==="hover"&&P.updateAutoHighlight(E)}),g}function zne({layer:t,info:e,mode:n}){for(;t&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=t,e=t.getPickingInfo({info:e,mode:n,sourceLayer:r}),t=t.parent}return e}function ISe(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.containsPixel(e))return r}return t[0]}class MSe{constructor(e){q(this,"gl",void 0),q(this,"pickingFBO",void 0),q(this,"depthFBO",void 0),q(this,"pickLayersPass",void 0),q(this,"layerFilter",void 0),q(this,"lastPickedInfo",void 0),q(this,"_pickable",!0),this.gl=e,this.pickLayersPass=new q5(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.delete(),this.depthFBO&&(this.depthFBO.color.delete(),this.depthFBO.delete())}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:n,layers:r,viewports:i},o=this.lastPickedInfo.info){const a=o&&o.layer&&o.layer.id,s=o&&o.viewport&&o.viewport.id,u=a?r.find(E=>E.id===a):null,d=s&&i.find(E=>E.id===s)||i[0],g=d&&d.unproject([e-d.x,n-d.y]);return{...o,...{x:e,y:n,viewport:d,coordinate:g,layer:u}}}_resizeBuffer(){var e,n;const{gl:r}=this;if(!this.pickingFBO&&(this.pickingFBO=new Ws(r),Ws.isSupported(r,{colorBufferFloat:!0}))){const i=new Ws(r);i.attach({36064:new Pl(r,{format:Hr(r)?34836:6408,type:5126})}),this.depthFBO=i}(e=this.pickingFBO)===null||e===void 0||e.resize({width:r.canvas.width,height:r.canvas.height}),(n=this.depthFBO)===null||n===void 0||n.resize({width:r.canvas.width,height:r.canvas.height})}_getPickable(e){if(this._pickable===!1)return null;const n=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return n.length?n:null}_pickClosestObject({layers:e,views:n,viewports:r,x:i,y:o,radius:a=0,depth:s=1,mode:u="query",unproject3D:d,onViewportActive:g,effects:_}){const E=this._getPickable(e),P=B0(this.gl);if(!E)return{result:[],emptyInfo:kne({viewports:r,x:i,y:o,pixelRatio:P})};this._resizeBuffer();const O=oC(this.gl,[i,o],!0),D=[O.x+Math.floor(O.width/2),O.y+Math.floor(O.height/2)],V=Math.round(a*P),{width:k,height:F}=this.pickingFBO,z=this._getPickingRect({deviceX:D[0],deviceY:D[1],deviceRadius:V,deviceWidth:k,deviceHeight:F}),X={x:i-a,y:o-a,width:a*2+1,height:a*2+1};let Y;const J=[],re=new Set;for(let ue=0;ue<s;ue++){let ie;if(z){const se=this._drawAndSample({layers:E,views:n,viewports:r,onViewportActive:g,deviceRect:z,cullRect:X,effects:_,pass:"picking:".concat(u)});ie=TSe({...se,deviceX:D[0],deviceY:D[1],deviceRadius:V,deviceRect:z})}else ie={pickedColor:null,pickedObjectIndex:-1};let ce;if(ie.pickedLayer&&d&&this.depthFBO){const{pickedColors:se}=this._drawAndSample({layers:[ie.pickedLayer],views:n,viewports:r,onViewportActive:g,deviceRect:{x:ie.pickedX,y:ie.pickedY,width:1,height:1},cullRect:X,effects:_,pass:"picking:".concat(u,":z")},!0);se[3]&&(ce=se[0])}ie.pickedLayer&&ue+1<s&&(re.add(ie.pickedLayer),ie.pickedLayer.disablePickingIndex(ie.pickedObjectIndex)),Y=PSe({pickInfo:ie,lastPickedInfo:this.lastPickedInfo,mode:u,layers:E,viewports:r,x:i,y:o,z:ce,pixelRatio:P});for(const se of Y.values())se.layer&&J.push(se);if(!ie.pickedColor)break}for(const ue of re)ue.restorePickingColors();return{result:J,emptyInfo:Y.get(null)}}_pickVisibleObjects({layers:e,views:n,viewports:r,x:i,y:o,width:a=1,height:s=1,mode:u="query",maxObjects:d=null,onViewportActive:g,effects:_}){const E=this._getPickable(e);if(!E)return[];this._resizeBuffer();const P=B0(this.gl),O=oC(this.gl,[i,o],!0),D=O.x,V=O.y+O.height,k=oC(this.gl,[i+a,o+s],!0),F=k.x+k.width,z=k.y,X={x:D,y:z,width:F-D,height:V-z},Y=this._drawAndSample({layers:E,views:n,viewports:r,onViewportActive:g,deviceRect:X,cullRect:{x:i,y:o,width:a,height:s},effects:_,pass:"picking:".concat(u)}),J=CSe(Y),re=new Map,ue=Number.isFinite(d);for(let ie=0;ie<J.length&&!(ue&&d&&re.size>=d);ie++){const ce=J[ie];let se={color:ce.pickedColor,layer:null,index:ce.pickedObjectIndex,picked:!0,x:i,y:o,pixelRatio:P};se=zne({layer:ce.pickedLayer,info:se,mode:u}),re.has(se.object)||re.set(se.object,se)}return Array.from(re.values())}_drawAndSample({layers:e,views:n,viewports:r,onViewportActive:i,deviceRect:o,cullRect:a,effects:s,pass:u},d=!1){const g=d?this.depthFBO:this.pickingFBO,_={layers:e,layerFilter:this.layerFilter,views:n,viewports:r,onViewportActive:i,pickingFBO:g,deviceRect:o,cullRect:a,effects:s,pass:u,pickZ:d,preRenderStats:{}};for(const F of s)F.useInPicking&&(_.preRenderStats[F.id]=F.preRender(this.gl,_));const{decodePickingColor:E}=this.pickLayersPass.render(_),{x:P,y:O,width:D,height:V}=o,k=new(d?Float32Array:Uint8Array)(D*V*4);return NE(g,{sourceX:P,sourceY:O,sourceWidth:D,sourceHeight:V,target:k}),{pickedColors:k,decodePickingColor:E}}_getPickingRect({deviceX:e,deviceY:n,deviceRadius:r,deviceWidth:i,deviceHeight:o}){const a=Math.max(0,e-r),s=Math.max(0,n-r),u=Math.min(i,e+r+1)-a,d=Math.min(o,n+r+1)-s;return u<=0||d<=0?null:{x:a,y:s,width:u,height:d}}}const OSe={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};let RSe=class{constructor(e){q(this,"el",null),q(this,"isVisible",!1);const n=e.parentElement;n&&(this.el=document.createElement("div"),this.el.className="deck-tooltip",Object.assign(this.el.style,OSe),n.appendChild(this.el))}setTooltip(e,n,r){const i=this.el;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform="translate(".concat(n,"px, ").concat(r,"px)"),e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}remove(){this.el&&(this.el.remove(),this.el=null)}};var Une={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */(function(t){(function(e,n,r,i){var o=["","webkit","Moz","MS","ms","o"],a=n.createElement("div"),s="function",u=Math.round,d=Math.abs,g=Date.now;function _(ye,Oe,He){return setTimeout(z(ye,He),Oe)}function E(ye,Oe,He){return Array.isArray(ye)?(P(ye,He[Oe],He),!0):!1}function P(ye,Oe,He){var Ot;if(ye)if(ye.forEach)ye.forEach(Oe,He);else if(ye.length!==i)for(Ot=0;Ot<ye.length;)Oe.call(He,ye[Ot],Ot,ye),Ot++;else for(Ot in ye)ye.hasOwnProperty(Ot)&&Oe.call(He,ye[Ot],Ot,ye)}function O(ye,Oe,He){var Ot="DEPRECATED METHOD: "+Oe+`
`+He+` AT 
`;return function(){var on=new Error("get-stack-trace"),Fn=on&&on.stack?on.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Rr=e.console&&(e.console.warn||e.console.log);return Rr&&Rr.call(e.console,Ot,Fn),ye.apply(this,arguments)}}var D;typeof Object.assign!="function"?D=function(Oe){if(Oe===i||Oe===null)throw new TypeError("Cannot convert undefined or null to object");for(var He=Object(Oe),Ot=1;Ot<arguments.length;Ot++){var on=arguments[Ot];if(on!==i&&on!==null)for(var Fn in on)on.hasOwnProperty(Fn)&&(He[Fn]=on[Fn])}return He}:D=Object.assign;var V=O(function(Oe,He,Ot){for(var on=Object.keys(He),Fn=0;Fn<on.length;)(!Ot||Ot&&Oe[on[Fn]]===i)&&(Oe[on[Fn]]=He[on[Fn]]),Fn++;return Oe},"extend","Use `assign`."),k=O(function(Oe,He){return V(Oe,He,!0)},"merge","Use `assign`.");function F(ye,Oe,He){var Ot=Oe.prototype,on;on=ye.prototype=Object.create(Ot),on.constructor=ye,on._super=Ot,He&&D(on,He)}function z(ye,Oe){return function(){return ye.apply(Oe,arguments)}}function X(ye,Oe){return typeof ye==s?ye.apply(Oe&&Oe[0]||i,Oe):ye}function Y(ye,Oe){return ye===i?Oe:ye}function J(ye,Oe,He){P(ce(Oe),function(Ot){ye.addEventListener(Ot,He,!1)})}function re(ye,Oe,He){P(ce(Oe),function(Ot){ye.removeEventListener(Ot,He,!1)})}function ue(ye,Oe){for(;ye;){if(ye==Oe)return!0;ye=ye.parentNode}return!1}function ie(ye,Oe){return ye.indexOf(Oe)>-1}function ce(ye){return ye.trim().split(/\s+/g)}function se(ye,Oe,He){if(ye.indexOf&&!He)return ye.indexOf(Oe);for(var Ot=0;Ot<ye.length;){if(He&&ye[Ot][He]==Oe||!He&&ye[Ot]===Oe)return Ot;Ot++}return-1}function me(ye){return Array.prototype.slice.call(ye,0)}function Ce(ye,Oe,He){for(var Ot=[],on=[],Fn=0;Fn<ye.length;){var Rr=Oe?ye[Fn][Oe]:ye[Fn];se(on,Rr)<0&&Ot.push(ye[Fn]),on[Fn]=Rr,Fn++}return He&&(Oe?Ot=Ot.sort(function(Lr,ao){return Lr[Oe]>ao[Oe]}):Ot=Ot.sort()),Ot}function we(ye,Oe){for(var He,Ot,on=Oe[0].toUpperCase()+Oe.slice(1),Fn=0;Fn<o.length;){if(He=o[Fn],Ot=He?He+on:Oe,Ot in ye)return Ot;Fn++}return i}var Ye=1;function at(){return Ye++}function yt(ye){var Oe=ye.ownerDocument||ye;return Oe.defaultView||Oe.parentWindow||e}var be=/mobile|tablet|ip(ad|hone|od)|android/i,De="ontouchstart"in e,Re=we(e,"PointerEvent")!==i,qe=De&&be.test(navigator.userAgent),ct="touch",Ct="pen",Dt="mouse",In="kinect",Mn=25,Tn=1,Nt=2,Zt=4,Wt=8,hn=1,lr=2,It=4,Xt=8,$t=16,cn=lr|It,Jt=Xt|$t,Ln=cn|Jt,qn=["x","y"],or=["clientX","clientY"];function cr(ye,Oe){var He=this;this.manager=ye,this.callback=Oe,this.element=ye.element,this.target=ye.options.inputTarget,this.domHandler=function(Ot){X(ye.options.enable,[ye])&&He.handler(Ot)},this.init()}cr.prototype={handler:function(){},init:function(){this.evEl&&J(this.element,this.evEl,this.domHandler),this.evTarget&&J(this.target,this.evTarget,this.domHandler),this.evWin&&J(yt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&re(this.element,this.evEl,this.domHandler),this.evTarget&&re(this.target,this.evTarget,this.domHandler),this.evWin&&re(yt(this.element),this.evWin,this.domHandler)}};function cs(ye){var Oe,He=ye.options.inputClass;return He?Oe=He:Re?Oe=Me:qe?Oe=Qt:De?Oe=ot:Oe=Wu,new Oe(ye,Ri)}function Ri(ye,Oe,He){var Ot=He.pointers.length,on=He.changedPointers.length,Fn=Oe&Tn&&Ot-on===0,Rr=Oe&(Zt|Wt)&&Ot-on===0;He.isFirst=!!Fn,He.isFinal=!!Rr,Fn&&(ye.session={}),He.eventType=Oe,Do(ye,He),ye.emit("hammer.input",He),ye.recognize(He),ye.session.prevInput=He}function Do(ye,Oe){var He=ye.session,Ot=Oe.pointers,on=Ot.length;He.firstInput||(He.firstInput=_s(Oe)),on>1&&!He.firstMultiple?He.firstMultiple=_s(Oe):on===1&&(He.firstMultiple=!1);var Fn=He.firstInput,Rr=He.firstMultiple,Ao=Rr?Rr.center:Fn.center,Lr=Oe.center=mo(Ot);Oe.timeStamp=g(),Oe.deltaTime=Oe.timeStamp-Fn.timeStamp,Oe.angle=au(Ao,Lr),Oe.distance=kl(Ao,Lr),Fa(He,Oe),Oe.offsetDirection=su(Oe.deltaX,Oe.deltaY);var ao=Fl(Oe.deltaTime,Oe.deltaX,Oe.deltaY);Oe.overallVelocityX=ao.x,Oe.overallVelocityY=ao.y,Oe.overallVelocity=d(ao.x)>d(ao.y)?ao.x:ao.y,Oe.scale=Rr?lu(Rr.pointers,Ot):1,Oe.rotation=Rr?$u(Rr.pointers,Ot):0,Oe.maxPointers=He.prevInput?Oe.pointers.length>He.prevInput.maxPointers?Oe.pointers.length:He.prevInput.maxPointers:Oe.pointers.length,Nl(He,Oe);var vs=ye.element;ue(Oe.srcEvent.target,vs)&&(vs=Oe.srcEvent.target),Oe.target=vs}function Fa(ye,Oe){var He=Oe.center,Ot=ye.offsetDelta||{},on=ye.prevDelta||{},Fn=ye.prevInput||{};(Oe.eventType===Tn||Fn.eventType===Zt)&&(on=ye.prevDelta={x:Fn.deltaX||0,y:Fn.deltaY||0},Ot=ye.offsetDelta={x:He.x,y:He.y}),Oe.deltaX=on.x+(He.x-Ot.x),Oe.deltaY=on.y+(He.y-Ot.y)}function Nl(ye,Oe){var He=ye.lastInterval||Oe,Ot=Oe.timeStamp-He.timeStamp,on,Fn,Rr,Ao;if(Oe.eventType!=Wt&&(Ot>Mn||He.velocity===i)){var Lr=Oe.deltaX-He.deltaX,ao=Oe.deltaY-He.deltaY,vs=Fl(Ot,Lr,ao);Fn=vs.x,Rr=vs.y,on=d(vs.x)>d(vs.y)?vs.x:vs.y,Ao=su(Lr,ao),ye.lastInterval=Oe}else on=He.velocity,Fn=He.velocityX,Rr=He.velocityY,Ao=He.direction;Oe.velocity=on,Oe.velocityX=Fn,Oe.velocityY=Rr,Oe.direction=Ao}function _s(ye){for(var Oe=[],He=0;He<ye.pointers.length;)Oe[He]={clientX:u(ye.pointers[He].clientX),clientY:u(ye.pointers[He].clientY)},He++;return{timeStamp:g(),pointers:Oe,center:mo(Oe),deltaX:ye.deltaX,deltaY:ye.deltaY}}function mo(ye){var Oe=ye.length;if(Oe===1)return{x:u(ye[0].clientX),y:u(ye[0].clientY)};for(var He=0,Ot=0,on=0;on<Oe;)He+=ye[on].clientX,Ot+=ye[on].clientY,on++;return{x:u(He/Oe),y:u(Ot/Oe)}}function Fl(ye,Oe,He){return{x:Oe/ye||0,y:He/ye||0}}function su(ye,Oe){return ye===Oe?hn:d(ye)>=d(Oe)?ye<0?lr:It:Oe<0?Xt:$t}function kl(ye,Oe,He){He||(He=qn);var Ot=Oe[He[0]]-ye[He[0]],on=Oe[He[1]]-ye[He[1]];return Math.sqrt(Ot*Ot+on*on)}function au(ye,Oe,He){He||(He=qn);var Ot=Oe[He[0]]-ye[He[0]],on=Oe[He[1]]-ye[He[1]];return Math.atan2(on,Ot)*180/Math.PI}function $u(ye,Oe){return au(Oe[1],Oe[0],or)+au(ye[1],ye[0],or)}function lu(ye,Oe){return kl(Oe[0],Oe[1],or)/kl(ye[0],ye[1],or)}var Hu={mousedown:Tn,mousemove:Nt,mouseup:Zt},uu="mousedown",Fc="mousemove mouseup";function Wu(){this.evEl=uu,this.evWin=Fc,this.pressed=!1,cr.apply(this,arguments)}F(Wu,cr,{handler:function(Oe){var He=Hu[Oe.type];He&Tn&&Oe.button===0&&(this.pressed=!0),He&Nt&&Oe.which!==1&&(He=Zt),this.pressed&&(He&Zt&&(this.pressed=!1),this.callback(this.manager,He,{pointers:[Oe],changedPointers:[Oe],pointerType:Dt,srcEvent:Oe}))}});var Ge={pointerdown:Tn,pointermove:Nt,pointerup:Zt,pointercancel:Wt,pointerout:Wt},ge={2:ct,3:Ct,4:Dt,5:In},Ae="pointerdown",ze="pointermove pointerup pointercancel";e.MSPointerEvent&&!e.PointerEvent&&(Ae="MSPointerDown",ze="MSPointerMove MSPointerUp MSPointerCancel");function Me(){this.evEl=Ae,this.evWin=ze,cr.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}F(Me,cr,{handler:function(Oe){var He=this.store,Ot=!1,on=Oe.type.toLowerCase().replace("ms",""),Fn=Ge[on],Rr=ge[Oe.pointerType]||Oe.pointerType,Ao=Rr==ct,Lr=se(He,Oe.pointerId,"pointerId");Fn&Tn&&(Oe.button===0||Ao)?Lr<0&&(He.push(Oe),Lr=He.length-1):Fn&(Zt|Wt)&&(Ot=!0),!(Lr<0)&&(He[Lr]=Oe,this.callback(this.manager,Fn,{pointers:He,changedPointers:[Oe],pointerType:Rr,srcEvent:Oe}),Ot&&He.splice(Lr,1))}});var rt={touchstart:Tn,touchmove:Nt,touchend:Zt,touchcancel:Wt},ht="touchstart",ft="touchstart touchmove touchend touchcancel";function nt(){this.evTarget=ht,this.evWin=ft,this.started=!1,cr.apply(this,arguments)}F(nt,cr,{handler:function(Oe){var He=rt[Oe.type];if(He===Tn&&(this.started=!0),!!this.started){var Ot=wt.call(this,Oe,He);He&(Zt|Wt)&&Ot[0].length-Ot[1].length===0&&(this.started=!1),this.callback(this.manager,He,{pointers:Ot[0],changedPointers:Ot[1],pointerType:ct,srcEvent:Oe})}}});function wt(ye,Oe){var He=me(ye.touches),Ot=me(ye.changedTouches);return Oe&(Zt|Wt)&&(He=Ce(He.concat(Ot),"identifier",!0)),[He,Ot]}var sn={touchstart:Tn,touchmove:Nt,touchend:Zt,touchcancel:Wt},dn="touchstart touchmove touchend touchcancel";function Qt(){this.evTarget=dn,this.targetIds={},cr.apply(this,arguments)}F(Qt,cr,{handler:function(Oe){var He=sn[Oe.type],Ot=sr.call(this,Oe,He);Ot&&this.callback(this.manager,He,{pointers:Ot[0],changedPointers:Ot[1],pointerType:ct,srcEvent:Oe})}});function sr(ye,Oe){var He=me(ye.touches),Ot=this.targetIds;if(Oe&(Tn|Nt)&&He.length===1)return Ot[He[0].identifier]=!0,[He,He];var on,Fn,Rr=me(ye.changedTouches),Ao=[],Lr=this.target;if(Fn=He.filter(function(ao){return ue(ao.target,Lr)}),Oe===Tn)for(on=0;on<Fn.length;)Ot[Fn[on].identifier]=!0,on++;for(on=0;on<Rr.length;)Ot[Rr[on].identifier]&&Ao.push(Rr[on]),Oe&(Zt|Wt)&&delete Ot[Rr[on].identifier],on++;if(Ao.length)return[Ce(Fn.concat(Ao),"identifier",!0),Ao]}var pr=2500,tr=25;function ot(){cr.apply(this,arguments);var ye=z(this.handler,this);this.touch=new Qt(this.manager,ye),this.mouse=new Wu(this.manager,ye),this.primaryTouch=null,this.lastTouches=[]}F(ot,cr,{handler:function(Oe,He,Ot){var on=Ot.pointerType==ct,Fn=Ot.pointerType==Dt;if(!(Fn&&Ot.sourceCapabilities&&Ot.sourceCapabilities.firesTouchEvents)){if(on)Pt.call(this,He,Ot);else if(Fn&&Gn.call(this,Ot))return;this.callback(Oe,He,Ot)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Pt(ye,Oe){ye&Tn?(this.primaryTouch=Oe.changedPointers[0].identifier,rn.call(this,Oe)):ye&(Zt|Wt)&&rn.call(this,Oe)}function rn(ye){var Oe=ye.changedPointers[0];if(Oe.identifier===this.primaryTouch){var He={x:Oe.clientX,y:Oe.clientY};this.lastTouches.push(He);var Ot=this.lastTouches,on=function(){var Fn=Ot.indexOf(He);Fn>-1&&Ot.splice(Fn,1)};setTimeout(on,pr)}}function Gn(ye){for(var Oe=ye.srcEvent.clientX,He=ye.srcEvent.clientY,Ot=0;Ot<this.lastTouches.length;Ot++){var on=this.lastTouches[Ot],Fn=Math.abs(Oe-on.x),Rr=Math.abs(He-on.y);if(Fn<=tr&&Rr<=tr)return!0}return!1}var w=we(a.style,"touchAction"),Ue=w!==i,Ir="compute",fr="auto",rr="manipulation",Tr="none",qi="pan-x",qr="pan-y",jn=kc();function ro(ye,Oe){this.manager=ye,this.set(Oe)}ro.prototype={set:function(ye){ye==Ir&&(ye=this.compute()),Ue&&this.manager.element.style&&jn[ye]&&(this.manager.element.style[w]=ye),this.actions=ye.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var ye=[];return P(this.manager.recognizers,function(Oe){X(Oe.options.enable,[Oe])&&(ye=ye.concat(Oe.getTouchAction()))}),ca(ye.join(" "))},preventDefaults:function(ye){var Oe=ye.srcEvent,He=ye.offsetDirection;if(this.manager.session.prevented){Oe.preventDefault();return}var Ot=this.actions,on=ie(Ot,Tr)&&!jn[Tr],Fn=ie(Ot,qr)&&!jn[qr],Rr=ie(Ot,qi)&&!jn[qi];if(on){var Ao=ye.pointers.length===1,Lr=ye.distance<2,ao=ye.deltaTime<250;if(Ao&&Lr&&ao)return}if(!(Rr&&Fn)&&(on||Fn&&He&cn||Rr&&He&Jt))return this.preventSrc(Oe)},preventSrc:function(ye){this.manager.session.prevented=!0,ye.preventDefault()}};function ca(ye){if(ie(ye,Tr))return Tr;var Oe=ie(ye,qi),He=ie(ye,qr);return Oe&&He?Tr:Oe||He?Oe?qi:qr:ie(ye,rr)?rr:fr}function kc(){if(!Ue)return!1;var ye={},Oe=e.CSS&&e.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(He){ye[He]=Oe?e.CSS.supports("touch-action",He):!0}),ye}var zl=1,Qr=2,Vo=4,Bo=8,ka=Bo,$o=16,Hn=32;function Ke(ye){this.options=D({},this.defaults,ye||{}),this.id=at(),this.manager=null,this.options.enable=Y(this.options.enable,!0),this.state=zl,this.simultaneous={},this.requireFail=[]}Ke.prototype={defaults:{},set:function(ye){return D(this.options,ye),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(ye){if(E(ye,"recognizeWith",this))return this;var Oe=this.simultaneous;return ye=Vi(ye,this),Oe[ye.id]||(Oe[ye.id]=ye,ye.recognizeWith(this)),this},dropRecognizeWith:function(ye){return E(ye,"dropRecognizeWith",this)?this:(ye=Vi(ye,this),delete this.simultaneous[ye.id],this)},requireFailure:function(ye){if(E(ye,"requireFailure",this))return this;var Oe=this.requireFail;return ye=Vi(ye,this),se(Oe,ye)===-1&&(Oe.push(ye),ye.requireFailure(this)),this},dropRequireFailure:function(ye){if(E(ye,"dropRequireFailure",this))return this;ye=Vi(ye,this);var Oe=se(this.requireFail,ye);return Oe>-1&&this.requireFail.splice(Oe,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(ye){return!!this.simultaneous[ye.id]},emit:function(ye){var Oe=this,He=this.state;function Ot(on){Oe.manager.emit(on,ye)}He<Bo&&Ot(Oe.options.event+pt(He)),Ot(Oe.options.event),ye.additionalEvent&&Ot(ye.additionalEvent),He>=Bo&&Ot(Oe.options.event+pt(He))},tryEmit:function(ye){if(this.canEmit())return this.emit(ye);this.state=Hn},canEmit:function(){for(var ye=0;ye<this.requireFail.length;){if(!(this.requireFail[ye].state&(Hn|zl)))return!1;ye++}return!0},recognize:function(ye){var Oe=D({},ye);if(!X(this.options.enable,[this,Oe])){this.reset(),this.state=Hn;return}this.state&(ka|$o|Hn)&&(this.state=zl),this.state=this.process(Oe),this.state&(Qr|Vo|Bo|$o)&&this.tryEmit(Oe)},process:function(ye){},getTouchAction:function(){},reset:function(){}};function pt(ye){return ye&$o?"cancel":ye&Bo?"end":ye&Vo?"move":ye&Qr?"start":""}function za(ye){return ye==$t?"down":ye==Xt?"up":ye==lr?"left":ye==It?"right":""}function Vi(ye,Oe){var He=Oe.manager;return He?He.get(ye):ye}function gi(){Ke.apply(this,arguments)}F(gi,Ke,{defaults:{pointers:1},attrTest:function(ye){var Oe=this.options.pointers;return Oe===0||ye.pointers.length===Oe},process:function(ye){var Oe=this.state,He=ye.eventType,Ot=Oe&(Qr|Vo),on=this.attrTest(ye);return Ot&&(He&Wt||!on)?Oe|$o:Ot||on?He&Zt?Oe|Bo:Oe&Qr?Oe|Vo:Qr:Hn}});function Nf(){gi.apply(this,arguments),this.pX=null,this.pY=null}F(Nf,gi,{defaults:{event:"pan",threshold:10,pointers:1,direction:Ln},getTouchAction:function(){var ye=this.options.direction,Oe=[];return ye&cn&&Oe.push(qr),ye&Jt&&Oe.push(qi),Oe},directionTest:function(ye){var Oe=this.options,He=!0,Ot=ye.distance,on=ye.direction,Fn=ye.deltaX,Rr=ye.deltaY;return on&Oe.direction||(Oe.direction&cn?(on=Fn===0?hn:Fn<0?lr:It,He=Fn!=this.pX,Ot=Math.abs(ye.deltaX)):(on=Rr===0?hn:Rr<0?Xt:$t,He=Rr!=this.pY,Ot=Math.abs(ye.deltaY))),ye.direction=on,He&&Ot>Oe.threshold&&on&Oe.direction},attrTest:function(ye){return gi.prototype.attrTest.call(this,ye)&&(this.state&Qr||!(this.state&Qr)&&this.directionTest(ye))},emit:function(ye){this.pX=ye.deltaX,this.pY=ye.deltaY;var Oe=za(ye.direction);Oe&&(ye.additionalEvent=this.options.event+Oe),this._super.emit.call(this,ye)}});function fa(){gi.apply(this,arguments)}F(fa,gi,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Tr]},attrTest:function(ye){return this._super.attrTest.call(this,ye)&&(Math.abs(ye.scale-1)>this.options.threshold||this.state&Qr)},emit:function(ye){if(ye.scale!==1){var Oe=ye.scale<1?"in":"out";ye.additionalEvent=this.options.event+Oe}this._super.emit.call(this,ye)}});function Ve(){Ke.apply(this,arguments),this._timer=null,this._input=null}F(Ve,Ke,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[fr]},process:function(ye){var Oe=this.options,He=ye.pointers.length===Oe.pointers,Ot=ye.distance<Oe.threshold,on=ye.deltaTime>Oe.time;if(this._input=ye,!Ot||!He||ye.eventType&(Zt|Wt)&&!on)this.reset();else if(ye.eventType&Tn)this.reset(),this._timer=_(function(){this.state=ka,this.tryEmit()},Oe.time,this);else if(ye.eventType&Zt)return ka;return Hn},reset:function(){clearTimeout(this._timer)},emit:function(ye){this.state===ka&&(ye&&ye.eventType&Zt?this.manager.emit(this.options.event+"up",ye):(this._input.timeStamp=g(),this.manager.emit(this.options.event,this._input)))}});function $h(){gi.apply(this,arguments)}F($h,gi,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Tr]},attrTest:function(ye){return this._super.attrTest.call(this,ye)&&(Math.abs(ye.rotation)>this.options.threshold||this.state&Qr)}});function cu(){gi.apply(this,arguments)}F(cu,gi,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:cn|Jt,pointers:1},getTouchAction:function(){return Nf.prototype.getTouchAction.call(this)},attrTest:function(ye){var Oe=this.options.direction,He;return Oe&(cn|Jt)?He=ye.overallVelocity:Oe&cn?He=ye.overallVelocityX:Oe&Jt&&(He=ye.overallVelocityY),this._super.attrTest.call(this,ye)&&Oe&ye.offsetDirection&&ye.distance>this.options.threshold&&ye.maxPointers==this.options.pointers&&d(He)>this.options.velocity&&ye.eventType&Zt},emit:function(ye){var Oe=za(ye.offsetDirection);Oe&&this.manager.emit(this.options.event+Oe,ye),this.manager.emit(this.options.event,ye)}});function _n(){Ke.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}F(_n,Ke,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[rr]},process:function(ye){var Oe=this.options,He=ye.pointers.length===Oe.pointers,Ot=ye.distance<Oe.threshold,on=ye.deltaTime<Oe.time;if(this.reset(),ye.eventType&Tn&&this.count===0)return this.failTimeout();if(Ot&&on&&He){if(ye.eventType!=Zt)return this.failTimeout();var Fn=this.pTime?ye.timeStamp-this.pTime<Oe.interval:!0,Rr=!this.pCenter||kl(this.pCenter,ye.center)<Oe.posThreshold;this.pTime=ye.timeStamp,this.pCenter=ye.center,!Rr||!Fn?this.count=1:this.count+=1,this._input=ye;var Ao=this.count%Oe.taps;if(Ao===0)return this.hasRequireFailures()?(this._timer=_(function(){this.state=ka,this.tryEmit()},Oe.interval,this),Qr):ka}return Hn},failTimeout:function(){return this._timer=_(function(){this.state=Hn},this.options.interval,this),Hn},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ka&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function ur(ye,Oe){return Oe=Oe||{},Oe.recognizers=Y(Oe.recognizers,ur.defaults.preset),new Rs(ye,Oe)}ur.VERSION="2.0.7",ur.defaults={domEvents:!1,touchAction:Ir,enable:!0,inputTarget:null,inputClass:null,preset:[[$h,{enable:!1}],[fa,{enable:!1},["rotate"]],[cu,{direction:cn}],[Nf,{direction:cn},["swipe"]],[_n],[_n,{event:"doubletap",taps:2},["tap"]],[Ve]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Cr=1,Os=2;function Rs(ye,Oe){this.options=D({},ur.defaults,Oe||{}),this.options.inputTarget=this.options.inputTarget||ye,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=ye,this.input=cs(this),this.touchAction=new ro(this,this.options.touchAction),xr(this,!0),P(this.options.recognizers,function(He){var Ot=this.add(new He[0](He[1]));He[2]&&Ot.recognizeWith(He[2]),He[3]&&Ot.requireFailure(He[3])},this)}Rs.prototype={set:function(ye){return D(this.options,ye),ye.touchAction&&this.touchAction.update(),ye.inputTarget&&(this.input.destroy(),this.input.target=ye.inputTarget,this.input.init()),this},stop:function(ye){this.session.stopped=ye?Os:Cr},recognize:function(ye){var Oe=this.session;if(!Oe.stopped){this.touchAction.preventDefaults(ye);var He,Ot=this.recognizers,on=Oe.curRecognizer;(!on||on&&on.state&ka)&&(on=Oe.curRecognizer=null);for(var Fn=0;Fn<Ot.length;)He=Ot[Fn],Oe.stopped!==Os&&(!on||He==on||He.canRecognizeWith(on))?He.recognize(ye):He.reset(),!on&&He.state&(Qr|Vo|Bo)&&(on=Oe.curRecognizer=He),Fn++}},get:function(ye){if(ye instanceof Ke)return ye;for(var Oe=this.recognizers,He=0;He<Oe.length;He++)if(Oe[He].options.event==ye)return Oe[He];return null},add:function(ye){if(E(ye,"add",this))return this;var Oe=this.get(ye.options.event);return Oe&&this.remove(Oe),this.recognizers.push(ye),ye.manager=this,this.touchAction.update(),ye},remove:function(ye){if(E(ye,"remove",this))return this;if(ye=this.get(ye),ye){var Oe=this.recognizers,He=se(Oe,ye);He!==-1&&(Oe.splice(He,1),this.touchAction.update())}return this},on:function(ye,Oe){if(ye!==i&&Oe!==i){var He=this.handlers;return P(ce(ye),function(Ot){He[Ot]=He[Ot]||[],He[Ot].push(Oe)}),this}},off:function(ye,Oe){if(ye!==i){var He=this.handlers;return P(ce(ye),function(Ot){Oe?He[Ot]&&He[Ot].splice(se(He[Ot],Oe),1):delete He[Ot]}),this}},emit:function(ye,Oe){this.options.domEvents&&ys(ye,Oe);var He=this.handlers[ye]&&this.handlers[ye].slice();if(!(!He||!He.length)){Oe.type=ye,Oe.preventDefault=function(){Oe.srcEvent.preventDefault()};for(var Ot=0;Ot<He.length;)He[Ot](Oe),Ot++}},destroy:function(){this.element&&xr(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function xr(ye,Oe){var He=ye.element;if(He.style){var Ot;P(ye.options.cssProps,function(on,Fn){Ot=we(He.style,Fn),Oe?(ye.oldCssProps[Ot]=He.style[Ot],He.style[Ot]=on):He.style[Ot]=ye.oldCssProps[Ot]||""}),Oe||(ye.oldCssProps={})}}function ys(ye,Oe){var He=n.createEvent("Event");He.initEvent(ye,!0,!0),He.gesture=Oe,Oe.target.dispatchEvent(He)}D(ur,{INPUT_START:Tn,INPUT_MOVE:Nt,INPUT_END:Zt,INPUT_CANCEL:Wt,STATE_POSSIBLE:zl,STATE_BEGAN:Qr,STATE_CHANGED:Vo,STATE_ENDED:Bo,STATE_RECOGNIZED:ka,STATE_CANCELLED:$o,STATE_FAILED:Hn,DIRECTION_NONE:hn,DIRECTION_LEFT:lr,DIRECTION_RIGHT:It,DIRECTION_UP:Xt,DIRECTION_DOWN:$t,DIRECTION_HORIZONTAL:cn,DIRECTION_VERTICAL:Jt,DIRECTION_ALL:Ln,Manager:Rs,Input:cr,TouchAction:ro,TouchInput:Qt,MouseInput:Wu,PointerEventInput:Me,TouchMouseInput:ot,SingleTouchInput:nt,Recognizer:Ke,AttrRecognizer:gi,Tap:_n,Pan:Nf,Swipe:cu,Pinch:fa,Rotate:$h,Press:Ve,on:J,off:re,each:P,merge:k,extend:V,assign:D,inherit:F,bindFn:z,prefixed:we});var Ls=typeof e<"u"?e:typeof self<"u"?self:{};Ls.Hammer=ur,typeof i=="function"&&i.amd?i(function(){return ur}):t.exports?t.exports=ur:e[r]=ur})(window,document,"Hammer")})(Une);var VE=Une.exports;const LSe=_A(VE),dd=lz({__proto__:null,default:LSe},[VE]),Gne=1,jne=2,XF=4,DSe={mousedown:Gne,mousemove:jne,mouseup:XF};function BSe(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return!0;return!1}function NSe(t){const e=t.prototype.handler;t.prototype.handler=function(r){const i=this.store;r.button>0&&r.type==="pointerdown"&&(BSe(i,o=>o.pointerId===r.pointerId)||i.push(r)),e.call(this,r)}}function FSe(t){t.prototype.handler=function(n){let r=DSe[n.type];r&Gne&&n.button>=0&&(this.pressed=!0),r&jne&&n.which===0&&(r=XF),this.pressed&&(r&XF&&(this.pressed=!1),this.callback(this.manager,r,{pointers:[n],changedPointers:[n],pointerType:"mouse",srcEvent:n}))}}NSe(VE.PointerEventInput);FSe(VE.MouseInput);const kSe=VE.Manager;let KO=class{constructor(e,n,r){this.element=e,this.callback=n,this.options={enable:!0,...r}}};const zSe=dd?[[dd.Pan,{event:"tripan",pointers:3,threshold:0,enable:!1}],[dd.Rotate,{enable:!1}],[dd.Pinch,{enable:!1}],[dd.Swipe,{enable:!1}],[dd.Pan,{threshold:0,enable:!1}],[dd.Press,{enable:!1}],[dd.Tap,{event:"doubletap",taps:2,enable:!1}],[dd.Tap,{event:"anytap",enable:!1}],[dd.Tap,{enable:!1}]]:null,tH={tripan:["rotate","pinch","pan"],rotate:["pinch"],pinch:["pan"],pan:["press","doubletap","anytap","tap"],doubletap:["anytap"],anytap:["tap"]},USe={doubletap:["tap"]},GSe={pointerdown:"pointerdown",pointermove:"pointermove",pointerup:"pointerup",touchstart:"pointerdown",touchmove:"pointermove",touchend:"pointerup",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup"},Y5={KEY_EVENTS:["keydown","keyup"],MOUSE_EVENTS:["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"],WHEEL_EVENTS:["wheel","mousewheel"]},jSe={tap:"tap",anytap:"anytap",doubletap:"doubletap",press:"press",pinch:"pinch",pinchin:"pinch",pinchout:"pinch",pinchstart:"pinch",pinchmove:"pinch",pinchend:"pinch",pinchcancel:"pinch",rotate:"rotate",rotatestart:"rotate",rotatemove:"rotate",rotateend:"rotate",rotatecancel:"rotate",tripan:"tripan",tripanstart:"tripan",tripanmove:"tripan",tripanup:"tripan",tripandown:"tripan",tripanleft:"tripan",tripanright:"tripan",tripanend:"tripan",tripancancel:"tripan",pan:"pan",panstart:"pan",panmove:"pan",panup:"pan",pandown:"pan",panleft:"pan",panright:"pan",panend:"pan",pancancel:"pan",swipe:"swipe",swipeleft:"swipe",swiperight:"swipe",swipeup:"swipe",swipedown:"swipe"},nH={click:"tap",anyclick:"anytap",dblclick:"doubletap",mousedown:"pointerdown",mousemove:"pointermove",mouseup:"pointerup",mouseover:"pointerover",mouseout:"pointerout",mouseleave:"pointerleave"},VSe=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",rv=typeof window<"u"?window:global;let ZF=!1;try{const t={get passive(){return ZF=!0,!0}};rv.addEventListener("test",null,t),rv.removeEventListener("test",null)}catch{ZF=!1}const $Se=VSe.indexOf("firefox")!==-1,{WHEEL_EVENTS:HSe}=Y5,rH="wheel",iH=4.000244140625,WSe=40,qSe=.25;class XSe extends KO{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{if(!this.options.enable)return;let o=i.deltaY;rv.WheelEvent&&($Se&&i.deltaMode===rv.WheelEvent.DOM_DELTA_PIXEL&&(o/=rv.devicePixelRatio),i.deltaMode===rv.WheelEvent.DOM_DELTA_LINE&&(o*=WSe)),o!==0&&o%iH===0&&(o=Math.floor(o/iH)),i.shiftKey&&o&&(o=o*qSe),this.callback({type:rH,center:{x:i.clientX,y:i.clientY},delta:-o,srcEvent:i,pointerType:"mouse",target:i.target})},this.events=(this.options.events||[]).concat(HSe),this.events.forEach(i=>e.addEventListener(i,this.handleEvent,ZF?{passive:!1}:!1))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===rH&&(this.options.enable=n)}}const{MOUSE_EVENTS:ZSe}=Y5,oH="pointermove",sH="pointerover",aH="pointerout",lH="pointerenter",uH="pointerleave";class YSe extends KO{constructor(e,n,r){super(e,n,r),this.handleEvent=o=>{this.handleOverEvent(o),this.handleOutEvent(o),this.handleEnterEvent(o),this.handleLeaveEvent(o),this.handleMoveEvent(o)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,this.events=(this.options.events||[]).concat(ZSe),this.events.forEach(o=>e.addEventListener(o,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===oH&&(this.enableMoveEvent=n),e===sH&&(this.enableOverEvent=n),e===aH&&(this.enableOutEvent=n),e===lH&&(this.enableEnterEvent=n),e===uH&&(this.enableLeaveEvent=n)}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit(sH,e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit(aH,e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit(lH,e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit(uH,e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.which===0&&(this.pressed=!1),this.pressed||this._emit(oH,e);break;case"mouseup":this.pressed=!1;break}}_emit(e,n){this.callback({type:e,center:{x:n.clientX,y:n.clientY},srcEvent:n,pointerType:"mouse",target:n.target})}}const{KEY_EVENTS:QSe}=Y5,cH="keydown",fH="keyup";class KSe extends KO{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{const o=i.target||i.srcElement;o.tagName==="INPUT"&&o.type==="text"||o.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:cH,srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:fH,srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,this.events=(this.options.events||[]).concat(QSe),e.tabIndex=this.options.tabIndex||0,e.style.outline="none",this.events.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){this.events.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,n){e===cH&&(this.enableDownEvent=n),e===fH&&(this.enableUpEvent=n)}}const hH="contextmenu";class JSe extends KO{constructor(e,n,r){super(e,n,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:hH,center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,n){e===hH&&(this.options.enable=n)}}const YF=1,mI=2,QF=4,eTe={pointerdown:YF,pointermove:mI,pointerup:QF,mousedown:YF,mousemove:mI,mouseup:QF},tTe=1,nTe=2,rTe=3,iTe=0,oTe=1,sTe=2,aTe=1,lTe=2,uTe=4;function cTe(t){const e=eTe[t.srcEvent.type];if(!e)return null;const{buttons:n,button:r,which:i}=t.srcEvent;let o=!1,a=!1,s=!1;return e===QF||e===mI&&!Number.isFinite(n)?(o=i===tTe,a=i===nTe,s=i===rTe):e===mI?(o=!!(n&aTe),a=!!(n&uTe),s=!!(n&lTe)):e===YF&&(o=r===iTe,a=r===oTe,s=r===sTe),{leftButton:o,middleButton:a,rightButton:s}}function fTe(t,e){const n=t.center;if(!n)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,o=r.height/e.offsetHeight||1,a={x:(n.x-r.left-e.clientLeft)/i,y:(n.y-r.top-e.clientTop)/o};return{center:n,offsetCenter:a}}const sB={srcElement:"root",priority:0};class hTe{constructor(e){this.handleEvent=n=>{if(this.isEmpty())return;const r=this._normalizeEvent(n);let i=n.srcEvent.target;for(;i&&i!==r.rootElement;){if(this._emit(r,i),r.handled)return;i=i.parentNode}this._emit(r,"root")},this.eventManager=e,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,n,r,i=!1,o=!1){const{handlers:a,handlersByElement:s}=this;let u=sB;typeof r=="string"||r&&r.addEventListener?u={...sB,srcElement:r}:r&&(u={...sB,...r});let d=s.get(u.srcElement);d||(d=[],s.set(u.srcElement,d));const g={type:e,handler:n,srcElement:u.srcElement,priority:u.priority};i&&(g.once=!0),o&&(g.passive=!0),a.push(g),this._active=this._active||!g.passive;let _=d.length-1;for(;_>=0&&!(d[_].priority>=g.priority);)_--;d.splice(_+1,0,g)}remove(e,n){const{handlers:r,handlersByElement:i}=this;for(let o=r.length-1;o>=0;o--){const a=r[o];if(a.type===e&&a.handler===n){r.splice(o,1);const s=i.get(a.srcElement);s.splice(s.indexOf(a),1),s.length===0&&i.delete(a.srcElement)}}this._active=r.some(o=>!o.passive)}_emit(e,n){const r=this.handlersByElement.get(n);if(r){let i=!1;const o=()=>{e.handled=!0},a=()=>{e.handled=!0,i=!0},s=[];for(let u=0;u<r.length;u++){const{type:d,handler:g,once:_}=r[u];if(g({...e,type:d,stopPropagation:o,stopImmediatePropagation:a}),_&&s.push(r[u]),i)break}for(let u=0;u<s.length;u++){const{type:d,handler:g}=s[u];this.remove(d,g)}}}_normalizeEvent(e){const n=this.eventManager.getElement();return{...e,...cTe(e),...fTe(e,n),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:n}}}const dTe={events:null,recognizers:null,recognizerOptions:{},Manager:kSe,touchAction:"none",tabIndex:0};class pTe{constructor(e=null,n){this._onBasicInput=i=>{const{srcEvent:o}=i,a=GSe[o.type];a&&this.manager.emit(a,i)},this._onOtherEvent=i=>{this.manager.emit(i.type,i)},this.options={...dTe,...n},this.events=new Map,this.setElement(e);const{events:r}=this.options;r&&this.on(r)}getElement(){return this.element}setElement(e){if(this.element&&this.destroy(),this.element=e,!e)return;const{options:n}=this,r=n.Manager;this.manager=new r(e,{touchAction:n.touchAction,recognizers:n.recognizers||zSe}).on("hammer.input",this._onBasicInput),n.recognizers||Object.keys(tH).forEach(i=>{const o=this.manager.get(i);o&&tH[i].forEach(a=>{o.recognizeWith(a)})});for(const i in n.recognizerOptions){const o=this.manager.get(i);if(o){const a=n.recognizerOptions[i];delete a.enable,o.set(a)}}this.wheelInput=new XSe(e,this._onOtherEvent,{enable:!1}),this.moveInput=new YSe(e,this._onOtherEvent,{enable:!1}),this.keyInput=new KSe(e,this._onOtherEvent,{enable:!1,tabIndex:n.tabIndex}),this.contextmenuInput=new JSe(e,this._onOtherEvent,{enable:!1});for(const[i,o]of this.events)o.isEmpty()||(this._toggleRecognizer(o.recognizerName,!0),this.manager.on(i,o.handleEvent))}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy(),this.wheelInput=null,this.moveInput=null,this.keyInput=null,this.contextmenuInput=null,this.manager=null,this.element=null)}on(e,n,r){this._addEventHandler(e,n,r,!1)}once(e,n,r){this._addEventHandler(e,n,r,!0)}watch(e,n,r){this._addEventHandler(e,n,r,!1,!0)}off(e,n){this._removeEventHandler(e,n)}_toggleRecognizer(e,n){const{manager:r}=this;if(!r)return;const i=r.get(e);if(i&&i.options.enable!==n){i.set({enable:n});const o=USe[e];o&&!this.options.recognizers&&o.forEach(a=>{const s=r.get(a);n?(s.requireFailure(e),i.dropRequireFailure(a)):s.dropRequireFailure(e)})}this.wheelInput.enableEventType(e,n),this.moveInput.enableEventType(e,n),this.keyInput.enableEventType(e,n),this.contextmenuInput.enableEventType(e,n)}_addEventHandler(e,n,r,i,o){if(typeof e!="string"){r=n;for(const g in e)this._addEventHandler(g,e[g],r,i,o);return}const{manager:a,events:s}=this,u=nH[e]||e;let d=s.get(u);d||(d=new hTe(this),s.set(u,d),d.recognizerName=jSe[u]||u,a&&a.on(u,d.handleEvent)),d.add(e,n,r,i,o),d.isEmpty()||this._toggleRecognizer(d.recognizerName,!0)}_removeEventHandler(e,n){if(typeof e!="string"){for(const a in e)this._removeEventHandler(a,e[a]);return}const{events:r}=this,i=nH[e]||e,o=r.get(i);if(o&&(o.remove(e,n),o.isEmpty())){const{recognizerName:a}=o;let s=!1;for(const u of r.values())if(u.recognizerName===a&&!u.isEmpty()){s=!0;break}s||this._toggleRecognizer(a,!1)}}}function u0(){}const gTe=({isDragging:t})=>t?"grabbing":"grab",Vne={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,glOptions:{},parameters:{},parent:null,gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,onWebGLInitialized:u0,onResize:u0,onViewStateChange:u0,onInteractionStateChange:u0,onBeforeRender:u0,onAfterRender:u0,onLoad:u0,onError:t=>Or.error(t.message,t.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:gTe,getTooltip:null,debug:!1,drawPickingColors:!1};class $E{constructor(e){q(this,"props",void 0),q(this,"width",0),q(this,"height",0),q(this,"userData",{}),q(this,"canvas",null),q(this,"viewManager",null),q(this,"layerManager",null),q(this,"effectManager",null),q(this,"deckRenderer",null),q(this,"deckPicker",null),q(this,"eventManager",null),q(this,"tooltip",null),q(this,"metrics",void 0),q(this,"animationLoop",void 0),q(this,"stats",void 0),q(this,"viewState",void 0),q(this,"cursorState",void 0),q(this,"_needsRedraw",void 0),q(this,"_pickRequest",void 0),q(this,"_lastPointerDownInfo",null),q(this,"_metricsCounter",void 0),q(this,"_onPointerMove",n=>{const{_pickRequest:r}=this;if(n.type==="pointerleave")r.x=-1,r.y=-1,r.radius=0;else{if(n.leftButton||n.rightButton)return;{const i=n.offsetCenter;if(!i)return;r.x=i.x,r.y=i.y,r.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:r.x,y:r.y}),r.event=n}),q(this,"_onEvent",n=>{const r=U9[n.type],i=n.offsetCenter;if(!r||!i||!this.layerManager)return;const o=this.layerManager.getLayers(),a=this.deckPicker.getLastPickedObject({x:i.x,y:i.y,layers:o,viewports:this.getViewports(i)},this._lastPointerDownInfo),{layer:s}=a,u=s&&(s[r.handler]||s.props[r.handler]),d=this.props[r.handler];let g=!1;u&&(g=u.call(s,a,n)),!g&&d&&d(a,n)}),q(this,"_onPointerDown",n=>{const r=n.offsetCenter,i=this._pick("pickObject","pickObject Time",{x:r.x,y:r.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=i.result[0]||i.emptyInfo}),this.props={...Vne,...e},e=this.props,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this.cursorState={isHovering:!1,isDragging:!1},e.viewState&&e.initialViewState&&Or.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),Jee()==="IE"&&Or.warn("IE 11 is not supported")(),this.viewState=e.initialViewState,e.gl||typeof document<"u"&&(this.canvas=this._createCanvas(e)),this.animationLoop=this._createAnimationLoop(e),this.stats=new _5({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this.setProps(e),e._typedArrayManagerProps&&jv.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,n,r,i,o,a,s,u;if((e=this.animationLoop)===null||e===void 0||e.stop(),this.animationLoop=null,this._lastPointerDownInfo=null,(n=this.layerManager)===null||n===void 0||n.finalize(),this.layerManager=null,(r=this.viewManager)===null||r===void 0||r.finalize(),this.viewManager=null,(i=this.effectManager)===null||i===void 0||i.finalize(),this.effectManager=null,(o=this.deckRenderer)===null||o===void 0||o.finalize(),this.deckRenderer=null,(a=this.deckPicker)===null||a===void 0||a.finalize(),this.deckPicker=null,(s=this.eventManager)===null||s===void 0||s.destroy(),this.eventManager=null,(u=this.tooltip)===null||u===void 0||u.remove(),this.tooltip=null,!this.props.canvas&&!this.props.gl&&this.canvas){var d;(d=this.canvas.parentElement)===null||d===void 0||d.removeChild(this.canvas),this.canvas=null}}setProps(e){this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&Or.removed("onLayerHover","onHover")(),"onLayerClick"in e&&Or.removed("onLayerClick","onClick")(),e.initialViewState&&!uc(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const n=Object.create(this.props);Object.assign(n,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),this.animationLoop.setProps(n),this.layerManager&&(this.viewManager.setProps(n),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(n),this.effectManager.setProps(n),this.deckRenderer.setProps(n),this.deckPicker.setProps(n)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let n=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),o=this.effectManager.needsRedraw(e),a=this.deckRenderer.needsRedraw(e);return n=n||r||i||o||a,n}redraw(e){if(!this.layerManager)return;let n=this.needsRedraw({clearRedrawFlags:!0});n=e||n,n&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(n):this._drawLayers(n))}get isInitialized(){return this.viewManager!==null}getViews(){return ia(this.viewManager),this.viewManager.views}getViewports(e){return ia(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const n=this._pick("pickObject","pickObject Time",e).result;return n.length?n[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,n=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:n})}_removeResources(e){for(const n of e)this.layerManager.resourceManager.remove(n)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_pick(e,n,r){ia(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(n).timeStart();const o=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(n).timeEnd(),o}_createCanvas(e){let n=e.canvas;return typeof n=="string"&&(n=document.getElementById(n),ia(n)),n||(n=document.createElement("canvas"),n.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(n)),Object.assign(n.style,e.style),n}_setCanvasSize(e){if(!this.canvas)return;const{width:n,height:r}=e;if(n||n===0){const o=Number.isFinite(n)?"".concat(n,"px"):n;this.canvas.style.width=o}if(r||r===0){var i;const o=Number.isFinite(r)?"".concat(r,"px"):r;this.canvas.style.position=((i=e.style)===null||i===void 0?void 0:i.position)||"absolute",this.canvas.style.height=o}}_updateCanvasSize(){var e,n;const{canvas:r}=this;if(!r)return;const i=(e=r.clientWidth)!==null&&e!==void 0?e:r.width,o=(n=r.clientHeight)!==null&&n!==void 0?n:r.height;if(i!==this.width||o!==this.height){var a,s;this.width=i,this.height=o,(a=this.viewManager)===null||a===void 0||a.setProps({width:i,height:o}),(s=this.layerManager)===null||s===void 0||s.activateViewport(this.getViewports()[0]),this.props.onResize({width:i,height:o})}}_createAnimationLoop(e){const{width:n,height:r,gl:i,glOptions:o,debug:a,onError:s,onBeforeRender:u,onAfterRender:d,useDevicePixels:g}=e;return new wte({width:n,height:r,useDevicePixels:g,autoResizeDrawingBuffer:!i,autoResizeViewport:!1,gl:i,onCreateContext:_=>A5({...o,..._,canvas:this.canvas,debug:a,onContextLost:()=>this._onContextLost()}),onInitialize:_=>this._setGLContext(_.gl),onRender:this._onRenderFrame.bind(this),onBeforeRender:u,onAfterRender:d,onError:s})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){let e=this.props.views||[new QO({id:"default-view"})];return e=Array.isArray(e)?e:[e],e.length&&this.props.controller&&(e[0].props.controller=this.props.controller),e}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){const{_pickRequest:e}=this;if(e.event){const{result:r,emptyInfo:i}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=r.length>0;let o=i,a=!1;for(const s of r){var n;o=s,a=((n=s.layer)===null||n===void 0?void 0:n.onHover(s,e.event))||a}if(!a&&this.props.onHover&&this.props.onHover(o,e.event),this.props.getTooltip&&this.tooltip){const s=this.props.getTooltip(o);this.tooltip.setTooltip(s,o.x,o.y)}e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setGLContext(e){if(this.layerManager)return;this.canvas||(this.canvas=e.canvas,zO(e,{enable:!0,copyState:!0})),this.tooltip=new RSe(this.canvas),bh(e,{blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onWebGLInitialized(e);const n=new F5;n.play(),this.animationLoop.attachTimeline(n),this.eventManager=new pTe(this.props.parent||e.canvas,{touchAction:this.props.touchAction,recognizerOptions:this.props.eventRecognizerOptions,events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const i in U9)this.eventManager.on(i,this._onEvent);this.viewManager=new fSe({timeline:n,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new Dne(e,{deck:this,stats:this.stats,viewport:r,timeline:n}),this.effectManager=new bSe,this.deckRenderer=new Fne(e),this.deckPicker=new MSe(e),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,n){const{gl:r}=this.layerManager.context;bh(r,this.props.parameters),this.props.onBeforeRender({gl:r}),this.deckRenderer.renderLayers({target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...n}),this.props.onAfterRender({gl:r})}_onRenderFrame(e){this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),Or.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.tooltip.isVisible&&this.viewManager.needsRedraw()&&this.tooltip.setTooltip(null),this.layerManager.updateLayers(),this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const n=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:n},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const n=this.animationLoop.stats;e.get("GPU Time").addTime(n.get("GPU Time").lastTiming),e.get("CPU Time").addTime(n.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:n}=this;e.fps=n.get("frameRate").getHz(),e.setPropsTime=n.get("setProps Time").time,e.updateAttributesTime=n.get("Update Attributes").time,e.framesRedrawn=n.get("Redraw Count").count,e.pickTime=n.get("pickObject Time").time+n.get("pickMultipleObjects Time").time+n.get("pickObjects Time").time,e.pickCount=n.get("Pick Count").count,e.gpuTime=n.get("GPU Time").time,e.cpuTime=n.get("CPU Time").time,e.gpuTimePerFrame=n.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=n.get("CPU Time").getAverageTime();const r=Im.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}q($E,"defaultProps",Vne);q($E,"VERSION",tte);class aB{constructor(e,n){q(this,"opts",void 0),q(this,"source",void 0),this.opts=n,this.source=e}get value(){return this.source.value}getValue(){const e=this.source.getBuffer(),n=this.getAccessor();if(e)return[e,n];const{value:r}=this.source,{size:i}=n;let o=r;if(r&&r.length!==i){o=new Float32Array(i);const a=n.elementOffset||0;for(let s=0;s<i;++s)o[s]=r[a+s]}return o}getAccessor(){return{...this.source.getAccessor(),...this.opts}}}function mTe(t){switch(t){case 5126:return Float32Array;case 5130:return Float64Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return Uint8ClampedArray;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Unknown GL type")}}function mC(t){return t.stride||t.size*t.bytesPerElement}function $ne(t,e){e.offset&&Or.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const n=mC(t),r=e.vertexOffset!==void 0?e.vertexOffset:t.vertexOffset||0,i=e.elementOffset||0,o=r*n+i*t.bytesPerElement+(t.offset||0);return{...e,offset:o,stride:n}}function ATe(t,e){const n=$ne(t,e);return{high:n,low:{...n,offset:n.offset+t.size*4}}}class _Te{constructor(e,n,r){q(this,"gl",void 0),q(this,"id",void 0),q(this,"size",void 0),q(this,"settings",void 0),q(this,"value",void 0),q(this,"doublePrecision",void 0),q(this,"_buffer",void 0),q(this,"state",void 0),this.gl=e,this.id=n.id||"",this.size=n.size||1;const i=n.logicalType||n.type,o=i===5130;let{defaultValue:a}=n;a=Number.isFinite(a)?[a]:a||new Array(this.size).fill(0);let s;o?s=5126:!i&&n.isIndexed?s=e&&FE(e,Qi.ELEMENT_INDEX_UINT32)?5125:5123:s=i||5126;let u=mTe(i||s||5126);this.doublePrecision=o,o&&n.fp64===!1&&(u=Float32Array),this.value=null,this.settings={...n,defaultType:u,defaultValue:a,logicalType:i,type:s,size:this.size,bytesPerElement:u.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1},this._buffer=null}get isConstant(){return this.state.constant}get buffer(){if(!this._buffer){const{isIndexed:e,type:n}=this.settings;this._buffer=new ji(this.gl,{id:this.id,target:e?34963:34962,accessor:{type:n}})}return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*mC(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),jv.release(this.state.allocatedValue)}getShaderAttributes(e,n){if(this.doublePrecision){const r={},i=this.value instanceof Float64Array,o=ATe(this.getAccessor(),n||{});return r[e]=new aB(this,o.high),r["".concat(e,"64Low")]=i?new aB(this,o.low):new Float32Array(this.size),r}if(n){const r=$ne(this.getAccessor(),n);return{[e]:new aB(this,r)}}return{[e]:this}}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(){return this.state.constant?this.value:[this.getBuffer(),this.getAccessor()]}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const n=Array.from(this.value);e=[n,n]}else{const{value:n,numInstances:r,size:i}=this,o=r*i;if(n&&o&&n.length>=o){const a=new Array(i).fill(1/0),s=new Array(i).fill(-1/0);for(let u=0;u<o;)for(let d=0;d<i;d++){const g=n[u++];g<a[d]&&(a[d]=g),g>s[d]&&(s[d]=g)}e=[a,s]}}return this.state.bounds=e,e}setData(e){const{state:n}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof ji?r={buffer:e}:r=e;const i={...this.settings,...r};if(n.bufferAccessor=i,n.bounds=null,r.constant){let o=r.value;if(o=this._normalizeValue(o,[],0),this.settings.normalized&&(o=this.normalizeConstant(o)),!(!n.constant||!this._areValuesEqual(o,this.value)))return!1;n.externalBuffer=null,n.constant=!0,this.value=o}else if(r.buffer){const o=r.buffer;n.externalBuffer=o,n.constant=!1,this.value=r.value||null;const a=r.value instanceof Float64Array;i.type=r.type||o.accessor.type,i.bytesPerElement=o.accessor.BYTES_PER_ELEMENT*(a?2:1),i.stride=mC(i)}else if(r.value){this._checkExternalBuffer(r);let o=r.value;n.externalBuffer=null,n.constant=!1,this.value=o,i.bytesPerElement=o.BYTES_PER_ELEMENT,i.stride=mC(i);const{buffer:a,byteOffset:s}=this;this.doublePrecision&&o instanceof Float64Array&&(o=rB(o,i));const u=o.byteLength+s+i.stride*2;a.byteLength<u&&a.reallocate(u),a.setAccessor(null),a.subData({data:o,offset:s}),i.type=r.type||a.accessor.type}return!0}updateSubBuffer(e={}){this.state.bounds=null;const n=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.subData({data:this.doublePrecision&&n instanceof Float64Array?rB(n,{size:this.size,startIndex:r,endIndex:i}):n.subarray(r,i),offset:r*n.BYTES_PER_ELEMENT+this.byteOffset})}allocate(e,n=!1){const{state:r}=this,i=r.allocatedValue,o=jv.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:n});this.value=o;const{buffer:a,byteOffset:s}=this;return a.byteLength<o.byteLength+s&&(a.reallocate(o.byteLength+s),n&&i&&a.subData({data:i instanceof Float64Array?rB(i,this):i,offset:s})),r.allocatedValue=o,r.constant=!1,r.externalBuffer=null,r.bufferAccessor=this.settings,!0}_checkExternalBuffer(e){const{value:n}=e;if(!ArrayBuffer.isView(n))throw new Error("Attribute ".concat(this.id," value is not TypedArray"));const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=n.BYTES_PER_ELEMENT<4),i)throw new Error("Attribute ".concat(this.id," does not support ").concat(n.constructor.name));!(n instanceof r)&&this.settings.normalized&&!("normalized"in e)&&Or.warn("Attribute ".concat(this.id," is normalized"))()}normalizeConstant(e){switch(this.settings.type){case 5120:return new Float32Array(e).map(n=>(n+128)/255*2-1);case 5122:return new Float32Array(e).map(n=>(n+32768)/65535*2-1);case 5121:return new Float32Array(e).map(n=>n/255);case 5123:return new Float32Array(e).map(n=>n/65535);default:return e}}_normalizeValue(e,n,r){const{defaultValue:i,size:o}=this.settings;if(Number.isFinite(e))return n[r]=e,n;if(!e){let a=o;for(;--a>=0;)n[r+a]=i[a];return n}switch(o){case 4:n[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:n[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:n[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:n[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let a=o;for(;--a>=0;)n[r+a]=Number.isFinite(e[a])?e[a]:i[a]}return n}_areValuesEqual(e,n){if(!e||!n)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==n[i])return!1;return!0}}const dH=[],pH=[];function Tg(t,e=0,n=1/0){let r=dH;const i={index:-1,data:t,target:[]};return t?typeof t[Symbol.iterator]=="function"?r=t:t.length>0&&(pH.length=t.length,r=pH):r=dH,(e>0||Number.isFinite(n))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,n),i.index=e-1),{iterable:r,objectInfo:i}}function Hne(t){return t&&t[Symbol.asyncIterator]}function Wne(t,e){const{size:n,stride:r,offset:i,startIndices:o,nested:a}=e,s=t.BYTES_PER_ELEMENT,u=r?r/s:n,d=i?i/s:0,g=Math.floor((t.length-d)/u);return(_,{index:E,target:P})=>{if(!o){const k=E*u+d;for(let F=0;F<n;F++)P[F]=t[k+F];return P}const O=o[E],D=o[E+1]||g;let V;if(a){V=new Array(D-O);for(let k=O;k<D;k++){const F=k*u+d;P=new Array(n);for(let z=0;z<n;z++)P[z]=t[F+z];V[k-O]=P}}else if(u===n)V=t.subarray(O*n+d,D*n+d);else{V=new t.constructor((D-O)*n);let k=0;for(let F=O;F<D;F++){const z=F*u+d;for(let X=0;X<n;X++)V[k++]=t[z+X]}}return V}}const yTe=[],AC=[[0,1/0]];function vTe(t,e){if(t===AC||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return t;const n=[],r=t.length;let i=0;for(let o=0;o<r;o++){const a=t[o];a[1]<e[0]?(n.push(a),i=o+1):a[0]>e[1]?n.push(a):e=[Math.min(a[0],e[0]),Math.max(a[1],e[1])]}return n.splice(i,0,e),n}function lB(t){const{source:e,target:n,start:r=0,size:i,getData:o}=t,a=t.end||n.length,s=e.length,u=a-r;if(s>u){n.set(e.subarray(0,u),r);return}if(n.set(e,r),!o)return;let d=s;for(;d<u;){const g=o(d,e);for(let _=0;_<i;_++)n[r+d]=g[_]||0,d++}}function xTe({source:t,target:e,size:n,getData:r,sourceStartIndices:i,targetStartIndices:o}){if(!Array.isArray(o))return lB({source:t,target:e,size:n,getData:r}),e;let a=0,s=0;const u=r&&((g,_)=>r(g+s,_)),d=Math.min(i.length,o.length);for(let g=1;g<d;g++){const _=i[g]*n,E=o[g]*n;lB({source:t.subarray(a,_),target:e,start:s,end:E,size:n,getData:u}),a=_,s=E}return s<e.length&&lB({source:[],target:e,start:s,size:n,getData:u}),e}const bTe={interpolation:{duration:0,easing:t=>t},spring:{stiffness:.05,damping:.5}};function qne(t,e){if(!t)return null;Number.isFinite(t)&&(t={type:"interpolation",duration:t});const n=t.type||"interpolation";return{...bTe[n],...e,...t,type:n}}function Xne(t,e){const n=e.getBuffer();return n?[n,{divisor:0,size:e.size,normalized:e.settings.normalized}]:e.value}function Zne(t){switch(t){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error('No defined attribute type for size "'.concat(t,'"'))}}function Yne(t){t.push(t.shift())}function Q5(t,e){const{doublePrecision:n,settings:r,value:i,size:o}=t,a=n&&i instanceof Float64Array?2:1;return(r.noAlloc?i.length:e*o)*a}function Qne({buffer:t,numInstances:e,attribute:n,fromLength:r,fromStartIndices:i,getData:o=a=>a}){const a=n.doublePrecision&&n.value instanceof Float64Array?2:1,s=n.size*a,u=n.byteOffset,d=n.startIndices,g=i&&d,_=Q5(n,e),E=n.isConstant;if(!g&&r>=_)return;const P=E?n.value:n.getBuffer().getData({srcByteOffset:u});if(n.settings.normalized&&!E){const k=o;o=(F,z)=>n.normalizeConstant(k(F,z))}const O=E?(k,F)=>o(P,F):(k,F)=>o(P.subarray(k,k+s),F),D=t.getData({length:r}),V=new Float32Array(_);xTe({source:D,target:V,sourceStartIndices:i,targetStartIndices:d,size:s,getData:O}),t.byteLength<V.byteLength+u&&t.reallocate(V.byteLength+u),t.subData({data:V,offset:u})}class K5 extends _Te{constructor(e,n){super(e,n,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,updateRanges:AC}),q(this,"constant",!1),this.settings.update=n.update||(n.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const n=this.state.needsRedraw;return this.state.needsRedraw=n&&!e,n}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:n}=this.settings,r=this.settings.transition,i=Array.isArray(n)?e[n.find(o=>e[o])]:e[n];return qne(i,r)}setNeedsUpdate(e=this.id,n){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),n){const{startRow:r=0,endRow:i=1/0}=n;this.state.updateRanges=vTe(this.state.updateRanges,[r,i])}else this.state.updateRanges=AC}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=yTe}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:n,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,n.updateRanges!==AC),!0):!1}updateBuffer({numInstances:e,data:n,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:o},settings:{update:a,noAlloc:s}}=this;let u=!0;if(a){for(const[d,g]of o)a.call(i,this,{data:n,startRow:d,endRow:g,props:r,numInstances:e});if(this.value)if(this.constant||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[d,g]of o){const _=Number.isFinite(d)?this.getVertexOffset(d):0,E=Number.isFinite(g)?this.getVertexOffset(g):s||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:_,endOffset:E})}this._checkAttributeArray()}else u=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),u}setConstantValue(e){return e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:n}=this;return e?(this.clearNeedsUpdate(),n.lastExternalBuffer===e||(n.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(n.lastExternalBuffer=null,!1)}setBinaryValue(e,n=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||n!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const a=e;ia(ArrayBuffer.isView(a.value),"invalid ".concat(i.accessor));const s=!!a.size&&a.size!==this.size;return r.binaryAccessor=Wne(a.value,{size:a.size||this.size,stride:a.stride,offset:a.offset,startIndices:n,nested:s}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:n}=this;return(n?e<n.length?n[e]:this.numInstances:e)*this.size}getShaderAttributes(){const e=this.settings.shaderAttributes||{[this.id]:null},n={};for(const r in e)Object.assign(n,super.getShaderAttributes(r,e[r]));return n}_autoUpdater(e,{data:n,startRow:r,endRow:i,props:o,numInstances:a}){if(e.constant)return;const{settings:s,state:u,value:d,size:g,startIndices:_}=e,{accessor:E,transform:P}=s,O=u.binaryAccessor||(typeof E=="function"?E:o[E]);ia(typeof O=="function",'accessor "'.concat(E,'" is not a function'));let D=e.getVertexOffset(r);const{iterable:V,objectInfo:k}=Tg(n,r,i);for(const F of V){k.index++;let z=O(F,k);if(P&&(z=P.call(this,z)),_){const X=(k.index<_.length-1?_[k.index+1]:a)-_[k.index];if(z&&Array.isArray(z[0])){let Y=D;for(const J of z)e._normalizeValue(J,d,Y),Y+=g}else z&&z.length>g?d.set(z,D):(e._normalizeValue(z,k.target,0),Lne({target:d,source:k.target,start:D,count:X}));D+=X*g}else e._normalizeValue(z,d,D),D+=g}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error("Attribute ".concat(this.id," missing update or accessor"))}_checkAttributeArray(){const{value:e}=this,n=Math.min(4,this.size);if(e&&e.length>=n){let r=!0;switch(n){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error("Illegal attribute generated for ".concat(this.id))}}}class wTe{constructor({gl:e,attribute:n,timeline:r}){q(this,"gl",void 0),q(this,"type","interpolation"),q(this,"attributeInTransition",void 0),q(this,"settings",void 0),q(this,"attribute",void 0),q(this,"transition",void 0),q(this,"currentStartIndices",void 0),q(this,"currentLength",void 0),q(this,"transform",void 0),q(this,"buffers",void 0),this.gl=e,this.transition=new jE(r),this.attribute=n,this.attributeInTransition=new K5(e,n.settings),this.currentStartIndices=n.startIndices,this.currentLength=0,this.transform=STe(e,n);const i={byteLength:0,usage:35050};this.buffers=[new ji(e,i),new ji(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){if(e.duration<=0){this.transition.cancel();return}this.settings=e;const{gl:r,buffers:i,attribute:o}=this;Yne(i);const a={numInstances:n,attribute:o,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const s of i)Qne({buffer:s,...a});this.currentStartIndices=o.startIndices,this.currentLength=Q5(o,n),this.attributeInTransition.setData({buffer:i[1],value:o.value}),this.transition.start(e),this.transform.update({elementCount:Math.floor(this.currentLength/o.size),sourceBuffers:{aFrom:i[0],aTo:Xne(r,o)},feedbackBuffers:{vCurrent:i[1]}})}update(){const e=this.transition.update();if(e){const{duration:n,easing:r}=this.settings,{time:i}=this.transition;let o=i/n;r&&(o=r(o)),this.transform.run({uniforms:{time:o}})}return e}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0}}const ETe=`
#define SHADER_NAME interpolation-transition-vertex-shader

uniform float time;
attribute ATTRIBUTE_TYPE aFrom;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, time);
  gl_Position = vec4(0.0);
}
`;function STe(t,e){const n=Zne(e.size);return new qO(t,{vs:ETe,defines:{ATTRIBUTE_TYPE:n},varyings:["vCurrent"]})}class TTe{constructor({gl:e,attribute:n,timeline:r}){q(this,"gl",void 0),q(this,"type","spring"),q(this,"attributeInTransition",void 0),q(this,"settings",void 0),q(this,"attribute",void 0),q(this,"transition",void 0),q(this,"currentStartIndices",void 0),q(this,"currentLength",void 0),q(this,"texture",void 0),q(this,"framebuffer",void 0),q(this,"transform",void 0),q(this,"buffers",void 0),this.gl=e,this.type="spring",this.transition=new jE(r),this.attribute=n,this.attributeInTransition=new K5(e,{...n.settings,normalized:!1}),this.currentStartIndices=n.startIndices,this.currentLength=0,this.texture=PTe(e),this.framebuffer=ITe(e,this.texture),this.transform=CTe(e,n,this.framebuffer);const i={byteLength:0,usage:35050};this.buffers=[new ji(e,i),new ji(e,i),new ji(e,i)]}get inProgress(){return this.transition.inProgress}start(e,n){const{gl:r,buffers:i,attribute:o}=this,a={numInstances:n,attribute:o,fromLength:this.currentLength,fromStartIndices:this.currentStartIndices,getData:e.enter};for(const s of i)Qne({buffer:s,...a});this.settings=e,this.currentStartIndices=o.startIndices,this.currentLength=Q5(o,n),this.attributeInTransition.setData({buffer:i[1],value:o.value}),this.transition.start({...e,duration:1/0}),this.transform.update({elementCount:Math.floor(this.currentLength/o.size),sourceBuffers:{aTo:Xne(r,o)}})}update(){const{buffers:e,transform:n,framebuffer:r,transition:i}=this;if(!i.update())return!1;const a=this.settings;return n.update({sourceBuffers:{aPrev:e[0],aCur:e[1]},feedbackBuffers:{vNext:e[2]}}),n.run({framebuffer:r,discard:!1,clearRenderTarget:!0,uniforms:{stiffness:a.stiffness,damping:a.damping},parameters:{depthTest:!1,blend:!0,viewport:[0,0,1,1],blendFunc:[1,1],blendEquation:[32776,32776]}}),Yne(e),this.attributeInTransition.setData({buffer:e[1],value:this.attribute.value}),NE(r)[0]>0||i.end(),!0}cancel(){this.transition.cancel(),this.transform.delete();for(const e of this.buffers)e.delete();this.buffers.length=0,this.texture.delete(),this.framebuffer.delete()}}function CTe(t,e,n){const r=Zne(e.size);return new qO(t,{framebuffer:n,vs:`
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

uniform float stiffness;
uniform float damping;
attribute ATTRIBUTE_TYPE aPrev;
attribute ATTRIBUTE_TYPE aCur;
attribute ATTRIBUTE_TYPE aTo;
varying ATTRIBUTE_TYPE vNext;
varying float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE spring = delta * stiffness;
  ATTRIBUTE_TYPE damper = velocity * -1.0 * damping;
  return spring + damper + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,fs:`
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

varying float vIsTransitioningFlag;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  gl_FragColor = vec4(1.0);
}`,defines:{ATTRIBUTE_TYPE:r},varyings:["vNext"]})}function PTe(t){return new Pl(t,{data:new Uint8Array(4),format:6408,type:5121,border:0,mipmaps:!1,dataFormat:6408,width:1,height:1})}function ITe(t,e){return new Ws(t,{id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,attachments:{36064:e}})}const MTe={interpolation:wTe,spring:TTe};class OTe{constructor(e,{id:n,timeline:r}){q(this,"id",void 0),q(this,"isSupported",void 0),q(this,"gl",void 0),q(this,"timeline",void 0),q(this,"transitions",void 0),q(this,"needsRedraw",void 0),q(this,"numInstances",void 0),this.id=n,this.gl=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1,this.isSupported=qO.isSupported(e)}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:n,numInstances:r}){this.numInstances=r||1;for(const i in e){const o=e[i],a=o.getTransitionSetting(n);a&&this._updateAttribute(i,o,a)}for(const i in this.transitions){const o=e[i];(!o||!o.getTransitionSetting(n))&&this._removeTransition(i)}}hasAttribute(e){const n=this.transitions[e];return n&&n.inProgress}getAttributes(){const e={};for(const n in this.transitions){const r=this.transitions[n];r.inProgress&&(e[n]=r.attributeInTransition)}return e}run(){if(!this.isSupported||this.numInstances===0)return!1;for(const n in this.transitions)this.transitions[n].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].cancel(),delete this.transitions[e]}_updateAttribute(e,n,r){const i=this.transitions[e];let o=!i||i.type!==r.type;if(o){if(!this.isSupported){Or.warn("WebGL2 not supported by this browser. Transition for ".concat(e," is disabled."))();return}i&&this._removeTransition(e);const a=MTe[r.type];a?this.transitions[e]=new a({attribute:n,timeline:this.timeline,gl:this.gl}):(Or.error("unsupported transition type '".concat(r.type,"'"))(),o=!1)}(o||n.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const gH="attributeManager.invalidate",RTe="attributeManager.updateStart",LTe="attributeManager.updateEnd",DTe="attribute.updateStart",BTe="attribute.allocate",NTe="attribute.updateEnd";class Kne{constructor(e,{id:n="attribute-manager",stats:r,timeline:i}={}){q(this,"id",void 0),q(this,"gl",void 0),q(this,"attributes",void 0),q(this,"updateTriggers",void 0),q(this,"needsRedraw",void 0),q(this,"userData",void 0),q(this,"stats",void 0),q(this,"attributeTransitionManager",void 0),q(this,"mergeBoundsMemoized",N1(y2e)),this.id=n,this.gl=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new OTe(e,{id:"".concat(n,"-transitions"),timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const n=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,n&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{instanced:1})}remove(e){for(const n of e)this.attributes[n]!==void 0&&(this.attributes[n].delete(),delete this.attributes[n])}invalidate(e,n){const r=this._invalidateTrigger(e,n);_l(gH,this,e,r)}invalidateAll(e){for(const n in this.attributes)this.attributes[n].setNeedsUpdate(n,e);_l(gH,this,"all")}update({data:e,numInstances:n,startIndices:r=null,transitions:i,props:o={},buffers:a={},context:s={}}){let u=!1;_l(RTe,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const d in this.attributes){const g=this.attributes[d],_=g.settings.accessor;g.startIndices=r,g.numInstances=n,o[d]&&Or.removed("props.".concat(d),"data.attributes.".concat(d))(),g.setExternalBuffer(a[d])||g.setBinaryValue(typeof _=="string"?a[_]:void 0,e.startIndices)||typeof _=="string"&&!a[_]&&g.setConstantValue(o[_])||g.needsUpdate()&&(u=!0,this._updateAttribute({attribute:g,numInstances:n,data:e,props:o,context:s})),this.needsRedraw=this.needsRedraw||g.needsRedraw()}u&&_l(LTe,this,n),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:n,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,n=e.run();return this.needsRedraw=this.needsRedraw||n,n}getAttributes(){return this.attributes}getBounds(e){const n=e.map(r=>{var i;return(i=this.attributes[r])===null||i===void 0?void 0:i.getBounds()});return this.mergeBoundsMemoized(n)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:n,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const o in n){const a=n[o];a.needsRedraw(e)&&!r.hasAttribute(o)&&(i[o]=a)}return i}getShaderAttributes(e,n={}){e||(e=this.getAttributes());const r={};for(const i in e)n[i]||Object.assign(r,e[i].getShaderAttributes());return r}_add(e,n={}){for(const r in e){const i=e[r];this.attributes[r]=this._createAttribute(r,i,n)}this._mapUpdateTriggersToAttributes()}_createAttribute(e,n,r){const i={...n,id:e,size:n.isIndexed&&1||n.size||1,divisor:r.instanced?1:n.divisor||0};return new K5(this.gl,i)}_mapUpdateTriggersToAttributes(){const e={};for(const n in this.attributes)this.attributes[n].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(n)});this.updateTriggers=e}_invalidateTrigger(e,n){const{attributes:r,updateTriggers:i}=this,o=i[e];return o&&o.forEach(a=>{const s=r[a];s&&s.setNeedsUpdate(s.id,n)}),o}_updateAttribute(e){const{attribute:n,numInstances:r}=e;if(_l(DTe,n),n.constant){n.setConstantValue(n.value);return}n.allocate(r)&&_l(BTe,n,r),n.updateBuffer(e)&&(this.needsRedraw=!0,_l(NTe,n,r))}}class FTe extends jE{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:n,toValue:r,duration:i,easing:o}}=this,a=o(e/i);this._value=pc(n,r,a)}}const mH=1e-5;function AH(t,e,n,r,i){const o=e-t,s=(n-e)*i,u=-o*r;return s+u+o+e}function kTe(t,e,n,r,i){if(Array.isArray(n)){const o=[];for(let a=0;a<n.length;a++)o[a]=AH(t[a],e[a],n[a],r,i);return o}return AH(t,e,n,r,i)}function _H(t,e){if(Array.isArray(t)){let n=0;for(let r=0;r<t.length;r++){const i=t[r]-e[r];n+=i*i}return Math.sqrt(n)}return Math.abs(t-e)}class zTe extends jE{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:n,damping:r,stiffness:i}=this.settings,{_prevValue:o=e,_currValue:a=e}=this;let s=kTe(o,a,n,r,i);const u=_H(s,n),d=_H(s,a);u<mH&&d<mH&&(s=n,this.end()),this._prevValue=a,this._currValue=s}}const UTe={interpolation:FTe,spring:zTe};class GTe{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,n,r,i){const{transitions:o}=this;if(o.has(e)){const u=o.get(e),{value:d=u.settings.fromValue}=u;n=d,this.remove(e)}if(i=qne(i),!i)return;const a=UTe[i.type];if(!a){Or.error("unsupported transition type '".concat(i.type,"'"))();return}const s=new a(this.timeline);s.start({...i,fromValue:n,toValue:r}),o.set(e,s)}remove(e){const{transitions:n}=this;n.has(e)&&(n.get(e).cancel(),n.delete(e))}update(){const e={};for(const[n,r]of this.transitions)r.update(),e[n]=r.value,r.inProgress||this.remove(n);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function jTe(t){const e=t[Vm];for(const n in e){const r=e[n],{validate:i}=r;if(i&&!i(t[n],r))throw new Error("Invalid prop ".concat(n,": ").concat(t[n]))}}function VTe(t,e){const n=J5({newProps:t,oldProps:e,propTypes:t[Vm],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=HTe(t,e);let i=!1;return r||(i=WTe(t,e)),{dataChanged:r,propsChanged:n,updateTriggersChanged:i,extensionsChanged:qTe(t,e),transitionsChanged:$Te(t,e)}}function $Te(t,e){if(!t.transitions)return!1;const n={},r=t[Vm];let i=!1;for(const o in t.transitions){const a=r[o],s=a&&a.type;(s==="number"||s==="color"||s==="array")&&KF(t[o],e[o],a)&&(n[o]=!0,i=!0)}return i?n:!1}function J5({newProps:t,oldProps:e,ignoreProps:n={},propTypes:r={},triggerName:i="props"}){if(e===t)return!1;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return"".concat(i," changed shallowly");for(const o of Object.keys(t))if(!(o in n)){if(!(o in e))return"".concat(i,".").concat(o," added");const a=KF(t[o],e[o],r[o]);if(a)return"".concat(i,".").concat(o," ").concat(a)}for(const o of Object.keys(e))if(!(o in n)){if(!(o in t))return"".concat(i,".").concat(o," dropped");if(!Object.hasOwnProperty.call(t,o)){const a=KF(t[o],e[o],r[o]);if(a)return"".concat(i,".").concat(o," ").concat(a)}}return!1}function KF(t,e,n){let r=n&&n.equal;return r&&!r(t,e,n)||!r&&(r=t&&e&&t.equals,r&&!r.call(t,e))?"changed deeply":!r&&e!==t?"changed shallowly":null}function HTe(t,e){if(e===null)return"oldProps is null, initial diff";let n=!1;const{dataComparator:r,_dataDiff:i}=t;return r?r(t.data,e.data)||(n="Data comparator detected a change"):t.data!==e.data&&(n="A new data container was supplied"),n&&i&&(n=i(t.data,e.data)||n),n}function WTe(t,e){if(e===null)return{all:!0};if("all"in t.updateTriggers&&yH(t,e,"all"))return{all:!0};const n={};let r=!1;for(const i in t.updateTriggers)i!=="all"&&yH(t,e,i)&&(n[i]=!0,r=!0);return r?n:!1}function qTe(t,e){if(e===null)return!0;const n=e.extensions,{extensions:r}=t;if(r===n)return!1;if(!n||!r||r.length!==n.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(n[i]))return!0;return!1}function yH(t,e,n){let r=t.updateTriggers[n];r=r??{};let i=e.updateTriggers[n];return i=i??{},J5({oldProps:i,newProps:r,triggerName:n})}const XTe="count(): argument not an object",ZTe="count(): argument not a container";function Jne(t){if(!QTe(t))throw new Error(XTe);if(typeof t.count=="function")return t.count();if(Number.isFinite(t.size))return t.size;if(Number.isFinite(t.length))return t.length;if(YTe(t))return Object.keys(t).length;throw new Error(ZTe)}function YTe(t){return t!==null&&typeof t=="object"&&t.constructor===Object}function QTe(t){return t!==null&&typeof t=="object"}function ere(t,e){if(!e)return t;const n={...t,...e};if("defines"in e&&(n.defines={...t.defines,...e.defines}),"modules"in e&&(n.modules=(t.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=n.modules.findIndex(i=>i.name==="project32");r>=0&&n.modules.splice(r,1)}if("inject"in e)if(!t.inject)n.inject=e.inject;else{const r={...t.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];n.inject=r}return n}const KTe={10241:9987,10240:9729,10242:33071,10243:33071},JF={};function JTe(t,e,n,r){if(n instanceof Pl)return n;n.constructor&&n.constructor.name!=="Object"&&(n={data:n});let i=null;n.compressed&&(i={10241:n.data.length>1?9985:9729});const o=new Pl(e,{...n,parameters:{...KTe,...i,...r}});return JF[o.id]=t,o}function eCe(t,e){!e||!(e instanceof Pl)||JF[e.id]===t&&(e.delete(),delete JF[e.id])}const tCe={boolean:{validate(t,e){return!0},equal(t,e,n){return!!t==!!e}},number:{validate(t,e){return Number.isFinite(t)&&(!("max"in e)||t<=e.max)&&(!("min"in e)||t>=e.min)}},color:{validate(t,e){return e.optional&&!t||ek(t)&&(t.length===3||t.length===4)},equal(t,e,n){return uc(t,e,1)}},accessor:{validate(t,e){const n=AI(t);return n==="function"||n===AI(e.value)},equal(t,e,n){return typeof e=="function"?!0:uc(t,e,1)}},array:{validate(t,e){return e.optional&&!t||ek(t)},equal(t,e,n){const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?uc(t,e,i):t===e}},object:{equal(t,e,n){if(n.ignore)return!0;const{compare:r}=n,i=Number.isInteger(r)?r:r?1:0;return r?uc(t,e,i):t===e}},function:{validate(t,e){return e.optional&&!t||typeof t=="function"},equal(t,e,n){return!n.compare&&n.ignore!==!1||t===e}},data:{transform:(t,e,n)=>{const{dataTransform:r}=n.props;return r&&t?r(t):t}},image:{transform:(t,e,n)=>{const r=n.context;return!r||!r.gl?null:JTe(n.id,r.gl,t,{...e.parameters,...n.props.textureParameters})},release:(t,e,n)=>{eCe(n.id,t)}}};function nCe(t){const e={},n={},r={};for(const[i,o]of Object.entries(t)){const a=o==null?void 0:o.deprecatedFor;if(a)r[i]=Array.isArray(a)?a:[a];else{const s=rCe(i,o);e[i]=s,n[i]=s.value}}return{propTypes:e,defaultProps:n,deprecatedProps:r}}function rCe(t,e){switch(AI(e)){case"object":return db(t,e);case"array":return db(t,{type:"array",value:e,compare:!1});case"boolean":return db(t,{type:"boolean",value:e});case"number":return db(t,{type:"number",value:e});case"function":return db(t,{type:"function",value:e,compare:!0});default:return{name:t,type:"unknown",value:e}}}function db(t,e){return"type"in e?{name:t,...tCe[e.type],...e}:"value"in e?{name:t,type:AI(e.value),...e}:{name:t,type:"object",value:e}}function ek(t){return Array.isArray(t)||ArrayBuffer.isView(t)}function AI(t){return ek(t)?"array":t===null?"null":typeof t}function iCe(t,e){let n;for(let o=e.length-1;o>=0;o--){const a=e[o];"extensions"in a&&(n=a.extensions)}const r=tk(t.constructor,n),i=Object.create(r);i[pI]=t,i[U0]={},i[Mm]={};for(let o=0;o<e.length;++o){const a=e[o];for(const s in a)i[s]=a[s]}return Object.freeze(i),i}const oCe="_mergedDefaultProps";function tk(t,e){let n=oCe;if(e)for(const i of e){const o=i.constructor;o&&(n+=":".concat(o.extensionName||o.name))}const r=tre(t,n);return r||(t[n]=sCe(t,e||[]))}function sCe(t,e){if(!t.prototype)return null;const r=Object.getPrototypeOf(t),i=tk(r),o=tre(t,"defaultProps")||{},a=nCe(o),s=Object.assign(Object.create(null),i,a.defaultProps),u=Object.assign(Object.create(null),i==null?void 0:i[Vm],a.propTypes),d=Object.assign(Object.create(null),i==null?void 0:i[oB],a.deprecatedProps);for(const g of e){const _=tk(g.constructor);_&&(Object.assign(s,_),Object.assign(u,_[Vm]),Object.assign(d,_[oB]))}return aCe(s,t),uCe(s,u),lCe(s,d),s[Vm]=u,s[oB]=d,e.length===0&&!e6(t,"_propTypes")&&(t._propTypes=u),s}function aCe(t,e){const n=fCe(e);Object.defineProperties(t,{id:{writable:!0,value:n}})}function lCe(t,e){for(const n in e)Object.defineProperty(t,n,{enumerable:!1,set(r){const i="".concat(this.id,": ").concat(n);for(const o of e[n])e6(this,o)||(this[o]=r);Or.deprecated(i,e[n].join("/"))()}})}function uCe(t,e){const n={},r={};for(const i in e){const o=e[i],{name:a,value:s}=o;o.async&&(n[a]=s,r[a]=cCe(a))}t[vv]=n,t[U0]={},Object.defineProperties(t,r)}function cCe(t){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||Hne(e)?this[U0][t]=e:this[Mm][t]=e},get(){if(this[Mm]){if(t in this[Mm])return this[Mm][t]||this[vv][t];if(t in this[U0]){const e=this[pI]&&this[pI].internalState;if(e&&e.hasAsyncProp(t))return e.getAsyncProp(t)||this[vv][t]}}return this[vv][t]}}}function e6(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function tre(t,e){return e6(t,e)&&t[e]}function fCe(t){const e=t.componentName;return e||Or.warn("".concat(t.name,".componentName not specified"))(),e||t.name}let hCe=0;class t6{constructor(...e){q(this,"id",void 0),q(this,"props",void 0),q(this,"count",void 0),this.props=iCe(this,e),this.id=this.props.id,this.count=hCe++}clone(e){const{props:n}=this,r={};for(const i in n[vv])i in n[Mm]?r[i]=n[Mm][i]:i in n[U0]&&(r[i]=n[U0][i]);return new this.constructor({...n,...r,...e})}}q(t6,"componentName","Component");q(t6,"defaultProps",{});const dCe=Object.freeze({});class pCe{constructor(e){q(this,"component",void 0),q(this,"onAsyncPropUpdated",void 0),q(this,"asyncProps",void 0),q(this,"oldProps",void 0),q(this,"oldAsyncProps",void 0),this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const n=this.asyncProps[e];n&&n.type&&n.type.release&&n.type.release(n.resolvedValue,n.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||dCe}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const n=this.asyncProps[e];return n&&n.resolvedValue}isAsyncPropLoading(e){if(e){const n=this.asyncProps[e];return!!(n&&n.pendingLoadCount>0&&n.pendingLoadCount!==n.resolvedLoadCount)}for(const n in this.asyncProps)if(this.isAsyncPropLoading(n))return!0;return!1}reloadAsyncProp(e,n){this._watchPromise(e,Promise.resolve(n))}setAsyncProps(e){this.component=e[pI]||this.component;const n=e[Mm]||{},r=e[U0]||e,i=e[vv]||{};for(const o in n){const a=n[o];this._createAsyncPropData(o,i[o]),this._updateAsyncProp(o,a),n[o]=this.getAsyncProp(o)}for(const o in r){const a=r[o];this._createAsyncPropData(o,i[o]),this._updateAsyncProp(o,a)}}_fetch(e,n){return null}_onResolve(e,n){}_onError(e,n){}_updateAsyncProp(e,n){if(this._didAsyncInputValueChange(e,n)){if(typeof n=="string"&&(n=this._fetch(e,n)),n instanceof Promise){this._watchPromise(e,n);return}if(Hne(n)){this._resolveAsyncIterable(e,n);return}this._setPropValue(e,n)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,n){const r=this.asyncProps[e];return n===r.resolvedValue||n===r.lastValue?!1:(r.lastValue=n,!0)}_setPropValue(e,n){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(n=this._postProcessValue(r,n),r.resolvedValue=n,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,n,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&n!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=n,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,n))}_watchPromise(e,n){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;n.then(o=>{this.component&&(o=this._postProcessValue(r,o),this._setAsyncPropValue(e,o,i),this._onResolve(e,o))}).catch(o=>{this._onError(e,o)})}}async _resolveAsyncIterable(e,n){if(e!=="data"){this._setPropValue(e,n);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let o=[],a=0;for await(const s of n){if(!this.component)return;const{dataTransform:u}=this.component.props;u?o=u(s,o):o=o.concat(s),Object.defineProperty(o,"__diff",{enumerable:!1,value:[{startRow:a,endRow:o.length}]}),a=o.length,this._setAsyncPropValue(e,o,i)}this._onResolve(e,o)}_postProcessValue(e,n){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(n,r,this.component):n}_createAsyncPropData(e,n){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Vm];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:n,pendingLoadCount:0,resolvedLoadCount:0}}}}class gCe extends pCe{constructor({attributeManager:e,layer:n}){super(n),q(this,"attributeManager",void 0),q(this,"needsRedraw",void 0),q(this,"needsUpdate",void 0),q(this,"subLayers",void 0),q(this,"usesPickingColorCache",void 0),q(this,"hasPickingBuffer",void 0),q(this,"changeFlags",void 0),q(this,"viewport",void 0),q(this,"uniformTransitions",void 0),q(this,"propsInTransition",void 0),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,n){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(n,{propName:e,layer:r}):super._fetch(e,n)}_onResolve(e,n){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(n,{propName:e,layer:r})}}_onError(e,n){const r=this.layer;r&&r.raiseError(n,"loading ".concat(e," of ").concat(this.layer))}}const mCe="layer.changeFlag",ACe="layer.initialize",_Ce="layer.update",yCe="layer.finalize",vCe="layer.matched",vH=2**24-1,xCe=Object.freeze([]),bCe=N1(({oldViewport:t,viewport:e})=>t.equals(e));let pd=new Uint8ClampedArray(0);const wCe={data:{type:"data",value:xCe,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:t=>t&&t.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(t,{propName:e,layer:n,loaders:r,loadOptions:i,signal:o})=>{const{resourceManager:a}=n.context;if(i=i||n.getLoadOptions(),r=r||n.props.loaders,o){var s;i={...i,fetch:{...(s=i)===null||s===void 0?void 0:s.fetch,signal:o}}}let u=a.contains(t);return!u&&!i&&(a.add({resourceId:t,data:ag(t,r),persistent:!1}),u=!0),u?a.subscribe({resourceId:t,onChange:d=>{var g;return(g=n.internalState)===null||g===void 0?void 0:g.reloadAsyncProp(e,d)},consumerId:n.id,requestId:e}):ag(t,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Br.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:t})=>[0,-t*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class nl extends t6{constructor(...e){super(...e),q(this,"internalState",null),q(this,"lifecycle",zy.NO_STATE),q(this,"context",void 0),q(this,"state",void 0),q(this,"parent",null)}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){const e=this.constructor.layerName||this.constructor.name;return"".concat(e,"({id: '").concat(this.props.id,"'})")}project(e){ia(this.internalState);const n=this.internalState.viewport||this.context.viewport,r=Ine(e,{viewport:n,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,o,a]=YO(r,n.pixelProjectionMatrix);return e.length===2?[i,o]:[i,o,a]}unproject(e){return ia(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,n){ia(this.internalState);const r=this.internalState.viewport||this.context.viewport;return Mne(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...n})}get isComposite(){return!1}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){return this.state&&(this.state.models||this.state.model&&[this.state.model])||[]}setModuleParameters(e){for(const n of this.getModels())n.updateModuleSettings(e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Br.DEFAULT||e===Br.LNGLAT||e===Br.CARTESIAN}onHover(e,n){return this.props.onHover&&this.props.onHover(e,n)||!1}onClick(e,n){return this.props.onClick&&this.props.onClick(e,n)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,n=[]){return n[0]=e+1&255,n[1]=e+1>>8&255,n[2]=e+1>>8>>8&255,n}decodePickingColor(e){ia(e instanceof Uint8Array);const[n,r,i]=e;return n+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:Jne(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){for(const n of this.props.extensions)e=ere(e,n.getShaders.call(this,n));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const n=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&n)if(Array.isArray(r))for(const i of r)n.invalidateAll(i);else n.invalidateAll();if(n){const{props:i}=e,o=this.internalState.hasPickingBuffer,a=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(s=>s.getNeedsPickingBuffer.call(this,s));if(o!==a){this.internalState.hasPickingBuffer=a;const{pickingColors:s,instancePickingColors:u}=n.attributes,d=s||u;d&&(a&&d.constant&&(d.constant=!1,n.invalidate(d.id)),!d.value&&!a&&(d.constant=!0,d.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.delete();const n=this.getAttributeManager();n&&n.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const n of this.getModels())n.draw(e)}getPickingInfo({info:e,mode:n,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,n){var r,i;if(n&&(e=new Error("".concat(n,": ").concat(e.message),{cause:e})),!((r=(i=this.props).onError)!==null&&r!==void 0&&r.call(i,e))){var o,a;(o=this.context)===null||o===void 0||(a=o.onError)===null||a===void 0||a.call(o,e,this)}}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)===null||e===void 0?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const n=this.internalState.viewport;this.internalState.viewport=e,(!n||!bCe({oldViewport:n,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const n=this.getAttributeManager();n&&(e==="all"?n.invalidateAll():n.invalidate(e))}updateAttributes(e){for(const n of this.getModels())this._setModelAttributes(n,e)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const n=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:n.data,numInstances:r,startIndices:i,props:n,transitions:n.transitions,buffers:n.data.attributes,context:this});const o=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(o)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const n=e.update(),r=Object.create(this.props);for(const i in n)Object.defineProperty(r,i,{value:n[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:n}){if(e.constant)return;const r=Math.floor(pd.length/3);if(this.internalState.usesPickingColorCache=!0,r<n){n>vH&&Or.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),pd=jv.allocate(pd,n,{size:3,copy:!0,maxCount:Math.max(n,vH)});const i=Math.floor(pd.length/3),o=[];for(let a=r;a<i;a++)this.encodePickingColor(a,o),pd[a*3+0]=o[0],pd[a*3+1]=o[1],pd[a*3+2]=o[2]}e.value=pd.subarray(0,n*3)}_setModelAttributes(e,n){const r=this.getAttributeManager(),i=e.userData.excludeAttributes||{},o=r.getShaderAttributes(n,i);e.setAttributes(o)}disablePickingIndex(e){const n=this.props.data;if(!("attributes"in n)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,o=r||i,a=o&&n.attributes&&n.attributes[o.id];if(a&&a.value){const s=a.value,u=this.encodePickingColor(e);for(let d=0;d<n.length;d++){const g=o.getVertexOffset(d);s[g]===u[0]&&s[g+1]===u[1]&&s[g+2]===u[2]&&this._disablePickingIndex(d)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:n,instancePickingColors:r}=this.getAttributeManager().attributes,i=n||r;if(!i)return;const o=i.getVertexOffset(e),a=i.getVertexOffset(e+1);i.buffer.subData({data:new Uint8Array(a-o),offset:o})}restorePickingColors(){const{pickingColors:e,instancePickingColors:n}=this.getAttributeManager().attributes,r=e||n;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==pd.buffer&&(r.value=pd.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){ia(!this.internalState),ia(Number.isFinite(this.props.coordinateSystem)),_l(ACe,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new gCe({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(Or.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new GTe(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const n of this.props.extensions)n.initializeState.call(this,this.context,n);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){_l(vCe,this,this===e);const{state:n,internalState:r}=e;this!==e&&(this.internalState=r,this.state=n,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(_l(_Ce,this,e),!e)return;const n=this.props,r=this.context,i=this.internalState,o=r.viewport,a=this._updateUniformTransition();i.propsInTransition=a,r.viewport=i.viewport||o,this.props=a;try{const s=this._getUpdateParams(),u=this.getModels();if(r.gl)this.updateState(s);else try{this.updateState(s)}catch{}for(const g of this.props.extensions)g.updateState.call(this,s,g);const d=this.getModels()[0]!==u[0];this._postUpdate(s,d)}finally{r.viewport=o,this.props=n,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){_l(yCe,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({moduleParameters:e=null,uniforms:n={},parameters:r={}}){this._updateAttributeTransition();const i=this.props,o=this.context;this.props=this.internalState.propsInTransition||i;const a=this.props.opacity;n.opacity=Math.pow(a,1/2.2);try{e&&this.setModuleParameters(e);const{getPolygonOffset:s}=this.props,u=s&&s(n)||[0,0];bh(o.gl,{polygonOffset:u}),Mu(o.gl,r,()=>{const d={moduleParameters:e,uniforms:n,parameters:r,context:o};for(const g of this.props.extensions)g.draw.call(this,d,g);this.draw(d)})}finally{this.props=i}}getChangeFlags(){var e;return(e=this.internalState)===null||e===void 0?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:n}=this.internalState;for(const i in e)if(e[i]){let o=!1;switch(i){case"dataChanged":const a=e[i],s=n[i];a&&Array.isArray(s)&&(n.dataChanged=Array.isArray(a)?s.concat(a):a,o=!0);default:n[i]||(n[i]=e[i],o=!0)}o&&_l(mCe,this,i,e)}const r=!!(n.dataChanged||n.updateTriggersChanged||n.propsChanged||n.extensionsChanged);n.propsOrDataChanged=r,n.somethingChanged=r||n.viewportChanged||n.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,n){const r=VTe(e,n);if(r.updateTriggersChanged)for(const o in r.updateTriggersChanged)r.updateTriggersChanged[o]&&this.invalidateAttribute(o);if(r.transitionsChanged)for(const o in r.transitionsChanged){var i;this.internalState.uniformTransitions.add(o,n[o],e[o],(i=e.transitions)===null||i===void 0?void 0:i[o])}return this.setChangeFlags(r)}validateProps(){jTe(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const n={pickingSelectedColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(n.pickingHighlightColor=r(e)),this.setModuleParameters(n),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new Kne(e.gl,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,n){const{props:r,oldProps:i}=e;this.setNeedsRedraw(),this._updateAttributes();const{model:o}=this.state;o==null||o.setInstanceCount(this.getNumInstances());const{autoHighlight:a,highlightedObjectIndex:s,highlightColor:u}=r;if(n||i.autoHighlight!==a||i.highlightedObjectIndex!==s||i.highlightColor!==u){const d={};a||(d.pickingSelectedColor=null),Array.isArray(u)&&(d.pickingHighlightColor=u),(n||s!==i.highlightedObjectIndex)&&(d.pickingSelectedColor=Number.isFinite(s)&&s>=0?this.encodePickingColor(s):null),this.setModuleParameters(d)}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let n=!1;n=n||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(n=n||i,n)for(const o of this.props.extensions)o.onNeedsRedraw.call(this,o);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,n}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}q(nl,"defaultProps",wCe);q(nl,"layerName","Layer");const ECe="compositeLayer.renderLayers";class Uh extends nl{get isComposite(){return!0}get isLoaded(){return super.isLoaded&&this.getSubLayers().every(e=>e.isLoaded)}getSubLayers(){return this.internalState&&this.internalState.subLayers||[]}initializeState(e){}setState(e){super.setState(e),this.setNeedsUpdate()}getPickingInfo({info:e}){const{object:n}=e;return n&&n.__source&&n.__source.parent&&n.__source.parent.id===this.id&&(e.object=n.__source.object,e.index=n.__source.index),e}filterSubLayer(e){return!0}shouldRenderSubLayer(e,n){return n&&n.length}getSubLayerClass(e,n){const{_subLayerProps:r}=this.props;return r&&r[e]&&r[e].type||n}getSubLayerRow(e,n,r){return e.__source={parent:this,object:n,index:r},e}getSubLayerAccessor(e){if(typeof e=="function"){const n={index:-1,data:this.props.data,target:[]};return(r,i)=>r&&r.__source?(n.index=r.__source.index,e(r.__source.object,n)):e(r,i)}return e}getSubLayerProps(e={}){var n;const{opacity:r,pickable:i,visible:o,parameters:a,getPolygonOffset:s,highlightedObjectIndex:u,autoHighlight:d,highlightColor:g,coordinateSystem:_,coordinateOrigin:E,wrapLongitude:P,positionFormat:O,modelMatrix:D,extensions:V,fetch:k,operation:F,_subLayerProps:z}=this.props,X={id:"",updateTriggers:{},opacity:r,pickable:i,visible:o,parameters:a,getPolygonOffset:s,highlightedObjectIndex:u,autoHighlight:d,highlightColor:g,coordinateSystem:_,coordinateOrigin:E,wrapLongitude:P,positionFormat:O,modelMatrix:D,extensions:V,fetch:k,operation:F},Y=z&&e.id&&z[e.id],J=Y&&Y.updateTriggers,re=e.id||"sublayer";if(Y){const ue=this.props[Vm],ie=e.type?e.type._propTypes:{};for(const ce in Y){const se=ie[ce]||ue[ce];se&&se.type==="accessor"&&(Y[ce]=this.getSubLayerAccessor(Y[ce]))}}Object.assign(X,e,Y),X.id="".concat(this.props.id,"-").concat(re),X.updateTriggers={all:(n=this.props.updateTriggers)===null||n===void 0?void 0:n.all,...e.updateTriggers,...J};for(const ue of V){const ie=ue.getSubLayerProps.call(this,ue);ie&&Object.assign(X,ie,{updateTriggers:Object.assign(X.updateTriggers,ie.updateTriggers)})}return X}_updateAutoHighlight(e){for(const n of this.getSubLayers())n.updateAutoHighlight(e)}_getAttributeManager(){return null}_postUpdate(e,n){let r=this.internalState.subLayers;const i=!r||this.needsUpdate();if(i){const o=this.renderLayers();r=GE(o,Boolean),this.internalState.subLayers=r}_l(ECe,this,i,r);for(const o of r)o.parent=this}}q(Uh,"layerName","CompositeLayer");const US=Math.PI/180,xH=180/Math.PI,_C=6370972,iv=256;function SCe(){const t=iv/_C,e=Math.PI/180*iv;return{unitsPerMeter:[t,t,t],unitsPerMeter2:[0,0,0],metersPerUnit:[1/t,1/t,1/t],unitsPerDegree:[e,e,t],unitsPerDegree2:[0,0,0],degreesPerUnit:[1/e,1/e,1/t]}}class n6 extends zh{constructor(e={}){const{latitude:n=0,longitude:r=0,zoom:i=0,nearZMultiplier:o=.1,farZMultiplier:a=2,resolution:s=10}=e;let{height:u,altitude:d=1.5}=e;u=u||1,d=Math.max(.75,d);const g=new vr().lookAt({eye:[0,-d,0],up:[0,0,1]}),_=Math.pow(2,i);g.rotateX(n*US),g.rotateZ(-r*US),g.scale(_/u);const E=Math.atan(.5/d),P=iv*2*_/u;super({...e,height:u,viewMatrix:g,longitude:r,latitude:n,zoom:i,distanceScales:SCe(),fovyRadians:E*2,focalDistance:d,near:o,far:Math.min(2,1/P+1)*d*a}),q(this,"longitude",void 0),q(this,"latitude",void 0),q(this,"resolution",void 0),this.latitude=n,this.longitude=r,this.resolution=s}get projectionMode(){return hh.GLOBE}getDistanceScales(){return this.distanceScales}getBounds(e={}){const n={targetZ:e.z||0},r=this.unproject([0,this.height/2],n),i=this.unproject([this.width/2,0],n),o=this.unproject([this.width,this.height/2],n),a=this.unproject([this.width/2,this.height],n);return o[0]<this.longitude&&(o[0]+=360),r[0]>this.longitude&&(r[0]-=360),[Math.min(r[0],o[0],i[0],a[0]),Math.min(r[1],o[1],i[1],a[1]),Math.max(r[0],o[0],i[0],a[0]),Math.max(r[1],o[1],i[1],a[1])]}unproject(e,{topLeft:n=!0,targetZ:r}={}){const[i,o,a]=e,s=n?o:this.height-o,{pixelUnprojectionMatrix:u}=this;let d;if(Number.isFinite(a))d=uB(u,[i,s,a,1]);else{const P=uB(u,[i,s,-1,1]),O=uB(u,[i,s,1,1]),D=((r||0)/_C+1)*iv,V=QD(Xte([],P,O)),k=QD(P),F=QD(O),X=4*((4*k*F-(V-k-F)**2)/16)/V,Y=Math.sqrt(k-X),J=Math.sqrt(Math.max(0,D*D-X)),re=(Y-J)/Math.sqrt(V);d=hbe([],P,O,re)}const[g,_,E]=this.unprojectPosition(d);return Number.isFinite(a)?[g,_,E]:Number.isFinite(r)?[g,_,r]:[g,_]}projectPosition(e){const[n,r,i=0]=e,o=n*US,a=r*US,s=Math.cos(a),u=(i/_C+1)*iv;return[Math.sin(o)*s*u,-Math.cos(o)*s*u,Math.sin(a)*u]}unprojectPosition(e){const[n,r,i]=e,o=Zte(e),a=Math.asin(i/o),u=Math.atan2(n,-r)*xH,d=a*xH,g=(o/iv-1)*_C;return[u,d,g]}projectFlat(e){return e}unprojectFlat(e){return e}panByPosition(e,n){const r=this.unproject(n);return{longitude:e[0]-r[0]+this.longitude,latitude:e[1]-r[1]+this.latitude}}}function uB(t,e){const n=D1([],e,t);return D5(n,n,1/n[3]),n}const cB=Math.PI/180;function TCe({height:t,focalDistance:e,orbitAxis:n,rotationX:r,rotationOrbit:i,zoom:o}){const a=n==="Z"?[0,0,1]:[0,1,0],s=n==="Z"?[0,-e,0]:[0,0,e],u=new vr().lookAt({eye:s,up:a});u.rotateX(r*cB),n==="Z"?u.rotateZ(i*cB):u.rotateY(i*cB);const d=Math.pow(2,o)/t;return u.scale(d),u}class nre extends zh{constructor(e){const{height:n,projectionMatrix:r,fovy:i=50,orbitAxis:o="Z",target:a=[0,0,0],rotationX:s=0,rotationOrbit:u=0,zoom:d=0}=e,g=r?r[5]/2:UE(i);super({...e,longitude:void 0,viewMatrix:TCe({height:n||1,focalDistance:g,orbitAxis:o,rotationX:s,rotationOrbit:u,zoom:d}),fovy:i,focalDistance:g,position:a,zoom:d}),q(this,"projectedCenter",void 0),this.projectedCenter=this.project(this.center)}unproject(e,{topLeft:n=!0}={}){const[r,i,o=this.projectedCenter[2]]=e,a=n?i:this.height-i,[s,u,d]=Km([r,a,o],this.pixelUnprojectionMatrix);return[s,u,d]}panByPosition(e,n){const r=this.project(e),i=[this.width/2+r[0]-n[0],this.height/2+r[1]-n[1],this.projectedCenter[2]];return{target:this.unproject(i)}}}const CCe=new vr().lookAt({eye:[0,0,1]});function PCe({width:t,height:e,near:n,far:r,padding:i}){let o=-t/2,a=t/2,s=-e/2,u=e/2;if(i){const{left:d=0,right:g=0,top:_=0,bottom:E=0}=i,P=Wi((d+t-g)/2,0,t)-t/2,O=Wi((_+e-E)/2,0,e)-e/2;o-=P,a-=P,s+=O,u+=O}return new vr().ortho({left:o,right:a,bottom:s,top:u,near:n,far:r})}class rre extends zh{constructor(e){const{width:n,height:r,near:i=.1,far:o=1e3,zoom:a=0,target:s=[0,0,0],padding:u=null,flipY:d=!0}=e,g=Array.isArray(a)?a[0]:a,_=Array.isArray(a)?a[1]:a,E=Math.min(g,_),P=Math.pow(2,E);let O;if(g!==_){const D=Math.pow(2,g),V=Math.pow(2,_);O={unitsPerMeter:[D/P,V/P,1],metersPerUnit:[P/D,P/V,1]}}super({...e,longitude:void 0,position:s,viewMatrix:CCe.clone().scale([P,P*(d?-1:1),P]),projectionMatrix:PCe({width:n||1,height:r||1,padding:u,near:i,far:o}),zoom:E,distanceScales:O})}projectFlat([e,n]){const{unitsPerMeter:r}=this.distanceScales;return[e*r[0],n*r[1]]}unprojectFlat([e,n]){const{metersPerUnit:r}=this.distanceScales;return[e*r[0],n*r[1]]}panByPosition(e,n){const r=Km(n,this.pixelUnprojectionMatrix),i=this.projectFlat(e),o=F0([],i,M5([],r)),a=F0([],this.center,o);return{target:this.unprojectFlat(a)}}}class ire extends zh{constructor(e){const{longitude:n,latitude:r,modelMatrix:i,bearing:o=0,pitch:a=0,up:s=[0,0,1]}=e,d=new zv({bearing:o,pitch:a===-90?1e-4:90+a}).toVector3().normalize(),g=i?new vr(i).transformAsVector(d):d,_=Number.isFinite(r)?U5({latitude:r}):0,E=Math.pow(2,_),P=new vr().lookAt({eye:[0,0,0],center:g,up:s}).scale(E);super({...e,zoom:_,viewMatrix:P}),q(this,"longitude",void 0),q(this,"latitude",void 0),this.latitude=r,this.longitude=n}}const pb=20;class r6 extends Z5{constructor(e){const{width:n,height:r,position:i=[0,0,0],bearing:o=0,pitch:a=0,longitude:s=null,latitude:u=null,maxPitch:d=90,minPitch:g=-90,startRotatePos:_,startBearing:E,startPitch:P,startZoomPosition:O}=e;super({width:n,height:r,position:i,bearing:o,pitch:a,longitude:s,latitude:u,maxPitch:d,minPitch:g},{startRotatePos:_,startBearing:E,startPitch:P,startZoomPosition:O})}panStart(){return this}pan(){return this}panEnd(){return this}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:o,startPitch:a}=this.getState(),{width:s,height:u}=this.getViewportProps();if(!i||o===void 0||a===void 0)return this;let d;if(e){const g=(e[0]-i[0])/s,_=(e[1]-i[1])/u;d={bearing:o-g*180,pitch:a-_*90}}else d={bearing:o-n,pitch:a-r};return this._getUpdatedState(d)}rotateEnd(){return this._getUpdatedState({startRotatePos:null,startBearing:null,startPitch:null})}zoomStart(){return this._getUpdatedState({startZoomPosition:this.getViewportProps().position})}zoom({scale:e}){let{startZoomPosition:n}=this.getState();n||(n=this.getViewportProps().position);const r=this.getDirection();return this._move(r,Math.log2(e)*pb,n)}zoomEnd(){return this._getUpdatedState({startZoomPosition:null})}moveLeft(e=pb){const n=this.getDirection(!0);return this._move(n.rotateZ({radians:Math.PI/2}),e)}moveRight(e=pb){const n=this.getDirection(!0);return this._move(n.rotateZ({radians:-Math.PI/2}),e)}moveUp(e=pb){const n=this.getDirection(!0);return this._move(n,e)}moveDown(e=pb){const n=this.getDirection(!0);return this._move(n.negate(),e)}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}zoomIn(e=2){return this.zoom({scale:e})}zoomOut(e=2){return this.zoom({scale:1/e})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:o}=r;return Math.abs(i-n.bearing)>180&&(r.bearing=i<0?i+360:i-360),o!==null&&n.longitude!==null&&Math.abs(o-n.longitude)>180&&(r.longitude=o<0?o+360:o-360),r}_move(e,n,r=this.getViewportProps().position){const i=e.scale(n);return this._getUpdatedState({position:new _t(r).add(i)})}getDirection(e=!1){return new zv({bearing:this.getViewportProps().bearing,pitch:e?90:90+this.getViewportProps().pitch}).toVector3().normalize()}_getUpdatedState(e){return new r6({...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{pitch:n,maxPitch:r,minPitch:i,longitude:o,bearing:a}=e;return e.pitch=Wi(n,i,r),o!==null&&(o<-180||o>180)&&(e.longitude=hI(o+180,360)-180),(a<-180||a>180)&&(e.bearing=hI(a+180,360)-180),e}}class ore extends F1{constructor(...e){super(...e),q(this,"ControllerState",r6),q(this,"transition",{transitionDuration:300,transitionInterpolator:new h_(["position","pitch","bearing"])})}}class sre extends Sh{get ViewportType(){return ire}get ControllerType(){return ore}}q(sre,"displayName","FirstPersonView");class are extends Z5{constructor(e){const{width:n,height:r,rotationX:i=0,rotationOrbit:o=0,target:a=[0,0,0],zoom:s=0,minRotationX:u=-90,maxRotationX:d=90,minZoom:g=-1/0,maxZoom:_=1/0,startPanPosition:E,startRotatePos:P,startRotationX:O,startRotationOrbit:D,startZoomPosition:V,startZoom:k}=e;super({width:n,height:r,rotationX:i,rotationOrbit:o,target:a,zoom:s,minRotationX:u,maxRotationX:d,minZoom:g,maxZoom:_},{startPanPosition:E,startRotatePos:P,startRotationX:O,startRotationOrbit:D,startZoomPosition:V,startZoom:k}),q(this,"makeViewport",void 0),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanPosition:this._unproject(e)})}pan({pos:e,startPosition:n}){const r=this.getState().startPanPosition||n;if(!r)return this;const o=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(o)}panEnd(){return this._getUpdatedState({startPanPosition:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startRotationX:this.getViewportProps().rotationX,startRotationOrbit:this.getViewportProps().rotationOrbit})}rotate({pos:e,deltaAngleX:n=0,deltaAngleY:r=0}){const{startRotatePos:i,startRotationX:o,startRotationOrbit:a}=this.getState(),{width:s,height:u}=this.getViewportProps();if(!i||o===void 0||a===void 0)return this;let d;if(e){let g=(e[0]-i[0])/s;const _=(e[1]-i[1])/u;(o<-90||o>90)&&(g*=-1),d={rotationX:o+_*180,rotationOrbit:a+g*180}}else d={rotationX:o+r,rotationOrbit:a+n};return this._getUpdatedState(d)}rotateEnd(){return this._getUpdatedState({startRotationX:null,startRotationOrbit:null})}shortestPathFrom(e){const n=e.getViewportProps(),r={...this.getViewportProps()},{rotationOrbit:i}=r;return Math.abs(i-n.rotationOrbit)>180&&(r.rotationOrbit=i<0?i+360:i-360),r}zoomStart({pos:e}){return this._getUpdatedState({startZoomPosition:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:n,scale:r}){let{startZoom:i,startZoomPosition:o}=this.getState();if(o||(i=this.getViewportProps().zoom,o=this._unproject(n)||this._unproject(e)),!o)return this;const a=this._calculateNewZoom({scale:r,startZoom:i}),s=this.makeViewport({...this.getViewportProps(),zoom:a});return this._getUpdatedState({zoom:a,...s.panByPosition(o,e)})}zoomEnd(){return this._getUpdatedState({startZoomPosition:null,startZoom:null})}zoomIn(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:e})})}zoomOut(e=2){return this._getUpdatedState({zoom:this._calculateNewZoom({scale:1/e})})}moveLeft(e=50){return this._panFromCenter([-e,0])}moveRight(e=50){return this._panFromCenter([e,0])}moveUp(e=50){return this._panFromCenter([0,-e])}moveDown(e=50){return this._panFromCenter([0,e])}rotateLeft(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit-e})}rotateRight(e=15){return this._getUpdatedState({rotationOrbit:this.getViewportProps().rotationOrbit+e})}rotateUp(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX-e})}rotateDown(e=10){return this._getUpdatedState({rotationX:this.getViewportProps().rotationX+e})}_unproject(e){const n=this.makeViewport(this.getViewportProps());return e&&n.unproject(e)}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:r,minZoom:i}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);const o=n+Math.log2(e);return Wi(o,i,r)}_panFromCenter(e){const{width:n,height:r,target:i}=this.getViewportProps();return this.pan({startPosition:i,pos:[n/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i,maxRotationX:o,minRotationX:a,rotationOrbit:s}=e;return e.zoom=Array.isArray(i)?[Wi(i[0],r,n),Wi(i[1],r,n)]:Wi(i,r,n),e.rotationX=Wi(e.rotationX,a,o),(s<-180||s>180)&&(e.rotationOrbit=hI(s+180,360)-180),e}}class lre extends F1{constructor(...e){super(...e),q(this,"ControllerState",are),q(this,"transition",{transitionDuration:300,transitionInterpolator:new h_({transitionProps:{compare:["target","zoom","rotationX","rotationOrbit"],required:["target","zoom"]}})})}}class ure extends Sh{constructor(e={}){super(e),this.props.orbitAxis=e.orbitAxis||"Z"}get ViewportType(){return nre}get ControllerType(){return lre}}q(ure,"displayName","OrbitView");class ICe extends are{constructor(e){super(e),q(this,"zoomAxis",void 0),this.zoomAxis=e.zoomAxis||"all"}_calculateNewZoom({scale:e,startZoom:n}){const{maxZoom:r,minZoom:i}=this.getViewportProps();n===void 0&&(n=this.getViewportProps().zoom);let o=Math.log2(e);if(Array.isArray(n)){let[a,s]=n;switch(this.zoomAxis){case"X":a=Wi(a+o,i,r);break;case"Y":s=Wi(s+o,i,r);break;default:let u=Math.min(a+o,s+o);u<i&&(o+=i-u),u=Math.max(a+o,s+o),u>r&&(o+=r-u),a+=o,s+=o}return[a,s]}return Wi(n+o,i,r)}}class cre extends F1{constructor(...e){super(...e),q(this,"ControllerState",ICe),q(this,"transition",{transitionDuration:300,transitionInterpolator:new h_(["target","zoom"])}),q(this,"dragMode","pan")}_onPanRotate(){return!1}}class fre extends Sh{get ViewportType(){return rre}get ControllerType(){return cre}}q(fre,"displayName","OrthographicView");class MCe extends Bne{applyConstraints(e){const{maxZoom:n,minZoom:r,zoom:i}=e;e.zoom=Wi(i,r,n);const{longitude:o,latitude:a}=e;return(o<-180||o>180)&&(e.longitude=hI(o+180,360)-180),e.latitude=Wi(a,-89,89),e}}class hre extends F1{constructor(...e){super(...e),q(this,"ControllerState",MCe),q(this,"transition",{transitionDuration:300,transitionInterpolator:new h_(["longitude","latitude","zoom"])}),q(this,"dragMode","pan")}setProps(e){super.setProps(e),this.dragRotate=!1,this.touchRotate=!1}}class dre extends Sh{get ViewportType(){return n6}get ControllerType(){return hre}}q(dre,"displayName","GlobeView");class JO{static get componentName(){return Object.prototype.hasOwnProperty.call(this,"extensionName")?this.extensionName:""}constructor(e){q(this,"opts",void 0),e&&(this.opts=e)}equals(e){return this===e?!0:this.constructor===e.constructor&&uc(this.opts,e.opts,1)}getShaders(e){return null}getSubLayerProps(e){const{defaultProps:n}=e.constructor,r={updateTriggers:{}};for(const i in n)if(i in this.props){const o=n[i],a=this.props[i];r[i]=a,o&&o.type==="accessor"&&(r.updateTriggers[i]=this.props.updateTriggers[i],typeof a=="function"&&(r[i]=this.getSubLayerAccessor(a)))}return r}initializeState(e,n){}updateState(e,n){}onNeedsRedraw(e){}getNeedsPickingBuffer(e){return!1}draw(e,n){}finalizeState(e,n){}}q(JO,"defaultProps",{});q(JO,"extensionName","LayerExtension");const fB={bearing:0,pitch:0,position:[0,0,0]},OCe={speed:1.2,curve:1.414};class pre extends X5{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),q(this,"opts",void 0),this.opts={...OCe,...e}}interpolateProps(e,n,r){const i=Sne(e,n,r,this.opts);for(const o in fB)i[o]=pc(e[o]||fB[o],n[o]||fB[o],r);return i}getDuration(e,n){let{transitionDuration:r}=n;return r==="auto"&&(r=Tne(e,n,this.opts)),r}}class i6{constructor(e){q(this,"opts",void 0),q(this,"typedArrayManager",void 0),q(this,"indexStarts",[0]),q(this,"vertexStarts",[0]),q(this,"vertexCount",0),q(this,"instanceCount",0),q(this,"attributes",void 0),q(this,"_attributeDefs",void 0),q(this,"data",void 0),q(this,"getGeometry",void 0),q(this,"geometryBuffer",void 0),q(this,"buffers",void 0),q(this,"positionSize",void 0),q(this,"normalize",void 0);const{attributes:n={}}=e;this.typedArrayManager=jv,this.attributes={},this._attributeDefs=n,this.opts=e,this.updateGeometry(e)}updateGeometry(e){Object.assign(this.opts,e);const{data:n,buffers:r={},getGeometry:i,geometryBuffer:o,positionFormat:a,dataChanged:s,normalize:u=!0}=this.opts;if(this.data=n,this.getGeometry=i,this.positionSize=o&&o.size||(a==="XY"?2:3),this.buffers=r,this.normalize=u,o&&(ia(n.startIndices),this.getGeometry=this.getGeometryFromBuffer(o),u||(r.positions=o)),this.geometryBuffer=r.positions,Array.isArray(s))for(const d of s)this._rebuildGeometry(d);else this._rebuildGeometry()}updatePartialGeometry({startRow:e,endRow:n}){this._rebuildGeometry({startRow:e,endRow:n})}getGeometryFromBuffer(e){const n=e.value||e;return ArrayBuffer.isView(n)?Wne(n,{size:this.positionSize,offset:e.offset,stride:e.stride,startIndices:this.data.startIndices}):null}_allocate(e,n){const{attributes:r,buffers:i,_attributeDefs:o,typedArrayManager:a}=this;for(const s in o)if(s in i)a.release(r[s]),r[s]=null;else{const u=o[s];u.copy=n,r[s]=a.allocate(r[s],e,u)}}_forEachGeometry(e,n,r){const{data:i,getGeometry:o}=this,{iterable:a,objectInfo:s}=Tg(i,n,r);for(const u of a){s.index++;const d=o?o(u,s):null;e(d,s.index)}}_rebuildGeometry(e){if(!this.data)return;let{indexStarts:n,vertexStarts:r,instanceCount:i}=this;const{data:o,geometryBuffer:a}=this,{startRow:s=0,endRow:u=1/0}=e||{},d={};if(e||(n=[0],r=[0]),this.normalize||!a)this._forEachGeometry((_,E)=>{const P=_&&this.normalizeGeometry(_);d[E]=P,r[E+1]=r[E]+(P?this.getGeometrySize(P):0)},s,u),i=r[r.length-1];else if(r=o.startIndices,i=r[o.length]||0,ArrayBuffer.isView(a))i=i||a.length/this.positionSize;else if(a instanceof ji){const _=a.accessor.stride||this.positionSize*4;i=i||a.byteLength/_}else if(a.buffer){const _=a.stride||this.positionSize*4;i=i||a.buffer.byteLength/_}else if(a.value){const _=a.value,E=a.stride/_.BYTES_PER_ELEMENT||this.positionSize;i=i||_.length/E}this._allocate(i,!!e),this.indexStarts=n,this.vertexStarts=r,this.instanceCount=i;const g={};this._forEachGeometry((_,E)=>{const P=d[E]||_;g.vertexStart=r[E],g.indexStart=n[E];const O=E<r.length-1?r[E+1]:i;g.geometrySize=O-r[E],g.geometryIndex=E,this.updateGeometryAttributes(P,g)},s,u),this.vertexCount=n[n.length-1]}}const RCe=Object.freeze(Object.defineProperty({__proto__:null,AmbientLight:fne,AttributeManager:Kne,COORDINATE_SYSTEM:Br,CompositeLayer:Uh,Controller:F1,Deck:$E,DeckRenderer:Fne,DirectionalLight:uI,FirstPersonController:ore,FirstPersonView:sre,FirstPersonViewport:ire,FlyToInterpolator:pre,Layer:nl,LayerExtension:JO,LayerManager:Dne,LightingEffect:W5,LinearInterpolator:h_,MapController:Nne,MapView:QO,OPERATION:Y_e,OrbitController:lre,OrbitView:ure,OrbitViewport:nre,OrthographicController:cre,OrthographicView:fre,OrthographicViewport:rre,PointLight:One,PostProcessEffect:Q2e,TRANSITION_EVENTS:gI,Tesselator:i6,TransitionInterpolator:X5,UNIT:Bu,VERSION:tte,View:Sh,Viewport:zh,WebMercatorViewport:ug,_CameraLight:O2e,_GlobeController:hre,_GlobeView:dre,_GlobeViewport:n6,_LayersPass:XO,_PickLayersPass:q5,_SunLight:Y2e,_compareProps:J5,_count:Jne,_deepEqual:uc,_fillArray:Lne,_flatten:GE,_memoize:N1,_mergeShaders:ere,assert:ia,createIterable:Tg,fp64LowPart:Pne,gouraudLighting:zE,log:Or,phongLighting:HO,picking:Oc,project:ZO,project32:Mc,shadow:gC},Symbol.toStringTag,{value:"Module"})),LCe=typeof window<"u"?Ee.useLayoutEffect:Ee.useEffect,DCe=LCe;function _I(t,e){for(;t;){if(t===e)return!0;t=Object.getPrototypeOf(t)}return!1}const BCe={position:"absolute",zIndex:-1};function gre(t,e){if(typeof t=="function")return t(e);if(Array.isArray(t))return t.map(n=>gre(n,e));if(eR(t)){if(NCe(t))return e.style=BCe,Ee.cloneElement(t,e);if(FCe(t))return Ee.cloneElement(t,e)}return t}function eR(t){return t&&typeof t=="object"&&"type"in t||!1}function NCe(t){var e;return(e=t.props)===null||e===void 0?void 0:e.mapStyle}function FCe(t){const e=t.type;return e&&e.deckGLViewProps}function nk(t){if(typeof t=="function")return Ee.createElement(Sh,{},t);if(Array.isArray(t))return t.map(nk);if(eR(t)){if(t.type===Ee.Fragment)return nk(t.props.children);if(_I(t.type,Sh))return t}return t}function kCe({children:t,layers:e=[],views:n=null}){const r=[],i=[],o={};return Ee.Children.forEach(nk(t),a=>{if(eR(a)){const s=a.type;if(_I(s,nl)){const u=zCe(s,a.props);i.push(u)}else r.push(a);if(_I(s,Sh)&&s!==Sh&&a.props.id){const u=new s(a.props);o[u.id]=u}}else a&&r.push(a)}),Object.keys(o).length>0&&(Array.isArray(n)?n.forEach(a=>{o[a.id]=a}):n&&(o[n.id]=n),n=Object.values(o)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:n}}function zCe(t,e){const n={},r=t.defaultProps||{};for(const i in e)r[i]!==e[i]&&(n[i]=e[i]);return new t(n)}function UCe({children:t,deck:e,ContextProvider:n}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},o=r.views[0].id;for(const a of t){let s=o,u=a;eR(a)&&_I(a.type,Sh)&&(s=a.props.id||o,u=a.props.children);const d=r.getViewport(s),g=r.getViewState(s);if(d){g.padding=d.padding;const{x:_,y:E,width:P,height:O}=d;u=gre(u,{x:_,y:E,width:P,height:O,viewport:d,viewState:g}),i[s]||(i[s]={viewport:d,children:[]}),i[s].children.push(u)}}return Object.keys(i).map(a=>{const{viewport:s,children:u}=i[a],{x:d,y:g,width:_,height:E}=s,P={position:"absolute",left:d,top:g,width:_,height:E},O="view-".concat(a),D=Ee.createElement("div",{key:O,id:O,style:P},...u);if(n){const V={viewport:s,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:k=>{k.viewId=a,e._onViewStateChange(k)}};return Ee.createElement(n,{key:O,value:V},D)}return D})}const GCe={mixBlendMode:null};function jCe({width:t,height:e,style:n}){const r={position:"absolute",zIndex:0,left:0,top:0,width:t,height:e},i={left:0,top:0};if(n)for(const o in n)o in GCe?i[o]=n[o]:r[o]=n[o];return{containerStyle:r,canvasStyle:i}}function VCe(t){return{get deck(){return t.deck},pickObject:e=>t.deck.pickObject(e),pickMultipleObjects:e=>t.deck.pickMultipleObjects(e),pickObjects:e=>t.deck.pickObjects(e)}}function mre(t){t.redrawReason&&(t.deck._drawLayers(t.redrawReason),t.redrawReason=null)}function $Ce(t,e,n){const r=new e({...n,_customRender:i=>{t.redrawReason=i;const o=r.getViewports();t.lastRenderedViewports!==o?t.forceUpdate():mre(t)}});return r}const Are=Ee.forwardRef((t,e)=>{const[n,r]=Ee.useState(0),o=Ee.useRef({control:null,version:n,forceUpdate:()=>r(Y=>Y+1)}).current,a=Ee.useRef(null),s=Ee.useRef(null),u=Ee.useMemo(()=>kCe(t),[t.layers,t.views,t.children]);let d=!0;const g=Y=>{var J;return d&&t.viewState?(o.viewStateUpdateRequested=Y,null):(o.viewStateUpdateRequested=null,(J=t.onViewStateChange)===null||J===void 0?void 0:J.call(t,Y))},_=Y=>{if(d)o.interactionStateUpdateRequested=Y;else{var J;o.interactionStateUpdateRequested=null,(J=t.onInteractionStateChange)===null||J===void 0||J.call(t,Y)}},E=Ee.useMemo(()=>{const Y={...t,style:null,width:"100%",height:"100%",parent:a.current,canvas:s.current,layers:u.layers,views:u.views,onViewStateChange:g,onInteractionStateChange:_};return delete Y._customRender,o.deck&&o.deck.setProps(Y),Y},[t]);Ee.useEffect(()=>{const Y=t.Deck||$E;return o.deck=$Ce(o,Y,{...E,parent:a.current,canvas:s.current}),()=>{var J;return(J=o.deck)===null||J===void 0?void 0:J.finalize()}},[]),DCe(()=>{mre(o);const{viewStateUpdateRequested:Y,interactionStateUpdateRequested:J}=o;Y&&g(Y),J&&_(J)}),Ee.useImperativeHandle(e,()=>VCe(o),[]);const P=o.deck&&o.deck.isInitialized?o.deck.getViewports():void 0,{ContextProvider:O,width:D,height:V,id:k,style:F}=t,{containerStyle:z,canvasStyle:X}=Ee.useMemo(()=>jCe({width:D,height:V,style:F}),[D,V,F]);if(!o.viewStateUpdateRequested&&o.lastRenderedViewports===P||o.version!==n){o.lastRenderedViewports=P,o.version=n;const Y=UCe({children:u.children,deck:o.deck,ContextProvider:O}),J=Ee.createElement("canvas",{key:"canvas",id:k||"deckgl-overlay",ref:s,style:X});o.control=Ee.createElement("div",{id:"".concat(k||"deckgl","-wrapper"),ref:a,style:z},[J,Y])}return d=!1,o.control});Are.defaultProps=$E.defaultProps;const HCe=Are;var Hp={},So={};/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function WCe(t,e){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},r,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(d){return function(g){return u([d,g])}}function u(d){if(r)throw new TypeError("Generator is already executing.");for(;n;)try{if(r=1,i&&(o=d[0]&2?i.return:d[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,d[1])).done)return o;switch(i=0,o&&(d=[d[0]&2,o.value]),d[0]){case 0:case 1:o=d;break;case 4:return n.label++,{value:d[1],done:!1};case 5:n.label++,i=d[1],d=[0];continue;case 7:d=n.ops.pop(),n.trys.pop();continue;default:if(o=n.trys,!(o=o.length>0&&o[o.length-1])&&(d[0]===6||d[0]===2)){n=0;continue}if(d[0]===3&&(!o||d[1]>o[0]&&d[1]<o[3])){n.label=d[1];break}if(d[0]===6&&n.label<o[1]){n.label=o[1],o=d;break}if(o&&n.label<o[2]){n.label=o[2],n.ops.push(d);break}o[2]&&n.ops.pop(),n.trys.pop();continue}d=e.call(t,n)}catch(g){d=[6,g],i=0}finally{r=o=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var Jm=function(){function t(e,n){this.next=null,this.key=e,this.data=n,this.left=null,this.right=null}return t}();function qCe(t,e){return t>e?1:t<e?-1:0}function Tm(t,e,n){for(var r=new Jm(null,null),i=r,o=r;;){var a=n(t,e.key);if(a<0){if(e.left===null)break;if(n(t,e.left.key)<0){var s=e.left;if(e.left=s.right,s.right=e,e=s,e.left===null)break}o.left=e,o=e,e=e.left}else if(a>0){if(e.right===null)break;if(n(t,e.right.key)>0){var s=e.right;if(e.right=s.left,s.left=e,e=s,e.right===null)break}i.right=e,i=e,e=e.right}else break}return i.right=e.left,o.left=e.right,e.left=r.right,e.right=r.left,e}function hB(t,e,n,r){var i=new Jm(t,e);if(n===null)return i.left=i.right=null,i;n=Tm(t,n,r);var o=r(t,n.key);return o<0?(i.left=n.left,i.right=n,n.left=null):o>=0&&(i.right=n.right,i.left=n,n.right=null),i}function bH(t,e,n){var r=null,i=null;if(e){e=Tm(t,e,n);var o=n(e.key,t);o===0?(r=e.left,i=e.right):o<0?(i=e.right,e.right=null,r=e):(r=e.left,e.left=null,i=e)}return{left:r,right:i}}function XCe(t,e,n){return e===null?t:(t===null||(e=Tm(t.key,e,n),e.left=t),e)}function rk(t,e,n,r,i){if(t){r(""+e+(n?" ":" ")+i(t)+`
`);var o=e+(n?"    ":"   ");t.left&&rk(t.left,o,!1,r,i),t.right&&rk(t.right,o,!0,r,i)}}var o6=function(){function t(e){e===void 0&&(e=qCe),this._root=null,this._size=0,this._comparator=e}return t.prototype.insert=function(e,n){return this._size++,this._root=hB(e,n,this._root,this._comparator)},t.prototype.add=function(e,n){var r=new Jm(e,n);this._root===null&&(r.left=r.right=null,this._size++,this._root=r);var i=this._comparator,o=Tm(e,this._root,i),a=i(e,o.key);return a===0?this._root=o:(a<0?(r.left=o.left,r.right=o,o.left=null):a>0&&(r.right=o.right,r.left=o,o.right=null),this._size++,this._root=r),this._root},t.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},t.prototype._remove=function(e,n,r){var i;if(n===null)return null;n=Tm(e,n,r);var o=r(e,n.key);return o===0?(n.left===null?i=n.right:(i=Tm(e,n.left,r),i.right=n.right),this._size--,i):n},t.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=Tm(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},t.prototype.findStatic=function(e){for(var n=this._root,r=this._comparator;n;){var i=r(e,n.key);if(i===0)return n;i<0?n=n.left:n=n.right}return null},t.prototype.find=function(e){return this._root&&(this._root=Tm(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},t.prototype.contains=function(e){for(var n=this._root,r=this._comparator;n;){var i=r(e,n.key);if(i===0)return!0;i<0?n=n.left:n=n.right}return!1},t.prototype.forEach=function(e,n){for(var r=this._root,i=[],o=!1;!o;)r!==null?(i.push(r),r=r.left):i.length!==0?(r=i.pop(),e.call(n,r),r=r.right):o=!0;return this},t.prototype.range=function(e,n,r,i){for(var o=[],a=this._comparator,s=this._root,u;o.length!==0||s;)if(s)o.push(s),s=s.left;else{if(s=o.pop(),u=a(s.key,n),u>0)break;if(a(s.key,e)>=0&&r.call(i,s))return this;s=s.right}return this},t.prototype.keys=function(){var e=[];return this.forEach(function(n){var r=n.key;return e.push(r)}),e},t.prototype.values=function(){var e=[];return this.forEach(function(n){var r=n.data;return e.push(r)}),e},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},t.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},t.prototype.at=function(e){for(var n=this._root,r=!1,i=0,o=[];!r;)if(n)o.push(n),n=n.left;else if(o.length>0){if(n=o.pop(),i===e)return n;i++,n=n.right}else r=!0;return null},t.prototype.next=function(e){var n=this._root,r=null;if(e.right){for(r=e.right;r.left;)r=r.left;return r}for(var i=this._comparator;n;){var o=i(e.key,n.key);if(o===0)break;o<0?(r=n,n=n.left):n=n.right}return r},t.prototype.prev=function(e){var n=this._root,r=null;if(e.left!==null){for(r=e.left;r.right;)r=r.right;return r}for(var i=this._comparator;n;){var o=i(e.key,n.key);if(o===0)break;o<0?n=n.left:(r=n,n=n.right)}return r},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return YCe(this._root)},t.prototype.load=function(e,n,r){n===void 0&&(n=[]),r===void 0&&(r=!1);var i=e.length,o=this._comparator;if(r&&sk(e,n,0,i-1,o),this._root===null)this._root=ik(e,n,0,i),this._size=i;else{var a=QCe(this.toList(),ZCe(e,n),o);i=this._size+i,this._root=ok({head:a},0,i)}return this},t.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){e===void 0&&(e=function(r){return String(r.key)});var n=[];return rk(this._root,"",!0,function(r){return n.push(r)},e),n.join("")},t.prototype.update=function(e,n,r){var i=this._comparator,o=bH(e,this._root,i),a=o.left,s=o.right;i(e,n)<0?s=hB(n,r,s,i):a=hB(n,r,a,i),this._root=XCe(a,s,i)},t.prototype.split=function(e){return bH(e,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var e,n,r;return WCe(this,function(i){switch(i.label){case 0:e=this._root,n=[],r=!1,i.label=1;case 1:return r?[3,6]:e===null?[3,2]:(n.push(e),e=e.left,[3,5]);case 2:return n.length===0?[3,4]:(e=n.pop(),[4,e]);case 3:return i.sent(),e=e.right,[3,5];case 4:r=!0,i.label=5;case 5:return[3,1];case 6:return[2]}})},t}();function ik(t,e,n,r){var i=r-n;if(i>0){var o=n+Math.floor(i/2),a=t[o],s=e[o],u=new Jm(a,s);return u.left=ik(t,e,n,o),u.right=ik(t,e,o+1,r),u}return null}function ZCe(t,e){for(var n=new Jm(null,null),r=n,i=0;i<t.length;i++)r=r.next=new Jm(t[i],e[i]);return r.next=null,n.next}function YCe(t){for(var e=t,n=[],r=!1,i=new Jm(null,null),o=i;!r;)e?(n.push(e),e=e.left):n.length>0?(e=o=o.next=n.pop(),e=e.right):r=!0;return o.next=null,i.next}function ok(t,e,n){var r=n-e;if(r>0){var i=e+Math.floor(r/2),o=ok(t,e,i),a=t.head;return a.left=o,t.head=t.head.next,a.right=ok(t,i+1,n),a}return null}function QCe(t,e,n){for(var r=new Jm(null,null),i=r,o=t,a=e;o!==null&&a!==null;)n(o.key,a.key)<0?(i.next=o,o=o.next):(i.next=a,a=a.next),i=i.next;return o!==null?i.next=o:a!==null&&(i.next=a),r.next}function sk(t,e,n,r,i){if(!(n>=r)){for(var o=t[n+r>>1],a=n-1,s=r+1;;){do a++;while(i(t[a],o)<0);do s--;while(i(t[s],o)>0);if(a>=s)break;var u=t[a];t[a]=t[s],t[s]=u,u=e[a],e[a]=e[s],e[s]=u}sk(t,e,n,s,i),sk(t,e,s+1,r,i)}}function Lf(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function wH(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Ql(t,e,n){return e&&wH(t.prototype,e),n&&wH(t,n),t}var gb=function(e,n){return e.ll.x<=n.x&&n.x<=e.ur.x&&e.ll.y<=n.y&&n.y<=e.ur.y},ak=function(e,n){if(n.ur.x<e.ll.x||e.ur.x<n.ll.x||n.ur.y<e.ll.y||e.ur.y<n.ll.y)return null;var r=e.ll.x<n.ll.x?n.ll.x:e.ll.x,i=e.ur.x<n.ur.x?e.ur.x:n.ur.x,o=e.ll.y<n.ll.y?n.ll.y:e.ll.y,a=e.ur.y<n.ur.y?e.ur.y:n.ur.y;return{ll:{x:r,y:o},ur:{x:i,y:a}}},Om=Number.EPSILON;Om===void 0&&(Om=Math.pow(2,-52));var KCe=Om*Om,lk=function(e,n){if(-Om<e&&e<Om&&-Om<n&&n<Om)return 0;var r=e-n;return r*r<KCe*e*n?0:e<n?-1:1},JCe=function(){function t(){Lf(this,t),this.reset()}return Ql(t,[{key:"reset",value:function(){this.xRounder=new EH,this.yRounder=new EH}},{key:"round",value:function(n,r){return{x:this.xRounder.round(n),y:this.yRounder.round(r)}}}]),t}(),EH=function(){function t(){Lf(this,t),this.tree=new o6,this.round(0)}return Ql(t,[{key:"round",value:function(n){var r=this.tree.add(n),i=this.tree.prev(r);if(i!==null&&lk(r.key,i.key)===0)return this.tree.remove(n),i.key;var o=this.tree.next(r);return o!==null&&lk(r.key,o.key)===0?(this.tree.remove(n),o.key):n}}]),t}(),Ww=new JCe,mw=function(e,n){return e.x*n.y-e.y*n.x},_re=function(e,n){return e.x*n.x+e.y*n.y},SH=function(e,n,r){var i={x:n.x-e.x,y:n.y-e.y},o={x:r.x-e.x,y:r.y-e.y},a=mw(i,o);return lk(a,0)},yI=function(e){return Math.sqrt(_re(e,e))},ePe=function(e,n,r){var i={x:n.x-e.x,y:n.y-e.y},o={x:r.x-e.x,y:r.y-e.y};return mw(o,i)/yI(o)/yI(i)},tPe=function(e,n,r){var i={x:n.x-e.x,y:n.y-e.y},o={x:r.x-e.x,y:r.y-e.y};return _re(o,i)/yI(o)/yI(i)},TH=function(e,n,r){return n.y===0?null:{x:e.x+n.x/n.y*(r-e.y),y:r}},CH=function(e,n,r){return n.x===0?null:{x:r,y:e.y+n.y/n.x*(r-e.x)}},nPe=function(e,n,r,i){if(n.x===0)return CH(r,i,e.x);if(i.x===0)return CH(e,n,r.x);if(n.y===0)return TH(r,i,e.y);if(i.y===0)return TH(e,n,r.y);var o=mw(n,i);if(o==0)return null;var a={x:r.x-e.x,y:r.y-e.y},s=mw(a,n)/o,u=mw(a,i)/o,d=e.x+u*n.x,g=r.x+s*i.x,_=e.y+u*n.y,E=r.y+s*i.y,P=(d+g)/2,O=(_+E)/2;return{x:P,y:O}},Ed=function(){Ql(t,null,[{key:"compare",value:function(n,r){var i=t.comparePoints(n.point,r.point);return i!==0?i:(n.point!==r.point&&n.link(r),n.isLeft!==r.isLeft?n.isLeft?1:-1:vI.compare(n.segment,r.segment))}},{key:"comparePoints",value:function(n,r){return n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0}}]);function t(e,n){Lf(this,t),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}return Ql(t,[{key:"link",value:function(n){if(n.point===this.point)throw new Error("Tried to link already linked events");for(var r=n.point.events,i=0,o=r.length;i<o;i++){var a=r[i];this.point.events.push(a),a.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var n=this.point.events.length,r=0;r<n;r++){var i=this.point.events[r];if(i.segment.consumedBy===void 0)for(var o=r+1;o<n;o++){var a=this.point.events[o];a.consumedBy===void 0&&i.otherSE.point.events===a.otherSE.point.events&&i.segment.consume(a.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var n=[],r=0,i=this.point.events.length;r<i;r++){var o=this.point.events[r];o!==this&&!o.segment.ringOut&&o.segment.isInResult()&&n.push(o)}return n}},{key:"getLeftmostComparator",value:function(n){var r=this,i=new Map,o=function(s){var u=s.otherSE;i.set(s,{sine:ePe(r.point,n.point,u.point),cosine:tPe(r.point,n.point,u.point)})};return function(a,s){i.has(a)||o(a),i.has(s)||o(s);var u=i.get(a),d=u.sine,g=u.cosine,_=i.get(s),E=_.sine,P=_.cosine;return d>=0&&E>=0?g<P?1:g>P?-1:0:d<0&&E<0?g<P?-1:g>P?1:0:E<d?-1:E>d?1:0}}}]),t}(),rPe=0,vI=function(){Ql(t,null,[{key:"compare",value:function(n,r){var i=n.leftSE.point.x,o=r.leftSE.point.x,a=n.rightSE.point.x,s=r.rightSE.point.x;if(s<i)return 1;if(a<o)return-1;var u=n.leftSE.point.y,d=r.leftSE.point.y,g=n.rightSE.point.y,_=r.rightSE.point.y;if(i<o){if(d<u&&d<g)return 1;if(d>u&&d>g)return-1;var E=n.comparePoint(r.leftSE.point);if(E<0)return 1;if(E>0)return-1;var P=r.comparePoint(n.rightSE.point);return P!==0?P:-1}if(i>o){if(u<d&&u<_)return-1;if(u>d&&u>_)return 1;var O=r.comparePoint(n.leftSE.point);if(O!==0)return O;var D=n.comparePoint(r.rightSE.point);return D<0?1:D>0?-1:1}if(u<d)return-1;if(u>d)return 1;if(a<s){var V=r.comparePoint(n.rightSE.point);if(V!==0)return V}if(a>s){var k=n.comparePoint(r.rightSE.point);if(k<0)return 1;if(k>0)return-1}if(a!==s){var F=g-u,z=a-i,X=_-d,Y=s-o;if(F>z&&X<Y)return 1;if(F<z&&X>Y)return-1}return a>s?1:a<s||g<_?-1:g>_?1:n.id<r.id?-1:n.id>r.id?1:0}}]);function t(e,n,r,i){Lf(this,t),this.id=++rPe,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=r,this.windings=i}return Ql(t,[{key:"replaceRightSE",value:function(n){this.rightSE=n,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var n=this.leftSE.point.y,r=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:n<r?n:r},ur:{x:this.rightSE.point.x,y:n>r?n:r}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(n){return n.x===this.leftSE.point.x&&n.y===this.leftSE.point.y||n.x===this.rightSE.point.x&&n.y===this.rightSE.point.y}},{key:"comparePoint",value:function(n){if(this.isAnEndpoint(n))return 0;var r=this.leftSE.point,i=this.rightSE.point,o=this.vector();if(r.x===i.x)return n.x===r.x?0:n.x<r.x?1:-1;var a=(n.y-r.y)/o.y,s=r.x+a*o.x;if(n.x===s)return 0;var u=(n.x-r.x)/o.x,d=r.y+u*o.y;return n.y===d?0:n.y<d?-1:1}},{key:"getIntersection",value:function(n){var r=this.bbox(),i=n.bbox(),o=ak(r,i);if(o===null)return null;var a=this.leftSE.point,s=this.rightSE.point,u=n.leftSE.point,d=n.rightSE.point,g=gb(r,u)&&this.comparePoint(u)===0,_=gb(i,a)&&n.comparePoint(a)===0,E=gb(r,d)&&this.comparePoint(d)===0,P=gb(i,s)&&n.comparePoint(s)===0;if(_&&g)return P&&!E?s:!P&&E?d:null;if(_)return E&&a.x===d.x&&a.y===d.y?null:a;if(g)return P&&s.x===u.x&&s.y===u.y?null:u;if(P&&E)return null;if(P)return s;if(E)return d;var O=nPe(a,this.vector(),u,n.vector());return O===null||!gb(o,O)?null:Ww.round(O.x,O.y)}},{key:"split",value:function(n){var r=[],i=n.events!==void 0,o=new Ed(n,!0),a=new Ed(n,!1),s=this.rightSE;this.replaceRightSE(a),r.push(a),r.push(o);var u=new t(o,s,this.rings.slice(),this.windings.slice());return Ed.comparePoints(u.leftSE.point,u.rightSE.point)>0&&u.swapEvents(),Ed.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(o.checkForConsuming(),a.checkForConsuming()),r}},{key:"swapEvents",value:function(){var n=this.rightSE;this.rightSE=this.leftSE,this.leftSE=n,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var r=0,i=this.windings.length;r<i;r++)this.windings[r]*=-1}},{key:"consume",value:function(n){for(var r=this,i=n;r.consumedBy;)r=r.consumedBy;for(;i.consumedBy;)i=i.consumedBy;var o=t.compare(r,i);if(o!==0){if(o>0){var a=r;r=i,i=a}if(r.prev===i){var s=r;r=i,i=s}for(var u=0,d=i.rings.length;u<d;u++){var g=i.rings[u],_=i.windings[u],E=r.rings.indexOf(g);E===-1?(r.rings.push(g),r.windings.push(_)):r.windings[E]+=_}i.rings=null,i.windings=null,i.consumedBy=r,i.leftSE.consumedBy=r.leftSE,i.rightSE.consumedBy=r.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var n=this.prev.consumedBy||this.prev;this._beforeState=n.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var n=this.beforeState();this._afterState={rings:n.rings.slice(0),windings:n.windings.slice(0),multiPolys:[]};for(var r=this._afterState.rings,i=this._afterState.windings,o=this._afterState.multiPolys,a=0,s=this.rings.length;a<s;a++){var u=this.rings[a],d=this.windings[a],g=r.indexOf(u);g===-1?(r.push(u),i.push(d)):i[g]+=d}for(var _=[],E=[],P=0,O=r.length;P<O;P++)if(i[P]!==0){var D=r[P],V=D.poly;if(E.indexOf(V)===-1)if(D.isExterior)_.push(V);else{E.indexOf(V)===-1&&E.push(V);var k=_.indexOf(D.poly);k!==-1&&_.splice(k,1)}}for(var F=0,z=_.length;F<z;F++){var X=_[F].multiPoly;o.indexOf(X)===-1&&o.push(X)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var n=this.beforeState().multiPolys,r=this.afterState().multiPolys;switch(ph.type){case"union":{var i=n.length===0,o=r.length===0;this._isInResult=i!==o;break}case"intersection":{var a,s;n.length<r.length?(a=n.length,s=r.length):(a=r.length,s=n.length),this._isInResult=s===ph.numMultiPolys&&a<s;break}case"xor":{var u=Math.abs(n.length-r.length);this._isInResult=u%2===1;break}case"difference":{var d=function(_){return _.length===1&&_[0].isSubject};this._isInResult=d(n)!==d(r);break}default:throw new Error("Unrecognized operation type found ".concat(ph.type))}return this._isInResult}}],[{key:"fromRing",value:function(n,r,i){var o,a,s,u=Ed.comparePoints(n,r);if(u<0)o=n,a=r,s=1;else if(u>0)o=r,a=n,s=-1;else throw new Error("Tried to create degenerate segment at [".concat(n.x,", ").concat(n.y,"]"));var d=new Ed(o,!0),g=new Ed(a,!1);return new t(d,g,[i],[s])}}]),t}(),PH=function(){function t(e,n,r){if(Lf(this,t),!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=r,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var i=Ww.round(e[0][0],e[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};for(var o=i,a=1,s=e.length;a<s;a++){if(typeof e[a][0]!="number"||typeof e[a][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var u=Ww.round(e[a][0],e[a][1]);u.x===o.x&&u.y===o.y||(this.segments.push(vI.fromRing(o,u,this)),u.x<this.bbox.ll.x&&(this.bbox.ll.x=u.x),u.y<this.bbox.ll.y&&(this.bbox.ll.y=u.y),u.x>this.bbox.ur.x&&(this.bbox.ur.x=u.x),u.y>this.bbox.ur.y&&(this.bbox.ur.y=u.y),o=u)}(i.x!==o.x||i.y!==o.y)&&this.segments.push(vI.fromRing(o,i,this))}return Ql(t,[{key:"getSweepEvents",value:function(){for(var n=[],r=0,i=this.segments.length;r<i;r++){var o=this.segments[r];n.push(o.leftSE),n.push(o.rightSE)}return n}}]),t}(),iPe=function(){function t(e,n){if(Lf(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new PH(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,i=e.length;r<i;r++){var o=new PH(e[r],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=n}return Ql(t,[{key:"getSweepEvents",value:function(){for(var n=this.exteriorRing.getSweepEvents(),r=0,i=this.interiorRings.length;r<i;r++)for(var o=this.interiorRings[r].getSweepEvents(),a=0,s=o.length;a<s;a++)n.push(o[a]);return n}}]),t}(),IH=function(){function t(e,n){if(Lf(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,i=e.length;r<i;r++){var o=new iPe(e[r],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=n}return Ql(t,[{key:"getSweepEvents",value:function(){for(var n=[],r=0,i=this.polys.length;r<i;r++)for(var o=this.polys[r].getSweepEvents(),a=0,s=o.length;a<s;a++)n.push(o[a]);return n}}]),t}(),oPe=function(){Ql(t,null,[{key:"factory",value:function(n){for(var r=[],i=0,o=n.length;i<o;i++){var a=n[i];if(!(!a.isInResult()||a.ringOut)){for(var s=null,u=a.leftSE,d=a.rightSE,g=[u],_=u.point,E=[];s=u,u=d,g.push(u),u.point!==_;)for(;;){var P=u.getAvailableLinkedEvents();if(P.length===0){var O=g[0].point,D=g[g.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(O.x,",")+" ".concat(O.y,"]. Last matching segment found ends at")+" [".concat(D.x,", ").concat(D.y,"]."))}if(P.length===1){d=P[0].otherSE;break}for(var V=null,k=0,F=E.length;k<F;k++)if(E[k].point===u.point){V=k;break}if(V!==null){var z=E.splice(V)[0],X=g.splice(z.index);X.unshift(X[0].otherSE),r.push(new t(X.reverse()));continue}E.push({index:g.length,point:u.point});var Y=u.getLeftmostComparator(s);d=P.sort(Y)[0].otherSE;break}r.push(new t(g))}}return r}}]);function t(e){Lf(this,t),this.events=e;for(var n=0,r=e.length;n<r;n++)e[n].segment.ringOut=this;this.poly=null}return Ql(t,[{key:"getGeom",value:function(){for(var n=this.events[0].point,r=[n],i=1,o=this.events.length-1;i<o;i++){var a=this.events[i].point,s=this.events[i+1].point;SH(a,n,s)!==0&&(r.push(a),n=a)}if(r.length===1)return null;var u=r[0],d=r[1];SH(u,n,d)===0&&r.shift(),r.push(r[0]);for(var g=this.isExteriorRing()?1:-1,_=this.isExteriorRing()?0:r.length-1,E=this.isExteriorRing()?r.length:-1,P=[],O=_;O!=E;O+=g)P.push([r[O].x,r[O].y]);return P}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var n=this.enclosingRing();this._isExteriorRing=n?!n.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var n=this.events[0],r=1,i=this.events.length;r<i;r++){var o=this.events[r];Ed.compare(n,o)>0&&(n=o)}for(var a=n.segment.prevInResult(),s=a?a.prevInResult():null;;){if(!a)return null;if(!s)return a.ringOut;if(s.ringOut!==a.ringOut)return s.ringOut.enclosingRing()!==a.ringOut?a.ringOut:a.ringOut.enclosingRing();a=s.prevInResult(),s=a?a.prevInResult():null}}}]),t}(),MH=function(){function t(e){Lf(this,t),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return Ql(t,[{key:"addInterior",value:function(n){this.interiorRings.push(n),n.poly=this}},{key:"getGeom",value:function(){var n=[this.exteriorRing.getGeom()];if(n[0]===null)return null;for(var r=0,i=this.interiorRings.length;r<i;r++){var o=this.interiorRings[r].getGeom();o!==null&&n.push(o)}return n}}]),t}(),sPe=function(){function t(e){Lf(this,t),this.rings=e,this.polys=this._composePolys(e)}return Ql(t,[{key:"getGeom",value:function(){for(var n=[],r=0,i=this.polys.length;r<i;r++){var o=this.polys[r].getGeom();o!==null&&n.push(o)}return n}},{key:"_composePolys",value:function(n){for(var r=[],i=0,o=n.length;i<o;i++){var a=n[i];if(!a.poly)if(a.isExteriorRing())r.push(new MH(a));else{var s=a.enclosingRing();s.poly||r.push(new MH(s)),s.poly.addInterior(a)}}return r}}]),t}(),aPe=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vI.compare;Lf(this,t),this.queue=e,this.tree=new o6(n),this.segments=[]}return Ql(t,[{key:"process",value:function(n){var r=n.segment,i=[];if(n.consumedBy)return n.isLeft?this.queue.remove(n.otherSE):this.tree.remove(r),i;var o=n.isLeft?this.tree.insert(r):this.tree.find(r);if(!o)throw new Error("Unable to find segment #".concat(r.id," ")+"[".concat(r.leftSE.point.x,", ").concat(r.leftSE.point.y,"] -> ")+"[".concat(r.rightSE.point.x,", ").concat(r.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var a=o,s=o,u=void 0,d=void 0;u===void 0;)a=this.tree.prev(a),a===null?u=null:a.key.consumedBy===void 0&&(u=a.key);for(;d===void 0;)s=this.tree.next(s),s===null?d=null:s.key.consumedBy===void 0&&(d=s.key);if(n.isLeft){var g=null;if(u){var _=u.getIntersection(r);if(_!==null&&(r.isAnEndpoint(_)||(g=_),!u.isAnEndpoint(_)))for(var E=this._splitSafely(u,_),P=0,O=E.length;P<O;P++)i.push(E[P])}var D=null;if(d){var V=d.getIntersection(r);if(V!==null&&(r.isAnEndpoint(V)||(D=V),!d.isAnEndpoint(V)))for(var k=this._splitSafely(d,V),F=0,z=k.length;F<z;F++)i.push(k[F])}if(g!==null||D!==null){var X=null;if(g===null)X=D;else if(D===null)X=g;else{var Y=Ed.comparePoints(g,D);X=Y<=0?g:D}this.queue.remove(r.rightSE),i.push(r.rightSE);for(var J=r.split(X),re=0,ue=J.length;re<ue;re++)i.push(J[re])}i.length>0?(this.tree.remove(r),i.push(n)):(this.segments.push(r),r.prev=u)}else{if(u&&d){var ie=u.getIntersection(d);if(ie!==null){if(!u.isAnEndpoint(ie))for(var ce=this._splitSafely(u,ie),se=0,me=ce.length;se<me;se++)i.push(ce[se]);if(!d.isAnEndpoint(ie))for(var Ce=this._splitSafely(d,ie),we=0,Ye=Ce.length;we<Ye;we++)i.push(Ce[we])}}this.tree.remove(r)}return i}},{key:"_splitSafely",value:function(n,r){this.tree.remove(n);var i=n.rightSE;this.queue.remove(i);var o=n.split(r);return o.push(i),n.consumedBy===void 0&&this.tree.insert(n),o}}]),t}(),OH=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,lPe=typeof process<"u"&&{}.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,uPe=function(){function t(){Lf(this,t)}return Ql(t,[{key:"run",value:function(n,r,i){ph.type=n,Ww.reset();for(var o=[new IH(r,!0)],a=0,s=i.length;a<s;a++)o.push(new IH(i[a],!1));if(ph.numMultiPolys=o.length,ph.type==="difference")for(var u=o[0],d=1;d<o.length;)ak(o[d].bbox,u.bbox)!==null?d++:o.splice(d,1);if(ph.type==="intersection"){for(var g=0,_=o.length;g<_;g++)for(var E=o[g],P=g+1,O=o.length;P<O;P++)if(ak(E.bbox,o[P].bbox)===null)return[]}for(var D=new o6(Ed.compare),V=0,k=o.length;V<k;V++)for(var F=o[V].getSweepEvents(),z=0,X=F.length;z<X;z++)if(D.insert(F[z]),D.size>OH)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var Y=new aPe(D),J=D.size,re=D.pop();re;){var ue=re.key;if(D.size===J){var ie=ue.segment;throw new Error("Unable to pop() ".concat(ue.isLeft?"left":"right"," SweepEvent ")+"[".concat(ue.point.x,", ").concat(ue.point.y,"] from segment #").concat(ie.id," ")+"[".concat(ie.leftSE.point.x,", ").concat(ie.leftSE.point.y,"] -> ")+"[".concat(ie.rightSE.point.x,", ").concat(ie.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(D.size>OH)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(Y.segments.length>lPe)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var ce=Y.process(ue),se=0,me=ce.length;se<me;se++){var Ce=ce[se];Ce.consumedBy===void 0&&D.insert(Ce)}J=D.size,re=D.pop()}Ww.reset();var we=oPe.factory(Y.segments),Ye=new sPe(we);return Ye.getGeom()}}]),t}(),ph=new uPe,cPe=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return ph.run("union",e,r)},fPe=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return ph.run("intersection",e,r)},hPe=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return ph.run("xor",e,r)},dPe=function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return ph.run("difference",e,r)},pPe={union:cPe,intersection:fPe,xor:hPe,difference:dPe};const s6=pPe;var na=63710088e-1,a6={centimeters:na*100,centimetres:na*100,degrees:na/111325,feet:na*3.28084,inches:na*39.37,kilometers:na/1e3,kilometres:na/1e3,meters:na,metres:na,miles:na/1609.344,millimeters:na*1e3,millimetres:na*1e3,nauticalmiles:na/1852,radians:1,yards:na*1.0936},gPe={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/na,yards:1.0936133},uk={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Kl(t,e,n){n===void 0&&(n={});var r={type:"Feature"};return(n.id===0||n.id)&&(r.id=n.id),n.bbox&&(r.bbox=n.bbox),r.properties=e||{},r.geometry=t,r}function mPe(t,e,n){switch(t){case"Point":return zo(e).geometry;case"LineString":return Su(e).geometry;case"Polygon":return Th(e).geometry;case"MultiPoint":return yre(e).geometry;case"MultiLineString":return l6(e).geometry;case"MultiPolygon":return HE(e).geometry;default:throw new Error(t+" is invalid")}}function zo(t,e,n){if(n===void 0&&(n={}),!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!eA(t[0])||!eA(t[1]))throw new Error("coordinates must contain numbers");var r={type:"Point",coordinates:t};return Kl(r,e,n)}function APe(t,e,n){return n===void 0&&(n={}),vf(t.map(function(r){return zo(r,e)}),n)}function Th(t,e,n){n===void 0&&(n={});for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:t};return Kl(s,e,n)}function _Pe(t,e,n){return n===void 0&&(n={}),vf(t.map(function(r){return Th(r,e)}),n)}function Su(t,e,n){if(n===void 0&&(n={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");var r={type:"LineString",coordinates:t};return Kl(r,e,n)}function yPe(t,e,n){return n===void 0&&(n={}),vf(t.map(function(r){return Su(r,e)}),n)}function vf(t,e){e===void 0&&(e={});var n={type:"FeatureCollection"};return e.id&&(n.id=e.id),e.bbox&&(n.bbox=e.bbox),n.features=t,n}function l6(t,e,n){n===void 0&&(n={});var r={type:"MultiLineString",coordinates:t};return Kl(r,e,n)}function yre(t,e,n){n===void 0&&(n={});var r={type:"MultiPoint",coordinates:t};return Kl(r,e,n)}function HE(t,e,n){n===void 0&&(n={});var r={type:"MultiPolygon",coordinates:t};return Kl(r,e,n)}function vPe(t,e,n){n===void 0&&(n={});var r={type:"GeometryCollection",geometries:t};return Kl(r,e,n)}function xPe(t,e){if(e===void 0&&(e=0),e&&!(e>=0))throw new Error("precision must be a positive number");var n=Math.pow(10,e||0);return Math.round(t*n)/n}function tR(t,e){e===void 0&&(e="kilometers");var n=a6[e];if(!n)throw new Error(e+" units is invalid");return t*n}function WE(t,e){e===void 0&&(e="kilometers");var n=a6[e];if(!n)throw new Error(e+" units is invalid");return t/n}function bPe(t,e){return Vv(WE(t,e))}function wPe(t){var e=t%360;return e<0&&(e+=360),e}function Vv(t){var e=t%(2*Math.PI);return e*180/Math.PI}function wa(t){var e=t%360;return e*Math.PI/180}function nR(t,e,n){if(e===void 0&&(e="kilometers"),n===void 0&&(n="kilometers"),!(t>=0))throw new Error("length must be a positive number");return tR(WE(t,e),n)}function EPe(t,e,n){if(e===void 0&&(e="meters"),n===void 0&&(n="kilometers"),!(t>=0))throw new Error("area must be a positive number");var r=uk[e];if(!r)throw new Error("invalid original units");var i=uk[n];if(!i)throw new Error("invalid final units");return t/r*i}function eA(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function d_(t){return!!t&&t.constructor===Object}function SPe(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(t.length!==4&&t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(e){if(!eA(e))throw new Error("bbox must only contain numbers")})}function TPe(t){if(!t)throw new Error("id is required");if(["string","number"].indexOf(typeof t)===-1)throw new Error("id must be a number or a string")}const CPe=Object.freeze(Object.defineProperty({__proto__:null,areaFactors:uk,bearingToAzimuth:wPe,convertArea:EPe,convertLength:nR,degreesToRadians:wa,earthRadius:na,factors:a6,feature:Kl,featureCollection:vf,geometry:mPe,geometryCollection:vPe,isNumber:eA,isObject:d_,lengthToDegrees:bPe,lengthToRadians:WE,lineString:Su,lineStrings:yPe,multiLineString:l6,multiPoint:yre,multiPolygon:HE,point:zo,points:APe,polygon:Th,polygons:_Pe,radiansToDegrees:Vv,radiansToLength:tR,round:xPe,unitsFactors:gPe,validateBBox:SPe,validateId:TPe},Symbol.toStringTag,{value:"Module"}));function Ea(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if(t.type==="Feature"&&t.geometry!==null&&t.geometry.type==="Point")return t.geometry.coordinates;if(t.type==="Point")return t.coordinates}if(Array.isArray(t)&&t.length>=2&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function jd(t){if(Array.isArray(t))return t;if(t.type==="Feature"){if(t.geometry!==null)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function vre(t){if(t.length>1&&eA(t[0])&&eA(t[1]))return!0;if(Array.isArray(t[0])&&t[0].length)return vre(t[0]);throw new Error("coordinates must only contain numbers")}function PPe(t,e,n){if(!e||!n)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.type)}function ck(t,e,n){if(!t)throw new Error("No feature passed");if(!n)throw new Error(".featureOf() requires a name");if(!t||t.type!=="Feature"||!t.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+t.geometry.type)}function IPe(t,e,n){if(!t)throw new Error("No featureCollection passed");if(!n)throw new Error(".collectionOf() requires a name");if(!t||t.type!=="FeatureCollection")throw new Error("Invalid input to "+n+", FeatureCollection required");for(var r=0,i=t.features;r<i.length;r++){var o=i[r];if(!o||o.type!=="Feature"||!o.geometry)throw new Error("Invalid input to "+n+", Feature with geometry required");if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to "+n+": must be a "+e+", given "+o.geometry.type)}}function xf(t){return t.type==="Feature"?t.geometry:t}function xre(t,e){return t.type==="FeatureCollection"?"FeatureCollection":t.type==="GeometryCollection"?"GeometryCollection":t.type==="Feature"&&t.geometry!==null?t.geometry.type:t.type}const MPe=Object.freeze(Object.defineProperty({__proto__:null,collectionOf:IPe,containsNumber:vre,featureOf:ck,geojsonType:PPe,getCoord:Ea,getCoords:jd,getGeom:xf,getType:xre},Symbol.toStringTag,{value:"Module"}));function OPe(t,e,n){n===void 0&&(n={});var r=xf(t),i=xf(e),o=s6.union(r.coordinates,i.coordinates);return o.length===0?null:o.length===1?Th(o[0],n.properties):HE(o,n.properties)}const RPe=Object.freeze(Object.defineProperty({__proto__:null,default:OPe},Symbol.toStringTag,{value:"Module"})),LPe=ti(RPe);function DPe(t,e){var n=xf(t),r=xf(e),i=t.properties||{},o=s6.difference(n.coordinates,r.coordinates);return o.length===0?null:o.length===1?Th(o[0],i):HE(o,i)}const BPe=Object.freeze(Object.defineProperty({__proto__:null,default:DPe},Symbol.toStringTag,{value:"Module"})),u6=ti(BPe);function NPe(t,e,n){n===void 0&&(n={});var r=xf(t),i=xf(e),o=s6.intersection(r.coordinates,i.coordinates);return o.length===0?null:o.length===1?Th(o[0],n.properties):HE(o,n.properties)}const FPe=Object.freeze(Object.defineProperty({__proto__:null,default:NPe},Symbol.toStringTag,{value:"Module"})),kPe=ti(FPe);function zPe(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return bre(t);case"FeatureCollection":return UPe(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return c6(t);default:throw new Error("unknown GeoJSON type")}}function bre(t){var e={type:"Feature"};return Object.keys(t).forEach(function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}}),e.properties=wre(t.properties),e.geometry=c6(t.geometry),e}function wre(t){var e={};return t&&Object.keys(t).forEach(function(n){var r=t[n];typeof r=="object"?r===null?e[n]=null:r.length?e[n]=r.map(function(i){return i}):e[n]=wre(r):e[n]=r}),e}function UPe(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach(function(n){switch(n){case"type":case"features":return;default:e[n]=t[n]}}),e.features=t.features.map(function(n){return bre(n)}),e}function c6(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),t.type==="GeometryCollection"?(e.geometries=t.geometries.map(function(n){return c6(n)}),e):(e.coordinates=Ere(t.coordinates),e)}function Ere(t){return typeof t[0]!="object"?t.slice():t.map(function(e){return Ere(e)})}function GPe(t){if(!t)throw new Error("coords is required");if(t.type==="Feature"&&t.geometry!==null)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function fk(t){if(!t)throw new Error("line is required");var e=t.geometry?t.geometry.type:t.type;if(!Array.isArray(t)&&e!=="LineString")throw new Error("geometry must be a LineString");for(var n=GPe(t),r=0,i=1,o,a;i<n.length;)o=a||n[0],a=n[i],r+=(a[0]-o[0])*(a[1]+o[1]),i++;return r>0}function jPe(t,e){if(e=e||{},!Sre(e))throw new Error("options is invalid");var n=e.bbox,r=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");n&&$Pe(n),r&&HPe(r);var i={type:"FeatureCollection"};return r&&(i.id=r),n&&(i.bbox=n),i.features=t,i}function VPe(t){return!isNaN(t)&&t!==null&&!Array.isArray(t)}function Sre(t){return!!t&&t.constructor===Object}function $Pe(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(t.length!==4&&t.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(e){if(!VPe(e))throw new Error("bbox must only contain numbers")})}function HPe(t){if(!t)throw new Error("id is required");if(["string","number"].indexOf(typeof t)===-1)throw new Error("id must be a number or a string")}function RH(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var n=0;n<t.features.length&&e(t.features[n],n)!==!1;n++);}function Tre(t,e){var n,r,i,o,a,s,u,d,g,_,E=0,P=t.type==="FeatureCollection",O=t.type==="Feature",D=P?t.features.length:1;for(n=0;n<D;n++){for(s=P?t.features[n].geometry:O?t.geometry:t,d=P?t.features[n].properties:O?t.properties:{},g=P?t.features[n].bbox:O?t.bbox:void 0,_=P?t.features[n].id:O?t.id:void 0,u=s?s.type==="GeometryCollection":!1,a=u?s.geometries.length:1,i=0;i<a;i++){if(o=u?s.geometries[i]:s,o===null){if(e(null,E,d,g,_)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(o,E,d,g,_)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<o.geometries.length;r++)if(e(o.geometries[r],E,d,g,_)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}E++}}function GS(t){if(!t)throw new Error("coords is required");if(t.type==="Feature"&&t.geometry!==null)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function WPe(t,e){if(e=e||{},!Sre(e))throw new Error("options is invalid");var n=e.reverse||!1,r=e.mutate||!1;if(!t)throw new Error("<geojson> is required");if(typeof n!="boolean")throw new Error("<reverse> must be a boolean");if(typeof r!="boolean")throw new Error("<mutate> must be a boolean");r===!1&&(t=zPe(t));var i=[];switch(t.type){case"GeometryCollection":return Tre(t,function(o){yC(o,n)}),t;case"FeatureCollection":return RH(t,function(o){RH(yC(o,n),function(a){i.push(a)})}),jPe(i)}return yC(t,n)}function yC(t,e){var n=t.type==="Feature"?t.geometry.type:t.type;switch(n){case"GeometryCollection":return Tre(t,function(r){yC(r,e)}),t;case"LineString":return LH(GS(t),e),t;case"Polygon":return DH(GS(t),e),t;case"MultiLineString":return GS(t).forEach(function(r){LH(r,e)}),t;case"MultiPolygon":return GS(t).forEach(function(r){DH(r,e)}),t;case"Point":case"MultiPoint":return t}}function LH(t,e){fk(t)===e&&t.reverse()}function DH(t,e){fk(t[0])!==e&&t[0].reverse();for(var n=1;n<t.length;n++)fk(t[n])===e&&t[n].reverse()}const qPe=Object.freeze(Object.defineProperty({__proto__:null,default:WPe},Symbol.toStringTag,{value:"Module"})),XPe=ti(qPe);var Ai={};function $v(t,e,n,r){r===void 0&&(r={});var i=Ea(t),o=wa(i[0]),a=wa(i[1]),s=wa(n),u=WE(e,r.units),d=Math.asin(Math.sin(a)*Math.cos(u)+Math.cos(a)*Math.sin(u)*Math.cos(s)),g=o+Math.atan2(Math.sin(s)*Math.sin(u)*Math.cos(a),Math.cos(u)-Math.sin(a)*Math.sin(d)),_=Vv(g),E=Vv(d);return zo([_,E],r.properties)}const ZPe=Object.freeze(Object.defineProperty({__proto__:null,default:$v},Symbol.toStringTag,{value:"Module"})),rR=ti(ZPe);function qE(t,e,n){if(n===void 0&&(n={}),n.final===!0)return YPe(t,e);var r=Ea(t),i=Ea(e),o=wa(r[0]),a=wa(i[0]),s=wa(r[1]),u=wa(i[1]),d=Math.sin(a-o)*Math.cos(u),g=Math.cos(s)*Math.sin(u)-Math.sin(s)*Math.cos(u)*Math.cos(a-o);return Vv(Math.atan2(d,g))}function YPe(t,e){var n=qE(e,t);return n=(n+180)%360,n}const QPe=Object.freeze(Object.defineProperty({__proto__:null,default:qE},Symbol.toStringTag,{value:"Module"})),Kd=ti(QPe);function ch(t,e,n){n===void 0&&(n={});var r=Ea(t),i=Ea(e),o=wa(i[1]-r[1]),a=wa(i[0]-r[0]),s=wa(r[1]),u=wa(i[1]),d=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(a/2),2)*Math.cos(s)*Math.cos(u);return tR(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)),n.units)}const KPe=Object.freeze(Object.defineProperty({__proto__:null,default:ch},Symbol.toStringTag,{value:"Module"}));function Jd(t,e,n){if(t!==null)for(var r,i,o,a,s,u,d,g=0,_=0,E,P=t.type,O=P==="FeatureCollection",D=P==="Feature",V=O?t.features.length:1,k=0;k<V;k++){d=O?t.features[k].geometry:D?t.geometry:t,E=d?d.type==="GeometryCollection":!1,s=E?d.geometries.length:1;for(var F=0;F<s;F++){var z=0,X=0;if(a=E?d.geometries[F]:d,a!==null){u=a.coordinates;var Y=a.type;switch(g=n&&(Y==="Polygon"||Y==="MultiPolygon")?1:0,Y){case null:break;case"Point":if(e(u,_,k,z,X)===!1)return!1;_++,z++;break;case"LineString":case"MultiPoint":for(r=0;r<u.length;r++){if(e(u[r],_,k,z,X)===!1)return!1;_++,Y==="MultiPoint"&&z++}Y==="LineString"&&z++;break;case"Polygon":case"MultiLineString":for(r=0;r<u.length;r++){for(i=0;i<u[r].length-g;i++){if(e(u[r][i],_,k,z,X)===!1)return!1;_++}Y==="MultiLineString"&&z++,Y==="Polygon"&&X++}Y==="Polygon"&&z++;break;case"MultiPolygon":for(r=0;r<u.length;r++){for(X=0,i=0;i<u[r].length;i++){for(o=0;o<u[r][i].length-g;o++){if(e(u[r][i][o],_,k,z,X)===!1)return!1;_++}X++}z++}break;case"GeometryCollection":for(r=0;r<a.geometries.length;r++)if(Jd(a.geometries[r],e,n)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function JPe(t,e,n,r){var i=n;return Jd(t,function(o,a,s,u,d){a===0&&n===void 0?i=o:i=e(i,o,a,s,u,d)},r),i}function Cre(t,e){var n;switch(t.type){case"FeatureCollection":for(n=0;n<t.features.length&&e(t.features[n].properties,n)!==!1;n++);break;case"Feature":e(t.properties,0);break}}function eIe(t,e,n){var r=n;return Cre(t,function(i,o){o===0&&n===void 0?r=i:r=e(r,i,o)}),r}function G0(t,e){if(t.type==="Feature")e(t,0);else if(t.type==="FeatureCollection")for(var n=0;n<t.features.length&&e(t.features[n],n)!==!1;n++);}function tIe(t,e,n){var r=n;return G0(t,function(i,o){o===0&&n===void 0?r=i:r=e(r,i,o)}),r}function nIe(t){var e=[];return Jd(t,function(n){e.push(n)}),e}function XE(t,e){var n,r,i,o,a,s,u,d,g,_,E=0,P=t.type==="FeatureCollection",O=t.type==="Feature",D=P?t.features.length:1;for(n=0;n<D;n++){for(s=P?t.features[n].geometry:O?t.geometry:t,d=P?t.features[n].properties:O?t.properties:{},g=P?t.features[n].bbox:O?t.bbox:void 0,_=P?t.features[n].id:O?t.id:void 0,u=s?s.type==="GeometryCollection":!1,a=u?s.geometries.length:1,i=0;i<a;i++){if(o=u?s.geometries[i]:s,o===null){if(e(null,E,d,g,_)===!1)return!1;continue}switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(o,E,d,g,_)===!1)return!1;break}case"GeometryCollection":{for(r=0;r<o.geometries.length;r++)if(e(o.geometries[r],E,d,g,_)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}E++}}function Pre(t,e,n){var r=n;return XE(t,function(i,o,a,s,u){o===0&&n===void 0?r=i:r=e(r,i,o,a,s,u)}),r}function Vd(t,e){XE(t,function(n,r,i,o,a){var s=n===null?null:n.type;switch(s){case null:case"Point":case"LineString":case"Polygon":return e(Kl(n,i,{bbox:o,id:a}),r,0)===!1?!1:void 0}var u;switch(s){case"MultiPoint":u="Point";break;case"MultiLineString":u="LineString";break;case"MultiPolygon":u="Polygon";break}for(var d=0;d<n.coordinates.length;d++){var g=n.coordinates[d],_={type:u,coordinates:g};if(e(Kl(_,i),r,d)===!1)return!1}})}function rIe(t,e,n){var r=n;return Vd(t,function(i,o,a){o===0&&a===0&&n===void 0?r=i:r=e(r,i,o,a)}),r}function f6(t,e){Vd(t,function(n,r,i){var o=0;if(n.geometry){var a=n.geometry.type;if(!(a==="Point"||a==="MultiPoint")){var s,u=0,d=0,g=0;if(Jd(n,function(_,E,P,O,D){if(s===void 0||r>u||O>d||D>g){s=_,u=r,d=O,g=D,o=0;return}var V=Su([s,_],n.properties);if(e(V,r,i,D,o)===!1)return!1;o++,s=_})===!1)return!1}}})}function iIe(t,e,n){var r=n,i=!1;return f6(t,function(o,a,s,u,d){i===!1&&n===void 0?r=o:r=e(r,o,a,s,u,d),i=!0}),r}function Ire(t,e){if(!t)throw new Error("geojson is required");Vd(t,function(n,r,i){if(n.geometry!==null){var o=n.geometry.type,a=n.geometry.coordinates;switch(o){case"LineString":if(e(n,r,i,0,0)===!1)return!1;break;case"Polygon":for(var s=0;s<a.length;s++)if(e(Su(a[s],n.properties),r,i,s)===!1)return!1;break}}})}function oIe(t,e,n){var r=n;return Ire(t,function(i,o,a,s){o===0&&n===void 0?r=i:r=e(r,i,o,a,s)}),r}function sIe(t,e){if(e=e||{},!d_(e))throw new Error("options is invalid");var n=e.featureIndex||0,r=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.segmentIndex||0,a=e.properties,s;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),a=a||t.features[n].properties,s=t.features[n].geometry;break;case"Feature":a=a||t.properties,s=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=t;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var u=s.coordinates;switch(s.type){case"Point":case"MultiPoint":return null;case"LineString":return o<0&&(o=u.length+o-1),Su([u[o],u[o+1]],a,e);case"Polygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o-1),Su([u[i][o],u[i][o+1]],a,e);case"MultiLineString":return r<0&&(r=u.length+r),o<0&&(o=u[r].length+o-1),Su([u[r][o],u[r][o+1]],a,e);case"MultiPolygon":return r<0&&(r=u.length+r),i<0&&(i=u[r].length+i),o<0&&(o=u[r][i].length-o-1),Su([u[r][i][o],u[r][i][o+1]],a,e)}throw new Error("geojson is invalid")}function aIe(t,e){if(e=e||{},!d_(e))throw new Error("options is invalid");var n=e.featureIndex||0,r=e.multiFeatureIndex||0,i=e.geometryIndex||0,o=e.coordIndex||0,a=e.properties,s;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),a=a||t.features[n].properties,s=t.features[n].geometry;break;case"Feature":a=a||t.properties,s=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":s=t;break;default:throw new Error("geojson is invalid")}if(s===null)return null;var u=s.coordinates;switch(s.type){case"Point":return zo(u,a,e);case"MultiPoint":return r<0&&(r=u.length+r),zo(u[r],a,e);case"LineString":return o<0&&(o=u.length+o),zo(u[o],a,e);case"Polygon":return i<0&&(i=u.length+i),o<0&&(o=u[i].length+o),zo(u[i][o],a,e);case"MultiLineString":return r<0&&(r=u.length+r),o<0&&(o=u[r].length+o),zo(u[r][o],a,e);case"MultiPolygon":return r<0&&(r=u.length+r),i<0&&(i=u[r].length+i),o<0&&(o=u[r][i].length-o),zo(u[r][i][o],a,e)}throw new Error("geojson is invalid")}const lIe=Object.freeze(Object.defineProperty({__proto__:null,coordAll:nIe,coordEach:Jd,coordReduce:JPe,featureEach:G0,featureReduce:tIe,findPoint:aIe,findSegment:sIe,flattenEach:Vd,flattenReduce:rIe,geomEach:XE,geomReduce:Pre,lineEach:Ire,lineReduce:oIe,propEach:Cre,propReduce:eIe,segmentEach:f6,segmentReduce:iIe},Symbol.toStringTag,{value:"Module"}));function h6(t,e,n){n===void 0&&(n={});var r=Ea(t),i=Ea(e);i[0]+=i[0]-r[0]>180?-360:r[0]-i[0]>180?360:0;var o=uIe(r,i),a=nR(o,"meters",n.units);return a}function uIe(t,e,n){n=n===void 0?na:Number(n);var r=n,i=t[1]*Math.PI/180,o=e[1]*Math.PI/180,a=o-i,s=Math.abs(e[0]-t[0])*Math.PI/180;s>Math.PI&&(s-=2*Math.PI);var u=Math.log(Math.tan(o/2+Math.PI/4)/Math.tan(i/2+Math.PI/4)),d=Math.abs(u)>1e-11?a/u:Math.cos(i),g=Math.sqrt(a*a+d*d*s*s),_=g*r;return _}function cIe(t,e,n){if(n===void 0&&(n={}),n.method||(n.method="geodesic"),n.units||(n.units="kilometers"),!t)throw new Error("pt is required");if(Array.isArray(t)?t=zo(t):t.type==="Point"?t=Kl(t):ck(t,"Point","point"),!e)throw new Error("line is required");Array.isArray(e)?e=Su(e):e.type==="LineString"?e=Kl(e):ck(e,"LineString","line");var r=1/0,i=t.geometry.coordinates;return f6(e,function(o){var a=o.geometry.coordinates[0],s=o.geometry.coordinates[1],u=fIe(i,a,s,n);u<r&&(r=u)}),nR(r,"degrees",n.units)}function fIe(t,e,n,r){var i=[n[0]-e[0],n[1]-e[1]],o=[t[0]-e[0],t[1]-e[1]],a=BH(o,i);if(a<=0)return dB(t,e,{method:r.method,units:"degrees"});var s=BH(i,i);if(s<=a)return dB(t,n,{method:r.method,units:"degrees"});var u=a/s,d=[e[0]+u*i[0],e[1]+u*i[1]];return dB(t,d,{method:r.method,units:"degrees"})}function BH(t,e){return t[0]*e[0]+t[1]*e[1]}function dB(t,e,n){return n.method==="planar"?h6(t,e,n):ch(t,e,n)}const hIe=Object.freeze(Object.defineProperty({__proto__:null,default:cIe},Symbol.toStringTag,{value:"Module"})),Mre=ti(hIe),iR=ti(lIe),rl=ti(CPe),d6=ti(MPe),dIe=Object.freeze(Object.defineProperty({__proto__:null,MAX_LATITUDE:Yb,WebMercatorViewport:V$,addMetersToLngLat:G5,altitudeToFovy:k0,default:V$,fitBounds:$5,flyToViewport:Sne,fovyToAltitude:UE,getBounds:H5,getDistanceScales:Hw,getFlyToDuration:Tne,getMeterZoom:U5,getProjectionMatrix:xne,getProjectionParameters:V5,getViewMatrix:j5,lngLatToWorld:El,normalizeViewportProps:bne,pixelsToWorld:Km,scaleToZoom:z5,unitsPerMeter:pC,worldToLngLat:gc,worldToPixels:YO,zoomToScale:fI},Symbol.toStringTag,{value:"Module"})),p6=ti(dIe);Object.defineProperty(Ai,"__esModule",{value:!0});Ai.toDeckColor=wIe;Ai.recursivelyTraverseNestedArrays=Lre;Ai.generatePointsParallelToLinePoints=EIe;Ai.distance2d=pk;Ai.mix=Dre;Ai.nearestPointOnProjectedLine=SIe;Ai.nearestPointOnLine=TIe;Ai.getPickedEditHandle=CIe;Ai.getPickedSnapSourceEditHandle=PIe;Ai.getNonGuidePicks=IIe;Ai.getPickedExistingEditHandle=MIe;Ai.getPickedIntermediateEditHandle=OIe;Ai.getPickedEditHandles=ZE;Ai.getEditHandlesForGeometry=RIe;Ai.updateRectanglePosition=LIe;Ai.mapCoords=Bre;var NH=oR(rR),pIe=oR(Kd),gIe=oR(Mre),mIe=iR,hk=rl,FH=d6,Ore=oR(p6);function oR(t){return t&&t.__esModule?t:{default:t}}function wy(t,e){return yIe(t)||_Ie(t,e)||Rre(t,e)||AIe()}function AIe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Ie(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,o=void 0;try{for(var a=t[Symbol.iterator](),s;!(r=(s=a.next()).done)&&(n.push(s.value),!(e&&n.length===e));r=!0);}catch(u){i=!0,o=u}finally{try{!r&&a.return!=null&&a.return()}finally{if(i)throw o}}return n}}function yIe(t){if(Array.isArray(t))return t}function g6(t){return bIe(t)||xIe(t)||Rre(t)||vIe()}function vIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Rre(t,e){if(t){if(typeof t=="string")return dk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dk(t,e)}}function xIe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function bIe(t){if(Array.isArray(t))return dk(t)}function dk(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function wIe(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[255,0,0,255];return Array.isArray(t)?[t[0]*255,t[1]*255,t[2]*255,t[3]*255]:e}function Lre(t,e,n){if(!Array.isArray(t[0]))return!0;for(var r=0;r<t.length;r++)if(Lre(t[r],[].concat(g6(e),[r]),n)){n(t,e);break}return!1}function EIe(t,e,n){var r={type:"LineString",coordinates:[t,e]},i=(0,hk.point)(n),o=(0,gIe.default)(i,r),a=(0,pIe.default)(t,e),s=(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0]),u=s<0?a-90:a-270,d=(0,NH.default)(e,o,u),g=(0,NH.default)(t,o,u);return[d.geometry.coordinates,g.geometry.coordinates]}function pk(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function Dre(t,e,n){return e*n+t*(1-n)}function SIe(t,e,n){var r=new Ore.default(n),i=t.geometry.coordinates,o=i.map(function(we){var Ye=wy(we,3),at=Ye[0],yt=Ye[1],be=Ye[2],De=be===void 0?0:be;return r.project([at,yt,De])}),a=r.project(e.geometry.coordinates),s=wy(a,2),u=s[0],d=s[1],g=1/0,_={};o.forEach(function(we,Ye){var at=wy(we,2),yt=at[0],be=at[1];if(Ye!==0){var De=wy(o[Ye-1],2),Re=De[0],qe=De[1],ct=qe-be,Ct=yt-Re,Dt=Re*be-yt*qe,In=ct*ct+Ct*Ct,Mn=Math.abs(ct*u+Ct*d+Dt)/Math.sqrt(In);Mn<g&&(g=Mn,_={index:Ye,x0:(Ct*(Ct*u-ct*d)-ct*Dt)/In,y0:(ct*(-Ct*u+ct*d)-Ct*Dt)/In})}});var E=_,P=E.index,O=E.x0,D=E.y0,V=wy(o[P-1],3),k=V[0],F=V[1],z=V[2],X=z===void 0?0:z,Y=wy(o[P],3),J=Y[0],re=Y[1],ue=Y[2],ie=ue===void 0?0:ue,ce=pk(k,F,J,re),se=pk(k,F,O,D),me=se/ce,Ce=Dre(X,ie,me);return{type:"Feature",geometry:{type:"Point",coordinates:r.unproject([O,D,Ce])},properties:{dist:g,index:P-1}}}function TIe(t,e,n){var r,i,o;n&&(o=new Ore.default(n));var a=(0,hk.point)([1/0,1/0],{dist:1/0});return!(!((r=t.geometry)===null||r===void 0)&&r.coordinates.length)||((i=t.geometry)===null||i===void 0?void 0:i.coordinates.length)<2||(0,mIe.flattenEach)(t,function(s){var u=(0,FH.getCoords)(s),d=(0,FH.getCoords)(e),g,_,E,P,O,D,V;if(u.length>1&&d.length){var k,F;o?(k=u.map(function(Ye){return o.project(Ye)}),F=o.project(d)):(k=u,F=d);for(var z=1;z<k.length;z++){if(k[z][0]!==k[z-1][0]){var X=(k[z][1]-k[z-1][1])/(k[z][0]-k[z-1][0]),Y=k[z][1]-X*k[z][0];V=Math.abs(X*F[0]+Y-F[1])/Math.sqrt(X*X+1)}else V=Math.abs(F[0]-k[z][0]);var J=Math.pow(k[z][1]-k[z-1][1],2)+Math.pow(k[z][0]-k[z-1][0],2),re=Math.pow(k[z][1]-F[1],2)+Math.pow(k[z][0]-F[0],2),ue=Math.pow(k[z-1][1]-F[1],2)+Math.pow(k[z-1][0]-F[0],2),ie=Math.pow(V,2),ce=re-ie+ue-ie;ce>J&&(V=Math.sqrt(Math.min(re,ue))),(g==null||g>V)&&(ce>J?ue<re?(_=0,E=1):(E=0,_=1):(_=Math.sqrt(ue-ie)/Math.sqrt(J),E=Math.sqrt(re-ie)/Math.sqrt(J)),g=V,D=z)}var se=k[D-1][0]-k[D][0],me=k[D-1][1]-k[D][1];P=k[D-1][0]-se*_,O=k[D-1][1]-me*_}var Ce={x:P,y:O,idx:D-1,to:_,from:E};if(o){var we=o.unproject([Ce.x,Ce.y]);Ce={x:we[0],y:we[1],idx:D-1,to:_,from:E}}a=(0,hk.point)([Ce.x,Ce.y],{dist:Math.abs(Ce.from-Ce.to),index:Ce.idx})}),a}function CIe(t){var e=ZE(t);return e.length?e[0]:null}function PIe(t){var e=ZE(t);return e.find(function(n){return n.properties.editHandleType==="snap-source"})}function IIe(t){return t&&t.filter(function(e){return!e.isGuide})}function MIe(t){var e=ZE(t);return e.find(function(n){var r=n.properties;return r.featureIndex>=0&&r.editHandleType==="existing"})}function OIe(t){var e=ZE(t);return e.find(function(n){var r=n.properties;return r.featureIndex>=0&&r.editHandleType==="intermediate"})}function ZE(t){var e=t&&t.filter(function(n){return n.isGuide&&n.object.properties.guideType==="editHandle"}).map(function(n){return n.object})||[];return e}function RIe(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"existing",r=[];switch(t.type){case"Point":r=[{type:"Feature",properties:{guideType:"editHandle",editHandleType:n,positionIndexes:[],featureIndex:e},geometry:{type:"Point",coordinates:t.coordinates}}];break;case"MultiPoint":case"LineString":r=r.concat(pB(t.coordinates,[],e,n));break;case"Polygon":case"MultiLineString":for(var i=0;i<t.coordinates.length;i++)r=r.concat(pB(t.coordinates[i],[i],e,n)),t.type==="Polygon"&&(r=r.slice(0,-1));break;case"MultiPolygon":for(var o=0;o<t.coordinates.length;o++)for(var a=0;a<t.coordinates[o].length;a++)r=r.concat(pB(t.coordinates[o][a],[o,a],e,n)),r=r.slice(0,-1);break;default:throw Error("Unhandled geometry type: ".concat(t.type))}return r}function pB(t,e,n){for(var r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"existing",i=[],o=0;o<t.length;o++){var a=t[o];i.push({type:"Feature",properties:{guideType:"editHandle",positionIndexes:[].concat(g6(e),[o]),featureIndex:n,editHandleType:r},geometry:{type:"Point",coordinates:a}})}return i}function LIe(t,e,n){var r=t.geometry.coordinates;if(!r)return null;var i=r[0].slice(0,4);i[e%4]=n;var o=i[(e+2)%4],a=i[e%4];return i[(e+1)%4]=[a[0],o[1]],i[(e+3)%4]=[o[0],a[1]],[[].concat(g6(i),[i[0]])]}function Bre(t,e){return typeof t[0]=="number"?!isNaN(t[0])&&isFinite(t[0])?e(t):t:t.map(function(n){return Bre(n,e)}).filter(Boolean)}var Rc={};Object.defineProperty(Rc,"__esModule",{value:!0});Rc.ImmutableFeatureCollection=void 0;function Za(t){return FIe(t)||NIe(t)||BIe(t)||DIe()}function DIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function BIe(t,e){if(t){if(typeof t=="string")return gk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gk(t,e)}}function NIe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function FIe(t){if(Array.isArray(t))return gk(t)}function gk(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function kH(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function c0(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?kH(Object(n),!0).forEach(function(r){Nre(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):kH(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function kIe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zH(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function zIe(t,e,n){return e&&zH(t.prototype,e),n&&zH(t,n),t}function Nre(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var UIe=function(){function t(e){kIe(this,t),Nre(this,"featureCollection",void 0),this.featureCollection=e}return zIe(t,[{key:"getObject",value:function(){return this.featureCollection}},{key:"replacePosition",value:function(n,r,i){var o=this.featureCollection.features[n].geometry,a=o.type==="Polygon"||o.type==="MultiPolygon",s=c0({},o,{coordinates:Fre(o.coordinates,r,i,a)});return this.replaceGeometry(n,s)}},{key:"removePosition",value:function(n,r){var i=this.featureCollection.features[n].geometry;if(i.type==="Point")throw Error("Can't remove a position from a Point or there'd be nothing left");if(i.type==="MultiPoint"&&i.coordinates.length<2)throw Error("Can't remove the last point of a MultiPoint or there'd be nothing left");if(i.type==="LineString"&&i.coordinates.length<3)throw Error("Can't remove position. LineString must have at least two positions");if(i.type==="Polygon"&&i.coordinates[0].length<5&&Array.isArray(r)&&r[0]===0)throw Error("Can't remove position. Polygon's outer ring must have at least four positions");if(i.type==="MultiLineString"&&i.coordinates.length===1&&i.coordinates[0].length<3)throw Error("Can't remove position. MultiLineString must have at least two positions");if(i.type==="MultiPolygon"&&i.coordinates.length===1&&i.coordinates[0][0].length<5&&Array.isArray(r)&&r[0]===0&&r[1]===0)throw Error("Can't remove position. MultiPolygon's outer ring must have at least four positions");var o=i.type==="Polygon"||i.type==="MultiPolygon",a=c0({},i,{coordinates:kre(i.coordinates,r,o)});return GIe(a),this.replaceGeometry(n,a)}},{key:"addPosition",value:function(n,r,i){var o=this.featureCollection.features[n].geometry;if(o.type==="Point")throw new Error("Unable to add a position to a Point feature");o.type==="Polygon"||o.type;var a=c0({},o,{coordinates:zre(o.coordinates,r,i)});return this.replaceGeometry(n,a)}},{key:"replaceGeometry",value:function(n,r){var i=c0({},this.featureCollection.features[n],{geometry:r}),o=c0({},this.featureCollection,{features:[].concat(Za(this.featureCollection.features.slice(0,n)),[i],Za(this.featureCollection.features.slice(n+1)))});return new t(o)}},{key:"addFeature",value:function(n){return this.addFeatures([n])}},{key:"addFeatures",value:function(n){var r=c0({},this.featureCollection,{features:[].concat(Za(this.featureCollection.features),Za(n))});return new t(r)}},{key:"deleteFeature",value:function(n){return this.deleteFeatures([n])}},{key:"deleteFeatures",value:function(n){var r=Za(this.featureCollection.features);n.sort();for(var i=n.length-1;i>=0;i--){var o=n[i];o>=0&&o<r.length&&r.splice(o,1)}var a=c0({},this.featureCollection,{features:r});return new t(a)}}]),t}();Rc.ImmutableFeatureCollection=UIe;function jS(t,e){if(t.length===2&&e.length===3){var n=e[2];return[t[0],t[1],n]}return t}function Fre(t,e,n,r){if(!e)return t;if(e.length===0)return jS(n,t);if(e.length===1){var i=[].concat(Za(t.slice(0,e[0])),[jS(n,t[e[0]])],Za(t.slice(e[0]+1)));return r&&(e[0]===0||e[0]===t.length-1)&&(i[0]=jS(n,t[0]),i[t.length-1]=jS(n,t[0])),i}return[].concat(Za(t.slice(0,e[0])),[Fre(t[e[0]],e.slice(1,e.length),n,r)],Za(t.slice(e[0]+1)))}function kre(t,e,n){if(!e)return t;if(e.length===0)throw Error("Must specify the index of the position to remove");if(e.length===1){var r=[].concat(Za(t.slice(0,e[0])),Za(t.slice(e[0]+1)));return n&&(e[0]===0||e[0]===t.length-1)&&(e[0]===0?r[r.length-1]=r[0]:e[0]===t.length-1&&(r[0]=r[r.length-1])),r}return[].concat(Za(t.slice(0,e[0])),[kre(t[e[0]],e.slice(1,e.length),n)],Za(t.slice(e[0]+1)))}function zre(t,e,n,r){if(!e)return t;if(e.length===0)throw Error("Must specify the index of the position to remove");if(e.length===1){var i=[].concat(Za(t.slice(0,e[0])),[n],Za(t.slice(e[0])));return i}return[].concat(Za(t.slice(0,e[0])),[zre(t[e[0]],e.slice(1,e.length),n)],Za(t.slice(e[0]+1)))}function GIe(t){switch(t.type){case"Polygon":jIe(t);break;case"MultiLineString":VIe(t);break;case"MultiPolygon":$Ie(t);break}}function jIe(t){for(var e=t.coordinates,n=1;n<e.length;n++)Ure(e,n)&&n--}function VIe(t){for(var e=0;e<t.coordinates.length;e++){var n=t.coordinates[e];n.length===1&&(t.coordinates.splice(e,1),e--)}}function $Ie(t){for(var e=0;e<t.coordinates.length;e++){var n=t.coordinates[e],r=n[0];r.length<=3&&(t.coordinates.splice(e,1),e--);for(var i=1;i<n.length;i++)Ure(n,i)&&i--}}function Ure(t,e){var n=t[e];return n.length<=3?(t.splice(e,1),!0):!1}Object.defineProperty(So,"__esModule",{value:!0});So.getIntermediatePosition=oMe;So.GeoJsonEditMode=void 0;var HIe=sR(LPe),WIe=sR(u6),qIe=sR(kPe),XIe=sR(XPe),UH=Ai,gB=Rc;function sR(t){return t&&t.__esModule?t:{default:t}}function ZIe(t){if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(t=Gre(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var r,i=!0,o=!1,a;return{s:function(){r=t[Symbol.iterator]()},n:function(){var u=r.next();return i=u.done,u},e:function(u){o=!0,a=u},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(o)throw a}}}}function GH(t){return KIe(t)||QIe(t)||Gre(t)||YIe()}function YIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Gre(t,e){if(t){if(typeof t=="string")return mk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mk(t,e)}}function QIe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function KIe(t){if(Array.isArray(t))return mk(t)}function mk(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function JIe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function jH(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function eMe(t,e,n){return e&&jH(t.prototype,e),n&&jH(t,n),t}function tMe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var nMe={type:"FeatureCollection",features:[]},rMe=[],iMe=function(){function t(){JIe(this,t),tMe(this,"_clickSequence",[])}return eMe(t,[{key:"getGuides",value:function(n){return nMe}},{key:"getTooltips",value:function(n){return rMe}},{key:"getSelectedFeature",value:function(n){return n.selectedIndexes.length===1?n.data.features[n.selectedIndexes[0]]:null}},{key:"getSelectedGeometry",value:function(n){var r=this.getSelectedFeature(n);return r?r.geometry:null}},{key:"getSelectedFeaturesAsFeatureCollection",value:function(n){var r=n.data.features,i=n.selectedIndexes.map(function(o){return r[o]});return{type:"FeatureCollection",features:i}}},{key:"getClickSequence",value:function(){return this._clickSequence}},{key:"addClickSequence",value:function(n){var r=n.mapCoords;this._clickSequence.push(r)}},{key:"resetClickSequence",value:function(){this._clickSequence=[]}},{key:"getTentativeGuide",value:function(n){var r=this.getGuides(n);return r.features.find(function(i){return i.properties&&i.properties.guideType==="tentative"})}},{key:"isSelectionPicked",value:function(n,r){if(!n.length)return!1;var i=(0,UH.getNonGuidePicks)(n).map(function(s){var u=s.index;return u}),o=(0,UH.getPickedEditHandles)(n).map(function(s){var u=s.properties;return u.featureIndex}),a=new Set([].concat(GH(i),GH(o)));return r.selectedIndexes.some(function(s){return a.has(s)})}},{key:"rewindPolygon",value:function(n){var r=n.geometry,i=r.type==="Polygon"||r.type==="MultiPolygon";return i?(0,XIe.default)(n):n}},{key:"getAddFeatureAction",value:function(n,r){var i=n,o=i.type==="Feature"?i:{type:"Feature",properties:{},geometry:i},a=this.rewindPolygon(o),s=new gB.ImmutableFeatureCollection(r).addFeature(a).getObject();return{updatedData:s,editType:"addFeature",editContext:{featureIndexes:[s.features.length-1]}}}},{key:"getAddManyFeaturesAction",value:function(n,r){var i=n.features,o=new gB.ImmutableFeatureCollection(r),a=o.getObject().features.length,s=[],u=ZIe(i),d;try{for(u.s();!(d=u.n()).done;){var g=d.value,_=g.properties,E=g.geometry,P=E;o=o.addFeature({type:"Feature",properties:_,geometry:P}),s.push(a+s.length)}}catch(O){u.e(O)}finally{u.f()}return{updatedData:o.getObject(),editType:"addFeature",editContext:{featureIndexes:s}}}},{key:"getAddFeatureOrBooleanPolygonAction",value:function(n,r){var i=n,o=this.getSelectedFeature(r),a=r.modeConfig;if(a&&a.booleanOperation){if(!o||o.geometry.type!=="Polygon"&&o.geometry.type!=="MultiPolygon")return console.warn("booleanOperation only supported for single Polygon or MultiPolygon selection"),null;var s=i.type==="Feature"?i:{type:"Feature",geometry:i},u;if(a.booleanOperation==="union")u=(0,HIe.default)(o,s);else if(a.booleanOperation==="difference")u=(0,WIe.default)(o,s);else if(a.booleanOperation==="intersection")u=(0,qIe.default)(o,s);else return console.warn("Invalid booleanOperation ".concat(a.booleanOperation)),null;if(!u)return console.warn("Canceling edit. Boolean operation erased entire polygon."),null;var d=r.selectedIndexes[0],g=new gB.ImmutableFeatureCollection(r.data).replaceGeometry(d,u.geometry).getObject(),_={updatedData:g,editType:"unionGeometry",editContext:{featureIndexes:[d]}};return _}return this.getAddFeatureAction(n,r.data)}},{key:"createTentativeFeature",value:function(n){return null}},{key:"handleClick",value:function(n,r){}},{key:"handlePointerMove",value:function(n,r){var i=this.createTentativeFeature(r);i&&r.onEdit({updatedData:r.data,editType:"updateTentativeFeature",editContext:{feature:i}})}},{key:"handleStartDragging",value:function(n,r){}},{key:"handleStopDragging",value:function(n,r){}},{key:"handleDragging",value:function(n,r){}},{key:"handleKeyUp",value:function(n,r){n.key==="Escape"&&(this.resetClickSequence(),r.onEdit({updatedData:r.data,editType:"cancelFeature",editContext:{}}))}}]),t}();So.GeoJsonEditMode=iMe;function oMe(t,e){var n=[(t[0]+e[0])/2,(t[1]+e[1])/2];return n}var k1={};Object.defineProperty(k1,"__esModule",{value:!0});k1.ModifyMode=void 0;var VH=rl,Qc=Ai,sMe=So,mb=Rc;function vC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?vC=function(n){return typeof n}:vC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},vC(t)}function $H(t){return uMe(t)||lMe(t)||jre(t)||aMe()}function aMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lMe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function uMe(t){if(Array.isArray(t))return Ak(t)}function cMe(t){if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(t=jre(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var r,i=!0,o=!1,a;return{s:function(){r=t[Symbol.iterator]()},n:function(){var u=r.next();return i=u.done,u},e:function(u){o=!0,a=u},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(o)throw a}}}}function jre(t,e){if(t){if(typeof t=="string")return Ak(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ak(t,e)}}function Ak(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function fMe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function HH(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function hMe(t,e,n){return e&&HH(t.prototype,e),n&&HH(t,n),t}function dMe(t){return function(){var e=xI(t),n;if(mMe()){var r=xI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return pMe(this,n)}}function pMe(t,e){return e&&(vC(e)==="object"||typeof e=="function")?e:gMe(t)}function gMe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function xI(t){return xI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},xI(t)}function AMe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_k(t,e)}function _k(t,e){return _k=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},_k(t,e)}var _Me=function(t){AMe(n,t);var e=dMe(n);function n(){return fMe(this,n),e.apply(this,arguments)}return hMe(n,[{key:"getGuides",value:function(i){var o=this,a=[],s=i.data,u=i.lastPointerMoveEvent,d=s.features,g=u&&u.picks,_=u&&u.mapCoords,E=cMe(i.selectedIndexes),P;try{for(E.s();!(P=E.n()).done;){var O=P.value;if(O<d.length){var D=d[O].geometry;a.push.apply(a,$H((0,Qc.getEditHandlesForGeometry)(D,O)))}else console.warn("selectedFeatureIndexes out of range ".concat(O))}}catch(ie){E.e(ie)}finally{E.f()}if(g&&g.length&&_){var V,k=(0,Qc.getPickedExistingEditHandle)(g),F=!k&&g.find(function(ie){return!ie.isGuide});if(F&&!F.object.geometry.type.includes("Point")&&!(!((V=i.modeConfig)===null||V===void 0)&&V.lockRectangles&&F.object.properties.shape==="Rectangle")&&i.selectedIndexes.includes(F.index)){var z=null,X=[],Y=(0,VH.point)(_);if((0,Qc.recursivelyTraverseNestedArrays)(F.object.geometry.coordinates,[],function(ie,ce){var se=(0,VH.lineString)(ie),me=o.getNearestPoint(se,Y,i.modeConfig&&i.modeConfig.viewport);(!z||me.properties.dist<z.properties.dist)&&(z=me,X=ce)}),z){var J=z,re=J.geometry.coordinates,ue=J.properties.index;a.push({type:"Feature",properties:{guideType:"editHandle",editHandleType:"intermediate",featureIndex:F.index,positionIndexes:[].concat($H(X),[ue+1])},geometry:{type:"Point",coordinates:re}})}}}return{type:"FeatureCollection",features:a}}},{key:"getNearestPoint",value:function(i,o,a){var s=i.geometry.coordinates;if(s.some(function(u){return u.length>2})){if(a)return(0,Qc.nearestPointOnProjectedLine)(i,o,a);console.log("Editing 3D point but modeConfig.viewport not provided. Falling back to 2D logic.")}return(0,Qc.nearestPointOnLine)(i,o,a)}},{key:"handleClick",value:function(i,o){var a=(0,Qc.getPickedExistingEditHandle)(i.picks),s=(0,Qc.getPickedIntermediateEditHandle)(i.picks);if(a){var u=a.properties,d=u.featureIndex,g=u.positionIndexes,_;try{_=new mb.ImmutableFeatureCollection(o.data).removePosition(d,g).getObject()}catch{}_&&o.onEdit({updatedData:_,editType:"removePosition",editContext:{featureIndexes:[d],positionIndexes:g,position:a.geometry.coordinates}})}else if(s){var E,P=s.properties,O=P.featureIndex,D=P.positionIndexes,V=o.data.features[O],k=!(!((E=o.modeConfig)===null||E===void 0)&&E.lockRectangles&&(V==null?void 0:V.properties.shape)==="Rectangle");if(k){var F=new mb.ImmutableFeatureCollection(o.data).addPosition(O,D,s.geometry.coordinates).getObject();F&&o.onEdit({updatedData:F,editType:"addPosition",editContext:{featureIndexes:[O],positionIndexes:D,position:s.geometry.coordinates}})}}}},{key:"handleDragging",value:function(i,o){var a=(0,Qc.getPickedEditHandle)(i.pointerDownPicks);a&&(i.cancelPan(),this._dragEditHandle("movePosition",o,a,i))}},{key:"_dragEditHandle",value:function(i,o,a,s){var u,d=a.properties,g=o.data.features[d.featureIndex],_;if(!((u=o.modeConfig)===null||u===void 0)&&u.lockRectangles&&g.properties.shape==="Rectangle"){var E=(0,Qc.updateRectanglePosition)(g,d.positionIndexes[1],s.mapCoords);_=new mb.ImmutableFeatureCollection(o.data).replaceGeometry(d.featureIndex,{coordinates:E,type:"Polygon"}).getObject()}else _=new mb.ImmutableFeatureCollection(o.data).replacePosition(d.featureIndex,d.positionIndexes,s.mapCoords).getObject();o.onEdit({updatedData:_,editType:i,editContext:{featureIndexes:[d.featureIndex],positionIndexes:d.positionIndexes,position:s.mapCoords}})}},{key:"handlePointerMove",value:function(i,o){var a=this.getCursor(i);o.onUpdateCursor(a)}},{key:"handleStartDragging",value:function(i,o){var a=o.selectedIndexes,s=(0,Qc.getPickedIntermediateEditHandle)(i.picks);if(a.length&&s){var u=s.properties,d=new mb.ImmutableFeatureCollection(o.data).addPosition(u.featureIndex,u.positionIndexes,i.mapCoords).getObject();o.onEdit({updatedData:d,editType:"addPosition",editContext:{featureIndexes:[u.featureIndex],positionIndexes:u.positionIndexes,position:i.mapCoords}})}}},{key:"handleStopDragging",value:function(i,o){var a=o.selectedIndexes,s=(0,Qc.getPickedEditHandle)(i.picks);a.length&&s&&this._dragEditHandle("finishMovePosition",o,s,i)}},{key:"getCursor",value:function(i){var o=i&&i.picks||[],a=(0,Qc.getPickedEditHandles)(o);return a.length?"cell":null}}]),n}(sMe.GeoJsonEditMode);k1.ModifyMode=_Me;var aR={};function WH(t){if(!t)throw new Error("geojson is required");var e=[];return Vd(t,function(n){yMe(n,e)}),vf(e)}function yMe(t,e){var n=[],r=t.geometry;if(r!==null){switch(r.type){case"Polygon":n=jd(r);break;case"LineString":n=[jd(r)]}n.forEach(function(i){var o=vMe(i,t.properties);o.forEach(function(a){a.id=e.length,e.push(a)})})}}function vMe(t,e){var n=[];return t.reduce(function(r,i){var o=Su([r,i],e);return o.bbox=xMe(r,i),n.push(o),i}),n}function xMe(t,e){var n=t[0],r=t[1],i=e[0],o=e[1],a=n<i?n:i,s=r<o?r:o,u=n>i?n:i,d=r>o?r:o;return[a,s,u,d]}var m6={exports:{}},Vre={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(Ya,function(){function n(F,z,X,Y,J){(function re(ue,ie,ce,se,me){for(;se>ce;){if(se-ce>600){var Ce=se-ce+1,we=ie-ce+1,Ye=Math.log(Ce),at=.5*Math.exp(2*Ye/3),yt=.5*Math.sqrt(Ye*at*(Ce-at)/Ce)*(we-Ce/2<0?-1:1),be=Math.max(ce,Math.floor(ie-we*at/Ce+yt)),De=Math.min(se,Math.floor(ie+(Ce-we)*at/Ce+yt));re(ue,ie,be,De,me)}var Re=ue[ie],qe=ce,ct=se;for(r(ue,ce,ie),me(ue[se],Re)>0&&r(ue,ce,se);qe<ct;){for(r(ue,qe,ct),qe++,ct--;me(ue[qe],Re)<0;)qe++;for(;me(ue[ct],Re)>0;)ct--}me(ue[ce],Re)===0?r(ue,ce,ct):r(ue,++ct,se),ct<=ie&&(ce=ct+1),ie<=ct&&(se=ct-1)}})(F,z,X||0,Y||F.length-1,J||i)}function r(F,z,X){var Y=F[z];F[z]=F[X],F[X]=Y}function i(F,z){return F<z?-1:F>z?1:0}var o=function(F){F===void 0&&(F=9),this._maxEntries=Math.max(4,F),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function a(F,z,X){if(!X)return z.indexOf(F);for(var Y=0;Y<z.length;Y++)if(X(F,z[Y]))return Y;return-1}function s(F,z){u(F,0,F.children.length,z,F)}function u(F,z,X,Y,J){J||(J=V(null)),J.minX=1/0,J.minY=1/0,J.maxX=-1/0,J.maxY=-1/0;for(var re=z;re<X;re++){var ue=F.children[re];d(J,F.leaf?Y(ue):ue)}return J}function d(F,z){return F.minX=Math.min(F.minX,z.minX),F.minY=Math.min(F.minY,z.minY),F.maxX=Math.max(F.maxX,z.maxX),F.maxY=Math.max(F.maxY,z.maxY),F}function g(F,z){return F.minX-z.minX}function _(F,z){return F.minY-z.minY}function E(F){return(F.maxX-F.minX)*(F.maxY-F.minY)}function P(F){return F.maxX-F.minX+(F.maxY-F.minY)}function O(F,z){return F.minX<=z.minX&&F.minY<=z.minY&&z.maxX<=F.maxX&&z.maxY<=F.maxY}function D(F,z){return z.minX<=F.maxX&&z.minY<=F.maxY&&z.maxX>=F.minX&&z.maxY>=F.minY}function V(F){return{children:F,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function k(F,z,X,Y,J){for(var re=[z,X];re.length;)if(!((X=re.pop())-(z=re.pop())<=Y)){var ue=z+Math.ceil((X-z)/Y/2)*Y;n(F,ue,z,X,J),re.push(z,ue,ue,X)}}return o.prototype.all=function(){return this._all(this.data,[])},o.prototype.search=function(F){var z=this.data,X=[];if(!D(F,z))return X;for(var Y=this.toBBox,J=[];z;){for(var re=0;re<z.children.length;re++){var ue=z.children[re],ie=z.leaf?Y(ue):ue;D(F,ie)&&(z.leaf?X.push(ue):O(F,ie)?this._all(ue,X):J.push(ue))}z=J.pop()}return X},o.prototype.collides=function(F){var z=this.data;if(!D(F,z))return!1;for(var X=[];z;){for(var Y=0;Y<z.children.length;Y++){var J=z.children[Y],re=z.leaf?this.toBBox(J):J;if(D(F,re)){if(z.leaf||O(F,re))return!0;X.push(J)}}z=X.pop()}return!1},o.prototype.load=function(F){if(!F||!F.length)return this;if(F.length<this._minEntries){for(var z=0;z<F.length;z++)this.insert(F[z]);return this}var X=this._build(F.slice(),0,F.length-1,0);if(this.data.children.length)if(this.data.height===X.height)this._splitRoot(this.data,X);else{if(this.data.height<X.height){var Y=this.data;this.data=X,X=Y}this._insert(X,this.data.height-X.height-1,!0)}else this.data=X;return this},o.prototype.insert=function(F){return F&&this._insert(F,this.data.height-1),this},o.prototype.clear=function(){return this.data=V([]),this},o.prototype.remove=function(F,z){if(!F)return this;for(var X,Y,J,re=this.data,ue=this.toBBox(F),ie=[],ce=[];re||ie.length;){if(re||(re=ie.pop(),Y=ie[ie.length-1],X=ce.pop(),J=!0),re.leaf){var se=a(F,re.children,z);if(se!==-1)return re.children.splice(se,1),ie.push(re),this._condense(ie),this}J||re.leaf||!O(re,ue)?Y?(X++,re=Y.children[X],J=!1):re=null:(ie.push(re),ce.push(X),X=0,Y=re,re=re.children[0])}return this},o.prototype.toBBox=function(F){return F},o.prototype.compareMinX=function(F,z){return F.minX-z.minX},o.prototype.compareMinY=function(F,z){return F.minY-z.minY},o.prototype.toJSON=function(){return this.data},o.prototype.fromJSON=function(F){return this.data=F,this},o.prototype._all=function(F,z){for(var X=[];F;)F.leaf?z.push.apply(z,F.children):X.push.apply(X,F.children),F=X.pop();return z},o.prototype._build=function(F,z,X,Y){var J,re=X-z+1,ue=this._maxEntries;if(re<=ue)return s(J=V(F.slice(z,X+1)),this.toBBox),J;Y||(Y=Math.ceil(Math.log(re)/Math.log(ue)),ue=Math.ceil(re/Math.pow(ue,Y-1))),(J=V([])).leaf=!1,J.height=Y;var ie=Math.ceil(re/ue),ce=ie*Math.ceil(Math.sqrt(ue));k(F,z,X,ce,this.compareMinX);for(var se=z;se<=X;se+=ce){var me=Math.min(se+ce-1,X);k(F,se,me,ie,this.compareMinY);for(var Ce=se;Ce<=me;Ce+=ie){var we=Math.min(Ce+ie-1,me);J.children.push(this._build(F,Ce,we,Y-1))}}return s(J,this.toBBox),J},o.prototype._chooseSubtree=function(F,z,X,Y){for(;Y.push(z),!z.leaf&&Y.length-1!==X;){for(var J=1/0,re=1/0,ue=void 0,ie=0;ie<z.children.length;ie++){var ce=z.children[ie],se=E(ce),me=(Ce=F,we=ce,(Math.max(we.maxX,Ce.maxX)-Math.min(we.minX,Ce.minX))*(Math.max(we.maxY,Ce.maxY)-Math.min(we.minY,Ce.minY))-se);me<re?(re=me,J=se<J?se:J,ue=ce):me===re&&se<J&&(J=se,ue=ce)}z=ue||z.children[0]}var Ce,we;return z},o.prototype._insert=function(F,z,X){var Y=X?F:this.toBBox(F),J=[],re=this._chooseSubtree(Y,this.data,z,J);for(re.children.push(F),d(re,Y);z>=0&&J[z].children.length>this._maxEntries;)this._split(J,z),z--;this._adjustParentBBoxes(Y,J,z)},o.prototype._split=function(F,z){var X=F[z],Y=X.children.length,J=this._minEntries;this._chooseSplitAxis(X,J,Y);var re=this._chooseSplitIndex(X,J,Y),ue=V(X.children.splice(re,X.children.length-re));ue.height=X.height,ue.leaf=X.leaf,s(X,this.toBBox),s(ue,this.toBBox),z?F[z-1].children.push(ue):this._splitRoot(X,ue)},o.prototype._splitRoot=function(F,z){this.data=V([F,z]),this.data.height=F.height+1,this.data.leaf=!1,s(this.data,this.toBBox)},o.prototype._chooseSplitIndex=function(F,z,X){for(var Y,J,re,ue,ie,ce,se,me=1/0,Ce=1/0,we=z;we<=X-z;we++){var Ye=u(F,0,we,this.toBBox),at=u(F,we,X,this.toBBox),yt=(J=Ye,re=at,ue=void 0,ie=void 0,ce=void 0,se=void 0,ue=Math.max(J.minX,re.minX),ie=Math.max(J.minY,re.minY),ce=Math.min(J.maxX,re.maxX),se=Math.min(J.maxY,re.maxY),Math.max(0,ce-ue)*Math.max(0,se-ie)),be=E(Ye)+E(at);yt<me?(me=yt,Y=we,Ce=be<Ce?be:Ce):yt===me&&be<Ce&&(Ce=be,Y=we)}return Y||X-z},o.prototype._chooseSplitAxis=function(F,z,X){var Y=F.leaf?this.compareMinX:g,J=F.leaf?this.compareMinY:_;this._allDistMargin(F,z,X,Y)<this._allDistMargin(F,z,X,J)&&F.children.sort(Y)},o.prototype._allDistMargin=function(F,z,X,Y){F.children.sort(Y);for(var J=this.toBBox,re=u(F,0,z,J),ue=u(F,X-z,X,J),ie=P(re)+P(ue),ce=z;ce<X-z;ce++){var se=F.children[ce];d(re,F.leaf?J(se):se),ie+=P(re)}for(var me=X-z-1;me>=z;me--){var Ce=F.children[me];d(ue,F.leaf?J(Ce):Ce),ie+=P(ue)}return ie},o.prototype._adjustParentBBoxes=function(F,z,X){for(var Y=X;Y>=0;Y--)d(z[Y],F)},o.prototype._condense=function(F){for(var z=F.length-1,X=void 0;z>=0;z--)F[z].children.length===0?z>0?(X=F[z-1].children).splice(X.indexOf(F[z]),1):this.clear():s(F[z],this.toBBox)},o})})(Vre);var bMe=Vre.exports;function j0(t){var e=[1/0,1/0,-1/0,-1/0];return Jd(t,function(n){e[0]>n[0]&&(e[0]=n[0]),e[1]>n[1]&&(e[1]=n[1]),e[2]<n[0]&&(e[2]=n[0]),e[3]<n[1]&&(e[3]=n[1])}),e}j0.default=j0;const wMe=Object.freeze(Object.defineProperty({__proto__:null,default:j0},Symbol.toStringTag,{value:"Module"})),A6=ti(wMe);var gd=bMe,$re=rl,Hre=iR,Ey=A6.default,EMe=Hre.featureEach;Hre.coordEach;$re.polygon;var qH=$re.featureCollection;function Wre(t){var e=new gd(t);return e.insert=function(n){if(n.type!=="Feature")throw new Error("invalid feature");return n.bbox=n.bbox?n.bbox:Ey(n),gd.prototype.insert.call(this,n)},e.load=function(n){var r=[];return Array.isArray(n)?n.forEach(function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:Ey(i),r.push(i)}):EMe(n,function(i){if(i.type!=="Feature")throw new Error("invalid features");i.bbox=i.bbox?i.bbox:Ey(i),r.push(i)}),gd.prototype.load.call(this,r)},e.remove=function(n,r){if(n.type!=="Feature")throw new Error("invalid feature");return n.bbox=n.bbox?n.bbox:Ey(n),gd.prototype.remove.call(this,n,r)},e.clear=function(){return gd.prototype.clear.call(this)},e.search=function(n){var r=gd.prototype.search.call(this,this.toBBox(n));return qH(r)},e.collides=function(n){return gd.prototype.collides.call(this,this.toBBox(n))},e.all=function(){var n=gd.prototype.all.call(this);return qH(n)},e.toJSON=function(){return gd.prototype.toJSON.call(this)},e.fromJSON=function(n){return gd.prototype.fromJSON.call(this,n)},e.toBBox=function(n){var r;if(n.bbox)r=n.bbox;else if(Array.isArray(n)&&n.length===4)r=n;else if(Array.isArray(n)&&n.length===6)r=[n[0],n[1],n[3],n[4]];else if(n.type==="Feature")r=Ey(n);else if(n.type==="FeatureCollection")r=Ey(n);else throw new Error("invalid geojson");return{minX:r[0],minY:r[1],maxX:r[2],maxY:r[3]}},e}m6.exports=Wre;m6.exports.default=Wre;var SMe=m6.exports;const TMe=_A(SMe);function YE(t,e){var n={},r=[];if(t.type==="LineString"&&(t=Kl(t)),e.type==="LineString"&&(e=Kl(e)),t.type==="Feature"&&e.type==="Feature"&&t.geometry!==null&&e.geometry!==null&&t.geometry.type==="LineString"&&e.geometry.type==="LineString"&&t.geometry.coordinates.length===2&&e.geometry.coordinates.length===2){var i=XH(t,e);return i&&r.push(i),vf(r)}var o=TMe();return o.load(WH(e)),G0(WH(t),function(a){G0(o.search(a),function(s){var u=XH(a,s);if(u){var d=jd(u).join(",");n[d]||(n[d]=!0,r.push(u))}})}),vf(r)}function XH(t,e){var n=jd(t),r=jd(e);if(n.length!==2)throw new Error("<intersects> line1 must only contain 2 coordinates");if(r.length!==2)throw new Error("<intersects> line2 must only contain 2 coordinates");var i=n[0][0],o=n[0][1],a=n[1][0],s=n[1][1],u=r[0][0],d=r[0][1],g=r[1][0],_=r[1][1],E=(_-d)*(a-i)-(g-u)*(s-o),P=(g-u)*(o-d)-(_-d)*(i-u),O=(a-i)*(o-d)-(s-o)*(i-u);if(E===0)return null;var D=P/E,V=O/E;if(D>=0&&D<=1&&V>=0&&V<=1){var k=i+D*(a-i),F=o+D*(s-o);return zo([k,F])}return null}const CMe=Object.freeze(Object.defineProperty({__proto__:null,default:YE},Symbol.toStringTag,{value:"Module"}));function PMe(t,e,n){n===void 0&&(n={});var r=zo([1/0,1/0],{dist:1/0}),i=0;return Vd(t,function(o){for(var a=jd(o),s=0;s<a.length-1;s++){var u=zo(a[s]);u.properties.dist=ch(e,u,n);var d=zo(a[s+1]);d.properties.dist=ch(e,d,n);var g=ch(u,d,n),_=Math.max(u.properties.dist,d.properties.dist),E=qE(u,d),P=$v(e,_,E+90,n),O=$v(e,_,E-90,n),D=YE(Su([P.geometry.coordinates,O.geometry.coordinates]),Su([u.geometry.coordinates,d.geometry.coordinates])),V=null;D.features.length>0&&(V=D.features[0],V.properties.dist=ch(e,V,n),V.properties.location=i+ch(u,V,n)),u.properties.dist<r.properties.dist&&(r=u,r.properties.index=s,r.properties.location=i),d.properties.dist<r.properties.dist&&(r=d,r.properties.index=s+1,r.properties.location=i+g),V&&V.properties.dist<r.properties.dist&&(r=V,r.properties.index=s),i+=g}}),r}const IMe=Object.freeze(Object.defineProperty({__proto__:null,default:PMe},Symbol.toStringTag,{value:"Module"})),qre=ti(IMe);function MMe(t,e,n){n===void 0&&(n={});for(var r=n.steps||64,i=n.properties?n.properties:!Array.isArray(t)&&t.type==="Feature"&&t.properties?t.properties:{},o=[],a=0;a<r;a++)o.push($v(t,e,a*-360/r,n).geometry.coordinates);return o.push(o[0]),Th([o],i)}const OMe=Object.freeze(Object.defineProperty({__proto__:null,default:MMe},Symbol.toStringTag,{value:"Module"})),_6=ti(OMe),Lc=ti(KPe);function lR(t,e){e===void 0&&(e={});var n=j0(t),r=(n[0]+n[2])/2,i=(n[1]+n[3])/2;return zo([r,i],e.properties,e)}const RMe=Object.freeze(Object.defineProperty({__proto__:null,default:lR},Symbol.toStringTag,{value:"Module"})),Xre=ti(RMe);Object.defineProperty(aR,"__esModule",{value:!0});aR.ResizeCircleMode=void 0;var LMe=uR(qre),ZH=rl,DMe=uR(_6),BMe=uR(Lc),NMe=uR(Xre),Ab=Ai,FMe=So,kMe=Rc;function uR(t){return t&&t.__esModule?t:{default:t}}function xC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?xC=function(n){return typeof n}:xC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},xC(t)}function zMe(t){return VMe(t)||jMe(t)||GMe(t)||UMe()}function UMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GMe(t,e){if(t){if(typeof t=="string")return yk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yk(t,e)}}function jMe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function VMe(t){if(Array.isArray(t))return yk(t)}function yk(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function $Me(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function YH(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function HMe(t,e,n){return e&&YH(t.prototype,e),n&&YH(t,n),t}function WMe(t){return function(){var e=bI(t),n;if(XMe()){var r=bI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return qMe(this,n)}}function qMe(t,e){return e&&(xC(e)==="object"||typeof e=="function")?e:vk(t)}function vk(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function XMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function bI(t){return bI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},bI(t)}function ZMe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&xk(t,e)}function xk(t,e){return xk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},xk(t,e)}function QH(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var YMe=function(t){ZMe(n,t);var e=WMe(n);function n(){var r;$Me(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=e.call.apply(e,[this].concat(o)),QH(vk(r),"_selectedEditHandle",void 0),QH(vk(r),"_isResizing",!1),r}return HMe(n,[{key:"getGuides",value:function(i){var o=this,a=[],s=i.selectedIndexes,u=i.lastPointerMoveEvent,d=u&&u.picks,g=u&&u.mapCoords;if(d&&d.length&&g&&s.length===1&&!this._isResizing){var _=d.find(function(F){return!F.isGuide});if(_&&_.object.properties.shape&&_.object.properties.shape.includes("Circle")&&i.selectedIndexes.includes(_.index)){var E=null,P=[],O=(0,ZH.point)(g);if((0,Ab.recursivelyTraverseNestedArrays)(_.object.geometry.coordinates,[],function(F,z){var X=(0,ZH.lineString)(F),Y=o.getNearestPoint(X,O,i.modeConfig&&i.modeConfig.viewport);(!E||Y.properties.dist<E.properties.dist)&&(E=Y,P=z)}),E){var D=E,V=D.geometry.coordinates,k=D.properties.index;a.push({type:"Feature",properties:{guideType:"editHandle",editHandleType:"intermediate",featureIndex:_.index,positionIndexes:[].concat(zMe(P),[k+1])},geometry:{type:"Point",coordinates:V}})}}}return{type:"FeatureCollection",features:a}}},{key:"getNearestPoint",value:function(i,o,a){var s=i.geometry.coordinates;if(s.some(function(u){return u.length>2})){if(a)return(0,Ab.nearestPointOnProjectedLine)(i,o,a);console.log("Editing 3D point but modeConfig.viewport not provided. Falling back to 2D logic.")}return(0,LMe.default)(i,o)}},{key:"handleDragging",value:function(i,o){var a=(0,Ab.getPickedEditHandle)(i.pointerDownPicks);if(a){i.cancelPan();var s=a.properties,u=this.getSelectedFeature(o),d=(0,NMe.default)(u).geometry.coordinates,g=Object.entries(u.geometry.coordinates[0]).length-1,_=Math.max((0,BMe.default)(d,i.mapCoords),.001),E={},P=E.steps,O=P===void 0?g:P,D={steps:O},V=(0,DMe.default)(d,_,D),k=V.geometry,F=new kMe.ImmutableFeatureCollection(o.data).replaceGeometry(s.featureIndex,k).getObject();o.onEdit({updatedData:F,editType:"unionGeometry",editContext:{featureIndexes:[s.featureIndex]}})}}},{key:"handlePointerMove",value:function(i,o){if(!this._isResizing){var a=(0,Ab.getPickedEditHandle)(i.picks);this._selectedEditHandle=a&&a.properties.editHandleType==="intermediate"?a:null}var s=this.getCursor(i);o.onUpdateCursor(s)}},{key:"handleStartDragging",value:function(i,o){this._selectedEditHandle&&(this._isResizing=!0)}},{key:"handleStopDragging",value:function(i,o){this._isResizing&&(this._selectedEditHandle=null,this._isResizing=!1)}},{key:"getCursor",value:function(i){var o=i&&i.picks||[],a=(0,Ab.getPickedEditHandles)(o);return a.length?"cell":null}}]),n}(FMe.GeoJsonEditMode);aR.ResizeCircleMode=YMe;var z1={};function y6(t){if(!t)throw new Error("geojson is required");switch(t.type){case"Feature":return Zre(t);case"FeatureCollection":return QMe(t);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return v6(t);default:throw new Error("unknown GeoJSON type")}}function Zre(t){var e={type:"Feature"};return Object.keys(t).forEach(function(n){switch(n){case"type":case"properties":case"geometry":return;default:e[n]=t[n]}}),e.properties=Yre(t.properties),e.geometry=v6(t.geometry),e}function Yre(t){var e={};return t&&Object.keys(t).forEach(function(n){var r=t[n];typeof r=="object"?r===null?e[n]=null:Array.isArray(r)?e[n]=r.map(function(i){return i}):e[n]=Yre(r):e[n]=r}),e}function QMe(t){var e={type:"FeatureCollection"};return Object.keys(t).forEach(function(n){switch(n){case"type":case"features":return;default:e[n]=t[n]}}),e.features=t.features.map(function(n){return Zre(n)}),e}function v6(t){var e={type:t.type};return t.bbox&&(e.bbox=t.bbox),t.type==="GeometryCollection"?(e.geometries=t.geometries.map(function(n){return v6(n)}),e):(e.coordinates=Qre(t.coordinates),e)}function Qre(t){var e=t;return typeof e[0]!="object"?e.slice():e.map(function(n){return Qre(n)})}function qw(t,e,n,r){r===void 0&&(r={});var i=e<0,o=nR(Math.abs(e),r.units,"meters");i&&(o=-Math.abs(o));var a=Ea(t),s=KMe(a,o,n);return s[0]+=s[0]-a[0]>180?-360:a[0]-s[0]>180?360:0,zo(s,r.properties)}function KMe(t,e,n,r){r=r===void 0?na:Number(r);var i=e/r,o=t[0]*Math.PI/180,a=wa(t[1]),s=wa(n),u=i*Math.cos(s),d=a+u;Math.abs(d)>Math.PI/2&&(d=d>0?Math.PI-d:-Math.PI-d);var g=Math.log(Math.tan(d/2+Math.PI/4)/Math.tan(a/2+Math.PI/4)),_=Math.abs(g)>1e-11?u/g:Math.cos(a),E=i*Math.sin(s)/_,P=o+E;return[(P*180/Math.PI+540)%360-180,d*180/Math.PI]}function JMe(t,e,n,r){if(r=r||{},!d_(r))throw new Error("options is invalid");var i=r.units,o=r.zTranslation,a=r.mutate;if(!t)throw new Error("geojson is required");if(e==null||isNaN(e))throw new Error("distance is required");if(o&&typeof o!="number"&&isNaN(o))throw new Error("zTranslation is not a number");if(o=o!==void 0?o:0,e===0&&o===0)return t;if(n==null||isNaN(n))throw new Error("direction is required");return e<0&&(e=-e,n=n+180),(a===!1||a===void 0)&&(t=y6(t)),Jd(t,function(s){var u=jd(qw(s,e,n,{units:i}));s[0]=u[0],s[1]=u[1],o&&s.length===3&&(s[2]+=o)}),t}const eOe=Object.freeze(Object.defineProperty({__proto__:null,default:JMe},Symbol.toStringTag,{value:"Module"})),tOe=ti(eOe);Object.defineProperty(z1,"__esModule",{value:!0});z1.TranslateMode=void 0;var nOe=cR(Kd),rOe=cR(Lc),iOe=cR(tOe),KH=rl,oOe=cR(p6),sOe=Ai,aOe=So,lOe=Rc;function cR(t){return t&&t.__esModule?t:{default:t}}function bC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?bC=function(n){return typeof n}:bC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},bC(t)}function uOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function JH(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function cOe(t,e,n){return e&&JH(t.prototype,e),n&&JH(t,n),t}function fOe(t){return function(){var e=wI(t),n;if(dOe()){var r=wI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return hOe(this,n)}}function hOe(t,e){return e&&(bC(e)==="object"||typeof e=="function")?e:bk(t)}function bk(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function dOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function wI(t){return wI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},wI(t)}function pOe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&wk(t,e)}function wk(t,e){return wk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},wk(t,e)}function e7(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var gOe=function(t){pOe(n,t);var e=fOe(n);function n(){var r;uOe(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=e.call.apply(e,[this].concat(o)),e7(bk(r),"_geometryBeforeTranslate",void 0),e7(bk(r),"_isTranslatable",void 0),r}return cOe(n,[{key:"handleDragging",value:function(i,o){if(this._isTranslatable){if(this._geometryBeforeTranslate){var a=this.getTranslateAction(i.pointerDownMapCoords,i.mapCoords,"translating",o);a&&o.onEdit(a)}i.cancelPan()}}},{key:"handlePointerMove",value:function(i,o){this._isTranslatable=this.isSelectionPicked(i.pointerDownPicks||i.picks,o),this.updateCursor(o)}},{key:"handleStartDragging",value:function(i,o){this._isTranslatable&&(this._geometryBeforeTranslate=this.getSelectedFeaturesAsFeatureCollection(o))}},{key:"handleStopDragging",value:function(i,o){if(this._geometryBeforeTranslate){var a=this.getTranslateAction(i.pointerDownMapCoords,i.mapCoords,"translated",o);a&&o.onEdit(a),this._geometryBeforeTranslate=null}}},{key:"updateCursor",value:function(i){this._isTranslatable?i.onUpdateCursor("move"):i.onUpdateCursor(null)}},{key:"getTranslateAction",value:function(i,o,a,s){var u=this;if(!this._geometryBeforeTranslate)return null;var d=new lOe.ImmutableFeatureCollection(s.data),g=s.selectedIndexes,_=s.modeConfig||{},E=_.viewport,P=_.screenSpace;if(E&&P)(function(){for(var J=E.project?E:new oOe.default(E),re=J.project(i),ue=J.project(o),ie=ue[0]-re[0],ce=ue[1]-re[1],se=0;se<g.length;se++){var me=g[se],Ce=u._geometryBeforeTranslate.features[se],we=Ce.geometry.coordinates;we&&(we=(0,sOe.mapCoords)(we,function(Ye){var at=J.project(Ye);return at?(at[0]+=ie,at[1]+=ce,J.unproject(at)):null}),d=d.replaceGeometry(me,{type:Ce.geometry.type,coordinates:we}))}})();else for(var O=(0,KH.point)(i),D=(0,KH.point)(o),V=(0,rOe.default)(O,D),k=(0,nOe.default)(O,D),F=(0,iOe.default)(this._geometryBeforeTranslate,V,k),z=0;z<g.length;z++){var X=g[z],Y=F.features[z];d=d.replaceGeometry(X,Y.geometry)}return{updatedData:d.getObject(),editType:a,editContext:{featureIndexes:g}}}}]),n}(aOe.GeoJsonEditMode);z1.TranslateMode=gOe;var QE={};function x6(t,e){e===void 0&&(e={});var n=0,r=0,i=0;return Jd(t,function(o){n+=o[0],r+=o[1],i++},!0),zo([n/i,r/i],e.properties)}const mOe=Object.freeze(Object.defineProperty({__proto__:null,default:x6},Symbol.toStringTag,{value:"Module"})),b6=ti(mOe);function AOe(t,e){e===void 0&&(e={});var n=Number(t[0]),r=Number(t[1]),i=Number(t[2]),o=Number(t[3]);if(t.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var a=[n,r],s=[n,o],u=[i,o],d=[i,r];return Th([[a,d,u,s,a]],e.properties,{bbox:t,id:e.id})}const _Oe=Object.freeze(Object.defineProperty({__proto__:null,default:AOe},Symbol.toStringTag,{value:"Module"})),p_=ti(_Oe);function EI(t,e){e===void 0&&(e={});var n=xf(t);switch(!e.properties&&t.type==="Feature"&&(e.properties=t.properties),n.type){case"Polygon":return Kre(n,e);case"MultiPolygon":return Jre(n,e);default:throw new Error("invalid poly")}}function Kre(t,e){e===void 0&&(e={});var n=xf(t),r=n.coordinates,i=e.properties?e.properties:t.type==="Feature"?t.properties:{};return w6(r,i)}function Jre(t,e){e===void 0&&(e={});var n=xf(t),r=n.coordinates,i=e.properties?e.properties:t.type==="Feature"?t.properties:{},o=[];return r.forEach(function(a){o.push(w6(a,i))}),vf(o)}function w6(t,e){return t.length>1?l6(t,e):Su(t[0],e)}const yOe=Object.freeze(Object.defineProperty({__proto__:null,coordsToLine:w6,default:EI,multiPolygonToLine:Jre,polygonToLine:Kre},Symbol.toStringTag,{value:"Module"})),E6=ti(yOe);function eie(t,e,n){n===void 0&&(n={});var r;n.final?r=t7(Ea(e),Ea(t)):r=t7(Ea(t),Ea(e));var i=r>180?-(360-r):r;return i}function t7(t,e){var n=wa(t[1]),r=wa(e[1]),i=wa(e[0]-t[0]);i>Math.PI&&(i-=2*Math.PI),i<-Math.PI&&(i+=2*Math.PI);var o=Math.log(Math.tan(r/2+Math.PI/4)/Math.tan(n/2+Math.PI/4)),a=Math.atan2(i,o);return(Vv(a)+360)%360}function vOe(t,e,n){if(n=n||{},!d_(n))throw new Error("options is invalid");var r=n.origin,i=n.mutate;if(!t)throw new Error("geojson required");if(typeof e!="number"||e===0)throw new Error("invalid factor");var o=Array.isArray(r)||typeof r=="object";return i!==!0&&(t=y6(t)),t.type==="FeatureCollection"&&!o?(G0(t,function(a,s){t.features[s]=n7(a,e,r)}),t):n7(t,e,r)}function n7(t,e,n){var r=xre(t)==="Point";return n=xOe(t,n),e===1||r||Jd(t,function(i){var o=h6(n,i),a=eie(n,i),s=o*e,u=jd(qw(n,s,a));i[0]=u[0],i[1]=u[1],i.length===3&&(i[2]*=e)}),t}function xOe(t,e){if(e==null&&(e="centroid"),Array.isArray(e)||typeof e=="object")return Ea(e);var n=t.bbox?t.bbox:j0(t),r=n[0],i=n[1],o=n[2],a=n[3];switch(e){case"sw":case"southwest":case"westsouth":case"bottomleft":return zo([r,i]);case"se":case"southeast":case"eastsouth":case"bottomright":return zo([o,i]);case"nw":case"northwest":case"westnorth":case"topleft":return zo([r,a]);case"ne":case"northeast":case"eastnorth":case"topright":return zo([o,a]);case"center":return lR(t);case void 0:case null:case"centroid":return x6(t);default:throw new Error("invalid origin")}}const bOe=Object.freeze(Object.defineProperty({__proto__:null,default:vOe},Symbol.toStringTag,{value:"Module"})),wOe=ti(bOe);Object.defineProperty(QE,"__esModule",{value:!0});QE.ScaleMode=void 0;var EOe=g_(A6),SOe=g_(b6),TOe=g_(Kd),COe=g_(p_),r7=rl,POe=g_(E6),IOe=iR,i7=g_(Lc),MOe=g_(wOe),o7=d6,OOe=Ai,ROe=So,LOe=Rc;function g_(t){return t&&t.__esModule?t:{default:t}}function wC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?wC=function(n){return typeof n}:wC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},wC(t)}function DOe(t){return kOe(t)||FOe(t)||NOe(t)||BOe()}function BOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function NOe(t,e){if(t){if(typeof t=="string")return Ek(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ek(t,e)}}function FOe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function kOe(t){if(Array.isArray(t))return Ek(t)}function Ek(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function zOe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function UOe(t,e,n){return e&&s7(t.prototype,e),n&&s7(t,n),t}function GOe(t){return function(){var e=SI(t),n;if(VOe()){var r=SI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return jOe(this,n)}}function jOe(t,e){return e&&(wC(e)==="object"||typeof e=="function")?e:Kc(t)}function Kc(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function VOe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function SI(t){return SI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},SI(t)}function $Oe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Sk(t,e)}function Sk(t,e){return Sk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Sk(t,e)}function ih(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var HOe=function(t){$Oe(n,t);var e=GOe(n);function n(){var r;zOe(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=e.call.apply(e,[this].concat(o)),ih(Kc(r),"_geometryBeingScaled",void 0),ih(Kc(r),"_selectedEditHandle",void 0),ih(Kc(r),"_cornerGuidePoints",void 0),ih(Kc(r),"_cursor",void 0),ih(Kc(r),"_isScaling",!1),ih(Kc(r),"_isSinglePointGeometrySelected",function(s){var u=s||{},d=u.features;if(Array.isArray(d)&&d.length===1){var g=(0,o7.getGeom)(d[0]),_=g.type;return _==="Point"}return!1}),ih(Kc(r),"_getOppositeScaleHandle",function(s){var u=s&&s.properties&&Array.isArray(s.properties.positionIndexes)&&s.properties.positionIndexes[0];if(typeof u!="number")return null;var d=r._cornerGuidePoints.length,g=(u+d/2)%d;return r._cornerGuidePoints.find(function(_){return Array.isArray(_.properties.positionIndexes)?_.properties.positionIndexes[0]===g:!1})}),ih(Kc(r),"_getUpdatedData",function(s,u){for(var d=new LOe.ImmutableFeatureCollection(s.data),g=s.selectedIndexes,_=0;_<g.length;_++){var E=g[_],P=u.features[_];d=d.replaceGeometry(E,P.geometry)}return d.getObject()}),ih(Kc(r),"isEditHandleSelected",function(){return!!r._selectedEditHandle}),ih(Kc(r),"getScaleAction",function(s,u,d,g){if(!r._selectedEditHandle)return null;var _=r._getOppositeScaleHandle(r._selectedEditHandle),E=(0,o7.getCoord)(_),P=WOe(E,s,u),O=(0,MOe.default)(r._geometryBeingScaled,P,{origin:E});return{updatedData:r._getUpdatedData(g,O),editType:d,editContext:{featureIndexes:g.selectedIndexes}}}),ih(Kc(r),"updateCursor",function(s){if(r._selectedEditHandle){r._cursor&&s.onUpdateCursor(r._cursor);var u=r.getSelectedFeaturesAsFeatureCollection(s),d=(0,SOe.default)(u),g=(0,TOe.default)(d,r._selectedEditHandle),_=g<0?g+180:g;_>=0&&_<=90||_>=180&&_<=270?(r._cursor="nesw-resize",s.onUpdateCursor("nesw-resize")):(r._cursor="nwse-resize",s.onUpdateCursor("nwse-resize"))}else s.onUpdateCursor(null),r._cursor=null}),r}return UOe(n,[{key:"handlePointerMove",value:function(i,o){if(!this._isScaling){var a=(0,OOe.getPickedEditHandle)(i.picks);this._selectedEditHandle=a&&a.properties.editHandleType==="scale"?a:null,this.updateCursor(o)}}},{key:"handleStartDragging",value:function(i,o){this._selectedEditHandle&&(this._isScaling=!0,this._geometryBeingScaled=this.getSelectedFeaturesAsFeatureCollection(o))}},{key:"handleDragging",value:function(i,o){if(this._isScaling){o.onUpdateCursor(this._cursor);var a=this.getScaleAction(i.pointerDownMapCoords,i.mapCoords,"scaling",o);a&&o.onEdit(a),i.cancelPan()}}},{key:"handleStopDragging",value:function(i,o){if(this._isScaling){var a=this.getScaleAction(i.pointerDownMapCoords,i.mapCoords,"scaled",o);a&&o.onEdit(a),o.onUpdateCursor(null),this._geometryBeingScaled=null,this._selectedEditHandle=null,this._cursor=null,this._isScaling=!1}}},{key:"getGuides",value:function(i){this._cornerGuidePoints=[];var o=this.getSelectedFeaturesAsFeatureCollection(i);if(this._isSinglePointGeometrySelected(o))return{type:"FeatureCollection",features:[]};var a=(0,COe.default)((0,EOe.default)(o));a.properties.mode="scale";var s=[];return(0,IOe.coordEach)(a,function(u,d){if(d<4){var g=(0,r7.point)(u,{guideType:"editHandle",editHandleType:"scale",positionIndexes:[d]});s.push(g)}}),this._cornerGuidePoints=s,(0,r7.featureCollection)([(0,POe.default)(a)].concat(DOe(this._cornerGuidePoints)))}}]),n}(ROe.GeoJsonEditMode);QE.ScaleMode=HOe;function WOe(t,e,n){var r=(0,i7.default)(t,e),i=(0,i7.default)(t,n);return i/r}var KE={};function tie(t,e,n){if(n=n||{},!d_(n))throw new Error("options is invalid");var r=n.pivot,i=n.mutate;if(!t)throw new Error("geojson is required");if(e==null||isNaN(e))throw new Error("angle is required");return e===0||(r||(r=x6(t)),(i===!1||i===void 0)&&(t=y6(t)),Jd(t,function(o){var a=eie(r,o),s=a+e,u=h6(r,o),d=jd(qw(r,u,s));o[0]=d[0],o[1]=d[1]})),t}const qOe=Object.freeze(Object.defineProperty({__proto__:null,default:tie},Symbol.toStringTag,{value:"Module"})),XOe=ti(qOe);Object.defineProperty(KE,"__esModule",{value:!0});KE.RotateMode=void 0;var ZOe=m_(A6),a7=m_(b6),l7=m_(Kd),YOe=m_(p_),QOe=m_(Lc),KOe=iR,JOe=d6,VS=rl,eRe=m_(XOe),tRe=m_(E6),nRe=Ai,u7=So,rRe=Rc;function m_(t){return t&&t.__esModule?t:{default:t}}function EC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?EC=function(n){return typeof n}:EC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},EC(t)}function iRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function oRe(t,e,n){return e&&c7(t.prototype,e),n&&c7(t,n),t}function sRe(t){return function(){var e=TI(t),n;if(lRe()){var r=TI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return aRe(this,n)}}function aRe(t,e){return e&&(EC(e)==="object"||typeof e=="function")?e:Uy(t)}function Uy(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function TI(t){return TI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},TI(t)}function uRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Tk(t,e)}function Tk(t,e){return Tk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Tk(t,e)}function _b(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var cRe=function(t){uRe(n,t);var e=sRe(n);function n(){var r;iRe(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=e.call.apply(e,[this].concat(o)),_b(Uy(r),"_selectedEditHandle",void 0),_b(Uy(r),"_geometryBeingRotated",void 0),_b(Uy(r),"_isRotating",!1),_b(Uy(r),"_isSinglePointGeometrySelected",function(s){var u=s||{},d=u.features;if(Array.isArray(d)&&d.length===1){var g=(0,JOe.getGeom)(d[0]),_=g.type;return _==="Point"}return!1}),_b(Uy(r),"getIsRotating",function(){return r._isRotating}),r}return oRe(n,[{key:"getGuides",value:function(i){var o=this._geometryBeingRotated||this.getSelectedFeaturesAsFeatureCollection(i);if(this._isSinglePointGeometrySelected(o))return{type:"FeatureCollection",features:[]};if(this._isRotating)return(0,VS.featureCollection)([(0,a7.default)(o)]);var a=(0,YOe.default)((0,ZOe.default)(o)),s=null,u=null,d=0;(0,KOe.coordEach)(a,function(P){if(s){var O=(0,u7.getIntermediatePosition)(P,s);(!u||O[1]>u[1])&&(u=O);var D=(0,QOe.default)(P,s);d=Math.max(d,D)}s=P});var g=u&&[u[0],u[1]+d/1e3],_=(0,VS.lineString)([u,g]),E=(0,VS.point)(g,{guideType:"editHandle",editHandleType:"rotate"});return(0,VS.featureCollection)([(0,tRe.default)(a),E,_])}},{key:"handleDragging",value:function(i,o){if(this._isRotating){var a=this.getRotateAction(i.pointerDownMapCoords,i.mapCoords,"rotating",o);a&&o.onEdit(a),i.cancelPan()}}},{key:"handlePointerMove",value:function(i,o){if(!this._isRotating){var a=(0,nRe.getPickedEditHandle)(i.picks);this._selectedEditHandle=a&&a.properties.editHandleType==="rotate"?a:null}this.updateCursor(o)}},{key:"handleStartDragging",value:function(i,o){this._selectedEditHandle&&(this._isRotating=!0,this._geometryBeingRotated=this.getSelectedFeaturesAsFeatureCollection(o))}},{key:"handleStopDragging",value:function(i,o){if(this._isRotating){var a=this.getRotateAction(i.pointerDownMapCoords,i.mapCoords,"rotated",o);a&&o.onEdit(a),this._geometryBeingRotated=null,this._selectedEditHandle=null,this._isRotating=!1}}},{key:"updateCursor",value:function(i){this._selectedEditHandle?i.onUpdateCursor("crosshair"):i.onUpdateCursor(null)}},{key:"getRotateAction",value:function(i,o,a,s){if(!this._geometryBeingRotated)return null;for(var u=(0,a7.default)(this._geometryBeingRotated),d=fRe(u,i,o),g=(0,eRe.default)(this._geometryBeingRotated,d,{pivot:u}),_=new rRe.ImmutableFeatureCollection(s.data),E=s.selectedIndexes,P=0;P<E.length;P++){var O=E[P],D=g.features[P];_=_.replaceGeometry(O,D.geometry)}return{updatedData:_.getObject(),editType:a,editContext:{featureIndexes:E}}}}]),n}(u7.GeoJsonEditMode);KE.RotateMode=cRe;function fRe(t,e,n){var r=(0,l7.default)(t,e),i=(0,l7.default)(t,n);return i-r}var fR={};Object.defineProperty(fR,"__esModule",{value:!0});fR.DuplicateMode=void 0;var hRe=z1;function SC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?SC=function(n){return typeof n}:SC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},SC(t)}function dRe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function f7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function pRe(t,e,n){return e&&f7(t.prototype,e),n&&f7(t,n),t}function TC(t,e,n){return typeof Reflect<"u"&&Reflect.get?TC=Reflect.get:TC=function(i,o,a){var s=gRe(i,o);if(s){var u=Object.getOwnPropertyDescriptor(s,o);return u.get?u.get.call(a):u.value}},TC(t,e,n||t)}function gRe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Hv(t),t!==null););return t}function mRe(t){return function(){var e=Hv(t),n;if(yRe()){var r=Hv(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return ARe(this,n)}}function ARe(t,e){return e&&(SC(e)==="object"||typeof e=="function")?e:_Re(t)}function _Re(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Hv(t){return Hv=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Hv(t)}function vRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ck(t,e)}function Ck(t,e){return Ck=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Ck(t,e)}var xRe=function(t){vRe(n,t);var e=mRe(n);function n(){return dRe(this,n),e.apply(this,arguments)}return pRe(n,[{key:"handleStartDragging",value:function(i,o){TC(Hv(n.prototype),"handleStartDragging",this).call(this,i,o),this._geometryBeforeTranslate&&o.onEdit(this.getAddManyFeaturesAction(this._geometryBeforeTranslate,o.data))}},{key:"updateCursor",value:function(i){this._isTranslatable?i.onUpdateCursor("copy"):i.onUpdateCursor(null)}}]),n}(hRe.TranslateMode);fR.DuplicateMode=xRe;var hR={};Object.defineProperty(hR,"__esModule",{value:!0});hR.ExtendLineStringMode=void 0;var bRe=So,wRe=Rc;function CC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?CC=function(n){return typeof n}:CC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},CC(t)}function ERe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function h7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function SRe(t,e,n){return e&&h7(t.prototype,e),n&&h7(t,n),t}function TRe(t){return function(){var e=CI(t),n;if(IRe()){var r=CI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return CRe(this,n)}}function CRe(t,e){return e&&(CC(e)==="object"||typeof e=="function")?e:PRe(t)}function PRe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function IRe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function CI(t){return CI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},CI(t)}function MRe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Pk(t,e)}function Pk(t,e){return Pk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Pk(t,e)}var ORe=function(t){MRe(n,t);var e=TRe(n);function n(){return ERe(this,n),e.apply(this,arguments)}return SRe(n,[{key:"getSingleSelectedLineString",value:function(i){var o=this.getSelectedGeometry(i);return o&&o.type==="LineString"?o:null}},{key:"handleClick",value:function(i,o){var a=o.selectedIndexes,s=this.getSingleSelectedLineString(o);if(!s){console.warn("ExtendLineStringMode only supported for single LineString selection");return}var u=[s.coordinates.length],d=o.modeConfig;d&&d.drawAtFront&&(u=[0]);var g=a[0],_=new wRe.ImmutableFeatureCollection(o.data).addPosition(g,u,i.mapCoords).getObject();o.onEdit({updatedData:_,editType:"addPosition",editContext:{featureIndexes:[g],positionIndexes:u,position:i.mapCoords}})}},{key:"getGuides",value:function(i){var o={type:"FeatureCollection",features:[]},a=this.getSingleSelectedLineString(i);if(!a)return o;var s=i.lastPointerMoveEvent&&i.lastPointerMoveEvent.mapCoords,u=null,d=i.modeConfig;return d&&d.drawAtFront?u=a.coordinates[0]:u=a.coordinates[a.coordinates.length-1],o.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[u,s]}}),o}},{key:"handlePointerMove",value:function(i,o){o.onUpdateCursor("cell")}}]),n}(bRe.GeoJsonEditMode);hR.ExtendLineStringMode=ORe;var dR={};function Wv(t,e,n){if(n===void 0&&(n={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var r=Ea(t),i=xf(e),o=i.type,a=e.bbox,s=i.coordinates;if(a&&RRe(r,a)===!1)return!1;o==="Polygon"&&(s=[s]);for(var u=!1,d=0;d<s.length&&!u;d++)if(d7(r,s[d][0],n.ignoreBoundary)){for(var g=!1,_=1;_<s[d].length&&!g;)d7(r,s[d][_],!n.ignoreBoundary)&&(g=!0),_++;g||(u=!0)}return u}function d7(t,e,n){var r=!1;e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]&&(e=e.slice(0,e.length-1));for(var i=0,o=e.length-1;i<e.length;o=i++){var a=e[i][0],s=e[i][1],u=e[o][0],d=e[o][1],g=t[1]*(a-u)+s*(u-t[0])+d*(t[0]-a)===0&&(a-t[0])*(u-t[0])<=0&&(s-t[1])*(d-t[1])<=0;if(g)return!n;var _=s>t[1]!=d>t[1]&&t[0]<(u-a)*(t[1]-s)/(d-s)+a;_&&(r=!r)}return r}function RRe(t,e){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[0]&&e[3]>=t[1]}const LRe=Object.freeze(Object.defineProperty({__proto__:null,default:Wv},Symbol.toStringTag,{value:"Module"})),DRe=ti(LRe);"fill"in Array.prototype||Object.defineProperty(Array.prototype,"fill",{configurable:!0,value:function(e){if(this===void 0||this===null)throw new TypeError(this+" is not an object");var n=Object(this),r=Math.max(Math.min(n.length,9007199254740991),0)||0,i=1 in arguments&&parseInt(Number(arguments[1]),10)||0;i=i<0?Math.max(r+i,0):Math.min(i,r);var o=2 in arguments&&arguments[2]!==void 0?parseInt(Number(arguments[2]),10)||0:r;for(o=o<0?Math.max(r+arguments[2],0):Math.min(o,r);i<o;)n[i]=e,++i;return n},writable:!0});Number.isFinite=Number.isFinite||function(t){return typeof t=="number"&&isFinite(t)};Number.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};Number.parseFloat=Number.parseFloat||parseFloat;Number.isNaN=Number.isNaN||function(t){return t!==t};Math.trunc=Math.trunc||function(t){return t<0?Math.ceil(t):Math.floor(t)};var V0=function(){};V0.prototype.interfaces_=function(){return[]};V0.prototype.getClass=function(){return V0};V0.prototype.equalsWithTolerance=function(e,n,r){return Math.abs(e-n)<=r};var oo=function(t){function e(n){t.call(this,n),this.name="IllegalArgumentException",this.message=n,this.stack=new t().stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),mr=function(){},nie={MAX_VALUE:{configurable:!0}};mr.isNaN=function(e){return Number.isNaN(e)};mr.doubleToLongBits=function(e){return e};mr.longBitsToDouble=function(e){return e};mr.isInfinite=function(e){return!Number.isFinite(e)};nie.MAX_VALUE.get=function(){return Number.MAX_VALUE};Object.defineProperties(mr,nie);var Uu=function(){},pR=function(){},qv=function(){};function Gu(){}var dt=function t(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)this.x=0,this.y=0,this.z=t.NULL_ORDINATE;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.z=e.z}else arguments.length===2?(this.x=arguments[0],this.y=arguments[1],this.z=t.NULL_ORDINATE):arguments.length===3&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])},A_={DimensionalComparator:{configurable:!0},serialVersionUID:{configurable:!0},NULL_ORDINATE:{configurable:!0},X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0}};dt.prototype.setOrdinate=function(e,n){switch(e){case dt.X:this.x=n;break;case dt.Y:this.y=n;break;case dt.Z:this.z=n;break;default:throw new oo("Invalid ordinate index: "+e)}};dt.prototype.equals2D=function(){if(arguments.length===1){var e=arguments[0];return!(this.x!==e.x||this.y!==e.y)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return!(!V0.equalsWithTolerance(this.x,n.x,r)||!V0.equalsWithTolerance(this.y,n.y,r))}};dt.prototype.getOrdinate=function(e){switch(e){case dt.X:return this.x;case dt.Y:return this.y;case dt.Z:return this.z}throw new oo("Invalid ordinate index: "+e)};dt.prototype.equals3D=function(e){return this.x===e.x&&this.y===e.y&&(this.z===e.z||mr.isNaN(this.z))&&mr.isNaN(e.z)};dt.prototype.equals=function(e){return e instanceof dt?this.equals2D(e):!1};dt.prototype.equalInZ=function(e,n){return V0.equalsWithTolerance(this.z,e.z,n)};dt.prototype.compareTo=function(e){var n=e;return this.x<n.x?-1:this.x>n.x?1:this.y<n.y?-1:this.y>n.y?1:0};dt.prototype.clone=function(){};dt.prototype.copy=function(){return new dt(this)};dt.prototype.toString=function(){return"("+this.x+", "+this.y+", "+this.z+")"};dt.prototype.distance3D=function(e){var n=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return Math.sqrt(n*n+r*r+i*i)};dt.prototype.distance=function(e){var n=this.x-e.x,r=this.y-e.y;return Math.sqrt(n*n+r*r)};dt.prototype.hashCode=function(){var e=17;return e=37*e+dt.hashCode(this.x),e=37*e+dt.hashCode(this.y),e};dt.prototype.setCoordinate=function(e){this.x=e.x,this.y=e.y,this.z=e.z};dt.prototype.interfaces_=function(){return[Uu,pR,Gu]};dt.prototype.getClass=function(){return dt};dt.hashCode=function(){if(arguments.length===1){var e=arguments[0],n=mr.doubleToLongBits(e);return Math.trunc((n^n)>>>32)}};A_.DimensionalComparator.get=function(){return Zp};A_.serialVersionUID.get=function(){return 6683108902428367e3};A_.NULL_ORDINATE.get=function(){return mr.NaN};A_.X.get=function(){return 0};A_.Y.get=function(){return 1};A_.Z.get=function(){return 2};Object.defineProperties(dt,A_);var Zp=function(e){if(this._dimensionsToTest=2,arguments.length!==0){if(arguments.length===1){var n=arguments[0];if(n!==2&&n!==3)throw new oo("only 2 or 3 dimensions may be specified");this._dimensionsToTest=n}}};Zp.prototype.compare=function(e,n){var r=e,i=n,o=Zp.compare(r.x,i.x);if(o!==0)return o;var a=Zp.compare(r.y,i.y);if(a!==0)return a;if(this._dimensionsToTest<=2)return 0;var s=Zp.compare(r.z,i.z);return s};Zp.prototype.interfaces_=function(){return[qv]};Zp.prototype.getClass=function(){return Zp};Zp.compare=function(e,n){return e<n?-1:e>n?1:mr.isNaN(e)?mr.isNaN(n)?0:-1:mr.isNaN(n)?1:0};var Xv=function(){};Xv.prototype.create=function(){};Xv.prototype.interfaces_=function(){return[]};Xv.prototype.getClass=function(){return Xv};var Et=function(){},JE={INTERIOR:{configurable:!0},BOUNDARY:{configurable:!0},EXTERIOR:{configurable:!0},NONE:{configurable:!0}};Et.prototype.interfaces_=function(){return[]};Et.prototype.getClass=function(){return Et};Et.toLocationSymbol=function(e){switch(e){case Et.EXTERIOR:return"e";case Et.BOUNDARY:return"b";case Et.INTERIOR:return"i";case Et.NONE:return"-"}throw new oo("Unknown location value: "+e)};JE.INTERIOR.get=function(){return 0};JE.BOUNDARY.get=function(){return 1};JE.EXTERIOR.get=function(){return 2};JE.NONE.get=function(){return-1};Object.defineProperties(Et,JE);var ar=function(t,e){return t.interfaces_&&t.interfaces_().indexOf(e)>-1},Jl=function(){},rie={LOG_10:{configurable:!0}};Jl.prototype.interfaces_=function(){return[]};Jl.prototype.getClass=function(){return Jl};Jl.log10=function(e){var n=Math.log(e);return mr.isInfinite(n)||mr.isNaN(n)?n:n/Jl.LOG_10};Jl.min=function(e,n,r,i){var o=e;return n<o&&(o=n),r<o&&(o=r),i<o&&(o=i),o};Jl.clamp=function(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],n=arguments[1],r=arguments[2];return e<n?n:e>r?r:e}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var i=arguments[0],o=arguments[1],a=arguments[2];return i<o?o:i>a?a:i}};Jl.wrap=function(e,n){return e<0?n- -e%n:e%n};Jl.max=function(){if(arguments.length===3){var e=arguments[0],n=arguments[1],r=arguments[2],i=e;return n>i&&(i=n),r>i&&(i=r),i}else if(arguments.length===4){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3],d=o;return a>d&&(d=a),s>d&&(d=s),u>d&&(d=u),d}};Jl.average=function(e,n){return(e+n)/2};rie.LOG_10.get=function(){return Math.log(10)};Object.defineProperties(Jl,rie);var Df=function(e){this.str=e};Df.prototype.append=function(e){this.str+=e};Df.prototype.setCharAt=function(e,n){this.str=this.str.substr(0,e)+n+this.str.substr(e+1)};Df.prototype.toString=function(e){return this.str};var bf=function(e){this.value=e};bf.prototype.intValue=function(){return this.value};bf.prototype.compareTo=function(e){return this.value<e?-1:this.value>e?1:0};bf.isNaN=function(e){return Number.isNaN(e)};var Xw=function(){};Xw.isWhitespace=function(e){return e<=32&&e>=0||e===127};Xw.toUpperCase=function(e){return e.toUpperCase()};var Lt=function t(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this.init(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}else if(typeof arguments[0]=="string"){var r=arguments[0];t.call(this,t.parse(r))}}else if(arguments.length===2){var i=arguments[0],o=arguments[1];this.init(i,o)}},Dc={PI:{configurable:!0},TWO_PI:{configurable:!0},PI_2:{configurable:!0},E:{configurable:!0},NaN:{configurable:!0},EPS:{configurable:!0},SPLIT:{configurable:!0},MAX_PRINT_DIGITS:{configurable:!0},TEN:{configurable:!0},ONE:{configurable:!0},SCI_NOT_EXPONENT_CHAR:{configurable:!0},SCI_NOT_ZERO:{configurable:!0}};Lt.prototype.le=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<=e._lo};Lt.prototype.extractSignificantDigits=function(e,n){var r=this.abs(),i=Lt.magnitude(r._hi),o=Lt.TEN.pow(i);r=r.divide(o),r.gt(Lt.TEN)?(r=r.divide(Lt.TEN),i+=1):r.lt(Lt.ONE)&&(r=r.multiply(Lt.TEN),i-=1);for(var a=i+1,s=new Df,u=Lt.MAX_PRINT_DIGITS-1,d=0;d<=u;d++){e&&d===a&&s.append(".");var g=Math.trunc(r._hi);if(g<0)break;var _=!1,E=0;g>9?(_=!0,E="9"):E="0"+g,s.append(E),r=r.subtract(Lt.valueOf(g)).multiply(Lt.TEN),_&&r.selfAdd(Lt.TEN);var P=!0,O=Lt.magnitude(r._hi);if(O<0&&Math.abs(O)>=u-d&&(P=!1),!P)break}return n[0]=i,s.toString()};Lt.prototype.sqr=function(){return this.multiply(this)};Lt.prototype.doubleValue=function(){return this._hi+this._lo};Lt.prototype.subtract=function(){if(arguments[0]instanceof Lt){var e=arguments[0];return this.add(e.negate())}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.add(-n)}};Lt.prototype.equals=function(){if(arguments.length===1){var e=arguments[0];return this._hi===e._hi&&this._lo===e._lo}};Lt.prototype.isZero=function(){return this._hi===0&&this._lo===0};Lt.prototype.selfSubtract=function(){if(arguments[0]instanceof Lt){var e=arguments[0];return this.isNaN()?this:this.selfAdd(-e._hi,-e._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.isNaN()?this:this.selfAdd(-n,0)}};Lt.prototype.getSpecialNumberString=function(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null};Lt.prototype.min=function(e){return this.le(e)?this:e};Lt.prototype.selfDivide=function(){if(arguments.length===1){if(arguments[0]instanceof Lt){var e=arguments[0];return this.selfDivide(e._hi,e._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfDivide(n,0)}}else if(arguments.length===2){var r=arguments[0],i=arguments[1],o=null,a=null,s=null,u=null,d=null,g=null,_=null,E=null;return d=this._hi/r,g=Lt.SPLIT*d,o=g-d,E=Lt.SPLIT*r,o=g-o,a=d-o,s=E-r,_=d*r,s=E-s,u=r-s,E=o*s-_+o*u+a*s+a*u,g=(this._hi-_-E+this._lo-d*i)/r,E=d+g,this._hi=E,this._lo=d-E+g,this}};Lt.prototype.dump=function(){return"DD<"+this._hi+", "+this._lo+">"};Lt.prototype.divide=function(){if(arguments[0]instanceof Lt){var e=arguments[0],n=null,r=null,i=null,o=null,a=null,s=null,u=null,d=null;a=this._hi/e._hi,s=Lt.SPLIT*a,n=s-a,d=Lt.SPLIT*e._hi,n=s-n,r=a-n,i=d-e._hi,u=a*e._hi,i=d-i,o=e._hi-i,d=n*i-u+n*o+r*i+r*o,s=(this._hi-u-d+this._lo-a*e._lo)/e._hi,d=a+s;var g=d,_=a-d+s;return new Lt(g,_)}else if(typeof arguments[0]=="number"){var E=arguments[0];return mr.isNaN(E)?Lt.createNaN():Lt.copy(this).selfDivide(E,0)}};Lt.prototype.ge=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>=e._lo};Lt.prototype.pow=function(e){if(e===0)return Lt.valueOf(1);var n=new Lt(this),r=Lt.valueOf(1),i=Math.abs(e);if(i>1)for(;i>0;)i%2===1&&r.selfMultiply(n),i/=2,i>0&&(n=n.sqr());else r=n;return e<0?r.reciprocal():r};Lt.prototype.ceil=function(){if(this.isNaN())return Lt.NaN;var e=Math.ceil(this._hi),n=0;return e===this._hi&&(n=Math.ceil(this._lo)),new Lt(e,n)};Lt.prototype.compareTo=function(e){var n=e;return this._hi<n._hi?-1:this._hi>n._hi?1:this._lo<n._lo?-1:this._lo>n._lo?1:0};Lt.prototype.rint=function(){if(this.isNaN())return this;var e=this.add(.5);return e.floor()};Lt.prototype.setValue=function(){if(arguments[0]instanceof Lt){var e=arguments[0];return this.init(e),this}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.init(n),this}};Lt.prototype.max=function(e){return this.ge(e)?this:e};Lt.prototype.sqrt=function(){if(this.isZero())return Lt.valueOf(0);if(this.isNegative())return Lt.NaN;var e=1/Math.sqrt(this._hi),n=this._hi*e,r=Lt.valueOf(n),i=this.subtract(r.sqr()),o=i._hi*(e*.5);return r.add(o)};Lt.prototype.selfAdd=function(){if(arguments.length===1){if(arguments[0]instanceof Lt){var e=arguments[0];return this.selfAdd(e._hi,e._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0],r=null,i=null,o=null,a=null,s=null,u=null;return o=this._hi+n,s=o-this._hi,a=o-s,a=n-s+(this._hi-a),u=a+this._lo,r=o+u,i=u+(o-r),this._hi=r+i,this._lo=i+(r-this._hi),this}}else if(arguments.length===2){var d=arguments[0],g=arguments[1],_=null,E=null,P=null,O=null,D=null,V=null,k=null,F=null;D=this._hi+d,P=this._lo+g,k=D-this._hi,F=P-this._lo,V=D-k,O=P-F,V=d-k+(this._hi-V),O=g-F+(this._lo-O),k=V+P,_=D+k,E=k+(D-_),k=O+E;var z=_+k,X=k+(_-z);return this._hi=z,this._lo=X,this}};Lt.prototype.selfMultiply=function(){if(arguments.length===1){if(arguments[0]instanceof Lt){var e=arguments[0];return this.selfMultiply(e._hi,e._lo)}else if(typeof arguments[0]=="number"){var n=arguments[0];return this.selfMultiply(n,0)}}else if(arguments.length===2){var r=arguments[0],i=arguments[1],o=null,a=null,s=null,u=null,d=null,g=null;d=Lt.SPLIT*this._hi,o=d-this._hi,g=Lt.SPLIT*r,o=d-o,a=this._hi-o,s=g-r,d=this._hi*r,s=g-s,u=r-s,g=o*s-d+o*u+a*s+a*u+(this._hi*i+this._lo*r);var _=d+g;o=d-_;var E=g+o;return this._hi=_,this._lo=E,this}};Lt.prototype.selfSqr=function(){return this.selfMultiply(this)};Lt.prototype.floor=function(){if(this.isNaN())return Lt.NaN;var e=Math.floor(this._hi),n=0;return e===this._hi&&(n=Math.floor(this._lo)),new Lt(e,n)};Lt.prototype.negate=function(){return this.isNaN()?this:new Lt(-this._hi,-this._lo)};Lt.prototype.clone=function(){};Lt.prototype.multiply=function(){if(arguments[0]instanceof Lt){var e=arguments[0];return e.isNaN()?Lt.createNaN():Lt.copy(this).selfMultiply(e)}else if(typeof arguments[0]=="number"){var n=arguments[0];return mr.isNaN(n)?Lt.createNaN():Lt.copy(this).selfMultiply(n,0)}};Lt.prototype.isNaN=function(){return mr.isNaN(this._hi)};Lt.prototype.intValue=function(){return Math.trunc(this._hi)};Lt.prototype.toString=function(){var e=Lt.magnitude(this._hi);return e>=-3&&e<=20?this.toStandardNotation():this.toSciNotation()};Lt.prototype.toStandardNotation=function(){var e=this.getSpecialNumberString();if(e!==null)return e;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!0,n),i=n[0]+1,o=r;if(r.charAt(0)===".")o="0"+r;else if(i<0)o="0."+Lt.stringOfChar("0",-i)+r;else if(r.indexOf(".")===-1){var a=i-r.length,s=Lt.stringOfChar("0",a);o=r+s+".0"}return this.isNegative()?"-"+o:o};Lt.prototype.reciprocal=function(){var e=null,n=null,r=null,i=null,o=null,a=null,s=null,u=null;o=1/this._hi,a=Lt.SPLIT*o,e=a-o,u=Lt.SPLIT*this._hi,e=a-e,n=o-e,r=u-this._hi,s=o*this._hi,r=u-r,i=this._hi-r,u=e*r-s+e*i+n*r+n*i,a=(1-s-u-o*this._lo)/this._hi;var d=o+a,g=o-d+a;return new Lt(d,g)};Lt.prototype.toSciNotation=function(){if(this.isZero())return Lt.SCI_NOT_ZERO;var e=this.getSpecialNumberString();if(e!==null)return e;var n=new Array(1).fill(null),r=this.extractSignificantDigits(!1,n),i=Lt.SCI_NOT_EXPONENT_CHAR+n[0];if(r.charAt(0)==="0")throw new Error("Found leading zero: "+r);var o="";r.length>1&&(o=r.substring(1));var a=r.charAt(0)+"."+o;return this.isNegative()?"-"+a+i:a+i};Lt.prototype.abs=function(){return this.isNaN()?Lt.NaN:this.isNegative()?this.negate():new Lt(this)};Lt.prototype.isPositive=function(){return(this._hi>0||this._hi===0)&&this._lo>0};Lt.prototype.lt=function(e){return(this._hi<e._hi||this._hi===e._hi)&&this._lo<e._lo};Lt.prototype.add=function(){if(arguments[0]instanceof Lt){var e=arguments[0];return Lt.copy(this).selfAdd(e)}else if(typeof arguments[0]=="number"){var n=arguments[0];return Lt.copy(this).selfAdd(n)}};Lt.prototype.init=function(){if(arguments.length===1){if(typeof arguments[0]=="number"){var e=arguments[0];this._hi=e,this._lo=0}else if(arguments[0]instanceof Lt){var n=arguments[0];this._hi=n._hi,this._lo=n._lo}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this._hi=r,this._lo=i}};Lt.prototype.gt=function(e){return(this._hi>e._hi||this._hi===e._hi)&&this._lo>e._lo};Lt.prototype.isNegative=function(){return(this._hi<0||this._hi===0)&&this._lo<0};Lt.prototype.trunc=function(){return this.isNaN()?Lt.NaN:this.isPositive()?this.floor():this.ceil()};Lt.prototype.signum=function(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0};Lt.prototype.interfaces_=function(){return[Gu,Uu,pR]};Lt.prototype.getClass=function(){return Lt};Lt.sqr=function(e){return Lt.valueOf(e).selfMultiply(e)};Lt.valueOf=function(){if(typeof arguments[0]=="string"){var e=arguments[0];return Lt.parse(e)}else if(typeof arguments[0]=="number"){var n=arguments[0];return new Lt(n)}};Lt.sqrt=function(e){return Lt.valueOf(e).sqrt()};Lt.parse=function(e){for(var n=0,r=e.length;Xw.isWhitespace(e.charAt(n));)n++;var i=!1;if(n<r){var o=e.charAt(n);(o==="-"||o==="+")&&(n++,o==="-"&&(i=!0))}for(var a=new Lt,s=0,u=0,d=0;!(n>=r);){var g=e.charAt(n);if(n++,Xw.isDigit(g)){var _=g-"0";a.selfMultiply(Lt.TEN),a.selfAdd(_),s++;continue}if(g==="."){u=s;continue}if(g==="e"||g==="E"){var E=e.substring(n);try{d=bf.parseInt(E)}catch(k){throw k instanceof Error?new Error("Invalid exponent "+E+" in string "+e):k}finally{}break}throw new Error("Unexpected character '"+g+"' at position "+n+" in string "+e)}var P=a,O=s-u-d;if(O===0)P=a;else if(O>0){var D=Lt.TEN.pow(O);P=a.divide(D)}else if(O<0){var V=Lt.TEN.pow(-O);P=a.multiply(V)}return i?P.negate():P};Lt.createNaN=function(){return new Lt(mr.NaN,mr.NaN)};Lt.copy=function(e){return new Lt(e)};Lt.magnitude=function(e){var n=Math.abs(e),r=Math.log(n)/Math.log(10),i=Math.trunc(Math.floor(r)),o=Math.pow(10,i);return o*10<=n&&(i+=1),i};Lt.stringOfChar=function(e,n){for(var r=new Df,i=0;i<n;i++)r.append(e);return r.toString()};Dc.PI.get=function(){return new Lt(3.141592653589793,12246467991473532e-32)};Dc.TWO_PI.get=function(){return new Lt(6.283185307179586,24492935982947064e-32)};Dc.PI_2.get=function(){return new Lt(1.5707963267948966,6123233995736766e-32)};Dc.E.get=function(){return new Lt(2.718281828459045,14456468917292502e-32)};Dc.NaN.get=function(){return new Lt(mr.NaN,mr.NaN)};Dc.EPS.get=function(){return 123259516440783e-46};Dc.SPLIT.get=function(){return 134217729};Dc.MAX_PRINT_DIGITS.get=function(){return 32};Dc.TEN.get=function(){return Lt.valueOf(10)};Dc.ONE.get=function(){return Lt.valueOf(1)};Dc.SCI_NOT_EXPONENT_CHAR.get=function(){return"E"};Dc.SCI_NOT_ZERO.get=function(){return"0.0E0"};Object.defineProperties(Lt,Dc);var qa=function(){},iie={DP_SAFE_EPSILON:{configurable:!0}};qa.prototype.interfaces_=function(){return[]};qa.prototype.getClass=function(){return qa};qa.orientationIndex=function(e,n,r){var i=qa.orientationIndexFilter(e,n,r);if(i<=1)return i;var o=Lt.valueOf(n.x).selfAdd(-e.x),a=Lt.valueOf(n.y).selfAdd(-e.y),s=Lt.valueOf(r.x).selfAdd(-n.x),u=Lt.valueOf(r.y).selfAdd(-n.y);return o.selfMultiply(u).selfSubtract(a.selfMultiply(s)).signum()};qa.signOfDet2x2=function(e,n,r,i){var o=e.multiply(i).selfSubtract(n.multiply(r));return o.signum()};qa.intersection=function(e,n,r,i){var o=Lt.valueOf(i.y).selfSubtract(r.y).selfMultiply(Lt.valueOf(n.x).selfSubtract(e.x)),a=Lt.valueOf(i.x).selfSubtract(r.x).selfMultiply(Lt.valueOf(n.y).selfSubtract(e.y)),s=o.subtract(a),u=Lt.valueOf(i.x).selfSubtract(r.x).selfMultiply(Lt.valueOf(e.y).selfSubtract(r.y)),d=Lt.valueOf(i.y).selfSubtract(r.y).selfMultiply(Lt.valueOf(e.x).selfSubtract(r.x)),g=u.subtract(d),_=g.selfDivide(s).doubleValue(),E=Lt.valueOf(e.x).selfAdd(Lt.valueOf(n.x).selfSubtract(e.x).selfMultiply(_)).doubleValue(),P=Lt.valueOf(n.x).selfSubtract(e.x).selfMultiply(Lt.valueOf(e.y).selfSubtract(r.y)),O=Lt.valueOf(n.y).selfSubtract(e.y).selfMultiply(Lt.valueOf(e.x).selfSubtract(r.x)),D=P.subtract(O),V=D.selfDivide(s).doubleValue(),k=Lt.valueOf(r.y).selfAdd(Lt.valueOf(i.y).selfSubtract(r.y).selfMultiply(V)).doubleValue();return new dt(E,k)};qa.orientationIndexFilter=function(e,n,r){var i=null,o=(e.x-r.x)*(n.y-r.y),a=(e.y-r.y)*(n.x-r.x),s=o-a;if(o>0){if(a<=0)return qa.signum(s);i=o+a}else if(o<0){if(a>=0)return qa.signum(s);i=-o-a}else return qa.signum(s);var u=qa.DP_SAFE_EPSILON*i;return s>=u||-s>=u?qa.signum(s):2};qa.signum=function(e){return e>0?1:e<0?-1:0};iie.DP_SAFE_EPSILON.get=function(){return 1e-15};Object.defineProperties(qa,iie);var Yr=function(){},e2={X:{configurable:!0},Y:{configurable:!0},Z:{configurable:!0},M:{configurable:!0}};e2.X.get=function(){return 0};e2.Y.get=function(){return 1};e2.Z.get=function(){return 2};e2.M.get=function(){return 3};Yr.prototype.setOrdinate=function(e,n,r){};Yr.prototype.size=function(){};Yr.prototype.getOrdinate=function(e,n){};Yr.prototype.getCoordinate=function(){};Yr.prototype.getCoordinateCopy=function(e){};Yr.prototype.getDimension=function(){};Yr.prototype.getX=function(e){};Yr.prototype.clone=function(){};Yr.prototype.expandEnvelope=function(e){};Yr.prototype.copy=function(){};Yr.prototype.getY=function(e){};Yr.prototype.toCoordinateArray=function(){};Yr.prototype.interfaces_=function(){return[pR]};Yr.prototype.getClass=function(){return Yr};Object.defineProperties(Yr,e2);var oie=function(){},U1=function(t){function e(){t.call(this,"Projective point not representable on the Cartesian plane.")}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(oie),qs=function(){};qs.arraycopy=function(e,n,r,i,o){for(var a=0,s=n;s<n+o;s++)r[i+a]=e[s],a++};qs.getProperty=function(e){return{"line.separator":`
`}[e]};var mc=function t(){if(this.x=null,this.y=null,this.w=null,arguments.length===0)this.x=0,this.y=0,this.w=1;else if(arguments.length===1){var e=arguments[0];this.x=e.x,this.y=e.y,this.w=1}else if(arguments.length===2){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var n=arguments[0],r=arguments[1];this.x=n,this.y=r,this.w=1}else if(arguments[0]instanceof t&&arguments[1]instanceof t){var i=arguments[0],o=arguments[1];this.x=i.y*o.w-o.y*i.w,this.y=o.x*i.w-i.x*o.w,this.w=i.x*o.y-o.x*i.y}else if(arguments[0]instanceof dt&&arguments[1]instanceof dt){var a=arguments[0],s=arguments[1];this.x=a.y-s.y,this.y=s.x-a.x,this.w=a.x*s.y-s.x*a.y}}else if(arguments.length===3){var u=arguments[0],d=arguments[1],g=arguments[2];this.x=u,this.y=d,this.w=g}else if(arguments.length===4){var _=arguments[0],E=arguments[1],P=arguments[2],O=arguments[3],D=_.y-E.y,V=E.x-_.x,k=_.x*E.y-E.x*_.y,F=P.y-O.y,z=O.x-P.x,X=P.x*O.y-O.x*P.y;this.x=V*X-z*k,this.y=F*k-D*X,this.w=D*z-F*V}};mc.prototype.getY=function(){var e=this.y/this.w;if(mr.isNaN(e)||mr.isInfinite(e))throw new U1;return e};mc.prototype.getX=function(){var e=this.x/this.w;if(mr.isNaN(e)||mr.isInfinite(e))throw new U1;return e};mc.prototype.getCoordinate=function(){var e=new dt;return e.x=this.getX(),e.y=this.getY(),e};mc.prototype.interfaces_=function(){return[]};mc.prototype.getClass=function(){return mc};mc.intersection=function(e,n,r,i){var o=e.y-n.y,a=n.x-e.x,s=e.x*n.y-n.x*e.y,u=r.y-i.y,d=i.x-r.x,g=r.x*i.y-i.x*r.y,_=a*g-d*s,E=u*s-o*g,P=o*d-u*a,O=_/P,D=E/P;if(mr.isNaN(O)||mr.isInfinite(O)||mr.isNaN(D)||mr.isInfinite(D))throw new U1;return new dt(O,D)};var Qn=function t(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof dt){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof t){var n=arguments[0];this.init(n)}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this.init(r.x,i.x,r.y,i.y)}else if(arguments.length===4){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3];this.init(o,a,s,u)}},sie={serialVersionUID:{configurable:!0}};Qn.prototype.getArea=function(){return this.getWidth()*this.getHeight()};Qn.prototype.equals=function(e){if(!(e instanceof Qn))return!1;var n=e;return this.isNull()?n.isNull():this._maxx===n.getMaxX()&&this._maxy===n.getMaxY()&&this._minx===n.getMinX()&&this._miny===n.getMinY()};Qn.prototype.intersection=function(e){if(this.isNull()||e.isNull()||!this.intersects(e))return new Qn;var n=this._minx>e._minx?this._minx:e._minx,r=this._miny>e._miny?this._miny:e._miny,i=this._maxx<e._maxx?this._maxx:e._maxx,o=this._maxy<e._maxy?this._maxy:e._maxy;return new Qn(n,i,r,o)};Qn.prototype.isNull=function(){return this._maxx<this._minx};Qn.prototype.getMaxX=function(){return this._maxx};Qn.prototype.covers=function(){if(arguments.length===1){if(arguments[0]instanceof dt){var e=arguments[0];return this.covers(e.x,e.y)}else if(arguments[0]instanceof Qn){var n=arguments[0];return this.isNull()||n.isNull()?!1:n.getMinX()>=this._minx&&n.getMaxX()<=this._maxx&&n.getMinY()>=this._miny&&n.getMaxY()<=this._maxy}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];return this.isNull()?!1:r>=this._minx&&r<=this._maxx&&i>=this._miny&&i<=this._maxy}};Qn.prototype.intersects=function(){if(arguments.length===1){if(arguments[0]instanceof Qn){var e=arguments[0];return this.isNull()||e.isNull()?!1:!(e._minx>this._maxx||e._maxx<this._minx||e._miny>this._maxy||e._maxy<this._miny)}else if(arguments[0]instanceof dt){var n=arguments[0];return this.intersects(n.x,n.y)}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];return this.isNull()?!1:!(r>this._maxx||r<this._minx||i>this._maxy||i<this._miny)}};Qn.prototype.getMinY=function(){return this._miny};Qn.prototype.getMinX=function(){return this._minx};Qn.prototype.expandToInclude=function(){if(arguments.length===1){if(arguments[0]instanceof dt){var e=arguments[0];this.expandToInclude(e.x,e.y)}else if(arguments[0]instanceof Qn){var n=arguments[0];if(n.isNull())return null;this.isNull()?(this._minx=n.getMinX(),this._maxx=n.getMaxX(),this._miny=n.getMinY(),this._maxy=n.getMaxY()):(n._minx<this._minx&&(this._minx=n._minx),n._maxx>this._maxx&&(this._maxx=n._maxx),n._miny<this._miny&&(this._miny=n._miny),n._maxy>this._maxy&&(this._maxy=n._maxy))}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this.isNull()?(this._minx=r,this._maxx=r,this._miny=i,this._maxy=i):(r<this._minx&&(this._minx=r),r>this._maxx&&(this._maxx=r),i<this._miny&&(this._miny=i),i>this._maxy&&(this._maxy=i))}};Qn.prototype.minExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),n=this.getHeight();return e<n?e:n};Qn.prototype.getWidth=function(){return this.isNull()?0:this._maxx-this._minx};Qn.prototype.compareTo=function(e){var n=e;return this.isNull()?n.isNull()?0:-1:n.isNull()?1:this._minx<n._minx?-1:this._minx>n._minx?1:this._miny<n._miny?-1:this._miny>n._miny?1:this._maxx<n._maxx?-1:this._maxx>n._maxx?1:this._maxy<n._maxy?-1:this._maxy>n._maxy?1:0};Qn.prototype.translate=function(e,n){if(this.isNull())return null;this.init(this.getMinX()+e,this.getMaxX()+e,this.getMinY()+n,this.getMaxY()+n)};Qn.prototype.toString=function(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"};Qn.prototype.setToNull=function(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1};Qn.prototype.getHeight=function(){return this.isNull()?0:this._maxy-this._miny};Qn.prototype.maxExtent=function(){if(this.isNull())return 0;var e=this.getWidth(),n=this.getHeight();return e>n?e:n};Qn.prototype.expandBy=function(){if(arguments.length===1){var e=arguments[0];this.expandBy(e,e)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this.isNull())return null;this._minx-=n,this._maxx+=n,this._miny-=r,this._maxy+=r,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}};Qn.prototype.contains=function(){if(arguments.length===1){if(arguments[0]instanceof Qn){var e=arguments[0];return this.covers(e)}else if(arguments[0]instanceof dt){var n=arguments[0];return this.covers(n)}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];return this.covers(r,i)}};Qn.prototype.centre=function(){return this.isNull()?null:new dt((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)};Qn.prototype.init=function(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof dt){var e=arguments[0];this.init(e.x,e.x,e.y,e.y)}else if(arguments[0]instanceof Qn){var n=arguments[0];this._minx=n._minx,this._maxx=n._maxx,this._miny=n._miny,this._maxy=n._maxy}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this.init(r.x,i.x,r.y,i.y)}else if(arguments.length===4){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3];o<a?(this._minx=o,this._maxx=a):(this._minx=a,this._maxx=o),s<u?(this._miny=s,this._maxy=u):(this._miny=u,this._maxy=s)}};Qn.prototype.getMaxY=function(){return this._maxy};Qn.prototype.distance=function(e){if(this.intersects(e))return 0;var n=0;this._maxx<e._minx?n=e._minx-this._maxx:this._minx>e._maxx&&(n=this._minx-e._maxx);var r=0;return this._maxy<e._miny?r=e._miny-this._maxy:this._miny>e._maxy&&(r=this._miny-e._maxy),n===0?r:r===0?n:Math.sqrt(n*n+r*r)};Qn.prototype.hashCode=function(){var e=17;return e=37*e+dt.hashCode(this._minx),e=37*e+dt.hashCode(this._maxx),e=37*e+dt.hashCode(this._miny),e=37*e+dt.hashCode(this._maxy),e};Qn.prototype.interfaces_=function(){return[Uu,Gu]};Qn.prototype.getClass=function(){return Qn};Qn.intersects=function(){if(arguments.length===3){var e=arguments[0],n=arguments[1],r=arguments[2];return r.x>=(e.x<n.x?e.x:n.x)&&r.x<=(e.x>n.x?e.x:n.x)&&r.y>=(e.y<n.y?e.y:n.y)&&r.y<=(e.y>n.y?e.y:n.y)}else if(arguments.length===4){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],u=Math.min(a.x,s.x),d=Math.max(a.x,s.x),g=Math.min(i.x,o.x),_=Math.max(i.x,o.x);return!(g>d||_<u||(u=Math.min(a.y,s.y),d=Math.max(a.y,s.y),g=Math.min(i.y,o.y),_=Math.max(i.y,o.y),g>d)||_<u)}};sie.serialVersionUID.get=function(){return 5873921885273102e3};Object.defineProperties(Qn,sie);var Jc={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,emptyTypeStr:/^\s*(\w+)\s*EMPTY\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},gR=function(e){this.geometryFactory=e||new kr};gR.prototype.read=function(e){var n,r,i;e=e.replace(/[\n\r]/g," ");var o=Jc.typeStr.exec(e);if(e.search("EMPTY")!==-1&&(o=Jc.emptyTypeStr.exec(e),o[2]=void 0),o&&(r=o[1].toLowerCase(),i=o[2],ov[r]&&(n=ov[r].apply(this,[i]))),n===void 0)throw new Error("Could not parse WKT "+e);return n};gR.prototype.write=function(e){return this.extractGeometry(e)};gR.prototype.extractGeometry=function(e){var n=e.getGeometryType().toLowerCase();if(!bd[n])return null;var r=n.toUpperCase(),i;return e.isEmpty()?i=r+" EMPTY":i=r+"("+bd[n].apply(this,[e])+")",i};var bd={coordinate:function(e){return e.x+" "+e.y},point:function(e){return bd.coordinate.call(this,e._coordinates._coordinates[0])},multipoint:function(e){for(var n=this,r=[],i=0,o=e._geometries.length;i<o;++i)r.push("("+bd.point.apply(n,[e._geometries[i]])+")");return r.join(",")},linestring:function(e){for(var n=this,r=[],i=0,o=e._points._coordinates.length;i<o;++i)r.push(bd.coordinate.apply(n,[e._points._coordinates[i]]));return r.join(",")},linearring:function(e){for(var n=this,r=[],i=0,o=e._points._coordinates.length;i<o;++i)r.push(bd.coordinate.apply(n,[e._points._coordinates[i]]));return r.join(",")},multilinestring:function(e){for(var n=this,r=[],i=0,o=e._geometries.length;i<o;++i)r.push("("+bd.linestring.apply(n,[e._geometries[i]])+")");return r.join(",")},polygon:function(e){var n=this,r=[];r.push("("+bd.linestring.apply(this,[e._shell])+")");for(var i=0,o=e._holes.length;i<o;++i)r.push("("+bd.linestring.apply(n,[e._holes[i]])+")");return r.join(",")},multipolygon:function(e){for(var n=this,r=[],i=0,o=e._geometries.length;i<o;++i)r.push("("+bd.polygon.apply(n,[e._geometries[i]])+")");return r.join(",")},geometrycollection:function(e){for(var n=this,r=[],i=0,o=e._geometries.length;i<o;++i)r.push(n.extractGeometry(e._geometries[i]));return r.join(",")}},ov={point:function(e){if(e===void 0)return this.geometryFactory.createPoint();var n=e.trim().split(Jc.spaces);return this.geometryFactory.createPoint(new dt(Number.parseFloat(n[0]),Number.parseFloat(n[1])))},multipoint:function(e){var n=this;if(e===void 0)return this.geometryFactory.createMultiPoint();for(var r,i=e.trim().split(","),o=[],a=0,s=i.length;a<s;++a)r=i[a].replace(Jc.trimParens,"$1"),o.push(ov.point.apply(n,[r]));return this.geometryFactory.createMultiPoint(o)},linestring:function(e){if(e===void 0)return this.geometryFactory.createLineString();for(var n=e.trim().split(","),r=[],i,o=0,a=n.length;o<a;++o)i=n[o].trim().split(Jc.spaces),r.push(new dt(Number.parseFloat(i[0]),Number.parseFloat(i[1])));return this.geometryFactory.createLineString(r)},linearring:function(e){if(e===void 0)return this.geometryFactory.createLinearRing();for(var n=e.trim().split(","),r=[],i,o=0,a=n.length;o<a;++o)i=n[o].trim().split(Jc.spaces),r.push(new dt(Number.parseFloat(i[0]),Number.parseFloat(i[1])));return this.geometryFactory.createLinearRing(r)},multilinestring:function(e){var n=this;if(e===void 0)return this.geometryFactory.createMultiLineString();for(var r,i=e.trim().split(Jc.parenComma),o=[],a=0,s=i.length;a<s;++a)r=i[a].replace(Jc.trimParens,"$1"),o.push(ov.linestring.apply(n,[r]));return this.geometryFactory.createMultiLineString(o)},polygon:function(e){var n=this;if(e===void 0)return this.geometryFactory.createPolygon();for(var r,i,o,a=e.trim().split(Jc.parenComma),s,u=[],d=0,g=a.length;d<g;++d)r=a[d].replace(Jc.trimParens,"$1"),i=ov.linestring.apply(n,[r]),o=n.geometryFactory.createLinearRing(i._points),d===0?s=o:u.push(o);return this.geometryFactory.createPolygon(s,u)},multipolygon:function(e){var n=this;if(e===void 0)return this.geometryFactory.createMultiPolygon();for(var r,i=e.trim().split(Jc.doubleParenComma),o=[],a=0,s=i.length;a<s;++a)r=i[a].replace(Jc.trimParens,"$1"),o.push(ov.polygon.apply(n,[r]));return this.geometryFactory.createMultiPolygon(o)},geometrycollection:function(e){var n=this;if(e===void 0)return this.geometryFactory.createGeometryCollection();e=e.replace(/,\s*([A-Za-z])/g,"|$1");for(var r=e.trim().split("|"),i=[],o=0,a=r.length;o<a;++o)i.push(n.read(r[o]));return this.geometryFactory.createGeometryCollection(i)}},xc=function(e){this.parser=new gR(e)};xc.prototype.write=function(e){return this.parser.write(e)};xc.toLineString=function(e,n){if(arguments.length!==2)throw new Error("Not implemented");return"LINESTRING ( "+e.x+" "+e.y+", "+n.x+" "+n.y+" )"};var $d=function(t){function e(n){t.call(this,n),this.name="RuntimeException",this.message=n,this.stack=new t().stack}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(Error),PI=function(t){function e(){if(t.call(this),arguments.length===0)t.call(this);else if(arguments.length===1){var n=arguments[0];t.call(this,n)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}($d),Pr=function(){};Pr.prototype.interfaces_=function(){return[]};Pr.prototype.getClass=function(){return Pr};Pr.shouldNeverReachHere=function(){if(arguments.length===0)Pr.shouldNeverReachHere(null);else if(arguments.length===1){var e=arguments[0];throw new PI("Should never reach here"+(e!==null?": "+e:""))}};Pr.isTrue=function(){var e,n;if(arguments.length===1)e=arguments[0],Pr.isTrue(e,null);else if(arguments.length===2&&(e=arguments[0],n=arguments[1],!e))throw n===null?new PI:new PI(n)};Pr.equals=function(){var e,n,r;if(arguments.length===2)e=arguments[0],n=arguments[1],Pr.equals(e,n,null);else if(arguments.length===3&&(e=arguments[0],n=arguments[1],r=arguments[2],!n.equals(e)))throw new PI("Expected "+e+" but encountered "+n+(r!==null?": "+r:""))};var ho=function(){this._result=null,this._inputLines=Array(2).fill().map(function(){return Array(2)}),this._intPt=new Array(2).fill(null),this._intLineIndex=null,this._isProper=null,this._pa=null,this._pb=null,this._precisionModel=null,this._intPt[0]=new dt,this._intPt[1]=new dt,this._pa=this._intPt[0],this._pb=this._intPt[1],this._result=0},__={DONT_INTERSECT:{configurable:!0},DO_INTERSECT:{configurable:!0},COLLINEAR:{configurable:!0},NO_INTERSECTION:{configurable:!0},POINT_INTERSECTION:{configurable:!0},COLLINEAR_INTERSECTION:{configurable:!0}};ho.prototype.getIndexAlongSegment=function(e,n){return this.computeIntLineIndex(),this._intLineIndex[e][n]};ho.prototype.getTopologySummary=function(){var e=new Df;return this.isEndPoint()&&e.append(" endpoint"),this._isProper&&e.append(" proper"),this.isCollinear()&&e.append(" collinear"),e.toString()};ho.prototype.computeIntersection=function(e,n,r,i){this._inputLines[0][0]=e,this._inputLines[0][1]=n,this._inputLines[1][0]=r,this._inputLines[1][1]=i,this._result=this.computeIntersect(e,n,r,i)};ho.prototype.getIntersectionNum=function(){return this._result};ho.prototype.computeIntLineIndex=function(){if(arguments.length===0)this._intLineIndex===null&&(this._intLineIndex=Array(2).fill().map(function(){return Array(2)}),this.computeIntLineIndex(0),this.computeIntLineIndex(1));else if(arguments.length===1){var e=arguments[0],n=this.getEdgeDistance(e,0),r=this.getEdgeDistance(e,1);n>r?(this._intLineIndex[e][0]=0,this._intLineIndex[e][1]=1):(this._intLineIndex[e][0]=1,this._intLineIndex[e][1]=0)}};ho.prototype.isProper=function(){return this.hasIntersection()&&this._isProper};ho.prototype.setPrecisionModel=function(e){this._precisionModel=e};ho.prototype.isInteriorIntersection=function(){var e=this;if(arguments.length===0)return!!(this.isInteriorIntersection(0)||this.isInteriorIntersection(1));if(arguments.length===1){for(var n=arguments[0],r=0;r<this._result;r++)if(!(e._intPt[r].equals2D(e._inputLines[n][0])||e._intPt[r].equals2D(e._inputLines[n][1])))return!0;return!1}};ho.prototype.getIntersection=function(e){return this._intPt[e]};ho.prototype.isEndPoint=function(){return this.hasIntersection()&&!this._isProper};ho.prototype.hasIntersection=function(){return this._result!==ho.NO_INTERSECTION};ho.prototype.getEdgeDistance=function(e,n){var r=ho.computeEdgeDistance(this._intPt[n],this._inputLines[e][0],this._inputLines[e][1]);return r};ho.prototype.isCollinear=function(){return this._result===ho.COLLINEAR_INTERSECTION};ho.prototype.toString=function(){return xc.toLineString(this._inputLines[0][0],this._inputLines[0][1])+" - "+xc.toLineString(this._inputLines[1][0],this._inputLines[1][1])+this.getTopologySummary()};ho.prototype.getEndpoint=function(e,n){return this._inputLines[e][n]};ho.prototype.isIntersection=function(e){for(var n=this,r=0;r<this._result;r++)if(n._intPt[r].equals2D(e))return!0;return!1};ho.prototype.getIntersectionAlongSegment=function(e,n){return this.computeIntLineIndex(),this._intPt[this._intLineIndex[e][n]]};ho.prototype.interfaces_=function(){return[]};ho.prototype.getClass=function(){return ho};ho.computeEdgeDistance=function(e,n,r){var i=Math.abs(r.x-n.x),o=Math.abs(r.y-n.y),a=-1;if(e.equals(n))a=0;else if(e.equals(r))i>o?a=i:a=o;else{var s=Math.abs(e.x-n.x),u=Math.abs(e.y-n.y);i>o?a=s:a=u,a===0&&!e.equals(n)&&(a=Math.max(s,u))}return Pr.isTrue(!(a===0&&!e.equals(n)),"Bad distance calculation"),a};ho.nonRobustComputeEdgeDistance=function(e,n,r){var i=e.x-n.x,o=e.y-n.y,a=Math.sqrt(i*i+o*o);return Pr.isTrue(!(a===0&&!e.equals(n)),"Invalid distance calculation"),a};__.DONT_INTERSECT.get=function(){return 0};__.DO_INTERSECT.get=function(){return 1};__.COLLINEAR.get=function(){return 2};__.NO_INTERSECTION.get=function(){return 0};__.POINT_INTERSECTION.get=function(){return 1};__.COLLINEAR_INTERSECTION.get=function(){return 2};Object.defineProperties(ho,__);var bA=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isInSegmentEnvelopes=function(r){var i=new Qn(this._inputLines[0][0],this._inputLines[0][1]),o=new Qn(this._inputLines[1][0],this._inputLines[1][1]);return i.contains(r)&&o.contains(r)},e.prototype.computeIntersection=function(){if(arguments.length===3){var r=arguments[0],i=arguments[1],o=arguments[2];if(this._isProper=!1,Qn.intersects(i,o,r)&&Rn.orientationIndex(i,o,r)===0&&Rn.orientationIndex(o,i,r)===0)return this._isProper=!0,(r.equals(i)||r.equals(o))&&(this._isProper=!1),this._result=t.POINT_INTERSECTION,null;this._result=t.NO_INTERSECTION}else return t.prototype.computeIntersection.apply(this,arguments)},e.prototype.normalizeToMinimum=function(r,i,o,a,s){s.x=this.smallestInAbsValue(r.x,i.x,o.x,a.x),s.y=this.smallestInAbsValue(r.y,i.y,o.y,a.y),r.x-=s.x,r.y-=s.y,i.x-=s.x,i.y-=s.y,o.x-=s.x,o.y-=s.y,a.x-=s.x,a.y-=s.y},e.prototype.safeHCoordinateIntersection=function(r,i,o,a){var s=null;try{s=mc.intersection(r,i,o,a)}catch(u){if(u instanceof U1)s=e.nearestEndpoint(r,i,o,a);else throw u}finally{}return s},e.prototype.intersection=function(r,i,o,a){var s=this.intersectionWithNormalization(r,i,o,a);return this.isInSegmentEnvelopes(s)||(s=new dt(e.nearestEndpoint(r,i,o,a))),this._precisionModel!==null&&this._precisionModel.makePrecise(s),s},e.prototype.smallestInAbsValue=function(r,i,o,a){var s=r,u=Math.abs(s);return Math.abs(i)<u&&(s=i,u=Math.abs(i)),Math.abs(o)<u&&(s=o,u=Math.abs(o)),Math.abs(a)<u&&(s=a),s},e.prototype.checkDD=function(r,i,o,a,s){var u=qa.intersection(r,i,o,a),d=this.isInSegmentEnvelopes(u);qs.out.println("DD in env = "+d+"  --------------------- "+u),s.distance(u)>1e-4&&qs.out.println("Distance = "+s.distance(u))},e.prototype.intersectionWithNormalization=function(r,i,o,a){var s=new dt(r),u=new dt(i),d=new dt(o),g=new dt(a),_=new dt;this.normalizeToEnvCentre(s,u,d,g,_);var E=this.safeHCoordinateIntersection(s,u,d,g);return E.x+=_.x,E.y+=_.y,E},e.prototype.computeCollinearIntersection=function(r,i,o,a){var s=Qn.intersects(r,i,o),u=Qn.intersects(r,i,a),d=Qn.intersects(o,a,r),g=Qn.intersects(o,a,i);return s&&u?(this._intPt[0]=o,this._intPt[1]=a,t.COLLINEAR_INTERSECTION):d&&g?(this._intPt[0]=r,this._intPt[1]=i,t.COLLINEAR_INTERSECTION):s&&d?(this._intPt[0]=o,this._intPt[1]=r,o.equals(r)&&!u&&!g?t.POINT_INTERSECTION:t.COLLINEAR_INTERSECTION):s&&g?(this._intPt[0]=o,this._intPt[1]=i,o.equals(i)&&!u&&!d?t.POINT_INTERSECTION:t.COLLINEAR_INTERSECTION):u&&d?(this._intPt[0]=a,this._intPt[1]=r,a.equals(r)&&!s&&!g?t.POINT_INTERSECTION:t.COLLINEAR_INTERSECTION):u&&g?(this._intPt[0]=a,this._intPt[1]=i,a.equals(i)&&!s&&!d?t.POINT_INTERSECTION:t.COLLINEAR_INTERSECTION):t.NO_INTERSECTION},e.prototype.normalizeToEnvCentre=function(r,i,o,a,s){var u=r.x<i.x?r.x:i.x,d=r.y<i.y?r.y:i.y,g=r.x>i.x?r.x:i.x,_=r.y>i.y?r.y:i.y,E=o.x<a.x?o.x:a.x,P=o.y<a.y?o.y:a.y,O=o.x>a.x?o.x:a.x,D=o.y>a.y?o.y:a.y,V=u>E?u:E,k=g<O?g:O,F=d>P?d:P,z=_<D?_:D,X=(V+k)/2,Y=(F+z)/2;s.x=X,s.y=Y,r.x-=s.x,r.y-=s.y,i.x-=s.x,i.y-=s.y,o.x-=s.x,o.y-=s.y,a.x-=s.x,a.y-=s.y},e.prototype.computeIntersect=function(r,i,o,a){if(this._isProper=!1,!Qn.intersects(r,i,o,a))return t.NO_INTERSECTION;var s=Rn.orientationIndex(r,i,o),u=Rn.orientationIndex(r,i,a);if(s>0&&u>0||s<0&&u<0)return t.NO_INTERSECTION;var d=Rn.orientationIndex(o,a,r),g=Rn.orientationIndex(o,a,i);if(d>0&&g>0||d<0&&g<0)return t.NO_INTERSECTION;var _=s===0&&u===0&&d===0&&g===0;return _?this.computeCollinearIntersection(r,i,o,a):(s===0||u===0||d===0||g===0?(this._isProper=!1,r.equals2D(o)||r.equals2D(a)?this._intPt[0]=r:i.equals2D(o)||i.equals2D(a)?this._intPt[0]=i:s===0?this._intPt[0]=new dt(o):u===0?this._intPt[0]=new dt(a):d===0?this._intPt[0]=new dt(r):g===0&&(this._intPt[0]=new dt(i))):(this._isProper=!0,this._intPt[0]=this.intersection(r,i,o,a)),t.POINT_INTERSECTION)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.nearestEndpoint=function(r,i,o,a){var s=r,u=Rn.distancePointLine(r,o,a),d=Rn.distancePointLine(i,o,a);return d<u&&(u=d,s=i),d=Rn.distancePointLine(o,r,i),d<u&&(u=d,s=o),d=Rn.distancePointLine(a,r,i),d<u&&(u=d,s=a),s},e}(ho),$0=function(){};$0.prototype.interfaces_=function(){return[]};$0.prototype.getClass=function(){return $0};$0.orientationIndex=function(e,n,r){var i=n.x-e.x,o=n.y-e.y,a=r.x-n.x,s=r.y-n.y;return $0.signOfDet2x2(i,o,a,s)};$0.signOfDet2x2=function(e,n,r,i){var o=null,a=null,s=null;if(o=1,e===0||i===0)return n===0||r===0?0:n>0?r>0?-o:o:r>0?o:-o;if(n===0||r===0)return i>0?e>0?o:-o:e>0?-o:o;if(n>0?i>0?n<=i||(o=-o,a=e,e=r,r=a,a=n,n=i,i=a):n<=-i?(o=-o,r=-r,i=-i):(a=e,e=-r,r=a,a=n,n=-i,i=a):i>0?-n<=i?(o=-o,e=-e,n=-n):(a=-e,e=r,r=a,a=-n,n=i,i=a):n>=i?(e=-e,n=-n,r=-r,i=-i):(o=-o,a=-e,e=-r,r=a,a=-n,n=-i,i=a),e>0)if(r>0){if(!(e<=r))return o}else return o;else{if(r>0)return-o;if(e>=r)o=-o,e=-e,r=-r;else return-o}for(;;){if(s=Math.floor(r/e),r=r-s*e,i=i-s*n,i<0)return-o;if(i>n)return o;if(e>r+r){if(n<i+i)return o}else{if(n>i+i)return-o;r=e-r,i=n-i,o=-o}if(i===0)return r===0?0:-o;if(r===0||(s=Math.floor(e/r),e=e-s*r,n=n-s*i,n<0))return o;if(n>i)return-o;if(r>e+e){if(i<n+n)return-o}else{if(i>n+n)return o;e=r-e,n=i-n,o=-o}if(n===0)return e===0?0:o;if(e===0)return-o}};var mf=function(){this._p=null,this._crossingCount=0,this._isPointOnSegment=!1;var e=arguments[0];this._p=e};mf.prototype.countSegment=function(e,n){if(e.x<this._p.x&&n.x<this._p.x)return null;if(this._p.x===n.x&&this._p.y===n.y)return this._isPointOnSegment=!0,null;if(e.y===this._p.y&&n.y===this._p.y){var r=e.x,i=n.x;return r>i&&(r=n.x,i=e.x),this._p.x>=r&&this._p.x<=i&&(this._isPointOnSegment=!0),null}if(e.y>this._p.y&&n.y<=this._p.y||n.y>this._p.y&&e.y<=this._p.y){var o=e.x-this._p.x,a=e.y-this._p.y,s=n.x-this._p.x,u=n.y-this._p.y,d=$0.signOfDet2x2(o,a,s,u);if(d===0)return this._isPointOnSegment=!0,null;u<a&&(d=-d),d>0&&this._crossingCount++}};mf.prototype.isPointInPolygon=function(){return this.getLocation()!==Et.EXTERIOR};mf.prototype.getLocation=function(){return this._isPointOnSegment?Et.BOUNDARY:this._crossingCount%2===1?Et.INTERIOR:Et.EXTERIOR};mf.prototype.isOnSegment=function(){return this._isPointOnSegment};mf.prototype.interfaces_=function(){return[]};mf.prototype.getClass=function(){return mf};mf.locatePointInRing=function(){if(arguments[0]instanceof dt&&ar(arguments[1],Yr)){for(var e=arguments[0],n=arguments[1],r=new mf(e),i=new dt,o=new dt,a=1;a<n.size();a++)if(n.getCoordinate(a,i),n.getCoordinate(a-1,o),r.countSegment(i,o),r.isOnSegment())return r.getLocation();return r.getLocation()}else if(arguments[0]instanceof dt&&arguments[1]instanceof Array){for(var s=arguments[0],u=arguments[1],d=new mf(s),g=1;g<u.length;g++){var _=u[g],E=u[g-1];if(d.countSegment(_,E),d.isOnSegment())return d.getLocation()}return d.getLocation()}};var Rn=function(){},y_={CLOCKWISE:{configurable:!0},RIGHT:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},LEFT:{configurable:!0},COLLINEAR:{configurable:!0},STRAIGHT:{configurable:!0}};Rn.prototype.interfaces_=function(){return[]};Rn.prototype.getClass=function(){return Rn};Rn.orientationIndex=function(e,n,r){return qa.orientationIndex(e,n,r)};Rn.signedArea=function(){if(arguments[0]instanceof Array){var e=arguments[0];if(e.length<3)return 0;for(var n=0,r=e[0].x,i=1;i<e.length-1;i++){var o=e[i].x-r,a=e[i+1].y,s=e[i-1].y;n+=o*(s-a)}return n/2}else if(ar(arguments[0],Yr)){var u=arguments[0],d=u.size();if(d<3)return 0;var g=new dt,_=new dt,E=new dt;u.getCoordinate(0,_),u.getCoordinate(1,E);var P=_.x;E.x-=P;for(var O=0,D=1;D<d-1;D++)g.y=_.y,_.x=E.x,_.y=E.y,u.getCoordinate(D+1,E),E.x-=P,O+=_.x*(g.y-E.y);return O/2}};Rn.distanceLineLine=function(e,n,r,i){if(e.equals(n))return Rn.distancePointLine(e,r,i);if(r.equals(i))return Rn.distancePointLine(i,e,n);var o=!1;if(!Qn.intersects(e,n,r,i))o=!0;else{var a=(n.x-e.x)*(i.y-r.y)-(n.y-e.y)*(i.x-r.x);if(a===0)o=!0;else{var s=(e.y-r.y)*(i.x-r.x)-(e.x-r.x)*(i.y-r.y),u=(e.y-r.y)*(n.x-e.x)-(e.x-r.x)*(n.y-e.y),d=u/a,g=s/a;(g<0||g>1||d<0||d>1)&&(o=!0)}}return o?Jl.min(Rn.distancePointLine(e,r,i),Rn.distancePointLine(n,r,i),Rn.distancePointLine(r,e,n),Rn.distancePointLine(i,e,n)):0};Rn.isPointInRing=function(e,n){return Rn.locatePointInRing(e,n)!==Et.EXTERIOR};Rn.computeLength=function(e){var n=e.size();if(n<=1)return 0;var r=0,i=new dt;e.getCoordinate(0,i);for(var o=i.x,a=i.y,s=1;s<n;s++){e.getCoordinate(s,i);var u=i.x,d=i.y,g=u-o,_=d-a;r+=Math.sqrt(g*g+_*_),o=u,a=d}return r};Rn.isCCW=function(e){var n=e.length-1;if(n<3)throw new oo("Ring has fewer than 4 points, so orientation cannot be determined");for(var r=e[0],i=0,o=1;o<=n;o++){var a=e[o];a.y>r.y&&(r=a,i=o)}var s=i;do s=s-1,s<0&&(s=n);while(e[s].equals2D(r)&&s!==i);var u=i;do u=(u+1)%n;while(e[u].equals2D(r)&&u!==i);var d=e[s],g=e[u];if(d.equals2D(r)||g.equals2D(r)||d.equals2D(g))return!1;var _=Rn.computeOrientation(d,r,g),E=!1;return _===0?E=d.x>g.x:E=_>0,E};Rn.locatePointInRing=function(e,n){return mf.locatePointInRing(e,n)};Rn.distancePointLinePerpendicular=function(e,n,r){var i=(r.x-n.x)*(r.x-n.x)+(r.y-n.y)*(r.y-n.y),o=((n.y-e.y)*(r.x-n.x)-(n.x-e.x)*(r.y-n.y))/i;return Math.abs(o)*Math.sqrt(i)};Rn.computeOrientation=function(e,n,r){return Rn.orientationIndex(e,n,r)};Rn.distancePointLine=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1];if(n.length===0)throw new oo("Line array must contain at least one vertex");for(var r=e.distance(n[0]),i=0;i<n.length-1;i++){var o=Rn.distancePointLine(e,n[i],n[i+1]);o<r&&(r=o)}return r}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];if(s.x===u.x&&s.y===u.y)return a.distance(s);var d=(u.x-s.x)*(u.x-s.x)+(u.y-s.y)*(u.y-s.y),g=((a.x-s.x)*(u.x-s.x)+(a.y-s.y)*(u.y-s.y))/d;if(g<=0)return a.distance(s);if(g>=1)return a.distance(u);var _=((s.y-a.y)*(u.x-s.x)-(s.x-a.x)*(u.y-s.y))/d;return Math.abs(_)*Math.sqrt(d)}};Rn.isOnLine=function(e,n){for(var r=new bA,i=1;i<n.length;i++){var o=n[i-1],a=n[i];if(r.computeIntersection(e,o,a),r.hasIntersection())return!0}return!1};y_.CLOCKWISE.get=function(){return-1};y_.RIGHT.get=function(){return Rn.CLOCKWISE};y_.COUNTERCLOCKWISE.get=function(){return 1};y_.LEFT.get=function(){return Rn.COUNTERCLOCKWISE};y_.COLLINEAR.get=function(){return 0};y_.STRAIGHT.get=function(){return Rn.COLLINEAR};Object.defineProperties(Rn,y_);var Hd=function(){};Hd.prototype.filter=function(e){};Hd.prototype.interfaces_=function(){return[]};Hd.prototype.getClass=function(){return Hd};var ir=function(){var e=arguments[0];this._envelope=null,this._factory=null,this._SRID=null,this._userData=null,this._factory=e,this._SRID=e.getSRID()},Gh={serialVersionUID:{configurable:!0},SORTINDEX_POINT:{configurable:!0},SORTINDEX_MULTIPOINT:{configurable:!0},SORTINDEX_LINESTRING:{configurable:!0},SORTINDEX_LINEARRING:{configurable:!0},SORTINDEX_MULTILINESTRING:{configurable:!0},SORTINDEX_POLYGON:{configurable:!0},SORTINDEX_MULTIPOLYGON:{configurable:!0},SORTINDEX_GEOMETRYCOLLECTION:{configurable:!0},geometryChangedFilter:{configurable:!0}};ir.prototype.isGeometryCollection=function(){return this.getSortIndex()===ir.SORTINDEX_GEOMETRYCOLLECTION};ir.prototype.getFactory=function(){return this._factory};ir.prototype.getGeometryN=function(e){return this};ir.prototype.getArea=function(){return 0};ir.prototype.isRectangle=function(){return!1};ir.prototype.equals=function(){if(arguments[0]instanceof ir){var e=arguments[0];return e===null?!1:this.equalsTopo(e)}else if(arguments[0]instanceof Object){var n=arguments[0];if(!(n instanceof ir))return!1;var r=n;return this.equalsExact(r)}};ir.prototype.equalsExact=function(e){return this===e||this.equalsExact(e,0)};ir.prototype.geometryChanged=function(){this.apply(ir.geometryChangedFilter)};ir.prototype.geometryChangedAction=function(){this._envelope=null};ir.prototype.equalsNorm=function(e){return e===null?!1:this.norm().equalsExact(e.norm())};ir.prototype.getLength=function(){return 0};ir.prototype.getNumGeometries=function(){return 1};ir.prototype.compareTo=function(){if(arguments.length===1){var e=arguments[0],n=e;return this.getSortIndex()!==n.getSortIndex()?this.getSortIndex()-n.getSortIndex():this.isEmpty()&&n.isEmpty()?0:this.isEmpty()?-1:n.isEmpty()?1:this.compareToSameClass(e)}else if(arguments.length===2){var r=arguments[0],i=arguments[1];return this.getSortIndex()!==r.getSortIndex()?this.getSortIndex()-r.getSortIndex():this.isEmpty()&&r.isEmpty()?0:this.isEmpty()?-1:r.isEmpty()?1:this.compareToSameClass(r,i)}};ir.prototype.getUserData=function(){return this._userData};ir.prototype.getSRID=function(){return this._SRID};ir.prototype.getEnvelope=function(){return this.getFactory().toGeometry(this.getEnvelopeInternal())};ir.prototype.checkNotGeometryCollection=function(e){if(e.getSortIndex()===ir.SORTINDEX_GEOMETRYCOLLECTION)throw new oo("This method does not support GeometryCollection arguments")};ir.prototype.equal=function(e,n,r){return r===0?e.equals(n):e.distance(n)<=r};ir.prototype.norm=function(){var e=this.copy();return e.normalize(),e};ir.prototype.getPrecisionModel=function(){return this._factory.getPrecisionModel()};ir.prototype.getEnvelopeInternal=function(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Qn(this._envelope)};ir.prototype.setSRID=function(e){this._SRID=e};ir.prototype.setUserData=function(e){this._userData=e};ir.prototype.compare=function(e,n){for(var r=e.iterator(),i=n.iterator();r.hasNext()&&i.hasNext();){var o=r.next(),a=i.next(),s=o.compareTo(a);if(s!==0)return s}return r.hasNext()?1:i.hasNext()?-1:0};ir.prototype.hashCode=function(){return this.getEnvelopeInternal().hashCode()};ir.prototype.isGeometryCollectionOrDerived=function(){return this.getSortIndex()===ir.SORTINDEX_GEOMETRYCOLLECTION||this.getSortIndex()===ir.SORTINDEX_MULTIPOINT||this.getSortIndex()===ir.SORTINDEX_MULTILINESTRING||this.getSortIndex()===ir.SORTINDEX_MULTIPOLYGON};ir.prototype.interfaces_=function(){return[pR,Uu,Gu]};ir.prototype.getClass=function(){return ir};ir.hasNonEmptyElements=function(e){for(var n=0;n<e.length;n++)if(!e[n].isEmpty())return!0;return!1};ir.hasNullElements=function(e){for(var n=0;n<e.length;n++)if(e[n]===null)return!0;return!1};Gh.serialVersionUID.get=function(){return 8763622679187377e3};Gh.SORTINDEX_POINT.get=function(){return 0};Gh.SORTINDEX_MULTIPOINT.get=function(){return 1};Gh.SORTINDEX_LINESTRING.get=function(){return 2};Gh.SORTINDEX_LINEARRING.get=function(){return 3};Gh.SORTINDEX_MULTILINESTRING.get=function(){return 4};Gh.SORTINDEX_POLYGON.get=function(){return 5};Gh.SORTINDEX_MULTIPOLYGON.get=function(){return 6};Gh.SORTINDEX_GEOMETRYCOLLECTION.get=function(){return 7};Gh.geometryChangedFilter.get=function(){return S6};Object.defineProperties(ir,Gh);var S6=function(){};S6.interfaces_=function(){return[Hd]};S6.filter=function(e){e.geometryChangedAction()};var Ch=function(){};Ch.prototype.filter=function(e){};Ch.prototype.interfaces_=function(){return[]};Ch.prototype.getClass=function(){return Ch};var Nu=function(){},ep={Mod2BoundaryNodeRule:{configurable:!0},EndPointBoundaryNodeRule:{configurable:!0},MultiValentEndPointBoundaryNodeRule:{configurable:!0},MonoValentEndPointBoundaryNodeRule:{configurable:!0},MOD2_BOUNDARY_RULE:{configurable:!0},ENDPOINT_BOUNDARY_RULE:{configurable:!0},MULTIVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},MONOVALENT_ENDPOINT_BOUNDARY_RULE:{configurable:!0},OGC_SFS_BOUNDARY_RULE:{configurable:!0}};Nu.prototype.isInBoundary=function(e){};Nu.prototype.interfaces_=function(){return[]};Nu.prototype.getClass=function(){return Nu};ep.Mod2BoundaryNodeRule.get=function(){return Zv};ep.EndPointBoundaryNodeRule.get=function(){return Yv};ep.MultiValentEndPointBoundaryNodeRule.get=function(){return Qv};ep.MonoValentEndPointBoundaryNodeRule.get=function(){return Kv};ep.MOD2_BOUNDARY_RULE.get=function(){return new Zv};ep.ENDPOINT_BOUNDARY_RULE.get=function(){return new Yv};ep.MULTIVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Qv};ep.MONOVALENT_ENDPOINT_BOUNDARY_RULE.get=function(){return new Kv};ep.OGC_SFS_BOUNDARY_RULE.get=function(){return Nu.MOD2_BOUNDARY_RULE};Object.defineProperties(Nu,ep);var Zv=function(){};Zv.prototype.isInBoundary=function(e){return e%2===1};Zv.prototype.interfaces_=function(){return[Nu]};Zv.prototype.getClass=function(){return Zv};var Yv=function(){};Yv.prototype.isInBoundary=function(e){return e>0};Yv.prototype.interfaces_=function(){return[Nu]};Yv.prototype.getClass=function(){return Yv};var Qv=function(){};Qv.prototype.isInBoundary=function(e){return e>1};Qv.prototype.interfaces_=function(){return[Nu]};Qv.prototype.getClass=function(){return Qv};var Kv=function(){};Kv.prototype.isInBoundary=function(e){return e===1};Kv.prototype.interfaces_=function(){return[Nu]};Kv.prototype.getClass=function(){return Kv};var Jo=function(){};Jo.prototype.add=function(){};Jo.prototype.addAll=function(){};Jo.prototype.isEmpty=function(){};Jo.prototype.iterator=function(){};Jo.prototype.size=function(){};Jo.prototype.toArray=function(){};Jo.prototype.remove=function(){};function T6(t){this.message=t||""}T6.prototype=new Error;T6.prototype.name="IndexOutOfBoundsException";var G1=function(){};G1.prototype.hasNext=function(){};G1.prototype.next=function(){};G1.prototype.remove=function(){};var Ac=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(){},e.prototype.set=function(){},e.prototype.isEmpty=function(){},e}(Jo);function j1(t){this.message=t||""}j1.prototype=new Error;j1.prototype.name="NoSuchElementException";var bn=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Jo&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.ensureCapacity=function(){},e.prototype.interfaces_=function(){return[t,Jo]},e.prototype.add=function(r){return arguments.length===1?this.array_.push(r):this.array_.splice(arguments[0],arguments[1]),!0},e.prototype.clear=function(){this.array_=[]},e.prototype.addAll=function(r){for(var i=this,o=r.iterator();o.hasNext();)i.add(o.next());return!0},e.prototype.set=function(r,i){var o=this.array_[r];return this.array_[r]=i,o},e.prototype.iterator=function(){return new BRe(this)},e.prototype.get=function(r){if(r<0||r>=this.size())throw new T6;return this.array_[r]},e.prototype.isEmpty=function(){return this.array_.length===0},e.prototype.size=function(){return this.array_.length},e.prototype.toArray=function(){for(var r=this,i=[],o=0,a=this.array_.length;o<a;o++)i.push(r.array_[o]);return i},e.prototype.remove=function(r){for(var i=this,o=!1,a=0,s=this.array_.length;a<s;a++)if(i.array_[a]===r){i.array_.splice(a,1),o=!0;break}return o},e}(Ac),BRe=function(t){function e(n){t.call(this),this.arrayList_=n,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.arrayList_.size())throw new j1;return this.arrayList_.get(this.position_++)},e.prototype.hasNext=function(){return this.position_<this.arrayList_.size()},e.prototype.set=function(r){return this.arrayList_.set(this.position_-1,r)},e.prototype.remove=function(){this.arrayList_.remove(this.arrayList_.get(this.position_))},e}(G1),t2=function(t){function e(){if(t.call(this),arguments.length!==0){if(arguments.length===1){var r=arguments[0];this.ensureCapacity(r.length),this.add(r,!0)}else if(arguments.length===2){var i=arguments[0],o=arguments[1];this.ensureCapacity(i.length),this.add(i,o)}}}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={coordArrayType:{configurable:!0}};return n.coordArrayType.get=function(){return new Array(0).fill(null)},e.prototype.getCoordinate=function(i){return this.get(i)},e.prototype.addAll=function(){var i=this;if(arguments.length===2){for(var o=arguments[0],a=arguments[1],s=!1,u=o.iterator();u.hasNext();)i.add(u.next(),a),s=!0;return s}else return t.prototype.addAll.apply(this,arguments)},e.prototype.clone=function(){for(var i=this,o=t.prototype.clone.call(this),a=0;a<this.size();a++)o.add(a,i.get(a).copy());return o},e.prototype.toCoordinateArray=function(){return this.toArray(e.coordArrayType)},e.prototype.add=function(){var i=this;if(arguments.length===1){var o=arguments[0];t.prototype.add.call(this,o)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var a=arguments[0],s=arguments[1];return this.add(a,s,!0),!0}else if(arguments[0]instanceof dt&&typeof arguments[1]=="boolean"){var u=arguments[0],d=arguments[1];if(!d&&this.size()>=1){var g=this.get(this.size()-1);if(g.equals2D(u))return null}t.prototype.add.call(this,u)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){var _=arguments[0],E=arguments[1];return this.add(_,E),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){var P=arguments[0],O=arguments[1],D=arguments[2];if(D)for(var V=0;V<P.length;V++)i.add(P[V],O);else for(var k=P.length-1;k>=0;k--)i.add(P[k],O);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof dt){var F=arguments[0],z=arguments[1],X=arguments[2];if(!X){var Y=this.size();if(Y>0){if(F>0){var J=this.get(F-1);if(J.equals2D(z))return null}if(F<Y){var re=this.get(F);if(re.equals2D(z))return null}}}t.prototype.add.call(this,F,z)}}else if(arguments.length===4){var ue=arguments[0],ie=arguments[1],ce=arguments[2],se=arguments[3],me=1;ce>se&&(me=-1);for(var Ce=ce;Ce!==se;Ce+=me)i.add(ue[Ce],ie);return!0}},e.prototype.closeRing=function(){this.size()>0&&this.add(new dt(this.get(0)),!1)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},Object.defineProperties(e,n),e}(bn),zr=function(){},mR={ForwardComparator:{configurable:!0},BidirectionalComparator:{configurable:!0},coordArrayType:{configurable:!0}};mR.ForwardComparator.get=function(){return Zw};mR.BidirectionalComparator.get=function(){return Jv};mR.coordArrayType.get=function(){return new Array(0).fill(null)};zr.prototype.interfaces_=function(){return[]};zr.prototype.getClass=function(){return zr};zr.isRing=function(e){return!(e.length<4||!e[0].equals2D(e[e.length-1]))};zr.ptNotInList=function(e,n){for(var r=0;r<e.length;r++){var i=e[r];if(zr.indexOf(i,n)<0)return i}return null};zr.scroll=function(e,n){var r=zr.indexOf(n,e);if(r<0)return null;var i=new Array(e.length).fill(null);qs.arraycopy(e,r,i,0,e.length-r),qs.arraycopy(e,0,i,e.length-r,r),qs.arraycopy(i,0,e,0,e.length)};zr.equals=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1];if(e===n)return!0;if(e===null||n===null||e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(!e[r].equals(n[r]))return!1;return!0}else if(arguments.length===3){var i=arguments[0],o=arguments[1],a=arguments[2];if(i===o)return!0;if(i===null||o===null||i.length!==o.length)return!1;for(var s=0;s<i.length;s++)if(a.compare(i[s],o[s])!==0)return!1;return!0}};zr.intersection=function(e,n){for(var r=new t2,i=0;i<e.length;i++)n.intersects(e[i])&&r.add(e[i],!0);return r.toCoordinateArray()};zr.hasRepeatedPoints=function(e){for(var n=1;n<e.length;n++)if(e[n-1].equals(e[n]))return!0;return!1};zr.removeRepeatedPoints=function(e){if(!zr.hasRepeatedPoints(e))return e;var n=new t2(e,!1);return n.toCoordinateArray()};zr.reverse=function(e){for(var n=e.length-1,r=Math.trunc(n/2),i=0;i<=r;i++){var o=e[i];e[i]=e[n-i],e[n-i]=o}};zr.removeNull=function(e){for(var n=0,r=0;r<e.length;r++)e[r]!==null&&n++;var i=new Array(n).fill(null);if(n===0)return i;for(var o=0,a=0;a<e.length;a++)e[a]!==null&&(i[o++]=e[a]);return i};zr.copyDeep=function(){if(arguments.length===1){for(var e=arguments[0],n=new Array(e.length).fill(null),r=0;r<e.length;r++)n[r]=new dt(e[r]);return n}else if(arguments.length===5)for(var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3],u=arguments[4],d=0;d<u;d++)a[s+d]=new dt(i[o+d])};zr.isEqualReversed=function(e,n){for(var r=0;r<e.length;r++){var i=e[r],o=n[e.length-r-1];if(i.compareTo(o)!==0)return!1}return!0};zr.envelope=function(e){for(var n=new Qn,r=0;r<e.length;r++)n.expandToInclude(e[r]);return n};zr.toCoordinateArray=function(e){return e.toArray(zr.coordArrayType)};zr.atLeastNCoordinatesOrNothing=function(e,n){return n.length>=e?n:[]};zr.indexOf=function(e,n){for(var r=0;r<n.length;r++)if(e.equals(n[r]))return r;return-1};zr.increasingDirection=function(e){for(var n=0;n<Math.trunc(e.length/2);n++){var r=e.length-1-n,i=e[n].compareTo(e[r]);if(i!==0)return i}return 1};zr.compare=function(e,n){for(var r=0;r<e.length&&r<n.length;){var i=e[r].compareTo(n[r]);if(i!==0)return i;r++}return r<n.length?-1:r<e.length?1:0};zr.minCoordinate=function(e){for(var n=null,r=0;r<e.length;r++)(n===null||n.compareTo(e[r])>0)&&(n=e[r]);return n};zr.extract=function(e,n,r){n=Jl.clamp(n,0,e.length),r=Jl.clamp(r,-1,e.length);var i=r-n+1;r<0&&(i=0),n>=e.length&&(i=0),r<n&&(i=0);var o=new Array(i).fill(null);if(i===0)return o;for(var a=0,s=n;s<=r;s++)o[a++]=e[s];return o};Object.defineProperties(zr,mR);var Zw=function(){};Zw.prototype.compare=function(e,n){var r=e,i=n;return zr.compare(r,i)};Zw.prototype.interfaces_=function(){return[qv]};Zw.prototype.getClass=function(){return Zw};var Jv=function(){};Jv.prototype.compare=function(e,n){var r=e,i=n;if(r.length<i.length)return-1;if(r.length>i.length)return 1;if(r.length===0)return 0;var o=zr.compare(r,i),a=zr.isEqualReversed(r,i);return a?0:o};Jv.prototype.OLDcompare=function(e,n){var r=e,i=n;if(r.length<i.length)return-1;if(r.length>i.length)return 1;if(r.length===0)return 0;for(var o=zr.increasingDirection(r),a=zr.increasingDirection(i),s=o>0?0:r.length-1,u=a>0?0:r.length-1,d=0;d<r.length;d++){var g=r[s].compareTo(i[u]);if(g!==0)return g;s+=o,u+=a}return 0};Jv.prototype.interfaces_=function(){return[qv]};Jv.prototype.getClass=function(){return Jv};var v_=function(){};v_.prototype.get=function(){};v_.prototype.put=function(){};v_.prototype.size=function(){};v_.prototype.values=function(){};v_.prototype.entrySet=function(){};var NRe=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e}(v_);function n2(t){this.message=t||""}n2.prototype=new Error;n2.prototype.name="OperationNotSupported";function AR(){}AR.prototype=new Jo;AR.prototype.contains=function(){};var C6=function(t){function e(){t.call(this),this.array_=[],arguments[0]instanceof Jo&&this.addAll(arguments[0])}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.contains=function(r){for(var i=this,o=0,a=this.array_.length;o<a;o++){var s=i.array_[o];if(s===r)return!0}return!1},e.prototype.add=function(r){return this.contains(r)?!1:(this.array_.push(r),!0)},e.prototype.addAll=function(r){for(var i=this,o=r.iterator();o.hasNext();)i.add(o.next());return!0},e.prototype.remove=function(r){throw new Error},e.prototype.size=function(){return this.array_.length},e.prototype.isEmpty=function(){return this.array_.length===0},e.prototype.toArray=function(){for(var r=this,i=[],o=0,a=this.array_.length;o<a;o++)i.push(r.array_[o]);return i},e.prototype.iterator=function(){return new FRe(this)},e}(AR),FRe=function(t){function e(n){t.call(this),this.hashSet_=n,this.position_=0}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.next=function(){if(this.position_===this.hashSet_.size())throw new j1;return this.hashSet_.array_[this.position_++]},e.prototype.hasNext=function(){return this.position_<this.hashSet_.size()},e.prototype.remove=function(){throw new n2},e}(G1),Sd=0,dm=1;function p7(t){return t===null?Sd:t.color}function Fi(t){return t===null?null:t.parent}function md(t,e){t!==null&&(t.color=e)}function mB(t){return t===null?null:t.left}function g7(t){return t===null?null:t.right}function aa(){this.root_=null,this.size_=0}aa.prototype=new NRe;aa.prototype.get=function(t){for(var e=this.root_;e!==null;){var n=t.compareTo(e.key);if(n<0)e=e.left;else if(n>0)e=e.right;else return e.value}return null};aa.prototype.put=function(t,e){if(this.root_===null)return this.root_={key:t,value:e,left:null,right:null,parent:null,color:Sd,getValue:function(){return this.value},getKey:function(){return this.key}},this.size_=1,null;var n=this.root_,r,i;do if(r=n,i=t.compareTo(n.key),i<0)n=n.left;else if(i>0)n=n.right;else{var o=n.value;return n.value=e,o}while(n!==null);var a={key:t,left:null,right:null,value:e,parent:r,color:Sd,getValue:function(){return this.value},getKey:function(){return this.key}};return i<0?r.left=a:r.right=a,this.fixAfterInsertion(a),this.size_++,null};aa.prototype.fixAfterInsertion=function(t){var e=this;for(t.color=dm;t!=null&&t!==this.root_&&t.parent.color===dm;)if(Fi(t)===mB(Fi(Fi(t)))){var n=g7(Fi(Fi(t)));p7(n)===dm?(md(Fi(t),Sd),md(n,Sd),md(Fi(Fi(t)),dm),t=Fi(Fi(t))):(t===g7(Fi(t))&&(t=Fi(t),e.rotateLeft(t)),md(Fi(t),Sd),md(Fi(Fi(t)),dm),e.rotateRight(Fi(Fi(t))))}else{var r=mB(Fi(Fi(t)));p7(r)===dm?(md(Fi(t),Sd),md(r,Sd),md(Fi(Fi(t)),dm),t=Fi(Fi(t))):(t===mB(Fi(t))&&(t=Fi(t),e.rotateRight(t)),md(Fi(t),Sd),md(Fi(Fi(t)),dm),e.rotateLeft(Fi(Fi(t))))}this.root_.color=Sd};aa.prototype.values=function(){var t=new bn,e=this.getFirstEntry();if(e!==null)for(t.add(e.value);(e=aa.successor(e))!==null;)t.add(e.value);return t};aa.prototype.entrySet=function(){var t=new C6,e=this.getFirstEntry();if(e!==null)for(t.add(e);(e=aa.successor(e))!==null;)t.add(e);return t};aa.prototype.rotateLeft=function(t){if(t!=null){var e=t.right;t.right=e.left,e.left!=null&&(e.left.parent=t),e.parent=t.parent,t.parent===null?this.root_=e:t.parent.left===t?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e}};aa.prototype.rotateRight=function(t){if(t!=null){var e=t.left;t.left=e.right,e.right!=null&&(e.right.parent=t),e.parent=t.parent,t.parent===null?this.root_=e:t.parent.right===t?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e}};aa.prototype.getFirstEntry=function(){var t=this.root_;if(t!=null)for(;t.left!=null;)t=t.left;return t};aa.successor=function(t){if(t===null)return null;if(t.right!==null){for(var e=t.right;e.left!==null;)e=e.left;return e}else{for(var n=t.parent,r=t;n!==null&&r===n.right;)r=n,n=n.parent;return n}};aa.prototype.size=function(){return this.size_};var Yw=function(){};Yw.prototype.interfaces_=function(){return[]};Yw.prototype.getClass=function(){return Yw};function aie(){}aie.prototype=new AR;function wf(){this.array_=[],arguments[0]instanceof Jo&&this.addAll(arguments[0])}wf.prototype=new aie;wf.prototype.contains=function(t){for(var e=this,n=0,r=this.array_.length;n<r;n++){var i=e.array_[n];if(i.compareTo(t)===0)return!0}return!1};wf.prototype.add=function(t){var e=this;if(this.contains(t))return!1;for(var n=0,r=this.array_.length;n<r;n++){var i=e.array_[n];if(i.compareTo(t)===1)return e.array_.splice(n,0,t),!0}return this.array_.push(t),!0};wf.prototype.addAll=function(t){for(var e=this,n=t.iterator();n.hasNext();)e.add(n.next());return!0};wf.prototype.remove=function(t){throw new n2};wf.prototype.size=function(){return this.array_.length};wf.prototype.isEmpty=function(){return this.array_.length===0};wf.prototype.toArray=function(){for(var t=this,e=[],n=0,r=this.array_.length;n<r;n++)e.push(t.array_[n]);return e};wf.prototype.iterator=function(){return new _R(this)};var _R=function(t){this.treeSet_=t,this.position_=0};_R.prototype.next=function(){if(this.position_===this.treeSet_.size())throw new j1;return this.treeSet_.array_[this.position_++]};_R.prototype.hasNext=function(){return this.position_<this.treeSet_.size()};_R.prototype.remove=function(){throw new n2};var $m=function(){};$m.sort=function(){var e=arguments[0],n,r,i,o;if(arguments.length===1)o=function(s,u){return s.compareTo(u)},e.sort(o);else if(arguments.length===2)i=arguments[1],o=function(s,u){return i.compare(s,u)},e.sort(o);else if(arguments.length===3){r=e.slice(arguments[1],arguments[2]),r.sort();var a=e.slice(0,arguments[1]).concat(r,e.slice(arguments[2],e.length));for(e.splice(0,e.length),n=0;n<a.length;n++)e.push(a[n])}else if(arguments.length===4)for(r=e.slice(arguments[1],arguments[2]),i=arguments[3],o=function(s,u){return i.compare(s,u)},r.sort(o),a=e.slice(0,arguments[1]).concat(r,e.slice(arguments[2],e.length)),e.splice(0,e.length),n=0;n<a.length;n++)e.push(a[n])};$m.asList=function(e){for(var n=new bn,r=0,i=e.length;r<i;r++)n.add(e[r]);return n};var ii=function(){},Bc={P:{configurable:!0},L:{configurable:!0},A:{configurable:!0},FALSE:{configurable:!0},TRUE:{configurable:!0},DONTCARE:{configurable:!0},SYM_FALSE:{configurable:!0},SYM_TRUE:{configurable:!0},SYM_DONTCARE:{configurable:!0},SYM_P:{configurable:!0},SYM_L:{configurable:!0},SYM_A:{configurable:!0}};Bc.P.get=function(){return 0};Bc.L.get=function(){return 1};Bc.A.get=function(){return 2};Bc.FALSE.get=function(){return-1};Bc.TRUE.get=function(){return-2};Bc.DONTCARE.get=function(){return-3};Bc.SYM_FALSE.get=function(){return"F"};Bc.SYM_TRUE.get=function(){return"T"};Bc.SYM_DONTCARE.get=function(){return"*"};Bc.SYM_P.get=function(){return"0"};Bc.SYM_L.get=function(){return"1"};Bc.SYM_A.get=function(){return"2"};ii.prototype.interfaces_=function(){return[]};ii.prototype.getClass=function(){return ii};ii.toDimensionSymbol=function(e){switch(e){case ii.FALSE:return ii.SYM_FALSE;case ii.TRUE:return ii.SYM_TRUE;case ii.DONTCARE:return ii.SYM_DONTCARE;case ii.P:return ii.SYM_P;case ii.L:return ii.SYM_L;case ii.A:return ii.SYM_A}throw new oo("Unknown dimension value: "+e)};ii.toDimensionValue=function(e){switch(Xw.toUpperCase(e)){case ii.SYM_FALSE:return ii.FALSE;case ii.SYM_TRUE:return ii.TRUE;case ii.SYM_DONTCARE:return ii.DONTCARE;case ii.SYM_P:return ii.P;case ii.SYM_L:return ii.L;case ii.SYM_A:return ii.A}throw new oo("Unknown dimension symbol: "+e)};Object.defineProperties(ii,Bc);var Ef=function(){};Ef.prototype.filter=function(e){};Ef.prototype.interfaces_=function(){return[]};Ef.prototype.getClass=function(){return Ef};var bc=function(){};bc.prototype.filter=function(e,n){};bc.prototype.isDone=function(){};bc.prototype.isGeometryChanged=function(){};bc.prototype.interfaces_=function(){return[]};bc.prototype.getClass=function(){return bc};var Ra=function(t){function e(r,i){if(t.call(this,i),this._geometries=r||[],t.hasNullElements(this._geometries))throw new oo("geometries must not contain null elements")}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){for(var i=this,o=new Qn,a=0;a<this._geometries.length;a++)o.expandToInclude(i._geometries[a].getEnvelopeInternal());return o},e.prototype.getGeometryN=function(i){return this._geometries[i]},e.prototype.getSortIndex=function(){return t.SORTINDEX_GEOMETRYCOLLECTION},e.prototype.getCoordinates=function(){for(var i=this,o=new Array(this.getNumPoints()).fill(null),a=-1,s=0;s<this._geometries.length;s++)for(var u=i._geometries[s].getCoordinates(),d=0;d<u.length;d++)a++,o[a]=u[d];return o},e.prototype.getArea=function(){for(var i=this,o=0,a=0;a<this._geometries.length;a++)o+=i._geometries[a].getArea();return o},e.prototype.equalsExact=function(){var i=this;if(arguments.length===2){var o=arguments[0],a=arguments[1];if(!this.isEquivalentClass(o))return!1;var s=o;if(this._geometries.length!==s._geometries.length)return!1;for(var u=0;u<this._geometries.length;u++)if(!i._geometries[u].equalsExact(s._geometries[u],a))return!1;return!0}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var i=this,o=0;o<this._geometries.length;o++)i._geometries[o].normalize();$m.sort(this._geometries)},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._geometries[0].getCoordinate()},e.prototype.getBoundaryDimension=function(){for(var i=this,o=ii.FALSE,a=0;a<this._geometries.length;a++)o=Math.max(o,i._geometries[a].getBoundaryDimension());return o},e.prototype.getDimension=function(){for(var i=this,o=ii.FALSE,a=0;a<this._geometries.length;a++)o=Math.max(o,i._geometries[a].getDimension());return o},e.prototype.getLength=function(){for(var i=this,o=0,a=0;a<this._geometries.length;a++)o+=i._geometries[a].getLength();return o},e.prototype.getNumPoints=function(){for(var i=this,o=0,a=0;a<this._geometries.length;a++)o+=i._geometries[a].getNumPoints();return o},e.prototype.getNumGeometries=function(){return this._geometries.length},e.prototype.reverse=function(){for(var i=this,o=this._geometries.length,a=new Array(o).fill(null),s=0;s<this._geometries.length;s++)a[s]=i._geometries[s].reverse();return this.getFactory().createGeometryCollection(a)},e.prototype.compareToSameClass=function(){var i=this;if(arguments.length===1){var o=arguments[0],a=new wf($m.asList(this._geometries)),s=new wf($m.asList(o._geometries));return this.compare(a,s)}else if(arguments.length===2){for(var u=arguments[0],d=arguments[1],g=u,_=this.getNumGeometries(),E=g.getNumGeometries(),P=0;P<_&&P<E;){var O=i.getGeometryN(P),D=g.getGeometryN(P),V=O.compareToSameClass(D,d);if(V!==0)return V;P++}return P<_?1:P<E?-1:0}},e.prototype.apply=function(){var i=this;if(ar(arguments[0],Ch))for(var o=arguments[0],a=0;a<this._geometries.length;a++)i._geometries[a].apply(o);else if(ar(arguments[0],bc)){var s=arguments[0];if(this._geometries.length===0)return null;for(var u=0;u<this._geometries.length&&(i._geometries[u].apply(s),!s.isDone());u++);s.isGeometryChanged()&&this.geometryChanged()}else if(ar(arguments[0],Ef)){var d=arguments[0];d.filter(this);for(var g=0;g<this._geometries.length;g++)i._geometries[g].apply(d)}else if(ar(arguments[0],Hd)){var _=arguments[0];_.filter(this);for(var E=0;E<this._geometries.length;E++)i._geometries[E].apply(_)}},e.prototype.getBoundary=function(){return this.checkNotGeometryCollection(this),Pr.shouldNeverReachHere(),null},e.prototype.clone=function(){var i=this,o=t.prototype.clone.call(this);o._geometries=new Array(this._geometries.length).fill(null);for(var a=0;a<this._geometries.length;a++)o._geometries[a]=i._geometries[a].clone();return o},e.prototype.getGeometryType=function(){return"GeometryCollection"},e.prototype.copy=function(){for(var i=this,o=new Array(this._geometries.length).fill(null),a=0;a<o.length;a++)o[a]=i._geometries[a].copy();return new e(o,this._factory)},e.prototype.isEmpty=function(){for(var i=this,o=0;o<this._geometries.length;o++)if(!i._geometries[o].isEmpty())return!1;return!0},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-5694727726395021e3},Object.defineProperties(e,n),e}(ir),tA=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ir.SORTINDEX_MULTILINESTRING},e.prototype.equalsExact=function(){if(arguments.length===2){var i=arguments[0],o=arguments[1];return this.isEquivalentClass(i)?t.prototype.equalsExact.call(this,i,o):!1}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?ii.FALSE:0},e.prototype.isClosed=function(){var i=this;if(this.isEmpty())return!1;for(var o=0;o<this._geometries.length;o++)if(!i._geometries[o].isClosed())return!1;return!0},e.prototype.getDimension=function(){return 1},e.prototype.reverse=function(){for(var i=this,o=this._geometries.length,a=new Array(o).fill(null),s=0;s<this._geometries.length;s++)a[o-1-s]=i._geometries[s].reverse();return this.getFactory().createMultiLineString(a)},e.prototype.getBoundary=function(){return new Ou(this).getBoundary()},e.prototype.getGeometryType=function(){return"MultiLineString"},e.prototype.copy=function(){for(var i=this,o=new Array(this._geometries.length).fill(null),a=0;a<o.length;a++)o[a]=i._geometries[a].copy();return new e(o,this._factory)},e.prototype.interfaces_=function(){return[Yw]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 8166665132445434e3},Object.defineProperties(e,n),e}(Ra),Ou=function(){if(this._geom=null,this._geomFact=null,this._bnRule=null,this._endpointMap=null,arguments.length===1){var e=arguments[0],n=Nu.MOD2_BOUNDARY_RULE;this._geom=e,this._geomFact=e.getFactory(),this._bnRule=n}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this._geom=r,this._geomFact=r.getFactory(),this._bnRule=i}};Ou.prototype.boundaryMultiLineString=function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();var n=this.computeBoundaryCoordinates(e);return n.length===1?this._geomFact.createPoint(n[0]):this._geomFact.createMultiPointFromCoords(n)};Ou.prototype.getBoundary=function(){return this._geom instanceof bo?this.boundaryLineString(this._geom):this._geom instanceof tA?this.boundaryMultiLineString(this._geom):this._geom.getBoundary()};Ou.prototype.boundaryLineString=function(e){if(this._geom.isEmpty())return this.getEmptyMultiPoint();if(e.isClosed()){var n=this._bnRule.isInBoundary(2);return n?e.getStartPoint():this._geomFact.createMultiPoint()}return this._geomFact.createMultiPoint([e.getStartPoint(),e.getEndPoint()])};Ou.prototype.getEmptyMultiPoint=function(){return this._geomFact.createMultiPoint()};Ou.prototype.computeBoundaryCoordinates=function(e){var n=this,r=new bn;this._endpointMap=new aa;for(var i=0;i<e.getNumGeometries();i++){var o=e.getGeometryN(i);o.getNumPoints()!==0&&(n.addEndpoint(o.getCoordinateN(0)),n.addEndpoint(o.getCoordinateN(o.getNumPoints()-1)))}for(var a=this._endpointMap.entrySet().iterator();a.hasNext();){var s=a.next(),u=s.getValue(),d=u.count;n._bnRule.isInBoundary(d)&&r.add(s.getKey())}return zr.toCoordinateArray(r)};Ou.prototype.addEndpoint=function(e){var n=this._endpointMap.get(e);n===null&&(n=new II,this._endpointMap.put(e,n)),n.count++};Ou.prototype.interfaces_=function(){return[]};Ou.prototype.getClass=function(){return Ou};Ou.getBoundary=function(){if(arguments.length===1){var e=arguments[0],n=new Ou(e);return n.getBoundary()}else if(arguments.length===2){var r=arguments[0],i=arguments[1],o=new Ou(r,i);return o.getBoundary()}};var II=function(){this.count=null};II.prototype.interfaces_=function(){return[]};II.prototype.getClass=function(){return II};function kRe(){}function zRe(){}var URe=function(){};function GRe(){}function jRe(){}function VRe(){}var Ru=function(){},P6={NEWLINE:{configurable:!0},SIMPLE_ORDINATE_FORMAT:{configurable:!0}};Ru.prototype.interfaces_=function(){return[]};Ru.prototype.getClass=function(){return Ru};Ru.chars=function(e,n){for(var r=new Array(n).fill(null),i=0;i<n;i++)r[i]=e;return String(r)};Ru.getStackTrace=function(){if(arguments.length===1){var e=arguments[0],n=new GRe,r=new kRe;return e.printStackTrace(r),n.toString()}else if(arguments.length===2){var i=arguments[0],o=arguments[1],a="";new zRe(Ru.getStackTrace(i));for(var s=new VRe,u=0;u<o;u++)try{a+=s.readLine()+Ru.NEWLINE}catch(d){if(d instanceof jRe)Pr.shouldNeverReachHere();else throw d}finally{}return a}};Ru.split=function(e,n){for(var r=n.length,i=new bn,o=""+e,a=o.indexOf(n);a>=0;){var s=o.substring(0,a);i.add(s),o=o.substring(a+r),a=o.indexOf(n)}o.length>0&&i.add(o);for(var u=new Array(i.size()).fill(null),d=0;d<u.length;d++)u[d]=i.get(d);return u};Ru.toString=function(){if(arguments.length===1){var e=arguments[0];return Ru.SIMPLE_ORDINATE_FORMAT.format(e)}};Ru.spaces=function(e){return Ru.chars(" ",e)};P6.NEWLINE.get=function(){return qs.getProperty("line.separator")};P6.SIMPLE_ORDINATE_FORMAT.get=function(){return new URe};Object.defineProperties(Ru,P6);var Ro=function(){};Ro.prototype.interfaces_=function(){return[]};Ro.prototype.getClass=function(){return Ro};Ro.copyCoord=function(e,n,r,i){for(var o=Math.min(e.getDimension(),r.getDimension()),a=0;a<o;a++)r.setOrdinate(i,a,e.getOrdinate(n,a))};Ro.isRing=function(e){var n=e.size();return n===0?!0:n<=3?!1:e.getOrdinate(0,Yr.X)===e.getOrdinate(n-1,Yr.X)&&e.getOrdinate(0,Yr.Y)===e.getOrdinate(n-1,Yr.Y)};Ro.isEqual=function(e,n){var r=e.size(),i=n.size();if(r!==i)return!1;for(var o=Math.min(e.getDimension(),n.getDimension()),a=0;a<r;a++)for(var s=0;s<o;s++){var u=e.getOrdinate(a,s),d=n.getOrdinate(a,s);if(e.getOrdinate(a,s)!==n.getOrdinate(a,s)&&!(mr.isNaN(u)&&mr.isNaN(d)))return!1}return!0};Ro.extend=function(e,n,r){var i=e.create(r,n.getDimension()),o=n.size();if(Ro.copy(n,0,i,0,o),o>0)for(var a=o;a<r;a++)Ro.copy(n,o-1,i,a,1);return i};Ro.reverse=function(e){for(var n=e.size()-1,r=Math.trunc(n/2),i=0;i<=r;i++)Ro.swap(e,i,n-i)};Ro.swap=function(e,n,r){if(n===r)return null;for(var i=0;i<e.getDimension();i++){var o=e.getOrdinate(n,i);e.setOrdinate(n,i,e.getOrdinate(r,i)),e.setOrdinate(r,i,o)}};Ro.copy=function(e,n,r,i,o){for(var a=0;a<o;a++)Ro.copyCoord(e,n+a,r,i+a)};Ro.toString=function(){if(arguments.length===1){var e=arguments[0],n=e.size();if(n===0)return"()";var r=e.getDimension(),i=new Df;i.append("(");for(var o=0;o<n;o++){o>0&&i.append(" ");for(var a=0;a<r;a++)a>0&&i.append(","),i.append(Ru.toString(e.getOrdinate(o,a)))}return i.append(")"),i.toString()}};Ro.ensureValidRing=function(e,n){var r=n.size();if(r===0)return n;if(r<=3)return Ro.createClosedRing(e,n,4);var i=n.getOrdinate(0,Yr.X)===n.getOrdinate(r-1,Yr.X)&&n.getOrdinate(0,Yr.Y)===n.getOrdinate(r-1,Yr.Y);return i?n:Ro.createClosedRing(e,n,r+1)};Ro.createClosedRing=function(e,n,r){var i=e.create(r,n.getDimension()),o=n.size();Ro.copy(n,0,i,0,o);for(var a=o;a<r;a++)Ro.copy(n,0,i,a,1);return i};var bo=function(t){function e(r,i){t.call(this,i),this._points=null,this.init(r)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this.isEmpty()?new Qn:this._points.expandEnvelope(new Qn)},e.prototype.isRing=function(){return this.isClosed()&&this.isSimple()},e.prototype.getSortIndex=function(){return t.SORTINDEX_LINESTRING},e.prototype.getCoordinates=function(){return this._points.toCoordinateArray()},e.prototype.equalsExact=function(){var i=this;if(arguments.length===2){var o=arguments[0],a=arguments[1];if(!this.isEquivalentClass(o))return!1;var s=o;if(this._points.size()!==s._points.size())return!1;for(var u=0;u<this._points.size();u++)if(!i.equal(i._points.getCoordinate(u),s._points.getCoordinate(u),a))return!1;return!0}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){for(var i=this,o=0;o<Math.trunc(this._points.size()/2);o++){var a=i._points.size()-1-o;if(!i._points.getCoordinate(o).equals(i._points.getCoordinate(a)))return i._points.getCoordinate(o).compareTo(i._points.getCoordinate(a))>0&&Ro.reverse(i._points),null}},e.prototype.getCoordinate=function(){return this.isEmpty()?null:this._points.getCoordinate(0)},e.prototype.getBoundaryDimension=function(){return this.isClosed()?ii.FALSE:0},e.prototype.isClosed=function(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))},e.prototype.getEndPoint=function(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)},e.prototype.getDimension=function(){return 1},e.prototype.getLength=function(){return Rn.computeLength(this._points)},e.prototype.getNumPoints=function(){return this._points.size()},e.prototype.reverse=function(){var i=this._points.copy();Ro.reverse(i);var o=this.getFactory().createLineString(i);return o},e.prototype.compareToSameClass=function(){var i=this;if(arguments.length===1){for(var o=arguments[0],a=o,s=0,u=0;s<this._points.size()&&u<a._points.size();){var d=i._points.getCoordinate(s).compareTo(a._points.getCoordinate(u));if(d!==0)return d;s++,u++}return s<this._points.size()?1:u<a._points.size()?-1:0}else if(arguments.length===2){var g=arguments[0],_=arguments[1],E=g;return _.compare(this._points,E._points)}},e.prototype.apply=function(){var i=this;if(ar(arguments[0],Ch))for(var o=arguments[0],a=0;a<this._points.size();a++)o.filter(i._points.getCoordinate(a));else if(ar(arguments[0],bc)){var s=arguments[0];if(this._points.size()===0)return null;for(var u=0;u<this._points.size()&&(s.filter(i._points,u),!s.isDone());u++);s.isGeometryChanged()&&this.geometryChanged()}else if(ar(arguments[0],Ef)){var d=arguments[0];d.filter(this)}else if(ar(arguments[0],Hd)){var g=arguments[0];g.filter(this)}},e.prototype.getBoundary=function(){return new Ou(this).getBoundary()},e.prototype.isEquivalentClass=function(i){return i instanceof e},e.prototype.clone=function(){var i=t.prototype.clone.call(this);return i._points=this._points.clone(),i},e.prototype.getCoordinateN=function(i){return this._points.getCoordinate(i)},e.prototype.getGeometryType=function(){return"LineString"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._points},e.prototype.isEmpty=function(){return this._points.size()===0},e.prototype.init=function(i){if(i===null&&(i=this.getFactory().getCoordinateSequenceFactory().create([])),i.size()===1)throw new oo("Invalid number of points in LineString (found "+i.size()+" - must be 0 or >= 2)");this._points=i},e.prototype.isCoordinate=function(i){for(var o=this,a=0;a<this._points.size();a++)if(o._points.getCoordinate(a).equals(i))return!0;return!1},e.prototype.getStartPoint=function(){return this.isEmpty()?null:this.getPointN(0)},e.prototype.getPointN=function(i){return this.getFactory().createPoint(this._points.getCoordinate(i))},e.prototype.interfaces_=function(){return[Yw]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 0x2b2b51ba435c8e00},Object.defineProperties(e,n),e}(ir),Qw=function(){};Qw.prototype.interfaces_=function(){return[]};Qw.prototype.getClass=function(){return Qw};var Il=function(t){function e(r,i){t.call(this,i),this._coordinates=r||null,this.init(this._coordinates)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){if(this.isEmpty())return new Qn;var i=new Qn;return i.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),i},e.prototype.getSortIndex=function(){return t.SORTINDEX_POINT},e.prototype.getCoordinates=function(){return this.isEmpty()?[]:[this.getCoordinate()]},e.prototype.equalsExact=function(){if(arguments.length===2){var i=arguments[0],o=arguments[1];return this.isEquivalentClass(i)?this.isEmpty()&&i.isEmpty()?!0:this.isEmpty()!==i.isEmpty()?!1:this.equal(i.getCoordinate(),this.getCoordinate(),o):!1}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){},e.prototype.getCoordinate=function(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null},e.prototype.getBoundaryDimension=function(){return ii.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getNumPoints=function(){return this.isEmpty()?0:1},e.prototype.reverse=function(){return this.copy()},e.prototype.getX=function(){if(this.getCoordinate()===null)throw new Error("getX called on empty Point");return this.getCoordinate().x},e.prototype.compareToSameClass=function(){if(arguments.length===1){var i=arguments[0],o=i;return this.getCoordinate().compareTo(o.getCoordinate())}else if(arguments.length===2){var a=arguments[0],s=arguments[1],u=a;return s.compare(this._coordinates,u._coordinates)}},e.prototype.apply=function(){if(ar(arguments[0],Ch)){var i=arguments[0];if(this.isEmpty())return null;i.filter(this.getCoordinate())}else if(ar(arguments[0],bc)){var o=arguments[0];if(this.isEmpty())return null;o.filter(this._coordinates,0),o.isGeometryChanged()&&this.geometryChanged()}else if(ar(arguments[0],Ef)){var a=arguments[0];a.filter(this)}else if(ar(arguments[0],Hd)){var s=arguments[0];s.filter(this)}},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.clone=function(){var i=t.prototype.clone.call(this);return i._coordinates=this._coordinates.clone(),i},e.prototype.getGeometryType=function(){return"Point"},e.prototype.copy=function(){return new e(this._coordinates.copy(),this._factory)},e.prototype.getCoordinateSequence=function(){return this._coordinates},e.prototype.getY=function(){if(this.getCoordinate()===null)throw new Error("getY called on empty Point");return this.getCoordinate().y},e.prototype.isEmpty=function(){return this._coordinates.size()===0},e.prototype.init=function(i){i===null&&(i=this.getFactory().getCoordinateSequenceFactory().create([])),Pr.isTrue(i.size()<=1),this._coordinates=i},e.prototype.isSimple=function(){return!0},e.prototype.interfaces_=function(){return[Qw]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return 4902022702746615e3},Object.defineProperties(e,n),e}(ir),cg=function(){};cg.prototype.interfaces_=function(){return[]};cg.prototype.getClass=function(){return cg};var us=function(t){function e(r,i,o){if(t.call(this,o),this._shell=null,this._holes=null,r===null&&(r=this.getFactory().createLinearRing()),i===null&&(i=[]),t.hasNullElements(i))throw new oo("holes must not contain null elements");if(r.isEmpty()&&t.hasNonEmptyElements(i))throw new oo("shell is empty but holes are not");this._shell=r,this._holes=i}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.computeEnvelopeInternal=function(){return this._shell.getEnvelopeInternal()},e.prototype.getSortIndex=function(){return t.SORTINDEX_POLYGON},e.prototype.getCoordinates=function(){var i=this;if(this.isEmpty())return[];for(var o=new Array(this.getNumPoints()).fill(null),a=-1,s=this._shell.getCoordinates(),u=0;u<s.length;u++)a++,o[a]=s[u];for(var d=0;d<this._holes.length;d++)for(var g=i._holes[d].getCoordinates(),_=0;_<g.length;_++)a++,o[a]=g[_];return o},e.prototype.getArea=function(){var i=this,o=0;o+=Math.abs(Rn.signedArea(this._shell.getCoordinateSequence()));for(var a=0;a<this._holes.length;a++)o-=Math.abs(Rn.signedArea(i._holes[a].getCoordinateSequence()));return o},e.prototype.isRectangle=function(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;for(var i=this._shell.getCoordinateSequence(),o=this.getEnvelopeInternal(),a=0;a<5;a++){var s=i.getX(a);if(!(s===o.getMinX()||s===o.getMaxX()))return!1;var u=i.getY(a);if(!(u===o.getMinY()||u===o.getMaxY()))return!1}for(var d=i.getX(0),g=i.getY(0),_=1;_<=4;_++){var E=i.getX(_),P=i.getY(_),O=E!==d,D=P!==g;if(O===D)return!1;d=E,g=P}return!0},e.prototype.equalsExact=function(){var i=this;if(arguments.length===2){var o=arguments[0],a=arguments[1];if(!this.isEquivalentClass(o))return!1;var s=o,u=this._shell,d=s._shell;if(!u.equalsExact(d,a)||this._holes.length!==s._holes.length)return!1;for(var g=0;g<this._holes.length;g++)if(!i._holes[g].equalsExact(s._holes[g],a))return!1;return!0}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.normalize=function(){var i=this;if(arguments.length===0){this.normalize(this._shell,!0);for(var o=0;o<this._holes.length;o++)i.normalize(i._holes[o],!1);$m.sort(this._holes)}else if(arguments.length===2){var a=arguments[0],s=arguments[1];if(a.isEmpty())return null;var u=new Array(a.getCoordinates().length-1).fill(null);qs.arraycopy(a.getCoordinates(),0,u,0,u.length);var d=zr.minCoordinate(a.getCoordinates());zr.scroll(u,d),qs.arraycopy(u,0,a.getCoordinates(),0,u.length),a.getCoordinates()[u.length]=u[0],Rn.isCCW(a.getCoordinates())===s&&zr.reverse(a.getCoordinates())}},e.prototype.getCoordinate=function(){return this._shell.getCoordinate()},e.prototype.getNumInteriorRing=function(){return this._holes.length},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.getLength=function(){var i=this,o=0;o+=this._shell.getLength();for(var a=0;a<this._holes.length;a++)o+=i._holes[a].getLength();return o},e.prototype.getNumPoints=function(){for(var i=this,o=this._shell.getNumPoints(),a=0;a<this._holes.length;a++)o+=i._holes[a].getNumPoints();return o},e.prototype.reverse=function(){var i=this,o=this.copy();o._shell=this._shell.copy().reverse(),o._holes=new Array(this._holes.length).fill(null);for(var a=0;a<this._holes.length;a++)o._holes[a]=i._holes[a].copy().reverse();return o},e.prototype.convexHull=function(){return this.getExteriorRing().convexHull()},e.prototype.compareToSameClass=function(){var i=this;if(arguments.length===1){var o=arguments[0],a=this._shell,s=o._shell;return a.compareToSameClass(s)}else if(arguments.length===2){var u=arguments[0],d=arguments[1],g=u,_=this._shell,E=g._shell,P=_.compareToSameClass(E,d);if(P!==0)return P;for(var O=this.getNumInteriorRing(),D=g.getNumInteriorRing(),V=0;V<O&&V<D;){var k=i.getInteriorRingN(V),F=g.getInteriorRingN(V),z=k.compareToSameClass(F,d);if(z!==0)return z;V++}return V<O?1:V<D?-1:0}},e.prototype.apply=function(i){var o=this;if(ar(i,Ch)){this._shell.apply(i);for(var a=0;a<this._holes.length;a++)o._holes[a].apply(i)}else if(ar(i,bc)){if(this._shell.apply(i),!i.isDone())for(var s=0;s<this._holes.length&&(o._holes[s].apply(i),!i.isDone());s++);i.isGeometryChanged()&&this.geometryChanged()}else if(ar(i,Ef))i.filter(this);else if(ar(i,Hd)){i.filter(this),this._shell.apply(i);for(var u=0;u<this._holes.length;u++)o._holes[u].apply(i)}},e.prototype.getBoundary=function(){var i=this;if(this.isEmpty())return this.getFactory().createMultiLineString();var o=new Array(this._holes.length+1).fill(null);o[0]=this._shell;for(var a=0;a<this._holes.length;a++)o[a+1]=i._holes[a];return o.length<=1?this.getFactory().createLinearRing(o[0].getCoordinateSequence()):this.getFactory().createMultiLineString(o)},e.prototype.clone=function(){var i=this,o=t.prototype.clone.call(this);o._shell=this._shell.clone(),o._holes=new Array(this._holes.length).fill(null);for(var a=0;a<this._holes.length;a++)o._holes[a]=i._holes[a].clone();return o},e.prototype.getGeometryType=function(){return"Polygon"},e.prototype.copy=function(){for(var i=this,o=this._shell.copy(),a=new Array(this._holes.length).fill(null),s=0;s<a.length;s++)a[s]=i._holes[s].copy();return new e(o,a,this._factory)},e.prototype.getExteriorRing=function(){return this._shell},e.prototype.isEmpty=function(){return this._shell.isEmpty()},e.prototype.getInteriorRingN=function(i){return this._holes[i]},e.prototype.interfaces_=function(){return[cg]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x307ffefd8dc97200},Object.defineProperties(e,n),e}(ir),e1=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ir.SORTINDEX_MULTIPOINT},e.prototype.isValid=function(){return!0},e.prototype.equalsExact=function(){if(arguments.length===2){var i=arguments[0],o=arguments[1];return this.isEquivalentClass(i)?t.prototype.equalsExact.call(this,i,o):!1}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getCoordinate=function(){if(arguments.length===1){var i=arguments[0];return this._geometries[i].getCoordinate()}else return t.prototype.getCoordinate.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return ii.FALSE},e.prototype.getDimension=function(){return 0},e.prototype.getBoundary=function(){return this.getFactory().createGeometryCollection(null)},e.prototype.getGeometryType=function(){return"MultiPoint"},e.prototype.copy=function(){for(var i=this,o=new Array(this._geometries.length).fill(null),a=0;a<o.length;a++)o[a]=i._geometries[a].copy();return new e(o,this._factory)},e.prototype.interfaces_=function(){return[Qw]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-8048474874175356e3},Object.defineProperties(e,n),e}(Ra),Ph=function(t){function e(r,i){r instanceof dt&&i instanceof kr&&(r=i.getCoordinateSequenceFactory().create(r)),t.call(this,r,i),this.validateConstruction()}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={MINIMUM_VALID_SIZE:{configurable:!0},serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ir.SORTINDEX_LINEARRING},e.prototype.getBoundaryDimension=function(){return ii.FALSE},e.prototype.isClosed=function(){return this.isEmpty()?!0:t.prototype.isClosed.call(this)},e.prototype.reverse=function(){var i=this._points.copy();Ro.reverse(i);var o=this.getFactory().createLinearRing(i);return o},e.prototype.validateConstruction=function(){if(!this.isEmpty()&&!t.prototype.isClosed.call(this))throw new oo("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<e.MINIMUM_VALID_SIZE)throw new oo("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")},e.prototype.getGeometryType=function(){return"LinearRing"},e.prototype.copy=function(){return new e(this._points.copy(),this._factory)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.MINIMUM_VALID_SIZE.get=function(){return 4},n.serialVersionUID.get=function(){return-0x3b229e262367a600},Object.defineProperties(e,n),e}(bo),yh=function(t){function e(){t.apply(this,arguments)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={serialVersionUID:{configurable:!0}};return e.prototype.getSortIndex=function(){return ir.SORTINDEX_MULTIPOLYGON},e.prototype.equalsExact=function(){if(arguments.length===2){var i=arguments[0],o=arguments[1];return this.isEquivalentClass(i)?t.prototype.equalsExact.call(this,i,o):!1}else return t.prototype.equalsExact.apply(this,arguments)},e.prototype.getBoundaryDimension=function(){return 1},e.prototype.getDimension=function(){return 2},e.prototype.reverse=function(){for(var i=this,o=this._geometries.length,a=new Array(o).fill(null),s=0;s<this._geometries.length;s++)a[s]=i._geometries[s].reverse();return this.getFactory().createMultiPolygon(a)},e.prototype.getBoundary=function(){var i=this;if(this.isEmpty())return this.getFactory().createMultiLineString();for(var o=new bn,a=0;a<this._geometries.length;a++)for(var s=i._geometries[a],u=s.getBoundary(),d=0;d<u.getNumGeometries();d++)o.add(u.getGeometryN(d));var g=new Array(o.size()).fill(null);return this.getFactory().createMultiLineString(o.toArray(g))},e.prototype.getGeometryType=function(){return"MultiPolygon"},e.prototype.copy=function(){for(var i=this,o=new Array(this._geometries.length).fill(null),a=0;a<o.length;a++)o[a]=i._geometries[a].copy();return new e(o,this._factory)},e.prototype.interfaces_=function(){return[cg]},e.prototype.getClass=function(){return e},n.serialVersionUID.get=function(){return-0x7a5aa1369171980},Object.defineProperties(e,n),e}(Ra),Fu=function(e){this._factory=e||null,this._isUserDataCopied=!1},yR={NoOpGeometryOperation:{configurable:!0},CoordinateOperation:{configurable:!0},CoordinateSequenceOperation:{configurable:!0}};Fu.prototype.setCopyUserData=function(e){this._isUserDataCopied=e};Fu.prototype.edit=function(e,n){if(e===null)return null;var r=this.editInternal(e,n);return this._isUserDataCopied&&r.setUserData(e.getUserData()),r};Fu.prototype.editInternal=function(e,n){return this._factory===null&&(this._factory=e.getFactory()),e instanceof Ra?this.editGeometryCollection(e,n):e instanceof us?this.editPolygon(e,n):e instanceof Il?n.edit(e,this._factory):e instanceof bo?n.edit(e,this._factory):(Pr.shouldNeverReachHere("Unsupported Geometry class: "+e.getClass().getName()),null)};Fu.prototype.editGeometryCollection=function(e,n){for(var r=this,i=n.edit(e,this._factory),o=new bn,a=0;a<i.getNumGeometries();a++){var s=r.edit(i.getGeometryN(a),n);s===null||s.isEmpty()||o.add(s)}return i.getClass()===e1?this._factory.createMultiPoint(o.toArray([])):i.getClass()===tA?this._factory.createMultiLineString(o.toArray([])):i.getClass()===yh?this._factory.createMultiPolygon(o.toArray([])):this._factory.createGeometryCollection(o.toArray([]))};Fu.prototype.editPolygon=function(e,n){var r=this,i=n.edit(e,this._factory);if(i===null&&(i=this._factory.createPolygon(null)),i.isEmpty())return i;var o=this.edit(i.getExteriorRing(),n);if(o===null||o.isEmpty())return this._factory.createPolygon();for(var a=new bn,s=0;s<i.getNumInteriorRing();s++){var u=r.edit(i.getInteriorRingN(s),n);u===null||u.isEmpty()||a.add(u)}return this._factory.createPolygon(o,a.toArray([]))};Fu.prototype.interfaces_=function(){return[]};Fu.prototype.getClass=function(){return Fu};Fu.GeometryEditorOperation=function(){};yR.NoOpGeometryOperation.get=function(){return Kw};yR.CoordinateOperation.get=function(){return Jw};yR.CoordinateSequenceOperation.get=function(){return eE};Object.defineProperties(Fu,yR);var Kw=function(){};Kw.prototype.edit=function(e,n){return e};Kw.prototype.interfaces_=function(){return[Fu.GeometryEditorOperation]};Kw.prototype.getClass=function(){return Kw};var Jw=function(){};Jw.prototype.edit=function(e,n){var r=this.editCoordinates(e.getCoordinates(),e);return r===null?e:e instanceof Ph?n.createLinearRing(r):e instanceof bo?n.createLineString(r):e instanceof Il?r.length>0?n.createPoint(r[0]):n.createPoint():e};Jw.prototype.interfaces_=function(){return[Fu.GeometryEditorOperation]};Jw.prototype.getClass=function(){return Jw};var eE=function(){};eE.prototype.edit=function(e,n){return e instanceof Ph?n.createLinearRing(this.edit(e.getCoordinateSequence(),e)):e instanceof bo?n.createLineString(this.edit(e.getCoordinateSequence(),e)):e instanceof Il?n.createPoint(this.edit(e.getCoordinateSequence(),e)):e};eE.prototype.interfaces_=function(){return[Fu.GeometryEditorOperation]};eE.prototype.getClass=function(){return eE};var Mo=function(){var e=this;if(this._dimension=3,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array)this._coordinates=arguments[0],this._dimension=3;else if(Number.isInteger(arguments[0])){var n=arguments[0];this._coordinates=new Array(n).fill(null);for(var r=0;r<n;r++)e._coordinates[r]=new dt}else if(ar(arguments[0],Yr)){var i=arguments[0];if(i===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=i.getDimension(),this._coordinates=new Array(i.size()).fill(null);for(var o=0;o<this._coordinates.length;o++)e._coordinates[o]=i.getCoordinateCopy(o)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){var a=arguments[0],s=arguments[1];this._coordinates=a,this._dimension=s,a===null&&(this._coordinates=new Array(0).fill(null))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){var u=arguments[0],d=arguments[1];this._coordinates=new Array(u).fill(null),this._dimension=d;for(var g=0;g<u;g++)e._coordinates[g]=new dt}}},lie={serialVersionUID:{configurable:!0}};Mo.prototype.setOrdinate=function(e,n,r){switch(n){case Yr.X:this._coordinates[e].x=r;break;case Yr.Y:this._coordinates[e].y=r;break;case Yr.Z:this._coordinates[e].z=r;break;default:throw new oo("invalid ordinateIndex")}};Mo.prototype.size=function(){return this._coordinates.length};Mo.prototype.getOrdinate=function(e,n){switch(n){case Yr.X:return this._coordinates[e].x;case Yr.Y:return this._coordinates[e].y;case Yr.Z:return this._coordinates[e].z}return mr.NaN};Mo.prototype.getCoordinate=function(){if(arguments.length===1){var e=arguments[0];return this._coordinates[e]}else if(arguments.length===2){var n=arguments[0],r=arguments[1];r.x=this._coordinates[n].x,r.y=this._coordinates[n].y,r.z=this._coordinates[n].z}};Mo.prototype.getCoordinateCopy=function(e){return new dt(this._coordinates[e])};Mo.prototype.getDimension=function(){return this._dimension};Mo.prototype.getX=function(e){return this._coordinates[e].x};Mo.prototype.clone=function(){for(var e=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=e._coordinates[r].clone();return new Mo(n,this._dimension)};Mo.prototype.expandEnvelope=function(e){for(var n=this,r=0;r<this._coordinates.length;r++)e.expandToInclude(n._coordinates[r]);return e};Mo.prototype.copy=function(){for(var e=this,n=new Array(this.size()).fill(null),r=0;r<this._coordinates.length;r++)n[r]=e._coordinates[r].copy();return new Mo(n,this._dimension)};Mo.prototype.toString=function(){var e=this;if(this._coordinates.length>0){var n=new Df(17*this._coordinates.length);n.append("("),n.append(this._coordinates[0]);for(var r=1;r<this._coordinates.length;r++)n.append(", "),n.append(e._coordinates[r]);return n.append(")"),n.toString()}else return"()"};Mo.prototype.getY=function(e){return this._coordinates[e].y};Mo.prototype.toCoordinateArray=function(){return this._coordinates};Mo.prototype.interfaces_=function(){return[Yr,Gu]};Mo.prototype.getClass=function(){return Mo};lie.serialVersionUID.get=function(){return-0xcb44a778db18e00};Object.defineProperties(Mo,lie);var Ih=function(){},I6={serialVersionUID:{configurable:!0},instanceObject:{configurable:!0}};Ih.prototype.readResolve=function(){return Ih.instance()};Ih.prototype.create=function(){if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return new Mo(e)}else if(ar(arguments[0],Yr)){var n=arguments[0];return new Mo(n)}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];return i>3&&(i=3),i<2?new Mo(r):new Mo(r,i)}};Ih.prototype.interfaces_=function(){return[Xv,Gu]};Ih.prototype.getClass=function(){return Ih};Ih.instance=function(){return Ih.instanceObject};I6.serialVersionUID.get=function(){return-0x38e49fa6cf6f2e00};I6.instanceObject.get=function(){return new Ih};Object.defineProperties(Ih,I6);var uie=function(t){function e(){t.call(this),this.map_=new Map}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.get=function(r){return this.map_.get(r)||null},e.prototype.put=function(r,i){return this.map_.set(r,i),i},e.prototype.values=function(){for(var r=new bn,i=this.map_.values(),o=i.next();!o.done;)r.add(o.value),o=i.next();return r},e.prototype.entrySet=function(){var r=new C6;return this.map_.entries().forEach(function(i){return r.add(i)}),r},e.prototype.size=function(){return this.map_.size()},e}(v_),si=function t(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=t.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Sf){var e=arguments[0];this._modelType=e,e===t.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){var n=arguments[0];this._modelType=t.FIXED,this.setScale(n)}else if(arguments[0]instanceof t){var r=arguments[0];this._modelType=r._modelType,this._scale=r._scale}}},M6={serialVersionUID:{configurable:!0},maximumPreciseValue:{configurable:!0}};si.prototype.equals=function(e){if(!(e instanceof si))return!1;var n=e;return this._modelType===n._modelType&&this._scale===n._scale};si.prototype.compareTo=function(e){var n=e,r=this.getMaximumSignificantDigits(),i=n.getMaximumSignificantDigits();return new bf(r).compareTo(new bf(i))};si.prototype.getScale=function(){return this._scale};si.prototype.isFloating=function(){return this._modelType===si.FLOATING||this._modelType===si.FLOATING_SINGLE};si.prototype.getType=function(){return this._modelType};si.prototype.toString=function(){var e="UNKNOWN";return this._modelType===si.FLOATING?e="Floating":this._modelType===si.FLOATING_SINGLE?e="Floating-Single":this._modelType===si.FIXED&&(e="Fixed (Scale="+this.getScale()+")"),e};si.prototype.makePrecise=function(){if(typeof arguments[0]=="number"){var e=arguments[0];if(mr.isNaN(e))return e;if(this._modelType===si.FLOATING_SINGLE){var n=e;return n}return this._modelType===si.FIXED?Math.round(e*this._scale)/this._scale:e}else if(arguments[0]instanceof dt){var r=arguments[0];if(this._modelType===si.FLOATING)return null;r.x=this.makePrecise(r.x),r.y=this.makePrecise(r.y)}};si.prototype.getMaximumSignificantDigits=function(){var e=16;return this._modelType===si.FLOATING?e=16:this._modelType===si.FLOATING_SINGLE?e=6:this._modelType===si.FIXED&&(e=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),e};si.prototype.setScale=function(e){this._scale=Math.abs(e)};si.prototype.interfaces_=function(){return[Gu,Uu]};si.prototype.getClass=function(){return si};si.mostPrecise=function(e,n){return e.compareTo(n)>=0?e:n};M6.serialVersionUID.get=function(){return 7777263578777804e3};M6.maximumPreciseValue.get=function(){return 9007199254740992};Object.defineProperties(si,M6);var Sf=function t(e){this._name=e||null,t.nameToTypeMap.put(e,this)},O6={serialVersionUID:{configurable:!0},nameToTypeMap:{configurable:!0}};Sf.prototype.readResolve=function(){return Sf.nameToTypeMap.get(this._name)};Sf.prototype.toString=function(){return this._name};Sf.prototype.interfaces_=function(){return[Gu]};Sf.prototype.getClass=function(){return Sf};O6.serialVersionUID.get=function(){return-552860263173159e4};O6.nameToTypeMap.get=function(){return new uie};Object.defineProperties(Sf,O6);si.Type=Sf;si.FIXED=new Sf("FIXED");si.FLOATING=new Sf("FLOATING");si.FLOATING_SINGLE=new Sf("FLOATING SINGLE");var kr=function t(){this._precisionModel=new si,this._SRID=0,this._coordinateSequenceFactory=t.getDefaultCoordinateSequenceFactory(),arguments.length===0||(arguments.length===1?ar(arguments[0],Xv)?this._coordinateSequenceFactory=arguments[0]:arguments[0]instanceof si&&(this._precisionModel=arguments[0]):arguments.length===2?(this._precisionModel=arguments[0],this._SRID=arguments[1]):arguments.length===3&&(this._precisionModel=arguments[0],this._SRID=arguments[1],this._coordinateSequenceFactory=arguments[2]))},cie={serialVersionUID:{configurable:!0}};kr.prototype.toGeometry=function(e){return e.isNull()?this.createPoint(null):e.getMinX()===e.getMaxX()&&e.getMinY()===e.getMaxY()?this.createPoint(new dt(e.getMinX(),e.getMinY())):e.getMinX()===e.getMaxX()||e.getMinY()===e.getMaxY()?this.createLineString([new dt(e.getMinX(),e.getMinY()),new dt(e.getMaxX(),e.getMaxY())]):this.createPolygon(this.createLinearRing([new dt(e.getMinX(),e.getMinY()),new dt(e.getMinX(),e.getMaxY()),new dt(e.getMaxX(),e.getMaxY()),new dt(e.getMaxX(),e.getMinY()),new dt(e.getMinX(),e.getMinY())]),null)};kr.prototype.createLineString=function(e){if(e){if(e instanceof Array)return new bo(this.getCoordinateSequenceFactory().create(e),this);if(ar(e,Yr))return new bo(e,this)}else return new bo(this.getCoordinateSequenceFactory().create([]),this)};kr.prototype.createMultiLineString=function(){if(arguments.length===0)return new tA(null,this);if(arguments.length===1){var e=arguments[0];return new tA(e,this)}};kr.prototype.buildGeometry=function(e){for(var n=null,r=!1,i=!1,o=e.iterator();o.hasNext();){var a=o.next(),s=a.getClass();n===null&&(n=s),s!==n&&(r=!0),a.isGeometryCollectionOrDerived()&&(i=!0)}if(n===null)return this.createGeometryCollection();if(r||i)return this.createGeometryCollection(kr.toGeometryArray(e));var u=e.iterator().next(),d=e.size()>1;if(d){if(u instanceof us)return this.createMultiPolygon(kr.toPolygonArray(e));if(u instanceof bo)return this.createMultiLineString(kr.toLineStringArray(e));if(u instanceof Il)return this.createMultiPoint(kr.toPointArray(e));Pr.shouldNeverReachHere("Unhandled class: "+u.getClass().getName())}return u};kr.prototype.createMultiPointFromCoords=function(e){return this.createMultiPoint(e!==null?this.getCoordinateSequenceFactory().create(e):null)};kr.prototype.createPoint=function(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof dt){var e=arguments[0];return this.createPoint(e!==null?this.getCoordinateSequenceFactory().create([e]):null)}else if(ar(arguments[0],Yr)){var n=arguments[0];return new Il(n,this)}}};kr.prototype.getCoordinateSequenceFactory=function(){return this._coordinateSequenceFactory};kr.prototype.createPolygon=function(){if(arguments.length===0)return new us(null,null,this);if(arguments.length===1){if(ar(arguments[0],Yr)){var e=arguments[0];return this.createPolygon(this.createLinearRing(e))}else if(arguments[0]instanceof Array){var n=arguments[0];return this.createPolygon(this.createLinearRing(n))}else if(arguments[0]instanceof Ph){var r=arguments[0];return this.createPolygon(r,null)}}else if(arguments.length===2){var i=arguments[0],o=arguments[1];return new us(i,o,this)}};kr.prototype.getSRID=function(){return this._SRID};kr.prototype.createGeometryCollection=function(){if(arguments.length===0)return new Ra(null,this);if(arguments.length===1){var e=arguments[0];return new Ra(e,this)}};kr.prototype.createGeometry=function(e){var n=new Fu(this);return n.edit(e,{edit:function(){if(arguments.length===2){var r=arguments[0];return this._coordinateSequenceFactory.create(r)}}})};kr.prototype.getPrecisionModel=function(){return this._precisionModel};kr.prototype.createLinearRing=function(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){var e=arguments[0];return this.createLinearRing(e!==null?this.getCoordinateSequenceFactory().create(e):null)}else if(ar(arguments[0],Yr)){var n=arguments[0];return new Ph(n,this)}}};kr.prototype.createMultiPolygon=function(){if(arguments.length===0)return new yh(null,this);if(arguments.length===1){var e=arguments[0];return new yh(e,this)}};kr.prototype.createMultiPoint=function(){var e=this;if(arguments.length===0)return new e1(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];return new e1(n,this)}else if(arguments[0]instanceof Array){var r=arguments[0];return this.createMultiPoint(r!==null?this.getCoordinateSequenceFactory().create(r):null)}else if(ar(arguments[0],Yr)){var i=arguments[0];if(i===null)return this.createMultiPoint(new Array(0).fill(null));for(var o=new Array(i.size()).fill(null),a=0;a<i.size();a++){var s=e.getCoordinateSequenceFactory().create(1,i.getDimension());Ro.copy(i,a,s,0,1),o[a]=e.createPoint(s)}return this.createMultiPoint(o)}}};kr.prototype.interfaces_=function(){return[Gu]};kr.prototype.getClass=function(){return kr};kr.toMultiPolygonArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};kr.toGeometryArray=function(e){if(e===null)return null;var n=new Array(e.size()).fill(null);return e.toArray(n)};kr.getDefaultCoordinateSequenceFactory=function(){return Ih.instance()};kr.toMultiLineStringArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};kr.toLineStringArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};kr.toMultiPointArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};kr.toLinearRingArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};kr.toPointArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};kr.toPolygonArray=function(e){var n=new Array(e.size()).fill(null);return e.toArray(n)};kr.createPointFromInternalCoord=function(e,n){return n.getPrecisionModel().makePrecise(e),n.getFactory().createPoint(e)};cie.serialVersionUID.get=function(){return-6820524753094096e3};Object.defineProperties(kr,cie);var $Re=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],vR=function(e){this.geometryFactory=e||new kr};vR.prototype.read=function(e){var n;typeof e=="string"?n=JSON.parse(e):n=e;var r=n.type;if(!nf[r])throw new Error("Unknown GeoJSON type: "+n.type);return $Re.indexOf(r)!==-1?nf[r].apply(this,[n.coordinates]):r==="GeometryCollection"?nf[r].apply(this,[n.geometries]):nf[r].apply(this,[n])};vR.prototype.write=function(e){var n=e.getGeometryType();if(!wd[n])throw new Error("Geometry is not supported");return wd[n].apply(this,[e])};var nf={Feature:function(t){var e={};for(var n in t)e[n]=t[n];if(t.geometry){var r=t.geometry.type;if(!nf[r])throw new Error("Unknown GeoJSON type: "+t.type);e.geometry=this.read(t.geometry)}return t.bbox&&(e.bbox=nf.bbox.apply(this,[t.bbox])),e},FeatureCollection:function(t){var e=this,n={};if(t.features){n.features=[];for(var r=0;r<t.features.length;++r)n.features.push(e.read(t.features[r]))}return t.bbox&&(n.bbox=this.parse.bbox.apply(this,[t.bbox])),n},coordinates:function(t){for(var e=[],n=0;n<t.length;++n){var r=t[n];e.push(new dt(r[0],r[1]))}return e},bbox:function(t){return this.geometryFactory.createLinearRing([new dt(t[0],t[1]),new dt(t[2],t[1]),new dt(t[2],t[3]),new dt(t[0],t[3]),new dt(t[0],t[1])])},Point:function(t){var e=new dt(t[0],t[1]);return this.geometryFactory.createPoint(e)},MultiPoint:function(t){for(var e=this,n=[],r=0;r<t.length;++r)n.push(nf.Point.apply(e,[t[r]]));return this.geometryFactory.createMultiPoint(n)},LineString:function(t){var e=nf.coordinates.apply(this,[t]);return this.geometryFactory.createLineString(e)},MultiLineString:function(t){for(var e=this,n=[],r=0;r<t.length;++r)n.push(nf.LineString.apply(e,[t[r]]));return this.geometryFactory.createMultiLineString(n)},Polygon:function(t){for(var e=this,n=nf.coordinates.apply(this,[t[0]]),r=this.geometryFactory.createLinearRing(n),i=[],o=1;o<t.length;++o){var a=t[o],s=nf.coordinates.apply(e,[a]),u=e.geometryFactory.createLinearRing(s);i.push(u)}return this.geometryFactory.createPolygon(r,i)},MultiPolygon:function(t){for(var e=this,n=[],r=0;r<t.length;++r){var i=t[r];n.push(nf.Polygon.apply(e,[i]))}return this.geometryFactory.createMultiPolygon(n)},GeometryCollection:function(t){for(var e=this,n=[],r=0;r<t.length;++r){var i=t[r];n.push(e.read(i))}return this.geometryFactory.createGeometryCollection(n)}},wd={coordinate:function(t){return[t.x,t.y]},Point:function(t){var e=wd.coordinate.apply(this,[t.getCoordinate()]);return{type:"Point",coordinates:e}},MultiPoint:function(t){for(var e=this,n=[],r=0;r<t._geometries.length;++r){var i=t._geometries[r],o=wd.Point.apply(e,[i]);n.push(o.coordinates)}return{type:"MultiPoint",coordinates:n}},LineString:function(t){for(var e=this,n=[],r=t.getCoordinates(),i=0;i<r.length;++i){var o=r[i];n.push(wd.coordinate.apply(e,[o]))}return{type:"LineString",coordinates:n}},MultiLineString:function(t){for(var e=this,n=[],r=0;r<t._geometries.length;++r){var i=t._geometries[r],o=wd.LineString.apply(e,[i]);n.push(o.coordinates)}return{type:"MultiLineString",coordinates:n}},Polygon:function(t){var e=this,n=[],r=wd.LineString.apply(this,[t._shell]);n.push(r.coordinates);for(var i=0;i<t._holes.length;++i){var o=t._holes[i],a=wd.LineString.apply(e,[o]);n.push(a.coordinates)}return{type:"Polygon",coordinates:n}},MultiPolygon:function(t){for(var e=this,n=[],r=0;r<t._geometries.length;++r){var i=t._geometries[r],o=wd.Polygon.apply(e,[i]);n.push(o.coordinates)}return{type:"MultiPolygon",coordinates:n}},GeometryCollection:function(t){for(var e=this,n=[],r=0;r<t._geometries.length;++r){var i=t._geometries[r],o=i.getGeometryType();n.push(wd[o].apply(e,[i]))}return{type:"GeometryCollection",geometries:n}}},R6=function(e){this.geometryFactory=e||new kr,this.precisionModel=this.geometryFactory.getPrecisionModel(),this.parser=new vR(this.geometryFactory)};R6.prototype.read=function(e){var n=this.parser.read(e);return this.precisionModel.getType()===si.FIXED&&this.reducePrecision(n),n};R6.prototype.reducePrecision=function(e){var n=this,r,i;if(e.coordinate)this.precisionModel.makePrecise(e.coordinate);else if(e.points)for(r=0,i=e.points.length;r<i;r++)n.precisionModel.makePrecise(e.points[r]);else if(e.geometries)for(r=0,i=e.geometries.length;r<i;r++)n.reducePrecision(e.geometries[r])};var fie=function(){this.parser=new vR(this.geometryFactory)};fie.prototype.write=function(e){return this.parser.write(e)};var gn=function(){},xR={ON:{configurable:!0},LEFT:{configurable:!0},RIGHT:{configurable:!0}};gn.prototype.interfaces_=function(){return[]};gn.prototype.getClass=function(){return gn};gn.opposite=function(e){return e===gn.LEFT?gn.RIGHT:e===gn.RIGHT?gn.LEFT:e};xR.ON.get=function(){return 0};xR.LEFT.get=function(){return 1};xR.RIGHT.get=function(){return 2};Object.defineProperties(gn,xR);function bR(t){this.message=t||""}bR.prototype=new Error;bR.prototype.name="EmptyStackException";function Bf(){this.array_=[]}Bf.prototype=new Ac;Bf.prototype.add=function(t){return this.array_.push(t),!0};Bf.prototype.get=function(t){if(t<0||t>=this.size())throw new Error;return this.array_[t]};Bf.prototype.push=function(t){return this.array_.push(t),t};Bf.prototype.pop=function(t){if(this.array_.length===0)throw new bR;return this.array_.pop()};Bf.prototype.peek=function(){if(this.array_.length===0)throw new bR;return this.array_[this.array_.length-1]};Bf.prototype.empty=function(){return this.array_.length===0};Bf.prototype.isEmpty=function(){return this.empty()};Bf.prototype.search=function(t){return this.array_.indexOf(t)};Bf.prototype.size=function(){return this.array_.length};Bf.prototype.toArray=function(){for(var t=this,e=[],n=0,r=this.array_.length;n<r;n++)e.push(t.array_[n]);return e};var Tf=function(){this._minIndex=-1,this._minCoord=null,this._minDe=null,this._orientedDe=null};Tf.prototype.getCoordinate=function(){return this._minCoord};Tf.prototype.getRightmostSide=function(e,n){var r=this.getRightmostSideOfSegment(e,n);return r<0&&(r=this.getRightmostSideOfSegment(e,n-1)),r<0&&(this._minCoord=null,this.checkForRightmostCoordinate(e)),r};Tf.prototype.findRightmostEdgeAtVertex=function(){var e=this._minDe.getEdge().getCoordinates();Pr.isTrue(this._minIndex>0&&this._minIndex<e.length,"rightmost point expected to be interior vertex of edge");var n=e[this._minIndex-1],r=e[this._minIndex+1],i=Rn.computeOrientation(this._minCoord,r,n),o=!1;(n.y<this._minCoord.y&&r.y<this._minCoord.y&&i===Rn.COUNTERCLOCKWISE||n.y>this._minCoord.y&&r.y>this._minCoord.y&&i===Rn.CLOCKWISE)&&(o=!0),o&&(this._minIndex=this._minIndex-1)};Tf.prototype.getRightmostSideOfSegment=function(e,n){var r=e.getEdge(),i=r.getCoordinates();if(n<0||n+1>=i.length||i[n].y===i[n+1].y)return-1;var o=gn.LEFT;return i[n].y<i[n+1].y&&(o=gn.RIGHT),o};Tf.prototype.getEdge=function(){return this._orientedDe};Tf.prototype.checkForRightmostCoordinate=function(e){for(var n=this,r=e.getEdge().getCoordinates(),i=0;i<r.length-1;i++)(n._minCoord===null||r[i].x>n._minCoord.x)&&(n._minDe=e,n._minIndex=i,n._minCoord=r[i])};Tf.prototype.findRightmostEdgeAtNode=function(){var e=this._minDe.getNode(),n=e.getEdges();this._minDe=n.getRightmostEdge(),this._minDe.isForward()||(this._minDe=this._minDe.getSym(),this._minIndex=this._minDe.getEdge().getCoordinates().length-1)};Tf.prototype.findEdge=function(e){for(var n=this,r=e.iterator();r.hasNext();){var i=r.next();i.isForward()&&n.checkForRightmostCoordinate(i)}Pr.isTrue(this._minIndex!==0||this._minCoord.equals(this._minDe.getCoordinate()),"inconsistency in rightmost processing"),this._minIndex===0?this.findRightmostEdgeAtNode():this.findRightmostEdgeAtVertex(),this._orientedDe=this._minDe;var o=this.getRightmostSide(this._minDe,this._minIndex);o===gn.LEFT&&(this._orientedDe=this._minDe.getSym())};Tf.prototype.interfaces_=function(){return[]};Tf.prototype.getClass=function(){return Tf};var Wd=function(t){function e(n,r){t.call(this,e.msgWithCoord(n,r)),this.pt=r?new dt(r):null,this.name="TopologyException"}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getCoordinate=function(){return this.pt},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.msgWithCoord=function(r,i){return i?r:r+" [ "+i+" ]"},e}($d),wR=function(){this.array_=[]};wR.prototype.addLast=function(e){this.array_.push(e)};wR.prototype.removeFirst=function(){return this.array_.shift()};wR.prototype.isEmpty=function(){return this.array_.length===0};var La=function(){this._finder=null,this._dirEdgeList=new bn,this._nodes=new bn,this._rightMostCoord=null,this._env=null,this._finder=new Tf};La.prototype.clearVisitedEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var n=e.next();n.setVisited(!1)}};La.prototype.getRightmostCoordinate=function(){return this._rightMostCoord};La.prototype.computeNodeDepth=function(e){for(var n=this,r=null,i=e.getEdges().iterator();i.hasNext();){var o=i.next();if(o.isVisited()||o.getSym().isVisited()){r=o;break}}if(r===null)throw new Wd("unable to find edge to compute depths at "+e.getCoordinate());e.getEdges().computeDepths(r);for(var a=e.getEdges().iterator();a.hasNext();){var s=a.next();s.setVisited(!0),n.copySymDepths(s)}};La.prototype.computeDepth=function(e){this.clearVisitedEdges();var n=this._finder.getEdge();n.setEdgeDepths(gn.RIGHT,e),this.copySymDepths(n),this.computeDepths(n)};La.prototype.create=function(e){this.addReachable(e),this._finder.findEdge(this._dirEdgeList),this._rightMostCoord=this._finder.getCoordinate()};La.prototype.findResultEdges=function(){for(var e=this._dirEdgeList.iterator();e.hasNext();){var n=e.next();n.getDepth(gn.RIGHT)>=1&&n.getDepth(gn.LEFT)<=0&&!n.isInteriorAreaEdge()&&n.setInResult(!0)}};La.prototype.computeDepths=function(e){var n=this,r=new C6,i=new wR,o=e.getNode();for(i.addLast(o),r.add(o),e.setVisited(!0);!i.isEmpty();){var a=i.removeFirst();r.add(a),n.computeNodeDepth(a);for(var s=a.getEdges().iterator();s.hasNext();){var u=s.next(),d=u.getSym();if(!d.isVisited()){var g=d.getNode();r.contains(g)||(i.addLast(g),r.add(g))}}}};La.prototype.compareTo=function(e){var n=e;return this._rightMostCoord.x<n._rightMostCoord.x?-1:this._rightMostCoord.x>n._rightMostCoord.x?1:0};La.prototype.getEnvelope=function(){if(this._env===null){for(var e=new Qn,n=this._dirEdgeList.iterator();n.hasNext();)for(var r=n.next(),i=r.getEdge().getCoordinates(),o=0;o<i.length-1;o++)e.expandToInclude(i[o]);this._env=e}return this._env};La.prototype.addReachable=function(e){var n=this,r=new Bf;for(r.add(e);!r.empty();){var i=r.pop();n.add(i,r)}};La.prototype.copySymDepths=function(e){var n=e.getSym();n.setDepth(gn.LEFT,e.getDepth(gn.RIGHT)),n.setDepth(gn.RIGHT,e.getDepth(gn.LEFT))};La.prototype.add=function(e,n){var r=this;e.setVisited(!0),this._nodes.add(e);for(var i=e.getEdges().iterator();i.hasNext();){var o=i.next();r._dirEdgeList.add(o);var a=o.getSym(),s=a.getNode();s.isVisited()||n.push(s)}};La.prototype.getNodes=function(){return this._nodes};La.prototype.getDirectedEdges=function(){return this._dirEdgeList};La.prototype.interfaces_=function(){return[Uu]};La.prototype.getClass=function(){return La};var Gi=function t(){var e=this;if(this.location=null,arguments.length===1){if(arguments[0]instanceof Array){var n=arguments[0];this.init(n.length)}else if(Number.isInteger(arguments[0])){var r=arguments[0];this.init(1),this.location[gn.ON]=r}else if(arguments[0]instanceof t){var i=arguments[0];if(this.init(i.location.length),i!==null)for(var o=0;o<this.location.length;o++)e.location[o]=i.location[o]}}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];this.init(3),this.location[gn.ON]=a,this.location[gn.LEFT]=s,this.location[gn.RIGHT]=u}};Gi.prototype.setAllLocations=function(e){for(var n=this,r=0;r<this.location.length;r++)n.location[r]=e};Gi.prototype.isNull=function(){for(var e=this,n=0;n<this.location.length;n++)if(e.location[n]!==Et.NONE)return!1;return!0};Gi.prototype.setAllLocationsIfNull=function(e){for(var n=this,r=0;r<this.location.length;r++)n.location[r]===Et.NONE&&(n.location[r]=e)};Gi.prototype.isLine=function(){return this.location.length===1};Gi.prototype.merge=function(e){var n=this;if(e.location.length>this.location.length){var r=new Array(3).fill(null);r[gn.ON]=this.location[gn.ON],r[gn.LEFT]=Et.NONE,r[gn.RIGHT]=Et.NONE,this.location=r}for(var i=0;i<this.location.length;i++)n.location[i]===Et.NONE&&i<e.location.length&&(n.location[i]=e.location[i])};Gi.prototype.getLocations=function(){return this.location};Gi.prototype.flip=function(){if(this.location.length<=1)return null;var e=this.location[gn.LEFT];this.location[gn.LEFT]=this.location[gn.RIGHT],this.location[gn.RIGHT]=e};Gi.prototype.toString=function(){var e=new Df;return this.location.length>1&&e.append(Et.toLocationSymbol(this.location[gn.LEFT])),e.append(Et.toLocationSymbol(this.location[gn.ON])),this.location.length>1&&e.append(Et.toLocationSymbol(this.location[gn.RIGHT])),e.toString()};Gi.prototype.setLocations=function(e,n,r){this.location[gn.ON]=e,this.location[gn.LEFT]=n,this.location[gn.RIGHT]=r};Gi.prototype.get=function(e){return e<this.location.length?this.location[e]:Et.NONE};Gi.prototype.isArea=function(){return this.location.length>1};Gi.prototype.isAnyNull=function(){for(var e=this,n=0;n<this.location.length;n++)if(e.location[n]===Et.NONE)return!0;return!1};Gi.prototype.setLocation=function(){if(arguments.length===1){var e=arguments[0];this.setLocation(gn.ON,e)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.location[n]=r}};Gi.prototype.init=function(e){this.location=new Array(e).fill(null),this.setAllLocations(Et.NONE)};Gi.prototype.isEqualOnSide=function(e,n){return this.location[n]===e.location[n]};Gi.prototype.allPositionsEqual=function(e){for(var n=this,r=0;r<this.location.length;r++)if(n.location[r]!==e)return!1;return!0};Gi.prototype.interfaces_=function(){return[]};Gi.prototype.getClass=function(){return Gi};var di=function t(){if(this.elt=new Array(2).fill(null),arguments.length===1){if(Number.isInteger(arguments[0])){var e=arguments[0];this.elt[0]=new Gi(e),this.elt[1]=new Gi(e)}else if(arguments[0]instanceof t){var n=arguments[0];this.elt[0]=new Gi(n.elt[0]),this.elt[1]=new Gi(n.elt[1])}}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this.elt[0]=new Gi(Et.NONE),this.elt[1]=new Gi(Et.NONE),this.elt[r].setLocation(i)}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];this.elt[0]=new Gi(o,a,s),this.elt[1]=new Gi(o,a,s)}else if(arguments.length===4){var u=arguments[0],d=arguments[1],g=arguments[2],_=arguments[3];this.elt[0]=new Gi(Et.NONE,Et.NONE,Et.NONE),this.elt[1]=new Gi(Et.NONE,Et.NONE,Et.NONE),this.elt[u].setLocations(d,g,_)}};di.prototype.getGeometryCount=function(){var e=0;return this.elt[0].isNull()||e++,this.elt[1].isNull()||e++,e};di.prototype.setAllLocations=function(e,n){this.elt[e].setAllLocations(n)};di.prototype.isNull=function(e){return this.elt[e].isNull()};di.prototype.setAllLocationsIfNull=function(){if(arguments.length===1){var e=arguments[0];this.setAllLocationsIfNull(0,e),this.setAllLocationsIfNull(1,e)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.elt[n].setAllLocationsIfNull(r)}};di.prototype.isLine=function(e){return this.elt[e].isLine()};di.prototype.merge=function(e){for(var n=this,r=0;r<2;r++)n.elt[r]===null&&e.elt[r]!==null?n.elt[r]=new Gi(e.elt[r]):n.elt[r].merge(e.elt[r])};di.prototype.flip=function(){this.elt[0].flip(),this.elt[1].flip()};di.prototype.getLocation=function(){if(arguments.length===1){var e=arguments[0];return this.elt[e].get(gn.ON)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.elt[n].get(r)}};di.prototype.toString=function(){var e=new Df;return this.elt[0]!==null&&(e.append("A:"),e.append(this.elt[0].toString())),this.elt[1]!==null&&(e.append(" B:"),e.append(this.elt[1].toString())),e.toString()};di.prototype.isArea=function(){if(arguments.length===0)return this.elt[0].isArea()||this.elt[1].isArea();if(arguments.length===1){var e=arguments[0];return this.elt[e].isArea()}};di.prototype.isAnyNull=function(e){return this.elt[e].isAnyNull()};di.prototype.setLocation=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1];this.elt[e].setLocation(gn.ON,n)}else if(arguments.length===3){var r=arguments[0],i=arguments[1],o=arguments[2];this.elt[r].setLocation(i,o)}};di.prototype.isEqualOnSide=function(e,n){return this.elt[0].isEqualOnSide(e.elt[0],n)&&this.elt[1].isEqualOnSide(e.elt[1],n)};di.prototype.allPositionsEqual=function(e,n){return this.elt[e].allPositionsEqual(n)};di.prototype.toLine=function(e){this.elt[e].isArea()&&(this.elt[e]=new Gi(this.elt[e].location[0]))};di.prototype.interfaces_=function(){return[]};di.prototype.getClass=function(){return di};di.toLineLabel=function(e){for(var n=new di(Et.NONE),r=0;r<2;r++)n.setLocation(r,e.getLocation(r));return n};var jo=function(){this._startDe=null,this._maxNodeDegree=-1,this._edges=new bn,this._pts=new bn,this._label=new di(Et.NONE),this._ring=null,this._isHole=null,this._shell=null,this._holes=new bn,this._geometryFactory=null;var e=arguments[0],n=arguments[1];this._geometryFactory=n,this.computePoints(e),this.computeRing()};jo.prototype.computeRing=function(){var e=this;if(this._ring!==null)return null;for(var n=new Array(this._pts.size()).fill(null),r=0;r<this._pts.size();r++)n[r]=e._pts.get(r);this._ring=this._geometryFactory.createLinearRing(n),this._isHole=Rn.isCCW(this._ring.getCoordinates())};jo.prototype.isIsolated=function(){return this._label.getGeometryCount()===1};jo.prototype.computePoints=function(e){var n=this;this._startDe=e;var r=e,i=!0;do{if(r===null)throw new Wd("Found null DirectedEdge");if(r.getEdgeRing()===n)throw new Wd("Directed Edge visited twice during ring-building at "+r.getCoordinate());n._edges.add(r);var o=r.getLabel();Pr.isTrue(o.isArea()),n.mergeLabel(o),n.addPoints(r.getEdge(),r.isForward(),i),i=!1,n.setEdgeRing(r,n),r=n.getNext(r)}while(r!==this._startDe)};jo.prototype.getLinearRing=function(){return this._ring};jo.prototype.getCoordinate=function(e){return this._pts.get(e)};jo.prototype.computeMaxNodeDegree=function(){var e=this;this._maxNodeDegree=0;var n=this._startDe;do{var r=n.getNode(),i=r.getEdges().getOutgoingDegree(e);i>e._maxNodeDegree&&(e._maxNodeDegree=i),n=e.getNext(n)}while(n!==this._startDe);this._maxNodeDegree*=2};jo.prototype.addPoints=function(e,n,r){var i=this,o=e.getCoordinates();if(n){var a=1;r&&(a=0);for(var s=a;s<o.length;s++)i._pts.add(o[s])}else{var u=o.length-2;r&&(u=o.length-1);for(var d=u;d>=0;d--)i._pts.add(o[d])}};jo.prototype.isHole=function(){return this._isHole};jo.prototype.setInResult=function(){var e=this._startDe;do e.getEdge().setInResult(!0),e=e.getNext();while(e!==this._startDe)};jo.prototype.containsPoint=function(e){var n=this.getLinearRing(),r=n.getEnvelopeInternal();if(!r.contains(e)||!Rn.isPointInRing(e,n.getCoordinates()))return!1;for(var i=this._holes.iterator();i.hasNext();){var o=i.next();if(o.containsPoint(e))return!1}return!0};jo.prototype.addHole=function(e){this._holes.add(e)};jo.prototype.isShell=function(){return this._shell===null};jo.prototype.getLabel=function(){return this._label};jo.prototype.getEdges=function(){return this._edges};jo.prototype.getMaxNodeDegree=function(){return this._maxNodeDegree<0&&this.computeMaxNodeDegree(),this._maxNodeDegree};jo.prototype.getShell=function(){return this._shell};jo.prototype.mergeLabel=function(){if(arguments.length===1){var e=arguments[0];this.mergeLabel(e,0),this.mergeLabel(e,1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],i=n.getLocation(r,gn.RIGHT);if(i===Et.NONE)return null;if(this._label.getLocation(r)===Et.NONE)return this._label.setLocation(r,i),null}};jo.prototype.setShell=function(e){this._shell=e,e!==null&&e.addHole(this)};jo.prototype.toPolygon=function(e){for(var n=this,r=new Array(this._holes.size()).fill(null),i=0;i<this._holes.size();i++)r[i]=n._holes.get(i).getLinearRing();var o=e.createPolygon(this.getLinearRing(),r);return o};jo.prototype.interfaces_=function(){return[]};jo.prototype.getClass=function(){return jo};var HRe=function(t){function e(){var n=arguments[0],r=arguments[1];t.call(this,n,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.setEdgeRing=function(r,i){r.setMinEdgeRing(i)},e.prototype.getNext=function(r){return r.getNextMin()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(jo),WRe=function(t){function e(){var n=arguments[0],r=arguments[1];t.call(this,n,r)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildMinimalRings=function(){var r=this,i=new bn,o=this._startDe;do{if(o.getMinEdgeRing()===null){var a=new HRe(o,r._geometryFactory);i.add(a)}o=o.getNext()}while(o!==this._startDe);return i},e.prototype.setEdgeRing=function(r,i){r.setEdgeRing(i)},e.prototype.linkDirectedEdgesForMinimalEdgeRings=function(){var r=this,i=this._startDe;do{var o=i.getNode();o.getEdges().linkMinimalDirectedEdges(r),i=i.getNext()}while(i!==this._startDe)},e.prototype.getNext=function(r){return r.getNext()},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(jo),eu=function(){if(this._label=null,this._isInResult=!1,this._isCovered=!1,this._isCoveredSet=!1,this._isVisited=!1,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this._label=e}}};eu.prototype.setVisited=function(e){this._isVisited=e};eu.prototype.setInResult=function(e){this._isInResult=e};eu.prototype.isCovered=function(){return this._isCovered};eu.prototype.isCoveredSet=function(){return this._isCoveredSet};eu.prototype.setLabel=function(e){this._label=e};eu.prototype.getLabel=function(){return this._label};eu.prototype.setCovered=function(e){this._isCovered=e,this._isCoveredSet=!0};eu.prototype.updateIM=function(e){Pr.isTrue(this._label.getGeometryCount()>=2,"found partial label"),this.computeIM(e)};eu.prototype.isInResult=function(){return this._isInResult};eu.prototype.isVisited=function(){return this._isVisited};eu.prototype.interfaces_=function(){return[]};eu.prototype.getClass=function(){return eu};var ER=function(t){function e(){t.call(this),this._coord=null,this._edges=null;var n=arguments[0],r=arguments[1];this._coord=n,this._edges=r,this._label=new di(0,Et.NONE)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isIncidentEdgeInResult=function(){for(var r=this.getEdges().getEdges().iterator();r.hasNext();){var i=r.next();if(i.getEdge().isInResult())return!0}return!1},e.prototype.isIsolated=function(){return this._label.getGeometryCount()===1},e.prototype.getCoordinate=function(){return this._coord},e.prototype.print=function(r){r.println("node "+this._coord+" lbl: "+this._label)},e.prototype.computeIM=function(r){},e.prototype.computeMergedLocation=function(r,i){var o=Et.NONE;if(o=this._label.getLocation(i),!r.isNull(i)){var a=r.getLocation(i);o!==Et.BOUNDARY&&(o=a)}return o},e.prototype.setLabel=function(){if(arguments.length===2){var r=arguments[0],i=arguments[1];this._label===null?this._label=new di(r,i):this._label.setLocation(r,i)}else return t.prototype.setLabel.apply(this,arguments)},e.prototype.getEdges=function(){return this._edges},e.prototype.mergeLabel=function(){var r=this;if(arguments[0]instanceof e){var i=arguments[0];this.mergeLabel(i._label)}else if(arguments[0]instanceof di)for(var o=arguments[0],a=0;a<2;a++){var s=r.computeMergedLocation(o,a),u=r._label.getLocation(a);u===Et.NONE&&r._label.setLocation(a,s)}},e.prototype.add=function(r){this._edges.insert(r),r.setNode(this)},e.prototype.setLabelBoundary=function(r){if(this._label===null)return null;var i=Et.NONE;this._label!==null&&(i=this._label.getLocation(r));var o=null;switch(i){case Et.BOUNDARY:o=Et.INTERIOR;break;case Et.INTERIOR:o=Et.BOUNDARY;break;default:o=Et.BOUNDARY;break}this._label.setLocation(r,o)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(eu),Cf=function(){this.nodeMap=new aa,this.nodeFact=null;var e=arguments[0];this.nodeFact=e};Cf.prototype.find=function(e){return this.nodeMap.get(e)};Cf.prototype.addNode=function(){if(arguments[0]instanceof dt){var e=arguments[0],n=this.nodeMap.get(e);return n===null&&(n=this.nodeFact.createNode(e),this.nodeMap.put(e,n)),n}else if(arguments[0]instanceof ER){var r=arguments[0],i=this.nodeMap.get(r.getCoordinate());return i===null?(this.nodeMap.put(r.getCoordinate(),r),r):(i.mergeLabel(r),i)}};Cf.prototype.print=function(e){for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(e)}};Cf.prototype.iterator=function(){return this.nodeMap.values().iterator()};Cf.prototype.values=function(){return this.nodeMap.values()};Cf.prototype.getBoundaryNodes=function(e){for(var n=new bn,r=this.iterator();r.hasNext();){var i=r.next();i.getLabel().getLocation(e)===Et.BOUNDARY&&n.add(i)}return n};Cf.prototype.add=function(e){var n=e.getCoordinate(),r=this.addNode(n);r.add(e)};Cf.prototype.interfaces_=function(){return[]};Cf.prototype.getClass=function(){return Cf};var yi=function(){},r2={NE:{configurable:!0},NW:{configurable:!0},SW:{configurable:!0},SE:{configurable:!0}};yi.prototype.interfaces_=function(){return[]};yi.prototype.getClass=function(){return yi};yi.isNorthern=function(e){return e===yi.NE||e===yi.NW};yi.isOpposite=function(e,n){if(e===n)return!1;var r=(e-n+4)%4;return r===2};yi.commonHalfPlane=function(e,n){if(e===n)return e;var r=(e-n+4)%4;if(r===2)return-1;var i=e<n?e:n,o=e>n?e:n;return i===0&&o===3?3:i};yi.isInHalfPlane=function(e,n){return n===yi.SE?e===yi.SE||e===yi.SW:e===n||e===n+1};yi.quadrant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],n=arguments[1];if(e===0&&n===0)throw new oo("Cannot compute the quadrant for point ( "+e+", "+n+" )");return e>=0?n>=0?yi.NE:yi.SE:n>=0?yi.NW:yi.SW}else if(arguments[0]instanceof dt&&arguments[1]instanceof dt){var r=arguments[0],i=arguments[1];if(i.x===r.x&&i.y===r.y)throw new oo("Cannot compute the quadrant for two identical points "+r);return i.x>=r.x?i.y>=r.y?yi.NE:yi.SE:i.y>=r.y?yi.NW:yi.SW}};r2.NE.get=function(){return 0};r2.NW.get=function(){return 1};r2.SW.get=function(){return 2};r2.SE.get=function(){return 3};Object.defineProperties(yi,r2);var la=function(){if(this._edge=null,this._label=null,this._node=null,this._p0=null,this._p1=null,this._dx=null,this._dy=null,this._quadrant=null,arguments.length===1){var e=arguments[0];this._edge=e}else if(arguments.length===3){var n=arguments[0],r=arguments[1],i=arguments[2],o=null;this._edge=n,this.init(r,i),this._label=o}else if(arguments.length===4){var a=arguments[0],s=arguments[1],u=arguments[2],d=arguments[3];this._edge=a,this.init(s,u),this._label=d}};la.prototype.compareDirection=function(e){return this._dx===e._dx&&this._dy===e._dy?0:this._quadrant>e._quadrant?1:this._quadrant<e._quadrant?-1:Rn.computeOrientation(e._p0,e._p1,this._p1)};la.prototype.getDy=function(){return this._dy};la.prototype.getCoordinate=function(){return this._p0};la.prototype.setNode=function(e){this._node=e};la.prototype.print=function(e){var n=Math.atan2(this._dy,this._dx),r=this.getClass().getName(),i=r.lastIndexOf("."),o=r.substring(i+1);e.print("  "+o+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+n+"   "+this._label)};la.prototype.compareTo=function(e){var n=e;return this.compareDirection(n)};la.prototype.getDirectedCoordinate=function(){return this._p1};la.prototype.getDx=function(){return this._dx};la.prototype.getLabel=function(){return this._label};la.prototype.getEdge=function(){return this._edge};la.prototype.getQuadrant=function(){return this._quadrant};la.prototype.getNode=function(){return this._node};la.prototype.toString=function(){var e=Math.atan2(this._dy,this._dx),n=this.getClass().getName(),r=n.lastIndexOf("."),i=n.substring(r+1);return"  "+i+": "+this._p0+" - "+this._p1+" "+this._quadrant+":"+e+"   "+this._label};la.prototype.computeLabel=function(e){};la.prototype.init=function(e,n){this._p0=e,this._p1=n,this._dx=n.x-e.x,this._dy=n.y-e.y,this._quadrant=yi.quadrant(this._dx,this._dy),Pr.isTrue(!(this._dx===0&&this._dy===0),"EdgeEnd with identical endpoints found")};la.prototype.interfaces_=function(){return[Uu]};la.prototype.getClass=function(){return la};var Ik=function(t){function e(){var n=arguments[0],r=arguments[1];if(t.call(this,n),this._isForward=null,this._isInResult=!1,this._isVisited=!1,this._sym=null,this._next=null,this._nextMin=null,this._edgeRing=null,this._minEdgeRing=null,this._depth=[0,-999,-999],this._isForward=r,r)this.init(n.getCoordinate(0),n.getCoordinate(1));else{var i=n.getNumPoints()-1;this.init(n.getCoordinate(i),n.getCoordinate(i-1))}this.computeDirectedLabel()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getNextMin=function(){return this._nextMin},e.prototype.getDepth=function(r){return this._depth[r]},e.prototype.setVisited=function(r){this._isVisited=r},e.prototype.computeDirectedLabel=function(){this._label=new di(this._edge.getLabel()),this._isForward||this._label.flip()},e.prototype.getNext=function(){return this._next},e.prototype.setDepth=function(r,i){if(this._depth[r]!==-999&&this._depth[r]!==i)throw new Wd("assigned depths do not match",this.getCoordinate());this._depth[r]=i},e.prototype.isInteriorAreaEdge=function(){for(var r=this,i=!0,o=0;o<2;o++)r._label.isArea(o)&&r._label.getLocation(o,gn.LEFT)===Et.INTERIOR&&r._label.getLocation(o,gn.RIGHT)===Et.INTERIOR||(i=!1);return i},e.prototype.setNextMin=function(r){this._nextMin=r},e.prototype.print=function(r){t.prototype.print.call(this,r),r.print(" "+this._depth[gn.LEFT]+"/"+this._depth[gn.RIGHT]),r.print(" ("+this.getDepthDelta()+")"),this._isInResult&&r.print(" inResult")},e.prototype.setMinEdgeRing=function(r){this._minEdgeRing=r},e.prototype.isLineEdge=function(){var r=this._label.isLine(0)||this._label.isLine(1),i=!this._label.isArea(0)||this._label.allPositionsEqual(0,Et.EXTERIOR),o=!this._label.isArea(1)||this._label.allPositionsEqual(1,Et.EXTERIOR);return r&&i&&o},e.prototype.setEdgeRing=function(r){this._edgeRing=r},e.prototype.getMinEdgeRing=function(){return this._minEdgeRing},e.prototype.getDepthDelta=function(){var r=this._edge.getDepthDelta();return this._isForward||(r=-r),r},e.prototype.setInResult=function(r){this._isInResult=r},e.prototype.getSym=function(){return this._sym},e.prototype.isForward=function(){return this._isForward},e.prototype.getEdge=function(){return this._edge},e.prototype.printEdge=function(r){this.print(r),r.print(" "),this._isForward?this._edge.print(r):this._edge.printReverse(r)},e.prototype.setSym=function(r){this._sym=r},e.prototype.setVisitedEdge=function(r){this.setVisited(r),this._sym.setVisited(r)},e.prototype.setEdgeDepths=function(r,i){var o=this.getEdge().getDepthDelta();this._isForward||(o=-o);var a=1;r===gn.LEFT&&(a=-1);var s=gn.opposite(r),u=o*a,d=i+u;this.setDepth(r,i),this.setDepth(s,d)},e.prototype.getEdgeRing=function(){return this._edgeRing},e.prototype.isInResult=function(){return this._isInResult},e.prototype.setNext=function(r){this._next=r},e.prototype.isVisited=function(){return this._isVisited},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.depthFactor=function(r,i){return r===Et.EXTERIOR&&i===Et.INTERIOR?1:r===Et.INTERIOR&&i===Et.EXTERIOR?-1:0},e}(la),t1=function(){};t1.prototype.createNode=function(e){return new ER(e,null)};t1.prototype.interfaces_=function(){return[]};t1.prototype.getClass=function(){return t1};var po=function(){if(this._edges=new bn,this._nodes=null,this._edgeEndList=new bn,arguments.length===0)this._nodes=new Cf(new t1);else if(arguments.length===1){var e=arguments[0];this._nodes=new Cf(e)}};po.prototype.printEdges=function(e){var n=this;e.println("Edges:");for(var r=0;r<this._edges.size();r++){e.println("edge "+r+":");var i=n._edges.get(r);i.print(e),i.eiList.print(e)}};po.prototype.find=function(e){return this._nodes.find(e)};po.prototype.addNode=function(){if(arguments[0]instanceof ER){var e=arguments[0];return this._nodes.addNode(e)}else if(arguments[0]instanceof dt){var n=arguments[0];return this._nodes.addNode(n)}};po.prototype.getNodeIterator=function(){return this._nodes.iterator()};po.prototype.linkResultDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();){var n=e.next();n.getEdges().linkResultDirectedEdges()}};po.prototype.debugPrintln=function(e){qs.out.println(e)};po.prototype.isBoundaryNode=function(e,n){var r=this._nodes.find(n);if(r===null)return!1;var i=r.getLabel();return i!==null&&i.getLocation(e)===Et.BOUNDARY};po.prototype.linkAllDirectedEdges=function(){for(var e=this._nodes.iterator();e.hasNext();){var n=e.next();n.getEdges().linkAllDirectedEdges()}};po.prototype.matchInSameDirection=function(e,n,r,i){return e.equals(r)?Rn.computeOrientation(e,n,i)===Rn.COLLINEAR&&yi.quadrant(e,n)===yi.quadrant(r,i):!1};po.prototype.getEdgeEnds=function(){return this._edgeEndList};po.prototype.debugPrint=function(e){qs.out.print(e)};po.prototype.getEdgeIterator=function(){return this._edges.iterator()};po.prototype.findEdgeInSameDirection=function(e,n){for(var r=this,i=0;i<this._edges.size();i++){var o=r._edges.get(i),a=o.getCoordinates();if(r.matchInSameDirection(e,n,a[0],a[1])||r.matchInSameDirection(e,n,a[a.length-1],a[a.length-2]))return o}return null};po.prototype.insertEdge=function(e){this._edges.add(e)};po.prototype.findEdgeEnd=function(e){for(var n=this.getEdgeEnds().iterator();n.hasNext();){var r=n.next();if(r.getEdge()===e)return r}return null};po.prototype.addEdges=function(e){for(var n=this,r=e.iterator();r.hasNext();){var i=r.next();n._edges.add(i);var o=new Ik(i,!0),a=new Ik(i,!1);o.setSym(a),a.setSym(o),n.add(o),n.add(a)}};po.prototype.add=function(e){this._nodes.add(e),this._edgeEndList.add(e)};po.prototype.getNodes=function(){return this._nodes.values()};po.prototype.findEdge=function(e,n){for(var r=this,i=0;i<this._edges.size();i++){var o=r._edges.get(i),a=o.getCoordinates();if(e.equals(a[0])&&n.equals(a[1]))return o}return null};po.prototype.interfaces_=function(){return[]};po.prototype.getClass=function(){return po};po.linkResultDirectedEdges=function(e){for(var n=e.iterator();n.hasNext();){var r=n.next();r.getEdges().linkResultDirectedEdges()}};var Ml=function(){this._geometryFactory=null,this._shellList=new bn;var e=arguments[0];this._geometryFactory=e};Ml.prototype.sortShellsAndHoles=function(e,n,r){for(var i=e.iterator();i.hasNext();){var o=i.next();o.isHole()?r.add(o):n.add(o)}};Ml.prototype.computePolygons=function(e){for(var n=this,r=new bn,i=e.iterator();i.hasNext();){var o=i.next(),a=o.toPolygon(n._geometryFactory);r.add(a)}return r};Ml.prototype.placeFreeHoles=function(e,n){for(var r=this,i=n.iterator();i.hasNext();){var o=i.next();if(o.getShell()===null){var a=r.findEdgeRingContaining(o,e);if(a===null)throw new Wd("unable to assign hole to a shell",o.getCoordinate(0));o.setShell(a)}}};Ml.prototype.buildMinimalEdgeRings=function(e,n,r){for(var i=this,o=new bn,a=e.iterator();a.hasNext();){var s=a.next();if(s.getMaxNodeDegree()>2){s.linkDirectedEdgesForMinimalEdgeRings();var u=s.buildMinimalRings(),d=i.findShell(u);d!==null?(i.placePolygonHoles(d,u),n.add(d)):r.addAll(u)}else o.add(s)}return o};Ml.prototype.containsPoint=function(e){for(var n=this._shellList.iterator();n.hasNext();){var r=n.next();if(r.containsPoint(e))return!0}return!1};Ml.prototype.buildMaximalEdgeRings=function(e){for(var n=this,r=new bn,i=e.iterator();i.hasNext();){var o=i.next();if(o.isInResult()&&o.getLabel().isArea()&&o.getEdgeRing()===null){var a=new WRe(o,n._geometryFactory);r.add(a),a.setInResult()}}return r};Ml.prototype.placePolygonHoles=function(e,n){for(var r=n.iterator();r.hasNext();){var i=r.next();i.isHole()&&i.setShell(e)}};Ml.prototype.getPolygons=function(){var e=this.computePolygons(this._shellList);return e};Ml.prototype.findEdgeRingContaining=function(e,n){for(var r=e.getLinearRing(),i=r.getEnvelopeInternal(),o=r.getCoordinateN(0),a=null,s=null,u=n.iterator();u.hasNext();){var d=u.next(),g=d.getLinearRing(),_=g.getEnvelopeInternal();a!==null&&(s=a.getLinearRing().getEnvelopeInternal());var E=!1;_.contains(i)&&Rn.isPointInRing(o,g.getCoordinates())&&(E=!0),E&&(a===null||s.contains(_))&&(a=d)}return a};Ml.prototype.findShell=function(e){for(var n=0,r=null,i=e.iterator();i.hasNext();){var o=i.next();o.isHole()||(r=o,n++)}return Pr.isTrue(n<=1,"found two shells in MinimalEdgeRing list"),r};Ml.prototype.add=function(){if(arguments.length===1){var e=arguments[0];this.add(e.getEdgeEnds(),e.getNodes())}else if(arguments.length===2){var n=arguments[0],r=arguments[1];po.linkResultDirectedEdges(r);var i=this.buildMaximalEdgeRings(n),o=new bn,a=this.buildMinimalEdgeRings(i,this._shellList,o);this.sortShellsAndHoles(a,this._shellList,o),this.placeFreeHoles(this._shellList,o)}};Ml.prototype.interfaces_=function(){return[]};Ml.prototype.getClass=function(){return Ml};var n1=function(){};n1.prototype.getBounds=function(){};n1.prototype.interfaces_=function(){return[]};n1.prototype.getClass=function(){return n1};var wc=function(){this._bounds=null,this._item=null;var e=arguments[0],n=arguments[1];this._bounds=e,this._item=n};wc.prototype.getItem=function(){return this._item};wc.prototype.getBounds=function(){return this._bounds};wc.prototype.interfaces_=function(){return[n1,Gu]};wc.prototype.getClass=function(){return wc};var qd=function(){this._size=null,this._items=null,this._size=0,this._items=new bn,this._items.add(null)};qd.prototype.poll=function(){if(this.isEmpty())return null;var e=this._items.get(1);return this._items.set(1,this._items.get(this._size)),this._size-=1,this.reorder(1),e};qd.prototype.size=function(){return this._size};qd.prototype.reorder=function(e){for(var n=this,r=null,i=this._items.get(e);e*2<=this._size&&(r=e*2,r!==n._size&&n._items.get(r+1).compareTo(n._items.get(r))<0&&r++,n._items.get(r).compareTo(i)<0);e=r)n._items.set(e,n._items.get(r));this._items.set(e,i)};qd.prototype.clear=function(){this._size=0,this._items.clear()};qd.prototype.isEmpty=function(){return this._size===0};qd.prototype.add=function(e){var n=this;this._items.add(null),this._size+=1;var r=this._size;for(this._items.set(0,e);e.compareTo(this._items.get(Math.trunc(r/2)))<0;r/=2)n._items.set(r,n._items.get(Math.trunc(r/2)));this._items.set(r,e)};qd.prototype.interfaces_=function(){return[]};qd.prototype.getClass=function(){return qd};var fg=function(){};fg.prototype.visitItem=function(e){};fg.prototype.interfaces_=function(){return[]};fg.prototype.getClass=function(){return fg};var H0=function(){};H0.prototype.insert=function(e,n){};H0.prototype.remove=function(e,n){};H0.prototype.query=function(){};H0.prototype.interfaces_=function(){return[]};H0.prototype.getClass=function(){return H0};var os=function(){if(this._childBoundables=new bn,this._bounds=null,this._level=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this._level=e}}},hie={serialVersionUID:{configurable:!0}};os.prototype.getLevel=function(){return this._level};os.prototype.size=function(){return this._childBoundables.size()};os.prototype.getChildBoundables=function(){return this._childBoundables};os.prototype.addChildBoundable=function(e){Pr.isTrue(this._bounds===null),this._childBoundables.add(e)};os.prototype.isEmpty=function(){return this._childBoundables.isEmpty()};os.prototype.getBounds=function(){return this._bounds===null&&(this._bounds=this.computeBounds()),this._bounds};os.prototype.interfaces_=function(){return[n1,Gu]};os.prototype.getClass=function(){return os};hie.serialVersionUID.get=function(){return 6493722185909574e3};Object.defineProperties(os,hie);var Ec=function(){};Ec.reverseOrder=function(){return{compare:function(n,r){return r.compareTo(n)}}};Ec.min=function(e){return Ec.sort(e),e.get(0)};Ec.sort=function(e,n){var r=e.toArray();n?$m.sort(r,n):$m.sort(r);for(var i=e.iterator(),o=0,a=r.length;o<a;o++)i.next(),i.set(r[o])};Ec.singletonList=function(e){var n=new bn;return n.add(e),n};var Uo=function(){this._boundable1=null,this._boundable2=null,this._distance=null,this._itemDistance=null;var e=arguments[0],n=arguments[1],r=arguments[2];this._boundable1=e,this._boundable2=n,this._itemDistance=r,this._distance=this.distance()};Uo.prototype.expandToQueue=function(e,n){var r=Uo.isComposite(this._boundable1),i=Uo.isComposite(this._boundable2);if(r&&i)return Uo.area(this._boundable1)>Uo.area(this._boundable2)?(this.expand(this._boundable1,this._boundable2,e,n),null):(this.expand(this._boundable2,this._boundable1,e,n),null);if(r)return this.expand(this._boundable1,this._boundable2,e,n),null;if(i)return this.expand(this._boundable2,this._boundable1,e,n),null;throw new oo("neither boundable is composite")};Uo.prototype.isLeaves=function(){return!(Uo.isComposite(this._boundable1)||Uo.isComposite(this._boundable2))};Uo.prototype.compareTo=function(e){var n=e;return this._distance<n._distance?-1:this._distance>n._distance?1:0};Uo.prototype.expand=function(e,n,r,i){for(var o=this,a=e.getChildBoundables(),s=a.iterator();s.hasNext();){var u=s.next(),d=new Uo(u,n,o._itemDistance);d.getDistance()<i&&r.add(d)}};Uo.prototype.getBoundable=function(e){return e===0?this._boundable1:this._boundable2};Uo.prototype.getDistance=function(){return this._distance};Uo.prototype.distance=function(){return this.isLeaves()?this._itemDistance.distance(this._boundable1,this._boundable2):this._boundable1.getBounds().distance(this._boundable2.getBounds())};Uo.prototype.interfaces_=function(){return[Uu]};Uo.prototype.getClass=function(){return Uo};Uo.area=function(e){return e.getBounds().getArea()};Uo.isComposite=function(e){return e instanceof os};var Ps=function t(){if(this._root=null,this._built=!1,this._itemBoundables=new bn,this._nodeCapacity=null,arguments.length===0){var e=t.DEFAULT_NODE_CAPACITY;this._nodeCapacity=e}else if(arguments.length===1){var n=arguments[0];Pr.isTrue(n>1,"Node capacity must be greater than 1"),this._nodeCapacity=n}},SR={IntersectsOp:{configurable:!0},serialVersionUID:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};Ps.prototype.getNodeCapacity=function(){return this._nodeCapacity};Ps.prototype.lastNode=function(e){return e.get(e.size()-1)};Ps.prototype.size=function(){var e=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.size(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,i=n.getChildBoundables().iterator();i.hasNext();){var o=i.next();o instanceof os?r+=e.size(o):o instanceof wc&&(r+=1)}return r}};Ps.prototype.removeItem=function(e,n){for(var r=null,i=e.getChildBoundables().iterator();i.hasNext();){var o=i.next();o instanceof wc&&o.getItem()===n&&(r=o)}return r!==null?(e.getChildBoundables().remove(r),!0):!1};Ps.prototype.itemsTree=function(){var e=this;if(arguments.length===0){this.build();var n=this.itemsTree(this._root);return n===null?new bn:n}else if(arguments.length===1){for(var r=arguments[0],i=new bn,o=r.getChildBoundables().iterator();o.hasNext();){var a=o.next();if(a instanceof os){var s=e.itemsTree(a);s!==null&&i.add(s)}else a instanceof wc?i.add(a.getItem()):Pr.shouldNeverReachHere()}return i.size()<=0?null:i}};Ps.prototype.insert=function(e,n){Pr.isTrue(!this._built,"Cannot insert items into an STR packed R-tree after it has been built."),this._itemBoundables.add(new wc(e,n))};Ps.prototype.boundablesAtLevel=function(){var e=this;if(arguments.length===1){var n=arguments[0],r=new bn;return this.boundablesAtLevel(n,this._root,r),r}else if(arguments.length===3){var i=arguments[0],o=arguments[1],a=arguments[2];if(Pr.isTrue(i>-2),o.getLevel()===i)return a.add(o),null;for(var s=o.getChildBoundables().iterator();s.hasNext();){var u=s.next();u instanceof os?e.boundablesAtLevel(i,u,a):(Pr.isTrue(u instanceof wc),i===-1&&a.add(u))}return null}};Ps.prototype.query=function(){var e=this;if(arguments.length===1){var n=arguments[0];this.build();var r=new bn;return this.isEmpty()||this.getIntersectsOp().intersects(this._root.getBounds(),n)&&this.query(n,this._root,r),r}else if(arguments.length===2){var i=arguments[0],o=arguments[1];if(this.build(),this.isEmpty())return null;this.getIntersectsOp().intersects(this._root.getBounds(),i)&&this.query(i,this._root,o)}else if(arguments.length===3){if(ar(arguments[2],fg)&&arguments[0]instanceof Object&&arguments[1]instanceof os)for(var a=arguments[0],s=arguments[1],u=arguments[2],d=s.getChildBoundables(),g=0;g<d.size();g++){var _=d.get(g);e.getIntersectsOp().intersects(_.getBounds(),a)&&(_ instanceof os?e.query(a,_,u):_ instanceof wc?u.visitItem(_.getItem()):Pr.shouldNeverReachHere())}else if(ar(arguments[2],Ac)&&arguments[0]instanceof Object&&arguments[1]instanceof os)for(var E=arguments[0],P=arguments[1],O=arguments[2],D=P.getChildBoundables(),V=0;V<D.size();V++){var k=D.get(V);e.getIntersectsOp().intersects(k.getBounds(),E)&&(k instanceof os?e.query(E,k,O):k instanceof wc?O.add(k.getItem()):Pr.shouldNeverReachHere())}}};Ps.prototype.build=function(){if(this._built)return null;this._root=this._itemBoundables.isEmpty()?this.createNode(0):this.createHigherLevels(this._itemBoundables,-1),this._itemBoundables=null,this._built=!0};Ps.prototype.getRoot=function(){return this.build(),this._root};Ps.prototype.remove=function(){var e=this;if(arguments.length===2){var n=arguments[0],r=arguments[1];return this.build(),this.getIntersectsOp().intersects(this._root.getBounds(),n)?this.remove(n,this._root,r):!1}else if(arguments.length===3){var i=arguments[0],o=arguments[1],a=arguments[2],s=this.removeItem(o,a);if(s)return!0;for(var u=null,d=o.getChildBoundables().iterator();d.hasNext();){var g=d.next();if(e.getIntersectsOp().intersects(g.getBounds(),i)&&g instanceof os&&(s=e.remove(i,g,a),s)){u=g;break}}return u!==null&&u.getChildBoundables().isEmpty()&&o.getChildBoundables().remove(u),s}};Ps.prototype.createHigherLevels=function(e,n){Pr.isTrue(!e.isEmpty());var r=this.createParentBoundables(e,n+1);return r.size()===1?r.get(0):this.createHigherLevels(r,n+1)};Ps.prototype.depth=function(){var e=this;if(arguments.length===0)return this.isEmpty()?0:(this.build(),this.depth(this._root));if(arguments.length===1){for(var n=arguments[0],r=0,i=n.getChildBoundables().iterator();i.hasNext();){var o=i.next();if(o instanceof os){var a=e.depth(o);a>r&&(r=a)}}return r+1}};Ps.prototype.createParentBoundables=function(e,n){var r=this;Pr.isTrue(!e.isEmpty());var i=new bn;i.add(this.createNode(n));var o=new bn(e);Ec.sort(o,this.getComparator());for(var a=o.iterator();a.hasNext();){var s=a.next();r.lastNode(i).getChildBoundables().size()===r.getNodeCapacity()&&i.add(r.createNode(n)),r.lastNode(i).addChildBoundable(s)}return i};Ps.prototype.isEmpty=function(){return this._built?this._root.isEmpty():this._itemBoundables.isEmpty()};Ps.prototype.interfaces_=function(){return[Gu]};Ps.prototype.getClass=function(){return Ps};Ps.compareDoubles=function(e,n){return e>n?1:e<n?-1:0};SR.IntersectsOp.get=function(){return qRe};SR.serialVersionUID.get=function(){return-3886435814360241e3};SR.DEFAULT_NODE_CAPACITY.get=function(){return 10};Object.defineProperties(Ps,SR);var qRe=function(){},r1=function(){};r1.prototype.distance=function(e,n){};r1.prototype.interfaces_=function(){return[]};r1.prototype.getClass=function(){return r1};var die=function(t){function e(r){r=r||e.DEFAULT_NODE_CAPACITY,t.call(this,r)}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={STRtreeNode:{configurable:!0},serialVersionUID:{configurable:!0},xComparator:{configurable:!0},yComparator:{configurable:!0},intersectsOp:{configurable:!0},DEFAULT_NODE_CAPACITY:{configurable:!0}};return e.prototype.createParentBoundablesFromVerticalSlices=function(i,o){var a=this;Pr.isTrue(i.length>0);for(var s=new bn,u=0;u<i.length;u++)s.addAll(a.createParentBoundablesFromVerticalSlice(i[u],o));return s},e.prototype.createNode=function(i){return new m7(i)},e.prototype.size=function(){return arguments.length===0?t.prototype.size.call(this):t.prototype.size.apply(this,arguments)},e.prototype.insert=function(){if(arguments.length===2){var i=arguments[0],o=arguments[1];if(i.isNull())return null;t.prototype.insert.call(this,i,o)}else return t.prototype.insert.apply(this,arguments)},e.prototype.getIntersectsOp=function(){return e.intersectsOp},e.prototype.verticalSlices=function(i,o){for(var a=Math.trunc(Math.ceil(i.size()/o)),s=new Array(o).fill(null),u=i.iterator(),d=0;d<o;d++){s[d]=new bn;for(var g=0;u.hasNext()&&g<a;){var _=u.next();s[d].add(_),g++}}return s},e.prototype.query=function(){if(arguments.length===1){var i=arguments[0];return t.prototype.query.call(this,i)}else if(arguments.length===2){var o=arguments[0],a=arguments[1];t.prototype.query.call(this,o,a)}else if(arguments.length===3){if(ar(arguments[2],fg)&&arguments[0]instanceof Object&&arguments[1]instanceof os){var s=arguments[0],u=arguments[1],d=arguments[2];t.prototype.query.call(this,s,u,d)}else if(ar(arguments[2],Ac)&&arguments[0]instanceof Object&&arguments[1]instanceof os){var g=arguments[0],_=arguments[1],E=arguments[2];t.prototype.query.call(this,g,_,E)}}},e.prototype.getComparator=function(){return e.yComparator},e.prototype.createParentBoundablesFromVerticalSlice=function(i,o){return t.prototype.createParentBoundables.call(this,i,o)},e.prototype.remove=function(){if(arguments.length===2){var i=arguments[0],o=arguments[1];return t.prototype.remove.call(this,i,o)}else return t.prototype.remove.apply(this,arguments)},e.prototype.depth=function(){return arguments.length===0?t.prototype.depth.call(this):t.prototype.depth.apply(this,arguments)},e.prototype.createParentBoundables=function(i,o){Pr.isTrue(!i.isEmpty());var a=Math.trunc(Math.ceil(i.size()/this.getNodeCapacity())),s=new bn(i);Ec.sort(s,e.xComparator);var u=this.verticalSlices(s,Math.trunc(Math.ceil(Math.sqrt(a))));return this.createParentBoundablesFromVerticalSlices(u,o)},e.prototype.nearestNeighbour=function(){if(arguments.length===1){if(ar(arguments[0],r1)){var i=arguments[0],o=new Uo(this.getRoot(),this.getRoot(),i);return this.nearestNeighbour(o)}else if(arguments[0]instanceof Uo){var a=arguments[0];return this.nearestNeighbour(a,mr.POSITIVE_INFINITY)}}else if(arguments.length===2){if(arguments[0]instanceof e&&ar(arguments[1],r1)){var s=arguments[0],u=arguments[1],d=new Uo(this.getRoot(),s.getRoot(),u);return this.nearestNeighbour(d)}else if(arguments[0]instanceof Uo&&typeof arguments[1]=="number"){var g=arguments[0],_=arguments[1],E=_,P=null,O=new qd;for(O.add(g);!O.isEmpty()&&E>0;){var D=O.poll(),V=D.getDistance();if(V>=E)break;D.isLeaves()?(E=V,P=D):D.expandToQueue(O,E)}return[P.getBoundable(0).getItem(),P.getBoundable(1).getItem()]}}else if(arguments.length===3){var k=arguments[0],F=arguments[1],z=arguments[2],X=new wc(k,F),Y=new Uo(this.getRoot(),X,z);return this.nearestNeighbour(Y)[0]}},e.prototype.interfaces_=function(){return[H0,Gu]},e.prototype.getClass=function(){return e},e.centreX=function(i){return e.avg(i.getMinX(),i.getMaxX())},e.avg=function(i,o){return(i+o)/2},e.centreY=function(i){return e.avg(i.getMinY(),i.getMaxY())},n.STRtreeNode.get=function(){return m7},n.serialVersionUID.get=function(){return 0x39920f7d5f261e0},n.xComparator.get=function(){return{interfaces_:function(){return[qv]},compare:function(r,i){return t.compareDoubles(e.centreX(r.getBounds()),e.centreX(i.getBounds()))}}},n.yComparator.get=function(){return{interfaces_:function(){return[qv]},compare:function(r,i){return t.compareDoubles(e.centreY(r.getBounds()),e.centreY(i.getBounds()))}}},n.intersectsOp.get=function(){return{interfaces_:function(){return[t.IntersectsOp]},intersects:function(r,i){return r.intersects(i)}}},n.DEFAULT_NODE_CAPACITY.get=function(){return 10},Object.defineProperties(e,n),e}(Ps),m7=function(t){function e(){var n=arguments[0];t.call(this,n)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.computeBounds=function(){for(var r=null,i=this.getChildBoundables().iterator();i.hasNext();){var o=i.next();r===null?r=new Qn(o.getBounds()):r.expandToInclude(o.getBounds())}return r},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(os),Ha=function(){};Ha.prototype.interfaces_=function(){return[]};Ha.prototype.getClass=function(){return Ha};Ha.relativeSign=function(e,n){return e<n?-1:e>n?1:0};Ha.compare=function(e,n,r){if(n.equals2D(r))return 0;var i=Ha.relativeSign(n.x,r.x),o=Ha.relativeSign(n.y,r.y);switch(e){case 0:return Ha.compareValue(i,o);case 1:return Ha.compareValue(o,i);case 2:return Ha.compareValue(o,-i);case 3:return Ha.compareValue(-i,o);case 4:return Ha.compareValue(-i,-o);case 5:return Ha.compareValue(-o,-i);case 6:return Ha.compareValue(-o,i);case 7:return Ha.compareValue(i,-o)}return Pr.shouldNeverReachHere("invalid octant value"),0};Ha.compareValue=function(e,n){return e<0?-1:e>0?1:n<0?-1:n>0?1:0};var hg=function(){this._segString=null,this.coord=null,this.segmentIndex=null,this._segmentOctant=null,this._isInterior=null;var e=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];this._segString=e,this.coord=new dt(n),this.segmentIndex=r,this._segmentOctant=i,this._isInterior=!n.equals2D(e.getCoordinate(r))};hg.prototype.getCoordinate=function(){return this.coord};hg.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex)};hg.prototype.compareTo=function(e){var n=e;return this.segmentIndex<n.segmentIndex?-1:this.segmentIndex>n.segmentIndex?1:this.coord.equals2D(n.coord)?0:Ha.compare(this._segmentOctant,this.coord,n.coord)};hg.prototype.isEndPoint=function(e){return this.segmentIndex===0&&!this._isInterior||this.segmentIndex===e};hg.prototype.isInterior=function(){return this._isInterior};hg.prototype.interfaces_=function(){return[Uu]};hg.prototype.getClass=function(){return hg};var Da=function(){this._nodeMap=new aa,this._edge=null;var e=arguments[0];this._edge=e};Da.prototype.getSplitCoordinates=function(){var e=this,n=new t2;this.addEndpoints();for(var r=this.iterator(),i=r.next();r.hasNext();){var o=r.next();e.addEdgeCoordinates(i,o,n),i=o}return n.toCoordinateArray()};Da.prototype.addCollapsedNodes=function(){var e=this,n=new bn;this.findCollapsesFromInsertedNodes(n),this.findCollapsesFromExistingVertices(n);for(var r=n.iterator();r.hasNext();){var i=r.next().intValue();e.add(e._edge.getCoordinate(i),i)}};Da.prototype.print=function(e){e.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(e)}};Da.prototype.findCollapsesFromExistingVertices=function(e){for(var n=this,r=0;r<this._edge.size()-2;r++){var i=n._edge.getCoordinate(r),o=n._edge.getCoordinate(r+2);i.equals2D(o)&&e.add(new bf(r+1))}};Da.prototype.addEdgeCoordinates=function(e,n,r){var i=this,o=this._edge.getCoordinate(n.segmentIndex),a=n.isInterior()||!n.coord.equals2D(o);r.add(new dt(e.coord),!1);for(var s=e.segmentIndex+1;s<=n.segmentIndex;s++)r.add(i._edge.getCoordinate(s));a&&r.add(new dt(n.coord))};Da.prototype.iterator=function(){return this._nodeMap.values().iterator()};Da.prototype.addSplitEdges=function(e){var n=this;this.addEndpoints(),this.addCollapsedNodes();for(var r=this.iterator(),i=r.next();r.hasNext();){var o=r.next(),a=n.createSplitEdge(i,o);e.add(a),i=o}};Da.prototype.findCollapseIndex=function(e,n,r){if(!e.coord.equals2D(n.coord))return!1;var i=n.segmentIndex-e.segmentIndex;return n.isInterior()||i--,i===1?(r[0]=e.segmentIndex+1,!0):!1};Da.prototype.findCollapsesFromInsertedNodes=function(e){for(var n=this,r=new Array(1).fill(null),i=this.iterator(),o=i.next();i.hasNext();){var a=i.next(),s=n.findCollapseIndex(o,a,r);s&&e.add(new bf(r[0])),o=a}};Da.prototype.getEdge=function(){return this._edge};Da.prototype.addEndpoints=function(){var e=this._edge.size()-1;this.add(this._edge.getCoordinate(0),0),this.add(this._edge.getCoordinate(e),e)};Da.prototype.createSplitEdge=function(e,n){var r=this,i=n.segmentIndex-e.segmentIndex+2,o=this._edge.getCoordinate(n.segmentIndex),a=n.isInterior()||!n.coord.equals2D(o);a||i--;var s=new Array(i).fill(null),u=0;s[u++]=new dt(e.coord);for(var d=e.segmentIndex+1;d<=n.segmentIndex;d++)s[u++]=r._edge.getCoordinate(d);return a&&(s[u]=new dt(n.coord)),new Lo(s,this._edge.getData())};Da.prototype.add=function(e,n){var r=new hg(this._edge,e,n,this._edge.getSegmentOctant(n)),i=this._nodeMap.get(r);return i!==null?(Pr.isTrue(i.coord.equals2D(e),"Found equal nodes with different coordinates"),i):(this._nodeMap.put(r,r),r)};Da.prototype.checkSplitEdgesCorrectness=function(e){var n=this._edge.getCoordinates(),r=e.get(0),i=r.getCoordinate(0);if(!i.equals2D(n[0]))throw new $d("bad split edge start point at "+i);var o=e.get(e.size()-1),a=o.getCoordinates(),s=a[a.length-1];if(!s.equals2D(n[n.length-1]))throw new $d("bad split edge end point at "+s)};Da.prototype.interfaces_=function(){return[]};Da.prototype.getClass=function(){return Da};var W0=function(){};W0.prototype.interfaces_=function(){return[]};W0.prototype.getClass=function(){return W0};W0.octant=function(){if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){var e=arguments[0],n=arguments[1];if(e===0&&n===0)throw new oo("Cannot compute the octant for point ( "+e+", "+n+" )");var r=Math.abs(e),i=Math.abs(n);return e>=0?n>=0?r>=i?0:1:r>=i?7:6:n>=0?r>=i?3:2:r>=i?4:5}else if(arguments[0]instanceof dt&&arguments[1]instanceof dt){var o=arguments[0],a=arguments[1],s=a.x-o.x,u=a.y-o.y;if(s===0&&u===0)throw new oo("Cannot compute the octant for two identical points "+o);return W0.octant(s,u)}};var Mh=function(){};Mh.prototype.getCoordinates=function(){};Mh.prototype.size=function(){};Mh.prototype.getCoordinate=function(e){};Mh.prototype.isClosed=function(){};Mh.prototype.setData=function(e){};Mh.prototype.getData=function(){};Mh.prototype.interfaces_=function(){return[]};Mh.prototype.getClass=function(){return Mh};var tE=function(){};tE.prototype.addIntersection=function(e,n){};tE.prototype.interfaces_=function(){return[Mh]};tE.prototype.getClass=function(){return tE};var Lo=function(){this._nodeList=new Da(this),this._pts=null,this._data=null;var e=arguments[0],n=arguments[1];this._pts=e,this._data=n};Lo.prototype.getCoordinates=function(){return this._pts};Lo.prototype.size=function(){return this._pts.length};Lo.prototype.getCoordinate=function(e){return this._pts[e]};Lo.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Lo.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:this.safeOctant(this.getCoordinate(e),this.getCoordinate(e+1))};Lo.prototype.setData=function(e){this._data=e};Lo.prototype.safeOctant=function(e,n){return e.equals2D(n)?0:W0.octant(e,n)};Lo.prototype.getData=function(){return this._data};Lo.prototype.addIntersection=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1];this.addIntersectionNode(e,n)}else if(arguments.length===4){var r=arguments[0],i=arguments[1],o=arguments[3],a=new dt(r.getIntersection(o));this.addIntersection(a,i)}};Lo.prototype.toString=function(){return xc.toLineString(new Mo(this._pts))};Lo.prototype.getNodeList=function(){return this._nodeList};Lo.prototype.addIntersectionNode=function(e,n){var r=n,i=r+1;if(i<this._pts.length){var o=this._pts[i];e.equals2D(o)&&(r=i)}var a=this._nodeList.add(e,r);return a};Lo.prototype.addIntersections=function(e,n,r){for(var i=this,o=0;o<e.getIntersectionNum();o++)i.addIntersection(e,n,r,o)};Lo.prototype.interfaces_=function(){return[tE]};Lo.prototype.getClass=function(){return Lo};Lo.getNodedSubstrings=function(){if(arguments.length===1){var e=arguments[0],n=new bn;return Lo.getNodedSubstrings(e,n),n}else if(arguments.length===2)for(var r=arguments[0],i=arguments[1],o=r.iterator();o.hasNext();){var a=o.next();a.getNodeList().addSplitEdges(i)}};var Jn=function(){if(this.p0=null,this.p1=null,arguments.length===0)this.p0=new dt,this.p1=new dt;else if(arguments.length===1){var e=arguments[0];this.p0=new dt(e.p0),this.p1=new dt(e.p1)}else if(arguments.length===2)this.p0=arguments[0],this.p1=arguments[1];else if(arguments.length===4){var n=arguments[0],r=arguments[1],i=arguments[2],o=arguments[3];this.p0=new dt(n,r),this.p1=new dt(i,o)}},pie={serialVersionUID:{configurable:!0}};Jn.prototype.minX=function(){return Math.min(this.p0.x,this.p1.x)};Jn.prototype.orientationIndex=function(){if(arguments[0]instanceof Jn){var e=arguments[0],n=Rn.orientationIndex(this.p0,this.p1,e.p0),r=Rn.orientationIndex(this.p0,this.p1,e.p1);return n>=0&&r>=0||n<=0&&r<=0?Math.max(n,r):0}else if(arguments[0]instanceof dt){var i=arguments[0];return Rn.orientationIndex(this.p0,this.p1,i)}};Jn.prototype.toGeometry=function(e){return e.createLineString([this.p0,this.p1])};Jn.prototype.isVertical=function(){return this.p0.x===this.p1.x};Jn.prototype.equals=function(e){if(!(e instanceof Jn))return!1;var n=e;return this.p0.equals(n.p0)&&this.p1.equals(n.p1)};Jn.prototype.intersection=function(e){var n=new bA;return n.computeIntersection(this.p0,this.p1,e.p0,e.p1),n.hasIntersection()?n.getIntersection(0):null};Jn.prototype.project=function(){if(arguments[0]instanceof dt){var e=arguments[0];if(e.equals(this.p0)||e.equals(this.p1))return new dt(e);var n=this.projectionFactor(e),r=new dt;return r.x=this.p0.x+n*(this.p1.x-this.p0.x),r.y=this.p0.y+n*(this.p1.y-this.p0.y),r}else if(arguments[0]instanceof Jn){var i=arguments[0],o=this.projectionFactor(i.p0),a=this.projectionFactor(i.p1);if(o>=1&&a>=1||o<=0&&a<=0)return null;var s=this.project(i.p0);o<0&&(s=this.p0),o>1&&(s=this.p1);var u=this.project(i.p1);return a<0&&(u=this.p0),a>1&&(u=this.p1),new Jn(s,u)}};Jn.prototype.normalize=function(){this.p1.compareTo(this.p0)<0&&this.reverse()};Jn.prototype.angle=function(){return Math.atan2(this.p1.y-this.p0.y,this.p1.x-this.p0.x)};Jn.prototype.getCoordinate=function(e){return e===0?this.p0:this.p1};Jn.prototype.distancePerpendicular=function(e){return Rn.distancePointLinePerpendicular(e,this.p0,this.p1)};Jn.prototype.minY=function(){return Math.min(this.p0.y,this.p1.y)};Jn.prototype.midPoint=function(){return Jn.midPoint(this.p0,this.p1)};Jn.prototype.projectionFactor=function(e){if(e.equals(this.p0))return 0;if(e.equals(this.p1))return 1;var n=this.p1.x-this.p0.x,r=this.p1.y-this.p0.y,i=n*n+r*r;if(i<=0)return mr.NaN;var o=((e.x-this.p0.x)*n+(e.y-this.p0.y)*r)/i;return o};Jn.prototype.closestPoints=function(e){var n=this.intersection(e);if(n!==null)return[n,n];var r=new Array(2).fill(null),i=mr.MAX_VALUE,o=null,a=this.closestPoint(e.p0);i=a.distance(e.p0),r[0]=a,r[1]=e.p0;var s=this.closestPoint(e.p1);o=s.distance(e.p1),o<i&&(i=o,r[0]=s,r[1]=e.p1);var u=e.closestPoint(this.p0);o=u.distance(this.p0),o<i&&(i=o,r[0]=this.p0,r[1]=u);var d=e.closestPoint(this.p1);return o=d.distance(this.p1),o<i&&(i=o,r[0]=this.p1,r[1]=d),r};Jn.prototype.closestPoint=function(e){var n=this.projectionFactor(e);if(n>0&&n<1)return this.project(e);var r=this.p0.distance(e),i=this.p1.distance(e);return r<i?this.p0:this.p1};Jn.prototype.maxX=function(){return Math.max(this.p0.x,this.p1.x)};Jn.prototype.getLength=function(){return this.p0.distance(this.p1)};Jn.prototype.compareTo=function(e){var n=e,r=this.p0.compareTo(n.p0);return r!==0?r:this.p1.compareTo(n.p1)};Jn.prototype.reverse=function(){var e=this.p0;this.p0=this.p1,this.p1=e};Jn.prototype.equalsTopo=function(e){return this.p0.equals(e.p0)&&(this.p1.equals(e.p1)||this.p0.equals(e.p1))&&this.p1.equals(e.p0)};Jn.prototype.lineIntersection=function(e){try{var n=mc.intersection(this.p0,this.p1,e.p0,e.p1);return n}catch(r){if(!(r instanceof U1))throw r}finally{}return null};Jn.prototype.maxY=function(){return Math.max(this.p0.y,this.p1.y)};Jn.prototype.pointAlongOffset=function(e,n){var r=this.p0.x+e*(this.p1.x-this.p0.x),i=this.p0.y+e*(this.p1.y-this.p0.y),o=this.p1.x-this.p0.x,a=this.p1.y-this.p0.y,s=Math.sqrt(o*o+a*a),u=0,d=0;if(n!==0){if(s<=0)throw new Error("Cannot compute offset from zero-length line segment");u=n*o/s,d=n*a/s}var g=r-d,_=i+u,E=new dt(g,_);return E};Jn.prototype.setCoordinates=function(){if(arguments.length===1){var e=arguments[0];this.setCoordinates(e.p0,e.p1)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.p0.x=n.x,this.p0.y=n.y,this.p1.x=r.x,this.p1.y=r.y}};Jn.prototype.segmentFraction=function(e){var n=this.projectionFactor(e);return n<0?n=0:(n>1||mr.isNaN(n))&&(n=1),n};Jn.prototype.toString=function(){return"LINESTRING( "+this.p0.x+" "+this.p0.y+", "+this.p1.x+" "+this.p1.y+")"};Jn.prototype.isHorizontal=function(){return this.p0.y===this.p1.y};Jn.prototype.distance=function(){if(arguments[0]instanceof Jn){var e=arguments[0];return Rn.distanceLineLine(this.p0,this.p1,e.p0,e.p1)}else if(arguments[0]instanceof dt){var n=arguments[0];return Rn.distancePointLine(n,this.p0,this.p1)}};Jn.prototype.pointAlong=function(e){var n=new dt;return n.x=this.p0.x+e*(this.p1.x-this.p0.x),n.y=this.p0.y+e*(this.p1.y-this.p0.y),n};Jn.prototype.hashCode=function(){var e=mr.doubleToLongBits(this.p0.x);e^=mr.doubleToLongBits(this.p0.y)*31;var n=Math.trunc(e)^Math.trunc(e>>32),r=mr.doubleToLongBits(this.p1.x);r^=mr.doubleToLongBits(this.p1.y)*31;var i=Math.trunc(r)^Math.trunc(r>>32);return n^i};Jn.prototype.interfaces_=function(){return[Uu,Gu]};Jn.prototype.getClass=function(){return Jn};Jn.midPoint=function(e,n){return new dt((e.x+n.x)/2,(e.y+n.y)/2)};pie.serialVersionUID.get=function(){return 0x2d2172135f411c00};Object.defineProperties(Jn,pie);var nE=function(){this.tempEnv1=new Qn,this.tempEnv2=new Qn,this._overlapSeg1=new Jn,this._overlapSeg2=new Jn};nE.prototype.overlap=function(){if(arguments.length!==2){if(arguments.length===4){var e=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];e.getLineSegment(n,this._overlapSeg1),r.getLineSegment(i,this._overlapSeg2),this.overlap(this._overlapSeg1,this._overlapSeg2)}}};nE.prototype.interfaces_=function(){return[]};nE.prototype.getClass=function(){return nE};var Ol=function(){this._pts=null,this._start=null,this._end=null,this._env=null,this._context=null,this._id=null;var e=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];this._pts=e,this._start=n,this._end=r,this._context=i};Ol.prototype.getLineSegment=function(e,n){n.p0=this._pts[e],n.p1=this._pts[e+1]};Ol.prototype.computeSelect=function(e,n,r,i){var o=this._pts[n],a=this._pts[r];if(i.tempEnv1.init(o,a),r-n===1)return i.select(this,n),null;if(!e.intersects(i.tempEnv1))return null;var s=Math.trunc((n+r)/2);n<s&&this.computeSelect(e,n,s,i),s<r&&this.computeSelect(e,s,r,i)};Ol.prototype.getCoordinates=function(){for(var e=this,n=new Array(this._end-this._start+1).fill(null),r=0,i=this._start;i<=this._end;i++)n[r++]=e._pts[i];return n};Ol.prototype.computeOverlaps=function(e,n){this.computeOverlapsInternal(this._start,this._end,e,e._start,e._end,n)};Ol.prototype.setId=function(e){this._id=e};Ol.prototype.select=function(e,n){this.computeSelect(e,this._start,this._end,n)};Ol.prototype.getEnvelope=function(){if(this._env===null){var e=this._pts[this._start],n=this._pts[this._end];this._env=new Qn(e,n)}return this._env};Ol.prototype.getEndIndex=function(){return this._end};Ol.prototype.getStartIndex=function(){return this._start};Ol.prototype.getContext=function(){return this._context};Ol.prototype.getId=function(){return this._id};Ol.prototype.computeOverlapsInternal=function(e,n,r,i,o,a){var s=this._pts[e],u=this._pts[n],d=r._pts[i],g=r._pts[o];if(n-e===1&&o-i===1)return a.overlap(this,e,r,i),null;if(a.tempEnv1.init(s,u),a.tempEnv2.init(d,g),!a.tempEnv1.intersects(a.tempEnv2))return null;var _=Math.trunc((e+n)/2),E=Math.trunc((i+o)/2);e<_&&(i<E&&this.computeOverlapsInternal(e,_,r,i,E,a),E<o&&this.computeOverlapsInternal(e,_,r,E,o,a)),_<n&&(i<E&&this.computeOverlapsInternal(_,n,r,i,E,a),E<o&&this.computeOverlapsInternal(_,n,r,E,o,a))};Ol.prototype.interfaces_=function(){return[]};Ol.prototype.getClass=function(){return Ol};var Af=function(){};Af.prototype.interfaces_=function(){return[]};Af.prototype.getClass=function(){return Af};Af.getChainStartIndices=function(e){var n=0,r=new bn;r.add(new bf(n));do{var i=Af.findChainEnd(e,n);r.add(new bf(i)),n=i}while(n<e.length-1);var o=Af.toIntArray(r);return o};Af.findChainEnd=function(e,n){for(var r=n;r<e.length-1&&e[r].equals2D(e[r+1]);)r++;if(r>=e.length-1)return e.length-1;for(var i=yi.quadrant(e[r],e[r+1]),o=n+1;o<e.length;){if(!e[o-1].equals2D(e[o])){var a=yi.quadrant(e[o-1],e[o]);if(a!==i)break}o++}return o-1};Af.getChains=function(){if(arguments.length===1){var e=arguments[0];return Af.getChains(e,null)}else if(arguments.length===2){for(var n=arguments[0],r=arguments[1],i=new bn,o=Af.getChainStartIndices(n),a=0;a<o.length-1;a++){var s=new Ol(n,o[a],o[a+1],r);i.add(s)}return i}};Af.toIntArray=function(e){for(var n=new Array(e.size()).fill(null),r=0;r<n.length;r++)n[r]=e.get(r).intValue();return n};var nA=function(){};nA.prototype.computeNodes=function(e){};nA.prototype.getNodedSubstrings=function(){};nA.prototype.interfaces_=function(){return[]};nA.prototype.getClass=function(){return nA};var rE=function(){if(this._segInt=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setSegmentIntersector(e)}}};rE.prototype.setSegmentIntersector=function(e){this._segInt=e};rE.prototype.interfaces_=function(){return[nA]};rE.prototype.getClass=function(){return rE};var L6=function(t){function e(r){r?t.call(this,r):t.call(this),this._monoChains=new bn,this._index=new die,this._idCounter=0,this._nodedSegStrings=null,this._nOverlaps=0}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var n={SegmentOverlapAction:{configurable:!0}};return e.prototype.getMonotoneChains=function(){return this._monoChains},e.prototype.getNodedSubstrings=function(){return Lo.getNodedSubstrings(this._nodedSegStrings)},e.prototype.getIndex=function(){return this._index},e.prototype.add=function(i){for(var o=this,a=Af.getChains(i.getCoordinates(),i),s=a.iterator();s.hasNext();){var u=s.next();u.setId(o._idCounter++),o._index.insert(u.getEnvelope(),u),o._monoChains.add(u)}},e.prototype.computeNodes=function(i){var o=this;this._nodedSegStrings=i;for(var a=i.iterator();a.hasNext();)o.add(a.next());this.intersectChains()},e.prototype.intersectChains=function(){for(var i=this,o=new A7(this._segInt),a=this._monoChains.iterator();a.hasNext();)for(var s=a.next(),u=i._index.query(s.getEnvelope()),d=u.iterator();d.hasNext();){var g=d.next();if(g.getId()>s.getId()&&(s.computeOverlaps(g,o),i._nOverlaps++),i._segInt.isDone())return null}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},n.SegmentOverlapAction.get=function(){return A7},Object.defineProperties(e,n),e}(rE),A7=function(t){function e(){t.call(this),this._si=null;var n=arguments[0];this._si=n}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.overlap=function(){if(arguments.length===4){var r=arguments[0],i=arguments[1],o=arguments[2],a=arguments[3],s=r.getContext(),u=o.getContext();this._si.processIntersections(s,i,u,a)}else return t.prototype.overlap.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(nE),oi=function t(){if(this._quadrantSegments=t.DEFAULT_QUADRANT_SEGMENTS,this._endCapStyle=t.CAP_ROUND,this._joinStyle=t.JOIN_ROUND,this._mitreLimit=t.DEFAULT_MITRE_LIMIT,this._isSingleSided=!1,this._simplifyFactor=t.DEFAULT_SIMPLIFY_FACTOR,arguments.length!==0){if(arguments.length===1){var e=arguments[0];this.setQuadrantSegments(e)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this.setQuadrantSegments(n),this.setEndCapStyle(r)}else if(arguments.length===4){var i=arguments[0],o=arguments[1],a=arguments[2],s=arguments[3];this.setQuadrantSegments(i),this.setEndCapStyle(o),this.setJoinStyle(a),this.setMitreLimit(s)}}},tp={CAP_ROUND:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},JOIN_ROUND:{configurable:!0},JOIN_MITRE:{configurable:!0},JOIN_BEVEL:{configurable:!0},DEFAULT_QUADRANT_SEGMENTS:{configurable:!0},DEFAULT_MITRE_LIMIT:{configurable:!0},DEFAULT_SIMPLIFY_FACTOR:{configurable:!0}};oi.prototype.getEndCapStyle=function(){return this._endCapStyle};oi.prototype.isSingleSided=function(){return this._isSingleSided};oi.prototype.setQuadrantSegments=function(e){this._quadrantSegments=e,this._quadrantSegments===0&&(this._joinStyle=oi.JOIN_BEVEL),this._quadrantSegments<0&&(this._joinStyle=oi.JOIN_MITRE,this._mitreLimit=Math.abs(this._quadrantSegments)),e<=0&&(this._quadrantSegments=1),this._joinStyle!==oi.JOIN_ROUND&&(this._quadrantSegments=oi.DEFAULT_QUADRANT_SEGMENTS)};oi.prototype.getJoinStyle=function(){return this._joinStyle};oi.prototype.setJoinStyle=function(e){this._joinStyle=e};oi.prototype.setSimplifyFactor=function(e){this._simplifyFactor=e<0?0:e};oi.prototype.getSimplifyFactor=function(){return this._simplifyFactor};oi.prototype.getQuadrantSegments=function(){return this._quadrantSegments};oi.prototype.setEndCapStyle=function(e){this._endCapStyle=e};oi.prototype.getMitreLimit=function(){return this._mitreLimit};oi.prototype.setMitreLimit=function(e){this._mitreLimit=e};oi.prototype.setSingleSided=function(e){this._isSingleSided=e};oi.prototype.interfaces_=function(){return[]};oi.prototype.getClass=function(){return oi};oi.bufferDistanceError=function(e){var n=Math.PI/2/e;return 1-Math.cos(n/2)};tp.CAP_ROUND.get=function(){return 1};tp.CAP_FLAT.get=function(){return 2};tp.CAP_SQUARE.get=function(){return 3};tp.JOIN_ROUND.get=function(){return 1};tp.JOIN_MITRE.get=function(){return 2};tp.JOIN_BEVEL.get=function(){return 3};tp.DEFAULT_QUADRANT_SEGMENTS.get=function(){return 8};tp.DEFAULT_MITRE_LIMIT.get=function(){return 5};tp.DEFAULT_SIMPLIFY_FACTOR.get=function(){return .01};Object.defineProperties(oi,tp);var Eo=function(e){this._distanceTol=null,this._isDeleted=null,this._angleOrientation=Rn.COUNTERCLOCKWISE,this._inputLine=e||null},i2={INIT:{configurable:!0},DELETE:{configurable:!0},KEEP:{configurable:!0},NUM_PTS_TO_CHECK:{configurable:!0}};Eo.prototype.isDeletable=function(e,n,r,i){var o=this._inputLine[e],a=this._inputLine[n],s=this._inputLine[r];return!this.isConcave(o,a,s)||!this.isShallow(o,a,s,i)?!1:this.isShallowSampled(o,a,e,r,i)};Eo.prototype.deleteShallowConcavities=function(){for(var e=this,n=1,r=this.findNextNonDeletedIndex(n),i=this.findNextNonDeletedIndex(r),o=!1;i<this._inputLine.length;){var a=!1;e.isDeletable(n,r,i,e._distanceTol)&&(e._isDeleted[r]=Eo.DELETE,a=!0,o=!0),a?n=i:n=r,r=e.findNextNonDeletedIndex(n),i=e.findNextNonDeletedIndex(r)}return o};Eo.prototype.isShallowConcavity=function(e,n,r,i){var o=Rn.computeOrientation(e,n,r),a=o===this._angleOrientation;if(!a)return!1;var s=Rn.distancePointLine(n,e,r);return s<i};Eo.prototype.isShallowSampled=function(e,n,r,i,o){var a=this,s=Math.trunc((i-r)/Eo.NUM_PTS_TO_CHECK);s<=0&&(s=1);for(var u=r;u<i;u+=s)if(!a.isShallow(e,n,a._inputLine[u],o))return!1;return!0};Eo.prototype.isConcave=function(e,n,r){var i=Rn.computeOrientation(e,n,r),o=i===this._angleOrientation;return o};Eo.prototype.simplify=function(e){var n=this;this._distanceTol=Math.abs(e),e<0&&(this._angleOrientation=Rn.CLOCKWISE),this._isDeleted=new Array(this._inputLine.length).fill(null);var r=!1;do r=n.deleteShallowConcavities();while(r);return this.collapseLine()};Eo.prototype.findNextNonDeletedIndex=function(e){for(var n=e+1;n<this._inputLine.length&&this._isDeleted[n]===Eo.DELETE;)n++;return n};Eo.prototype.isShallow=function(e,n,r,i){var o=Rn.distancePointLine(n,e,r);return o<i};Eo.prototype.collapseLine=function(){for(var e=this,n=new t2,r=0;r<this._inputLine.length;r++)e._isDeleted[r]!==Eo.DELETE&&n.add(e._inputLine[r]);return n.toCoordinateArray()};Eo.prototype.interfaces_=function(){return[]};Eo.prototype.getClass=function(){return Eo};Eo.simplify=function(e,n){var r=new Eo(e);return r.simplify(n)};i2.INIT.get=function(){return 0};i2.DELETE.get=function(){return 1};i2.KEEP.get=function(){return 1};i2.NUM_PTS_TO_CHECK.get=function(){return 10};Object.defineProperties(Eo,i2);var tu=function(){this._ptList=null,this._precisionModel=null,this._minimimVertexDistance=0,this._ptList=new bn},gie={COORDINATE_ARRAY_TYPE:{configurable:!0}};tu.prototype.getCoordinates=function(){var e=this._ptList.toArray(tu.COORDINATE_ARRAY_TYPE);return e};tu.prototype.setPrecisionModel=function(e){this._precisionModel=e};tu.prototype.addPt=function(e){var n=new dt(e);if(this._precisionModel.makePrecise(n),this.isRedundant(n))return null;this._ptList.add(n)};tu.prototype.revere=function(){};tu.prototype.addPts=function(e,n){var r=this;if(n)for(var i=0;i<e.length;i++)r.addPt(e[i]);else for(var o=e.length-1;o>=0;o--)r.addPt(e[o])};tu.prototype.isRedundant=function(e){if(this._ptList.size()<1)return!1;var n=this._ptList.get(this._ptList.size()-1),r=e.distance(n);return r<this._minimimVertexDistance};tu.prototype.toString=function(){var e=new kr,n=e.createLineString(this.getCoordinates());return n.toString()};tu.prototype.closeRing=function(){if(this._ptList.size()<1)return null;var e=new dt(this._ptList.get(0)),n=this._ptList.get(this._ptList.size()-1);if(e.equals(n))return null;this._ptList.add(e)};tu.prototype.setMinimumVertexDistance=function(e){this._minimimVertexDistance=e};tu.prototype.interfaces_=function(){return[]};tu.prototype.getClass=function(){return tu};gie.COORDINATE_ARRAY_TYPE.get=function(){return new Array(0).fill(null)};Object.defineProperties(tu,gie);var Wr=function(){},x_={PI_TIMES_2:{configurable:!0},PI_OVER_2:{configurable:!0},PI_OVER_4:{configurable:!0},COUNTERCLOCKWISE:{configurable:!0},CLOCKWISE:{configurable:!0},NONE:{configurable:!0}};Wr.prototype.interfaces_=function(){return[]};Wr.prototype.getClass=function(){return Wr};Wr.toDegrees=function(e){return e*180/Math.PI};Wr.normalize=function(e){for(;e>Math.PI;)e-=Wr.PI_TIMES_2;for(;e<=-Math.PI;)e+=Wr.PI_TIMES_2;return e};Wr.angle=function(){if(arguments.length===1){var e=arguments[0];return Math.atan2(e.y,e.x)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],i=r.x-n.x,o=r.y-n.y;return Math.atan2(o,i)}};Wr.isAcute=function(e,n,r){var i=e.x-n.x,o=e.y-n.y,a=r.x-n.x,s=r.y-n.y,u=i*a+o*s;return u>0};Wr.isObtuse=function(e,n,r){var i=e.x-n.x,o=e.y-n.y,a=r.x-n.x,s=r.y-n.y,u=i*a+o*s;return u<0};Wr.interiorAngle=function(e,n,r){var i=Wr.angle(n,e),o=Wr.angle(n,r);return Math.abs(o-i)};Wr.normalizePositive=function(e){if(e<0){for(;e<0;)e+=Wr.PI_TIMES_2;e>=Wr.PI_TIMES_2&&(e=0)}else{for(;e>=Wr.PI_TIMES_2;)e-=Wr.PI_TIMES_2;e<0&&(e=0)}return e};Wr.angleBetween=function(e,n,r){var i=Wr.angle(n,e),o=Wr.angle(n,r);return Wr.diff(i,o)};Wr.diff=function(e,n){var r=null;return e<n?r=n-e:r=e-n,r>Math.PI&&(r=2*Math.PI-r),r};Wr.toRadians=function(e){return e*Math.PI/180};Wr.getTurn=function(e,n){var r=Math.sin(n-e);return r>0?Wr.COUNTERCLOCKWISE:r<0?Wr.CLOCKWISE:Wr.NONE};Wr.angleBetweenOriented=function(e,n,r){var i=Wr.angle(n,e),o=Wr.angle(n,r),a=o-i;return a<=-Math.PI?a+Wr.PI_TIMES_2:a>Math.PI?a-Wr.PI_TIMES_2:a};x_.PI_TIMES_2.get=function(){return 2*Math.PI};x_.PI_OVER_2.get=function(){return Math.PI/2};x_.PI_OVER_4.get=function(){return Math.PI/4};x_.COUNTERCLOCKWISE.get=function(){return Rn.COUNTERCLOCKWISE};x_.CLOCKWISE.get=function(){return Rn.CLOCKWISE};x_.NONE.get=function(){return Rn.COLLINEAR};Object.defineProperties(Wr,x_);var eo=function t(){this._maxCurveSegmentError=0,this._filletAngleQuantum=null,this._closingSegLengthFactor=1,this._segList=null,this._distance=0,this._precisionModel=null,this._bufParams=null,this._li=null,this._s0=null,this._s1=null,this._s2=null,this._seg0=new Jn,this._seg1=new Jn,this._offset0=new Jn,this._offset1=new Jn,this._side=0,this._hasNarrowConcaveAngle=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._precisionModel=e,this._bufParams=n,this._li=new bA,this._filletAngleQuantum=Math.PI/2/n.getQuadrantSegments(),n.getQuadrantSegments()>=8&&n.getJoinStyle()===oi.JOIN_ROUND&&(this._closingSegLengthFactor=t.MAX_CLOSING_SEG_LEN_FACTOR),this.init(r)},o2={OFFSET_SEGMENT_SEPARATION_FACTOR:{configurable:!0},INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},CURVE_VERTEX_SNAP_DISTANCE_FACTOR:{configurable:!0},MAX_CLOSING_SEG_LEN_FACTOR:{configurable:!0}};eo.prototype.addNextSegment=function(e,n){if(this._s0=this._s1,this._s1=this._s2,this._s2=e,this._seg0.setCoordinates(this._s0,this._s1),this.computeOffsetSegment(this._seg0,this._side,this._distance,this._offset0),this._seg1.setCoordinates(this._s1,this._s2),this.computeOffsetSegment(this._seg1,this._side,this._distance,this._offset1),this._s1.equals(this._s2))return null;var r=Rn.computeOrientation(this._s0,this._s1,this._s2),i=r===Rn.CLOCKWISE&&this._side===gn.LEFT||r===Rn.COUNTERCLOCKWISE&&this._side===gn.RIGHT;r===0?this.addCollinear(n):i?this.addOutsideTurn(r,n):this.addInsideTurn(r,n)};eo.prototype.addLineEndCap=function(e,n){var r=new Jn(e,n),i=new Jn;this.computeOffsetSegment(r,gn.LEFT,this._distance,i);var o=new Jn;this.computeOffsetSegment(r,gn.RIGHT,this._distance,o);var a=n.x-e.x,s=n.y-e.y,u=Math.atan2(s,a);switch(this._bufParams.getEndCapStyle()){case oi.CAP_ROUND:this._segList.addPt(i.p1),this.addFilletArc(n,u+Math.PI/2,u-Math.PI/2,Rn.CLOCKWISE,this._distance),this._segList.addPt(o.p1);break;case oi.CAP_FLAT:this._segList.addPt(i.p1),this._segList.addPt(o.p1);break;case oi.CAP_SQUARE:var d=new dt;d.x=Math.abs(this._distance)*Math.cos(u),d.y=Math.abs(this._distance)*Math.sin(u);var g=new dt(i.p1.x+d.x,i.p1.y+d.y),_=new dt(o.p1.x+d.x,o.p1.y+d.y);this._segList.addPt(g),this._segList.addPt(_);break}};eo.prototype.getCoordinates=function(){var e=this._segList.getCoordinates();return e};eo.prototype.addMitreJoin=function(e,n,r,i){var o=!0,a=null;try{a=mc.intersection(n.p0,n.p1,r.p0,r.p1);var s=i<=0?1:a.distance(e)/Math.abs(i);s>this._bufParams.getMitreLimit()&&(o=!1)}catch(u){if(u instanceof U1)a=new dt(0,0),o=!1;else throw u}finally{}o?this._segList.addPt(a):this.addLimitedMitreJoin(n,r,i,this._bufParams.getMitreLimit())};eo.prototype.addFilletCorner=function(e,n,r,i,o){var a=n.x-e.x,s=n.y-e.y,u=Math.atan2(s,a),d=r.x-e.x,g=r.y-e.y,_=Math.atan2(g,d);i===Rn.CLOCKWISE?u<=_&&(u+=2*Math.PI):u>=_&&(u-=2*Math.PI),this._segList.addPt(n),this.addFilletArc(e,u,_,i,o),this._segList.addPt(r)};eo.prototype.addOutsideTurn=function(e,n){if(this._offset0.p1.distance(this._offset1.p0)<this._distance*eo.OFFSET_SEGMENT_SEPARATION_FACTOR)return this._segList.addPt(this._offset0.p1),null;this._bufParams.getJoinStyle()===oi.JOIN_MITRE?this.addMitreJoin(this._s1,this._offset0,this._offset1,this._distance):this._bufParams.getJoinStyle()===oi.JOIN_BEVEL?this.addBevelJoin(this._offset0,this._offset1):(n&&this._segList.addPt(this._offset0.p1),this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,e,this._distance),this._segList.addPt(this._offset1.p0))};eo.prototype.createSquare=function(e){this._segList.addPt(new dt(e.x+this._distance,e.y+this._distance)),this._segList.addPt(new dt(e.x+this._distance,e.y-this._distance)),this._segList.addPt(new dt(e.x-this._distance,e.y-this._distance)),this._segList.addPt(new dt(e.x-this._distance,e.y+this._distance)),this._segList.closeRing()};eo.prototype.addSegments=function(e,n){this._segList.addPts(e,n)};eo.prototype.addFirstSegment=function(){this._segList.addPt(this._offset1.p0)};eo.prototype.addLastSegment=function(){this._segList.addPt(this._offset1.p1)};eo.prototype.initSideSegments=function(e,n,r){this._s1=e,this._s2=n,this._side=r,this._seg1.setCoordinates(e,n),this.computeOffsetSegment(this._seg1,r,this._distance,this._offset1)};eo.prototype.addLimitedMitreJoin=function(e,n,r,i){var o=this._seg0.p1,a=Wr.angle(o,this._seg0.p0),s=Wr.angleBetweenOriented(this._seg0.p0,o,this._seg1.p1),u=s/2,d=Wr.normalize(a+u),g=Wr.normalize(d+Math.PI),_=i*r,E=_*Math.abs(Math.sin(u)),P=r-E,O=o.x+_*Math.cos(g),D=o.y+_*Math.sin(g),V=new dt(O,D),k=new Jn(o,V),F=k.pointAlongOffset(1,P),z=k.pointAlongOffset(1,-P);this._side===gn.LEFT?(this._segList.addPt(F),this._segList.addPt(z)):(this._segList.addPt(z),this._segList.addPt(F))};eo.prototype.computeOffsetSegment=function(e,n,r,i){var o=n===gn.LEFT?1:-1,a=e.p1.x-e.p0.x,s=e.p1.y-e.p0.y,u=Math.sqrt(a*a+s*s),d=o*r*a/u,g=o*r*s/u;i.p0.x=e.p0.x-g,i.p0.y=e.p0.y+d,i.p1.x=e.p1.x-g,i.p1.y=e.p1.y+d};eo.prototype.addFilletArc=function(e,n,r,i,o){var a=this,s=i===Rn.CLOCKWISE?-1:1,u=Math.abs(n-r),d=Math.trunc(u/this._filletAngleQuantum+.5);if(d<1)return null;for(var g=0,_=u/d,E=g,P=new dt;E<u;){var O=n+s*E;P.x=e.x+o*Math.cos(O),P.y=e.y+o*Math.sin(O),a._segList.addPt(P),E+=_}};eo.prototype.addInsideTurn=function(e,n){if(this._li.computeIntersection(this._offset0.p0,this._offset0.p1,this._offset1.p0,this._offset1.p1),this._li.hasIntersection())this._segList.addPt(this._li.getIntersection(0));else if(this._hasNarrowConcaveAngle=!0,this._offset0.p1.distance(this._offset1.p0)<this._distance*eo.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR)this._segList.addPt(this._offset0.p1);else{if(this._segList.addPt(this._offset0.p1),this._closingSegLengthFactor>0){var r=new dt((this._closingSegLengthFactor*this._offset0.p1.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset0.p1.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(r);var i=new dt((this._closingSegLengthFactor*this._offset1.p0.x+this._s1.x)/(this._closingSegLengthFactor+1),(this._closingSegLengthFactor*this._offset1.p0.y+this._s1.y)/(this._closingSegLengthFactor+1));this._segList.addPt(i)}else this._segList.addPt(this._s1);this._segList.addPt(this._offset1.p0)}};eo.prototype.createCircle=function(e){var n=new dt(e.x+this._distance,e.y);this._segList.addPt(n),this.addFilletArc(e,0,2*Math.PI,-1,this._distance),this._segList.closeRing()};eo.prototype.addBevelJoin=function(e,n){this._segList.addPt(e.p1),this._segList.addPt(n.p0)};eo.prototype.init=function(e){this._distance=e,this._maxCurveSegmentError=e*(1-Math.cos(this._filletAngleQuantum/2)),this._segList=new tu,this._segList.setPrecisionModel(this._precisionModel),this._segList.setMinimumVertexDistance(e*eo.CURVE_VERTEX_SNAP_DISTANCE_FACTOR)};eo.prototype.addCollinear=function(e){this._li.computeIntersection(this._s0,this._s1,this._s1,this._s2);var n=this._li.getIntersectionNum();n>=2&&(this._bufParams.getJoinStyle()===oi.JOIN_BEVEL||this._bufParams.getJoinStyle()===oi.JOIN_MITRE?(e&&this._segList.addPt(this._offset0.p1),this._segList.addPt(this._offset1.p0)):this.addFilletCorner(this._s1,this._offset0.p1,this._offset1.p0,Rn.CLOCKWISE,this._distance))};eo.prototype.closeRing=function(){this._segList.closeRing()};eo.prototype.hasNarrowConcaveAngle=function(){return this._hasNarrowConcaveAngle};eo.prototype.interfaces_=function(){return[]};eo.prototype.getClass=function(){return eo};o2.OFFSET_SEGMENT_SEPARATION_FACTOR.get=function(){return .001};o2.INSIDE_TURN_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return .001};o2.CURVE_VERTEX_SNAP_DISTANCE_FACTOR.get=function(){return 1e-6};o2.MAX_CLOSING_SEG_LEN_FACTOR.get=function(){return 80};Object.defineProperties(eo,o2);var Ja=function(){this._distance=0,this._precisionModel=null,this._bufParams=null;var e=arguments[0],n=arguments[1];this._precisionModel=e,this._bufParams=n};Ja.prototype.getOffsetCurve=function(e,n){if(this._distance=n,n===0)return null;var r=n<0,i=Math.abs(n),o=this.getSegGen(i);e.length<=1?this.computePointCurve(e[0],o):this.computeOffsetCurve(e,r,o);var a=o.getCoordinates();return r&&zr.reverse(a),a};Ja.prototype.computeSingleSidedBufferCurve=function(e,n,r){var i=this.simplifyTolerance(this._distance);if(n){r.addSegments(e,!0);var o=Eo.simplify(e,-i),a=o.length-1;r.initSideSegments(o[a],o[a-1],gn.LEFT),r.addFirstSegment();for(var s=a-2;s>=0;s--)r.addNextSegment(o[s],!0)}else{r.addSegments(e,!1);var u=Eo.simplify(e,i),d=u.length-1;r.initSideSegments(u[0],u[1],gn.LEFT),r.addFirstSegment();for(var g=2;g<=d;g++)r.addNextSegment(u[g],!0)}r.addLastSegment(),r.closeRing()};Ja.prototype.computeRingBufferCurve=function(e,n,r){var i=this.simplifyTolerance(this._distance);n===gn.RIGHT&&(i=-i);var o=Eo.simplify(e,i),a=o.length-1;r.initSideSegments(o[a-1],o[0],n);for(var s=1;s<=a;s++){var u=s!==1;r.addNextSegment(o[s],u)}r.closeRing()};Ja.prototype.computeLineBufferCurve=function(e,n){var r=this.simplifyTolerance(this._distance),i=Eo.simplify(e,r),o=i.length-1;n.initSideSegments(i[0],i[1],gn.LEFT);for(var a=2;a<=o;a++)n.addNextSegment(i[a],!0);n.addLastSegment(),n.addLineEndCap(i[o-1],i[o]);var s=Eo.simplify(e,-r),u=s.length-1;n.initSideSegments(s[u],s[u-1],gn.LEFT);for(var d=u-2;d>=0;d--)n.addNextSegment(s[d],!0);n.addLastSegment(),n.addLineEndCap(s[1],s[0]),n.closeRing()};Ja.prototype.computePointCurve=function(e,n){switch(this._bufParams.getEndCapStyle()){case oi.CAP_ROUND:n.createCircle(e);break;case oi.CAP_SQUARE:n.createSquare(e);break}};Ja.prototype.getLineCurve=function(e,n){if(this._distance=n,n<0&&!this._bufParams.isSingleSided()||n===0)return null;var r=Math.abs(n),i=this.getSegGen(r);if(e.length<=1)this.computePointCurve(e[0],i);else if(this._bufParams.isSingleSided()){var o=n<0;this.computeSingleSidedBufferCurve(e,o,i)}else this.computeLineBufferCurve(e,i);var a=i.getCoordinates();return a};Ja.prototype.getBufferParameters=function(){return this._bufParams};Ja.prototype.simplifyTolerance=function(e){return e*this._bufParams.getSimplifyFactor()};Ja.prototype.getRingCurve=function(e,n,r){if(this._distance=r,e.length<=2)return this.getLineCurve(e,r);if(r===0)return Ja.copyCoordinates(e);var i=this.getSegGen(r);return this.computeRingBufferCurve(e,n,i),i.getCoordinates()};Ja.prototype.computeOffsetCurve=function(e,n,r){var i=this.simplifyTolerance(this._distance);if(n){var o=Eo.simplify(e,-i),a=o.length-1;r.initSideSegments(o[a],o[a-1],gn.LEFT),r.addFirstSegment();for(var s=a-2;s>=0;s--)r.addNextSegment(o[s],!0)}else{var u=Eo.simplify(e,i),d=u.length-1;r.initSideSegments(u[0],u[1],gn.LEFT),r.addFirstSegment();for(var g=2;g<=d;g++)r.addNextSegment(u[g],!0)}r.addLastSegment()};Ja.prototype.getSegGen=function(e){return new eo(this._precisionModel,this._bufParams,e)};Ja.prototype.interfaces_=function(){return[]};Ja.prototype.getClass=function(){return Ja};Ja.copyCoordinates=function(e){for(var n=new Array(e.length).fill(null),r=0;r<n.length;r++)n[r]=new dt(e[r]);return n};var q0=function(){this._subgraphs=null,this._seg=new Jn,this._cga=new Rn;var e=arguments[0];this._subgraphs=e},mie={DepthSegment:{configurable:!0}};q0.prototype.findStabbedSegments=function(){var e=this;if(arguments.length===1){for(var n=arguments[0],r=new bn,i=this._subgraphs.iterator();i.hasNext();){var o=i.next(),a=o.getEnvelope();n.y<a.getMinY()||n.y>a.getMaxY()||e.findStabbedSegments(n,o.getDirectedEdges(),r)}return r}else if(arguments.length===3){if(ar(arguments[2],Ac)&&arguments[0]instanceof dt&&arguments[1]instanceof Ik)for(var s=arguments[0],u=arguments[1],d=arguments[2],g=u.getEdge().getCoordinates(),_=0;_<g.length-1;_++){e._seg.p0=g[_],e._seg.p1=g[_+1],e._seg.p0.y>e._seg.p1.y&&e._seg.reverse();var E=Math.max(e._seg.p0.x,e._seg.p1.x);if(!(E<s.x)&&!e._seg.isHorizontal()&&!(s.y<e._seg.p0.y||s.y>e._seg.p1.y)&&Rn.computeOrientation(e._seg.p0,e._seg.p1,s)!==Rn.RIGHT){var P=u.getDepth(gn.LEFT);e._seg.p0.equals(g[_])||(P=u.getDepth(gn.RIGHT));var O=new rA(e._seg,P);d.add(O)}}else if(ar(arguments[2],Ac)&&arguments[0]instanceof dt&&ar(arguments[1],Ac))for(var D=arguments[0],V=arguments[1],k=arguments[2],F=V.iterator();F.hasNext();){var z=F.next();z.isForward()&&e.findStabbedSegments(D,z,k)}}};q0.prototype.getDepth=function(e){var n=this.findStabbedSegments(e);if(n.size()===0)return 0;var r=Ec.min(n);return r._leftDepth};q0.prototype.interfaces_=function(){return[]};q0.prototype.getClass=function(){return q0};mie.DepthSegment.get=function(){return rA};Object.defineProperties(q0,mie);var rA=function(){this._upwardSeg=null,this._leftDepth=null;var e=arguments[0],n=arguments[1];this._upwardSeg=new Jn(e),this._leftDepth=n};rA.prototype.compareTo=function(e){var n=e;if(this._upwardSeg.minX()>=n._upwardSeg.maxX())return 1;if(this._upwardSeg.maxX()<=n._upwardSeg.minX())return-1;var r=this._upwardSeg.orientationIndex(n._upwardSeg);return r!==0||(r=-1*n._upwardSeg.orientationIndex(this._upwardSeg),r!==0)?r:this._upwardSeg.compareTo(n._upwardSeg)};rA.prototype.compareX=function(e,n){var r=e.p0.compareTo(n.p0);return r!==0?r:e.p1.compareTo(n.p1)};rA.prototype.toString=function(){return this._upwardSeg.toString()};rA.prototype.interfaces_=function(){return[Uu]};rA.prototype.getClass=function(){return rA};var ai=function(e,n,r){this.p0=e||null,this.p1=n||null,this.p2=r||null};ai.prototype.area=function(){return ai.area(this.p0,this.p1,this.p2)};ai.prototype.signedArea=function(){return ai.signedArea(this.p0,this.p1,this.p2)};ai.prototype.interpolateZ=function(e){if(e===null)throw new oo("Supplied point is null.");return ai.interpolateZ(e,this.p0,this.p1,this.p2)};ai.prototype.longestSideLength=function(){return ai.longestSideLength(this.p0,this.p1,this.p2)};ai.prototype.isAcute=function(){return ai.isAcute(this.p0,this.p1,this.p2)};ai.prototype.circumcentre=function(){return ai.circumcentre(this.p0,this.p1,this.p2)};ai.prototype.area3D=function(){return ai.area3D(this.p0,this.p1,this.p2)};ai.prototype.centroid=function(){return ai.centroid(this.p0,this.p1,this.p2)};ai.prototype.inCentre=function(){return ai.inCentre(this.p0,this.p1,this.p2)};ai.prototype.interfaces_=function(){return[]};ai.prototype.getClass=function(){return ai};ai.area=function(e,n,r){return Math.abs(((r.x-e.x)*(n.y-e.y)-(n.x-e.x)*(r.y-e.y))/2)};ai.signedArea=function(e,n,r){return((r.x-e.x)*(n.y-e.y)-(n.x-e.x)*(r.y-e.y))/2};ai.det=function(e,n,r,i){return e*i-n*r};ai.interpolateZ=function(e,n,r,i){var o=n.x,a=n.y,s=r.x-o,u=i.x-o,d=r.y-a,g=i.y-a,_=s*g-u*d,E=e.x-o,P=e.y-a,O=(g*E-u*P)/_,D=(-d*E+s*P)/_,V=n.z+O*(r.z-n.z)+D*(i.z-n.z);return V};ai.longestSideLength=function(e,n,r){var i=e.distance(n),o=n.distance(r),a=r.distance(e),s=i;return o>s&&(s=o),a>s&&(s=a),s};ai.isAcute=function(e,n,r){return!(!Wr.isAcute(e,n,r)||!Wr.isAcute(n,r,e)||!Wr.isAcute(r,e,n))};ai.circumcentre=function(e,n,r){var i=r.x,o=r.y,a=e.x-i,s=e.y-o,u=n.x-i,d=n.y-o,g=2*ai.det(a,s,u,d),_=ai.det(s,a*a+s*s,d,u*u+d*d),E=ai.det(a,a*a+s*s,u,u*u+d*d),P=i-_/g,O=o+E/g;return new dt(P,O)};ai.perpendicularBisector=function(e,n){var r=n.x-e.x,i=n.y-e.y,o=new mc(e.x+r/2,e.y+i/2,1),a=new mc(e.x-i+r/2,e.y+r+i/2,1);return new mc(o,a)};ai.angleBisector=function(e,n,r){var i=n.distance(e),o=n.distance(r),a=i/(i+o),s=r.x-e.x,u=r.y-e.y,d=new dt(e.x+a*s,e.y+a*u);return d};ai.area3D=function(e,n,r){var i=n.x-e.x,o=n.y-e.y,a=n.z-e.z,s=r.x-e.x,u=r.y-e.y,d=r.z-e.z,g=o*d-a*u,_=a*s-i*d,E=i*u-o*s,P=g*g+_*_+E*E,O=Math.sqrt(P)/2;return O};ai.centroid=function(e,n,r){var i=(e.x+n.x+r.x)/3,o=(e.y+n.y+r.y)/3;return new dt(i,o)};ai.inCentre=function(e,n,r){var i=n.distance(r),o=e.distance(r),a=e.distance(n),s=i+o+a,u=(i*e.x+o*n.x+a*r.x)/s,d=(i*e.y+o*n.y+a*r.y)/s;return new dt(u,d)};var ku=function(){this._inputGeom=null,this._distance=null,this._curveBuilder=null,this._curveList=new bn;var e=arguments[0],n=arguments[1],r=arguments[2];this._inputGeom=e,this._distance=n,this._curveBuilder=r};ku.prototype.addPoint=function(e){if(this._distance<=0)return null;var n=e.getCoordinates(),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,Et.EXTERIOR,Et.INTERIOR)};ku.prototype.addPolygon=function(e){var n=this,r=this._distance,i=gn.LEFT;this._distance<0&&(r=-this._distance,i=gn.RIGHT);var o=e.getExteriorRing(),a=zr.removeRepeatedPoints(o.getCoordinates());if(this._distance<0&&this.isErodedCompletely(o,this._distance)||this._distance<=0&&a.length<3)return null;this.addPolygonRing(a,r,i,Et.EXTERIOR,Et.INTERIOR);for(var s=0;s<e.getNumInteriorRing();s++){var u=e.getInteriorRingN(s),d=zr.removeRepeatedPoints(u.getCoordinates());n._distance>0&&n.isErodedCompletely(u,-n._distance)||n.addPolygonRing(d,r,gn.opposite(i),Et.INTERIOR,Et.EXTERIOR)}};ku.prototype.isTriangleErodedCompletely=function(e,n){var r=new ai(e[0],e[1],e[2]),i=r.inCentre(),o=Rn.distancePointLine(i,r.p0,r.p1);return o<Math.abs(n)};ku.prototype.addLineString=function(e){if(this._distance<=0&&!this._curveBuilder.getBufferParameters().isSingleSided())return null;var n=zr.removeRepeatedPoints(e.getCoordinates()),r=this._curveBuilder.getLineCurve(n,this._distance);this.addCurve(r,Et.EXTERIOR,Et.INTERIOR)};ku.prototype.addCurve=function(e,n,r){if(e===null||e.length<2)return null;var i=new Lo(e,new di(0,Et.BOUNDARY,n,r));this._curveList.add(i)};ku.prototype.getCurves=function(){return this.add(this._inputGeom),this._curveList};ku.prototype.addPolygonRing=function(e,n,r,i,o){if(n===0&&e.length<Ph.MINIMUM_VALID_SIZE)return null;var a=i,s=o;e.length>=Ph.MINIMUM_VALID_SIZE&&Rn.isCCW(e)&&(a=o,s=i,r=gn.opposite(r));var u=this._curveBuilder.getRingCurve(e,r,n);this.addCurve(u,a,s)};ku.prototype.add=function(e){if(e.isEmpty())return null;e instanceof us?this.addPolygon(e):e instanceof bo?this.addLineString(e):e instanceof Il?this.addPoint(e):e instanceof e1?this.addCollection(e):e instanceof tA?this.addCollection(e):e instanceof yh?this.addCollection(e):e instanceof Ra&&this.addCollection(e)};ku.prototype.isErodedCompletely=function(e,n){var r=e.getCoordinates();if(r.length<4)return n<0;if(r.length===4)return this.isTriangleErodedCompletely(r,n);var i=e.getEnvelopeInternal(),o=Math.min(i.getHeight(),i.getWidth());return n<0&&2*Math.abs(n)>o};ku.prototype.addCollection=function(e){for(var n=this,r=0;r<e.getNumGeometries();r++){var i=e.getGeometryN(r);n.add(i)}};ku.prototype.interfaces_=function(){return[]};ku.prototype.getClass=function(){return ku};var i1=function(){};i1.prototype.locate=function(e){};i1.prototype.interfaces_=function(){return[]};i1.prototype.getClass=function(){return i1};var vh=function(){this._parent=null,this._atStart=null,this._max=null,this._index=null,this._subcollectionIterator=null;var e=arguments[0];this._parent=e,this._atStart=!0,this._index=0,this._max=e.getNumGeometries()};vh.prototype.next=function(){if(this._atStart)return this._atStart=!1,vh.isAtomic(this._parent)&&this._index++,this._parent;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return this._subcollectionIterator.next();this._subcollectionIterator=null}if(this._index>=this._max)throw new j1;var e=this._parent.getGeometryN(this._index++);return e instanceof Ra?(this._subcollectionIterator=new vh(e),this._subcollectionIterator.next()):e};vh.prototype.remove=function(){throw new Error(this.getClass().getName())};vh.prototype.hasNext=function(){if(this._atStart)return!0;if(this._subcollectionIterator!==null){if(this._subcollectionIterator.hasNext())return!0;this._subcollectionIterator=null}return!(this._index>=this._max)};vh.prototype.interfaces_=function(){return[G1]};vh.prototype.getClass=function(){return vh};vh.isAtomic=function(e){return!(e instanceof Ra)};var Yl=function(){this._geom=null;var e=arguments[0];this._geom=e};Yl.prototype.locate=function(e){return Yl.locate(e,this._geom)};Yl.prototype.interfaces_=function(){return[i1]};Yl.prototype.getClass=function(){return Yl};Yl.isPointInRing=function(e,n){return n.getEnvelopeInternal().intersects(e)?Rn.isPointInRing(e,n.getCoordinates()):!1};Yl.containsPointInPolygon=function(e,n){if(n.isEmpty())return!1;var r=n.getExteriorRing();if(!Yl.isPointInRing(e,r))return!1;for(var i=0;i<n.getNumInteriorRing();i++){var o=n.getInteriorRingN(i);if(Yl.isPointInRing(e,o))return!1}return!0};Yl.containsPoint=function(e,n){if(n instanceof us)return Yl.containsPointInPolygon(e,n);if(n instanceof Ra)for(var r=new vh(n);r.hasNext();){var i=r.next();if(i!==n&&Yl.containsPoint(e,i))return!0}return!1};Yl.locate=function(e,n){return n.isEmpty()?Et.EXTERIOR:Yl.containsPoint(e,n)?Et.INTERIOR:Et.EXTERIOR};var ua=function(){this._edgeMap=new aa,this._edgeList=null,this._ptInAreaLocation=[Et.NONE,Et.NONE]};ua.prototype.getNextCW=function(e){this.getEdges();var n=this._edgeList.indexOf(e),r=n-1;return n===0&&(r=this._edgeList.size()-1),this._edgeList.get(r)};ua.prototype.propagateSideLabels=function(e){for(var n=Et.NONE,r=this.iterator();r.hasNext();){var i=r.next(),o=i.getLabel();o.isArea(e)&&o.getLocation(e,gn.LEFT)!==Et.NONE&&(n=o.getLocation(e,gn.LEFT))}if(n===Et.NONE)return null;for(var a=n,s=this.iterator();s.hasNext();){var u=s.next(),d=u.getLabel();if(d.getLocation(e,gn.ON)===Et.NONE&&d.setLocation(e,gn.ON,a),d.isArea(e)){var g=d.getLocation(e,gn.LEFT),_=d.getLocation(e,gn.RIGHT);if(_!==Et.NONE){if(_!==a)throw new Wd("side location conflict",u.getCoordinate());g===Et.NONE&&Pr.shouldNeverReachHere("found single null side (at "+u.getCoordinate()+")"),a=g}else Pr.isTrue(d.getLocation(e,gn.LEFT)===Et.NONE,"found single null side"),d.setLocation(e,gn.RIGHT,a),d.setLocation(e,gn.LEFT,a)}}};ua.prototype.getCoordinate=function(){var e=this.iterator();if(!e.hasNext())return null;var n=e.next();return n.getCoordinate()};ua.prototype.print=function(e){qs.out.println("EdgeEndStar:   "+this.getCoordinate());for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(e)}};ua.prototype.isAreaLabelsConsistent=function(e){return this.computeEdgeEndLabels(e.getBoundaryNodeRule()),this.checkAreaLabelsConsistent(0)};ua.prototype.checkAreaLabelsConsistent=function(e){var n=this.getEdges();if(n.size()<=0)return!0;var r=n.size()-1,i=n.get(r).getLabel(),o=i.getLocation(e,gn.LEFT);Pr.isTrue(o!==Et.NONE,"Found unlabelled area edge");for(var a=o,s=this.iterator();s.hasNext();){var u=s.next(),d=u.getLabel();Pr.isTrue(d.isArea(e),"Found non-area edge");var g=d.getLocation(e,gn.LEFT),_=d.getLocation(e,gn.RIGHT);if(g===_||_!==a)return!1;a=g}return!0};ua.prototype.findIndex=function(e){var n=this;this.iterator();for(var r=0;r<this._edgeList.size();r++){var i=n._edgeList.get(r);if(i===e)return r}return-1};ua.prototype.iterator=function(){return this.getEdges().iterator()};ua.prototype.getEdges=function(){return this._edgeList===null&&(this._edgeList=new bn(this._edgeMap.values())),this._edgeList};ua.prototype.getLocation=function(e,n,r){return this._ptInAreaLocation[e]===Et.NONE&&(this._ptInAreaLocation[e]=Yl.locate(n,r[e].getGeometry())),this._ptInAreaLocation[e]};ua.prototype.toString=function(){var e=new Df;e.append("EdgeEndStar:   "+this.getCoordinate()),e.append(`
`);for(var n=this.iterator();n.hasNext();){var r=n.next();e.append(r),e.append(`
`)}return e.toString()};ua.prototype.computeEdgeEndLabels=function(e){for(var n=this.iterator();n.hasNext();){var r=n.next();r.computeLabel(e)}};ua.prototype.computeLabelling=function(e){var n=this;this.computeEdgeEndLabels(e[0].getBoundaryNodeRule()),this.propagateSideLabels(0),this.propagateSideLabels(1);for(var r=[!1,!1],i=this.iterator();i.hasNext();)for(var o=i.next(),a=o.getLabel(),s=0;s<2;s++)a.isLine(s)&&a.getLocation(s)===Et.BOUNDARY&&(r[s]=!0);for(var u=this.iterator();u.hasNext();)for(var d=u.next(),g=d.getLabel(),_=0;_<2;_++)if(g.isAnyNull(_)){var E=Et.NONE;if(r[_])E=Et.EXTERIOR;else{var P=d.getCoordinate();E=n.getLocation(_,P,e)}g.setAllLocationsIfNull(_,E)}};ua.prototype.getDegree=function(){return this._edgeMap.size()};ua.prototype.insertEdgeEnd=function(e,n){this._edgeMap.put(e,n),this._edgeList=null};ua.prototype.interfaces_=function(){return[]};ua.prototype.getClass=function(){return ua};var XRe=function(t){function e(){t.call(this),this._resultAreaEdgeList=null,this._label=null,this._SCANNING_FOR_INCOMING=1,this._LINKING_TO_OUTGOING=2}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.linkResultDirectedEdges=function(){var r=this;this.getResultAreaEdges();for(var i=null,o=null,a=this._SCANNING_FOR_INCOMING,s=0;s<this._resultAreaEdgeList.size();s++){var u=r._resultAreaEdgeList.get(s),d=u.getSym();if(u.getLabel().isArea())switch(i===null&&u.isInResult()&&(i=u),a){case r._SCANNING_FOR_INCOMING:if(!d.isInResult())continue;o=d,a=r._LINKING_TO_OUTGOING;break;case r._LINKING_TO_OUTGOING:if(!u.isInResult())continue;o.setNext(u),a=r._SCANNING_FOR_INCOMING;break}}if(a===this._LINKING_TO_OUTGOING){if(i===null)throw new Wd("no outgoing dirEdge found",this.getCoordinate());Pr.isTrue(i.isInResult(),"unable to link last incoming dirEdge"),o.setNext(i)}},e.prototype.insert=function(r){var i=r;this.insertEdgeEnd(i,i)},e.prototype.getRightmostEdge=function(){var r=this.getEdges(),i=r.size();if(i<1)return null;var o=r.get(0);if(i===1)return o;var a=r.get(i-1),s=o.getQuadrant(),u=a.getQuadrant();return yi.isNorthern(s)&&yi.isNorthern(u)?o:!yi.isNorthern(s)&&!yi.isNorthern(u)?a:o.getDy()!==0?o:a.getDy()!==0?a:(Pr.shouldNeverReachHere("found two horizontal edges incident on node"),null)},e.prototype.print=function(r){qs.out.println("DirectedEdgeStar: "+this.getCoordinate());for(var i=this.iterator();i.hasNext();){var o=i.next();r.print("out "),o.print(r),r.println(),r.print("in "),o.getSym().print(r),r.println()}},e.prototype.getResultAreaEdges=function(){var r=this;if(this._resultAreaEdgeList!==null)return this._resultAreaEdgeList;this._resultAreaEdgeList=new bn;for(var i=this.iterator();i.hasNext();){var o=i.next();(o.isInResult()||o.getSym().isInResult())&&r._resultAreaEdgeList.add(o)}return this._resultAreaEdgeList},e.prototype.updateLabelling=function(r){for(var i=this.iterator();i.hasNext();){var o=i.next(),a=o.getLabel();a.setAllLocationsIfNull(0,r.getLocation(0)),a.setAllLocationsIfNull(1,r.getLocation(1))}},e.prototype.linkAllDirectedEdges=function(){var r=this;this.getEdges();for(var i=null,o=null,a=this._edgeList.size()-1;a>=0;a--){var s=r._edgeList.get(a),u=s.getSym();o===null&&(o=u),i!==null&&u.setNext(i),i=s}o.setNext(i)},e.prototype.computeDepths=function(){var r=this;if(arguments.length===1){var i=arguments[0],o=this.findIndex(i),a=i.getDepth(gn.LEFT),s=i.getDepth(gn.RIGHT),u=this.computeDepths(o+1,this._edgeList.size(),a),d=this.computeDepths(0,o,u);if(d!==s)throw new Wd("depth mismatch at "+i.getCoordinate())}else if(arguments.length===3){for(var g=arguments[0],_=arguments[1],E=arguments[2],P=E,O=g;O<_;O++){var D=r._edgeList.get(O);D.setEdgeDepths(gn.RIGHT,P),P=D.getDepth(gn.LEFT)}return P}},e.prototype.mergeSymLabels=function(){for(var r=this.iterator();r.hasNext();){var i=r.next(),o=i.getLabel();o.merge(i.getSym().getLabel())}},e.prototype.linkMinimalDirectedEdges=function(r){for(var i=this,o=null,a=null,s=this._SCANNING_FOR_INCOMING,u=this._resultAreaEdgeList.size()-1;u>=0;u--){var d=i._resultAreaEdgeList.get(u),g=d.getSym();switch(o===null&&d.getEdgeRing()===r&&(o=d),s){case i._SCANNING_FOR_INCOMING:if(g.getEdgeRing()!==r)continue;a=g,s=i._LINKING_TO_OUTGOING;break;case i._LINKING_TO_OUTGOING:if(d.getEdgeRing()!==r)continue;a.setNextMin(d),s=i._SCANNING_FOR_INCOMING;break}}s===this._LINKING_TO_OUTGOING&&(Pr.isTrue(o!==null,"found null for first outgoing dirEdge"),Pr.isTrue(o.getEdgeRing()===r,"unable to link last incoming dirEdge"),a.setNextMin(o))},e.prototype.getOutgoingDegree=function(){if(arguments.length===0){for(var r=0,i=this.iterator();i.hasNext();){var o=i.next();o.isInResult()&&r++}return r}else if(arguments.length===1){for(var a=arguments[0],s=0,u=this.iterator();u.hasNext();){var d=u.next();d.getEdgeRing()===a&&s++}return s}},e.prototype.getLabel=function(){return this._label},e.prototype.findCoveredLineEdges=function(){for(var r=Et.NONE,i=this.iterator();i.hasNext();){var o=i.next(),a=o.getSym();if(!o.isLineEdge()){if(o.isInResult()){r=Et.INTERIOR;break}if(a.isInResult()){r=Et.EXTERIOR;break}}}if(r===Et.NONE)return null;for(var s=r,u=this.iterator();u.hasNext();){var d=u.next(),g=d.getSym();d.isLineEdge()?d.getEdge().setCovered(s===Et.INTERIOR):(d.isInResult()&&(s=Et.EXTERIOR),g.isInResult()&&(s=Et.INTERIOR))}},e.prototype.computeLabelling=function(r){var i=this;t.prototype.computeLabelling.call(this,r),this._label=new di(Et.NONE);for(var o=this.iterator();o.hasNext();)for(var a=o.next(),s=a.getEdge(),u=s.getLabel(),d=0;d<2;d++){var g=u.getLocation(d);(g===Et.INTERIOR||g===Et.BOUNDARY)&&i._label.setLocation(d,Et.INTERIOR)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(ua),Aie=function(t){function e(){t.apply(this,arguments)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.createNode=function(r){return new ER(r,new XRe)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(t1),dg=function t(){this._pts=null,this._orientation=null;var e=arguments[0];this._pts=e,this._orientation=t.orientation(e)};dg.prototype.compareTo=function(e){var n=e,r=dg.compareOriented(this._pts,this._orientation,n._pts,n._orientation);return r};dg.prototype.interfaces_=function(){return[Uu]};dg.prototype.getClass=function(){return dg};dg.orientation=function(e){return zr.increasingDirection(e)===1};dg.compareOriented=function(e,n,r,i){for(var o=n?1:-1,a=i?1:-1,s=n?e.length:-1,u=i?r.length:-1,d=n?0:e.length-1,g=i?0:r.length-1;;){var _=e[d].compareTo(r[g]);if(_!==0)return _;d+=o,g+=a;var E=d===s,P=g===u;if(E&&!P)return-1;if(!E&&P)return 1;if(E&&P)return 0}};var Sc=function(){this._edges=new bn,this._ocaMap=new aa};Sc.prototype.print=function(e){var n=this;e.print("MULTILINESTRING ( ");for(var r=0;r<this._edges.size();r++){var i=n._edges.get(r);r>0&&e.print(","),e.print("(");for(var o=i.getCoordinates(),a=0;a<o.length;a++)a>0&&e.print(","),e.print(o[a].x+" "+o[a].y);e.println(")")}e.print(")  ")};Sc.prototype.addAll=function(e){for(var n=this,r=e.iterator();r.hasNext();)n.add(r.next())};Sc.prototype.findEdgeIndex=function(e){for(var n=this,r=0;r<this._edges.size();r++)if(n._edges.get(r).equals(e))return r;return-1};Sc.prototype.iterator=function(){return this._edges.iterator()};Sc.prototype.getEdges=function(){return this._edges};Sc.prototype.get=function(e){return this._edges.get(e)};Sc.prototype.findEqualEdge=function(e){var n=new dg(e.getCoordinates()),r=this._ocaMap.get(n);return r};Sc.prototype.add=function(e){this._edges.add(e);var n=new dg(e.getCoordinates());this._ocaMap.put(n,e)};Sc.prototype.interfaces_=function(){return[]};Sc.prototype.getClass=function(){return Sc};var iA=function(){};iA.prototype.processIntersections=function(e,n,r,i){};iA.prototype.isDone=function(){};iA.prototype.interfaces_=function(){return[]};iA.prototype.getClass=function(){return iA};var nu=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._hasInterior=!1,this._properIntersectionPoint=null,this._li=null,this._isSelfIntersection=null,this.numIntersections=0,this.numInteriorIntersections=0,this.numProperIntersections=0,this.numTests=0;var e=arguments[0];this._li=e};nu.prototype.isTrivialIntersection=function(e,n,r,i){if(e===r&&this._li.getIntersectionNum()===1){if(nu.isAdjacentSegments(n,i))return!0;if(e.isClosed()){var o=e.size()-1;if(n===0&&i===o||i===0&&n===o)return!0}}return!1};nu.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};nu.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};nu.prototype.getLineIntersector=function(){return this._li};nu.prototype.hasProperIntersection=function(){return this._hasProper};nu.prototype.processIntersections=function(e,n,r,i){if(e===r&&n===i)return null;this.numTests++;var o=e.getCoordinates()[n],a=e.getCoordinates()[n+1],s=r.getCoordinates()[i],u=r.getCoordinates()[i+1];this._li.computeIntersection(o,a,s,u),this._li.hasIntersection()&&(this.numIntersections++,this._li.isInteriorIntersection()&&(this.numInteriorIntersections++,this._hasInterior=!0),this.isTrivialIntersection(e,n,r,i)||(this._hasIntersection=!0,e.addIntersections(this._li,n,0),r.addIntersections(this._li,i,1),this._li.isProper()&&(this.numProperIntersections++,this._hasProper=!0,this._hasProperInterior=!0)))};nu.prototype.hasIntersection=function(){return this._hasIntersection};nu.prototype.isDone=function(){return!1};nu.prototype.hasInteriorIntersection=function(){return this._hasInterior};nu.prototype.interfaces_=function(){return[iA]};nu.prototype.getClass=function(){return nu};nu.isAdjacentSegments=function(e,n){return Math.abs(e-n)===1};var Pf=function(){this.coord=null,this.segmentIndex=null,this.dist=null;var e=arguments[0],n=arguments[1],r=arguments[2];this.coord=new dt(e),this.segmentIndex=n,this.dist=r};Pf.prototype.getSegmentIndex=function(){return this.segmentIndex};Pf.prototype.getCoordinate=function(){return this.coord};Pf.prototype.print=function(e){e.print(this.coord),e.print(" seg # = "+this.segmentIndex),e.println(" dist = "+this.dist)};Pf.prototype.compareTo=function(e){var n=e;return this.compare(n.segmentIndex,n.dist)};Pf.prototype.isEndPoint=function(e){return this.segmentIndex===0&&this.dist===0||this.segmentIndex===e};Pf.prototype.toString=function(){return this.coord+" seg # = "+this.segmentIndex+" dist = "+this.dist};Pf.prototype.getDistance=function(){return this.dist};Pf.prototype.compare=function(e,n){return this.segmentIndex<e?-1:this.segmentIndex>e?1:this.dist<n?-1:this.dist>n?1:0};Pf.prototype.interfaces_=function(){return[Uu]};Pf.prototype.getClass=function(){return Pf};var Oh=function(){this._nodeMap=new aa,this.edge=null;var e=arguments[0];this.edge=e};Oh.prototype.print=function(e){e.println("Intersections:");for(var n=this.iterator();n.hasNext();){var r=n.next();r.print(e)}};Oh.prototype.iterator=function(){return this._nodeMap.values().iterator()};Oh.prototype.addSplitEdges=function(e){var n=this;this.addEndpoints();for(var r=this.iterator(),i=r.next();r.hasNext();){var o=r.next(),a=n.createSplitEdge(i,o);e.add(a),i=o}};Oh.prototype.addEndpoints=function(){var e=this.edge.pts.length-1;this.add(this.edge.pts[0],0,0),this.add(this.edge.pts[e],e,0)};Oh.prototype.createSplitEdge=function(e,n){var r=this,i=n.segmentIndex-e.segmentIndex+2,o=this.edge.pts[n.segmentIndex],a=n.dist>0||!n.coord.equals2D(o);a||i--;var s=new Array(i).fill(null),u=0;s[u++]=new dt(e.coord);for(var d=e.segmentIndex+1;d<=n.segmentIndex;d++)s[u++]=r.edge.pts[d];return a&&(s[u]=n.coord),new MI(s,new di(this.edge._label))};Oh.prototype.add=function(e,n,r){var i=new Pf(e,n,r),o=this._nodeMap.get(i);return o!==null?o:(this._nodeMap.put(i,i),i)};Oh.prototype.isIntersection=function(e){for(var n=this.iterator();n.hasNext();){var r=n.next();if(r.coord.equals(e))return!0}return!1};Oh.prototype.interfaces_=function(){return[]};Oh.prototype.getClass=function(){return Oh};var oA=function(){};oA.prototype.getChainStartIndices=function(e){var n=this,r=0,i=new bn;i.add(new bf(r));do{var o=n.findChainEnd(e,r);i.add(new bf(o)),r=o}while(r<e.length-1);var a=oA.toIntArray(i);return a};oA.prototype.findChainEnd=function(e,n){for(var r=yi.quadrant(e[n],e[n+1]),i=n+1;i<e.length;){var o=yi.quadrant(e[i-1],e[i]);if(o!==r)break;i++}return i-1};oA.prototype.interfaces_=function(){return[]};oA.prototype.getClass=function(){return oA};oA.toIntArray=function(e){for(var n=new Array(e.size()).fill(null),r=0;r<n.length;r++)n[r]=e.get(r).intValue();return n};var Xd=function(){this.e=null,this.pts=null,this.startIndex=null,this.env1=new Qn,this.env2=new Qn;var e=arguments[0];this.e=e,this.pts=e.getCoordinates();var n=new oA;this.startIndex=n.getChainStartIndices(this.pts)};Xd.prototype.getCoordinates=function(){return this.pts};Xd.prototype.getMaxX=function(e){var n=this.pts[this.startIndex[e]].x,r=this.pts[this.startIndex[e+1]].x;return n>r?n:r};Xd.prototype.getMinX=function(e){var n=this.pts[this.startIndex[e]].x,r=this.pts[this.startIndex[e+1]].x;return n<r?n:r};Xd.prototype.computeIntersectsForChain=function(){if(arguments.length===4){var e=arguments[0],n=arguments[1],r=arguments[2],i=arguments[3];this.computeIntersectsForChain(this.startIndex[e],this.startIndex[e+1],n,n.startIndex[r],n.startIndex[r+1],i)}else if(arguments.length===6){var o=arguments[0],a=arguments[1],s=arguments[2],u=arguments[3],d=arguments[4],g=arguments[5],_=this.pts[o],E=this.pts[a],P=s.pts[u],O=s.pts[d];if(a-o===1&&d-u===1)return g.addIntersections(this.e,o,s.e,u),null;if(this.env1.init(_,E),this.env2.init(P,O),!this.env1.intersects(this.env2))return null;var D=Math.trunc((o+a)/2),V=Math.trunc((u+d)/2);o<D&&(u<V&&this.computeIntersectsForChain(o,D,s,u,V,g),V<d&&this.computeIntersectsForChain(o,D,s,V,d,g)),D<a&&(u<V&&this.computeIntersectsForChain(D,a,s,u,V,g),V<d&&this.computeIntersectsForChain(D,a,s,V,d,g))}};Xd.prototype.getStartIndexes=function(){return this.startIndex};Xd.prototype.computeIntersects=function(e,n){for(var r=this,i=0;i<this.startIndex.length-1;i++)for(var o=0;o<e.startIndex.length-1;o++)r.computeIntersectsForChain(i,e,o,n)};Xd.prototype.interfaces_=function(){return[]};Xd.prototype.getClass=function(){return Xd};var Hs=function t(){var e=this;this._depth=Array(2).fill().map(function(){return Array(3)});for(var n=0;n<2;n++)for(var r=0;r<3;r++)e._depth[n][r]=t.NULL_VALUE},_ie={NULL_VALUE:{configurable:!0}};Hs.prototype.getDepth=function(e,n){return this._depth[e][n]};Hs.prototype.setDepth=function(e,n,r){this._depth[e][n]=r};Hs.prototype.isNull=function(){var e=this;if(arguments.length===0){for(var n=0;n<2;n++)for(var r=0;r<3;r++)if(e._depth[n][r]!==Hs.NULL_VALUE)return!1;return!0}else if(arguments.length===1){var i=arguments[0];return this._depth[i][1]===Hs.NULL_VALUE}else if(arguments.length===2){var o=arguments[0],a=arguments[1];return this._depth[o][a]===Hs.NULL_VALUE}};Hs.prototype.normalize=function(){for(var e=this,n=0;n<2;n++)if(!e.isNull(n)){var r=e._depth[n][1];e._depth[n][2]<r&&(r=e._depth[n][2]),r<0&&(r=0);for(var i=1;i<3;i++){var o=0;e._depth[n][i]>r&&(o=1),e._depth[n][i]=o}}};Hs.prototype.getDelta=function(e){return this._depth[e][gn.RIGHT]-this._depth[e][gn.LEFT]};Hs.prototype.getLocation=function(e,n){return this._depth[e][n]<=0?Et.EXTERIOR:Et.INTERIOR};Hs.prototype.toString=function(){return"A: "+this._depth[0][1]+","+this._depth[0][2]+" B: "+this._depth[1][1]+","+this._depth[1][2]};Hs.prototype.add=function(){var e=this;if(arguments.length===1)for(var n=arguments[0],r=0;r<2;r++)for(var i=1;i<3;i++){var o=n.getLocation(r,i);(o===Et.EXTERIOR||o===Et.INTERIOR)&&(e.isNull(r,i)?e._depth[r][i]=Hs.depthAtLocation(o):e._depth[r][i]+=Hs.depthAtLocation(o))}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2];u===Et.INTERIOR&&this._depth[a][s]++}};Hs.prototype.interfaces_=function(){return[]};Hs.prototype.getClass=function(){return Hs};Hs.depthAtLocation=function(e){return e===Et.EXTERIOR?0:e===Et.INTERIOR?1:Hs.NULL_VALUE};_ie.NULL_VALUE.get=function(){return-1};Object.defineProperties(Hs,_ie);var MI=function(t){function e(){if(t.call(this),this.pts=null,this._env=null,this.eiList=new Oh(this),this._name=null,this._mce=null,this._isIsolated=!0,this._depth=new Hs,this._depthDelta=0,arguments.length===1){var n=arguments[0];e.call(this,n,null)}else if(arguments.length===2){var r=arguments[0],i=arguments[1];this.pts=r,this._label=i}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.getDepth=function(){return this._depth},e.prototype.getCollapsedEdge=function(){var r=new Array(2).fill(null);r[0]=this.pts[0],r[1]=this.pts[1];var i=new e(r,di.toLineLabel(this._label));return i},e.prototype.isIsolated=function(){return this._isIsolated},e.prototype.getCoordinates=function(){return this.pts},e.prototype.setIsolated=function(r){this._isIsolated=r},e.prototype.setName=function(r){this._name=r},e.prototype.equals=function(r){var i=this;if(!(r instanceof e))return!1;var o=r;if(this.pts.length!==o.pts.length)return!1;for(var a=!0,s=!0,u=this.pts.length,d=0;d<this.pts.length;d++)if(i.pts[d].equals2D(o.pts[d])||(a=!1),i.pts[d].equals2D(o.pts[--u])||(s=!1),!a&&!s)return!1;return!0},e.prototype.getCoordinate=function(){if(arguments.length===0)return this.pts.length>0?this.pts[0]:null;if(arguments.length===1){var r=arguments[0];return this.pts[r]}},e.prototype.print=function(r){var i=this;r.print("edge "+this._name+": "),r.print("LINESTRING (");for(var o=0;o<this.pts.length;o++)o>0&&r.print(","),r.print(i.pts[o].x+" "+i.pts[o].y);r.print(")  "+this._label+" "+this._depthDelta)},e.prototype.computeIM=function(r){e.updateIM(this._label,r)},e.prototype.isCollapsed=function(){return!this._label.isArea()||this.pts.length!==3?!1:!!this.pts[0].equals(this.pts[2])},e.prototype.isClosed=function(){return this.pts[0].equals(this.pts[this.pts.length-1])},e.prototype.getMaximumSegmentIndex=function(){return this.pts.length-1},e.prototype.getDepthDelta=function(){return this._depthDelta},e.prototype.getNumPoints=function(){return this.pts.length},e.prototype.printReverse=function(r){var i=this;r.print("edge "+this._name+": ");for(var o=this.pts.length-1;o>=0;o--)r.print(i.pts[o]+" ");r.println("")},e.prototype.getMonotoneChainEdge=function(){return this._mce===null&&(this._mce=new Xd(this)),this._mce},e.prototype.getEnvelope=function(){var r=this;if(this._env===null){this._env=new Qn;for(var i=0;i<this.pts.length;i++)r._env.expandToInclude(r.pts[i])}return this._env},e.prototype.addIntersection=function(r,i,o,a){var s=new dt(r.getIntersection(a)),u=i,d=r.getEdgeDistance(o,a),g=u+1;if(g<this.pts.length){var _=this.pts[g];s.equals2D(_)&&(u=g,d=0)}this.eiList.add(s,u,d)},e.prototype.toString=function(){var r=this,i=new Df;i.append("edge "+this._name+": "),i.append("LINESTRING (");for(var o=0;o<this.pts.length;o++)o>0&&i.append(","),i.append(r.pts[o].x+" "+r.pts[o].y);return i.append(")  "+this._label+" "+this._depthDelta),i.toString()},e.prototype.isPointwiseEqual=function(r){var i=this;if(this.pts.length!==r.pts.length)return!1;for(var o=0;o<this.pts.length;o++)if(!i.pts[o].equals2D(r.pts[o]))return!1;return!0},e.prototype.setDepthDelta=function(r){this._depthDelta=r},e.prototype.getEdgeIntersectionList=function(){return this.eiList},e.prototype.addIntersections=function(r,i,o){for(var a=this,s=0;s<r.getIntersectionNum();s++)a.addIntersection(r,i,o,s)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.updateIM=function(){if(arguments.length===2){var r=arguments[0],i=arguments[1];i.setAtLeastIfValid(r.getLocation(0,gn.ON),r.getLocation(1,gn.ON),1),r.isArea()&&(i.setAtLeastIfValid(r.getLocation(0,gn.LEFT),r.getLocation(1,gn.LEFT),2),i.setAtLeastIfValid(r.getLocation(0,gn.RIGHT),r.getLocation(1,gn.RIGHT),2))}else return t.prototype.updateIM.apply(this,arguments)},e}(eu),Ia=function(e){this._workingPrecisionModel=null,this._workingNoder=null,this._geomFact=null,this._graph=null,this._edgeList=new Sc,this._bufParams=e||null};Ia.prototype.setWorkingPrecisionModel=function(e){this._workingPrecisionModel=e};Ia.prototype.insertUniqueEdge=function(e){var n=this._edgeList.findEqualEdge(e);if(n!==null){var r=n.getLabel(),i=e.getLabel();n.isPointwiseEqual(e)||(i=new di(e.getLabel()),i.flip()),r.merge(i);var o=Ia.depthDelta(i),a=n.getDepthDelta(),s=a+o;n.setDepthDelta(s)}else this._edgeList.add(e),e.setDepthDelta(Ia.depthDelta(e.getLabel()))};Ia.prototype.buildSubgraphs=function(e,n){for(var r=new bn,i=e.iterator();i.hasNext();){var o=i.next(),a=o.getRightmostCoordinate(),s=new q0(r),u=s.getDepth(a);o.computeDepth(u),o.findResultEdges(),r.add(o),n.add(o.getDirectedEdges(),o.getNodes())}};Ia.prototype.createSubgraphs=function(e){for(var n=new bn,r=e.getNodes().iterator();r.hasNext();){var i=r.next();if(!i.isVisited()){var o=new La;o.create(i),n.add(o)}}return Ec.sort(n,Ec.reverseOrder()),n};Ia.prototype.createEmptyResultGeometry=function(){var e=this._geomFact.createPolygon();return e};Ia.prototype.getNoder=function(e){if(this._workingNoder!==null)return this._workingNoder;var n=new L6,r=new bA;return r.setPrecisionModel(e),n.setSegmentIntersector(new nu(r)),n};Ia.prototype.buffer=function(e,n){var r=this._workingPrecisionModel;r===null&&(r=e.getPrecisionModel()),this._geomFact=e.getFactory();var i=new Ja(r,this._bufParams),o=new ku(e,n,i),a=o.getCurves();if(a.size()<=0)return this.createEmptyResultGeometry();this.computeNodedEdges(a,r),this._graph=new po(new Aie),this._graph.addEdges(this._edgeList.getEdges());var s=this.createSubgraphs(this._graph),u=new Ml(this._geomFact);this.buildSubgraphs(s,u);var d=u.getPolygons();if(d.size()<=0)return this.createEmptyResultGeometry();var g=this._geomFact.buildGeometry(d);return g};Ia.prototype.computeNodedEdges=function(e,n){var r=this,i=this.getNoder(n);i.computeNodes(e);for(var o=i.getNodedSubstrings(),a=o.iterator();a.hasNext();){var s=a.next(),u=s.getCoordinates();if(!(u.length===2&&u[0].equals2D(u[1]))){var d=s.getData(),g=new MI(s.getCoordinates(),new di(d));r.insertUniqueEdge(g)}}};Ia.prototype.setNoder=function(e){this._workingNoder=e};Ia.prototype.interfaces_=function(){return[]};Ia.prototype.getClass=function(){return Ia};Ia.depthDelta=function(e){var n=e.getLocation(0,gn.LEFT),r=e.getLocation(0,gn.RIGHT);return n===Et.INTERIOR&&r===Et.EXTERIOR?1:n===Et.EXTERIOR&&r===Et.INTERIOR?-1:0};Ia.convertSegStrings=function(e){for(var n=new kr,r=new bn;e.hasNext();){var i=e.next(),o=n.createLineString(i.getCoordinates());r.add(o)}return n.buildGeometry(r)};var pg=function(){if(this._noder=null,this._scaleFactor=null,this._offsetX=null,this._offsetY=null,this._isScaled=!1,arguments.length===2){var e=arguments[0],n=arguments[1];this._noder=e,this._scaleFactor=n,this._offsetX=0,this._offsetY=0,this._isScaled=!this.isIntegerPrecision()}else if(arguments.length===4){var r=arguments[0],i=arguments[1],o=arguments[2],a=arguments[3];this._noder=r,this._scaleFactor=i,this._offsetX=o,this._offsetY=a,this._isScaled=!this.isIntegerPrecision()}};pg.prototype.rescale=function(){var e=this;if(ar(arguments[0],Jo))for(var n=arguments[0],r=n.iterator();r.hasNext();){var i=r.next();e.rescale(i.getCoordinates())}else if(arguments[0]instanceof Array){for(var o=arguments[0],a=0;a<o.length;a++)o[a].x=o[a].x/e._scaleFactor+e._offsetX,o[a].y=o[a].y/e._scaleFactor+e._offsetY;o.length===2&&o[0].equals2D(o[1])&&qs.out.println(o)}};pg.prototype.scale=function(){var e=this;if(ar(arguments[0],Jo)){for(var n=arguments[0],r=new bn,i=n.iterator();i.hasNext();){var o=i.next();r.add(new Lo(e.scale(o.getCoordinates()),o.getData()))}return r}else if(arguments[0]instanceof Array){for(var a=arguments[0],s=new Array(a.length).fill(null),u=0;u<a.length;u++)s[u]=new dt(Math.round((a[u].x-e._offsetX)*e._scaleFactor),Math.round((a[u].y-e._offsetY)*e._scaleFactor),a[u].z);var d=zr.removeRepeatedPoints(s);return d}};pg.prototype.isIntegerPrecision=function(){return this._scaleFactor===1};pg.prototype.getNodedSubstrings=function(){var e=this._noder.getNodedSubstrings();return this._isScaled&&this.rescale(e),e};pg.prototype.computeNodes=function(e){var n=e;this._isScaled&&(n=this.scale(e)),this._noder.computeNodes(n)};pg.prototype.interfaces_=function(){return[nA]};pg.prototype.getClass=function(){return pg};var If=function(){this._li=new bA,this._segStrings=null;var e=arguments[0];this._segStrings=e},yie={fact:{configurable:!0}};If.prototype.checkEndPtVertexIntersections=function(){var e=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next(),i=r.getCoordinates();e.checkEndPtVertexIntersections(i[0],e._segStrings),e.checkEndPtVertexIntersections(i[i.length-1],e._segStrings)}else if(arguments.length===2){for(var o=arguments[0],a=arguments[1],s=a.iterator();s.hasNext();)for(var u=s.next(),d=u.getCoordinates(),g=1;g<d.length-1;g++)if(d[g].equals(o))throw new $d("found endpt/interior pt intersection at index "+g+" :pt "+o)}};If.prototype.checkInteriorIntersections=function(){var e=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();)for(var r=n.next(),i=this._segStrings.iterator();i.hasNext();){var o=i.next();e.checkInteriorIntersections(r,o)}else if(arguments.length===2)for(var a=arguments[0],s=arguments[1],u=a.getCoordinates(),d=s.getCoordinates(),g=0;g<u.length-1;g++)for(var _=0;_<d.length-1;_++)e.checkInteriorIntersections(a,g,s,_);else if(arguments.length===4){var E=arguments[0],P=arguments[1],O=arguments[2],D=arguments[3];if(E===O&&P===D)return null;var V=E.getCoordinates()[P],k=E.getCoordinates()[P+1],F=O.getCoordinates()[D],z=O.getCoordinates()[D+1];if(this._li.computeIntersection(V,k,F,z),this._li.hasIntersection()&&(this._li.isProper()||this.hasInteriorIntersection(this._li,V,k)||this.hasInteriorIntersection(this._li,F,z)))throw new $d("found non-noded intersection at "+V+"-"+k+" and "+F+"-"+z)}};If.prototype.checkValid=function(){this.checkEndPtVertexIntersections(),this.checkInteriorIntersections(),this.checkCollapses()};If.prototype.checkCollapses=function(){var e=this;if(arguments.length===0)for(var n=this._segStrings.iterator();n.hasNext();){var r=n.next();e.checkCollapses(r)}else if(arguments.length===1)for(var i=arguments[0],o=i.getCoordinates(),a=0;a<o.length-2;a++)e.checkCollapse(o[a],o[a+1],o[a+2])};If.prototype.hasInteriorIntersection=function(e,n,r){for(var i=0;i<e.getIntersectionNum();i++){var o=e.getIntersection(i);if(!(o.equals(n)||o.equals(r)))return!0}return!1};If.prototype.checkCollapse=function(e,n,r){if(e.equals(r))throw new $d("found non-noded collapse at "+If.fact.createLineString([e,n,r]))};If.prototype.interfaces_=function(){return[]};If.prototype.getClass=function(){return If};yie.fact.get=function(){return new kr};Object.defineProperties(If,yie);var el=function(){this._li=null,this._pt=null,this._originalPt=null,this._ptScaled=null,this._p0Scaled=null,this._p1Scaled=null,this._scaleFactor=null,this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,this._corner=new Array(4).fill(null),this._safeEnv=null;var e=arguments[0],n=arguments[1],r=arguments[2];if(this._originalPt=e,this._pt=e,this._scaleFactor=n,this._li=r,n<=0)throw new oo("Scale factor must be non-zero");n!==1&&(this._pt=new dt(this.scale(e.x),this.scale(e.y)),this._p0Scaled=new dt,this._p1Scaled=new dt),this.initCorners(this._pt)},vie={SAFE_ENV_EXPANSION_FACTOR:{configurable:!0}};el.prototype.intersectsScaled=function(e,n){var r=Math.min(e.x,n.x),i=Math.max(e.x,n.x),o=Math.min(e.y,n.y),a=Math.max(e.y,n.y),s=this._maxx<r||this._minx>i||this._maxy<o||this._miny>a;if(s)return!1;var u=this.intersectsToleranceSquare(e,n);return Pr.isTrue(!(s&&u),"Found bad envelope test"),u};el.prototype.initCorners=function(e){var n=.5;this._minx=e.x-n,this._maxx=e.x+n,this._miny=e.y-n,this._maxy=e.y+n,this._corner[0]=new dt(this._maxx,this._maxy),this._corner[1]=new dt(this._minx,this._maxy),this._corner[2]=new dt(this._minx,this._miny),this._corner[3]=new dt(this._maxx,this._miny)};el.prototype.intersects=function(e,n){return this._scaleFactor===1?this.intersectsScaled(e,n):(this.copyScaled(e,this._p0Scaled),this.copyScaled(n,this._p1Scaled),this.intersectsScaled(this._p0Scaled,this._p1Scaled))};el.prototype.scale=function(e){return Math.round(e*this._scaleFactor)};el.prototype.getCoordinate=function(){return this._originalPt};el.prototype.copyScaled=function(e,n){n.x=this.scale(e.x),n.y=this.scale(e.y)};el.prototype.getSafeEnvelope=function(){if(this._safeEnv===null){var e=el.SAFE_ENV_EXPANSION_FACTOR/this._scaleFactor;this._safeEnv=new Qn(this._originalPt.x-e,this._originalPt.x+e,this._originalPt.y-e,this._originalPt.y+e)}return this._safeEnv};el.prototype.intersectsPixelClosure=function(e,n){return this._li.computeIntersection(e,n,this._corner[0],this._corner[1]),!!(this._li.hasIntersection()||(this._li.computeIntersection(e,n,this._corner[1],this._corner[2]),this._li.hasIntersection())||(this._li.computeIntersection(e,n,this._corner[2],this._corner[3]),this._li.hasIntersection())||(this._li.computeIntersection(e,n,this._corner[3],this._corner[0]),this._li.hasIntersection()))};el.prototype.intersectsToleranceSquare=function(e,n){var r=!1,i=!1;return this._li.computeIntersection(e,n,this._corner[0],this._corner[1]),!!(this._li.isProper()||(this._li.computeIntersection(e,n,this._corner[1],this._corner[2]),this._li.isProper())||(this._li.hasIntersection()&&(r=!0),this._li.computeIntersection(e,n,this._corner[2],this._corner[3]),this._li.isProper())||(this._li.hasIntersection()&&(i=!0),this._li.computeIntersection(e,n,this._corner[3],this._corner[0]),this._li.isProper())||r&&i||e.equals(this._pt)||n.equals(this._pt))};el.prototype.addSnappedNode=function(e,n){var r=e.getCoordinate(n),i=e.getCoordinate(n+1);return this.intersects(r,i)?(e.addIntersection(this.getCoordinate(),n),!0):!1};el.prototype.interfaces_=function(){return[]};el.prototype.getClass=function(){return el};vie.SAFE_ENV_EXPANSION_FACTOR.get=function(){return .75};Object.defineProperties(el,vie);var iE=function(){this.tempEnv1=new Qn,this.selectedSegment=new Jn};iE.prototype.select=function(){if(arguments.length!==1){if(arguments.length===2){var e=arguments[0],n=arguments[1];e.getLineSegment(n,this.selectedSegment),this.select(this.selectedSegment)}}};iE.prototype.interfaces_=function(){return[]};iE.prototype.getClass=function(){return iE};var o1=function(){this._index=null;var e=arguments[0];this._index=e},xie={HotPixelSnapAction:{configurable:!0}};o1.prototype.snap=function(){if(arguments.length===1){var e=arguments[0];return this.snap(e,null,-1)}else if(arguments.length===3){var n=arguments[0],r=arguments[1],i=arguments[2],o=n.getSafeEnvelope(),a=new bie(n,r,i);return this._index.query(o,{interfaces_:function(){return[fg]},visitItem:function(s){var u=s;u.select(o,a)}}),a.isNodeAdded()}};o1.prototype.interfaces_=function(){return[]};o1.prototype.getClass=function(){return o1};xie.HotPixelSnapAction.get=function(){return bie};Object.defineProperties(o1,xie);var bie=function(t){function e(){t.call(this),this._hotPixel=null,this._parentEdge=null,this._hotPixelVertexIndex=null,this._isNodeAdded=!1;var n=arguments[0],r=arguments[1],i=arguments[2];this._hotPixel=n,this._parentEdge=r,this._hotPixelVertexIndex=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.isNodeAdded=function(){return this._isNodeAdded},e.prototype.select=function(){if(arguments.length===2){var r=arguments[0],i=arguments[1],o=r.getContext();if(this._parentEdge!==null&&o===this._parentEdge&&i===this._hotPixelVertexIndex)return null;this._isNodeAdded=this._hotPixel.addSnappedNode(o,i)}else return t.prototype.select.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(iE),X0=function(){this._li=null,this._interiorIntersections=null;var e=arguments[0];this._li=e,this._interiorIntersections=new bn};X0.prototype.processIntersections=function(e,n,r,i){var o=this;if(e===r&&n===i)return null;var a=e.getCoordinates()[n],s=e.getCoordinates()[n+1],u=r.getCoordinates()[i],d=r.getCoordinates()[i+1];if(this._li.computeIntersection(a,s,u,d),this._li.hasIntersection()&&this._li.isInteriorIntersection()){for(var g=0;g<this._li.getIntersectionNum();g++)o._interiorIntersections.add(o._li.getIntersection(g));e.addIntersections(this._li,n,0),r.addIntersections(this._li,i,1)}};X0.prototype.isDone=function(){return!1};X0.prototype.getInteriorIntersections=function(){return this._interiorIntersections};X0.prototype.interfaces_=function(){return[iA]};X0.prototype.getClass=function(){return X0};var Rh=function(){this._pm=null,this._li=null,this._scaleFactor=null,this._noder=null,this._pointSnapper=null,this._nodedSegStrings=null;var e=arguments[0];this._pm=e,this._li=new bA,this._li.setPrecisionModel(e),this._scaleFactor=e.getScale()};Rh.prototype.checkCorrectness=function(e){var n=Lo.getNodedSubstrings(e),r=new If(n);try{r.checkValid()}catch(i){if(i instanceof oie)i.printStackTrace();else throw i}finally{}};Rh.prototype.getNodedSubstrings=function(){return Lo.getNodedSubstrings(this._nodedSegStrings)};Rh.prototype.snapRound=function(e,n){var r=this.findInteriorIntersections(e,n);this.computeIntersectionSnaps(r),this.computeVertexSnaps(e)};Rh.prototype.findInteriorIntersections=function(e,n){var r=new X0(n);return this._noder.setSegmentIntersector(r),this._noder.computeNodes(e),r.getInteriorIntersections()};Rh.prototype.computeVertexSnaps=function(){var e=this;if(ar(arguments[0],Jo))for(var n=arguments[0],r=n.iterator();r.hasNext();){var i=r.next();e.computeVertexSnaps(i)}else if(arguments[0]instanceof Lo)for(var o=arguments[0],a=o.getCoordinates(),s=0;s<a.length;s++){var u=new el(a[s],e._scaleFactor,e._li),d=e._pointSnapper.snap(u,o,s);d&&o.addIntersection(a[s],s)}};Rh.prototype.computeNodes=function(e){this._nodedSegStrings=e,this._noder=new L6,this._pointSnapper=new o1(this._noder.getIndex()),this.snapRound(e,this._li)};Rh.prototype.computeIntersectionSnaps=function(e){for(var n=this,r=e.iterator();r.hasNext();){var i=r.next(),o=new el(i,n._scaleFactor,n._li);n._pointSnapper.snap(o)}};Rh.prototype.interfaces_=function(){return[nA]};Rh.prototype.getClass=function(){return Rh};var $s=function(){if(this._argGeom=null,this._distance=null,this._bufParams=new oi,this._resultGeometry=null,this._saveException=null,arguments.length===1){var e=arguments[0];this._argGeom=e}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._argGeom=n,this._bufParams=r}},V1={CAP_ROUND:{configurable:!0},CAP_BUTT:{configurable:!0},CAP_FLAT:{configurable:!0},CAP_SQUARE:{configurable:!0},MAX_PRECISION_DIGITS:{configurable:!0}};$s.prototype.bufferFixedPrecision=function(e){var n=new pg(new Rh(new si(1)),e.getScale()),r=new Ia(this._bufParams);r.setWorkingPrecisionModel(e),r.setNoder(n),this._resultGeometry=r.buffer(this._argGeom,this._distance)};$s.prototype.bufferReducedPrecision=function(){var e=this;if(arguments.length===0){for(var n=$s.MAX_PRECISION_DIGITS;n>=0;n--){try{e.bufferReducedPrecision(n)}catch(a){if(a instanceof Wd)e._saveException=a;else throw a}finally{}if(e._resultGeometry!==null)return null}throw this._saveException}else if(arguments.length===1){var r=arguments[0],i=$s.precisionScaleFactor(this._argGeom,this._distance,r),o=new si(i);this.bufferFixedPrecision(o)}};$s.prototype.computeGeometry=function(){if(this.bufferOriginalPrecision(),this._resultGeometry!==null)return null;var e=this._argGeom.getFactory().getPrecisionModel();e.getType()===si.FIXED?this.bufferFixedPrecision(e):this.bufferReducedPrecision()};$s.prototype.setQuadrantSegments=function(e){this._bufParams.setQuadrantSegments(e)};$s.prototype.bufferOriginalPrecision=function(){try{var e=new Ia(this._bufParams);this._resultGeometry=e.buffer(this._argGeom,this._distance)}catch(n){if(n instanceof $d)this._saveException=n;else throw n}finally{}};$s.prototype.getResultGeometry=function(e){return this._distance=e,this.computeGeometry(),this._resultGeometry};$s.prototype.setEndCapStyle=function(e){this._bufParams.setEndCapStyle(e)};$s.prototype.interfaces_=function(){return[]};$s.prototype.getClass=function(){return $s};$s.bufferOp=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1],r=new $s(e),i=r.getResultGeometry(n);return i}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof ir&&typeof arguments[1]=="number"){var o=arguments[0],a=arguments[1],s=arguments[2],u=new $s(o);u.setQuadrantSegments(s);var d=u.getResultGeometry(a);return d}else if(arguments[2]instanceof oi&&arguments[0]instanceof ir&&typeof arguments[1]=="number"){var g=arguments[0],_=arguments[1],E=arguments[2],P=new $s(g,E),O=P.getResultGeometry(_);return O}}else if(arguments.length===4){var D=arguments[0],V=arguments[1],k=arguments[2],F=arguments[3],z=new $s(D);z.setQuadrantSegments(k),z.setEndCapStyle(F);var X=z.getResultGeometry(V);return X}};$s.precisionScaleFactor=function(e,n,r){var i=e.getEnvelopeInternal(),o=Jl.max(Math.abs(i.getMaxX()),Math.abs(i.getMaxY()),Math.abs(i.getMinX()),Math.abs(i.getMinY())),a=n>0?n:0,s=o+2*a,u=Math.trunc(Math.log(s)/Math.log(10)+1),d=r-u,g=Math.pow(10,d);return g};V1.CAP_ROUND.get=function(){return oi.CAP_ROUND};V1.CAP_BUTT.get=function(){return oi.CAP_FLAT};V1.CAP_FLAT.get=function(){return oi.CAP_FLAT};V1.CAP_SQUARE.get=function(){return oi.CAP_SQUARE};V1.MAX_PRECISION_DIGITS.get=function(){return 12};Object.defineProperties($s,V1);var Sa=function(){this._pt=[new dt,new dt],this._distance=mr.NaN,this._isNull=!0};Sa.prototype.getCoordinates=function(){return this._pt};Sa.prototype.getCoordinate=function(e){return this._pt[e]};Sa.prototype.setMinimum=function(){if(arguments.length===1){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var i=n.distance(r);i<this._distance&&this.initialize(n,r,i)}};Sa.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var e=arguments[0],n=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(n),this._distance=e.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],i=arguments[1],o=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(i),this._distance=o,this._isNull=!1}};Sa.prototype.getDistance=function(){return this._distance};Sa.prototype.setMaximum=function(){if(arguments.length===1){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var i=n.distance(r);i>this._distance&&this.initialize(n,r,i)}};Sa.prototype.interfaces_=function(){return[]};Sa.prototype.getClass=function(){return Sa};var uh=function(){};uh.prototype.interfaces_=function(){return[]};uh.prototype.getClass=function(){return uh};uh.computeDistance=function(){if(arguments[2]instanceof Sa&&arguments[0]instanceof bo&&arguments[1]instanceof dt)for(var e=arguments[0],n=arguments[1],r=arguments[2],i=e.getCoordinates(),o=new Jn,a=0;a<i.length-1;a++){o.setCoordinates(i[a],i[a+1]);var s=o.closestPoint(n);r.setMinimum(s,n)}else if(arguments[2]instanceof Sa&&arguments[0]instanceof us&&arguments[1]instanceof dt){var u=arguments[0],d=arguments[1],g=arguments[2];uh.computeDistance(u.getExteriorRing(),d,g);for(var _=0;_<u.getNumInteriorRing();_++)uh.computeDistance(u.getInteriorRingN(_),d,g)}else if(arguments[2]instanceof Sa&&arguments[0]instanceof ir&&arguments[1]instanceof dt){var E=arguments[0],P=arguments[1],O=arguments[2];if(E instanceof bo)uh.computeDistance(E,P,O);else if(E instanceof us)uh.computeDistance(E,P,O);else if(E instanceof Ra)for(var D=E,V=0;V<D.getNumGeometries();V++){var k=D.getGeometryN(V);uh.computeDistance(k,P,O)}else O.setMinimum(E.getCoordinate(),P)}else if(arguments[2]instanceof Sa&&arguments[0]instanceof Jn&&arguments[1]instanceof dt){var F=arguments[0],z=arguments[1],X=arguments[2],Y=F.closestPoint(z);X.setMinimum(Y,z)}};var sA=function(e){this._maxPtDist=new Sa,this._inputGeom=e||null},D6={MaxPointDistanceFilter:{configurable:!0},MaxMidpointDistanceFilter:{configurable:!0}};sA.prototype.computeMaxMidpointDistance=function(e){var n=new gg(this._inputGeom);e.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};sA.prototype.computeMaxVertexDistance=function(e){var n=new Z0(this._inputGeom);e.apply(n),this._maxPtDist.setMaximum(n.getMaxPointDistance())};sA.prototype.findDistance=function(e){return this.computeMaxVertexDistance(e),this.computeMaxMidpointDistance(e),this._maxPtDist.getDistance()};sA.prototype.getDistancePoints=function(){return this._maxPtDist};sA.prototype.interfaces_=function(){return[]};sA.prototype.getClass=function(){return sA};D6.MaxPointDistanceFilter.get=function(){return Z0};D6.MaxMidpointDistanceFilter.get=function(){return gg};Object.defineProperties(sA,D6);var Z0=function(e){this._maxPtDist=new Sa,this._minPtDist=new Sa,this._geom=e||null};Z0.prototype.filter=function(e){this._minPtDist.initialize(),uh.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Z0.prototype.getMaxPointDistance=function(){return this._maxPtDist};Z0.prototype.interfaces_=function(){return[Ch]};Z0.prototype.getClass=function(){return Z0};var gg=function(e){this._maxPtDist=new Sa,this._minPtDist=new Sa,this._geom=e||null};gg.prototype.filter=function(e,n){if(n===0)return null;var r=e.getCoordinate(n-1),i=e.getCoordinate(n),o=new dt((r.x+i.x)/2,(r.y+i.y)/2);this._minPtDist.initialize(),uh.computeDistance(this._geom,o,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};gg.prototype.isDone=function(){return!1};gg.prototype.isGeometryChanged=function(){return!1};gg.prototype.getMaxPointDistance=function(){return this._maxPtDist};gg.prototype.interfaces_=function(){return[bc]};gg.prototype.getClass=function(){return gg};var zd=function(e){this._comps=e||null};zd.prototype.filter=function(e){e instanceof us&&this._comps.add(e)};zd.prototype.interfaces_=function(){return[Ef]};zd.prototype.getClass=function(){return zd};zd.getPolygons=function(){if(arguments.length===1){var e=arguments[0];return zd.getPolygons(e,new bn)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof us?r.add(n):n instanceof Ra&&n.apply(new zd(r)),r}};var Gs=function(){if(this._lines=null,this._isForcedToLineString=!1,arguments.length===1){var e=arguments[0];this._lines=e}else if(arguments.length===2){var n=arguments[0],r=arguments[1];this._lines=n,this._isForcedToLineString=r}};Gs.prototype.filter=function(e){if(this._isForcedToLineString&&e instanceof Ph){var n=e.getFactory().createLineString(e.getCoordinateSequence());return this._lines.add(n),null}e instanceof bo&&this._lines.add(e)};Gs.prototype.setForceToLineString=function(e){this._isForcedToLineString=e};Gs.prototype.interfaces_=function(){return[Hd]};Gs.prototype.getClass=function(){return Gs};Gs.getGeometry=function(){if(arguments.length===1){var e=arguments[0];return e.getFactory().buildGeometry(Gs.getLines(e))}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n.getFactory().buildGeometry(Gs.getLines(n,r))}};Gs.getLines=function(){if(arguments.length===1){var e=arguments[0];return Gs.getLines(e,!1)}else if(arguments.length===2){if(ar(arguments[0],Jo)&&ar(arguments[1],Jo)){for(var n=arguments[0],r=arguments[1],i=n.iterator();i.hasNext();){var o=i.next();Gs.getLines(o,r)}return r}else if(arguments[0]instanceof ir&&typeof arguments[1]=="boolean"){var a=arguments[0],s=arguments[1],u=new bn;return a.apply(new Gs(u,s)),u}else if(arguments[0]instanceof ir&&ar(arguments[1],Jo)){var d=arguments[0],g=arguments[1];return d instanceof bo?g.add(d):d.apply(new Gs(g)),g}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&ar(arguments[0],Jo)&&ar(arguments[1],Jo)){for(var _=arguments[0],E=arguments[1],P=arguments[2],O=_.iterator();O.hasNext();){var D=O.next();Gs.getLines(D,E,P)}return E}else if(typeof arguments[2]=="boolean"&&arguments[0]instanceof ir&&ar(arguments[1],Jo)){var V=arguments[0],k=arguments[1],F=arguments[2];return V.apply(new Gs(k,F)),k}}};var Tc=function(){if(this._boundaryRule=Nu.OGC_SFS_BOUNDARY_RULE,this._isIn=null,this._numBoundaries=null,arguments.length!==0){if(arguments.length===1){var e=arguments[0];if(e===null)throw new oo("Rule must be non-null");this._boundaryRule=e}}};Tc.prototype.locateInternal=function(){var e=this;if(arguments[0]instanceof dt&&arguments[1]instanceof us){var n=arguments[0],r=arguments[1];if(r.isEmpty())return Et.EXTERIOR;var i=r.getExteriorRing(),o=this.locateInPolygonRing(n,i);if(o===Et.EXTERIOR)return Et.EXTERIOR;if(o===Et.BOUNDARY)return Et.BOUNDARY;for(var a=0;a<r.getNumInteriorRing();a++){var s=r.getInteriorRingN(a),u=e.locateInPolygonRing(n,s);if(u===Et.INTERIOR)return Et.EXTERIOR;if(u===Et.BOUNDARY)return Et.BOUNDARY}return Et.INTERIOR}else if(arguments[0]instanceof dt&&arguments[1]instanceof bo){var d=arguments[0],g=arguments[1];if(!g.getEnvelopeInternal().intersects(d))return Et.EXTERIOR;var _=g.getCoordinates();return!g.isClosed()&&(d.equals(_[0])||d.equals(_[_.length-1]))?Et.BOUNDARY:Rn.isOnLine(d,_)?Et.INTERIOR:Et.EXTERIOR}else if(arguments[0]instanceof dt&&arguments[1]instanceof Il){var E=arguments[0],P=arguments[1],O=P.getCoordinate();return O.equals2D(E)?Et.INTERIOR:Et.EXTERIOR}};Tc.prototype.locateInPolygonRing=function(e,n){return n.getEnvelopeInternal().intersects(e)?Rn.locatePointInRing(e,n.getCoordinates()):Et.EXTERIOR};Tc.prototype.intersects=function(e,n){return this.locate(e,n)!==Et.EXTERIOR};Tc.prototype.updateLocationInfo=function(e){e===Et.INTERIOR&&(this._isIn=!0),e===Et.BOUNDARY&&this._numBoundaries++};Tc.prototype.computeLocation=function(e,n){var r=this;if(n instanceof Il&&this.updateLocationInfo(this.locateInternal(e,n)),n instanceof bo)this.updateLocationInfo(this.locateInternal(e,n));else if(n instanceof us)this.updateLocationInfo(this.locateInternal(e,n));else if(n instanceof tA)for(var i=n,o=0;o<i.getNumGeometries();o++){var a=i.getGeometryN(o);r.updateLocationInfo(r.locateInternal(e,a))}else if(n instanceof yh)for(var s=n,u=0;u<s.getNumGeometries();u++){var d=s.getGeometryN(u);r.updateLocationInfo(r.locateInternal(e,d))}else if(n instanceof Ra)for(var g=new vh(n);g.hasNext();){var _=g.next();_!==n&&r.computeLocation(e,_)}};Tc.prototype.locate=function(e,n){return n.isEmpty()?Et.EXTERIOR:n instanceof bo?this.locateInternal(e,n):n instanceof us?this.locateInternal(e,n):(this._isIn=!1,this._numBoundaries=0,this.computeLocation(e,n),this._boundaryRule.isInBoundary(this._numBoundaries)?Et.BOUNDARY:this._numBoundaries>0||this._isIn?Et.INTERIOR:Et.EXTERIOR)};Tc.prototype.interfaces_=function(){return[]};Tc.prototype.getClass=function(){return Tc};var Ta=function t(){if(this._component=null,this._segIndex=null,this._pt=null,arguments.length===2){var e=arguments[0],n=arguments[1];t.call(this,e,t.INSIDE_AREA,n)}else if(arguments.length===3){var r=arguments[0],i=arguments[1],o=arguments[2];this._component=r,this._segIndex=i,this._pt=o}},wie={INSIDE_AREA:{configurable:!0}};Ta.prototype.isInsideArea=function(){return this._segIndex===Ta.INSIDE_AREA};Ta.prototype.getCoordinate=function(){return this._pt};Ta.prototype.getGeometryComponent=function(){return this._component};Ta.prototype.getSegmentIndex=function(){return this._segIndex};Ta.prototype.interfaces_=function(){return[]};Ta.prototype.getClass=function(){return Ta};wie.INSIDE_AREA.get=function(){return-1};Object.defineProperties(Ta,wie);var Jp=function(e){this._pts=e||null};Jp.prototype.filter=function(e){e instanceof Il&&this._pts.add(e)};Jp.prototype.interfaces_=function(){return[Ef]};Jp.prototype.getClass=function(){return Jp};Jp.getPoints=function(){if(arguments.length===1){var e=arguments[0];return e instanceof Il?Ec.singletonList(e):Jp.getPoints(e,new bn)}else if(arguments.length===2){var n=arguments[0],r=arguments[1];return n instanceof Il?r.add(n):n instanceof Ra&&n.apply(new Jp(r)),r}};var Y0=function(){this._locations=null;var e=arguments[0];this._locations=e};Y0.prototype.filter=function(e){(e instanceof Il||e instanceof bo||e instanceof us)&&this._locations.add(new Ta(e,0,e.getCoordinate()))};Y0.prototype.interfaces_=function(){return[Ef]};Y0.prototype.getClass=function(){return Y0};Y0.getLocations=function(e){var n=new bn;return e.apply(new Y0(n)),n};var Xs=function(){if(this._geom=null,this._terminateDistance=0,this._ptLocator=new Tc,this._minDistanceLocation=null,this._minDistance=mr.MAX_VALUE,arguments.length===2){var e=arguments[0],n=arguments[1];this._geom=[e,n],this._terminateDistance=0}else if(arguments.length===3){var r=arguments[0],i=arguments[1],o=arguments[2];this._geom=new Array(2).fill(null),this._geom[0]=r,this._geom[1]=i,this._terminateDistance=o}};Xs.prototype.computeContainmentDistance=function(){var e=this;if(arguments.length===0){var n=new Array(2).fill(null);if(this.computeContainmentDistance(0,n),this._minDistance<=this._terminateDistance)return null;this.computeContainmentDistance(1,n)}else if(arguments.length===2){var r=arguments[0],i=arguments[1],o=1-r,a=zd.getPolygons(this._geom[r]);if(a.size()>0){var s=Y0.getLocations(this._geom[o]);if(this.computeContainmentDistance(s,a,i),this._minDistance<=this._terminateDistance)return this._minDistanceLocation[o]=i[0],this._minDistanceLocation[r]=i[1],null}}else if(arguments.length===3){if(arguments[2]instanceof Array&&ar(arguments[0],Ac)&&ar(arguments[1],Ac)){for(var u=arguments[0],d=arguments[1],g=arguments[2],_=0;_<u.size();_++)for(var E=u.get(_),P=0;P<d.size();P++)if(e.computeContainmentDistance(E,d.get(P),g),e._minDistance<=e._terminateDistance)return null}else if(arguments[2]instanceof Array&&arguments[0]instanceof Ta&&arguments[1]instanceof us){var O=arguments[0],D=arguments[1],V=arguments[2],k=O.getCoordinate();if(Et.EXTERIOR!==this._ptLocator.locate(k,D))return this._minDistance=0,V[0]=O,V[1]=new Ta(D,k),null}}};Xs.prototype.computeMinDistanceLinesPoints=function(e,n,r){for(var i=this,o=0;o<e.size();o++)for(var a=e.get(o),s=0;s<n.size();s++){var u=n.get(s);if(i.computeMinDistance(a,u,r),i._minDistance<=i._terminateDistance)return null}};Xs.prototype.computeFacetDistance=function(){var e=new Array(2).fill(null),n=Gs.getLines(this._geom[0]),r=Gs.getLines(this._geom[1]),i=Jp.getPoints(this._geom[0]),o=Jp.getPoints(this._geom[1]);if(this.computeMinDistanceLines(n,r,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance||(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(n,o,e),this.updateMinDistance(e,!1),this._minDistance<=this._terminateDistance)||(e[0]=null,e[1]=null,this.computeMinDistanceLinesPoints(r,i,e),this.updateMinDistance(e,!0),this._minDistance<=this._terminateDistance))return null;e[0]=null,e[1]=null,this.computeMinDistancePoints(i,o,e),this.updateMinDistance(e,!1)};Xs.prototype.nearestLocations=function(){return this.computeMinDistance(),this._minDistanceLocation};Xs.prototype.updateMinDistance=function(e,n){if(e[0]===null)return null;n?(this._minDistanceLocation[0]=e[1],this._minDistanceLocation[1]=e[0]):(this._minDistanceLocation[0]=e[0],this._minDistanceLocation[1]=e[1])};Xs.prototype.nearestPoints=function(){this.computeMinDistance();var e=[this._minDistanceLocation[0].getCoordinate(),this._minDistanceLocation[1].getCoordinate()];return e};Xs.prototype.computeMinDistance=function(){var e=this;if(arguments.length===0){if(this._minDistanceLocation!==null||(this._minDistanceLocation=new Array(2).fill(null),this.computeContainmentDistance(),this._minDistance<=this._terminateDistance))return null;this.computeFacetDistance()}else if(arguments.length===3){if(arguments[2]instanceof Array&&arguments[0]instanceof bo&&arguments[1]instanceof Il){var n=arguments[0],r=arguments[1],i=arguments[2];if(n.getEnvelopeInternal().distance(r.getEnvelopeInternal())>this._minDistance)return null;for(var o=n.getCoordinates(),a=r.getCoordinate(),s=0;s<o.length-1;s++){var u=Rn.distancePointLine(a,o[s],o[s+1]);if(u<e._minDistance){e._minDistance=u;var d=new Jn(o[s],o[s+1]),g=d.closestPoint(a);i[0]=new Ta(n,s,g),i[1]=new Ta(r,0,a)}if(e._minDistance<=e._terminateDistance)return null}}else if(arguments[2]instanceof Array&&arguments[0]instanceof bo&&arguments[1]instanceof bo){var _=arguments[0],E=arguments[1],P=arguments[2];if(_.getEnvelopeInternal().distance(E.getEnvelopeInternal())>this._minDistance)return null;for(var O=_.getCoordinates(),D=E.getCoordinates(),V=0;V<O.length-1;V++)for(var k=0;k<D.length-1;k++){var F=Rn.distanceLineLine(O[V],O[V+1],D[k],D[k+1]);if(F<e._minDistance){e._minDistance=F;var z=new Jn(O[V],O[V+1]),X=new Jn(D[k],D[k+1]),Y=z.closestPoints(X);P[0]=new Ta(_,V,Y[0]),P[1]=new Ta(E,k,Y[1])}if(e._minDistance<=e._terminateDistance)return null}}}};Xs.prototype.computeMinDistancePoints=function(e,n,r){for(var i=this,o=0;o<e.size();o++)for(var a=e.get(o),s=0;s<n.size();s++){var u=n.get(s),d=a.getCoordinate().distance(u.getCoordinate());if(d<i._minDistance&&(i._minDistance=d,r[0]=new Ta(a,0,a.getCoordinate()),r[1]=new Ta(u,0,u.getCoordinate())),i._minDistance<=i._terminateDistance)return null}};Xs.prototype.distance=function(){if(this._geom[0]===null||this._geom[1]===null)throw new oo("null geometries are not supported");return this._geom[0].isEmpty()||this._geom[1].isEmpty()?0:(this.computeMinDistance(),this._minDistance)};Xs.prototype.computeMinDistanceLines=function(e,n,r){for(var i=this,o=0;o<e.size();o++)for(var a=e.get(o),s=0;s<n.size();s++){var u=n.get(s);if(i.computeMinDistance(a,u,r),i._minDistance<=i._terminateDistance)return null}};Xs.prototype.interfaces_=function(){return[]};Xs.prototype.getClass=function(){return Xs};Xs.distance=function(e,n){var r=new Xs(e,n);return r.distance()};Xs.isWithinDistance=function(e,n,r){var i=new Xs(e,n,r);return i.distance()<=r};Xs.nearestPoints=function(e,n){var r=new Xs(e,n);return r.nearestPoints()};var sa=function(){this._pt=[new dt,new dt],this._distance=mr.NaN,this._isNull=!0};sa.prototype.getCoordinates=function(){return this._pt};sa.prototype.getCoordinate=function(e){return this._pt[e]};sa.prototype.setMinimum=function(){if(arguments.length===1){var e=arguments[0];this.setMinimum(e._pt[0],e._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var i=n.distance(r);i<this._distance&&this.initialize(n,r,i)}};sa.prototype.initialize=function(){if(arguments.length===0)this._isNull=!0;else if(arguments.length===2){var e=arguments[0],n=arguments[1];this._pt[0].setCoordinate(e),this._pt[1].setCoordinate(n),this._distance=e.distance(n),this._isNull=!1}else if(arguments.length===3){var r=arguments[0],i=arguments[1],o=arguments[2];this._pt[0].setCoordinate(r),this._pt[1].setCoordinate(i),this._distance=o,this._isNull=!1}};sa.prototype.toString=function(){return xc.toLineString(this._pt[0],this._pt[1])};sa.prototype.getDistance=function(){return this._distance};sa.prototype.setMaximum=function(){if(arguments.length===1){var e=arguments[0];this.setMaximum(e._pt[0],e._pt[1])}else if(arguments.length===2){var n=arguments[0],r=arguments[1];if(this._isNull)return this.initialize(n,r),null;var i=n.distance(r);i>this._distance&&this.initialize(n,r,i)}};sa.prototype.interfaces_=function(){return[]};sa.prototype.getClass=function(){return sa};var uf=function(){};uf.prototype.interfaces_=function(){return[]};uf.prototype.getClass=function(){return uf};uf.computeDistance=function(){if(arguments[2]instanceof sa&&arguments[0]instanceof bo&&arguments[1]instanceof dt)for(var e=arguments[0],n=arguments[1],r=arguments[2],i=new Jn,o=e.getCoordinates(),a=0;a<o.length-1;a++){i.setCoordinates(o[a],o[a+1]);var s=i.closestPoint(n);r.setMinimum(s,n)}else if(arguments[2]instanceof sa&&arguments[0]instanceof us&&arguments[1]instanceof dt){var u=arguments[0],d=arguments[1],g=arguments[2];uf.computeDistance(u.getExteriorRing(),d,g);for(var _=0;_<u.getNumInteriorRing();_++)uf.computeDistance(u.getInteriorRingN(_),d,g)}else if(arguments[2]instanceof sa&&arguments[0]instanceof ir&&arguments[1]instanceof dt){var E=arguments[0],P=arguments[1],O=arguments[2];if(E instanceof bo)uf.computeDistance(E,P,O);else if(E instanceof us)uf.computeDistance(E,P,O);else if(E instanceof Ra)for(var D=E,V=0;V<D.getNumGeometries();V++){var k=D.getGeometryN(V);uf.computeDistance(k,P,O)}else O.setMinimum(E.getCoordinate(),P)}else if(arguments[2]instanceof sa&&arguments[0]instanceof Jn&&arguments[1]instanceof dt){var F=arguments[0],z=arguments[1],X=arguments[2],Y=F.closestPoint(z);X.setMinimum(Y,z)}};var Lu=function(){this._g0=null,this._g1=null,this._ptDist=new sa,this._densifyFrac=0;var e=arguments[0],n=arguments[1];this._g0=e,this._g1=n},B6={MaxPointDistanceFilter:{configurable:!0},MaxDensifiedByFractionDistanceFilter:{configurable:!0}};Lu.prototype.getCoordinates=function(){return this._ptDist.getCoordinates()};Lu.prototype.setDensifyFraction=function(e){if(e>1||e<=0)throw new oo("Fraction is not in range (0.0 - 1.0]");this._densifyFrac=e};Lu.prototype.compute=function(e,n){this.computeOrientedDistance(e,n,this._ptDist),this.computeOrientedDistance(n,e,this._ptDist)};Lu.prototype.distance=function(){return this.compute(this._g0,this._g1),this._ptDist.getDistance()};Lu.prototype.computeOrientedDistance=function(e,n,r){var i=new Q0(n);if(e.apply(i),r.setMaximum(i.getMaxPointDistance()),this._densifyFrac>0){var o=new mg(n,this._densifyFrac);e.apply(o),r.setMaximum(o.getMaxPointDistance())}};Lu.prototype.orientedDistance=function(){return this.computeOrientedDistance(this._g0,this._g1,this._ptDist),this._ptDist.getDistance()};Lu.prototype.interfaces_=function(){return[]};Lu.prototype.getClass=function(){return Lu};Lu.distance=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1],r=new Lu(e,n);return r.distance()}else if(arguments.length===3){var i=arguments[0],o=arguments[1],a=arguments[2],s=new Lu(i,o);return s.setDensifyFraction(a),s.distance()}};B6.MaxPointDistanceFilter.get=function(){return Q0};B6.MaxDensifiedByFractionDistanceFilter.get=function(){return mg};Object.defineProperties(Lu,B6);var Q0=function(){this._maxPtDist=new sa,this._minPtDist=new sa,this._euclideanDist=new uf,this._geom=null;var e=arguments[0];this._geom=e};Q0.prototype.filter=function(e){this._minPtDist.initialize(),uf.computeDistance(this._geom,e,this._minPtDist),this._maxPtDist.setMaximum(this._minPtDist)};Q0.prototype.getMaxPointDistance=function(){return this._maxPtDist};Q0.prototype.interfaces_=function(){return[Ch]};Q0.prototype.getClass=function(){return Q0};var mg=function(){this._maxPtDist=new sa,this._minPtDist=new sa,this._geom=null,this._numSubSegs=0;var e=arguments[0],n=arguments[1];this._geom=e,this._numSubSegs=Math.trunc(Math.round(1/n))};mg.prototype.filter=function(e,n){var r=this;if(n===0)return null;for(var i=e.getCoordinate(n-1),o=e.getCoordinate(n),a=(o.x-i.x)/this._numSubSegs,s=(o.y-i.y)/this._numSubSegs,u=0;u<this._numSubSegs;u++){var d=i.x+u*a,g=i.y+u*s,_=new dt(d,g);r._minPtDist.initialize(),uf.computeDistance(r._geom,_,r._minPtDist),r._maxPtDist.setMaximum(r._minPtDist)}};mg.prototype.isDone=function(){return!1};mg.prototype.isGeometryChanged=function(){return!1};mg.prototype.getMaxPointDistance=function(){return this._maxPtDist};mg.prototype.interfaces_=function(){return[bc]};mg.prototype.getClass=function(){return mg};var Tl=function(e,n,r){this._minValidDistance=null,this._maxValidDistance=null,this._minDistanceFound=null,this._maxDistanceFound=null,this._isValid=!0,this._errMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._bufDistance=n||null,this._result=r||null},N6={VERBOSE:{configurable:!0},MAX_DISTANCE_DIFF_FRAC:{configurable:!0}};Tl.prototype.checkMaximumDistance=function(e,n,r){var i=new Lu(n,e);if(i.setDensifyFraction(.25),this._maxDistanceFound=i.orientedDistance(),this._maxDistanceFound>r){this._isValid=!1;var o=i.getCoordinates();this._errorLocation=o[1],this._errorIndicator=e.getFactory().createLineString(o),this._errMsg="Distance between buffer curve and input is too large ("+this._maxDistanceFound+" at "+xc.toLineString(o[0],o[1])+")"}};Tl.prototype.isValid=function(){var e=Math.abs(this._bufDistance),n=Tl.MAX_DISTANCE_DIFF_FRAC*e;return this._minValidDistance=e-n,this._maxValidDistance=e+n,this._input.isEmpty()||this._result.isEmpty()?!0:(this._bufDistance>0?this.checkPositiveValid():this.checkNegativeValid(),Tl.VERBOSE&&qs.out.println("Min Dist= "+this._minDistanceFound+"  err= "+(1-this._minDistanceFound/this._bufDistance)+"  Max Dist= "+this._maxDistanceFound+"  err= "+(this._maxDistanceFound/this._bufDistance-1)),this._isValid)};Tl.prototype.checkNegativeValid=function(){if(!(this._input instanceof us||this._input instanceof yh||this._input instanceof Ra))return null;var e=this.getPolygonLines(this._input);if(this.checkMinimumDistance(e,this._result,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(e,this._result,this._maxValidDistance)};Tl.prototype.getErrorIndicator=function(){return this._errorIndicator};Tl.prototype.checkMinimumDistance=function(e,n,r){var i=new Xs(e,n,r);if(this._minDistanceFound=i.distance(),this._minDistanceFound<r){this._isValid=!1;var o=i.nearestPoints();this._errorLocation=i.nearestPoints()[1],this._errorIndicator=e.getFactory().createLineString(o),this._errMsg="Distance between buffer curve and input is too small ("+this._minDistanceFound+" at "+xc.toLineString(o[0],o[1])+" )"}};Tl.prototype.checkPositiveValid=function(){var e=this._result.getBoundary();if(this.checkMinimumDistance(this._input,e,this._minValidDistance),!this._isValid)return null;this.checkMaximumDistance(this._input,e,this._maxValidDistance)};Tl.prototype.getErrorLocation=function(){return this._errorLocation};Tl.prototype.getPolygonLines=function(e){for(var n=new bn,r=new Gs(n),i=zd.getPolygons(e),o=i.iterator();o.hasNext();){var a=o.next();a.apply(r)}return e.getFactory().buildGeometry(n)};Tl.prototype.getErrorMessage=function(){return this._errMsg};Tl.prototype.interfaces_=function(){return[]};Tl.prototype.getClass=function(){return Tl};N6.VERBOSE.get=function(){return!1};N6.MAX_DISTANCE_DIFF_FRAC.get=function(){return .012};Object.defineProperties(Tl,N6);var Zs=function(e,n,r){this._isValid=!0,this._errorMsg=null,this._errorLocation=null,this._errorIndicator=null,this._input=e||null,this._distance=n||null,this._result=r||null},F6={VERBOSE:{configurable:!0},MAX_ENV_DIFF_FRAC:{configurable:!0}};Zs.prototype.isValid=function(){return this.checkPolygonal(),this._isValid?(this.checkExpectedEmpty(),this._isValid?(this.checkEnvelope(),this._isValid?(this.checkArea(),this._isValid?(this.checkDistance(),this._isValid):this._isValid):this._isValid):this._isValid):this._isValid};Zs.prototype.checkEnvelope=function(){if(this._distance<0)return null;var e=this._distance*Zs.MAX_ENV_DIFF_FRAC;e===0&&(e=.001);var n=new Qn(this._input.getEnvelopeInternal());n.expandBy(this._distance);var r=new Qn(this._result.getEnvelopeInternal());r.expandBy(e),r.contains(n)||(this._isValid=!1,this._errorMsg="Buffer envelope is incorrect",this._errorIndicator=this._input.getFactory().toGeometry(r)),this.report("Envelope")};Zs.prototype.checkDistance=function(){var e=new Tl(this._input,this._distance,this._result);e.isValid()||(this._isValid=!1,this._errorMsg=e.getErrorMessage(),this._errorLocation=e.getErrorLocation(),this._errorIndicator=e.getErrorIndicator()),this.report("Distance")};Zs.prototype.checkArea=function(){var e=this._input.getArea(),n=this._result.getArea();this._distance>0&&e>n&&(this._isValid=!1,this._errorMsg="Area of positive buffer is smaller than input",this._errorIndicator=this._result),this._distance<0&&e<n&&(this._isValid=!1,this._errorMsg="Area of negative buffer is larger than input",this._errorIndicator=this._result),this.report("Area")};Zs.prototype.checkPolygonal=function(){this._result instanceof us||this._result instanceof yh||(this._isValid=!1),this._errorMsg="Result is not polygonal",this._errorIndicator=this._result,this.report("Polygonal")};Zs.prototype.getErrorIndicator=function(){return this._errorIndicator};Zs.prototype.getErrorLocation=function(){return this._errorLocation};Zs.prototype.checkExpectedEmpty=function(){if(this._input.getDimension()>=2||this._distance>0)return null;this._result.isEmpty()||(this._isValid=!1,this._errorMsg="Result is non-empty",this._errorIndicator=this._result),this.report("ExpectedEmpty")};Zs.prototype.report=function(e){if(!Zs.VERBOSE)return null;qs.out.println("Check "+e+": "+(this._isValid?"passed":"FAILED"))};Zs.prototype.getErrorMessage=function(){return this._errorMsg};Zs.prototype.interfaces_=function(){return[]};Zs.prototype.getClass=function(){return Zs};Zs.isValidMsg=function(e,n,r){var i=new Zs(e,n,r);return i.isValid()?null:i.getErrorMessage()};Zs.isValid=function(e,n,r){var i=new Zs(e,n,r);return!!i.isValid()};F6.VERBOSE.get=function(){return!1};F6.MAX_ENV_DIFF_FRAC.get=function(){return .012};Object.defineProperties(Zs,F6);var Mf=function(){this._pts=null,this._data=null;var e=arguments[0],n=arguments[1];this._pts=e,this._data=n};Mf.prototype.getCoordinates=function(){return this._pts};Mf.prototype.size=function(){return this._pts.length};Mf.prototype.getCoordinate=function(e){return this._pts[e]};Mf.prototype.isClosed=function(){return this._pts[0].equals(this._pts[this._pts.length-1])};Mf.prototype.getSegmentOctant=function(e){return e===this._pts.length-1?-1:W0.octant(this.getCoordinate(e),this.getCoordinate(e+1))};Mf.prototype.setData=function(e){this._data=e};Mf.prototype.getData=function(){return this._data};Mf.prototype.toString=function(){return xc.toLineString(new Mo(this._pts))};Mf.prototype.interfaces_=function(){return[Mh]};Mf.prototype.getClass=function(){return Mf};var Is=function(){this._findAllIntersections=!1,this._isCheckEndSegmentsOnly=!1,this._li=null,this._interiorIntersection=null,this._intSegments=null,this._intersections=new bn,this._intersectionCount=0,this._keepIntersections=!0;var e=arguments[0];this._li=e,this._interiorIntersection=null};Is.prototype.getInteriorIntersection=function(){return this._interiorIntersection};Is.prototype.setCheckEndSegmentsOnly=function(e){this._isCheckEndSegmentsOnly=e};Is.prototype.getIntersectionSegments=function(){return this._intSegments};Is.prototype.count=function(){return this._intersectionCount};Is.prototype.getIntersections=function(){return this._intersections};Is.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e};Is.prototype.setKeepIntersections=function(e){this._keepIntersections=e};Is.prototype.processIntersections=function(e,n,r,i){if(!this._findAllIntersections&&this.hasIntersection()||e===r&&n===i)return null;if(this._isCheckEndSegmentsOnly){var o=this.isEndSegment(e,n)||this.isEndSegment(r,i);if(!o)return null}var a=e.getCoordinates()[n],s=e.getCoordinates()[n+1],u=r.getCoordinates()[i],d=r.getCoordinates()[i+1];this._li.computeIntersection(a,s,u,d),this._li.hasIntersection()&&this._li.isInteriorIntersection()&&(this._intSegments=new Array(4).fill(null),this._intSegments[0]=a,this._intSegments[1]=s,this._intSegments[2]=u,this._intSegments[3]=d,this._interiorIntersection=this._li.getIntersection(0),this._keepIntersections&&this._intersections.add(this._interiorIntersection),this._intersectionCount++)};Is.prototype.isEndSegment=function(e,n){return n===0||n>=e.size()-2};Is.prototype.hasIntersection=function(){return this._interiorIntersection!==null};Is.prototype.isDone=function(){return this._findAllIntersections?!1:this._interiorIntersection!==null};Is.prototype.interfaces_=function(){return[iA]};Is.prototype.getClass=function(){return Is};Is.createAllIntersectionsFinder=function(e){var n=new Is(e);return n.setFindAllIntersections(!0),n};Is.createAnyIntersectionFinder=function(e){return new Is(e)};Is.createIntersectionCounter=function(e){var n=new Is(e);return n.setFindAllIntersections(!0),n.setKeepIntersections(!1),n};var Cc=function(){this._li=new bA,this._segStrings=null,this._findAllIntersections=!1,this._segInt=null,this._isValid=!0;var e=arguments[0];this._segStrings=e};Cc.prototype.execute=function(){if(this._segInt!==null)return null;this.checkInteriorIntersections()};Cc.prototype.getIntersections=function(){return this._segInt.getIntersections()};Cc.prototype.isValid=function(){return this.execute(),this._isValid};Cc.prototype.setFindAllIntersections=function(e){this._findAllIntersections=e};Cc.prototype.checkInteriorIntersections=function(){this._isValid=!0,this._segInt=new Is(this._li),this._segInt.setFindAllIntersections(this._findAllIntersections);var e=new L6;if(e.setSegmentIntersector(this._segInt),e.computeNodes(this._segStrings),this._segInt.hasIntersection())return this._isValid=!1,null};Cc.prototype.checkValid=function(){if(this.execute(),!this._isValid)throw new Wd(this.getErrorMessage(),this._segInt.getInteriorIntersection())};Cc.prototype.getErrorMessage=function(){if(this._isValid)return"no intersections found";var e=this._segInt.getIntersectionSegments();return"found non-noded intersection between "+xc.toLineString(e[0],e[1])+" and "+xc.toLineString(e[2],e[3])};Cc.prototype.interfaces_=function(){return[]};Cc.prototype.getClass=function(){return Cc};Cc.computeIntersections=function(e){var n=new Cc(e);return n.setFindAllIntersections(!0),n.isValid(),n.getIntersections()};var aA=function t(){this._nv=null;var e=arguments[0];this._nv=new Cc(t.toSegmentStrings(e))};aA.prototype.checkValid=function(){this._nv.checkValid()};aA.prototype.interfaces_=function(){return[]};aA.prototype.getClass=function(){return aA};aA.toSegmentStrings=function(e){for(var n=new bn,r=e.iterator();r.hasNext();){var i=r.next();n.add(new Mf(i.getCoordinates(),i))}return n};aA.checkValid=function(e){var n=new aA(e);n.checkValid()};var K0=function(e){this._mapOp=e};K0.prototype.map=function(e){for(var n=this,r=new bn,i=0;i<e.getNumGeometries();i++){var o=n._mapOp.map(e.getGeometryN(i));o.isEmpty()||r.add(o)}return e.getFactory().createGeometryCollection(kr.toGeometryArray(r))};K0.prototype.interfaces_=function(){return[]};K0.prototype.getClass=function(){return K0};K0.map=function(e,n){var r=new K0(n);return r.map(e)};var Of=function(){this._op=null,this._geometryFactory=null,this._ptLocator=null,this._lineEdgesList=new bn,this._resultLineList=new bn;var e=arguments[0],n=arguments[1],r=arguments[2];this._op=e,this._geometryFactory=n,this._ptLocator=r};Of.prototype.collectLines=function(e){for(var n=this,r=this._op.getGraph().getEdgeEnds().iterator();r.hasNext();){var i=r.next();n.collectLineEdge(i,e,n._lineEdgesList),n.collectBoundaryTouchEdge(i,e,n._lineEdgesList)}};Of.prototype.labelIsolatedLine=function(e,n){var r=this._ptLocator.locate(e.getCoordinate(),this._op.getArgGeometry(n));e.getLabel().setLocation(n,r)};Of.prototype.build=function(e){return this.findCoveredLineEdges(),this.collectLines(e),this.buildLines(e),this._resultLineList};Of.prototype.collectLineEdge=function(e,n,r){var i=e.getLabel(),o=e.getEdge();e.isLineEdge()&&!e.isVisited()&&Sr.isResultOfOp(i,n)&&!o.isCovered()&&(r.add(o),e.setVisitedEdge(!0))};Of.prototype.findCoveredLineEdges=function(){for(var e=this,n=this._op.getGraph().getNodes().iterator();n.hasNext();){var r=n.next();r.getEdges().findCoveredLineEdges()}for(var i=this._op.getGraph().getEdgeEnds().iterator();i.hasNext();){var o=i.next(),a=o.getEdge();if(o.isLineEdge()&&!a.isCoveredSet()){var s=e._op.isCoveredByA(o.getCoordinate());a.setCovered(s)}}};Of.prototype.labelIsolatedLines=function(e){for(var n=this,r=e.iterator();r.hasNext();){var i=r.next(),o=i.getLabel();i.isIsolated()&&(o.isNull(0)?n.labelIsolatedLine(i,0):n.labelIsolatedLine(i,1))}};Of.prototype.buildLines=function(e){for(var n=this,r=this._lineEdgesList.iterator();r.hasNext();){var i=r.next(),o=n._geometryFactory.createLineString(i.getCoordinates());n._resultLineList.add(o),i.setInResult(!0)}};Of.prototype.collectBoundaryTouchEdge=function(e,n,r){var i=e.getLabel();if(e.isLineEdge()||e.isVisited()||e.isInteriorAreaEdge()||e.getEdge().isInResult())return null;Pr.isTrue(!(e.isInResult()||e.getSym().isInResult())||!e.getEdge().isInResult()),Sr.isResultOfOp(i,n)&&n===Sr.INTERSECTION&&(r.add(e.getEdge()),e.setVisitedEdge(!0))};Of.prototype.interfaces_=function(){return[]};Of.prototype.getClass=function(){return Of};var J0=function(){this._op=null,this._geometryFactory=null,this._resultPointList=new bn;var e=arguments[0],n=arguments[1];this._op=e,this._geometryFactory=n};J0.prototype.filterCoveredNodeToPoint=function(e){var n=e.getCoordinate();if(!this._op.isCoveredByLA(n)){var r=this._geometryFactory.createPoint(n);this._resultPointList.add(r)}};J0.prototype.extractNonCoveredResultNodes=function(e){for(var n=this,r=this._op.getGraph().getNodes().iterator();r.hasNext();){var i=r.next();if(!i.isInResult()&&!i.isIncidentEdgeInResult()&&(i.getEdges().getDegree()===0||e===Sr.INTERSECTION)){var o=i.getLabel();Sr.isResultOfOp(o,e)&&n.filterCoveredNodeToPoint(i)}}};J0.prototype.build=function(e){return this.extractNonCoveredResultNodes(e),this._resultPointList};J0.prototype.interfaces_=function(){return[]};J0.prototype.getClass=function(){return J0};var tl=function(){this._inputGeom=null,this._factory=null,this._pruneEmptyGeometry=!0,this._preserveGeometryCollectionType=!0,this._preserveCollections=!1,this._preserveType=!1};tl.prototype.transformPoint=function(e,n){return this._factory.createPoint(this.transformCoordinates(e.getCoordinateSequence(),e))};tl.prototype.transformPolygon=function(e,n){var r=this,i=!0,o=this.transformLinearRing(e.getExteriorRing(),e);(o===null||!(o instanceof Ph)||o.isEmpty())&&(i=!1);for(var a=new bn,s=0;s<e.getNumInteriorRing();s++){var u=r.transformLinearRing(e.getInteriorRingN(s),e);u===null||u.isEmpty()||(u instanceof Ph||(i=!1),a.add(u))}if(i)return this._factory.createPolygon(o,a.toArray([]));var d=new bn;return o!==null&&d.add(o),d.addAll(a),this._factory.buildGeometry(d)};tl.prototype.createCoordinateSequence=function(e){return this._factory.getCoordinateSequenceFactory().create(e)};tl.prototype.getInputGeometry=function(){return this._inputGeom};tl.prototype.transformMultiLineString=function(e,n){for(var r=this,i=new bn,o=0;o<e.getNumGeometries();o++){var a=r.transformLineString(e.getGeometryN(o),e);a!==null&&(a.isEmpty()||i.add(a))}return this._factory.buildGeometry(i)};tl.prototype.transformCoordinates=function(e,n){return this.copy(e)};tl.prototype.transformLineString=function(e,n){return this._factory.createLineString(this.transformCoordinates(e.getCoordinateSequence(),e))};tl.prototype.transformMultiPoint=function(e,n){for(var r=this,i=new bn,o=0;o<e.getNumGeometries();o++){var a=r.transformPoint(e.getGeometryN(o),e);a!==null&&(a.isEmpty()||i.add(a))}return this._factory.buildGeometry(i)};tl.prototype.transformMultiPolygon=function(e,n){for(var r=this,i=new bn,o=0;o<e.getNumGeometries();o++){var a=r.transformPolygon(e.getGeometryN(o),e);a!==null&&(a.isEmpty()||i.add(a))}return this._factory.buildGeometry(i)};tl.prototype.copy=function(e){return e.copy()};tl.prototype.transformGeometryCollection=function(e,n){for(var r=this,i=new bn,o=0;o<e.getNumGeometries();o++){var a=r.transform(e.getGeometryN(o));a!==null&&(r._pruneEmptyGeometry&&a.isEmpty()||i.add(a))}return this._preserveGeometryCollectionType?this._factory.createGeometryCollection(kr.toGeometryArray(i)):this._factory.buildGeometry(i)};tl.prototype.transform=function(e){if(this._inputGeom=e,this._factory=e.getFactory(),e instanceof Il)return this.transformPoint(e,null);if(e instanceof e1)return this.transformMultiPoint(e,null);if(e instanceof Ph)return this.transformLinearRing(e,null);if(e instanceof bo)return this.transformLineString(e,null);if(e instanceof tA)return this.transformMultiLineString(e,null);if(e instanceof us)return this.transformPolygon(e,null);if(e instanceof yh)return this.transformMultiPolygon(e,null);if(e instanceof Ra)return this.transformGeometryCollection(e,null);throw new oo("Unknown Geometry subtype: "+e.getClass().getName())};tl.prototype.transformLinearRing=function(e,n){var r=this.transformCoordinates(e.getCoordinateSequence(),e);if(r===null)return this._factory.createLinearRing(null);var i=r.size();return i>0&&i<4&&!this._preserveType?this._factory.createLineString(r):this._factory.createLinearRing(r)};tl.prototype.interfaces_=function(){return[]};tl.prototype.getClass=function(){return tl};var Lh=function t(){if(this._snapTolerance=0,this._srcPts=null,this._seg=new Jn,this._allowSnappingToSourceVertices=!1,this._isClosed=!1,arguments[0]instanceof bo&&typeof arguments[1]=="number"){var e=arguments[0],n=arguments[1];t.call(this,e.getCoordinates(),n)}else if(arguments[0]instanceof Array&&typeof arguments[1]=="number"){var r=arguments[0],i=arguments[1];this._srcPts=r,this._isClosed=t.isClosed(r),this._snapTolerance=i}};Lh.prototype.snapVertices=function(e,n){for(var r=this,i=this._isClosed?e.size()-1:e.size(),o=0;o<i;o++){var a=e.get(o),s=r.findSnapForVertex(a,n);s!==null&&(e.set(o,new dt(s)),o===0&&r._isClosed&&e.set(e.size()-1,new dt(s)))}};Lh.prototype.findSnapForVertex=function(e,n){for(var r=this,i=0;i<n.length;i++){if(e.equals2D(n[i]))return null;if(e.distance(n[i])<r._snapTolerance)return n[i]}return null};Lh.prototype.snapTo=function(e){var n=new t2(this._srcPts);this.snapVertices(n,e),this.snapSegments(n,e);var r=n.toCoordinateArray();return r};Lh.prototype.snapSegments=function(e,n){var r=this;if(n.length===0)return null;var i=n.length;n[0].equals2D(n[n.length-1])&&(i=n.length-1);for(var o=0;o<i;o++){var a=n[o],s=r.findSegmentIndexToSnap(a,e);s>=0&&e.add(s+1,new dt(a),!1)}};Lh.prototype.findSegmentIndexToSnap=function(e,n){for(var r=this,i=mr.MAX_VALUE,o=-1,a=0;a<n.size()-1;a++){if(r._seg.p0=n.get(a),r._seg.p1=n.get(a+1),r._seg.p0.equals2D(e)||r._seg.p1.equals2D(e)){if(r._allowSnappingToSourceVertices)continue;return-1}var s=r._seg.distance(e);s<r._snapTolerance&&s<i&&(i=s,o=a)}return o};Lh.prototype.setAllowSnappingToSourceVertices=function(e){this._allowSnappingToSourceVertices=e};Lh.prototype.interfaces_=function(){return[]};Lh.prototype.getClass=function(){return Lh};Lh.isClosed=function(e){return e.length<=1?!1:e[0].equals2D(e[e.length-1])};var Oo=function(e){this._srcGeom=e||null},Eie={SNAP_PRECISION_FACTOR:{configurable:!0}};Oo.prototype.snapTo=function(e,n){var r=this.extractTargetCoordinates(e),i=new Sie(n,r);return i.transform(this._srcGeom)};Oo.prototype.snapToSelf=function(e,n){var r=this.extractTargetCoordinates(this._srcGeom),i=new Sie(e,r,!0),o=i.transform(this._srcGeom),a=o;return n&&ar(a,cg)&&(a=o.buffer(0)),a};Oo.prototype.computeSnapTolerance=function(e){var n=this.computeMinimumSegmentLength(e),r=n/10;return r};Oo.prototype.extractTargetCoordinates=function(e){for(var n=new wf,r=e.getCoordinates(),i=0;i<r.length;i++)n.add(r[i]);return n.toArray(new Array(0).fill(null))};Oo.prototype.computeMinimumSegmentLength=function(e){for(var n=mr.MAX_VALUE,r=0;r<e.length-1;r++){var i=e[r].distance(e[r+1]);i<n&&(n=i)}return n};Oo.prototype.interfaces_=function(){return[]};Oo.prototype.getClass=function(){return Oo};Oo.snap=function(e,n,r){var i=new Array(2).fill(null),o=new Oo(e);i[0]=o.snapTo(n,r);var a=new Oo(n);return i[1]=a.snapTo(i[0],r),i};Oo.computeOverlaySnapTolerance=function(){if(arguments.length===1){var e=arguments[0],n=Oo.computeSizeBasedSnapTolerance(e),r=e.getPrecisionModel();if(r.getType()===si.FIXED){var i=1/r.getScale()*2/1.415;i>n&&(n=i)}return n}else if(arguments.length===2){var o=arguments[0],a=arguments[1];return Math.min(Oo.computeOverlaySnapTolerance(o),Oo.computeOverlaySnapTolerance(a))}};Oo.computeSizeBasedSnapTolerance=function(e){var n=e.getEnvelopeInternal(),r=Math.min(n.getHeight(),n.getWidth()),i=r*Oo.SNAP_PRECISION_FACTOR;return i};Oo.snapToSelf=function(e,n,r){var i=new Oo(e);return i.snapToSelf(n,r)};Eie.SNAP_PRECISION_FACTOR.get=function(){return 1e-9};Object.defineProperties(Oo,Eie);var Sie=function(t){function e(n,r,i){t.call(this),this._snapTolerance=n||null,this._snapPts=r||null,this._isSelfSnap=i!==void 0?i:!1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.snapLine=function(r,i){var o=new Lh(r,this._snapTolerance);return o.setAllowSnappingToSourceVertices(this._isSelfSnap),o.snapTo(i)},e.prototype.transformCoordinates=function(r,i){var o=r.toCoordinateArray(),a=this.snapLine(o,this._snapPts);return this._factory.getCoordinateSequenceFactory().create(a)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(tl),ba=function(){this._isFirst=!0,this._commonMantissaBitsCount=53,this._commonBits=0,this._commonSignExp=null};ba.prototype.getCommon=function(){return mr.longBitsToDouble(this._commonBits)};ba.prototype.add=function(e){var n=mr.doubleToLongBits(e);if(this._isFirst)return this._commonBits=n,this._commonSignExp=ba.signExpBits(this._commonBits),this._isFirst=!1,null;var r=ba.signExpBits(n);if(r!==this._commonSignExp)return this._commonBits=0,null;this._commonMantissaBitsCount=ba.numCommonMostSigMantissaBits(this._commonBits,n),this._commonBits=ba.zeroLowerBits(this._commonBits,64-(12+this._commonMantissaBitsCount))};ba.prototype.toString=function(){if(arguments.length===1){var e=arguments[0],n=mr.longBitsToDouble(e),r=mr.toBinaryString(e),i="0000000000000000000000000000000000000000000000000000000000000000"+r,o=i.substring(i.length-64),a=o.substring(0,1)+"  "+o.substring(1,12)+"(exp) "+o.substring(12)+" [ "+n+" ]";return a}};ba.prototype.interfaces_=function(){return[]};ba.prototype.getClass=function(){return ba};ba.getBit=function(e,n){var r=1<<n;return e&r?1:0};ba.signExpBits=function(e){return e>>52};ba.zeroLowerBits=function(e,n){var r=(1<<n)-1,i=~r,o=e&i;return o};ba.numCommonMostSigMantissaBits=function(e,n){for(var r=0,i=52;i>=0;i--){if(ba.getBit(e,i)!==ba.getBit(n,i))return r;r++}return 52};var Ag=function(){this._commonCoord=null,this._ccFilter=new e_},k6={CommonCoordinateFilter:{configurable:!0},Translater:{configurable:!0}};Ag.prototype.addCommonBits=function(e){var n=new _g(this._commonCoord);e.apply(n),e.geometryChanged()};Ag.prototype.removeCommonBits=function(e){if(this._commonCoord.x===0&&this._commonCoord.y===0)return e;var n=new dt(this._commonCoord);n.x=-n.x,n.y=-n.y;var r=new _g(n);return e.apply(r),e.geometryChanged(),e};Ag.prototype.getCommonCoordinate=function(){return this._commonCoord};Ag.prototype.add=function(e){e.apply(this._ccFilter),this._commonCoord=this._ccFilter.getCommonCoordinate()};Ag.prototype.interfaces_=function(){return[]};Ag.prototype.getClass=function(){return Ag};k6.CommonCoordinateFilter.get=function(){return e_};k6.Translater.get=function(){return _g};Object.defineProperties(Ag,k6);var e_=function(){this._commonBitsX=new ba,this._commonBitsY=new ba};e_.prototype.filter=function(e){this._commonBitsX.add(e.x),this._commonBitsY.add(e.y)};e_.prototype.getCommonCoordinate=function(){return new dt(this._commonBitsX.getCommon(),this._commonBitsY.getCommon())};e_.prototype.interfaces_=function(){return[Ch]};e_.prototype.getClass=function(){return e_};var _g=function(){this.trans=null;var e=arguments[0];this.trans=e};_g.prototype.filter=function(e,n){var r=e.getOrdinate(n,0)+this.trans.x,i=e.getOrdinate(n,1)+this.trans.y;e.setOrdinate(n,0,r),e.setOrdinate(n,1,i)};_g.prototype.isDone=function(){return!1};_g.prototype.isGeometryChanged=function(){return!0};_g.prototype.interfaces_=function(){return[bc]};_g.prototype.getClass=function(){return _g};var Ms=function(e,n){this._geom=new Array(2).fill(null),this._snapTolerance=null,this._cbr=null,this._geom[0]=e,this._geom[1]=n,this.computeSnapTolerance()};Ms.prototype.selfSnap=function(e){var n=new Oo(e),r=n.snapTo(e,this._snapTolerance);return r};Ms.prototype.removeCommonBits=function(e){this._cbr=new Ag,this._cbr.add(e[0]),this._cbr.add(e[1]);var n=new Array(2).fill(null);return n[0]=this._cbr.removeCommonBits(e[0].copy()),n[1]=this._cbr.removeCommonBits(e[1].copy()),n};Ms.prototype.prepareResult=function(e){return this._cbr.addCommonBits(e),e};Ms.prototype.getResultGeometry=function(e){var n=this.snap(this._geom),r=Sr.overlayOp(n[0],n[1],e);return this.prepareResult(r)};Ms.prototype.checkValid=function(e){e.isValid()||qs.out.println("Snapped geometry is invalid")};Ms.prototype.computeSnapTolerance=function(){this._snapTolerance=Oo.computeOverlaySnapTolerance(this._geom[0],this._geom[1])};Ms.prototype.snap=function(e){var n=this.removeCommonBits(e),r=Oo.snap(n[0],n[1],this._snapTolerance);return r};Ms.prototype.interfaces_=function(){return[]};Ms.prototype.getClass=function(){return Ms};Ms.overlayOp=function(e,n,r){var i=new Ms(e,n);return i.getResultGeometry(r)};Ms.union=function(e,n){return Ms.overlayOp(e,n,Sr.UNION)};Ms.intersection=function(e,n){return Ms.overlayOp(e,n,Sr.INTERSECTION)};Ms.symDifference=function(e,n){return Ms.overlayOp(e,n,Sr.SYMDIFFERENCE)};Ms.difference=function(e,n){return Ms.overlayOp(e,n,Sr.DIFFERENCE)};var Ba=function(e,n){this._geom=new Array(2).fill(null),this._geom[0]=e,this._geom[1]=n};Ba.prototype.getResultGeometry=function(e){var n=null,r=!1,i=null;try{n=Sr.overlayOp(this._geom[0],this._geom[1],e);var o=!0;o&&(r=!0)}catch(a){if(a instanceof $d)i=a;else throw a}finally{}if(!r)try{n=Ms.overlayOp(this._geom[0],this._geom[1],e)}catch(a){throw a instanceof $d?i:a}finally{}return n};Ba.prototype.interfaces_=function(){return[]};Ba.prototype.getClass=function(){return Ba};Ba.overlayOp=function(e,n,r){var i=new Ba(e,n);return i.getResultGeometry(r)};Ba.union=function(e,n){return Ba.overlayOp(e,n,Sr.UNION)};Ba.intersection=function(e,n){return Ba.overlayOp(e,n,Sr.INTERSECTION)};Ba.symDifference=function(e,n){return Ba.overlayOp(e,n,Sr.SYMDIFFERENCE)};Ba.difference=function(e,n){return Ba.overlayOp(e,n,Sr.DIFFERENCE)};var oE=function(){this.mce=null,this.chainIndex=null;var e=arguments[0],n=arguments[1];this.mce=e,this.chainIndex=n};oE.prototype.computeIntersections=function(e,n){this.mce.computeIntersectsForChain(this.chainIndex,e.mce,e.chainIndex,n)};oE.prototype.interfaces_=function(){return[]};oE.prototype.getClass=function(){return oE};var Rl=function t(){if(this._label=null,this._xValue=null,this._eventType=null,this._insertEvent=null,this._deleteEventIndex=null,this._obj=null,arguments.length===2){var e=arguments[0],n=arguments[1];this._eventType=t.DELETE,this._xValue=e,this._insertEvent=n}else if(arguments.length===3){var r=arguments[0],i=arguments[1],o=arguments[2];this._eventType=t.INSERT,this._label=r,this._xValue=i,this._obj=o}},z6={INSERT:{configurable:!0},DELETE:{configurable:!0}};Rl.prototype.isDelete=function(){return this._eventType===Rl.DELETE};Rl.prototype.setDeleteEventIndex=function(e){this._deleteEventIndex=e};Rl.prototype.getObject=function(){return this._obj};Rl.prototype.compareTo=function(e){var n=e;return this._xValue<n._xValue?-1:this._xValue>n._xValue?1:this._eventType<n._eventType?-1:this._eventType>n._eventType?1:0};Rl.prototype.getInsertEvent=function(){return this._insertEvent};Rl.prototype.isInsert=function(){return this._eventType===Rl.INSERT};Rl.prototype.isSameLabel=function(e){return this._label===null?!1:this._label===e._label};Rl.prototype.getDeleteEventIndex=function(){return this._deleteEventIndex};Rl.prototype.interfaces_=function(){return[Uu]};Rl.prototype.getClass=function(){return Rl};z6.INSERT.get=function(){return 1};z6.DELETE.get=function(){return 2};Object.defineProperties(Rl,z6);var OI=function(){};OI.prototype.interfaces_=function(){return[]};OI.prototype.getClass=function(){return OI};var Ys=function(){this._hasIntersection=!1,this._hasProper=!1,this._hasProperInterior=!1,this._properIntersectionPoint=null,this._li=null,this._includeProper=null,this._recordIsolated=null,this._isSelfIntersection=null,this._numIntersections=0,this.numTests=0,this._bdyNodes=null,this._isDone=!1,this._isDoneWhenProperInt=!1;var e=arguments[0],n=arguments[1],r=arguments[2];this._li=e,this._includeProper=n,this._recordIsolated=r};Ys.prototype.isTrivialIntersection=function(e,n,r,i){if(e===r&&this._li.getIntersectionNum()===1){if(Ys.isAdjacentSegments(n,i))return!0;if(e.isClosed()){var o=e.getNumPoints()-1;if(n===0&&i===o||i===0&&n===o)return!0}}return!1};Ys.prototype.getProperIntersectionPoint=function(){return this._properIntersectionPoint};Ys.prototype.setIsDoneIfProperInt=function(e){this._isDoneWhenProperInt=e};Ys.prototype.hasProperInteriorIntersection=function(){return this._hasProperInterior};Ys.prototype.isBoundaryPointInternal=function(e,n){for(var r=n.iterator();r.hasNext();){var i=r.next(),o=i.getCoordinate();if(e.isIntersection(o))return!0}return!1};Ys.prototype.hasProperIntersection=function(){return this._hasProper};Ys.prototype.hasIntersection=function(){return this._hasIntersection};Ys.prototype.isDone=function(){return this._isDone};Ys.prototype.isBoundaryPoint=function(e,n){return n===null?!1:!!(this.isBoundaryPointInternal(e,n[0])||this.isBoundaryPointInternal(e,n[1]))};Ys.prototype.setBoundaryNodes=function(e,n){this._bdyNodes=new Array(2).fill(null),this._bdyNodes[0]=e,this._bdyNodes[1]=n};Ys.prototype.addIntersections=function(e,n,r,i){if(e===r&&n===i)return null;this.numTests++;var o=e.getCoordinates()[n],a=e.getCoordinates()[n+1],s=r.getCoordinates()[i],u=r.getCoordinates()[i+1];this._li.computeIntersection(o,a,s,u),this._li.hasIntersection()&&(this._recordIsolated&&(e.setIsolated(!1),r.setIsolated(!1)),this._numIntersections++,this.isTrivialIntersection(e,n,r,i)||(this._hasIntersection=!0,(this._includeProper||!this._li.isProper())&&(e.addIntersections(this._li,n,0),r.addIntersections(this._li,i,1)),this._li.isProper()&&(this._properIntersectionPoint=this._li.getIntersection(0).copy(),this._hasProper=!0,this._isDoneWhenProperInt&&(this._isDone=!0),this.isBoundaryPoint(this._li,this._bdyNodes)||(this._hasProperInterior=!0))))};Ys.prototype.interfaces_=function(){return[]};Ys.prototype.getClass=function(){return Ys};Ys.isAdjacentSegments=function(e,n){return Math.abs(e-n)===1};var ZRe=function(t){function e(){t.call(this),this.events=new bn,this.nOverlaps=null}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.prepareEvents=function(){var r=this;Ec.sort(this.events);for(var i=0;i<this.events.size();i++){var o=r.events.get(i);o.isDelete()&&o.getInsertEvent().setDeleteEventIndex(i)}},e.prototype.computeIntersections=function(){var r=this;if(arguments.length===1){var i=arguments[0];this.nOverlaps=0,this.prepareEvents();for(var o=0;o<this.events.size();o++){var a=r.events.get(o);if(a.isInsert()&&r.processOverlaps(o,a.getDeleteEventIndex(),a,i),i.isDone())break}}else if(arguments.length===3){if(arguments[2]instanceof Ys&&ar(arguments[0],Ac)&&ar(arguments[1],Ac)){var s=arguments[0],u=arguments[1],d=arguments[2];this.addEdges(s,s),this.addEdges(u,u),this.computeIntersections(d)}else if(typeof arguments[2]=="boolean"&&ar(arguments[0],Ac)&&arguments[1]instanceof Ys){var g=arguments[0],_=arguments[1],E=arguments[2];E?this.addEdges(g,null):this.addEdges(g),this.computeIntersections(_)}}},e.prototype.addEdge=function(r,i){for(var o=this,a=r.getMonotoneChainEdge(),s=a.getStartIndexes(),u=0;u<s.length-1;u++){var d=new oE(a,u),g=new Rl(i,a.getMinX(u),d);o.events.add(g),o.events.add(new Rl(a.getMaxX(u),g))}},e.prototype.processOverlaps=function(r,i,o,a){for(var s=this,u=o.getObject(),d=r;d<i;d++){var g=s.events.get(d);if(g.isInsert()){var _=g.getObject();o.isSameLabel(g)||(u.computeIntersections(_,a),s.nOverlaps++)}}},e.prototype.addEdges=function(){var r=this;if(arguments.length===1)for(var i=arguments[0],o=i.iterator();o.hasNext();){var a=o.next();r.addEdge(a,a)}else if(arguments.length===2)for(var s=arguments[0],u=arguments[1],d=s.iterator();d.hasNext();){var g=d.next();r.addEdge(g,u)}},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(OI),Dh=function(){this._min=mr.POSITIVE_INFINITY,this._max=mr.NEGATIVE_INFINITY},Tie={NodeComparator:{configurable:!0}};Dh.prototype.getMin=function(){return this._min};Dh.prototype.intersects=function(e,n){return!(this._min>n||this._max<e)};Dh.prototype.getMax=function(){return this._max};Dh.prototype.toString=function(){return xc.toLineString(new dt(this._min,0),new dt(this._max,0))};Dh.prototype.interfaces_=function(){return[]};Dh.prototype.getClass=function(){return Dh};Tie.NodeComparator.get=function(){return sE};Object.defineProperties(Dh,Tie);var sE=function(){};sE.prototype.compare=function(e,n){var r=e,i=n,o=(r._min+r._max)/2,a=(i._min+i._max)/2;return o<a?-1:o>a?1:0};sE.prototype.interfaces_=function(){return[qv]};sE.prototype.getClass=function(){return sE};var YRe=function(t){function e(){t.call(this),this._item=null;var n=arguments[0],r=arguments[1],i=arguments[2];this._min=n,this._max=r,this._item=i}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.query=function(r,i,o){if(!this.intersects(r,i))return null;o.visitItem(this._item)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Dh),QRe=function(t){function e(){t.call(this),this._node1=null,this._node2=null;var n=arguments[0],r=arguments[1];this._node1=n,this._node2=r,this.buildExtent(this._node1,this._node2)}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.buildExtent=function(r,i){this._min=Math.min(r._min,i._min),this._max=Math.max(r._max,i._max)},e.prototype.query=function(r,i,o){if(!this.intersects(r,i))return null;this._node1!==null&&this._node1.query(r,i,o),this._node2!==null&&this._node2.query(r,i,o)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(Dh),Bh=function(){this._leaves=new bn,this._root=null,this._level=0};Bh.prototype.buildTree=function(){var e=this;Ec.sort(this._leaves,new Dh.NodeComparator);for(var n=this._leaves,r=null,i=new bn;;){if(e.buildLevel(n,i),i.size()===1)return i.get(0);r=n,n=i,i=r}};Bh.prototype.insert=function(e,n,r){if(this._root!==null)throw new Error("Index cannot be added to once it has been queried");this._leaves.add(new YRe(e,n,r))};Bh.prototype.query=function(e,n,r){this.init(),this._root.query(e,n,r)};Bh.prototype.buildRoot=function(){if(this._root!==null)return null;this._root=this.buildTree()};Bh.prototype.printNode=function(e){qs.out.println(xc.toLineString(new dt(e._min,this._level),new dt(e._max,this._level)))};Bh.prototype.init=function(){if(this._root!==null)return null;this.buildRoot()};Bh.prototype.buildLevel=function(e,n){this._level++,n.clear();for(var r=0;r<e.size();r+=2){var i=e.get(r),o=r+1<e.size()?e.get(r):null;if(o===null)n.add(i);else{var a=new QRe(e.get(r),e.get(r+1));n.add(a)}}};Bh.prototype.interfaces_=function(){return[]};Bh.prototype.getClass=function(){return Bh};var s1=function(){this._items=new bn};s1.prototype.visitItem=function(e){this._items.add(e)};s1.prototype.getItems=function(){return this._items};s1.prototype.interfaces_=function(){return[fg]};s1.prototype.getClass=function(){return s1};var a1=function(){this._index=null;var e=arguments[0];if(!ar(e,cg))throw new oo("Argument must be Polygonal");this._index=new lA(e)},U6={SegmentVisitor:{configurable:!0},IntervalIndexedGeometry:{configurable:!0}};a1.prototype.locate=function(e){var n=new mf(e),r=new l1(n);return this._index.query(e.y,e.y,r),n.getLocation()};a1.prototype.interfaces_=function(){return[i1]};a1.prototype.getClass=function(){return a1};U6.SegmentVisitor.get=function(){return l1};U6.IntervalIndexedGeometry.get=function(){return lA};Object.defineProperties(a1,U6);var l1=function(){this._counter=null;var e=arguments[0];this._counter=e};l1.prototype.visitItem=function(e){var n=e;this._counter.countSegment(n.getCoordinate(0),n.getCoordinate(1))};l1.prototype.interfaces_=function(){return[fg]};l1.prototype.getClass=function(){return l1};var lA=function(){this._index=new Bh;var e=arguments[0];this.init(e)};lA.prototype.init=function(e){for(var n=this,r=Gs.getLines(e),i=r.iterator();i.hasNext();){var o=i.next(),a=o.getCoordinates();n.addLine(a)}};lA.prototype.addLine=function(e){for(var n=this,r=1;r<e.length;r++){var i=new Jn(e[r-1],e[r]),o=Math.min(i.p0.y,i.p1.y),a=Math.max(i.p0.y,i.p1.y);n._index.insert(o,a,i)}};lA.prototype.query=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1],r=new s1;return this._index.query(e,n,r),r.getItems()}else if(arguments.length===3){var i=arguments[0],o=arguments[1],a=arguments[2];this._index.query(i,o,a)}};lA.prototype.interfaces_=function(){return[]};lA.prototype.getClass=function(){return lA};var yb=function(t){function e(){if(t.call(this),this._parentGeom=null,this._lineEdgeMap=new uie,this._boundaryNodeRule=null,this._useBoundaryDeterminationRule=!0,this._argIndex=null,this._boundaryNodes=null,this._hasTooFewPoints=!1,this._invalidPoint=null,this._areaPtLocator=null,this._ptLocator=new Tc,arguments.length===2){var n=arguments[0],r=arguments[1],i=Nu.OGC_SFS_BOUNDARY_RULE;this._argIndex=n,this._parentGeom=r,this._boundaryNodeRule=i,r!==null&&this.add(r)}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];this._argIndex=o,this._parentGeom=a,this._boundaryNodeRule=s,a!==null&&this.add(a)}}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertBoundaryPoint=function(r,i){var o=this._nodes.addNode(i),a=o.getLabel(),s=1,u=Et.NONE;u=a.getLocation(r,gn.ON),u===Et.BOUNDARY&&s++;var d=e.determineBoundary(this._boundaryNodeRule,s);a.setLocation(r,d)},e.prototype.computeSelfNodes=function(){if(arguments.length===2){var r=arguments[0],i=arguments[1];return this.computeSelfNodes(r,i,!1)}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2],u=new Ys(o,!0,!1);u.setIsDoneIfProperInt(s);var d=this.createEdgeSetIntersector(),g=this._parentGeom instanceof Ph||this._parentGeom instanceof us||this._parentGeom instanceof yh,_=a||!g;return d.computeIntersections(this._edges,u,_),this.addSelfIntersectionNodes(this._argIndex),u}},e.prototype.computeSplitEdges=function(r){for(var i=this._edges.iterator();i.hasNext();){var o=i.next();o.eiList.addSplitEdges(r)}},e.prototype.computeEdgeIntersections=function(r,i,o){var a=new Ys(i,o,!0);a.setBoundaryNodes(this.getBoundaryNodes(),r.getBoundaryNodes());var s=this.createEdgeSetIntersector();return s.computeIntersections(this._edges,r._edges,a),a},e.prototype.getGeometry=function(){return this._parentGeom},e.prototype.getBoundaryNodeRule=function(){return this._boundaryNodeRule},e.prototype.hasTooFewPoints=function(){return this._hasTooFewPoints},e.prototype.addPoint=function(){if(arguments[0]instanceof Il){var r=arguments[0],i=r.getCoordinate();this.insertPoint(this._argIndex,i,Et.INTERIOR)}else if(arguments[0]instanceof dt){var o=arguments[0];this.insertPoint(this._argIndex,o,Et.INTERIOR)}},e.prototype.addPolygon=function(r){var i=this;this.addPolygonRing(r.getExteriorRing(),Et.EXTERIOR,Et.INTERIOR);for(var o=0;o<r.getNumInteriorRing();o++){var a=r.getInteriorRingN(o);i.addPolygonRing(a,Et.INTERIOR,Et.EXTERIOR)}},e.prototype.addEdge=function(r){this.insertEdge(r);var i=r.getCoordinates();this.insertPoint(this._argIndex,i[0],Et.BOUNDARY),this.insertPoint(this._argIndex,i[i.length-1],Et.BOUNDARY)},e.prototype.addLineString=function(r){var i=zr.removeRepeatedPoints(r.getCoordinates());if(i.length<2)return this._hasTooFewPoints=!0,this._invalidPoint=i[0],null;var o=new MI(i,new di(this._argIndex,Et.INTERIOR));this._lineEdgeMap.put(r,o),this.insertEdge(o),Pr.isTrue(i.length>=2,"found LineString with single point"),this.insertBoundaryPoint(this._argIndex,i[0]),this.insertBoundaryPoint(this._argIndex,i[i.length-1])},e.prototype.getInvalidPoint=function(){return this._invalidPoint},e.prototype.getBoundaryPoints=function(){for(var r=this.getBoundaryNodes(),i=new Array(r.size()).fill(null),o=0,a=r.iterator();a.hasNext();){var s=a.next();i[o++]=s.getCoordinate().copy()}return i},e.prototype.getBoundaryNodes=function(){return this._boundaryNodes===null&&(this._boundaryNodes=this._nodes.getBoundaryNodes(this._argIndex)),this._boundaryNodes},e.prototype.addSelfIntersectionNode=function(r,i,o){if(this.isBoundaryNode(r,i))return null;o===Et.BOUNDARY&&this._useBoundaryDeterminationRule?this.insertBoundaryPoint(r,i):this.insertPoint(r,i,o)},e.prototype.addPolygonRing=function(r,i,o){if(r.isEmpty())return null;var a=zr.removeRepeatedPoints(r.getCoordinates());if(a.length<4)return this._hasTooFewPoints=!0,this._invalidPoint=a[0],null;var s=i,u=o;Rn.isCCW(a)&&(s=o,u=i);var d=new MI(a,new di(this._argIndex,Et.BOUNDARY,s,u));this._lineEdgeMap.put(r,d),this.insertEdge(d),this.insertPoint(this._argIndex,a[0],Et.BOUNDARY)},e.prototype.insertPoint=function(r,i,o){var a=this._nodes.addNode(i),s=a.getLabel();s===null?a._label=new di(r,o):s.setLocation(r,o)},e.prototype.createEdgeSetIntersector=function(){return new ZRe},e.prototype.addSelfIntersectionNodes=function(r){for(var i=this,o=this._edges.iterator();o.hasNext();)for(var a=o.next(),s=a.getLabel().getLocation(r),u=a.eiList.iterator();u.hasNext();){var d=u.next();i.addSelfIntersectionNode(r,d.coord,s)}},e.prototype.add=function(){if(arguments.length===1){var r=arguments[0];if(r.isEmpty())return null;if(r instanceof yh&&(this._useBoundaryDeterminationRule=!1),r instanceof us)this.addPolygon(r);else if(r instanceof bo)this.addLineString(r);else if(r instanceof Il)this.addPoint(r);else if(r instanceof e1)this.addCollection(r);else if(r instanceof tA)this.addCollection(r);else if(r instanceof yh)this.addCollection(r);else if(r instanceof Ra)this.addCollection(r);else throw new Error(r.getClass().getName())}else return t.prototype.add.apply(this,arguments)},e.prototype.addCollection=function(r){for(var i=this,o=0;o<r.getNumGeometries();o++){var a=r.getGeometryN(o);i.add(a)}},e.prototype.locate=function(r){return ar(this._parentGeom,cg)&&this._parentGeom.getNumGeometries()>50?(this._areaPtLocator===null&&(this._areaPtLocator=new a1(this._parentGeom)),this._areaPtLocator.locate(r)):this._ptLocator.locate(r,this._parentGeom)},e.prototype.findEdge=function(){if(arguments.length===1){var r=arguments[0];return this._lineEdgeMap.get(r)}else return t.prototype.findEdge.apply(this,arguments)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e.determineBoundary=function(r,i){return r.isInBoundary(i)?Et.BOUNDARY:Et.INTERIOR},e}(po),u1=function(){if(this._li=new bA,this._resultPrecisionModel=null,this._arg=null,arguments.length===1){var e=arguments[0];this.setComputationPrecision(e.getPrecisionModel()),this._arg=new Array(1).fill(null),this._arg[0]=new yb(0,e)}else if(arguments.length===2){var n=arguments[0],r=arguments[1],i=Nu.OGC_SFS_BOUNDARY_RULE;n.getPrecisionModel().compareTo(r.getPrecisionModel())>=0?this.setComputationPrecision(n.getPrecisionModel()):this.setComputationPrecision(r.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new yb(0,n,i),this._arg[1]=new yb(1,r,i)}else if(arguments.length===3){var o=arguments[0],a=arguments[1],s=arguments[2];o.getPrecisionModel().compareTo(a.getPrecisionModel())>=0?this.setComputationPrecision(o.getPrecisionModel()):this.setComputationPrecision(a.getPrecisionModel()),this._arg=new Array(2).fill(null),this._arg[0]=new yb(0,o,s),this._arg[1]=new yb(1,a,s)}};u1.prototype.getArgGeometry=function(e){return this._arg[e].getGeometry()};u1.prototype.setComputationPrecision=function(e){this._resultPrecisionModel=e,this._li.setPrecisionModel(this._resultPrecisionModel)};u1.prototype.interfaces_=function(){return[]};u1.prototype.getClass=function(){return u1};var Hm=function(){};Hm.prototype.interfaces_=function(){return[]};Hm.prototype.getClass=function(){return Hm};Hm.map=function(){if(arguments[0]instanceof ir&&ar(arguments[1],Hm.MapOp)){for(var e=arguments[0],n=arguments[1],r=new bn,i=0;i<e.getNumGeometries();i++){var o=n.map(e.getGeometryN(i));o!==null&&r.add(o)}return e.getFactory().buildGeometry(r)}else if(ar(arguments[0],Jo)&&ar(arguments[1],Hm.MapOp)){for(var a=arguments[0],s=arguments[1],u=new bn,d=a.iterator();d.hasNext();){var g=d.next(),_=s.map(g);_!==null&&u.add(_)}return u}};Hm.MapOp=function(){};var Sr=function(t){function e(){var n=arguments[0],r=arguments[1];t.call(this,n,r),this._ptLocator=new Tc,this._geomFact=null,this._resultGeom=null,this._graph=null,this._edgeList=new Sc,this._resultPolyList=new bn,this._resultLineList=new bn,this._resultPointList=new bn,this._graph=new po(new Aie),this._geomFact=n.getFactory()}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.insertUniqueEdge=function(r){var i=this._edgeList.findEqualEdge(r);if(i!==null){var o=i.getLabel(),a=r.getLabel();i.isPointwiseEqual(r)||(a=new di(r.getLabel()),a.flip());var s=i.getDepth();s.isNull()&&s.add(o),s.add(a),o.merge(a)}else this._edgeList.add(r)},e.prototype.getGraph=function(){return this._graph},e.prototype.cancelDuplicateResultEdges=function(){for(var r=this._graph.getEdgeEnds().iterator();r.hasNext();){var i=r.next(),o=i.getSym();i.isInResult()&&o.isInResult()&&(i.setInResult(!1),o.setInResult(!1))}},e.prototype.isCoveredByLA=function(r){return!!(this.isCovered(r,this._resultLineList)||this.isCovered(r,this._resultPolyList))},e.prototype.computeGeometry=function(r,i,o,a){var s=new bn;return s.addAll(r),s.addAll(i),s.addAll(o),s.isEmpty()?e.createEmptyResult(a,this._arg[0].getGeometry(),this._arg[1].getGeometry(),this._geomFact):this._geomFact.buildGeometry(s)},e.prototype.mergeSymLabels=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var i=r.next();i.getEdges().mergeSymLabels()}},e.prototype.isCovered=function(r,i){for(var o=this,a=i.iterator();a.hasNext();){var s=a.next(),u=o._ptLocator.locate(r,s);if(u!==Et.EXTERIOR)return!0}return!1},e.prototype.replaceCollapsedEdges=function(){for(var r=new bn,i=this._edgeList.iterator();i.hasNext();){var o=i.next();o.isCollapsed()&&(i.remove(),r.add(o.getCollapsedEdge()))}this._edgeList.addAll(r)},e.prototype.updateNodeLabelling=function(){for(var r=this._graph.getNodes().iterator();r.hasNext();){var i=r.next(),o=i.getEdges().getLabel();i.getLabel().merge(o)}},e.prototype.getResultGeometry=function(r){return this.computeOverlay(r),this._resultGeom},e.prototype.insertUniqueEdges=function(r){for(var i=this,o=r.iterator();o.hasNext();){var a=o.next();i.insertUniqueEdge(a)}},e.prototype.computeOverlay=function(r){this.copyPoints(0),this.copyPoints(1),this._arg[0].computeSelfNodes(this._li,!1),this._arg[1].computeSelfNodes(this._li,!1),this._arg[0].computeEdgeIntersections(this._arg[1],this._li,!0);var i=new bn;this._arg[0].computeSplitEdges(i),this._arg[1].computeSplitEdges(i),this.insertUniqueEdges(i),this.computeLabelsFromDepths(),this.replaceCollapsedEdges(),aA.checkValid(this._edgeList.getEdges()),this._graph.addEdges(this._edgeList.getEdges()),this.computeLabelling(),this.labelIncompleteNodes(),this.findResultAreaEdges(r),this.cancelDuplicateResultEdges();var o=new Ml(this._geomFact);o.add(this._graph),this._resultPolyList=o.getPolygons();var a=new Of(this,this._geomFact,this._ptLocator);this._resultLineList=a.build(r);var s=new J0(this,this._geomFact,this._ptLocator);this._resultPointList=s.build(r),this._resultGeom=this.computeGeometry(this._resultPointList,this._resultLineList,this._resultPolyList,r)},e.prototype.labelIncompleteNode=function(r,i){var o=this._ptLocator.locate(r.getCoordinate(),this._arg[i].getGeometry());r.getLabel().setLocation(i,o)},e.prototype.copyPoints=function(r){for(var i=this,o=this._arg[r].getNodeIterator();o.hasNext();){var a=o.next(),s=i._graph.addNode(a.getCoordinate());s.setLabel(r,a.getLabel().getLocation(r))}},e.prototype.findResultAreaEdges=function(r){for(var i=this._graph.getEdgeEnds().iterator();i.hasNext();){var o=i.next(),a=o.getLabel();a.isArea()&&!o.isInteriorAreaEdge()&&e.isResultOfOp(a.getLocation(0,gn.RIGHT),a.getLocation(1,gn.RIGHT),r)&&o.setInResult(!0)}},e.prototype.computeLabelsFromDepths=function(){for(var r=this._edgeList.iterator();r.hasNext();){var i=r.next(),o=i.getLabel(),a=i.getDepth();if(!a.isNull()){a.normalize();for(var s=0;s<2;s++)!o.isNull(s)&&o.isArea()&&!a.isNull(s)&&(a.getDelta(s)===0?o.toLine(s):(Pr.isTrue(!a.isNull(s,gn.LEFT),"depth of LEFT side has not been initialized"),o.setLocation(s,gn.LEFT,a.getLocation(s,gn.LEFT)),Pr.isTrue(!a.isNull(s,gn.RIGHT),"depth of RIGHT side has not been initialized"),o.setLocation(s,gn.RIGHT,a.getLocation(s,gn.RIGHT))))}}},e.prototype.computeLabelling=function(){for(var r=this,i=this._graph.getNodes().iterator();i.hasNext();){var o=i.next();o.getEdges().computeLabelling(r._arg)}this.mergeSymLabels(),this.updateNodeLabelling()},e.prototype.labelIncompleteNodes=function(){for(var r=this,i=this._graph.getNodes().iterator();i.hasNext();){var o=i.next(),a=o.getLabel();o.isIsolated()&&(a.isNull(0)?r.labelIncompleteNode(o,0):r.labelIncompleteNode(o,1)),o.getEdges().updateLabelling(a)}},e.prototype.isCoveredByA=function(r){return!!this.isCovered(r,this._resultPolyList)},e.prototype.interfaces_=function(){return[]},e.prototype.getClass=function(){return e},e}(u1);Sr.overlayOp=function(t,e,n){var r=new Sr(t,e),i=r.getResultGeometry(n);return i};Sr.intersection=function(t,e){if(t.isEmpty()||e.isEmpty())return Sr.createEmptyResult(Sr.INTERSECTION,t,e,t.getFactory());if(t.isGeometryCollection()){var n=e;return K0.map(t,{interfaces_:function(){return[Hm.MapOp]},map:function(r){return r.intersection(n)}})}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Ba.overlayOp(t,e,Sr.INTERSECTION)};Sr.symDifference=function(t,e){if(t.isEmpty()||e.isEmpty()){if(t.isEmpty()&&e.isEmpty())return Sr.createEmptyResult(Sr.SYMDIFFERENCE,t,e,t.getFactory());if(t.isEmpty())return e.copy();if(e.isEmpty())return t.copy()}return t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Ba.overlayOp(t,e,Sr.SYMDIFFERENCE)};Sr.resultDimension=function(t,e,n){var r=e.getDimension(),i=n.getDimension(),o=-1;switch(t){case Sr.INTERSECTION:o=Math.min(r,i);break;case Sr.UNION:o=Math.max(r,i);break;case Sr.DIFFERENCE:o=r;break;case Sr.SYMDIFFERENCE:o=Math.max(r,i);break}return o};Sr.createEmptyResult=function(t,e,n,r){var i=null;switch(Sr.resultDimension(t,e,n)){case-1:i=r.createGeometryCollection(new Array(0).fill(null));break;case 0:i=r.createPoint();break;case 1:i=r.createLineString();break;case 2:i=r.createPolygon();break}return i};Sr.difference=function(t,e){return t.isEmpty()?Sr.createEmptyResult(Sr.DIFFERENCE,t,e,t.getFactory()):e.isEmpty()?t.copy():(t.checkNotGeometryCollection(t),t.checkNotGeometryCollection(e),Ba.overlayOp(t,e,Sr.DIFFERENCE))};Sr.isResultOfOp=function(){if(arguments.length===2){var t=arguments[0],e=arguments[1],n=t.getLocation(0),r=t.getLocation(1);return Sr.isResultOfOp(n,r,e)}else if(arguments.length===3){var i=arguments[0],o=arguments[1],a=arguments[2];switch(i===Et.BOUNDARY&&(i=Et.INTERIOR),o===Et.BOUNDARY&&(o=Et.INTERIOR),a){case Sr.INTERSECTION:return i===Et.INTERIOR&&o===Et.INTERIOR;case Sr.UNION:return i===Et.INTERIOR||o===Et.INTERIOR;case Sr.DIFFERENCE:return i===Et.INTERIOR&&o!==Et.INTERIOR;case Sr.SYMDIFFERENCE:return i===Et.INTERIOR&&o!==Et.INTERIOR||i!==Et.INTERIOR&&o===Et.INTERIOR}return!1}};Sr.INTERSECTION=1;Sr.UNION=2;Sr.DIFFERENCE=3;Sr.SYMDIFFERENCE=4;var eg=function(){this._g=null,this._boundaryDistanceTolerance=null,this._linework=null,this._ptLocator=new Tc,this._seg=new Jn;var e=arguments[0],n=arguments[1];this._g=e,this._boundaryDistanceTolerance=n,this._linework=this.extractLinework(e)};eg.prototype.isWithinToleranceOfBoundary=function(e){for(var n=this,r=0;r<this._linework.getNumGeometries();r++)for(var i=n._linework.getGeometryN(r),o=i.getCoordinateSequence(),a=0;a<o.size()-1;a++){o.getCoordinate(a,n._seg.p0),o.getCoordinate(a+1,n._seg.p1);var s=n._seg.distance(e);if(s<=n._boundaryDistanceTolerance)return!0}return!1};eg.prototype.getLocation=function(e){return this.isWithinToleranceOfBoundary(e)?Et.BOUNDARY:this._ptLocator.locate(e,this._g)};eg.prototype.extractLinework=function(e){var n=new c1;e.apply(n);var r=n.getLinework(),i=kr.toLineStringArray(r);return e.getFactory().createMultiLineString(i)};eg.prototype.interfaces_=function(){return[]};eg.prototype.getClass=function(){return eg};var c1=function(){this._linework=null,this._linework=new bn};c1.prototype.getLinework=function(){return this._linework};c1.prototype.filter=function(e){var n=this;if(e instanceof us){var r=e;this._linework.add(r.getExteriorRing());for(var i=0;i<r.getNumInteriorRing();i++)n._linework.add(r.getInteriorRingN(i))}};c1.prototype.interfaces_=function(){return[Ef]};c1.prototype.getClass=function(){return c1};var uA=function(){this._g=null,this._doLeft=!0,this._doRight=!0;var e=arguments[0];this._g=e};uA.prototype.extractPoints=function(e,n,r){for(var i=this,o=e.getCoordinates(),a=0;a<o.length-1;a++)i.computeOffsetPoints(o[a],o[a+1],n,r)};uA.prototype.setSidesToGenerate=function(e,n){this._doLeft=e,this._doRight=n};uA.prototype.getPoints=function(e){for(var n=this,r=new bn,i=Gs.getLines(this._g),o=i.iterator();o.hasNext();){var a=o.next();n.extractPoints(a,e,r)}return r};uA.prototype.computeOffsetPoints=function(e,n,r,i){var o=n.x-e.x,a=n.y-e.y,s=Math.sqrt(o*o+a*a),u=r*o/s,d=r*a/s,g=(n.x+e.x)/2,_=(n.y+e.y)/2;if(this._doLeft){var E=new dt(g-d,_+u);i.add(E)}if(this._doRight){var P=new dt(g+d,_-u);i.add(P)}};uA.prototype.interfaces_=function(){return[]};uA.prototype.getClass=function(){return uA};var ru=function t(){this._geom=null,this._locFinder=null,this._location=new Array(3).fill(null),this._invalidLocation=null,this._boundaryDistanceTolerance=t.TOLERANCE,this._testCoords=new bn;var e=arguments[0],n=arguments[1],r=arguments[2];this._boundaryDistanceTolerance=t.computeBoundaryDistanceTolerance(e,n),this._geom=[e,n,r],this._locFinder=[new eg(this._geom[0],this._boundaryDistanceTolerance),new eg(this._geom[1],this._boundaryDistanceTolerance),new eg(this._geom[2],this._boundaryDistanceTolerance)]},Cie={TOLERANCE:{configurable:!0}};ru.prototype.reportResult=function(e,n,r){qs.out.println("Overlay result invalid - A:"+Et.toLocationSymbol(n[0])+" B:"+Et.toLocationSymbol(n[1])+" expected:"+(r?"i":"e")+" actual:"+Et.toLocationSymbol(n[2]))};ru.prototype.isValid=function(e){this.addTestPts(this._geom[0]),this.addTestPts(this._geom[1]);var n=this.checkValid(e);return n};ru.prototype.checkValid=function(){var e=this;if(arguments.length===1){for(var n=arguments[0],r=0;r<this._testCoords.size();r++){var i=e._testCoords.get(r);if(!e.checkValid(n,i))return e._invalidLocation=i,!1}return!0}else if(arguments.length===2){var o=arguments[0],a=arguments[1];return this._location[0]=this._locFinder[0].getLocation(a),this._location[1]=this._locFinder[1].getLocation(a),this._location[2]=this._locFinder[2].getLocation(a),ru.hasLocation(this._location,Et.BOUNDARY)?!0:this.isValidResult(o,this._location)}};ru.prototype.addTestPts=function(e){var n=new uA(e);this._testCoords.addAll(n.getPoints(5*this._boundaryDistanceTolerance))};ru.prototype.isValidResult=function(e,n){var r=Sr.isResultOfOp(n[0],n[1],e),i=n[2]===Et.INTERIOR,o=!(r^i);return o||this.reportResult(e,n,r),o};ru.prototype.getInvalidLocation=function(){return this._invalidLocation};ru.prototype.interfaces_=function(){return[]};ru.prototype.getClass=function(){return ru};ru.hasLocation=function(e,n){for(var r=0;r<3;r++)if(e[r]===n)return!0;return!1};ru.computeBoundaryDistanceTolerance=function(e,n){return Math.min(Oo.computeSizeBasedSnapTolerance(e),Oo.computeSizeBasedSnapTolerance(n))};ru.isValid=function(e,n,r,i){var o=new ru(e,n,i);return o.isValid(r)};Cie.TOLERANCE.get=function(){return 1e-6};Object.defineProperties(ru,Cie);var ql=function t(e){this._geomFactory=null,this._skipEmpty=!1,this._inputGeoms=null,this._geomFactory=t.extractFactory(e),this._inputGeoms=e};ql.prototype.extractElements=function(e,n){var r=this;if(e===null)return null;for(var i=0;i<e.getNumGeometries();i++){var o=e.getGeometryN(i);r._skipEmpty&&o.isEmpty()||n.add(o)}};ql.prototype.combine=function(){for(var e=this,n=new bn,r=this._inputGeoms.iterator();r.hasNext();){var i=r.next();e.extractElements(i,n)}return n.size()===0?this._geomFactory!==null?this._geomFactory.createGeometryCollection(null):null:this._geomFactory.buildGeometry(n)};ql.prototype.interfaces_=function(){return[]};ql.prototype.getClass=function(){return ql};ql.combine=function(){if(arguments.length===1){var e=arguments[0],n=new ql(e);return n.combine()}else if(arguments.length===2){var r=arguments[0],i=arguments[1],o=new ql(ql.createList(r,i));return o.combine()}else if(arguments.length===3){var a=arguments[0],s=arguments[1],u=arguments[2],d=new ql(ql.createList(a,s,u));return d.combine()}};ql.extractFactory=function(e){return e.isEmpty()?null:e.iterator().next().getFactory()};ql.createList=function(){if(arguments.length===2){var e=arguments[0],n=arguments[1],r=new bn;return r.add(e),r.add(n),r}else if(arguments.length===3){var i=arguments[0],o=arguments[1],a=arguments[2],s=new bn;return s.add(i),s.add(o),s.add(a),s}};var Go=function(){this._inputPolys=null,this._geomFactory=null;var e=arguments[0];this._inputPolys=e,this._inputPolys===null&&(this._inputPolys=new bn)},Pie={STRTREE_NODE_CAPACITY:{configurable:!0}};Go.prototype.reduceToGeometries=function(e){for(var n=this,r=new bn,i=e.iterator();i.hasNext();){var o=i.next(),a=null;ar(o,Ac)?a=n.unionTree(o):o instanceof ir&&(a=o),r.add(a)}return r};Go.prototype.extractByEnvelope=function(e,n,r){for(var i=new bn,o=0;o<n.getNumGeometries();o++){var a=n.getGeometryN(o);a.getEnvelopeInternal().intersects(e)?i.add(a):r.add(a)}return this._geomFactory.buildGeometry(i)};Go.prototype.unionOptimized=function(e,n){var r=e.getEnvelopeInternal(),i=n.getEnvelopeInternal();if(!r.intersects(i)){var o=ql.combine(e,n);return o}if(e.getNumGeometries()<=1&&n.getNumGeometries()<=1)return this.unionActual(e,n);var a=r.intersection(i);return this.unionUsingEnvelopeIntersection(e,n,a)};Go.prototype.union=function(){if(this._inputPolys===null)throw new Error("union() method cannot be called twice");if(this._inputPolys.isEmpty())return null;this._geomFactory=this._inputPolys.iterator().next().getFactory();for(var e=new die(Go.STRTREE_NODE_CAPACITY),n=this._inputPolys.iterator();n.hasNext();){var r=n.next();e.insert(r.getEnvelopeInternal(),r)}this._inputPolys=null;var i=e.itemsTree(),o=this.unionTree(i);return o};Go.prototype.binaryUnion=function(){if(arguments.length===1){var e=arguments[0];return this.binaryUnion(e,0,e.size())}else if(arguments.length===3){var n=arguments[0],r=arguments[1],i=arguments[2];if(i-r<=1){var o=Go.getGeometry(n,r);return this.unionSafe(o,null)}else{if(i-r===2)return this.unionSafe(Go.getGeometry(n,r),Go.getGeometry(n,r+1));var a=Math.trunc((i+r)/2),s=this.binaryUnion(n,r,a),u=this.binaryUnion(n,a,i);return this.unionSafe(s,u)}}};Go.prototype.repeatedUnion=function(e){for(var n=null,r=e.iterator();r.hasNext();){var i=r.next();n===null?n=i.copy():n=n.union(i)}return n};Go.prototype.unionSafe=function(e,n){return e===null&&n===null?null:e===null?n.copy():n===null?e.copy():this.unionOptimized(e,n)};Go.prototype.unionActual=function(e,n){return Go.restrictToPolygons(e.union(n))};Go.prototype.unionTree=function(e){var n=this.reduceToGeometries(e),r=this.binaryUnion(n);return r};Go.prototype.unionUsingEnvelopeIntersection=function(e,n,r){var i=new bn,o=this.extractByEnvelope(r,e,i),a=this.extractByEnvelope(r,n,i),s=this.unionActual(o,a);i.add(s);var u=ql.combine(i);return u};Go.prototype.bufferUnion=function(){if(arguments.length===1){var e=arguments[0],n=e.get(0).getFactory(),r=n.buildGeometry(e),i=r.buffer(0);return i}else if(arguments.length===2){var o=arguments[0],a=arguments[1],s=o.getFactory(),u=s.createGeometryCollection([o,a]),d=u.buffer(0);return d}};Go.prototype.interfaces_=function(){return[]};Go.prototype.getClass=function(){return Go};Go.restrictToPolygons=function(e){if(ar(e,cg))return e;var n=zd.getPolygons(e);return n.size()===1?n.get(0):e.getFactory().createMultiPolygon(kr.toPolygonArray(n))};Go.getGeometry=function(e,n){return n>=e.size()?null:e.get(n)};Go.union=function(e){var n=new Go(e);return n.union()};Pie.STRTREE_NODE_CAPACITY.get=function(){return 4};Object.defineProperties(Go,Pie);var RI=function(){};RI.prototype.interfaces_=function(){return[]};RI.prototype.getClass=function(){return RI};RI.union=function(e,n){if(e.isEmpty()||n.isEmpty()){if(e.isEmpty()&&n.isEmpty())return Sr.createEmptyResult(Sr.UNION,e,n,e.getFactory());if(e.isEmpty())return n.copy();if(n.isEmpty())return e.copy()}return e.checkNotGeometryCollection(e),e.checkNotGeometryCollection(n),Ba.overlayOp(e,n,Sr.UNION)};function wA(){return new LI}function LI(){this.reset()}LI.prototype={constructor:LI,reset:function(){this.s=this.t=0},add:function(t){_7($S,t,this.t),_7(this,$S.s,this.s),this.s?this.t+=$S.t:this.s=$S.t},valueOf:function(){return this.s}};var $S=new LI;function _7(t,e,n){var r=t.s=e+n,i=r-e,o=r-i;t.t=e-o+(n-i)}var vo=1e-6,Mi=Math.PI,Ld=Mi/2,y7=Mi/4,Zd=Mi*2,pm=180/Mi,ef=Mi/180,Ca=Math.abs,KRe=Math.atan,f1=Math.atan2,es=Math.cos,ts=Math.sin,$1=Math.sqrt;function Iie(t){return t>1?0:t<-1?Mi:Math.acos(t)}function t_(t){return t>1?Ld:t<-1?-Ld:Math.asin(t)}function Kb(){}function DI(t,e){t&&x7.hasOwnProperty(t.type)&&x7[t.type](t,e)}var v7={Feature:function(t,e){DI(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)DI(n[r].geometry,e)}},x7={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){Mk(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)Mk(n[r],e,0)},Polygon:function(t,e){b7(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)b7(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)DI(n[r],e)}};function Mk(t,e,n){var r=-1,i=t.length-n,o;for(e.lineStart();++r<i;)o=t[r],e.point(o[0],o[1],o[2]);e.lineEnd()}function b7(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)Mk(t[n],e,1);e.polygonEnd()}function JRe(t,e){t&&v7.hasOwnProperty(t.type)?v7[t.type](t,e):DI(t,e)}wA();wA();function Ok(t){return[f1(t[1],t[0]),t_(t[2])]}function h1(t){var e=t[0],n=t[1],r=es(n);return[r*es(e),r*ts(e),ts(n)]}function HS(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function BI(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function AB(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function WS(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Rk(t){var e=$1(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}wA();function Mie(t,e){function n(r,i){return r=t(r,i),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,i){return r=e.invert(r,i),r&&t.invert(r[0],r[1])}),n}function Lk(t,e){return[t>Mi?t-Zd:t<-Mi?t+Zd:t,e]}Lk.invert=Lk;function eLe(t,e,n){return(t%=Zd)?e||n?Mie(E7(t),S7(e,n)):E7(t):e||n?S7(e,n):Lk}function w7(t){return function(e,n){return e+=t,[e>Mi?e-Zd:e<-Mi?e+Zd:e,n]}}function E7(t){var e=w7(t);return e.invert=w7(-t),e}function S7(t,e){var n=es(t),r=ts(t),i=es(e),o=ts(e);function a(s,u){var d=es(u),g=es(s)*d,_=ts(s)*d,E=ts(u),P=E*n+g*r;return[f1(_*i-P*o,g*n-E*r),t_(P*i+_*o)]}return a.invert=function(s,u){var d=es(u),g=es(s)*d,_=ts(s)*d,E=ts(u),P=E*i-_*o;return[f1(_*i+E*o,g*n+P*r),t_(P*n-g*r)]},a}function tLe(t,e,n,r,i,o){if(n){var a=es(e),s=ts(e),u=r*n;i==null?(i=e+r*Zd,o=e-u/2):(i=T7(a,i),o=T7(a,o),(r>0?i<o:i>o)&&(i+=r*Zd));for(var d,g=i;r>0?g>o:g<o;g-=u)d=Ok([a,-s*es(g),-s*ts(g)]),t.point(d[0],d[1])}}function T7(t,e){e=h1(e),e[0]-=t,Rk(e);var n=Iie(-e[1]);return((-e[2]<0?-n:n)+Zd-vo)%Zd}function Oie(){var t=[],e;return{point:function(n,r){e.push([n,r])},lineStart:function(){t.push(e=[])},lineEnd:Kb,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function nLe(t,e,n,r,i,o){var a=t[0],s=t[1],u=e[0],d=e[1],g=0,_=1,E=u-a,P=d-s,O;if(O=n-a,!(!E&&O>0)){if(O/=E,E<0){if(O<g)return;O<_&&(_=O)}else if(E>0){if(O>_)return;O>g&&(g=O)}if(O=i-a,!(!E&&O<0)){if(O/=E,E<0){if(O>_)return;O>g&&(g=O)}else if(E>0){if(O<g)return;O<_&&(_=O)}if(O=r-s,!(!P&&O>0)){if(O/=P,P<0){if(O<g)return;O<_&&(_=O)}else if(P>0){if(O>_)return;O>g&&(g=O)}if(O=o-s,!(!P&&O<0)){if(O/=P,P<0){if(O>_)return;O>g&&(g=O)}else if(P>0){if(O<g)return;O<_&&(_=O)}return g>0&&(t[0]=a+g*E,t[1]=s+g*P),_<1&&(e[0]=a+_*E,e[1]=s+_*P),!0}}}}}function PC(t,e){return Ca(t[0]-e[0])<vo&&Ca(t[1]-e[1])<vo}function qS(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Rie(t,e,n,r,i){var o=[],a=[],s,u;if(t.forEach(function(O){if(!((D=O.length-1)<=0)){var D,V=O[0],k=O[D],F;if(PC(V,k)){for(i.lineStart(),s=0;s<D;++s)i.point((V=O[s])[0],V[1]);i.lineEnd();return}o.push(F=new qS(V,O,null,!0)),a.push(F.o=new qS(V,null,F,!1)),o.push(F=new qS(k,O,null,!1)),a.push(F.o=new qS(k,null,F,!0))}}),!!o.length){for(a.sort(e),C7(o),C7(a),s=0,u=a.length;s<u;++s)a[s].e=n=!n;for(var d=o[0],g,_;;){for(var E=d,P=!0;E.v;)if((E=E.n)===d)return;g=E.z,i.lineStart();do{if(E.v=E.o.v=!0,E.e){if(P)for(s=0,u=g.length;s<u;++s)i.point((_=g[s])[0],_[1]);else r(E.x,E.n.x,1,i);E=E.n}else{if(P)for(g=E.p.z,s=g.length-1;s>=0;--s)i.point((_=g[s])[0],_[1]);else r(E.x,E.p.x,-1,i);E=E.p}E=E.o,g=E.z,P=!P}while(!E.v);i.lineEnd()}}}function C7(t){if(e=t.length){for(var e,n=0,r=t[0],i;++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}function Lie(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function rLe(t){return t.length===1&&(t=iLe(t)),{left:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(r==null&&(r=0),i==null&&(i=e.length);r<i;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}function iLe(t){return function(e,n){return Lie(t(e),n)}}rLe(Lie);function Die(t){for(var e=t.length,n,r=-1,i=0,o,a;++r<e;)i+=t[r].length;for(o=new Array(i);--e>=0;)for(a=t[e],n=a.length;--n>=0;)o[--i]=a[n];return o}var Jb=1e9,XS=-Jb;function oLe(t,e,n,r){function i(d,g){return t<=d&&d<=n&&e<=g&&g<=r}function o(d,g,_,E){var P=0,O=0;if(d==null||(P=a(d,_))!==(O=a(g,_))||u(d,g)<0^_>0)do E.point(P===0||P===3?t:n,P>1?r:e);while((P=(P+_+4)%4)!==O);else E.point(g[0],g[1])}function a(d,g){return Ca(d[0]-t)<vo?g>0?0:3:Ca(d[0]-n)<vo?g>0?2:1:Ca(d[1]-e)<vo?g>0?1:0:g>0?3:2}function s(d,g){return u(d.x,g.x)}function u(d,g){var _=a(d,1),E=a(g,1);return _!==E?_-E:_===0?g[1]-d[1]:_===1?d[0]-g[0]:_===2?d[1]-g[1]:g[0]-d[0]}return function(d){var g=d,_=Oie(),E,P,O,D,V,k,F,z,X,Y,J,re={point:ue,lineStart:me,lineEnd:Ce,polygonStart:ce,polygonEnd:se};function ue(Ye,at){i(Ye,at)&&g.point(Ye,at)}function ie(){for(var Ye=0,at=0,yt=P.length;at<yt;++at)for(var be=P[at],De=1,Re=be.length,qe=be[0],ct,Ct,Dt=qe[0],In=qe[1];De<Re;++De)ct=Dt,Ct=In,qe=be[De],Dt=qe[0],In=qe[1],Ct<=r?In>r&&(Dt-ct)*(r-Ct)>(In-Ct)*(t-ct)&&++Ye:In<=r&&(Dt-ct)*(r-Ct)<(In-Ct)*(t-ct)&&--Ye;return Ye}function ce(){g=_,E=[],P=[],J=!0}function se(){var Ye=ie(),at=J&&Ye,yt=(E=Die(E)).length;(at||yt)&&(d.polygonStart(),at&&(d.lineStart(),o(null,null,1,d),d.lineEnd()),yt&&Rie(E,s,Ye,o,d),d.polygonEnd()),g=d,E=P=O=null}function me(){re.point=we,P&&P.push(O=[]),Y=!0,X=!1,F=z=NaN}function Ce(){E&&(we(D,V),k&&X&&_.rejoin(),E.push(_.result())),re.point=ue,X&&g.lineEnd()}function we(Ye,at){var yt=i(Ye,at);if(P&&O.push([Ye,at]),Y)D=Ye,V=at,k=yt,Y=!1,yt&&(g.lineStart(),g.point(Ye,at));else if(yt&&X)g.point(Ye,at);else{var be=[F=Math.max(XS,Math.min(Jb,F)),z=Math.max(XS,Math.min(Jb,z))],De=[Ye=Math.max(XS,Math.min(Jb,Ye)),at=Math.max(XS,Math.min(Jb,at))];nLe(be,De,t,e,n,r)?(X||(g.lineStart(),g.point(be[0],be[1])),g.point(De[0],De[1]),yt||g.lineEnd(),J=!1):yt&&(g.lineStart(),g.point(Ye,at),J=!1)}F=Ye,z=at,X=yt}return re}}var _B=wA();function sLe(t,e){var n=e[0],r=e[1],i=[ts(n),-es(n),0],o=0,a=0;_B.reset();for(var s=0,u=t.length;s<u;++s)if(g=(d=t[s]).length)for(var d,g,_=d[g-1],E=_[0],P=_[1]/2+y7,O=ts(P),D=es(P),V=0;V<g;++V,E=F,O=X,D=Y,_=k){var k=d[V],F=k[0],z=k[1]/2+y7,X=ts(z),Y=es(z),J=F-E,re=J>=0?1:-1,ue=re*J,ie=ue>Mi,ce=O*X;if(_B.add(f1(ce*re*ts(ue),D*Y+ce*es(ue))),o+=ie?J+re*Zd:J,ie^E>=n^F>=n){var se=BI(h1(_),h1(k));Rk(se);var me=BI(i,se);Rk(me);var Ce=(ie^J>=0?-1:1)*t_(me[2]);(r>Ce||r===Ce&&(se[0]||se[1]))&&(a+=ie^J>=0?1:-1)}}return(o<-vo||o<vo&&_B<-vo)^a&1}wA();function P7(t){return t}wA();wA();var d1=1/0,NI=d1,aE=-d1,FI=aE,I7={point:aLe,lineStart:Kb,lineEnd:Kb,polygonStart:Kb,polygonEnd:Kb,result:function(){var t=[[d1,NI],[aE,FI]];return aE=FI=-(NI=d1=1/0),t}};function aLe(t,e){t<d1&&(d1=t),t>aE&&(aE=t),e<NI&&(NI=e),e>FI&&(FI=e)}wA();function Bie(t,e,n,r){return function(i,o){var a=e(o),s=i.invert(r[0],r[1]),u=Oie(),d=e(u),g=!1,_,E,P,O={point:D,lineStart:k,lineEnd:F,polygonStart:function(){O.point=z,O.lineStart=X,O.lineEnd=Y,E=[],_=[]},polygonEnd:function(){O.point=D,O.lineStart=k,O.lineEnd=F,E=Die(E);var J=sLe(_,s);E.length?(g||(o.polygonStart(),g=!0),Rie(E,uLe,J,n,o)):J&&(g||(o.polygonStart(),g=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),g&&(o.polygonEnd(),g=!1),E=_=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function D(J,re){var ue=i(J,re);t(J=ue[0],re=ue[1])&&o.point(J,re)}function V(J,re){var ue=i(J,re);a.point(ue[0],ue[1])}function k(){O.point=V,a.lineStart()}function F(){O.point=D,a.lineEnd()}function z(J,re){P.push([J,re]);var ue=i(J,re);d.point(ue[0],ue[1])}function X(){d.lineStart(),P=[]}function Y(){z(P[0][0],P[0][1]),d.lineEnd();var J=d.clean(),re=u.result(),ue,ie=re.length,ce,se,me;if(P.pop(),_.push(P),P=null,!!ie){if(J&1){if(se=re[0],(ce=se.length-1)>0){for(g||(o.polygonStart(),g=!0),o.lineStart(),ue=0;ue<ce;++ue)o.point((me=se[ue])[0],me[1]);o.lineEnd()}return}ie>1&&J&2&&re.push(re.pop().concat(re.shift())),E.push(re.filter(lLe))}}return O}}function lLe(t){return t.length>1}function uLe(t,e){return((t=t.x)[0]<0?t[1]-Ld-vo:Ld-t[1])-((e=e.x)[0]<0?e[1]-Ld-vo:Ld-e[1])}const M7=Bie(function(){return!0},cLe,hLe,[-Mi,-Ld]);function cLe(t){var e=NaN,n=NaN,r=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(o,a){var s=o>0?Mi:-Mi,u=Ca(o-e);Ca(u-Mi)<vo?(t.point(e,n=(n+a)/2>0?Ld:-Ld),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),t.point(o,n),i=0):r!==s&&u>=Mi&&(Ca(e-r)<vo&&(e-=r*vo),Ca(o-s)<vo&&(o-=s*vo),n=fLe(e,n,o,a),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(s,n),i=0),t.point(e=o,n=a),r=s},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-i}}}function fLe(t,e,n,r){var i,o,a=ts(t-n);return Ca(a)>vo?KRe((ts(e)*(o=es(r))*ts(n)-ts(r)*(i=es(e))*ts(t))/(i*o*a)):(e+r)/2}function hLe(t,e,n,r){var i;if(t==null)i=n*Ld,r.point(-Mi,i),r.point(0,i),r.point(Mi,i),r.point(Mi,0),r.point(Mi,-i),r.point(0,-i),r.point(-Mi,-i),r.point(-Mi,0),r.point(-Mi,i);else if(Ca(t[0]-e[0])>vo){var o=t[0]<e[0]?Mi:-Mi;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}function dLe(t,e){var n=es(t),r=n>0,i=Ca(n)>vo;function o(g,_,E,P){tLe(P,t,e,E,g,_)}function a(g,_){return es(g)*es(_)>n}function s(g){var _,E,P,O,D;return{lineStart:function(){O=P=!1,D=1},point:function(V,k){var F=[V,k],z,X=a(V,k),Y=r?X?0:d(V,k):X?d(V+(V<0?Mi:-Mi),k):0;if(!_&&(O=P=X)&&g.lineStart(),X!==P&&(z=u(_,F),(!z||PC(_,z)||PC(F,z))&&(F[0]+=vo,F[1]+=vo,X=a(F[0],F[1]))),X!==P)D=0,X?(g.lineStart(),z=u(F,_),g.point(z[0],z[1])):(z=u(_,F),g.point(z[0],z[1]),g.lineEnd()),_=z;else if(i&&_&&r^X){var J;!(Y&E)&&(J=u(F,_,!0))&&(D=0,r?(g.lineStart(),g.point(J[0][0],J[0][1]),g.point(J[1][0],J[1][1]),g.lineEnd()):(g.point(J[1][0],J[1][1]),g.lineEnd(),g.lineStart(),g.point(J[0][0],J[0][1])))}X&&(!_||!PC(_,F))&&g.point(F[0],F[1]),_=F,P=X,E=Y},lineEnd:function(){P&&g.lineEnd(),_=null},clean:function(){return D|(O&&P)<<1}}}function u(g,_,E){var P=h1(g),O=h1(_),D=[1,0,0],V=BI(P,O),k=HS(V,V),F=V[0],z=k-F*F;if(!z)return!E&&g;var X=n*k/z,Y=-n*F/z,J=BI(D,V),re=WS(D,X),ue=WS(V,Y);AB(re,ue);var ie=J,ce=HS(re,ie),se=HS(ie,ie),me=ce*ce-se*(HS(re,re)-1);if(!(me<0)){var Ce=$1(me),we=WS(ie,(-ce-Ce)/se);if(AB(we,re),we=Ok(we),!E)return we;var Ye=g[0],at=_[0],yt=g[1],be=_[1],De;at<Ye&&(De=Ye,Ye=at,at=De);var Re=at-Ye,qe=Ca(Re-Mi)<vo,ct=qe||Re<vo;if(!qe&&be<yt&&(De=yt,yt=be,be=De),ct?qe?yt+be>0^we[1]<(Ca(we[0]-Ye)<vo?yt:be):yt<=we[1]&&we[1]<=be:Re>Mi^(Ye<=we[0]&&we[0]<=at)){var Ct=WS(ie,(-ce+Ce)/se);return AB(Ct,re),[we,Ok(Ct)]}}}function d(g,_){var E=r?t:Mi-t,P=0;return g<-E?P|=1:g>E&&(P|=2),_<-E?P|=4:_>E&&(P|=8),P}return Bie(a,s,o,r?[0,-t]:[-Mi,t-Mi])}function Nie(t){return function(e){var n=new Dk;for(var r in t)n[r]=t[r];return n.stream=e,n}}function Dk(){}Dk.prototype={constructor:Dk,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function Fie(t,e,n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=t.clipExtent&&t.clipExtent();t.scale(150).translate([0,0]),o!=null&&t.clipExtent(null),JRe(n,t.stream(I7));var a=I7.result(),s=Math.min(r/(a[1][0]-a[0][0]),i/(a[1][1]-a[0][1])),u=+e[0][0]+(r-s*(a[1][0]+a[0][0]))/2,d=+e[0][1]+(i-s*(a[1][1]+a[0][1]))/2;return o!=null&&t.clipExtent(o),t.scale(s*150).translate([u,d])}function pLe(t,e,n){return Fie(t,[[0,0],e],n)}var O7=16,gLe=es(30*ef);function R7(t,e){return+e?ALe(t,e):mLe(t)}function mLe(t){return Nie({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function ALe(t,e){function n(r,i,o,a,s,u,d,g,_,E,P,O,D,V){var k=d-r,F=g-i,z=k*k+F*F;if(z>4*e&&D--){var X=a+E,Y=s+P,J=u+O,re=$1(X*X+Y*Y+J*J),ue=t_(J/=re),ie=Ca(Ca(J)-1)<vo||Ca(o-_)<vo?(o+_)/2:f1(Y,X),ce=t(ie,ue),se=ce[0],me=ce[1],Ce=se-r,we=me-i,Ye=F*Ce-k*we;(Ye*Ye/z>e||Ca((k*Ce+F*we)/z-.5)>.3||a*E+s*P+u*O<gLe)&&(n(r,i,o,a,s,u,se,me,ie,X/=re,Y/=re,J,D,V),V.point(se,me),n(se,me,ie,X,Y,J,d,g,_,E,P,O,D,V))}}return function(r){var i,o,a,s,u,d,g,_,E,P,O,D,V={point:k,lineStart:F,lineEnd:X,polygonStart:function(){r.polygonStart(),V.lineStart=Y},polygonEnd:function(){r.polygonEnd(),V.lineStart=F}};function k(ue,ie){ue=t(ue,ie),r.point(ue[0],ue[1])}function F(){_=NaN,V.point=z,r.lineStart()}function z(ue,ie){var ce=h1([ue,ie]),se=t(ue,ie);n(_,E,g,P,O,D,_=se[0],E=se[1],g=ue,P=ce[0],O=ce[1],D=ce[2],O7,r),r.point(_,E)}function X(){V.point=k,r.lineEnd()}function Y(){F(),V.point=J,V.lineEnd=re}function J(ue,ie){z(i=ue,ie),o=_,a=E,s=P,u=O,d=D,V.point=z}function re(){n(_,E,g,P,O,D,o,a,i,s,u,d,O7,r),V.lineEnd=X,X()}return V}}var _Le=Nie({point:function(t,e){this.stream.point(t*ef,e*ef)}});function yLe(t){return vLe(function(){return t})()}function vLe(t){var e,n=150,r=480,i=250,o,a,s=0,u=0,d=0,g=0,_=0,E,P,O=null,D=M7,V=null,k,F,z,X=P7,Y=.5,J=R7(se,Y),re,ue;function ie(we){return we=P(we[0]*ef,we[1]*ef),[we[0]*n+o,a-we[1]*n]}function ce(we){return we=P.invert((we[0]-o)/n,(a-we[1])/n),we&&[we[0]*pm,we[1]*pm]}function se(we,Ye){return we=e(we,Ye),[we[0]*n+o,a-we[1]*n]}ie.stream=function(we){return re&&ue===we?re:re=_Le(D(E,J(X(ue=we))))},ie.clipAngle=function(we){return arguments.length?(D=+we?dLe(O=we*ef,6*ef):(O=null,M7),Ce()):O*pm},ie.clipExtent=function(we){return arguments.length?(X=we==null?(V=k=F=z=null,P7):oLe(V=+we[0][0],k=+we[0][1],F=+we[1][0],z=+we[1][1]),Ce()):V==null?null:[[V,k],[F,z]]},ie.scale=function(we){return arguments.length?(n=+we,me()):n},ie.translate=function(we){return arguments.length?(r=+we[0],i=+we[1],me()):[r,i]},ie.center=function(we){return arguments.length?(s=we[0]%360*ef,u=we[1]%360*ef,me()):[s*pm,u*pm]},ie.rotate=function(we){return arguments.length?(d=we[0]%360*ef,g=we[1]%360*ef,_=we.length>2?we[2]%360*ef:0,me()):[d*pm,g*pm,_*pm]},ie.precision=function(we){return arguments.length?(J=R7(se,Y=we*we),Ce()):$1(Y)},ie.fitExtent=function(we,Ye){return Fie(ie,we,Ye)},ie.fitSize=function(we,Ye){return pLe(ie,we,Ye)};function me(){P=Mie(E=eLe(d,g,_),e);var we=e(s,u);return o=r-we[0]*n,a=i+we[1]*n,Ce()}function Ce(){return re=ue=null,ie}return function(){return e=t.apply(this,arguments),ie.invert=e.invert&&ce,me()}}function kie(t){return function(e,n){var r=es(e),i=es(n),o=t(r*i);return[o*i*ts(e),o*ts(n)]}}function zie(t){return function(e,n){var r=$1(e*e+n*n),i=t(r),o=ts(i),a=es(i);return[f1(e*o,r*a),t_(r&&n*o/r)]}}var xLe=kie(function(t){return $1(2/(1+t))});xLe.invert=zie(function(t){return 2*t_(t/2)});var Uie=kie(function(t){return(t=Iie(t))&&t/ts(t)});Uie.invert=zie(function(t){return t});function bLe(){return yLe(Uie).scale(79.4188).clipAngle(180-.001)}function L7(t,e){return[t,e]}L7.invert=L7;function G6(t,e,n){n=n||{};var r=n.units||"kilometers",i=n.steps||8;if(!t)throw new Error("geojson is required");if(typeof n!="object")throw new Error("options must be an object");if(typeof i!="number")throw new Error("steps must be an number");if(e===void 0)throw new Error("radius is required");if(i<=0)throw new Error("steps must be greater than 0");var o=[];switch(t.type){case"GeometryCollection":return XE(t,function(a){var s=IC(a,e,r,i);s&&o.push(s)}),vf(o);case"FeatureCollection":return G0(t,function(a){var s=IC(a,e,r,i);s&&G0(s,function(u){u&&o.push(u)})}),vf(o)}return IC(t,e,r,i)}function IC(t,e,n,r){var i=t.properties||{},o=t.type==="Feature"?t.geometry:t;if(o.type==="GeometryCollection"){var a=[];return XE(t,function(D){var V=IC(D,e,n,r);V&&a.push(V)}),vf(a)}var s=wLe(o),u={type:o.type,coordinates:jie(o.coordinates,s)},d=new R6,g=d.read(u),_=tR(WE(e,n),"meters"),E=$s.bufferOp(g,_,r),P=new fie;if(E=P.write(E),!Gie(E.coordinates)){var O={type:E.type,coordinates:Vie(E.coordinates,s)};return Kl(O,i)}}function Gie(t){return Array.isArray(t[0])?Gie(t[0]):isNaN(t[0])}function jie(t,e){return typeof t[0]!="object"?e(t):t.map(function(n){return jie(n,e)})}function Vie(t,e){return typeof t[0]!="object"?e.invert(t):t.map(function(n){return Vie(n,e)})}function wLe(t){var e=lR(t).geometry.coordinates,n=[-e[0],-e[1]];return bLe().rotate(n).scale(na)}const ELe=Object.freeze(Object.defineProperty({__proto__:null,default:G6},Symbol.toStringTag,{value:"Module"})),$ie=ti(ELe),j6=ti(CMe);Object.defineProperty(dR,"__esModule",{value:!0});dR.SplitPolygonMode=void 0;var SLe=Cg(DRe),TLe=Cg(u6),CLe=Cg($ie),PLe=Cg(j6),ILe=rl,MLe=Cg(Kd),D7=Cg(Lc),OLe=Cg(rR),RLe=Cg(E6),B7=Cg(qre),LLe=Ai,DLe=So,BLe=Rc;function Cg(t){return t&&t.__esModule?t:{default:t}}function MC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?MC=function(n){return typeof n}:MC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},MC(t)}function NLe(t){return zLe(t)||kLe(t)||Hie(t)||FLe()}function FLe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kLe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function zLe(t){if(Array.isArray(t))return Bk(t)}function ULe(t,e){return VLe(t)||jLe(t,e)||Hie(t,e)||GLe()}function GLe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Hie(t,e){if(t){if(typeof t=="string")return Bk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bk(t,e)}}function Bk(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function jLe(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,o=void 0;try{for(var a=t[Symbol.iterator](),s;!(r=(s=a.next()).done)&&(n.push(s.value),!(e&&n.length===e));r=!0);}catch(u){i=!0,o=u}finally{try{!r&&a.return!=null&&a.return()}finally{if(i)throw o}}return n}}function VLe(t){if(Array.isArray(t))return t}function $Le(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function N7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function HLe(t,e,n){return e&&N7(t.prototype,e),n&&N7(t,n),t}function WLe(t){return function(){var e=kI(t),n;if(ZLe()){var r=kI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return qLe(this,n)}}function qLe(t,e){return e&&(MC(e)==="object"||typeof e=="function")?e:XLe(t)}function XLe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ZLe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function kI(t){return kI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},kI(t)}function YLe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Nk(t,e)}function Nk(t,e){return Nk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Nk(t,e)}var QLe=function(t){YLe(n,t);var e=WLe(n);function n(){return $Le(this,n),e.apply(this,arguments)}return HLe(n,[{key:"calculateMapCoords",value:function(i,o,a){var s=a.modeConfig;if(!s||!s.lock90Degree||!i.length)return o;if(i.length===1){var u=i[0],d=this.getSelectedGeometry(a),g=(0,RLe.default)(d),_=g.type==="FeatureCollection"?g.features:[g],E=Number.MAX_SAFE_INTEGER,P=null;if(_.forEach(function(Y){var J=(0,B7.default)(Y,u),re=(0,D7.default)(J,u);E>re&&(E=re,P=J)}),P){var O=(0,MLe.default)(u,P),D=(0,D7.default)(u,o,{units:"meters"});return(0,OLe.default)(u,D,O,{units:"meters"}).geometry.coordinates}return o}var V=i[i.length-1],k=(0,LLe.generatePointsParallelToLinePoints)(i[i.length-2],V,o),F=ULe(k,1),z=F[0],X=(0,B7.default)((0,ILe.lineString)([V,z]),o).geometry.coordinates;return X}},{key:"getGuides",value:function(i){var o=this.getClickSequence(),a={type:"FeatureCollection",features:[]};if(o.length===0||!i.lastPointerMoveEvent)return a;var s=i.lastPointerMoveEvent.mapCoords;return a.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(NLe(o),[this.calculateMapCoords(o,s,i)])}}),a}},{key:"handleClick",value:function(i,o){var a=this.getTentativeGuide(o),s=this.getSelectedGeometry(o);if(!s){console.warn("A polygon must be selected for splitting");return}var u=this.getClickSequence();a&&a.geometry.type==="LineString"?u.push(a.geometry.coordinates[a.geometry.coordinates.length-1]):this.addClickSequence(i);var d={type:"Point",coordinates:u[u.length-1]},g=(0,SLe.default)(d,s);if(u.length>1&&a&&!g){this.resetClickSequence();var _=(0,PLe.default)(a,s);if(_.features.length===0)return;var E=this.splitPolygon(a,o);E&&o.onEdit(E)}}},{key:"handlePointerMove",value:function(i,o){o.onUpdateCursor("cell")}},{key:"splitPolygon",value:function(i,o){var a=this.getSelectedGeometry(o),s=o.selectedIndexes[0],u=o.modeConfig||{},d=u.gap,g=d===void 0?.1:d,_=u.units,E=_===void 0?"centimeters":_;g===0&&(g=.1,E="centimeters");var P=(0,CLe.default)(i,g,{units:E}),O=(0,TLe.default)(a,P);if(!O)return console.warn("Canceling edit. Split Polygon erased"),null;var D=O.geometry,V=D.type,k=D.coordinates,F=[];V==="Polygon"?F=k.map(function(Y){return[Y]}):F=k.reduce(function(Y,J){return J.forEach(function(re){Y.push([re])}),Y},[]);var z=new BLe.ImmutableFeatureCollection(o.data).replaceGeometry(s,{type:"MultiPolygon",coordinates:F}),X={updatedData:z.getObject(),editType:"split",editContext:{featureIndexes:[s]}};return X}}]),n}(DLe.GeoJsonEditMode);dR.SplitPolygonMode=QLe;var TR={};Object.defineProperty(TR,"__esModule",{value:!0});TR.ExtrudeMode=void 0;var KLe=e3e(Kd),vb=Ai,JLe=k1,yB=Rc;function e3e(t){return t&&t.__esModule?t:{default:t}}function OC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?OC=function(n){return typeof n}:OC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},OC(t)}function F7(t){return r3e(t)||n3e(t)||Wie(t)||t3e()}function t3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function n3e(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function r3e(t){if(Array.isArray(t))return Fk(t)}function Sy(t,e){return s3e(t)||o3e(t,e)||Wie(t,e)||i3e()}function i3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wie(t,e){if(t){if(typeof t=="string")return Fk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fk(t,e)}}function Fk(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function o3e(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,o=void 0;try{for(var a=t[Symbol.iterator](),s;!(r=(s=a.next()).done)&&(n.push(s.value),!(e&&n.length===e));r=!0);}catch(u){i=!0,o=u}finally{try{!r&&a.return!=null&&a.return()}finally{if(i)throw o}}return n}}function s3e(t){if(Array.isArray(t))return t}function a3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function k7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function l3e(t,e,n){return e&&k7(t.prototype,e),n&&k7(t,n),t}function u3e(t){return function(){var e=zI(t),n;if(f3e()){var r=zI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return c3e(this,n)}}function c3e(t,e){return e&&(OC(e)==="object"||typeof e=="function")?e:qie(t)}function qie(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function zI(t){return zI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},zI(t)}function h3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&kk(t,e)}function kk(t,e){return kk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},kk(t,e)}function d3e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var p3e=function(t){h3e(n,t);var e=u3e(n);function n(){var r;a3e(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=e.call.apply(e,[this].concat(o)),d3e(qie(r),"isPointAdded",!1),r}return l3e(n,[{key:"handleDragging",value:function(i,o){var a=(0,vb.getPickedEditHandle)(i.pointerDownPicks);if(a){var s=a.properties.featureIndex,u=a.properties.positionIndexes,d=this.coordinatesSize(u,s,o.data);u=this.isPointAdded?this.nextPositionIndexes(u,d):u;var g=this.getPointForPositionIndexes(this.prevPositionIndexes(u,d),s,o.data),_=this.getPointForPositionIndexes(u,s,o.data);if(g&&_){var E=(0,vb.generatePointsParallelToLinePoints)(g,_,i.mapCoords),P=Sy(E,2),O=P[0],D=P[1],V=new yB.ImmutableFeatureCollection(o.data).replacePosition(s,this.prevPositionIndexes(u,d),D).replacePosition(s,u,O).getObject();o.onEdit({updatedData:V,editType:"extruding",editContext:{featureIndexes:[s],positionIndexes:this.nextPositionIndexes(u,d),position:O}}),i.cancelPan()}}}},{key:"handleStartDragging",value:function(i,o){var a=o.selectedIndexes,s=(0,vb.getPickedIntermediateEditHandle)(i.picks);if(a.length&&s){var u=s.properties,d=u.positionIndexes,g=u.featureIndex,_=this.coordinatesSize(d,g,o.data),E=this.getPointForPositionIndexes(this.prevPositionIndexes(d,_),g,o.data),P=this.getPointForPositionIndexes(d,g,o.data);if(E&&P){var O=new yB.ImmutableFeatureCollection(o.data);this.isOrthogonal(d,g,_,o.data)||(O=O.addPosition(g,d,P)),this.isOrthogonal(this.prevPositionIndexes(d,_),g,_,o.data)||(O=O.addPosition(g,d,E),this.isPointAdded=!0),o.onEdit({updatedData:O.getObject(),editType:"startExtruding",editContext:{featureIndexes:[g],positionIndexes:d,position:E}})}}}},{key:"handleStopDragging",value:function(i,o){var a=o.selectedIndexes,s=(0,vb.getPickedEditHandle)(i.pointerDownPicks);if(a.length&&s){var u=s.properties.featureIndex,d=s.properties.positionIndexes,g=this.coordinatesSize(d,u,o.data);d=this.isPointAdded?this.nextPositionIndexes(d,g):d;var _=this.getPointForPositionIndexes(this.prevPositionIndexes(d,g),u,o.data),E=this.getPointForPositionIndexes(d,u,o.data);if(_&&E){var P=(0,vb.generatePointsParallelToLinePoints)(_,E,i.mapCoords),O=Sy(P,2),D=O[0],V=O[1],k=new yB.ImmutableFeatureCollection(o.data).replacePosition(u,this.prevPositionIndexes(d,g),V).replacePosition(u,d,D).getObject();o.onEdit({updatedData:k,editType:"extruded",editContext:{featureIndexes:[u],positionIndexes:d,position:D}})}}this.isPointAdded=!1}},{key:"coordinatesSize",value:function(i,o,a){var s=a.features,u=0;if(Array.isArray(i)){var d=s[o],g=d.geometry.coordinates;if(i.length===3){var _=Sy(i,2),E=_[0],P=_[1];g.length&&g[E].length&&(u=g[E][P].length)}else{var O=Sy(i,1),D=O[0];g.length&&g[D].length&&(u=g[D].length)}}return u}},{key:"getBearing",value:function(i,o){var a=(0,KLe.default)(i,o);return a<0?Math.floor(360+a):Math.floor(a)}},{key:"isOrthogonal",value:function(i,o,a,s){if(!Array.isArray(i))return!1;i[i.length-1]===a-1&&(i[i.length-1]=0);var u=this.getPointForPositionIndexes(this.prevPositionIndexes(i,a),o,s),d=this.getPointForPositionIndexes(this.nextPositionIndexes(i,a),o,s),g=this.getPointForPositionIndexes(i,o,s),_=this.getBearing(g,u),E=this.getBearing(g,d);return[89,90,91,269,270,271].includes(Math.abs(_-E))}},{key:"nextPositionIndexes",value:function(i,o){if(!Array.isArray(i))return[];var a=F7(i);return a.length&&(a[a.length-1]=a[a.length-1]===o-1?0:a[a.length-1]+1),a}},{key:"prevPositionIndexes",value:function(i,o){if(!Array.isArray(i))return[];var a=F7(i);return a.length&&(a[a.length-1]=a[a.length-1]===0?o-2:a[a.length-1]-1),a}},{key:"getPointForPositionIndexes",value:function(i,o,a){var s=a.features,u;if(Array.isArray(i)){var d=s[o],g=d.geometry.coordinates;if(i.length===3){var _=Sy(i,3),E=_[0],P=_[1],O=_[2];g.length&&g[E].length&&(u=g[E][P][O])}else{var D=Sy(i,2),V=D[0],k=D[1];g.length&&g[V].length&&(u=g[V][k])}}return u}}]),n}(JLe.ModifyMode);TR.ExtrudeMode=p3e;var CR={};Object.defineProperty(CR,"__esModule",{value:!0});CR.ElevationMode=void 0;var z7=Ai,g3e=k1;function RC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?RC=function(n){return typeof n}:RC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},RC(t)}function m3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function U7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function A3e(t,e,n){return e&&U7(t.prototype,e),n&&U7(t,n),t}function xv(t,e,n){return typeof Reflect<"u"&&Reflect.get?xv=Reflect.get:xv=function(i,o,a){var s=_3e(i,o);if(s){var u=Object.getOwnPropertyDescriptor(s,o);return u.get?u.get.call(a):u.value}},xv(t,e,n||t)}function _3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=Wm(t),t!==null););return t}function y3e(t){return function(){var e=Wm(t),n;if(b3e()){var r=Wm(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return v3e(this,n)}}function v3e(t,e){return e&&(RC(e)==="object"||typeof e=="function")?e:x3e(t)}function x3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function b3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function Wm(t){return Wm=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},Wm(t)}function w3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&zk(t,e)}function zk(t,e){return zk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},zk(t,e)}function E3e(t){var e=t.pointerDownScreenCoords,n=t.screenCoords;return 10*(e[1]-n[1])}var S3e=function(t){w3e(n,t);var e=y3e(n);function n(){return m3e(this,n),e.apply(this,arguments)}return A3e(n,[{key:"makeElevatedEvent",value:function(i,o,a){var s=a.modeConfig||{},u=s.minElevation,d=u===void 0?0:u,g=s.maxElevation,_=g===void 0?2e4:g,E=s.calculateElevationChange,P=E===void 0?E3e:E;if(!i.pointerDownScreenCoords)return i;var O=o.length===3?o[2]:0;return O+=P({pointerDownScreenCoords:i.pointerDownScreenCoords,screenCoords:i.screenCoords}),O=Math.min(O,_),O=Math.max(O,d),Object.assign({},i,{mapCoords:[o[0],o[1],O]})}},{key:"handlePointerMove",value:function(i,o){var a=(0,z7.getPickedEditHandle)(i.pointerDownPicks),s=a?a.geometry.coordinates:i.mapCoords;xv(Wm(n.prototype),"handlePointerMove",this).call(this,this.makeElevatedEvent(i,s,o),o)}},{key:"handleStopDragging",value:function(i,o){var a=(0,z7.getPickedEditHandle)(i.picks),s=a?a.geometry.coordinates:i.mapCoords;xv(Wm(n.prototype),"handleStopDragging",this).call(this,this.makeElevatedEvent(i,s,o),o)}},{key:"getCursor",value:function(i){var o=xv(Wm(n.prototype),"getCursor",this).call(this,i);return o==="cell"&&(o="ns-resize"),o}}],[{key:"calculateElevationChangeWithViewport",value:function(i,o){var a=o.pointerDownScreenCoords,s=o.screenCoords,u=156543.03392*Math.cos(i.latitude*Math.PI/180)/Math.pow(2,i.zoom);return u*(a[1]-s[1])/2}}]),n}(g3e.ModifyMode);CR.ElevationMode=S3e;var PR={},s2={};Object.defineProperty(s2,"__esModule",{value:!0});s2.CompositeMode=void 0;var T3e=So;function LC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?LC=function(n){return typeof n}:LC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},LC(t)}function C3e(t){return M3e(t)||I3e(t)||Xie(t)||P3e()}function P3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function I3e(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function M3e(t){if(Array.isArray(t))return Uk(t)}function O3e(t){if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(t=Xie(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var r,i=!0,o=!1,a;return{s:function(){r=t[Symbol.iterator]()},n:function(){var u=r.next();return i=u.done,u},e:function(u){o=!0,a=u},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(o)throw a}}}}function Xie(t,e){if(t){if(typeof t=="string")return Uk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Uk(t,e)}}function Uk(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function R3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function G7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function L3e(t,e,n){return e&&G7(t.prototype,e),n&&G7(t,n),t}function D3e(t){return function(){var e=UI(t),n;if(N3e()){var r=UI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return B3e(this,n)}}function B3e(t,e){return e&&(LC(e)==="object"||typeof e=="function")?e:Zie(t)}function Zie(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function N3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function UI(t){return UI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},UI(t)}function F3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Gk(t,e)}function Gk(t,e){return Gk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Gk(t,e)}function k3e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var z3e=function(t){F3e(n,t);var e=D3e(n);function n(r){var i;return R3e(this,n),i=e.call(this),k3e(Zie(i),"_modes",void 0),i._modes=r,i}return L3e(n,[{key:"_coalesce",value:function(i){for(var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,a,s=0;s<this._modes.length&&(a=i(this._modes[s]),!(o?o(a):a));s++);return a}},{key:"handleClick",value:function(i,o){this._coalesce(function(a){return a.handleClick(i,o)})}},{key:"handlePointerMove",value:function(i,o){return this._coalesce(function(a){return a.handlePointerMove(i,o)})}},{key:"handleStartDragging",value:function(i,o){return this._coalesce(function(a){return a.handleStartDragging(i,o)})}},{key:"handleStopDragging",value:function(i,o){return this._coalesce(function(a){return a.handleStopDragging(i,o)})}},{key:"handleDragging",value:function(i,o){return this._coalesce(function(a){return a.handleDragging(i,o)})}},{key:"getGuides",value:function(i){var o=[],a=O3e(this._modes),s;try{for(a.s();!(s=a.n()).done;){var u=s.value;o.push.apply(o,C3e(u.getGuides(i).features))}}catch(d){a.e(d)}finally{a.f()}return{type:"FeatureCollection",features:o}}}]),n}(T3e.GeoJsonEditMode);s2.CompositeMode=z3e;Object.defineProperty(PR,"__esModule",{value:!0});PR.TransformMode=void 0;var U3e=rl,j7=z1,vB=QE,xB=KE,G3e=s2;function DC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?DC=function(n){return typeof n}:DC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},DC(t)}function V7(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function j3e(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?V7(Object(n),!0).forEach(function(r){V3e(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):V7(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function V3e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $3e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function $7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function H3e(t,e,n){return e&&$7(t.prototype,e),n&&$7(t,n),t}function Aw(t,e,n){return typeof Reflect<"u"&&Reflect.get?Aw=Reflect.get:Aw=function(i,o,a){var s=W3e(i,o);if(s){var u=Object.getOwnPropertyDescriptor(s,o);return u.get?u.get.call(a):u.value}},Aw(t,e,n||t)}function W3e(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=n_(t),t!==null););return t}function q3e(t){return function(){var e=n_(t),n;if(Y3e()){var r=n_(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return X3e(this,n)}}function X3e(t,e){return e&&(DC(e)==="object"||typeof e=="function")?e:Z3e(t)}function Z3e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Y3e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function n_(t){return n_=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},n_(t)}function Q3e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&jk(t,e)}function jk(t,e){return jk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},jk(t,e)}var K3e=function(t){Q3e(n,t);var e=q3e(n);function n(){return $3e(this,n),e.call(this,[new j7.TranslateMode,new vB.ScaleMode,new xB.RotateMode])}return H3e(n,[{key:"handlePointerMove",value:function(i,o){var a=null;Aw(n_(n.prototype),"handlePointerMove",this).call(this,i,j3e({},o,{onUpdateCursor:function(u){a=u||a}})),o.onUpdateCursor(a)}},{key:"handleStartDragging",value:function(i,o){var a=null,s=null,u=[];this._modes.forEach(function(d){d instanceof j7.TranslateMode?s=d:(d instanceof vB.ScaleMode&&(a=d),u.push(d))}),a instanceof vB.ScaleMode&&!a.isEditHandleSelected()&&u.push(s),u.filter(Boolean).forEach(function(d){return d.handleStartDragging(i,o)})}},{key:"getGuides",value:function(i){var o=Aw(n_(n.prototype),"getGuides",this).call(this,i),a=(this._modes||[]).find(function(u){return u instanceof xB.RotateMode});if(a instanceof xB.RotateMode){var s=o.features.filter(function(u){var d=u.properties||{},g=d.editHandleType,_=d.mode,E=[_];return a.getIsRotating()&&E.push(g),!E.includes("scale")});o=(0,U3e.featureCollection)(s)}return o}}]),n}(G3e.CompositeMode);PR.TransformMode=K3e;var IR={};Object.defineProperty(IR,"__esModule",{value:!0});IR.DrawPointMode=void 0;var J3e=So;function BC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?BC=function(n){return typeof n}:BC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},BC(t)}function eDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function H7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function tDe(t,e,n){return e&&H7(t.prototype,e),n&&H7(t,n),t}function NC(t,e,n){return typeof Reflect<"u"&&Reflect.get?NC=Reflect.get:NC=function(i,o,a){var s=nDe(i,o);if(s){var u=Object.getOwnPropertyDescriptor(s,o);return u.get?u.get.call(a):u.value}},NC(t,e,n||t)}function nDe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=p1(t),t!==null););return t}function rDe(t){return function(){var e=p1(t),n;if(sDe()){var r=p1(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return iDe(this,n)}}function iDe(t,e){return e&&(BC(e)==="object"||typeof e=="function")?e:oDe(t)}function oDe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function p1(t){return p1=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},p1(t)}function aDe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Vk(t,e)}function Vk(t,e){return Vk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Vk(t,e)}var lDe=function(t){aDe(n,t);var e=rDe(n);function n(){return eDe(this,n),e.apply(this,arguments)}return tDe(n,[{key:"createTentativeFeature",value:function(i){var o=i.lastPointerMoveEvent,a=o?[o.mapCoords]:[];return{type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Point",coordinates:a[0]}}}},{key:"handleClick",value:function(i,o){var a=i.mapCoords,s={type:"Point",coordinates:a};o.onEdit(this.getAddFeatureAction(s,o.data))}},{key:"handlePointerMove",value:function(i,o){o.onUpdateCursor("cell"),NC(p1(n.prototype),"handlePointerMove",this).call(this,i,o)}}]),n}(J3e.GeoJsonEditMode);IR.DrawPointMode=lDe;var MR={};Object.defineProperty(MR,"__esModule",{value:!0});MR.DrawLineStringMode=void 0;var uDe=Ai,cDe=So;function FC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?FC=function(n){return typeof n}:FC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},FC(t)}function ZS(t){return pDe(t)||dDe(t)||hDe(t)||fDe()}function fDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hDe(t,e){if(t){if(typeof t=="string")return $k(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $k(t,e)}}function dDe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function pDe(t){if(Array.isArray(t))return $k(t)}function $k(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function gDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function W7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function mDe(t,e,n){return e&&W7(t.prototype,e),n&&W7(t,n),t}function ADe(t){return function(){var e=GI(t),n;if(vDe()){var r=GI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return _De(this,n)}}function _De(t,e){return e&&(FC(e)==="object"||typeof e=="function")?e:yDe(t)}function yDe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function GI(t){return GI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},GI(t)}function xDe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Hk(t,e)}function Hk(t,e){return Hk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Hk(t,e)}var bDe=function(t){xDe(n,t);var e=ADe(n);function n(){return gDe(this,n),e.apply(this,arguments)}return mDe(n,[{key:"handleClick",value:function(i,o){var a=i.picks,s=(0,uDe.getPickedEditHandle)(a),u=!1;s||(this.addClickSequence(i),u=!0);var d=this.getClickSequence();if(d.length>1&&s&&Array.isArray(s.properties.positionIndexes)&&s.properties.positionIndexes[0]===d.length-1){var g={type:"LineString",coordinates:ZS(d)};this.resetClickSequence();var _=this.getAddFeatureAction(g,o.data);_&&o.onEdit(_)}else u&&o.onEdit({updatedData:o.data,editType:"addTentativePosition",editContext:{position:i.mapCoords}})}},{key:"handleKeyUp",value:function(i,o){var a=i.key;if(a==="Enter"){var s=this.getClickSequence();if(s.length>1){var u={type:"LineString",coordinates:ZS(s)};this.resetClickSequence();var d=this.getAddFeatureAction(u,o.data);d&&o.onEdit(d)}}}},{key:"getGuides",value:function(i){var o,a=i.lastPointerMoveEvent,s=this.getClickSequence(),u=a?[a.mapCoords]:[],d={type:"FeatureCollection",features:[]},g;s.length>0&&(g={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(ZS(s),u)}}),g&&d.features.push(g);var _=s.map(function(E,P){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[P]},geometry:{type:"Point",coordinates:E}}});return(o=d.features).push.apply(o,ZS(_)),d}},{key:"handlePointerMove",value:function(i,o){o.onUpdateCursor("cell")}}]),n}(cDe.GeoJsonEditMode);MR.DrawLineStringMode=bDe;var H1={};Object.defineProperty(H1,"__esModule",{value:!0});H1.DrawPolygonMode=void 0;var wDe=TDe(j6),q7=rl,EDe=Ai,SDe=So;function TDe(t){return t&&t.__esModule?t:{default:t}}function kC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?kC=function(n){return typeof n}:kC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},kC(t)}function Ty(t){return MDe(t)||IDe(t)||PDe(t)||CDe()}function CDe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function PDe(t,e){if(t){if(typeof t=="string")return Wk(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wk(t,e)}}function IDe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function MDe(t){if(Array.isArray(t))return Wk(t)}function Wk(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function ODe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function X7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function RDe(t,e,n){return e&&X7(t.prototype,e),n&&X7(t,n),t}function zC(t,e,n){return typeof Reflect<"u"&&Reflect.get?zC=Reflect.get:zC=function(i,o,a){var s=LDe(i,o);if(s){var u=Object.getOwnPropertyDescriptor(s,o);return u.get?u.get.call(a):u.value}},zC(t,e,n||t)}function LDe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=g1(t),t!==null););return t}function DDe(t){return function(){var e=g1(t),n;if(FDe()){var r=g1(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return BDe(this,n)}}function BDe(t,e){return e&&(kC(e)==="object"||typeof e=="function")?e:NDe(t)}function NDe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function FDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function g1(t){return g1=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},g1(t)}function kDe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&qk(t,e)}function qk(t,e){return qk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},qk(t,e)}var zDe=function(t){kDe(n,t);var e=DDe(n);function n(){return ODe(this,n),e.apply(this,arguments)}return RDe(n,[{key:"createTentativeFeature",value:function(i){var o=i.lastPointerMoveEvent,a=this.getClickSequence(),s=o?[o.mapCoords]:[],u;return a.length===1||a.length===2?u={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(Ty(a),s)}}:a.length>2&&(u={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Polygon",coordinates:[[].concat(Ty(a),s,[a[0]])]}}),u}},{key:"getGuides",value:function(i){var o,a=this.getClickSequence(),s={type:"FeatureCollection",features:[]},u=this.createTentativeFeature(i);u&&s.features.push(u);var d=a.map(function(g,_){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[_]},geometry:{type:"Point",coordinates:g}}});return(o=s.features).push.apply(o,Ty(d)),s}},{key:"handleClick",value:function(i,o){var a=i.picks,s=(0,EDe.getPickedEditHandle)(a),u=this.getClickSequence(),d=!1;if(u.length>2&&o.modeConfig&&o.modeConfig.preventOverlappingLines){var g=(0,q7.lineString)([u[u.length-1],i.mapCoords]),_=(0,q7.lineString)(Ty(u.slice(0,u.length-1))),E=(0,wDe.default)(g,_);E.features.length>0&&(d=!0)}var P=!1;if(!s&&!d&&(this.addClickSequence(i),P=!0),u.length>2&&s&&Array.isArray(s.properties.positionIndexes)&&(s.properties.positionIndexes[0]===0||s.properties.positionIndexes[0]===u.length-1)){var O={type:"Polygon",coordinates:[[].concat(Ty(u),[u[0]])]};this.resetClickSequence();var D=this.getAddFeatureOrBooleanPolygonAction(O,o);D&&o.onEdit(D)}else P&&o.onEdit({updatedData:o.data,editType:"addTentativePosition",editContext:{position:i.mapCoords}})}},{key:"handleKeyUp",value:function(i,o){if(i.key==="Enter"){var a=this.getClickSequence();if(a.length>2){var s={type:"Polygon",coordinates:[[].concat(Ty(a),[a[0]])]};this.resetClickSequence();var u=this.getAddFeatureOrBooleanPolygonAction(s,o);u&&o.onEdit(u)}}}},{key:"handlePointerMove",value:function(i,o){o.onUpdateCursor("cell"),zC(g1(n.prototype),"handlePointerMove",this).call(this,i,o)}}]),n}(SDe.GeoJsonEditMode);H1.DrawPolygonMode=zDe;var OR={},np={};Object.defineProperty(np,"__esModule",{value:!0});np.TwoClickPolygonMode=void 0;var UDe=So;function UC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?UC=function(n){return typeof n}:UC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},UC(t)}function GDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Z7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function jDe(t,e,n){return e&&Z7(t.prototype,e),n&&Z7(t,n),t}function GC(t,e,n){return typeof Reflect<"u"&&Reflect.get?GC=Reflect.get:GC=function(i,o,a){var s=VDe(i,o);if(s){var u=Object.getOwnPropertyDescriptor(s,o);return u.get?u.get.call(a):u.value}},GC(t,e,n||t)}function VDe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=m1(t),t!==null););return t}function $De(t){return function(){var e=m1(t),n;if(qDe()){var r=m1(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return HDe(this,n)}}function HDe(t,e){return e&&(UC(e)==="object"||typeof e=="function")?e:WDe(t)}function WDe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function qDe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function m1(t){return m1=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},m1(t)}function XDe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Xk(t,e)}function Xk(t,e){return Xk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Xk(t,e)}var ZDe=function(t){XDe(n,t);var e=$De(n);function n(){return GDe(this,n),e.apply(this,arguments)}return jDe(n,[{key:"handleClick",value:function(i,o){o.modeConfig&&o.modeConfig.dragToDraw||(this.addClickSequence(i),this.checkAndFinishPolygon(o))}},{key:"handleStartDragging",value:function(i,o){!o.modeConfig||!o.modeConfig.dragToDraw||(this.addClickSequence(i),i.cancelPan())}},{key:"handleStopDragging",value:function(i,o){!o.modeConfig||!o.modeConfig.dragToDraw||(this.addClickSequence(i),this.checkAndFinishPolygon(o))}},{key:"checkAndFinishPolygon",value:function(i){var o=this.getClickSequence(),a=this.getTentativeGuide(i);if(o.length>1&&a&&a.geometry.type==="Polygon"){var s={type:"Feature",properties:{shape:a.properties.shape},geometry:{type:"Polygon",coordinates:a.geometry.coordinates}},u=this.getAddFeatureOrBooleanPolygonAction(s,i);this.resetClickSequence(),u&&i.onEdit(u)}}},{key:"getGuides",value:function(i){var o=i.lastPointerMoveEvent,a=i.modeConfig,s=this.getClickSequence(),u={type:"FeatureCollection",features:[]};if(s.length===0)return u;var d=s[0],g=o.mapCoords,_=this.getTwoClickPolygon(d,g,a);return _&&u.features.push({type:"Feature",properties:{shape:_.properties&&_.properties.shape,guideType:"tentative"},geometry:_.geometry}),u}},{key:"getTwoClickPolygon",value:function(i,o,a){return null}},{key:"handlePointerMove",value:function(i,o){o.onUpdateCursor("cell"),GC(m1(n.prototype),"handlePointerMove",this).call(this,i,o)}},{key:"createTentativeFeature",value:function(i){var o=i.lastPointerMoveEvent,a=this.getClickSequence(),s=o?[o.mapCoords]:[],u;return a.length===1&&(u=this.getTwoClickPolygon(a[0],s[0],i.modeConfig)),u}}]),n}(UDe.GeoJsonEditMode);np.TwoClickPolygonMode=ZDe;Object.defineProperty(OR,"__esModule",{value:!0});OR.DrawRectangleMode=void 0;var YDe=KDe(p_),QDe=np;function KDe(t){return t&&t.__esModule?t:{default:t}}function jC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?jC=function(n){return typeof n}:jC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},jC(t)}function JDe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function eBe(t,e,n){return e&&Y7(t.prototype,e),n&&Y7(t,n),t}function tBe(t){return function(){var e=jI(t),n;if(iBe()){var r=jI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return nBe(this,n)}}function nBe(t,e){return e&&(jC(e)==="object"||typeof e=="function")?e:rBe(t)}function rBe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function iBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function jI(t){return jI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},jI(t)}function oBe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Zk(t,e)}function Zk(t,e){return Zk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Zk(t,e)}var sBe=function(t){oBe(n,t);var e=tBe(n);function n(){return JDe(this,n),e.apply(this,arguments)}return eBe(n,[{key:"getTwoClickPolygon",value:function(i,o,a){var s=(0,YDe.default)([i[0],i[1],o[0],o[1]]);return s.properties=s.properties||{},s.properties.shape="Rectangle",s}}]),n}(QDe.TwoClickPolygonMode);OR.DrawRectangleMode=sBe;var RR={};function aBe(t,e,n){n===void 0&&(n={});for(var r=xf(t),i=r.coordinates,o=0,a=0;a<i.length&&!(e>=o&&a===i.length-1);a++)if(o>=e){var s=e-o;if(s){var u=qE(i[a],i[a-1])-180,d=$v(i[a],s,u,n);return d}else return zo(i[a])}else o+=ch(i[a],i[a+1],n);return zo(i[i.length-1])}const lBe=Object.freeze(Object.defineProperty({__proto__:null,default:aBe},Symbol.toStringTag,{value:"Module"})),Yie=ti(lBe);Object.defineProperty(RR,"__esModule",{value:!0});RR.DrawSquareMode=void 0;var uBe=V6(p_),Q7=V6(Lc),cBe=V6(Yie),xb=rl,fBe=np;function V6(t){return t&&t.__esModule?t:{default:t}}function VC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?VC=function(n){return typeof n}:VC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},VC(t)}function hBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function K7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function dBe(t,e,n){return e&&K7(t.prototype,e),n&&K7(t,n),t}function pBe(t){return function(){var e=VI(t),n;if(ABe()){var r=VI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return gBe(this,n)}}function gBe(t,e){return e&&(VC(e)==="object"||typeof e=="function")?e:mBe(t)}function mBe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ABe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function VI(t){return VI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},VI(t)}function _Be(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Yk(t,e)}function Yk(t,e){return Yk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Yk(t,e)}var yBe=function(t){_Be(n,t);var e=pBe(n);function n(){return hBe(this,n),e.apply(this,arguments)}return dBe(n,[{key:"getTwoClickPolygon",value:function(i,o,a){var s=[o[0],i[1]],u=[i[0],o[1]],d=(0,Q7.default)((0,xb.point)(s),(0,xb.point)(i)),g=(0,Q7.default)((0,xb.point)(u),(0,xb.point)(i)),_=d<=g?d:g,E=d<=g?s:u,P=(0,xb.lineString)([E,o]),O=(0,cBe.default)(P,_),D=O.geometry.coordinates,V=(0,uBe.default)([i[0],i[1],D[0],D[1]]);return V.properties=V.properties||{},V.properties.shape="Square",V}}]),n}(fBe.TwoClickPolygonMode);RR.DrawSquareMode=yBe;var LR={};Object.defineProperty(LR,"__esModule",{value:!0});LR.DrawRectangleFromCenterMode=void 0;var vBe=bBe(p_),xBe=np;function bBe(t){return t&&t.__esModule?t:{default:t}}function $C(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?$C=function(n){return typeof n}:$C=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},$C(t)}function wBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function J7(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function EBe(t,e,n){return e&&J7(t.prototype,e),n&&J7(t,n),t}function SBe(t){return function(){var e=$I(t),n;if(PBe()){var r=$I(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return TBe(this,n)}}function TBe(t,e){return e&&($C(e)==="object"||typeof e=="function")?e:CBe(t)}function CBe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function PBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function $I(t){return $I=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},$I(t)}function IBe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Qk(t,e)}function Qk(t,e){return Qk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Qk(t,e)}var MBe=function(t){IBe(n,t);var e=SBe(n);function n(){return wBe(this,n),e.apply(this,arguments)}return EBe(n,[{key:"getTwoClickPolygon",value:function(i,o,a){var s=i[0]>o[0]?i[0]+Math.abs(i[0]-o[0]):i[0]-Math.abs(i[0]-o[0]),u=i[1]>o[1]?i[1]+Math.abs(i[1]-o[1]):i[1]-Math.abs(i[1]-o[1]),d=(0,vBe.default)([s,u,o[0],o[1]]);return d.properties=d.properties||{},d.properties.shape="Rectangle",d}}]),n}(xBe.TwoClickPolygonMode);LR.DrawRectangleFromCenterMode=MBe;var DR={};Object.defineProperty(DR,"__esModule",{value:!0});DR.DrawSquareFromCenterMode=void 0;var OBe=$6(p_),eW=$6(Lc),RBe=$6(Yie),bb=rl,LBe=np;function $6(t){return t&&t.__esModule?t:{default:t}}function HC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?HC=function(n){return typeof n}:HC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},HC(t)}function DBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function tW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function BBe(t,e,n){return e&&tW(t.prototype,e),n&&tW(t,n),t}function NBe(t){return function(){var e=HI(t),n;if(zBe()){var r=HI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return FBe(this,n)}}function FBe(t,e){return e&&(HC(e)==="object"||typeof e=="function")?e:kBe(t)}function kBe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function zBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function HI(t){return HI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},HI(t)}function UBe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Kk(t,e)}function Kk(t,e){return Kk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Kk(t,e)}var GBe=function(t){UBe(n,t);var e=NBe(n);function n(){return DBe(this,n),e.apply(this,arguments)}return BBe(n,[{key:"getTwoClickPolygon",value:function(i,o,a){var s=[o[0],i[1]],u=[i[0],o[1]],d=(0,eW.default)((0,bb.point)(s),(0,bb.point)(i)),g=(0,eW.default)((0,bb.point)(u),(0,bb.point)(i)),_=d<=g?d:g,E=d<=g?s:u,P=(0,bb.lineString)([E,o]),O=(0,RBe.default)(P,_),D=O.geometry.coordinates,V=i[0]>D[0]?i[0]+Math.abs(i[0]-D[0]):i[0]-Math.abs(i[0]-D[0]),k=i[1]>D[1]?i[1]+Math.abs(i[1]-D[1]):i[1]-Math.abs(i[1]-D[1]),F=(0,OBe.default)([V,k,D[0],D[1]]);return F.properties=F.properties||{},F.properties.shape="Square",F}}]),n}(LBe.TwoClickPolygonMode);DR.DrawSquareFromCenterMode=GBe;var BR={};Object.defineProperty(BR,"__esModule",{value:!0});BR.DrawCircleByDiameterMode=void 0;var jBe=Qie(_6),VBe=Qie(Lc),$Be=So,HBe=np;function Qie(t){return t&&t.__esModule?t:{default:t}}function WC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?WC=function(n){return typeof n}:WC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},WC(t)}function WBe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function nW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function qBe(t,e,n){return e&&nW(t.prototype,e),n&&nW(t,n),t}function XBe(t){return function(){var e=WI(t),n;if(QBe()){var r=WI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return ZBe(this,n)}}function ZBe(t,e){return e&&(WC(e)==="object"||typeof e=="function")?e:YBe(t)}function YBe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function QBe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function WI(t){return WI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},WI(t)}function KBe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Jk(t,e)}function Jk(t,e){return Jk=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},Jk(t,e)}var JBe=function(t){KBe(n,t);var e=XBe(n);function n(){return WBe(this,n),e.apply(this,arguments)}return qBe(n,[{key:"getTwoClickPolygon",value:function(i,o,a){var s=a||{},u=s.steps,d=u===void 0?64:u,g={steps:d};d<4&&(console.warn("Minimum steps to draw a circle is 4 "),g.steps=4);var _=(0,$Be.getIntermediatePosition)(i,o),E=Math.max((0,VBe.default)(i,_),.001),P=(0,jBe.default)(_,E,g);return P.properties=P.properties||{},P.properties.shape="Circle",P}}]),n}(HBe.TwoClickPolygonMode);BR.DrawCircleByDiameterMode=JBe;var NR={};Object.defineProperty(NR,"__esModule",{value:!0});NR.DrawCircleFromCenterMode=void 0;var eNe=Kie(_6),tNe=Kie(Lc),nNe=np;function Kie(t){return t&&t.__esModule?t:{default:t}}function qC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?qC=function(n){return typeof n}:qC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},qC(t)}function rNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function iNe(t,e,n){return e&&rW(t.prototype,e),n&&rW(t,n),t}function oNe(t){return function(){var e=qI(t),n;if(lNe()){var r=qI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return sNe(this,n)}}function sNe(t,e){return e&&(qC(e)==="object"||typeof e=="function")?e:aNe(t)}function aNe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function qI(t){return qI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},qI(t)}function uNe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&e4(t,e)}function e4(t,e){return e4=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},e4(t,e)}var cNe=function(t){uNe(n,t);var e=oNe(n);function n(){return rNe(this,n),e.apply(this,arguments)}return iNe(n,[{key:"getTwoClickPolygon",value:function(i,o,a){var s=a||{},u=s.steps,d=u===void 0?64:u,g={steps:d};d<4&&(console.warn("Minimum steps to draw a circle is 4 "),g.steps=4);var _=Math.max((0,tNe.default)(i,o),.001),E=(0,eNe.default)(i,_,g);return E.properties=E.properties||{},E.properties.shape="Circle",E}}]),n}(nNe.TwoClickPolygonMode);NR.DrawCircleFromCenterMode=cNe;var FR={};function fNe(t,e,n,r){r=r||{};var i=r.steps||64,o=r.units||"kilometers",a=r.angle||0,s=r.pivot||t,u=r.properties||t.properties||{};if(!t)throw new Error("center is required");if(!e)throw new Error("xSemiAxis is required");if(!n)throw new Error("ySemiAxis is required");if(!d_(r))throw new Error("options must be an object");if(!eA(i))throw new Error("steps must be a number");if(!eA(a))throw new Error("angle must be a number");var d=Ea(t);if(o==="degrees")var g=wa(a);else e=qw(t,e,90,{units:o}),n=qw(t,n,0,{units:o}),e=Ea(e)[0]-d[0],n=Ea(n)[1]-d[1];for(var _=[],E=0;E<i;E+=1){var P=E*-360/i,O=e*n/Math.sqrt(Math.pow(n,2)+Math.pow(e,2)*Math.pow(iW(P),2)),D=e*n/Math.sqrt(Math.pow(e,2)+Math.pow(n,2)/Math.pow(iW(P),2));if(P<-90&&P>=-270&&(O=-O),P<-180&&P>=-360&&(D=-D),o==="degrees"){var V=O*Math.cos(g)+D*Math.sin(g),k=D*Math.cos(g)-O*Math.sin(g);O=V,D=k}_.push([O+d[0],D+d[1]])}return _.push(_[0]),o==="degrees"?Th([_],u):tie(Th([_],u),a,{pivot:s})}function iW(t){var e=t*Math.PI/180;return Math.tan(e)}const hNe=Object.freeze(Object.defineProperty({__proto__:null,default:fNe},Symbol.toStringTag,{value:"Module"})),Jie=ti(hNe);Object.defineProperty(FR,"__esModule",{value:!0});FR.DrawEllipseByBoundingBoxMode=void 0;var dNe=H6(p_),oW=H6(Lc),pNe=H6(Jie),YS=rl,gNe=So,mNe=np;function H6(t){return t&&t.__esModule?t:{default:t}}function XC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?XC=function(n){return typeof n}:XC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},XC(t)}function ANe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function sW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _Ne(t,e,n){return e&&sW(t.prototype,e),n&&sW(t,n),t}function yNe(t){return function(){var e=XI(t),n;if(bNe()){var r=XI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return vNe(this,n)}}function vNe(t,e){return e&&(XC(e)==="object"||typeof e=="function")?e:xNe(t)}function xNe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function XI(t){return XI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},XI(t)}function wNe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&t4(t,e)}function t4(t,e){return t4=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},t4(t,e)}var ENe=function(t){wNe(n,t);var e=yNe(n);function n(){return ANe(this,n),e.apply(this,arguments)}return _Ne(n,[{key:"getTwoClickPolygon",value:function(i,o,a){var s=Math.min(i[0],o[0]),u=Math.min(i[1],o[1]),d=Math.max(i[0],o[0]),g=Math.max(i[1],o[1]),_=(0,dNe.default)([s,u,d,g]).geometry.coordinates[0],E=(0,gNe.getIntermediatePosition)(i,o),P=Math.max((0,oW.default)((0,YS.point)(_[0]),(0,YS.point)(_[1])),.001),O=Math.max((0,oW.default)((0,YS.point)(_[0]),(0,YS.point)(_[3])),.001);return(0,pNe.default)(E,P,O)}}]),n}(mNe.TwoClickPolygonMode);FR.DrawEllipseByBoundingBoxMode=ENe;var kR={},a2={};Object.defineProperty(a2,"__esModule",{value:!0});a2.ThreeClickPolygonMode=void 0;var SNe=So;function ZC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?ZC=function(n){return typeof n}:ZC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},ZC(t)}function TNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function aW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function CNe(t,e,n){return e&&aW(t.prototype,e),n&&aW(t,n),t}function YC(t,e,n){return typeof Reflect<"u"&&Reflect.get?YC=Reflect.get:YC=function(i,o,a){var s=PNe(i,o);if(s){var u=Object.getOwnPropertyDescriptor(s,o);return u.get?u.get.call(a):u.value}},YC(t,e,n||t)}function PNe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=A1(t),t!==null););return t}function INe(t){return function(){var e=A1(t),n;if(RNe()){var r=A1(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return MNe(this,n)}}function MNe(t,e){return e&&(ZC(e)==="object"||typeof e=="function")?e:ONe(t)}function ONe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function RNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function A1(t){return A1=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},A1(t)}function LNe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&n4(t,e)}function n4(t,e){return n4=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},n4(t,e)}var DNe=function(t){LNe(n,t);var e=INe(n);function n(){return TNe(this,n),e.apply(this,arguments)}return CNe(n,[{key:"handleClick",value:function(i,o){this.addClickSequence(i);var a=this.getClickSequence(),s=this.getTentativeGuide(o);if(a.length>2&&s&&s.geometry.type==="Polygon"){var u=this.getAddFeatureOrBooleanPolygonAction(s.geometry,o);this.resetClickSequence(),u&&o.onEdit(u)}}},{key:"getGuides",value:function(i){var o=i.lastPointerMoveEvent,a=i.modeConfig,s=this.getClickSequence(),u={type:"FeatureCollection",features:[]};if(s.length===0)return u;var d=o.mapCoords;if(s.length===1)u.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[s[0],d]}});else{var g=this.getThreeClickPolygon(s[0],s[1],d,a);g&&u.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:g.geometry})}return u}},{key:"getThreeClickPolygon",value:function(i,o,a,s){return null}},{key:"handlePointerMove",value:function(i,o){o.onUpdateCursor("cell"),YC(A1(n.prototype),"handlePointerMove",this).call(this,i,o)}},{key:"createTentativeFeature",value:function(i){var o=i.lastPointerMoveEvent,a=this.getClickSequence(),s=o?[o.mapCoords]:[],u;return a.length===2&&(u=this.getThreeClickPolygon(a[0],a[1],s[0],i.modeConfig)),u}}]),n}(SNe.GeoJsonEditMode);a2.ThreeClickPolygonMode=DNe;Object.defineProperty(kR,"__esModule",{value:!0});kR.DrawEllipseUsingThreePointsMode=void 0;var lW=W6(Lc),BNe=W6(Jie),NNe=W6(Kd),FNe=rl,kNe=So,zNe=a2;function W6(t){return t&&t.__esModule?t:{default:t}}function QC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?QC=function(n){return typeof n}:QC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},QC(t)}function UNe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function GNe(t,e,n){return e&&uW(t.prototype,e),n&&uW(t,n),t}function jNe(t){return function(){var e=ZI(t),n;if(HNe()){var r=ZI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return VNe(this,n)}}function VNe(t,e){return e&&(QC(e)==="object"||typeof e=="function")?e:$Ne(t)}function $Ne(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function HNe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function ZI(t){return ZI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},ZI(t)}function WNe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r4(t,e)}function r4(t,e){return r4=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},r4(t,e)}var qNe=function(t){WNe(n,t);var e=jNe(n);function n(){return UNe(this,n),e.apply(this,arguments)}return GNe(n,[{key:"getThreeClickPolygon",value:function(i,o,a,s){var u=(0,kNe.getIntermediatePosition)(i,o),d=Math.max((0,lW.default)(u,(0,FNe.point)(a)),.001),g=Math.max((0,lW.default)(i,o),.001)/2,_={angle:(0,NNe.default)(i,o)};return(0,BNe.default)(u,d,g,_)}}]),n}(zNe.ThreeClickPolygonMode);kR.DrawEllipseUsingThreePointsMode=qNe;var zR={};Object.defineProperty(zR,"__esModule",{value:!0});zR.DrawRectangleUsingThreePointsMode=void 0;var XNe=Ai,ZNe=a2;function KC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?KC=function(n){return typeof n}:KC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},KC(t)}function YNe(t,e){return eFe(t)||JNe(t,e)||KNe(t,e)||QNe()}function QNe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KNe(t,e){if(t){if(typeof t=="string")return cW(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cW(t,e)}}function cW(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function JNe(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,o=void 0;try{for(var a=t[Symbol.iterator](),s;!(r=(s=a.next()).done)&&(n.push(s.value),!(e&&n.length===e));r=!0);}catch(u){i=!0,o=u}finally{try{!r&&a.return!=null&&a.return()}finally{if(i)throw o}}return n}}function eFe(t){if(Array.isArray(t))return t}function tFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nFe(t,e,n){return e&&fW(t.prototype,e),n&&fW(t,n),t}function rFe(t){return function(){var e=YI(t),n;if(sFe()){var r=YI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return iFe(this,n)}}function iFe(t,e){return e&&(KC(e)==="object"||typeof e=="function")?e:oFe(t)}function oFe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function sFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function YI(t){return YI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},YI(t)}function aFe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&i4(t,e)}function i4(t,e){return i4=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},i4(t,e)}var lFe=function(t){aFe(n,t);var e=rFe(n);function n(){return tFe(this,n),e.apply(this,arguments)}return nFe(n,[{key:"getThreeClickPolygon",value:function(i,o,a,s){var u=(0,XNe.generatePointsParallelToLinePoints)(i,o,a),d=YNe(u,2),g=d[0],_=d[1];return{type:"Feature",properties:{shape:"Rectangle"},geometry:{type:"Polygon",coordinates:[[i,o,g,_,i]]}}}}]),n}(ZNe.ThreeClickPolygonMode);zR.DrawRectangleUsingThreePointsMode=lFe;var UR={};Object.defineProperty(UR,"__esModule",{value:!0});UR.Draw90DegreePolygonMode=void 0;var hW=GR(rR),dW=GR(Kd),uFe=GR(j6),cFe=GR(Lc),QS=rl,bB=Ai,fFe=So;function GR(t){return t&&t.__esModule?t:{default:t}}function JC(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?JC=function(n){return typeof n}:JC=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},JC(t)}function Ad(t){return pFe(t)||dFe(t)||eoe(t)||hFe()}function hFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dFe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function pFe(t){if(Array.isArray(t))return o4(t)}function gFe(t,e){return _Fe(t)||AFe(t,e)||eoe(t,e)||mFe()}function mFe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eoe(t,e){if(t){if(typeof t=="string")return o4(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o4(t,e)}}function o4(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function AFe(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,o=void 0;try{for(var a=t[Symbol.iterator](),s;!(r=(s=a.next()).done)&&(n.push(s.value),!(e&&n.length===e));r=!0);}catch(u){i=!0,o=u}finally{try{!r&&a.return!=null&&a.return()}finally{if(i)throw o}}return n}}function _Fe(t){if(Array.isArray(t))return t}function yFe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function pW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function vFe(t,e,n){return e&&pW(t.prototype,e),n&&pW(t,n),t}function eP(t,e,n){return typeof Reflect<"u"&&Reflect.get?eP=Reflect.get:eP=function(i,o,a){var s=xFe(i,o);if(s){var u=Object.getOwnPropertyDescriptor(s,o);return u.get?u.get.call(a):u.value}},eP(t,e,n||t)}function xFe(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=_1(t),t!==null););return t}function bFe(t){return function(){var e=_1(t),n;if(SFe()){var r=_1(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return wFe(this,n)}}function wFe(t,e){return e&&(JC(e)==="object"||typeof e=="function")?e:EFe(t)}function EFe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function SFe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function _1(t){return _1=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},_1(t)}function TFe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s4(t,e)}function s4(t,e){return s4=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},s4(t,e)}var CFe=function(t){TFe(n,t);var e=bFe(n);function n(){return yFe(this,n),e.apply(this,arguments)}return vFe(n,[{key:"createTentativeFeature",value:function(i){var o=this.getClickSequence(),a=i.lastPointerMoveEvent.mapCoords,s;if(o.length===1)s=a;else{var u=o[o.length-2],d=o[o.length-1],g=(0,bB.generatePointsParallelToLinePoints)(u,d,a),_=gFe(g,1);s=_[0]}var E;return o.length<3?E={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(Ad(o),[s])}}:E={type:"Feature",properties:{guideType:"tentative"},geometry:{type:"Polygon",coordinates:[[].concat(Ad(o),[s,o[0]])]}},E}},{key:"getGuides",value:function(i){var o={type:"FeatureCollection",features:[]},a=this.getClickSequence();if(a.length===0||!i.lastPointerMoveEvent)return o;var s=this.createTentativeFeature(i);return o.features.push(s),o.features=o.features.concat((0,bB.getEditHandlesForGeometry)(s.geometry,-1)),o.features=o.features.slice(0,-1),o}},{key:"handlePointerMove",value:function(i,o){o.onUpdateCursor("cell"),eP(_1(n.prototype),"handlePointerMove",this).call(this,i,o)}},{key:"handleClick",value:function(i,o){var a=i.picks,s=this.getTentativeGuide(o);this.addClickSequence(i);var u=this.getClickSequence();if(s){if(u.length===3&&s.geometry.type==="LineString"){var d=s.geometry;u[u.length-1]=d.coordinates[d.coordinates.length-1]}else if(u.length>3&&s.geometry.type==="Polygon"){var g=s.geometry;u[u.length-1]=g.coordinates[0][g.coordinates[0].length-2];var _=(0,bB.getPickedEditHandle)(a);if(_&&Array.isArray(_.properties.positionIndexes)&&(_.properties.positionIndexes[1]===0||_.properties.positionIndexes[1]===g.coordinates[0].length-3)){var E={type:"Polygon",coordinates:this.finalizedCoordinates(Ad(g.coordinates[0]))};this.resetClickSequence();var P=this.getAddFeatureOrBooleanPolygonAction(E,o);P&&o.onEdit(P)}}var O={screenCoords:[-1,-1],mapCoords:i.mapCoords,picks:[],pointerDownPicks:null,pointerDownScreenCoords:null,pointerDownMapCoords:null,cancelPan:function(){},sourceEvent:null};this.handlePointerMove(O,o)}}},{key:"finalizedCoordinates",value:function(i){var o=[[].concat(Ad(i.slice(0,-2)),[i[0]])],a=this.getIntermediatePoint(Ad(i));if(a)o=[[].concat(Ad(i.slice(0,-2)),[a,i[0]])];else{var s=Ad(i);s.splice(-3,1),a=this.getIntermediatePoint(Ad(s)),a&&(o=[[].concat(Ad(i.slice(0,-3)),[a,i[0]])])}return o}},{key:"getIntermediatePoint",value:function(i){var o;if(i.length>4){var a=Ad(i),s=a[0],u=a[1],d=(0,dW.default)(s,u),g=i[i.length-3],_=i[i.length-4],E=(0,dW.default)(g,_),P={first:[],second:[]};[1,2,3].forEach(function(D){var V=d+D*90;P.first.push(V>180?V-360:V);var k=E+D*90;P.second.push(k>180?k-360:k)});var O=(0,cFe.default)((0,QS.point)(s),(0,QS.point)(g));[0,1,2].forEach(function(D){var V=(0,QS.lineString)([s,(0,hW.default)(s,O,P.first[D]).geometry.coordinates]);[0,1,2].forEach(function(k){var F=(0,QS.lineString)([g,(0,hW.default)(g,O,P.second[k]).geometry.coordinates]),z=(0,uFe.default)(V,F);z&&z.features.length&&(o=z.features[0].geometry.coordinates)})})}return o}}]),n}(fFe.GeoJsonEditMode);UR.Draw90DegreePolygonMode=CFe;var jR={},toe="Expected a function",gW=0/0,PFe="[object Symbol]",IFe=/^\s+|\s+$/g,MFe=/^[-+]0x[0-9a-f]+$/i,OFe=/^0b[01]+$/i,RFe=/^0o[0-7]+$/i,LFe=parseInt,DFe=typeof Ya=="object"&&Ya&&Ya.Object===Object&&Ya,BFe=typeof self=="object"&&self&&self.Object===Object&&self,NFe=DFe||BFe||Function("return this")(),FFe=Object.prototype,kFe=FFe.toString,zFe=Math.max,UFe=Math.min,wB=function(){return NFe.Date.now()};function GFe(t,e,n){var r,i,o,a,s,u,d=0,g=!1,_=!1,E=!0;if(typeof t!="function")throw new TypeError(toe);e=mW(e)||0,QI(n)&&(g=!!n.leading,_="maxWait"in n,o=_?zFe(mW(n.maxWait)||0,e):o,E="trailing"in n?!!n.trailing:E);function P(J){var re=r,ue=i;return r=i=void 0,d=J,a=t.apply(ue,re),a}function O(J){return d=J,s=setTimeout(k,e),g?P(J):a}function D(J){var re=J-u,ue=J-d,ie=e-re;return _?UFe(ie,o-ue):ie}function V(J){var re=J-u,ue=J-d;return u===void 0||re>=e||re<0||_&&ue>=o}function k(){var J=wB();if(V(J))return F(J);s=setTimeout(k,D(J))}function F(J){return s=void 0,E&&r?P(J):(r=i=void 0,a)}function z(){s!==void 0&&clearTimeout(s),d=0,r=u=i=s=void 0}function X(){return s===void 0?a:F(wB())}function Y(){var J=wB(),re=V(J);if(r=arguments,i=this,u=J,re){if(s===void 0)return O(u);if(_)return s=setTimeout(k,e),P(u)}return s===void 0&&(s=setTimeout(k,e)),a}return Y.cancel=z,Y.flush=X,Y}function jFe(t,e,n){var r=!0,i=!0;if(typeof t!="function")throw new TypeError(toe);return QI(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),GFe(t,e,{leading:r,maxWait:e,trailing:i})}function QI(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function VFe(t){return!!t&&typeof t=="object"}function $Fe(t){return typeof t=="symbol"||VFe(t)&&kFe.call(t)==PFe}function mW(t){if(typeof t=="number")return t;if($Fe(t))return gW;if(QI(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=QI(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(IFe,"");var n=OFe.test(t);return n||RFe.test(t)?LFe(t.slice(2),n?2:8):MFe.test(t)?gW:+t}var HFe=jFe;Object.defineProperty(jR,"__esModule",{value:!0});jR.DrawPolygonByDraggingMode=void 0;var WFe=ZFe(HFe),qFe=Ai,XFe=H1;function ZFe(t){return t&&t.__esModule?t:{default:t}}function tP(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?tP=function(n){return typeof n}:tP=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},tP(t)}function YFe(t){return eke(t)||JFe(t)||KFe(t)||QFe()}function QFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function KFe(t,e){if(t){if(typeof t=="string")return a4(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return a4(t,e)}}function JFe(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function eke(t){if(Array.isArray(t))return a4(t)}function a4(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function tke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function AW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function nke(t,e,n){return e&&AW(t.prototype,e),n&&AW(t,n),t}function rke(t){return function(){var e=KI(t),n;if(oke()){var r=KI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return ike(this,n)}}function ike(t,e){return e&&(tP(e)==="object"||typeof e=="function")?e:noe(t)}function noe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function oke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function KI(t){return KI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},KI(t)}function ske(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l4(t,e)}function l4(t,e){return l4=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},l4(t,e)}function ake(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var lke=function(t){ske(n,t);var e=rke(n);function n(){var r;tke(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=e.call.apply(e,[this].concat(o)),ake(noe(r),"handleDraggingThrottled",null),r}return nke(n,[{key:"handleClick",value:function(i,o){}},{key:"handleStartDragging",value:function(i,o){i.cancelPan(),o.modeConfig&&o.modeConfig.throttleMs?this.handleDraggingThrottled=(0,WFe.default)(this.handleDraggingAux,o.modeConfig.throttleMs):this.handleDraggingThrottled=this.handleDraggingAux}},{key:"handleStopDragging",value:function(i,o){this.addClickSequence(i);var a=this.getClickSequence();if(this.handleDraggingThrottled&&this.handleDraggingThrottled.cancel&&this.handleDraggingThrottled.cancel(),a.length>2){var s={type:"Polygon",coordinates:[[].concat(YFe(a),[a[0]])]};this.resetClickSequence();var u=this.getAddFeatureOrBooleanPolygonAction(s,o);u&&o.onEdit(u)}}},{key:"handleDraggingAux",value:function(i,o){var a=i.picks,s=(0,qFe.getPickedEditHandle)(a);s||this.addClickSequence(i)}},{key:"handleDragging",value:function(i,o){this.handleDraggingThrottled&&this.handleDraggingThrottled(i,o)}}]),n}(XFe.DrawPolygonMode);jR.DrawPolygonByDraggingMode=lke;var VR={};Object.defineProperty(VR,"__esModule",{value:!0});VR.ViewMode=void 0;var uke=So;function nP(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?nP=function(n){return typeof n}:nP=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},nP(t)}function cke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fke(t){return function(){var e=JI(t),n;if(pke()){var r=JI(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return hke(this,n)}}function hke(t,e){return e&&(nP(e)==="object"||typeof e=="function")?e:dke(t)}function dke(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function JI(t){return JI=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},JI(t)}function gke(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&u4(t,e)}function u4(t,e){return u4=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},u4(t,e)}var mke=function(t){gke(n,t);var e=fke(n);function n(){return cke(this,n),e.apply(this,arguments)}return n}(uke.GeoJsonEditMode);VR.ViewMode=mke;var $R={};function Ake(t,e){var n=ch(t,e),r=qE(t,e),i=$v(t,n/2,r);return i}const _ke=Object.freeze(Object.defineProperty({__proto__:null,default:Ake},Symbol.toStringTag,{value:"Module"})),yke=ti(_ke);Object.defineProperty($R,"__esModule",{value:!0});$R.MeasureDistanceMode=void 0;var vke=roe(Lc),_W=roe(yke),xke=Ai,bke=So;function roe(t){return t&&t.__esModule?t:{default:t}}function rP(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?rP=function(n){return typeof n}:rP=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},rP(t)}function EB(t){return Tke(t)||Ske(t)||Eke(t)||wke()}function wke(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eke(t,e){if(t){if(typeof t=="string")return c4(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c4(t,e)}}function Ske(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function Tke(t){if(Array.isArray(t))return c4(t)}function c4(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Cke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Pke(t,e,n){return e&&yW(t.prototype,e),n&&yW(t,n),t}function Ike(t){return function(){var e=eM(t),n;if(Oke()){var r=eM(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return Mke(this,n)}}function Mke(t,e){return e&&(rP(e)==="object"||typeof e=="function")?e:ew(t)}function ew(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Oke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function eM(t){return eM=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},eM(t)}function Rke(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&f4(t,e)}function f4(t,e){return f4=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},f4(t,e)}function KS(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Lke=function(t){Rke(n,t);var e=Ike(n);function n(){var r;Cke(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=e.call.apply(e,[this].concat(o)),KS(ew(r),"_isMeasuringSessionFinished",!1),KS(ew(r),"_currentTooltips",[]),KS(ew(r),"_currentDistance",0),KS(ew(r),"_calculateDistanceForTooltip",function(s){var u=s.positionA,d=s.positionB,g=s.modeConfig,_=g||{},E=_.turfOptions,P=_.measurementCallback,O=(0,vke.default)(u,d,E);return P&&P(O),O}),r}return Pke(n,[{key:"_formatTooltip",value:function(i,o){var a=o||{},s=a.formatTooltip,u=a.turfOptions,d=u&&u.units||"kilometers",g;return s?g=s(i):g="".concat(parseFloat(i).toFixed(2)," ").concat(d),g}},{key:"handleClick",value:function(i,o){var a=o.modeConfig,s=o.data,u=o.onEdit,d=a||{},g=d.centerTooltipsOnLine,_=g===void 0?!1:g;this._isMeasuringSessionFinished&&(this._isMeasuringSessionFinished=!1,this.resetClickSequence(),this._currentTooltips=[],this._currentDistance=0);var E=i.picks,P=(0,xke.getPickedEditHandle)(E),O=!1;P||(this.addClickSequence(i),O=!0);var D=this.getClickSequence();if(D.length>1&&P&&Array.isArray(P.properties.positionIndexes)&&P.properties.positionIndexes[0]===D.length-1)this._isMeasuringSessionFinished=!0;else if(O){if(D.length>1){this._currentDistance+=this._calculateDistanceForTooltip({positionA:D[D.length-2],positionB:D[D.length-1],modeConfig:a});var V=_?(0,_W.default)(D[D.length-2],D[D.length-1]).geometry.coordinates:i.mapCoords;this._currentTooltips.push({position:V,text:this._formatTooltip(this._currentDistance,a)})}u({updatedData:s,editType:"addTentativePosition",editContext:{position:i.mapCoords}})}}},{key:"handleKeyUp",value:function(i,o){if(!this._isMeasuringSessionFinished){i.stopPropagation();var a=i.key,s=this.getClickSequence().length;switch(a){case"Escape":this._isMeasuringSessionFinished=!0,s===1&&(this.resetClickSequence(),this._currentTooltips=[]),o.onUpdateCursor("cell");break;case"Enter":this.handleClick(o.lastPointerMoveEvent,o),this._isMeasuringSessionFinished=!0;break}}}},{key:"getGuides",value:function(i){var o,a=i.lastPointerMoveEvent,s=this.getClickSequence(),u=a&&!this._isMeasuringSessionFinished?[a.mapCoords]:[],d={type:"FeatureCollection",features:[]};s.length>0&&d.features.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[].concat(EB(s),u)}});var g=s.map(function(_,E){return{type:"Feature",properties:{guideType:"editHandle",editHandleType:"existing",featureIndex:-1,positionIndexes:[E]},geometry:{type:"Point",coordinates:_}}});return(o=d.features).push.apply(o,EB(g)),d}},{key:"handlePointerMove",value:function(i,o){o.onUpdateCursor("cell")}},{key:"getTooltips",value:function(i){var o=i.lastPointerMoveEvent,a=i.modeConfig,s=a||{},u=s.centerTooltipsOnLine,d=u===void 0?!1:u,g=this.getClickSequence();if(g.length>0&&o&&!this._isMeasuringSessionFinished){var _=this._calculateDistanceForTooltip({positionA:g[g.length-1],positionB:o.mapCoords,modeConfig:i.modeConfig}),E=d?(0,_W.default)(g[g.length-1],o.mapCoords).geometry.coordinates:o.mapCoords;return[].concat(EB(this._currentTooltips),[{position:E,text:this._formatTooltip(this._currentDistance+_,a)}])}return this._currentTooltips}}]),n}(bke.GeoJsonEditMode);$R.MeasureDistanceMode=Lke;var HR={},vW=6378137;function h4(t){return Pre(t,function(e,n){return e+Dke(n)},0)}function Dke(t){var e=0,n;switch(t.type){case"Polygon":return xW(t.coordinates);case"MultiPolygon":for(n=0;n<t.coordinates.length;n++)e+=xW(t.coordinates[n]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function xW(t){var e=0;if(t&&t.length>0){e+=Math.abs(bW(t[0]));for(var n=1;n<t.length;n++)e-=Math.abs(bW(t[n]))}return e}function bW(t){var e,n,r,i,o,a,s,u=0,d=t.length;if(d>2){for(s=0;s<d;s++)s===d-2?(i=d-2,o=d-1,a=0):s===d-1?(i=d-1,o=0,a=1):(i=s,o=s+1,a=s+2),e=t[i],n=t[o],r=t[a],u+=(SB(r[0])-SB(e[0]))*Math.sin(SB(n[1]));u=u*vW*vW/2}return u}function SB(t){return t*Math.PI/180}const Bke=Object.freeze(Object.defineProperty({__proto__:null,default:h4},Symbol.toStringTag,{value:"Module"})),Nke=ti(Bke);Object.defineProperty(HR,"__esModule",{value:!0});HR.MeasureAreaMode=void 0;var Fke=ioe(Nke),kke=ioe(b6),zke=H1;function ioe(t){return t&&t.__esModule?t:{default:t}}function iP(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?iP=function(n){return typeof n}:iP=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},iP(t)}function wW(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Uke(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?wW(Object(n),!0).forEach(function(r){Gke(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wW(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Gke(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jke(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function EW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function Vke(t,e,n){return e&&EW(t.prototype,e),n&&EW(t,n),t}function oP(t,e,n){return typeof Reflect<"u"&&Reflect.get?oP=Reflect.get:oP=function(i,o,a){var s=$ke(i,o);if(s){var u=Object.getOwnPropertyDescriptor(s,o);return u.get?u.get.call(a):u.value}},oP(t,e,n||t)}function $ke(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&(t=y1(t),t!==null););return t}function Hke(t){return function(){var e=y1(t),n;if(Xke()){var r=y1(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return Wke(this,n)}}function Wke(t,e){return e&&(iP(e)==="object"||typeof e=="function")?e:qke(t)}function qke(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xke(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function y1(t){return y1=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},y1(t)}function Zke(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&d4(t,e)}function d4(t,e){return d4=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},d4(t,e)}var Yke=[],Qke=function(t){Zke(n,t);var e=Hke(n);function n(){return jke(this,n),e.apply(this,arguments)}return Vke(n,[{key:"handleClick",value:function(i,o){var a=Uke({},o,{onEdit:function(){}});oP(y1(n.prototype),"handleClick",this).call(this,i,a)}},{key:"getTooltips",value:function(i){var o=this.getTentativeGuide(i);if(o&&o.geometry.type==="Polygon"){var a=i.modeConfig,s=a||{},u=s.formatTooltip,d=s.measurementCallback,g="sq. m",_=(0,kke.default)(o),E=(0,Fke.default)(o),P;return u?P=u(E):P="".concat(parseFloat(E).toFixed(2)," ").concat(g),d&&d(E),[{position:_.geometry.coordinates,text:P}]}return Yke}}]),n}(zke.DrawPolygonMode);HR.MeasureAreaMode=Qke;var WR={},q6={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=n;function e(r,i){if(r===i)return!0;if(Array.isArray(r)){var o=r.length;if(!i||i.length!==o)return!1;for(var a=0;a<o;a++)if(r[a]!==i[a])return!1;return!0}return!1}function n(r){var i={},o;return function(a){for(var s in a)if(!e(a[s],i[s])){o=r(a),i=a;break}return o}}})(q6);Object.defineProperty(WR,"__esModule",{value:!0});WR.MeasureAngleMode=void 0;var SW=X6(Kd),Kke=X6(Xre),Jke=X6(q6),e4e=So;function X6(t){return t&&t.__esModule?t:{default:t}}function sP(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?sP=function(n){return typeof n}:sP=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},sP(t)}function t4e(t){return o4e(t)||i4e(t)||r4e(t)||n4e()}function n4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r4e(t,e){if(t){if(typeof t=="string")return p4(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p4(t,e)}}function i4e(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function o4e(t){if(Array.isArray(t))return p4(t)}function p4(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function s4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function TW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a4e(t,e,n){return e&&TW(t.prototype,e),n&&TW(t,n),t}function l4e(t){return function(){var e=tM(t),n;if(c4e()){var r=tM(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return u4e(this,n)}}function u4e(t,e){return e&&(sP(e)==="object"||typeof e=="function")?e:ooe(t)}function ooe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c4e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function tM(t){return tM=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},tM(t)}function f4e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&g4(t,e)}function g4(t,e){return g4=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},g4(t,e)}function h4e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d4e=[],p4e=function(t){f4e(n,t);var e=l4e(n);function n(){var r;s4e(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return r=e.call.apply(e,[this].concat(o)),h4e(ooe(r),"_getTooltips",(0,Jke.default)(function(s){var u=s.modeConfig,d=s.vertex,g=s.point1,_=s.point2,E=d4e;if(d&&g&&_){var P=u||{},O=P.formatTooltip,D=P.measurementCallback,V="deg",k=(0,SW.default)(d,g),F=(0,SW.default)(d,_),z=Math.abs(k-F);z>180&&(z=360-z);var X;O?X=O(z):X="".concat(parseFloat(z).toFixed(2)," ").concat(V),D&&D(z);var Y=(0,Kke.default)({type:"FeatureCollection",features:[g,_].map(function(J){return{type:"Feature",geometry:{type:"Point",coordinates:J}}})}).geometry.coordinates;E=[{position:Y,text:X}]}return E})),r}return a4e(n,[{key:"handleClick",value:function(i,o){this.getClickSequence().length>=3&&this.resetClickSequence(),this.addClickSequence(i)}},{key:"handlePointerMove",value:function(i,o){o.onUpdateCursor("cell")}},{key:"getPoints",value:function(i){var o=this.getClickSequence(),a=t4e(o);return o.length<3&&i.lastPointerMoveEvent&&a.push(i.lastPointerMoveEvent.mapCoords),a}},{key:"getGuides",value:function(i){var o={type:"FeatureCollection",features:[]},a=o.features,s=this.getPoints(i);return s.length>2?a.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[s[1],s[0],s[2]]}}):s.length>1&&a.push({type:"Feature",properties:{guideType:"tentative"},geometry:{type:"LineString",coordinates:[s[1],s[0]]}}),o}},{key:"getTooltips",value:function(i){var o=this.getPoints(i);return this._getTooltips({modeConfig:i.modeConfig,vertex:o[0],point1:o[1],point2:o[2]})}}]),n}(e4e.GeoJsonEditMode);WR.MeasureAngleMode=p4e;var qR={};Object.defineProperty(qR,"__esModule",{value:!0});qR.SnappableMode=void 0;var JS=Ai,g4e=So;function aP(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?aP=function(n){return typeof n}:aP=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},aP(t)}function m4e(t){if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(t=soe(t))){var e=0,n=function(){};return{s:n,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(u){throw u},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var r,i=!0,o=!1,a;return{s:function(){r=t[Symbol.iterator]()},n:function(){var u=r.next();return i=u.done,u},e:function(u){o=!0,a=u},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(o)throw a}}}}function Cy(t){return y4e(t)||_4e(t)||soe(t)||A4e()}function A4e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function soe(t,e){if(t){if(typeof t=="string")return m4(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m4(t,e)}}function _4e(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function y4e(t){if(Array.isArray(t))return m4(t)}function m4(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function CW(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function v4e(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?CW(Object(n),!0).forEach(function(r){loe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):CW(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function x4e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function PW(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function b4e(t,e,n){return e&&PW(t.prototype,e),n&&PW(t,n),t}function w4e(t){return function(){var e=nM(t),n;if(S4e()){var r=nM(this).constructor;n=Reflect.construct(e,arguments,r)}else n=e.apply(this,arguments);return E4e(this,n)}}function E4e(t,e){return e&&(aP(e)==="object"||typeof e=="function")?e:aoe(t)}function aoe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S4e(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function nM(t){return nM=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},nM(t)}function T4e(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&A4(t,e)}function A4(t,e){return A4=Object.setPrototypeOf||function(r,i){return r.__proto__=i,r},A4(t,e)}function loe(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var C4e=function(t){T4e(n,t);var e=w4e(n);function n(r){var i;return x4e(this,n),i=e.call(this),loe(aoe(i),"_handler",void 0),i._handler=r,i}return b4e(n,[{key:"_getSnappedMouseEvent",value:function(i,o,a){return Object.assign(i,{mapCoords:a.geometry.coordinates,pointerDownMapCoords:o&&o.geometry.coordinates})}},{key:"_getPickedSnapTarget",value:function(i){return(0,JS.getPickedEditHandles)(i).find(function(o){return o.properties.editHandleType==="snap-target"})}},{key:"_getPickedSnapSource",value:function(i){return(0,JS.getPickedSnapSourceEditHandle)(i)}},{key:"_getUpdatedSnapSourceHandle",value:function(i,o){var a=i.properties,s=a.featureIndex,u=a.positionIndexes;if(!Array.isArray(u))return i;var d=o.features[s],g=u.reduce(function(_,E){return _[E]},d.geometry.coordinates);return v4e({},i,{geometry:{type:"Point",coordinates:g}})}},{key:"_getSnapTargets",value:function(i){var o=i.modeConfig||{},a=o.additionalSnapTargets;a=a||[];var s=[].concat(Cy(i.data.features),Cy(a));return s}},{key:"_getSnapTargetHandles",value:function(i){for(var o=[],a=this._getSnapTargets(i),s=0;s<a.length;s++){var u=!i.selectedIndexes.includes(s);if(u){var d=a[s].geometry;o.push.apply(o,Cy((0,JS.getEditHandlesForGeometry)(d,s,"snap-target")))}}return o}},{key:"getGuides",value:function(i){var o=i.modeConfig,a=i.lastPointerMoveEvent,s=o||{},u=s.enableSnapping,d={type:"FeatureCollection",features:Cy(this._handler.getGuides(i).features)};if(!u)return d;var g=a&&this._getPickedSnapSource(a.pointerDownPicks);if(g){var _;return(_=d.features).push.apply(_,Cy(this._getSnapTargetHandles(i)).concat([this._getUpdatedSnapSourceHandle(g,i.data)])),d}var E=i.data.features,P=m4e(i.selectedIndexes),O;try{for(P.s();!(O=P.n()).done;){var D=O.value;if(D<E.length){var V,k=E[D].geometry;(V=d.features).push.apply(V,Cy((0,JS.getEditHandlesForGeometry)(k,D,"snap-source")))}}}catch(F){P.e(F)}finally{P.f()}return d}},{key:"_getSnapAwareEvent",value:function(i,o){var a=this._getPickedSnapSource(o.lastPointerMoveEvent.pointerDownPicks),s=this._getPickedSnapTarget(i.picks);return a&&s?this._getSnappedMouseEvent(i,a,s):i}},{key:"handleStartDragging",value:function(i,o){this._handler.handleStartDragging(i,o)}},{key:"handleStopDragging",value:function(i,o){this._handler.handleStopDragging(this._getSnapAwareEvent(i,o),o)}},{key:"handleDragging",value:function(i,o){this._handler.handleDragging(this._getSnapAwareEvent(i,o),o)}},{key:"handlePointerMove",value:function(i,o){this._handler.handlePointerMove(this._getSnapAwareEvent(i,o),o)}}]),n}(g4e.GeoJsonEditMode);qR.SnappableMode=C4e;(function(t){function e(Dt){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?e=function(Mn){return typeof Mn}:e=function(Mn){return Mn&&typeof Symbol=="function"&&Mn.constructor===Symbol&&Mn!==Symbol.prototype?"symbol":typeof Mn},e(Dt)}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"GeoJsonEditMode",{enumerable:!0,get:function(){return n.GeoJsonEditMode}}),Object.defineProperty(t,"ModifyMode",{enumerable:!0,get:function(){return r.ModifyMode}}),Object.defineProperty(t,"ResizeCircleMode",{enumerable:!0,get:function(){return i.ResizeCircleMode}}),Object.defineProperty(t,"TranslateMode",{enumerable:!0,get:function(){return o.TranslateMode}}),Object.defineProperty(t,"ScaleMode",{enumerable:!0,get:function(){return a.ScaleMode}}),Object.defineProperty(t,"RotateMode",{enumerable:!0,get:function(){return s.RotateMode}}),Object.defineProperty(t,"DuplicateMode",{enumerable:!0,get:function(){return u.DuplicateMode}}),Object.defineProperty(t,"ExtendLineStringMode",{enumerable:!0,get:function(){return d.ExtendLineStringMode}}),Object.defineProperty(t,"SplitPolygonMode",{enumerable:!0,get:function(){return g.SplitPolygonMode}}),Object.defineProperty(t,"ExtrudeMode",{enumerable:!0,get:function(){return _.ExtrudeMode}}),Object.defineProperty(t,"ElevationMode",{enumerable:!0,get:function(){return E.ElevationMode}}),Object.defineProperty(t,"TransformMode",{enumerable:!0,get:function(){return P.TransformMode}}),Object.defineProperty(t,"DrawPointMode",{enumerable:!0,get:function(){return O.DrawPointMode}}),Object.defineProperty(t,"DrawLineStringMode",{enumerable:!0,get:function(){return D.DrawLineStringMode}}),Object.defineProperty(t,"DrawPolygonMode",{enumerable:!0,get:function(){return V.DrawPolygonMode}}),Object.defineProperty(t,"DrawRectangleMode",{enumerable:!0,get:function(){return k.DrawRectangleMode}}),Object.defineProperty(t,"DrawSquareMode",{enumerable:!0,get:function(){return F.DrawSquareMode}}),Object.defineProperty(t,"DrawRectangleFromCenterMode",{enumerable:!0,get:function(){return z.DrawRectangleFromCenterMode}}),Object.defineProperty(t,"DrawSquareFromCenterMode",{enumerable:!0,get:function(){return X.DrawSquareFromCenterMode}}),Object.defineProperty(t,"DrawCircleByDiameterMode",{enumerable:!0,get:function(){return Y.DrawCircleByDiameterMode}}),Object.defineProperty(t,"DrawCircleFromCenterMode",{enumerable:!0,get:function(){return J.DrawCircleFromCenterMode}}),Object.defineProperty(t,"DrawEllipseByBoundingBoxMode",{enumerable:!0,get:function(){return re.DrawEllipseByBoundingBoxMode}}),Object.defineProperty(t,"DrawEllipseUsingThreePointsMode",{enumerable:!0,get:function(){return ue.DrawEllipseUsingThreePointsMode}}),Object.defineProperty(t,"DrawRectangleUsingThreePointsMode",{enumerable:!0,get:function(){return ie.DrawRectangleUsingThreePointsMode}}),Object.defineProperty(t,"Draw90DegreePolygonMode",{enumerable:!0,get:function(){return ce.Draw90DegreePolygonMode}}),Object.defineProperty(t,"DrawPolygonByDraggingMode",{enumerable:!0,get:function(){return se.DrawPolygonByDraggingMode}}),Object.defineProperty(t,"ImmutableFeatureCollection",{enumerable:!0,get:function(){return me.ImmutableFeatureCollection}}),Object.defineProperty(t,"ViewMode",{enumerable:!0,get:function(){return Ce.ViewMode}}),Object.defineProperty(t,"MeasureDistanceMode",{enumerable:!0,get:function(){return we.MeasureDistanceMode}}),Object.defineProperty(t,"MeasureAreaMode",{enumerable:!0,get:function(){return Ye.MeasureAreaMode}}),Object.defineProperty(t,"MeasureAngleMode",{enumerable:!0,get:function(){return at.MeasureAngleMode}}),Object.defineProperty(t,"CompositeMode",{enumerable:!0,get:function(){return yt.CompositeMode}}),Object.defineProperty(t,"SnappableMode",{enumerable:!0,get:function(){return be.SnappableMode}}),Object.defineProperty(t,"_memoize",{enumerable:!0,get:function(){return De.default}}),t.utils=void 0;var n=So,r=k1,i=aR,o=z1,a=QE,s=KE,u=fR,d=hR,g=dR,_=TR,E=CR,P=PR,O=IR,D=MR,V=H1,k=OR,F=RR,z=LR,X=DR,Y=BR,J=NR,re=FR,ue=kR,ie=zR,ce=UR,se=jR,me=Rc,Ce=VR,we=$R,Ye=HR,at=WR,yt=s2,be=qR,De=Ct(q6),Re=ct(Ai);t.utils=Re;function qe(){if(typeof WeakMap!="function")return null;var Dt=new WeakMap;return qe=function(){return Dt},Dt}function ct(Dt){if(Dt&&Dt.__esModule)return Dt;if(Dt===null||e(Dt)!=="object"&&typeof Dt!="function")return{default:Dt};var In=qe();if(In&&In.has(Dt))return In.get(Dt);var Mn={},Tn=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var Nt in Dt)if(Object.prototype.hasOwnProperty.call(Dt,Nt)){var Zt=Tn?Object.getOwnPropertyDescriptor(Dt,Nt):null;Zt&&(Zt.get||Zt.set)?Object.defineProperty(Mn,Nt,Zt):Mn[Nt]=Dt[Nt]}return Mn.default=Dt,In&&In.set(Dt,Mn),Mn}function Ct(Dt){return Dt&&Dt.__esModule?Dt:{default:Dt}}})(Hp);var uoe={},qm={};Object.defineProperty(qm,"__esModule",{value:!0});qm.MAX_ARROWS=qm.DEFAULT_ARROWS=qm.ArrowStyles=void 0;var P4e={NONE:0,FORWARD:1,BACKWARD:2,BOTH:3};qm.ArrowStyles=P4e;var I4e=1;qm.DEFAULT_ARROWS=I4e;var M4e=3;qm.MAX_ARROWS=M4e;var XR={};const O4e=`#define SHADER_NAME arc-layer-vertex-shader

attribute vec3 positions;
attribute vec4 instanceSourceColors;
attribute vec4 instanceTargetColors;
attribute vec3 instanceSourcePositions;
attribute vec3 instanceSourcePositions64Low;
attribute vec3 instanceTargetPositions;
attribute vec3 instanceTargetPositions64Low;
attribute vec3 instancePickingColors;
attribute float instanceWidths;
attribute float instanceHeights;
attribute float instanceTilts;

uniform bool greatCircle;
uniform bool useShortestPath;
uniform float numSegments;
uniform float opacity;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int widthUnits;

varying vec4 vColor;
varying vec2 uv;
varying float isValid;

float paraboloid(float distance, float sourceZ, float targetZ, float ratio) {

  float deltaZ = targetZ - sourceZ;
  float dh = distance * instanceHeights;
  if (dh == 0.0) {
    return sourceZ + deltaZ * ratio;
  }
  float unitZ = deltaZ / dh;
  float p2 = unitZ * unitZ + 1.0;
  float dir = step(deltaZ, 0.0);
  float z0 = mix(sourceZ, targetZ, dir);
  float r = mix(ratio, 1.0 - ratio, dir);
  return sqrt(r * (p2 - r)) * dh + z0;
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  return dir_screenspace * offset_direction * width / 2.0;
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (numSegments - 1.0));
}

vec3 interpolateFlat(vec3 source, vec3 target, float segmentRatio) {
  float distance = length(source.xy - target.xy);
  float z = paraboloid(distance, source.z, target.z, segmentRatio);

  float tiltAngle = radians(instanceTilts);
  vec2 tiltDirection = normalize(target.xy - source.xy);
  vec2 tilt = vec2(-tiltDirection.y, tiltDirection.x) * z * sin(tiltAngle);

  return vec3(
    mix(source.xy, target.xy, segmentRatio) + tilt,
    z * cos(tiltAngle)
  );
}
float getAngularDist (vec2 source, vec2 target) {
  vec2 sourceRadians = radians(source);
  vec2 targetRadians = radians(target);
  vec2 sin_half_delta = sin((sourceRadians - targetRadians) / 2.0);
  vec2 shd_sq = sin_half_delta * sin_half_delta;

  float a = shd_sq.y + cos(sourceRadians.y) * cos(targetRadians.y) * shd_sq.x;
  return 2.0 * asin(sqrt(a));
}

vec3 interpolateGreatCircle(vec3 source, vec3 target, vec3 source3D, vec3 target3D, float angularDist, float t) {
  vec2 lngLat;
  if(abs(angularDist - PI) < 0.001) {
    lngLat = (1.0 - t) * source.xy + t * target.xy;
  } else {
    float a = sin((1.0 - t) * angularDist);
    float b = sin(t * angularDist);
    vec3 p = source3D.yxz * a + target3D.yxz * b;
    lngLat = degrees(vec2(atan(p.y, -p.x), atan(p.z, length(p.xy))));
  }

  float z = paraboloid(angularDist * EARTH_RADIUS, source.z, target.z, t);

  return vec3(lngLat, z);
}

void main(void) {
  geometry.worldPosition = instanceSourcePositions;
  geometry.worldPositionAlt = instanceTargetPositions;

  float segmentIndex = positions.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float prevSegmentRatio = getSegmentRatio(max(0.0, segmentIndex - 1.0));
  float nextSegmentRatio = getSegmentRatio(min(numSegments - 1.0, segmentIndex + 1.0));
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  isValid = 1.0;

  uv = vec2(segmentRatio, positions.y);
  geometry.uv = uv;
  geometry.pickingColor = instancePickingColors;

  vec4 curr;
  vec4 next;
  vec3 source;
  vec3 target;

  if ((greatCircle || project_uProjectionMode == PROJECTION_MODE_GLOBE) && project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
    source = project_globe_(vec3(instanceSourcePositions.xy, 0.0));
    target = project_globe_(vec3(instanceTargetPositions.xy, 0.0));
    float angularDist = getAngularDist(instanceSourcePositions.xy, instanceTargetPositions.xy);

    vec3 prevPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, prevSegmentRatio);
    vec3 currPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, segmentRatio);
    vec3 nextPos = interpolateGreatCircle(instanceSourcePositions, instanceTargetPositions, source, target, angularDist, nextSegmentRatio);

    if (abs(currPos.x - prevPos.x) > 180.0) {
      indexDir = -1.0;
      isValid = 0.0;
    } else if (abs(currPos.x - nextPos.x) > 180.0) {
      indexDir = 1.0;
      isValid = 0.0;
    }
    nextPos = indexDir < 0.0 ? prevPos : nextPos;
    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;

    if (isValid == 0.0) {
      nextPos.x += nextPos.x > 0.0 ? -360.0 : 360.0;
      float t = ((currPos.x > 0.0 ? 180.0 : -180.0) - currPos.x) / (nextPos.x - currPos.x);
      currPos = mix(currPos, nextPos, t);
      segmentRatio = mix(segmentRatio, nextSegmentRatio, t);
    }

    vec3 currPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, segmentRatio);
    vec3 nextPos64Low = mix(instanceSourcePositions64Low, instanceTargetPositions64Low, nextSegmentRatio);
  
    curr = project_position_to_clipspace(currPos, currPos64Low, vec3(0.0), geometry.position);
    next = project_position_to_clipspace(nextPos, nextPos64Low, vec3(0.0));
  
  } else {
    vec3 source_world = instanceSourcePositions;
    vec3 target_world = instanceTargetPositions;
    if (useShortestPath) {
      source_world.x = mod(source_world.x + 180., 360.0) - 180.;
      target_world.x = mod(target_world.x + 180., 360.0) - 180.;

      float deltaLng = target_world.x - source_world.x;
      if (deltaLng > 180.) target_world.x -= 360.;
      if (deltaLng < -180.) source_world.x -= 360.;
    }
    source = project_position(source_world, instanceSourcePositions64Low);
    target = project_position(target_world, instanceTargetPositions64Low);
    float antiMeridianX = 0.0;

    if (useShortestPath) {
      if (project_uProjectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
        antiMeridianX = -(project_uCoordinateOrigin.x + 180.) / 360. * TILE_SIZE;
      }
      float thresholdRatio = (antiMeridianX - source.x) / (target.x - source.x);

      if (prevSegmentRatio <= thresholdRatio && nextSegmentRatio > thresholdRatio) {
        isValid = 0.0;
        indexDir = sign(segmentRatio - thresholdRatio);
        segmentRatio = thresholdRatio;
      }
    }

    nextSegmentRatio = indexDir < 0.0 ? prevSegmentRatio : nextSegmentRatio;
    vec3 currPos = interpolateFlat(source, target, segmentRatio);
    vec3 nextPos = interpolateFlat(source, target, nextSegmentRatio);

    if (useShortestPath) {
      if (nextPos.x < antiMeridianX) {
        currPos.x += TILE_SIZE;
        nextPos.x += TILE_SIZE;
      }
    }

    curr = project_common_position_to_clipspace(vec4(currPos, 1.0));
    next = project_common_position_to_clipspace(vec4(nextPos, 1.0));
    geometry.position = vec4(currPos, 1.0);
  }
  float widthPixels = clamp(
    project_size_to_pixel(instanceWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels
  );
  vec3 offset = vec3(
    getExtrusionOffset((next.xy - curr.xy) * indexDir, positions.y, widthPixels),
    0.0);
  DECKGL_FILTER_SIZE(offset, geometry);
  DECKGL_FILTER_GL_POSITION(curr, geometry);
  gl_Position = curr + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);

  vec4 color = mix(instanceSourceColors, instanceTargetColors, segmentRatio);
  vColor = vec4(color.rgb, color.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,R4e=`#define SHADER_NAME arc-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 uv;
varying float isValid;

void main(void) {
  if (isValid == 0.0) {
    discard;
  }

  gl_FragColor = vColor;
  geometry.uv = uv;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,rM=[0,0,0,255],L4e={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getSourceColor:{type:"accessor",value:rM},getTargetColor:{type:"accessor",value:rM},getWidth:{type:"accessor",value:1},getHeight:{type:"accessor",value:1},getTilt:{type:"accessor",value:0},greatCircle:!1,numSegments:{type:"number",value:50,min:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class ZR extends nl{constructor(...e){super(...e),q(this,"state",void 0)}getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:O4e,fs:R4e,modules:[Mc,Oc]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceSourceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getSourceColor",defaultValue:rM},instanceTargetColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getTargetColor",defaultValue:rM},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1},instanceHeights:{size:1,transition:!0,accessor:"getHeight",defaultValue:1},instanceTilts:{size:1,transition:!0,accessor:"getTilt",defaultValue:0}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e;if(i.extensionsChanged||i.propsChanged&&n.numSegments!==r.numSegments){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{widthUnits:n,widthScale:r,widthMinPixels:i,widthMaxPixels:o,greatCircle:a,wrapLongitude:s}=this.props;this.state.model.setUniforms(e).setUniforms({greatCircle:a,widthUnits:Bu[n],widthScale:r,widthMinPixels:i,widthMaxPixels:o,useShortestPath:s}).draw()}_getModel(e){const{id:n,numSegments:r}=this.props;let i=[];for(let a=0;a<r;a++)i=i.concat([a,1,0,a,-1,0]);const o=new Oa(e,{...this.getShaders(),id:n,geometry:new Cs({drawMode:5,attributes:{positions:new Float32Array(i)}}),isInstanced:!0});return o.setUniforms({numSegments:r}),o}}q(ZR,"layerName","ArcLayer");q(ZR,"defaultProps",L4e);const D4e=new Uint16Array([0,2,1,0,3,2]),B4e=new Float32Array([0,1,0,0,1,0,1,1]);function N4e(t,e){if(!e)return F4e(t);const n=Math.max(Math.abs(t[0][0]-t[3][0]),Math.abs(t[1][0]-t[2][0])),r=Math.max(Math.abs(t[1][1]-t[0][1]),Math.abs(t[2][1]-t[3][1])),i=Math.ceil(n/e)+1,o=Math.ceil(r/e)+1,a=(i-1)*(o-1)*6,s=new Uint32Array(a),u=new Float32Array(i*o*2),d=new Float64Array(i*o*3);let g=0,_=0;for(let E=0;E<i;E++){const P=E/(i-1);for(let O=0;O<o;O++){const D=O/(o-1),V=k4e(t,P,D);d[g*3+0]=V[0],d[g*3+1]=V[1],d[g*3+2]=V[2]||0,u[g*2+0]=P,u[g*2+1]=1-D,E>0&&O>0&&(s[_++]=g-o,s[_++]=g-o-1,s[_++]=g-1,s[_++]=g-o,s[_++]=g-1,s[_++]=g),g++}}return{vertexCount:a,positions:d,indices:s,texCoords:u}}function F4e(t){const e=new Float64Array(12);for(let n=0;n<t.length;n++)e[n*3+0]=t[n][0],e[n*3+1]=t[n][1],e[n*3+2]=t[n][2]||0;return{vertexCount:6,positions:e,indices:D4e,texCoords:B4e}}function k4e(t,e,n){return pc(pc(t[0],t[1],n),pc(t[3],t[2],n),e)}const z4e=`
#define SHADER_NAME bitmap-layer-vertex-shader

attribute vec2 texCoords;
attribute vec3 positions;
attribute vec3 positions64Low;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float coordinateConversion;

const vec3 pickingColor = vec3(1.0, 0.0, 0.0);

void main(void) {
  geometry.worldPosition = positions;
  geometry.uv = texCoords;
  geometry.pickingColor = pickingColor;

  gl_Position = project_position_to_clipspace(positions, positions64Low, vec3(0.0), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  vTexCoord = texCoords;

  if (coordinateConversion < -0.5) {
    vTexPos = geometry.position.xy + project_uCommonOrigin.xy;
  } else if (coordinateConversion > 0.5) {
    vTexPos = geometry.worldPosition.xy;
  }

  vec4 color = vec4(0.0);
  DECKGL_FILTER_COLOR(color, geometry);
}
`,U4e=`
vec3 packUVsIntoRGB(vec2 uv) {
  // Extract the top 8 bits. We want values to be truncated down so we can add a fraction
  vec2 uv8bit = floor(uv * 256.);

  // Calculate the normalized remainders of u and v parts that do not fit into 8 bits
  // Scale and clamp to 0-1 range
  vec2 uvFraction = fract(uv * 256.);
  vec2 uvFraction4bit = floor(uvFraction * 16.);

  // Remainder can be encoded in blue channel, encode as 4 bits for pixel coordinates
  float fractions = uvFraction4bit.x + uvFraction4bit.y * 16.;

  return vec3(uv8bit, fractions) / 255.;
}
`,G4e=`
#define SHADER_NAME bitmap-layer-fragment-shader

#ifdef GL_ES
precision highp float;
#endif

uniform sampler2D bitmapTexture;

varying vec2 vTexCoord;
varying vec2 vTexPos;

uniform float desaturate;
uniform vec4 transparentColor;
uniform vec3 tintColor;
uniform float opacity;

uniform float coordinateConversion;
uniform vec4 bounds;

/* projection utils */
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / PI / 2.0;

// from degrees to Web Mercator
vec2 lnglat_to_mercator(vec2 lnglat) {
  float x = lnglat.x;
  float y = clamp(lnglat.y, -89.9, 89.9);
  return vec2(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// from Web Mercator to degrees
vec2 mercator_to_lnglat(vec2 xy) {
  xy /= WORLD_SCALE;
  return degrees(vec2(
    xy.x - PI,
    atan(exp(xy.y - PI)) * 2.0 - PI * 0.5
  ));
}
/* End projection utils */

// apply desaturation
vec3 color_desaturate(vec3 color) {
  float luminance = (color.r + color.g + color.b) * 0.333333333;
  return mix(color, vec3(luminance), desaturate);
}

// apply tint
vec3 color_tint(vec3 color) {
  return color * tintColor;
}

// blend with background color
vec4 apply_opacity(vec3 color, float alpha) {
  if (transparentColor.a == 0.0) {
    return vec4(color, alpha);
  }
  float blendedAlpha = alpha + transparentColor.a * (1.0 - alpha);
  float highLightRatio = alpha / blendedAlpha;
  vec3 blendedRGB = mix(transparentColor.rgb, color, highLightRatio);
  return vec4(blendedRGB, blendedAlpha);
}

vec2 getUV(vec2 pos) {
  return vec2(
    (pos.x - bounds[0]) / (bounds[2] - bounds[0]),
    (pos.y - bounds[3]) / (bounds[1] - bounds[3])
  );
}

`.concat(U4e,`

void main(void) {
  vec2 uv = vTexCoord;
  if (coordinateConversion < -0.5) {
    vec2 lnglat = mercator_to_lnglat(vTexPos);
    uv = getUV(lnglat);
  } else if (coordinateConversion > 0.5) {
    vec2 commonPos = lnglat_to_mercator(vTexPos);
    uv = getUV(commonPos);
  }
  vec4 bitmapColor = texture2D(bitmapTexture, uv);

  gl_FragColor = apply_opacity(color_tint(color_desaturate(bitmapColor.rgb)), bitmapColor.a * opacity);

  geometry.uv = uv;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);

  if (picking_uActive && !picking_uAttribute) {
    // Since instance information is not used, we can use picking color for pixel index
    gl_FragColor.rgb = packUVsIntoRGB(uv);
  }
}
`),j4e={image:{type:"image",value:null,async:!0},bounds:{type:"array",value:[1,0,0,1],compare:!0},_imageCoordinateSystem:Br.DEFAULT,desaturate:{type:"number",min:0,max:1,value:0},transparentColor:{type:"color",value:[0,0,0,0]},tintColor:{type:"color",value:[255,255,255]},textureParameters:{type:"object",ignore:!0}};class YR extends nl{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(){return super.getShaders({vs:z4e,fs:G4e,modules:[Mc,Oc]})}initializeState(){const e=this.getAttributeManager();e.remove(["instancePickingColors"]);const n=!0;e.add({indices:{size:1,isIndexed:!0,update:r=>r.value=this.state.mesh.indices,noAlloc:n},positions:{size:3,type:5130,fp64:this.use64bitPositions(),update:r=>r.value=this.state.mesh.positions,noAlloc:n},texCoords:{size:2,update:r=>r.value=this.state.mesh.texCoords,noAlloc:n}})}updateState({props:e,oldProps:n,changeFlags:r}){const i=this.getAttributeManager();if(r.extensionsChanged){var o;const{gl:a}=this.context;(o=this.state.model)===null||o===void 0||o.delete(),this.state.model=this._getModel(a),i.invalidateAll()}if(e.bounds!==n.bounds){const a=this.state.mesh,s=this._createMesh();this.state.model.setVertexCount(s.vertexCount);for(const u in s)a&&a[u]!==s[u]&&i.invalidate(u);this.setState({mesh:s,...this._getCoordinateUniforms()})}else e._imageCoordinateSystem!==n._imageCoordinateSystem&&this.setState(this._getCoordinateUniforms())}getPickingInfo(e){const{image:n}=this.props,r=e.info;if(!r.color||!n)return r.bitmap=null,r;const{width:i,height:o}=n;r.index=0;const a=V4e(r.color),s=[Math.floor(a[0]*i),Math.floor(a[1]*o)];return r.bitmap={size:{width:i,height:o},uv:a,pixel:s},r}disablePickingIndex(){this.setState({disablePicking:!0})}restorePickingColors(){this.setState({disablePicking:!1})}_updateAutoHighlight(e){super._updateAutoHighlight({...e,color:this.encodePickingColor(0)})}_createMesh(){const{bounds:e}=this.props;let n=e;return IW(e)&&(n=[[e[0],e[1]],[e[0],e[3]],[e[2],e[3]],[e[2],e[1]]]),N4e(n,this.context.viewport.resolution)}_getModel(e){return e?new Oa(e,{...this.getShaders(),id:this.props.id,geometry:new Cs({drawMode:4,vertexCount:6}),isInstanced:!1}):null}draw(e){const{uniforms:n,moduleParameters:r}=e,{model:i,coordinateConversion:o,bounds:a,disablePicking:s}=this.state,{image:u,desaturate:d,transparentColor:g,tintColor:_}=this.props;r.pickingActive&&s||u&&i&&i.setUniforms(n).setUniforms({bitmapTexture:u,desaturate:d,transparentColor:g.map(E=>E/255),tintColor:_.slice(0,3).map(E=>E/255),coordinateConversion:o,bounds:a}).draw()}_getCoordinateUniforms(){const{LNGLAT:e,CARTESIAN:n,DEFAULT:r}=Br;let{_imageCoordinateSystem:i}=this.props;if(i!==r){const{bounds:o}=this.props;if(!IW(o))throw new Error("_imageCoordinateSystem only supports rectangular bounds");const a=this.context.viewport.resolution?e:n;if(i=i===e?e:n,i===e&&a===n)return{coordinateConversion:-1,bounds:o};if(i===n&&a===e){const s=El([o[0],o[1]]),u=El([o[2],o[3]]);return{coordinateConversion:1,bounds:[s[0],s[1],u[0],u[1]]}}}return{coordinateConversion:0,bounds:[0,0,0,0]}}}q(YR,"layerName","BitmapLayer");q(YR,"defaultProps",j4e);function V4e(t){const[e,n,r]=t,i=(r&240)/256,o=(r&15)/16;return[(e+o)/256,(n+i)/256]}function IW(t){return Number.isFinite(t[0])}const $4e=`#define SHADER_NAME icon-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute vec4 instanceIconFrames;
attribute float instanceColorModes;
attribute vec2 instanceOffsets;
attribute vec2 instancePixelOffset;

uniform float sizeScale;
uniform vec2 iconsTextureDim;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform bool billboard;
uniform int sizeUnits;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = angle * PI / 180.0;
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;

  vec2 iconSize = instanceIconFrames.zw;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits), 
    sizeMinPixels, sizeMaxPixels
  );
  float instanceScale = iconSize.y == 0.0 ? 0.0 : sizePixels / iconSize.y;
  vec2 pixelOffset = positions / 2.0 * iconSize + instanceOffsets;
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles) * instanceScale;
  pixelOffset += instancePixelOffset;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);

  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position); 
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }

  vTextureCoords = mix(
    instanceIconFrames.xy,
    instanceIconFrames.xy + iconSize,
    (positions.xy + 1.0) / 2.0
  ) / iconsTextureDim;

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);

  vColorMode = instanceColorModes;
}
`,H4e=`#define SHADER_NAME icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float alphaCutoff;

varying float vColorMode;
varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  vec4 texColor = texture2D(iconsTexture, vTextureCoords);
  vec3 color = mix(texColor.rgb, vColor.rgb, vColorMode);
  float a = texColor.a * opacity * vColor.a;

  if (a < alphaCutoff) {
    discard;
  }

  gl_FragColor = vec4(color, a);
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,W4e=1024,q4e=4,MW=()=>{},OW={10241:9987,10240:9729,10242:33071,10243:33071};function X4e(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function Z4e(t,e,n,r){const i=Math.min(n/e.width,r/e.height),o=Math.floor(e.width*i),a=Math.floor(e.height*i);return i===1?{data:e,width:o,height:a}:(t.canvas.height=a,t.canvas.width=o,t.clearRect(0,0,o,a),t.drawImage(e,0,0,e.width,e.height,0,0,o,a),{data:t.canvas,width:o,height:a})}function lE(t){return t&&(t.id||t.url)}function Y4e(t,e,n,r){const i=t.width,o=t.height,a=new Pl(t.gl,{width:e,height:n,parameters:r});return mte(t,a,{targetY:0,width:i,height:o}),t.delete(),a}function RW(t,e,n){for(let r=0;r<e.length;r++){const{icon:i,xOffset:o}=e[r],a=lE(i);t[a]={...i,x:o,y:n}}}function Q4e({icons:t,buffer:e,mapping:n={},xOffset:r=0,yOffset:i=0,rowHeight:o=0,canvasWidth:a}){let s=[];for(let u=0;u<t.length;u++){const d=t[u],g=lE(d);if(!n[g]){const{height:_,width:E}=d;r+E+e>a&&(RW(n,s,i),r=0,i=o+i+e,o=0,s=[]),s.push({icon:d,xOffset:r}),r=r+E+e,o=Math.max(o,_)}}return s.length>0&&RW(n,s,i),{mapping:n,rowHeight:o,xOffset:r,yOffset:i,canvasWidth:a,canvasHeight:X4e(o+i+e)}}function K4e(t,e,n){if(!t||!e)return null;n=n||{};const r={},{iterable:i,objectInfo:o}=Tg(t);for(const a of i){o.index++;const s=e(a,o),u=lE(s);if(!s)throw new Error("Icon is missing.");if(!s.url)throw new Error("Icon url is missing.");!r[u]&&(!n[u]||s.url!==n[u].url)&&(r[u]={...s,source:a,sourceIndex:o.index})}return r}class J4e{constructor(e,{onUpdate:n=MW,onError:r=MW}){q(this,"gl",void 0),q(this,"onUpdate",void 0),q(this,"onError",void 0),q(this,"_loadOptions",null),q(this,"_texture",null),q(this,"_externalTexture",null),q(this,"_mapping",{}),q(this,"_textureParameters",null),q(this,"_pendingCount",0),q(this,"_autoPacking",!1),q(this,"_xOffset",0),q(this,"_yOffset",0),q(this,"_rowHeight",0),q(this,"_buffer",q4e),q(this,"_canvasWidth",W4e),q(this,"_canvasHeight",0),q(this,"_canvas",null),this.gl=e,this.onUpdate=n,this.onError=r}finalize(){var e;(e=this._texture)===null||e===void 0||e.delete()}getTexture(){return this._texture||this._externalTexture}getIconMapping(e){const n=this._autoPacking?lE(e):e;return this._mapping[n]||{}}setProps({loadOptions:e,autoPacking:n,iconAtlas:r,iconMapping:i,textureParameters:o}){if(e&&(this._loadOptions=e),n!==void 0&&(this._autoPacking=n),i&&(this._mapping=i),r){var a;(a=this._texture)===null||a===void 0||a.delete(),this._texture=null,this._externalTexture=r}o&&(this._textureParameters=o)}get isLoaded(){return this._pendingCount===0}packIcons(e,n){if(!this._autoPacking||typeof document>"u")return;const r=Object.values(K4e(e,n,this._mapping)||{});if(r.length>0){const{mapping:i,xOffset:o,yOffset:a,rowHeight:s,canvasHeight:u}=Q4e({icons:r,buffer:this._buffer,canvasWidth:this._canvasWidth,mapping:this._mapping,rowHeight:this._rowHeight,xOffset:this._xOffset,yOffset:this._yOffset});this._rowHeight=s,this._mapping=i,this._xOffset=o,this._yOffset=a,this._canvasHeight=u,this._texture||(this._texture=new Pl(this.gl,{width:this._canvasWidth,height:this._canvasHeight,parameters:this._textureParameters||OW})),this._texture.height!==this._canvasHeight&&(this._texture=Y4e(this._texture,this._canvasWidth,this._canvasHeight,this._textureParameters||OW)),this.onUpdate(),this._canvas=this._canvas||document.createElement("canvas"),this._loadIcons(r)}}_loadIcons(e){const n=this._canvas.getContext("2d",{willReadFrequently:!0});for(const r of e)this._pendingCount++,ag(r.url,this._loadOptions).then(i=>{const o=lE(r),a=this._mapping[o],{x:s,y:u,width:d,height:g}=a,{data:_,width:E,height:P}=Z4e(n,i,d,g);this._texture.setSubImageData({data:_,x:s+(d-E)/2,y:u+(g-P)/2,width:E,height:P}),a.width=E,a.height=P,this._texture.generateMipmap(),this.onUpdate()}).catch(i=>{this.onError({url:r.url,source:r.source,sourceIndex:r.sourceIndex,loadOptions:this._loadOptions,error:i})}).finally(()=>{this._pendingCount--})}}const coe=[0,0,0,255],eze={iconAtlas:{type:"image",value:null,async:!0},iconMapping:{type:"object",value:{},async:!0},sizeScale:{type:"number",value:1,min:0},billboard:!0,sizeUnits:"pixels",sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},alphaCutoff:{type:"number",value:.05,min:0,max:1},getPosition:{type:"accessor",value:t=>t.position},getIcon:{type:"accessor",value:t=>t.icon},getColor:{type:"accessor",value:coe},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},onIconError:{type:"function",value:null,optional:!0},textureParameters:{type:"object",ignore:!0}};class l2 extends nl{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(){return super.getShaders({vs:$4e,fs:H4e,modules:[Mc,Oc]})}initializeState(){this.state={iconManager:new J4e(this.context.gl,{onUpdate:this._onUpdate.bind(this),onError:this._onError.bind(this)})},this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceOffsets:{size:2,accessor:"getIcon",transform:this.getInstanceOffset},instanceIconFrames:{size:4,accessor:"getIcon",transform:this.getInstanceIconFrame},instanceColorModes:{size:1,type:5121,accessor:"getIcon",transform:this.getInstanceColorMode},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:coe},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instancePixelOffset:{size:2,transition:!0,accessor:"getPixelOffset"}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,o=this.getAttributeManager(),{iconAtlas:a,iconMapping:s,data:u,getIcon:d,textureParameters:g}=n,{iconManager:_}=this.state,E=a||this.internalState.isAsyncPropLoading("iconAtlas");if(_.setProps({loadOptions:n.loadOptions,autoPacking:!E,iconAtlas:a,iconMapping:E?s:null,textureParameters:g}),E?r.iconMapping!==n.iconMapping&&o.invalidate("getIcon"):(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getIcon))&&_.packIcons(u,d),i.extensionsChanged){var P;const{gl:O}=this.context;(P=this.state.model)===null||P===void 0||P.delete(),this.state.model=this._getModel(O),o.invalidateAll()}}get isLoaded(){return super.isLoaded&&this.state.iconManager.isLoaded}finalizeState(e){super.finalizeState(e),this.state.iconManager.finalize()}draw({uniforms:e}){const{sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,sizeUnits:o,billboard:a,alphaCutoff:s}=this.props,{iconManager:u}=this.state,d=u.getTexture();d&&this.state.model.setUniforms(e).setUniforms({iconsTexture:d,iconsTextureDim:[d.width,d.height],sizeUnits:Bu[o],sizeScale:n,sizeMinPixels:r,sizeMaxPixels:i,billboard:a,alphaCutoff:s}).draw()}_getModel(e){const n=[-1,-1,-1,1,1,1,1,-1];return new Oa(e,{...this.getShaders(),id:this.props.id,geometry:new Cs({drawMode:6,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}_onUpdate(){this.setNeedsRedraw()}_onError(e){var n;const r=(n=this.getCurrentLayer())===null||n===void 0?void 0:n.props.onIconError;r?r(e):Or.error(e.error.message)()}getInstanceOffset(e){const{width:n,height:r,anchorX:i=n/2,anchorY:o=r/2}=this.state.iconManager.getIconMapping(e);return[n/2-i,r/2-o]}getInstanceColorMode(e){return this.state.iconManager.getIconMapping(e).mask?1:0}getInstanceIconFrame(e){const{x:n,y:r,width:i,height:o}=this.state.iconManager.getIconMapping(e);return[n,r,i,o]}}q(l2,"defaultProps",eze);q(l2,"layerName","IconLayer");const tze=`#define SHADER_NAME line-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceSourcePositions;
attribute vec3 instanceTargetPositions;
attribute vec3 instanceSourcePositions64Low;
attribute vec3 instanceTargetPositions64Low;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;
attribute float instanceWidths;

uniform float opacity;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float useShortestPath;
uniform int widthUnits;

varying vec4 vColor;
varying vec2 uv;
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction, float width) {
  vec2 dir_screenspace = normalize(line_clipspace * project_uViewportSize);
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  return dir_screenspace * offset_direction * width / 2.0;
}

vec3 splitLine(vec3 a, vec3 b, float x) {
  float t = (x - a.x) / (b.x - a.x);
  return vec3(x, mix(a.yz, b.yz, t));
}

void main(void) {
  geometry.worldPosition = instanceSourcePositions;
  geometry.worldPositionAlt = instanceTargetPositions;

  vec3 source_world = instanceSourcePositions;
  vec3 target_world = instanceTargetPositions;
  vec3 source_world_64low = instanceSourcePositions64Low;
  vec3 target_world_64low = instanceTargetPositions64Low;

  if (useShortestPath > 0.5 || useShortestPath < -0.5) {
    source_world.x = mod(source_world.x + 180., 360.0) - 180.;
    target_world.x = mod(target_world.x + 180., 360.0) - 180.;
    float deltaLng = target_world.x - source_world.x;

    if (deltaLng * useShortestPath > 180.) {
      source_world.x += 360. * useShortestPath;
      source_world = splitLine(source_world, target_world, 180. * useShortestPath);
      source_world_64low = vec3(0.0);
    } else if (deltaLng * useShortestPath < -180.) {
      target_world.x += 360. * useShortestPath;
      target_world = splitLine(source_world, target_world, 180. * useShortestPath);
      target_world_64low = vec3(0.0);
    } else if (useShortestPath < 0.) {
      gl_Position = vec4(0.);
      return;
    }
  }
  vec4 source_commonspace;
  vec4 target_commonspace;
  vec4 source = project_position_to_clipspace(source_world, source_world_64low, vec3(0.), source_commonspace);
  vec4 target = project_position_to_clipspace(target_world, target_world_64low, vec3(0.), target_commonspace);
  float segmentIndex = positions.x;
  vec4 p = mix(source, target, segmentIndex);
  geometry.position = mix(source_commonspace, target_commonspace, segmentIndex);
  uv = positions.xy;
  geometry.uv = uv;
  geometry.pickingColor = instancePickingColors;
  float widthPixels = clamp(
    project_size_to_pixel(instanceWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels
  );
  vec3 offset = vec3(
    getExtrusionOffset(target.xy - source.xy, positions.y, widthPixels),
    0.0);
  DECKGL_FILTER_SIZE(offset, geometry);
  DECKGL_FILTER_GL_POSITION(p, geometry);
  gl_Position = p + vec4(project_pixel_size_to_clipspace(offset.xy), 0.0, 0.0);
  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,nze=`#define SHADER_NAME line-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,rze=[0,0,0,255],ize={getSourcePosition:{type:"accessor",value:t=>t.sourcePosition},getTargetPosition:{type:"accessor",value:t=>t.targetPosition},getColor:{type:"accessor",value:rze},getWidth:{type:"accessor",value:1},widthUnits:"pixels",widthScale:{type:"number",value:1,min:0},widthMinPixels:{type:"number",value:0,min:0},widthMaxPixels:{type:"number",value:Number.MAX_SAFE_INTEGER,min:0}};class Z6 extends nl{getBounds(){var e;return(e=this.getAttributeManager())===null||e===void 0?void 0:e.getBounds(["instanceSourcePositions","instanceTargetPositions"])}getShaders(){return super.getShaders({vs:tze,fs:nze,modules:[Mc,Oc]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({instanceSourcePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getSourcePosition"},instanceTargetPositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getTargetPosition"},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceWidths:{size:1,transition:!0,accessor:"getWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{widthUnits:n,widthScale:r,widthMinPixels:i,widthMaxPixels:o,wrapLongitude:a}=this.props;this.state.model.setUniforms(e).setUniforms({widthUnits:Bu[n],widthScale:r,widthMinPixels:i,widthMaxPixels:o,useShortestPath:a?1:0}).draw(),a&&this.state.model.setUniforms({useShortestPath:-1}).draw()}_getModel(e){const n=[0,-1,0,0,1,0,1,-1,0,1,1,0];return new Oa(e,{...this.getShaders(),id:this.props.id,geometry:new Cs({drawMode:5,attributes:{positions:new Float32Array(n)}}),isInstanced:!0})}}q(Z6,"layerName","LineLayer");q(Z6,"defaultProps",ize);const oze=`#define SHADER_NAME point-cloud-layer-vertex-shader

attribute vec3 positions;
attribute vec3 instanceNormals;
attribute vec4 instanceColors;
attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusPixels;
uniform int sizeUnits;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.normal = project_normal(instanceNormals);
  unitPosition = positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;
  vec3 offset = vec3(positions.xy * project_size_to_pixel(radiusPixels, sizeUnits), 0.0);
  DECKGL_FILTER_SIZE(offset, geometry);

  gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.), geometry.position);
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  vec3 lightColor = lighting_getLightColor(instanceColors.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
  vColor = vec4(lightColor, instanceColors.a * opacity);
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,sze=`#define SHADER_NAME point-cloud-layer-fragment-shader

precision highp float;

varying vec4 vColor;
varying vec2 unitPosition;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition);

  if (distToCenter > 1.0) {
    discard;
  }

  gl_FragColor = vColor;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,foe=[0,0,0,255],hoe=[0,0,1],aze={sizeUnits:"pixels",pointSize:{type:"number",min:0,value:10},getPosition:{type:"accessor",value:t=>t.position},getNormal:{type:"accessor",value:hoe},getColor:{type:"accessor",value:foe},material:!0,radiusPixels:{deprecatedFor:"pointSize"}};function lze(t){const{header:e,attributes:n}=t;!e||!n||(t.length=e.vertexCount,n.POSITION&&(n.instancePositions=n.POSITION),n.NORMAL&&(n.instanceNormals=n.NORMAL),n.COLOR_0&&(n.instanceColors=n.COLOR_0))}class QR extends nl{getShaders(){return super.getShaders({vs:oze,fs:sze,modules:[Mc,zE,Oc]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceNormals:{size:3,transition:!0,accessor:"getNormal",defaultValue:hoe},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getColor",defaultValue:foe}})}updateState(e){const{changeFlags:n,props:r}=e;if(super.updateState(e),n.extensionsChanged){var i;const{gl:o}=this.context;(i=this.state.model)===null||i===void 0||i.delete(),this.state.model=this._getModel(o),this.getAttributeManager().invalidateAll()}n.dataChanged&&lze(r.data)}draw({uniforms:e}){const{pointSize:n,sizeUnits:r}=this.props;this.state.model.setUniforms(e).setUniforms({sizeUnits:Bu[r],radiusPixels:n}).draw()}_getModel(e){const n=[];for(let r=0;r<3;r++){const i=r/3*Math.PI*2;n.push(Math.cos(i)*2,Math.sin(i)*2,0)}return new Oa(e,{...this.getShaders(),id:this.props.id,geometry:new Cs({drawMode:4,attributes:{positions:new Float32Array(n)}}),isInstanced:!0})}}q(QR,"layerName","PointCloudLayer");q(QR,"defaultProps",aze);const uze=`#define SHADER_NAME scatterplot-layer-vertex-shader

attribute vec3 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute float instanceRadius;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform float opacity;
uniform float radiusScale;
uniform float radiusMinPixels;
uniform float radiusMaxPixels;
uniform float lineWidthScale;
uniform float lineWidthMinPixels;
uniform float lineWidthMaxPixels;
uniform float stroked;
uniform bool filled;
uniform bool antialiasing;
uniform bool billboard;
uniform int radiusUnits;
uniform int lineWidthUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;


void main(void) {
  geometry.worldPosition = instancePositions;
  outerRadiusPixels = clamp(
    project_size_to_pixel(radiusScale * instanceRadius, radiusUnits),
    radiusMinPixels, radiusMaxPixels
  );
  float lineWidthPixels = clamp(
    project_size_to_pixel(lineWidthScale * instanceLineWidths, lineWidthUnits),
    lineWidthMinPixels, lineWidthMaxPixels
  );
  outerRadiusPixels += stroked * lineWidthPixels / 2.0;
  float edgePadding = antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
  unitPosition = edgePadding * positions.xy;
  geometry.uv = unitPosition;
  geometry.pickingColor = instancePickingColors;

  innerUnitRadius = 1.0 - stroked * lineWidthPixels / outerRadiusPixels;
  
  if (billboard) {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = edgePadding * positions * outerRadiusPixels;
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,cze=`#define SHADER_NAME scatterplot-layer-fragment-shader

precision highp float;

uniform bool filled;
uniform float stroked;
uniform bool antialiasing;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying vec2 unitPosition;
varying float innerUnitRadius;
varying float outerRadiusPixels;

void main(void) {
  geometry.uv = unitPosition;

  float distToCenter = length(unitPosition) * outerRadiusPixels;
  float inCircle = antialiasing ? 
    smoothedge(distToCenter, outerRadiusPixels) : 
    step(distToCenter, outerRadiusPixels);

  if (inCircle == 0.0) {
    discard;
  }

  if (stroked > 0.5) {
    float isLine = antialiasing ? 
      smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
      step(innerUnitRadius * outerRadiusPixels, distToCenter);

    if (filled) {
      gl_FragColor = mix(vFillColor, vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        discard;
      }
      gl_FragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
    }
  } else if (!filled) {
    discard;
  } else {
    gl_FragColor = vFillColor;
  }

  gl_FragColor.a *= inCircle;
  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,LW=[0,0,0,255],fze={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:t=>t.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:LW},getLineColor:{type:"accessor",value:LW},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class KR extends nl{getShaders(){return super.getShaders({vs:uze,fs:cze,modules:[Mc,Oc]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){if(super.updateState(e),e.changeFlags.extensionsChanged){var n;const{gl:r}=this.context;(n=this.state.model)===null||n===void 0||n.delete(),this.state.model=this._getModel(r),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{radiusUnits:n,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:o,stroked:a,filled:s,billboard:u,antialiasing:d,lineWidthUnits:g,lineWidthScale:_,lineWidthMinPixels:E,lineWidthMaxPixels:P}=this.props;this.state.model.setUniforms(e).setUniforms({stroked:a?1:0,filled:s,billboard:u,antialiasing:d,radiusUnits:Bu[n],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:o,lineWidthUnits:Bu[g],lineWidthScale:_,lineWidthMinPixels:E,lineWidthMaxPixels:P}).draw()}_getModel(e){const n=[-1,-1,0,1,-1,0,1,1,0,-1,1,0];return new Oa(e,{...this.getShaders(),id:this.props.id,geometry:new Cs({drawMode:6,vertexCount:4,attributes:{positions:{size:3,value:new Float32Array(n)}}}),isInstanced:!0})}}q(KR,"defaultProps",fze);q(KR,"layerName","ScatterplotLayer");const Y6={CLOCKWISE:1,COUNTER_CLOCKWISE:-1};function Q6(t,e,n={}){return hze(t,n)!==e?(dze(t,n),!0):!1}function hze(t,e={}){return Math.sign(iM(t,e))}function iM(t,e={}){const{start:n=0,end:r=t.length}=e,i=e.size||2;let o=0;for(let a=n,s=r-i;a<r;a+=i)o+=(t[a]-t[s])*(t[a+1]+t[s+1]),s=a;return o/2}function dze(t,e){const{start:n=0,end:r=t.length,size:i=2}=e,o=(r-n)/i,a=Math.floor(o/2);for(let s=0;s<a;++s){const u=n+s*i,d=n+(o-1-s)*i;for(let g=0;g<i;++g){const _=t[u+g];t[u+g]=t[d+g],t[d+g]=_}}}function pze(t,e,n=2,r){const i=e&&e.length,o=i?e[0]*n:t.length;let a=doe(t,0,o,n,!0,r&&r[0]);const s=[];if(!a||a.next===a.prev)return s;let u,d,g,_,E,P,O;if(i&&(a=yze(t,e,a,n,r)),t.length>80*n){_=d=t[0],E=g=t[1];for(let D=n;D<o;D+=n)P=t[D],O=t[D+1],P<_&&(_=P),O<E&&(E=O),P>d&&(d=P),O>g&&(g=O);u=Math.max(d-_,g-E),u=u!==0?1/u:0}return uE(a,s,n,_,E,u),s}function doe(t,e,n,r,i,o){let a,s;if(o===void 0&&(o=iM(t,{start:e,end:n,size:r})),i===o<0)for(a=e;a<n;a+=r)s=DW(a,t[a],t[a+1],s);else for(a=n-r;a>=e;a-=r)s=DW(a,t[a],t[a+1],s);return s&&JR(s,s.next)&&(fE(s),s=s.next),s}function cA(t,e){if(!t)return t;e||(e=t);let n=t,r;do if(r=!1,!n.steiner&&(JR(n,n.next)||ns(n.prev,n,n.next)===0)){if(fE(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function uE(t,e,n,r,i,o,a){if(!t)return;!a&&o&&Eze(t,r,i,o);let s=t,u,d;for(;t.prev!==t.next;){if(u=t.prev,d=t.next,o?mze(t,r,i,o):gze(t)){e.push(u.i/n),e.push(t.i/n),e.push(d.i/n),fE(t),t=d.next,s=d.next;continue}if(t=d,t===s){a?a===1?(t=Aze(cA(t),e,n),uE(t,e,n,r,i,o,2)):a===2&&_ze(t,e,n,r,i,o):uE(cA(t),e,n,r,i,o,1);break}}}function gze(t){const e=t.prev,n=t,r=t.next;if(ns(e,n,r)>=0)return!1;let i=t.next.next;for(;i!==t.prev;){if(sv(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&ns(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function mze(t,e,n,r){const i=t.prev,o=t,a=t.next;if(ns(i,o,a)>=0)return!1;const s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,d=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,g=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,_=_4(s,u,e,n,r),E=_4(d,g,e,n,r);let P=t.prevZ,O=t.nextZ;for(;P&&P.z>=_&&O&&O.z<=E;){if(P!==t.prev&&P!==t.next&&sv(i.x,i.y,o.x,o.y,a.x,a.y,P.x,P.y)&&ns(P.prev,P,P.next)>=0||(P=P.prevZ,O!==t.prev&&O!==t.next&&sv(i.x,i.y,o.x,o.y,a.x,a.y,O.x,O.y)&&ns(O.prev,O,O.next)>=0))return!1;O=O.nextZ}for(;P&&P.z>=_;){if(P!==t.prev&&P!==t.next&&sv(i.x,i.y,o.x,o.y,a.x,a.y,P.x,P.y)&&ns(P.prev,P,P.next)>=0)return!1;P=P.prevZ}for(;O&&O.z<=E;){if(O!==t.prev&&O!==t.next&&sv(i.x,i.y,o.x,o.y,a.x,a.y,O.x,O.y)&&ns(O.prev,O,O.next)>=0)return!1;O=O.nextZ}return!0}function Aze(t,e,n){let r=t;do{const i=r.prev,o=r.next.next;!JR(i,o)&&poe(i,r,r.next,o)&&cE(i,o)&&cE(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),fE(r),fE(r.next),r=t=o),r=r.next}while(r!==t);return cA(r)}function _ze(t,e,n,r,i,o){let a=t;do{let s=a.next.next;for(;s!==a.prev;){if(a.i!==s.i&&Cze(a,s)){let u=goe(a,s);a=cA(a,a.next),u=cA(u,u.next),uE(a,e,n,r,i,o),uE(u,e,n,r,i,o);return}s=s.next}a=a.next}while(a!==t)}function yze(t,e,n,r,i){const o=[];let a,s,u,d,g;for(a=0,s=e.length;a<s;a++)u=e[a]*r,d=a<s-1?e[a+1]*r:t.length,g=doe(t,u,d,r,!1,i&&i[a+1]),g===g.next&&(g.steiner=!0),o.push(Tze(g));for(o.sort(vze),a=0;a<o.length;a++)xze(o[a],n),n=cA(n,n.next);return n}function vze(t,e){return t.x-e.x}function xze(t,e){if(e=bze(t,e),e){const n=goe(e,t);cA(e,e.next),cA(n,n.next)}}function bze(t,e){let n=e;const r=t.x,i=t.y;let o=-1/0,a;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){const E=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(E<=r&&E>o){if(o=E,E===r){if(i===n.y)return n;if(i===n.next.y)return n.next}a=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!a)return null;if(r===o)return a;const s=a,u=a.x,d=a.y;let g=1/0,_;n=a;do r>=n.x&&n.x>=u&&r!==n.x&&sv(i<d?r:o,i,u,d,i<d?o:r,i,n.x,n.y)&&(_=Math.abs(i-n.y)/(r-n.x),cE(n,t)&&(_<g||_===g&&(n.x>a.x||n.x===a.x&&wze(a,n)))&&(a=n,g=_)),n=n.next;while(n!==s);return a}function wze(t,e){return ns(t.prev,t,e.prev)<0&&ns(e.next,t,t.next)<0}function Eze(t,e,n,r){let i=t;do i.z===null&&(i.z=_4(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,Sze(i)}function Sze(t){let e,n,r=1,i,o,a,s,u,d;do{for(o=t,t=null,d=null,i=0;o;){for(i++,s=o,a=0,n=0;n<r&&(a++,s=s.nextZ,!!s);n++);for(u=r;a>0||u>0&&s;)a!==0&&(u===0||!s||o.z<=s.z)?(e=o,o=o.nextZ,a--):(e=s,s=s.nextZ,u--),d?d.nextZ=e:t=e,e.prevZ=d,d=e;o=s}d.nextZ=null,r*=2}while(i>1);return t}function _4(t,e,n,r,i){return t=32767*(t-n)*i,e=32767*(e-r)*i,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function Tze(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function sv(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Cze(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Pze(t,e)&&(cE(t,e)&&cE(e,t)&&Ize(t,e)&&(ns(t.prev,t,e.prev)||ns(t,e.prev,e))||JR(t,e)&&ns(t.prev,t,t.next)>0&&ns(e.prev,e,e.next)>0)}function ns(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function JR(t,e){return t.x===e.x&&t.y===e.y}function poe(t,e,n,r){const i=tT(ns(t,e,n)),o=tT(ns(t,e,r)),a=tT(ns(n,r,t)),s=tT(ns(n,r,e));return!!(i!==o&&a!==s||i===0&&eT(t,n,e)||o===0&&eT(t,r,e)||a===0&&eT(n,t,r)||s===0&&eT(n,e,r))}function eT(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function tT(t){return t>0?1:t<0?-1:0}function Pze(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&poe(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function cE(t,e){return ns(t.prev,t,t.next)<0?ns(t,e,t.next)>=0&&ns(t,t.prev,e)>=0:ns(t,e,t.prev)<0||ns(t,t.next,e)<0}function Ize(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,o=(t.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function goe(t,e){const n=new y4(t.i,t.x,t.y),r=new y4(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function DW(t,e,n,r){const i=new y4(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function fE(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function y4(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function gh(t,e){const n=e.length,r=t.length;if(r>0){let i=!0;for(let o=0;o<n;o++)if(t[r-n+o]!==e[o]){i=!1;break}if(i)return!1}for(let i=0;i<n;i++)t[r+i]=e[i];return!0}function v4(t,e){const n=e.length;for(let r=0;r<n;r++)t[r]=e[r]}function hE(t,e,n,r,i=[]){const o=r+e*n;for(let a=0;a<n;a++)i[a]=t[o+a];return i}function x4(t,e,n,r,i=[]){let o,a;if(n&8)o=(r[3]-t[1])/(e[1]-t[1]),a=3;else if(n&4)o=(r[1]-t[1])/(e[1]-t[1]),a=1;else if(n&2)o=(r[2]-t[0])/(e[0]-t[0]),a=2;else if(n&1)o=(r[0]-t[0])/(e[0]-t[0]),a=0;else return null;for(let s=0;s<t.length;s++)i[s]=(a&1)===s?r[a]:o*(e[s]-t[s])+t[s];return i}function lP(t,e){let n=0;return t[0]<e[0]?n|=1:t[0]>e[2]&&(n|=2),t[1]<e[1]?n|=4:t[1]>e[3]&&(n|=8),n}function moe(t,e){const{size:n=2,broken:r=!1,gridResolution:i=10,gridOffset:o=[0,0],startIndex:a=0,endIndex:s=t.length}=e||{},u=(s-a)/n;let d=[];const g=[d],_=hE(t,0,n,a);let E,P;const O=_oe(_,i,o,[]),D=[];gh(d,_);for(let V=1;V<u;V++){for(E=hE(t,V,n,a,E),P=lP(E,O);P;){x4(_,E,P,O,D);const k=lP(D,O);k&&(x4(_,D,k,O,D),P=k),gh(d,D),v4(_,D),Oze(O,i,P),r&&d.length>n&&(d=[],g.push(d),gh(d,_)),P=lP(E,O)}gh(d,E),v4(_,E)}return r?g:g[0]}const BW=0,Mze=1;function nT(t,e){for(let n=0;n<e.length;n++)t.push(e[n]);return t}function Aoe(t,e=null,n){if(!t.length)return[];const{size:r=2,gridResolution:i=10,gridOffset:o=[0,0],edgeTypes:a=!1}=n||{},s=[],u=[{pos:t,types:a?new Array(t.length/r).fill(Mze):null,holes:e||[]}],d=[[],[]];let g=[];for(;u.length;){const{pos:_,types:E,holes:P}=u.shift();Rze(_,r,P[0]||_.length,d),g=_oe(d[0],i,o,g);const O=lP(d[1],g);if(O){let D=NW(_,E,r,0,P[0]||_.length,g,O);const V={pos:D[0].pos,types:D[0].types,holes:[]},k={pos:D[1].pos,types:D[1].types,holes:[]};u.push(V,k);for(let F=0;F<P.length;F++)D=NW(_,E,r,P[F],P[F+1]||_.length,g,O),D[0]&&(V.holes.push(V.pos.length),V.pos=nT(V.pos,D[0].pos),a&&(V.types=nT(V.types,D[0].types))),D[1]&&(k.holes.push(k.pos.length),k.pos=nT(k.pos,D[1].pos),a&&(k.types=nT(k.types,D[1].types)))}else{const D={positions:_};a&&(D.edgeTypes=E),P.length&&(D.holeIndices=P),s.push(D)}}return s}function NW(t,e,n,r,i,o,a){const s=(i-r)/n,u=[],d=[],g=[],_=[],E=[];let P,O,D;const V=hE(t,s-1,n,r);let k=Math.sign(a&8?V[1]-o[3]:V[0]-o[2]),F=e&&e[s-1],z=0,X=0;for(let Y=0;Y<s;Y++)P=hE(t,Y,n,r,P),O=Math.sign(a&8?P[1]-o[3]:P[0]-o[2]),D=e&&e[r/n+Y],O&&k&&k!==O&&(x4(V,P,a,o,E),gh(u,E)&&g.push(F),gh(d,E)&&_.push(F)),O<=0?(gh(u,P)&&g.push(D),z-=O):g.length&&(g[g.length-1]=BW),O>=0?(gh(d,P)&&_.push(D),X+=O):_.length&&(_[_.length-1]=BW),v4(V,P),k=O,F=D;return[z?{pos:u,types:e&&g}:null,X?{pos:d,types:e&&_}:null]}function _oe(t,e,n,r){const i=Math.floor((t[0]-n[0])/e)*e+n[0],o=Math.floor((t[1]-n[1])/e)*e+n[1];return r[0]=i,r[1]=o,r[2]=i+e,r[3]=o+e,r}function Oze(t,e,n){n&8?(t[1]+=e,t[3]+=e):n&4?(t[1]-=e,t[3]-=e):n&2?(t[0]+=e,t[2]+=e):n&1&&(t[0]-=e,t[2]-=e)}function Rze(t,e,n,r){let i=1/0,o=-1/0,a=1/0,s=-1/0;for(let u=0;u<n;u+=e){const d=t[u],g=t[u+1];i=d<i?d:i,o=d>o?d:o,a=g<a?g:a,s=g>s?g:s}return r[0][0]=i,r[0][1]=a,r[1][0]=o,r[1][1]=s,r}const Lze=85.051129;function Dze(t,e){const{size:n=2,startIndex:r=0,endIndex:i=t.length,normalize:o=!0}=e||{},a=t.slice(r,i);yoe(a,n,0,i-r);const s=moe(a,{size:n,broken:!0,gridResolution:360,gridOffset:[-180,-180]});if(o)for(const u of s)voe(u,n);return s}function Bze(t,e=null,n){const{size:r=2,normalize:i=!0,edgeTypes:o=!1}=n||{};e=e||[];const a=[],s=[];let u=0,d=0;for(let _=0;_<=e.length;_++){const E=e[_]||t.length,P=d,O=Nze(t,r,u,E);for(let D=O;D<E;D++)a[d++]=t[D];for(let D=u;D<O;D++)a[d++]=t[D];yoe(a,r,P,d),Fze(a,r,P,d,n==null?void 0:n.maxLatitude),u=E,s[_]=d}s.pop();const g=Aoe(a,s,{size:r,gridResolution:360,gridOffset:[-180,-180],edgeTypes:o});if(i)for(const _ of g)voe(_.positions,r);return g}function Nze(t,e,n,r){let i=-1,o=-1;for(let a=n+1;a<r;a+=e){const s=Math.abs(t[a]);s>i&&(i=s,o=a-1)}return o}function Fze(t,e,n,r,i=Lze){const o=t[n],a=t[r-e];if(Math.abs(o-a)>180){const s=hE(t,0,e,n);s[0]+=Math.round((a-o)/360)*360,gh(t,s),s[1]=Math.sign(s[1])*i,gh(t,s),s[0]=o,gh(t,s)}}function yoe(t,e,n,r){let i=t[0],o;for(let a=n;a<r;a+=e){o=t[a];const s=o-i;(s>180||s<-180)&&(o-=Math.round(s/360)*360),t[a]=i=o}}function voe(t,e){let n;const r=t.length/e;for(let o=0;o<r&&(n=t[o*e],(n+180)%360===0);o++);const i=-Math.round(n/360)*360;if(i!==0)for(let o=0;o<r;o++)t[o*e]+=i}class kze extends Cs{constructor(e){const{id:n=Ma("column-geometry")}=e,{indices:r,attributes:i}=zze(e);super({...e,id:n,indices:r,attributes:i})}}function zze(t){const{radius:e,height:n=1,nradial:r=10}=t;let{vertices:i}=t;i&&(Or.assert(i.length>=r),i=i.flatMap(P=>[P[0],P[1]]),Q6(i,Y6.COUNTER_CLOCKWISE));const o=n>0,a=r+1,s=o?a*3+1:r,u=Math.PI*2/r,d=new Uint16Array(o?r*3*2:0),g=new Float32Array(s*3),_=new Float32Array(s*3);let E=0;if(o){for(let P=0;P<a;P++){const O=P*u,D=P%r,V=Math.sin(O),k=Math.cos(O);for(let F=0;F<2;F++)g[E+0]=i?i[D*2]:k*e,g[E+1]=i?i[D*2+1]:V*e,g[E+2]=(1/2-F)*n,_[E+0]=i?i[D*2]:k,_[E+1]=i?i[D*2+1]:V,E+=3}g[E+0]=g[E-3],g[E+1]=g[E-2],g[E+2]=g[E-1],E+=3}for(let P=o?0:1;P<a;P++){const O=Math.floor(P/2)*Math.sign(.5-P%2),D=O*u,V=(O+r)%r,k=Math.sin(D),F=Math.cos(D);g[E+0]=i?i[V*2]:F*e,g[E+1]=i?i[V*2+1]:k*e,g[E+2]=n/2,_[E+2]=1,E+=3}if(o){let P=0;for(let O=0;O<r;O++)d[P++]=O*2+0,d[P++]=O*2+2,d[P++]=O*2+0,d[P++]=O*2+1,d[P++]=O*2+1,d[P++]=O*2+3}return{indices:d,attributes:{POSITION:{size:3,value:g},NORMAL:{size:3,value:_}}}}const Uze=`#version 300 es

#define SHADER_NAME column-layer-vertex-shader

in vec3 positions;
in vec3 normals;

in vec3 instancePositions;
in float instanceElevations;
in vec3 instancePositions64Low;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in float instanceStrokeWidths;

in vec3 instancePickingColors;
uniform float opacity;
uniform float radius;
uniform float angle;
uniform vec2 offset;
uniform bool extruded;
uniform bool stroked;
uniform bool isStroke;
uniform float coverage;
uniform float elevationScale;
uniform float edgeDistance;
uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform int radiusUnits;
uniform int widthUnits;
out vec4 vColor;
#ifdef FLAT_SHADING
out vec4 position_commonspace;
#endif

void main(void) {
  geometry.worldPosition = instancePositions;

  vec4 color = isStroke ? instanceLineColors : instanceFillColors;
  mat2 rotationMatrix = mat2(cos(angle), sin(angle), -sin(angle), cos(angle));
  float elevation = 0.0;
  float strokeOffsetRatio = 1.0;

  if (extruded) {
    elevation = instanceElevations * (positions.z + 1.0) / 2.0 * elevationScale;
  } else if (stroked) {
    float widthPixels = clamp(
      project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
      widthMinPixels, widthMaxPixels) / 2.0;
    float halfOffset = project_pixel_size(widthPixels) / project_size(edgeDistance * coverage * radius);
    if (isStroke) {
      strokeOffsetRatio -= sign(positions.z) * halfOffset;
    } else {
      strokeOffsetRatio -= halfOffset;
    }
  }
  float shouldRender = float(color.a > 0.0 && instanceElevations >= 0.0);
  float dotRadius = radius * coverage * shouldRender;

  geometry.pickingColor = instancePickingColors;
  vec3 centroidPosition = vec3(instancePositions.xy, instancePositions.z + elevation);
  vec3 centroidPosition64Low = instancePositions64Low;
  vec2 offset = (rotationMatrix * positions.xy * strokeOffsetRatio + offset) * dotRadius;
  if (radiusUnits == UNIT_METERS) {
    offset = project_size(offset);
  }
  vec3 pos = vec3(offset, 0.);
  DECKGL_FILTER_SIZE(pos, geometry);

  gl_Position = project_position_to_clipspace(centroidPosition, centroidPosition64Low, pos, geometry.position);
  geometry.normal = project_normal(vec3(rotationMatrix * normals.xy, normals.z));
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  if (extruded && !isStroke) {
#ifdef FLAT_SHADING
    position_commonspace = geometry.position;
    vColor = vec4(color.rgb, color.a * opacity);
#else
    vec3 lightColor = lighting_getLightColor(color.rgb, project_uCameraPosition, geometry.position.xyz, geometry.normal);
    vColor = vec4(lightColor, color.a * opacity);
#endif
  } else {
    vColor = vec4(color.rgb, color.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Gze=`#version 300 es
#define SHADER_NAME column-layer-fragment-shader

precision highp float;

uniform vec3 project_uCameraPosition;
uniform bool extruded;
uniform bool isStroke;

out vec4 fragColor;

in vec4 vColor;
#ifdef FLAT_SHADING
in vec4 position_commonspace;
#endif

void main(void) {
  fragColor = vColor;
#ifdef FLAT_SHADING
  if (extruded && !isStroke && !picking_uActive) {
    vec3 normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
    fragColor.rgb = lighting_getLightColor(vColor.rgb, project_uCameraPosition, position_commonspace.xyz, normal);
  }
#endif
  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,oM=[0,0,0,255],jze={diskResolution:{type:"number",min:4,value:20},vertices:null,radius:{type:"number",min:0,value:1e3},angle:{type:"number",value:0},offset:{type:"array",value:[0,0]},coverage:{type:"number",min:0,max:1,value:1},elevationScale:{type:"number",min:0,value:1},radiusUnits:"meters",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,extruded:!0,wireframe:!1,filled:!0,stroked:!1,getPosition:{type:"accessor",value:t=>t.position},getFillColor:{type:"accessor",value:oM},getLineColor:{type:"accessor",value:oM},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0,getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class u2 extends nl{getShaders(){const{gl:e}=this.context,n=!Hr(e),r={},i=this.props.flatShading&&FE(e,Qi.GLSL_DERIVATIVES);return i&&(r.FLAT_SHADING=1),super.getShaders({vs:Uze,fs:Gze,defines:r,transpileToGLSL100:n,modules:[Mc,i?HO:zE,Oc]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceElevations:{size:1,transition:!0,accessor:"getElevation"},instanceFillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getFillColor",defaultValue:oM},instanceLineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:!0,accessor:"getLineColor",defaultValue:oM},instanceStrokeWidths:{size:1,accessor:"getLineWidth",transition:!0}})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e,o=i.extensionsChanged||n.flatShading!==r.flatShading;if(o){var a;const{gl:s}=this.context;(a=this.state.model)===null||a===void 0||a.delete(),this.state.model=this._getModel(s),this.getAttributeManager().invalidateAll()}(o||n.diskResolution!==r.diskResolution||n.vertices!==r.vertices||(n.extruded||n.stroked)!==(r.extruded||r.stroked))&&this._updateGeometry(n)}getGeometry(e,n,r){const i=new kze({radius:1,height:r?2:0,vertices:n,nradial:e});let o=0;if(n)for(let a=0;a<e;a++){const s=n[a],u=Math.sqrt(s[0]*s[0]+s[1]*s[1]);o+=u/e}else o=1;return this.setState({edgeDistance:Math.cos(Math.PI/e)*o}),i}_getModel(e){return new Oa(e,{...this.getShaders(),id:this.props.id,isInstanced:!0})}_updateGeometry({diskResolution:e,vertices:n,extruded:r,stroked:i}){const o=this.getGeometry(e,n,r||i);this.setState({fillVertexCount:o.attributes.POSITION.value.length/3,wireframeVertexCount:o.indices.value.length}),this.state.model.setProps({geometry:o})}draw({uniforms:e}){const{lineWidthUnits:n,lineWidthScale:r,lineWidthMinPixels:i,lineWidthMaxPixels:o,radiusUnits:a,elevationScale:s,extruded:u,filled:d,stroked:g,wireframe:_,offset:E,coverage:P,radius:O,angle:D}=this.props,{model:V,fillVertexCount:k,wireframeVertexCount:F,edgeDistance:z}=this.state;V.setUniforms(e).setUniforms({radius:O,angle:D/180*Math.PI,offset:E,extruded:u,stroked:g,coverage:P,elevationScale:s,edgeDistance:z,radiusUnits:Bu[a],widthUnits:Bu[n],widthScale:r,widthMinPixels:i,widthMaxPixels:o}),u&&_&&(V.setProps({isIndexed:!0}),V.setVertexCount(F).setDrawMode(1).setUniforms({isStroke:!0}).draw()),d&&(V.setProps({isIndexed:!1}),V.setVertexCount(k).setDrawMode(5).setUniforms({isStroke:!1}).draw()),!u&&g&&(V.setProps({isIndexed:!1}),V.setVertexCount(k*2/3).setDrawMode(5).setUniforms({isStroke:!0}).draw())}}q(u2,"layerName","ColumnLayer");q(u2,"defaultProps",jze);const Vze={cellSize:{type:"number",min:0,value:1e3},offset:{type:"array",value:[1,1]}};class K6 extends u2{getGeometry(e){return new une}draw({uniforms:e}){const{elevationScale:n,extruded:r,offset:i,coverage:o,cellSize:a,angle:s,radiusUnits:u}=this.props;this.state.model.setUniforms(e).setUniforms({radius:a/2,radiusUnits:Bu[u],angle:s,offset:i,extruded:r,coverage:o,elevationScale:n,edgeDistance:1,isWireframe:!1}).draw()}}q(K6,"layerName","GridCellLayer");q(K6,"defaultProps",Vze);function $ze(t,e,n,r){let i;if(Array.isArray(t[0])){const o=t.length*e;i=new Array(o);for(let a=0;a<t.length;a++)for(let s=0;s<e;s++)i[a*e+s]=t[a][s]||0}else i=t;return n?moe(i,{size:e,gridResolution:n}):r?Dze(i,{size:e}):i}const Hze=1,Wze=2,TB=4;class qze extends i6{constructor(e){super({...e,attributes:{positions:{size:3,padding:18,initialize:!0,type:e.fp64?Float64Array:Float32Array},segmentTypes:{size:1,type:Uint8ClampedArray}}})}get(e){return this.attributes[e]}getGeometryFromBuffer(e){return this.normalize?super.getGeometryFromBuffer(e):null}normalizeGeometry(e){return this.normalize?$ze(e,this.positionSize,this.opts.resolution,this.opts.wrapLongitude):e}getGeometrySize(e){if(FW(e)){let r=0;for(const i of e)r+=this.getGeometrySize(i);return r}const n=this.getPathLength(e);return n<2?0:this.isClosed(e)?n<3?0:n+2:n}updateGeometryAttributes(e,n){if(n.geometrySize!==0)if(e&&FW(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i}else this._updateSegmentTypes(e,n),this._updatePositions(e,n)}_updateSegmentTypes(e,n){const r=this.attributes.segmentTypes,i=e?this.isClosed(e):!1,{vertexStart:o,geometrySize:a}=n;r.fill(0,o,o+a),i?(r[o]=TB,r[o+a-2]=TB):(r[o]+=Hze,r[o+a-2]+=Wze),r[o+a-1]=TB}_updatePositions(e,n){const{positions:r}=this.attributes;if(!r||!e)return;const{vertexStart:i,geometrySize:o}=n,a=new Array(3);for(let s=i,u=0;u<o;s++,u++)this.getPointOnPath(e,u,a),r[s*3]=a[0],r[s*3+1]=a[1],r[s*3+2]=a[2]}getPathLength(e){return e.length/this.positionSize}getPointOnPath(e,n,r=[]){const{positionSize:i}=this;n*i>=e.length&&(n+=1-e.length/i);const o=n*i;return r[0]=e[o],r[1]=e[o+1],r[2]=i===3&&e[o+2]||0,r}isClosed(e){if(!this.normalize)return!!this.opts.loop;const{positionSize:n}=this,r=e.length-n;return e[0]===e[r]&&e[1]===e[r+1]&&(n===2||e[2]===e[r+2])}}function FW(t){return Array.isArray(t[0])}const Xze=`#define SHADER_NAME path-layer-vertex-shader

attribute vec2 positions;

attribute float instanceTypes;
attribute vec3 instanceStartPositions;
attribute vec3 instanceEndPositions;
attribute vec3 instanceLeftPositions;
attribute vec3 instanceRightPositions;
attribute vec3 instanceLeftPositions64Low;
attribute vec3 instanceStartPositions64Low;
attribute vec3 instanceEndPositions64Low;
attribute vec3 instanceRightPositions64Low;
attribute float instanceStrokeWidths;
attribute vec4 instanceColors;
attribute vec3 instancePickingColors;

uniform float widthScale;
uniform float widthMinPixels;
uniform float widthMaxPixels;
uniform float jointType;
uniform float capType;
uniform float miterLimit;
uniform bool billboard;
uniform int widthUnits;

uniform float opacity;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

const float EPSILON = 0.001;
const vec3 ZERO_OFFSET = vec3(0.0);

float flipIfTrue(bool flag) {
  return -(float(flag) * 2. - 1.);
}
vec3 getLineJoinOffset(
  vec3 prevPoint, vec3 currPoint, vec3 nextPoint,
  vec2 width
) {
  bool isEnd = positions.x > 0.0;
  float sideOfPath = positions.y;
  float isJoint = float(sideOfPath == 0.0);

  vec3 deltaA3 = (currPoint - prevPoint);
  vec3 deltaB3 = (nextPoint - currPoint);

  mat3 rotationMatrix;
  bool needsRotation = !billboard && project_needs_rotation(currPoint, rotationMatrix);
  if (needsRotation) {
    deltaA3 = deltaA3 * rotationMatrix;
    deltaB3 = deltaB3 * rotationMatrix;
  }
  vec2 deltaA = deltaA3.xy / width;
  vec2 deltaB = deltaB3.xy / width;

  float lenA = length(deltaA);
  float lenB = length(deltaB);

  vec2 dirA = lenA > 0. ? normalize(deltaA) : vec2(0.0, 0.0);
  vec2 dirB = lenB > 0. ? normalize(deltaB) : vec2(0.0, 0.0);

  vec2 perpA = vec2(-dirA.y, dirA.x);
  vec2 perpB = vec2(-dirB.y, dirB.x);
  vec2 tangent = dirA + dirB;
  tangent = length(tangent) > 0. ? normalize(tangent) : perpA;
  vec2 miterVec = vec2(-tangent.y, tangent.x);
  vec2 dir = isEnd ? dirA : dirB;
  vec2 perp = isEnd ? perpA : perpB;
  float L = isEnd ? lenA : lenB;
  float sinHalfA = abs(dot(miterVec, perp));
  float cosHalfA = abs(dot(dirA, miterVec));
  float turnDirection = flipIfTrue(dirA.x * dirB.y >= dirA.y * dirB.x);
  float cornerPosition = sideOfPath * turnDirection;

  float miterSize = 1.0 / max(sinHalfA, EPSILON);
  miterSize = mix(
    min(miterSize, max(lenA, lenB) / max(cosHalfA, EPSILON)),
    miterSize,
    step(0.0, cornerPosition)
  );

  vec2 offsetVec = mix(miterVec * miterSize, perp, step(0.5, cornerPosition))
    * (sideOfPath + isJoint * turnDirection);
  bool isStartCap = lenA == 0.0 || (!isEnd && (instanceTypes == 1.0 || instanceTypes == 3.0));
  bool isEndCap = lenB == 0.0 || (isEnd && (instanceTypes == 2.0 || instanceTypes == 3.0));
  bool isCap = isStartCap || isEndCap;
  if (isCap) {
    offsetVec = mix(perp * sideOfPath, dir * capType * 4.0 * flipIfTrue(isStartCap), isJoint);
    vJointType = capType;
  } else {
    vJointType = jointType;
  }
  vPathLength = L;
  vCornerOffset = offsetVec;
  vMiterLength = dot(vCornerOffset, miterVec * turnDirection);
  vMiterLength = isCap ? isJoint : vMiterLength;

  vec2 offsetFromStartOfPath = vCornerOffset + deltaA * float(isEnd);
  vPathPosition = vec2(
    dot(offsetFromStartOfPath, perp),
    dot(offsetFromStartOfPath, dir)
  );
  geometry.uv = vPathPosition;

  float isValid = step(instanceTypes, 3.5);
  vec3 offset = vec3(offsetVec * width * isValid, 0.0);

  if (needsRotation) {
    offset = rotationMatrix * offset;
  }
  return offset;
}
void clipLine(inout vec4 position, vec4 refPosition) {
  if (position.w < EPSILON) {
    float r = (EPSILON - refPosition.w) / (position.w - refPosition.w);
    position = refPosition + (position - refPosition) * r;
  }
}

void main() {
  geometry.pickingColor = instancePickingColors;

  vColor = vec4(instanceColors.rgb, instanceColors.a * opacity);

  float isEnd = positions.x;

  vec3 prevPosition = mix(instanceLeftPositions, instanceStartPositions, isEnd);
  vec3 prevPosition64Low = mix(instanceLeftPositions64Low, instanceStartPositions64Low, isEnd);

  vec3 currPosition = mix(instanceStartPositions, instanceEndPositions, isEnd);
  vec3 currPosition64Low = mix(instanceStartPositions64Low, instanceEndPositions64Low, isEnd);

  vec3 nextPosition = mix(instanceEndPositions, instanceRightPositions, isEnd);
  vec3 nextPosition64Low = mix(instanceEndPositions64Low, instanceRightPositions64Low, isEnd);

  geometry.worldPosition = currPosition;
  vec2 widthPixels = vec2(clamp(
    project_size_to_pixel(instanceStrokeWidths * widthScale, widthUnits),
    widthMinPixels, widthMaxPixels) / 2.0);
  vec3 width;

  if (billboard) {
    vec4 prevPositionScreen = project_position_to_clipspace(prevPosition, prevPosition64Low, ZERO_OFFSET);
    vec4 currPositionScreen = project_position_to_clipspace(currPosition, currPosition64Low, ZERO_OFFSET, geometry.position);
    vec4 nextPositionScreen = project_position_to_clipspace(nextPosition, nextPosition64Low, ZERO_OFFSET);

    clipLine(prevPositionScreen, currPositionScreen);
    clipLine(nextPositionScreen, currPositionScreen);
    clipLine(currPositionScreen, mix(nextPositionScreen, prevPositionScreen, isEnd));

    width = vec3(widthPixels, 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(
      prevPositionScreen.xyz / prevPositionScreen.w,
      currPositionScreen.xyz / currPositionScreen.w,
      nextPositionScreen.xyz / nextPositionScreen.w,
      project_pixel_size_to_clipspace(width.xy)
    );

    DECKGL_FILTER_GL_POSITION(currPositionScreen, geometry);
    gl_Position = vec4(currPositionScreen.xyz + offset * currPositionScreen.w, currPositionScreen.w);
  } else {
    prevPosition = project_position(prevPosition, prevPosition64Low);
    currPosition = project_position(currPosition, currPosition64Low);
    nextPosition = project_position(nextPosition, nextPosition64Low);

    width = vec3(project_pixel_size(widthPixels), 0.0);
    DECKGL_FILTER_SIZE(width, geometry);

    vec3 offset = getLineJoinOffset(prevPosition, currPosition, nextPosition, width.xy);
    geometry.position = vec4(currPosition + offset, 1.0);
    gl_Position = project_common_position_to_clipspace(geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,Zze=`#define SHADER_NAME path-layer-fragment-shader

precision highp float;

uniform float miterLimit;

varying vec4 vColor;
varying vec2 vCornerOffset;
varying float vMiterLength;
varying vec2 vPathPosition;
varying float vPathLength;
varying float vJointType;

void main(void) {
  geometry.uv = vPathPosition;

  if (vPathPosition.y < 0.0 || vPathPosition.y > vPathLength) {
    if (vJointType > 0.5 && length(vCornerOffset) > 1.0) {
      discard;
    }
    if (vJointType < 0.5 && vMiterLength > miterLimit + 1.0) {
      discard;
    }
  }
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,xoe=[0,0,0,255],Yze={widthUnits:"meters",widthScale:{type:"number",min:0,value:1},widthMinPixels:{type:"number",min:0,value:0},widthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},jointRounded:!1,capRounded:!1,miterLimit:{type:"number",min:0,value:4},billboard:!1,_pathType:null,getPath:{type:"accessor",value:t=>t.path},getColor:{type:"accessor",value:xoe},getWidth:{type:"accessor",value:1},rounded:{deprecatedFor:["jointRounded","capRounded"]}},CB={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class W1 extends nl{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(){return super.getShaders({vs:Xze,fs:Zze,modules:[Mc,Oc]})}get wrapLongitude(){return!1}initializeState(){this.getAttributeManager().addInstanced({positions:{size:3,vertexOffset:1,type:5130,fp64:this.use64bitPositions(),transition:CB,accessor:"getPath",update:this.calculatePositions,noAlloc:!0,shaderAttributes:{instanceLeftPositions:{vertexOffset:0},instanceStartPositions:{vertexOffset:1},instanceEndPositions:{vertexOffset:2},instanceRightPositions:{vertexOffset:3}}},instanceTypes:{size:1,type:5121,update:this.calculateSegmentTypes,noAlloc:!0},instanceStrokeWidths:{size:1,accessor:"getWidth",transition:CB,defaultValue:1},instanceColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,accessor:"getColor",transition:CB,defaultValue:xoe},instancePickingColors:{size:3,type:5121,accessor:(r,{index:i,target:o})=>this.encodePickingColor(r&&r.__source?r.__source.index:i,o)}}),this.setState({pathTesselator:new qze({fp64:this.use64bitPositions()})})}updateState(e){super.updateState(e);const{props:n,changeFlags:r}=e,i=this.getAttributeManager();if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPath)){const{pathTesselator:s}=this.state,u=n.data.attributes||{};s.updateGeometry({data:n.data,geometryBuffer:u.getPath,buffers:u,normalize:!n._pathType,loop:n._pathType==="loop",getGeometry:n.getPath,positionFormat:n.positionFormat,wrapLongitude:n.wrapLongitude,resolution:this.context.viewport.resolution,dataChanged:r.dataChanged}),this.setState({numInstances:s.instanceCount,startIndices:s.vertexStarts}),r.dataChanged||i.invalidateAll()}if(r.extensionsChanged){var a;const{gl:s}=this.context;(a=this.state.model)===null||a===void 0||a.delete(),this.state.model=this._getModel(s),i.invalidateAll()}}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(o=>o.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{jointRounded:n,capRounded:r,billboard:i,miterLimit:o,widthUnits:a,widthScale:s,widthMinPixels:u,widthMaxPixels:d}=this.props;this.state.model.setUniforms(e).setUniforms({jointType:Number(n),capType:Number(r),billboard:i,widthUnits:Bu[a],widthScale:s,miterLimit:o,widthMinPixels:u,widthMaxPixels:d}).draw()}_getModel(e){const n=[0,1,2,1,4,2,1,3,4,3,5,4],r=[0,0,0,-1,0,1,1,-1,1,1,1,0];return new Oa(e,{...this.getShaders(),id:this.props.id,geometry:new Cs({drawMode:4,attributes:{indices:new Uint16Array(n),positions:{value:new Float32Array(r),size:2}}}),isInstanced:!0})}calculatePositions(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateSegmentTypes(e){const{pathTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("segmentTypes")}}q(W1,"defaultProps",Yze);q(W1,"layerName","PathLayer");var J6={exports:{}};J6.exports=eL;J6.exports.default=eL;function eL(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,o=boe(t,0,i,n,!0),a=[];if(!o||o.next===o.prev)return a;var s,u,d,g,_,E,P;if(r&&(o=t5e(t,e,o,n)),t.length>80*n){s=d=t[0],u=g=t[1];for(var O=n;O<i;O+=n)_=t[O],E=t[O+1],_<s&&(s=_),E<u&&(u=E),_>d&&(d=_),E>g&&(g=E);P=Math.max(d-s,g-u),P=P!==0?32767/P:0}return dE(o,a,n,s,u,P,0),a}function boe(t,e,n,r,i){var o,a;if(i===E4(t,e,n,r)>0)for(o=e;o<n;o+=r)a=kW(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=kW(o,t[o],t[o+1],a);return a&&tL(a,a.next)&&(gE(a),a=a.next),a}function r_(t,e){if(!t)return t;e||(e=t);var n=t,r;do if(r=!1,!n.steiner&&(tL(n,n.next)||rs(n.prev,n,n.next)===0)){if(gE(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function dE(t,e,n,r,i,o,a){if(t){!a&&o&&s5e(t,r,i,o);for(var s=t,u,d;t.prev!==t.next;){if(u=t.prev,d=t.next,o?Kze(t,r,i,o):Qze(t)){e.push(u.i/n|0),e.push(t.i/n|0),e.push(d.i/n|0),gE(t),t=d.next,s=d.next;continue}if(t=d,t===s){a?a===1?(t=Jze(r_(t),e,n),dE(t,e,n,r,i,o,2)):a===2&&e5e(t,e,n,r,i,o):dE(r_(t),e,n,r,i,o,1);break}}}}function Qze(t){var e=t.prev,n=t,r=t.next;if(rs(e,n,r)>=0)return!1;for(var i=e.x,o=n.x,a=r.x,s=e.y,u=n.y,d=r.y,g=i<o?i<a?i:a:o<a?o:a,_=s<u?s<d?s:d:u<d?u:d,E=i>o?i>a?i:a:o>a?o:a,P=s>u?s>d?s:d:u>d?u:d,O=r.next;O!==e;){if(O.x>=g&&O.x<=E&&O.y>=_&&O.y<=P&&av(i,s,o,u,a,d,O.x,O.y)&&rs(O.prev,O,O.next)>=0)return!1;O=O.next}return!0}function Kze(t,e,n,r){var i=t.prev,o=t,a=t.next;if(rs(i,o,a)>=0)return!1;for(var s=i.x,u=o.x,d=a.x,g=i.y,_=o.y,E=a.y,P=s<u?s<d?s:d:u<d?u:d,O=g<_?g<E?g:E:_<E?_:E,D=s>u?s>d?s:d:u>d?u:d,V=g>_?g>E?g:E:_>E?_:E,k=b4(P,O,e,n,r),F=b4(D,V,e,n,r),z=t.prevZ,X=t.nextZ;z&&z.z>=k&&X&&X.z<=F;){if(z.x>=P&&z.x<=D&&z.y>=O&&z.y<=V&&z!==i&&z!==a&&av(s,g,u,_,d,E,z.x,z.y)&&rs(z.prev,z,z.next)>=0||(z=z.prevZ,X.x>=P&&X.x<=D&&X.y>=O&&X.y<=V&&X!==i&&X!==a&&av(s,g,u,_,d,E,X.x,X.y)&&rs(X.prev,X,X.next)>=0))return!1;X=X.nextZ}for(;z&&z.z>=k;){if(z.x>=P&&z.x<=D&&z.y>=O&&z.y<=V&&z!==i&&z!==a&&av(s,g,u,_,d,E,z.x,z.y)&&rs(z.prev,z,z.next)>=0)return!1;z=z.prevZ}for(;X&&X.z<=F;){if(X.x>=P&&X.x<=D&&X.y>=O&&X.y<=V&&X!==i&&X!==a&&av(s,g,u,_,d,E,X.x,X.y)&&rs(X.prev,X,X.next)>=0)return!1;X=X.nextZ}return!0}function Jze(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!tL(i,o)&&woe(i,r,r.next,o)&&pE(i,o)&&pE(o,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(o.i/n|0),gE(r),gE(r.next),r=t=o),r=r.next}while(r!==t);return r_(r)}function e5e(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&u5e(a,s)){var u=Eoe(a,s);a=r_(a,a.next),u=r_(u,u.next),dE(a,e,n,r,i,o,0),dE(u,e,n,r,i,o,0);return}s=s.next}a=a.next}while(a!==t)}function t5e(t,e,n,r){var i=[],o,a,s,u,d;for(o=0,a=e.length;o<a;o++)s=e[o]*r,u=o<a-1?e[o+1]*r:t.length,d=boe(t,s,u,r,!1),d===d.next&&(d.steiner=!0),i.push(l5e(d));for(i.sort(n5e),o=0;o<i.length;o++)n=r5e(i[o],n);return n}function n5e(t,e){return t.x-e.x}function r5e(t,e){var n=i5e(t,e);if(!n)return e;var r=Eoe(n,t);return r_(r,r.next),r_(n,n.next)}function i5e(t,e){var n=e,r=t.x,i=t.y,o=-1/0,a;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var s=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>o&&(o=s,a=n.x<n.next.x?n:n.next,s===r))return a}n=n.next}while(n!==e);if(!a)return null;var u=a,d=a.x,g=a.y,_=1/0,E;n=a;do r>=n.x&&n.x>=d&&r!==n.x&&av(i<g?r:o,i,d,g,i<g?o:r,i,n.x,n.y)&&(E=Math.abs(i-n.y)/(r-n.x),pE(n,t)&&(E<_||E===_&&(n.x>a.x||n.x===a.x&&o5e(a,n)))&&(a=n,_=E)),n=n.next;while(n!==u);return a}function o5e(t,e){return rs(t.prev,t,e.prev)<0&&rs(e.next,t,t.next)<0}function s5e(t,e,n,r){var i=t;do i.z===0&&(i.z=b4(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,a5e(i)}function a5e(t){var e,n,r,i,o,a,s,u,d=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<d&&(s++,r=r.nextZ,!!r);e++);for(u=d;s>0||u>0&&r;)s!==0&&(u===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,d*=2}while(a>1);return t}function b4(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function l5e(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function av(t,e,n,r,i,o,a,s){return(i-a)*(e-s)>=(t-a)*(o-s)&&(t-a)*(r-s)>=(n-a)*(e-s)&&(n-a)*(o-s)>=(i-a)*(r-s)}function u5e(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!c5e(t,e)&&(pE(t,e)&&pE(e,t)&&f5e(t,e)&&(rs(t.prev,t,e.prev)||rs(t,e.prev,e))||tL(t,e)&&rs(t.prev,t,t.next)>0&&rs(e.prev,e,e.next)>0)}function rs(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function tL(t,e){return t.x===e.x&&t.y===e.y}function woe(t,e,n,r){var i=iT(rs(t,e,n)),o=iT(rs(t,e,r)),a=iT(rs(n,r,t)),s=iT(rs(n,r,e));return!!(i!==o&&a!==s||i===0&&rT(t,n,e)||o===0&&rT(t,r,e)||a===0&&rT(n,t,r)||s===0&&rT(n,e,r))}function rT(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function iT(t){return t>0?1:t<0?-1:0}function c5e(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&woe(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function pE(t,e){return rs(t.prev,t,t.next)<0?rs(t,e,t.next)>=0&&rs(t,t.prev,e)>=0:rs(t,e,t.prev)<0||rs(t,t.next,e)<0}function f5e(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do n.y>o!=n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function Eoe(t,e){var n=new w4(t.i,t.x,t.y),r=new w4(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function kW(t,e,n,r){var i=new w4(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function gE(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function w4(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}eL.deviation=function(t,e,n,r){var i=e&&e.length,o=i?e[0]*n:t.length,a=Math.abs(E4(t,0,o,n));if(i)for(var s=0,u=e.length;s<u;s++){var d=e[s]*n,g=s<u-1?e[s+1]*n:t.length;a-=Math.abs(E4(t,d,g,n))}var _=0;for(s=0;s<r.length;s+=3){var E=r[s]*n,P=r[s+1]*n,O=r[s+2]*n;_+=Math.abs((t[E]-t[O])*(t[P+1]-t[E+1])-(t[E]-t[P])*(t[O+1]-t[E+1]))}return a===0&&_===0?0:Math.abs((_-a)/a)};function E4(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}eL.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},r=0,i=0;i<t.length;i++){for(var o=0;o<t[i].length;o++)for(var a=0;a<e;a++)n.vertices.push(t[i][o][a]);i>0&&(r+=t[i-1].length,n.holes.push(r))}return n};var h5e=J6.exports;const d5e=_A(h5e),oT=Y6.CLOCKWISE,zW=Y6.COUNTER_CLOCKWISE,Rm={isClosed:!0};function p5e(t){if(t=t&&t.positions||t,!Array.isArray(t)&&!ArrayBuffer.isView(t))throw new Error("invalid polygon")}function tw(t){return"positions"in t?t.positions:t}function uP(t){return"holeIndices"in t?t.holeIndices:null}function g5e(t){return Array.isArray(t[0])}function m5e(t){return t.length>=1&&t[0].length>=2&&Number.isFinite(t[0][0])}function A5e(t){const e=t[0],n=t[t.length-1];return e[0]===n[0]&&e[1]===n[1]&&e[2]===n[2]}function _5e(t,e,n,r){for(let i=0;i<e;i++)if(t[n+i]!==t[r-e+i])return!1;return!0}function UW(t,e,n,r,i){let o=e;const a=n.length;for(let s=0;s<a;s++)for(let u=0;u<r;u++)t[o++]=n[s][u]||0;if(!A5e(n))for(let s=0;s<r;s++)t[o++]=n[0][s]||0;return Rm.start=e,Rm.end=o,Rm.size=r,Q6(t,i,Rm),o}function GW(t,e,n,r,i=0,o,a){o=o||n.length;const s=o-i;if(s<=0)return e;let u=e;for(let d=0;d<s;d++)t[u++]=n[i+d];if(!_5e(n,r,i,o))for(let d=0;d<r;d++)t[u++]=n[i+d];return Rm.start=e,Rm.end=u,Rm.size=r,Q6(t,a,Rm),u}function Soe(t,e){p5e(t);const n=[],r=[];if("positions"in t){const{positions:i,holeIndices:o}=t;if(o){let a=0;for(let s=0;s<=o.length;s++)a=GW(n,a,i,e,o[s-1],o[s],s===0?oT:zW),r.push(a);return r.pop(),{positions:n,holeIndices:r}}t=i}if(!g5e(t))return GW(n,0,t,e,0,n.length,oT),n;if(!m5e(t)){let i=0;for(const[o,a]of t.entries())i=UW(n,i,a,e,o===0?oT:zW),r.push(i);return r.pop(),{positions:n,holeIndices:r}}return UW(n,0,t,e,oT),n}function PB(t,e,n){const r=t.length/3;let i=0;for(let o=0;o<r;o++){const a=(o+1)%r;i+=t[o*3+e]*t[a*3+n],i-=t[a*3+e]*t[o*3+n]}return Math.abs(i/2)}function jW(t,e,n,r){const i=t.length/3;for(let o=0;o<i;o++){const a=o*3,s=t[a+0],u=t[a+1],d=t[a+2];t[a+e]=s,t[a+n]=u,t[a+r]=d}}function y5e(t,e,n,r){let i=uP(t);i&&(i=i.map(s=>s/e));let o=tw(t);const a=r&&e===3;if(n){const s=o.length;o=o.slice();const u=[];for(let d=0;d<s;d+=e){u[0]=o[d],u[1]=o[d+1],a&&(u[2]=o[d+2]);const g=n(u);o[d]=g[0],o[d+1]=g[1],a&&(o[d+2]=g[2])}}if(a){const s=PB(o,0,1),u=PB(o,0,2),d=PB(o,1,2);if(!s&&!u&&!d)return[];s>u&&s>d||(u>d?(n||(o=o.slice()),jW(o,0,2,1)):(n||(o=o.slice()),jW(o,2,0,1)))}return d5e(o,i,e)}class v5e extends i6{constructor(e){const{fp64:n,IndexType:r=Uint32Array}=e;super({...e,attributes:{positions:{size:3,type:n?Float64Array:Float32Array},vertexValid:{type:Uint8ClampedArray,size:1},indices:{type:r,size:1}}})}get(e){const{attributes:n}=this;return e==="indices"?n.indices&&n.indices.subarray(0,this.vertexCount):n[e]}updateGeometry(e){super.updateGeometry(e);const n=this.buffers.indices;if(n)this.vertexCount=(n.value||n).length;else if(this.data&&!this.getGeometry)throw new Error("missing indices buffer")}normalizeGeometry(e){if(this.normalize){const n=Soe(e,this.positionSize);return this.opts.resolution?Aoe(tw(n),uP(n),{size:this.positionSize,gridResolution:this.opts.resolution,edgeTypes:!0}):this.opts.wrapLongitude?Bze(tw(n),uP(n),{size:this.positionSize,maxLatitude:86,edgeTypes:!0}):n}return e}getGeometrySize(e){if(VW(e)){let n=0;for(const r of e)n+=this.getGeometrySize(r);return n}return tw(e).length/this.positionSize}getGeometryFromBuffer(e){return this.normalize||!this.buffers.indices?super.getGeometryFromBuffer(e):null}updateGeometryAttributes(e,n){if(e&&VW(e))for(const r of e){const i=this.getGeometrySize(r);n.geometrySize=i,this.updateGeometryAttributes(r,n),n.vertexStart+=i,n.indexStart=this.indexStarts[n.geometryIndex+1]}else this._updateIndices(e,n),this._updatePositions(e,n),this._updateVertexValid(e,n)}_updateIndices(e,{geometryIndex:n,vertexStart:r,indexStart:i}){const{attributes:o,indexStarts:a,typedArrayManager:s}=this;let u=o.indices;if(!u||!e)return;let d=i;const g=y5e(e,this.positionSize,this.opts.preproject,this.opts.full3d);u=s.allocate(u,i+g.length,{copy:!0});for(let _=0;_<g.length;_++)u[d++]=g[_]+r;a[n+1]=i+g.length,o.indices=u}_updatePositions(e,{vertexStart:n,geometrySize:r}){const{attributes:{positions:i},positionSize:o}=this;if(!i||!e)return;const a=tw(e);for(let s=n,u=0;u<r;s++,u++){const d=a[u*o],g=a[u*o+1],_=o>2?a[u*o+2]:0;i[s*3]=d,i[s*3+1]=g,i[s*3+2]=_}}_updateVertexValid(e,{vertexStart:n,geometrySize:r}){const{positionSize:i}=this,o=this.attributes.vertexValid,a=e&&uP(e);if(e&&e.edgeTypes?o.set(e.edgeTypes,n):o.fill(1,n,n+r),a)for(let s=0;s<a.length;s++)o[n+a[s]/i-1]=0;o[n+r-1]=0}}function VW(t){return Array.isArray(t)&&t.length>0&&!Number.isFinite(t[0])}const Toe=`
attribute vec2 vertexPositions;
attribute float vertexValid;

uniform bool extruded;
uniform bool isWireframe;
uniform float elevationScale;
uniform float opacity;

varying vec4 vColor;

struct PolygonProps {
  vec4 fillColors;
  vec4 lineColors;
  vec3 positions;
  vec3 nextPositions;
  vec3 pickingColors;
  vec3 positions64Low;
  vec3 nextPositions64Low;
  float elevations;
};

vec3 project_offset_normal(vec3 vector) {
  if (project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    project_uCoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSETS) {
    return normalize(vector * project_uCommonUnitsPerWorldUnit);
  }
  return project_normal(vector);
}

void calculatePosition(PolygonProps props) {
#ifdef IS_SIDE_VERTEX
  if(vertexValid < 0.5){
    gl_Position = vec4(0.);
    return;
  }
#endif

  vec3 pos;
  vec3 pos64Low;
  vec3 normal;
  vec4 colors = isWireframe ? props.lineColors : props.fillColors;

  geometry.worldPosition = props.positions;
  geometry.worldPositionAlt = props.nextPositions;
  geometry.pickingColor = props.pickingColors;

#ifdef IS_SIDE_VERTEX
  pos = mix(props.positions, props.nextPositions, vertexPositions.x);
  pos64Low = mix(props.positions64Low, props.nextPositions64Low, vertexPositions.x);
#else
  pos = props.positions;
  pos64Low = props.positions64Low;
#endif

  if (extruded) {
    pos.z += props.elevations * vertexPositions.y * elevationScale;
  }
  gl_Position = project_position_to_clipspace(pos, pos64Low, vec3(0.), geometry.position);

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  if (extruded) {
  #ifdef IS_SIDE_VERTEX
    normal = vec3(
      props.positions.y - props.nextPositions.y + (props.positions64Low.y - props.nextPositions64Low.y),
      props.nextPositions.x - props.positions.x + (props.nextPositions64Low.x - props.positions64Low.x),
      0.0);
    normal = project_offset_normal(normal);
  #else
    normal = project_normal(vec3(0.0, 0.0, 1.0));
  #endif
    geometry.normal = normal;
    vec3 lightColor = lighting_getLightColor(colors.rgb, project_uCameraPosition, geometry.position.xyz, normal);
    vColor = vec4(lightColor, colors.a * opacity);
  } else {
    vColor = vec4(colors.rgb, colors.a * opacity);
  }
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,x5e=`#define SHADER_NAME solid-polygon-layer-vertex-shader

attribute vec3 positions;
attribute vec3 positions64Low;
attribute float elevations;
attribute vec4 fillColors;
attribute vec4 lineColors;
attribute vec3 pickingColors;

`.concat(Toe,`

void main(void) {
  PolygonProps props;

  props.positions = positions;
  props.positions64Low = positions64Low;
  props.elevations = elevations;
  props.fillColors = fillColors;
  props.lineColors = lineColors;
  props.pickingColors = pickingColors;

  calculatePosition(props);
}
`),b5e=`#define SHADER_NAME solid-polygon-layer-vertex-shader-side
#define IS_SIDE_VERTEX


attribute vec3 instancePositions;
attribute vec3 nextPositions;
attribute vec3 instancePositions64Low;
attribute vec3 nextPositions64Low;
attribute float instanceElevations;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

`.concat(Toe,`

void main(void) {
  PolygonProps props;

  #if RING_WINDING_ORDER_CW == 1
    props.positions = instancePositions;
    props.positions64Low = instancePositions64Low;
    props.nextPositions = nextPositions;
    props.nextPositions64Low = nextPositions64Low;
  #else
    props.positions = nextPositions;
    props.positions64Low = nextPositions64Low;
    props.nextPositions = instancePositions;
    props.nextPositions64Low = instancePositions64Low;
  #endif
  props.elevations = instanceElevations;
  props.fillColors = instanceFillColors;
  props.lineColors = instanceLineColors;
  props.pickingColors = instancePickingColors;

  calculatePosition(props);
}
`),w5e=`#define SHADER_NAME solid-polygon-layer-fragment-shader

precision highp float;

varying vec4 vColor;

void main(void) {
  gl_FragColor = vColor;

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,sM=[0,0,0,255],E5e={filled:!0,extruded:!1,wireframe:!1,_normalize:!0,_windingOrder:"CW",_full3d:!1,elevationScale:{type:"number",min:0,value:1},getPolygon:{type:"accessor",value:t=>t.polygon},getElevation:{type:"accessor",value:1e3},getFillColor:{type:"accessor",value:sM},getLineColor:{type:"accessor",value:sM},material:!0},sT={enter:(t,e)=>e.length?e.subarray(e.length-t.length):t};class c2 extends nl{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(e){return super.getShaders({vs:e==="top"?x5e:b5e,fs:w5e,defines:{RING_WINDING_ORDER_CW:!this.props._normalize&&this.props._windingOrder==="CCW"?0:1},modules:[Mc,zE,Oc]})}get wrapLongitude(){return!1}initializeState(){const{gl:e,viewport:n}=this.context;let{coordinateSystem:r}=this.props;const{_full3d:i}=this.props;n.isGeospatial&&r===Br.DEFAULT&&(r=Br.LNGLAT);let o;r===Br.LNGLAT&&(i?o=n.projectPosition.bind(n):o=n.projectFlat.bind(n)),this.setState({numInstances:0,polygonTesselator:new v5e({preproject:o,fp64:this.use64bitPositions(),IndexType:!e||UO(e,Qi.ELEMENT_INDEX_UINT32)?Uint32Array:Uint16Array})});const a=this.getAttributeManager(),s=!0;a.remove(["instancePickingColors"]),a.add({indices:{size:1,isIndexed:!0,update:this.calculateIndices,noAlloc:s},positions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:sT,accessor:"getPolygon",update:this.calculatePositions,noAlloc:s,shaderAttributes:{positions:{vertexOffset:0,divisor:0},instancePositions:{vertexOffset:0,divisor:1},nextPositions:{vertexOffset:1,divisor:1}}},vertexValid:{size:1,divisor:1,type:5121,update:this.calculateVertexValid,noAlloc:s},elevations:{size:1,transition:sT,accessor:"getElevation",shaderAttributes:{elevations:{divisor:0},instanceElevations:{divisor:1}}},fillColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:sT,accessor:"getFillColor",defaultValue:sM,shaderAttributes:{fillColors:{divisor:0},instanceFillColors:{divisor:1}}},lineColors:{size:this.props.colorFormat.length,type:5121,normalized:!0,transition:sT,accessor:"getLineColor",defaultValue:sM,shaderAttributes:{lineColors:{divisor:0},instanceLineColors:{divisor:1}}},pickingColors:{size:3,type:5121,accessor:(u,{index:d,target:g})=>this.encodePickingColor(u&&u.__source?u.__source.index:d,g),shaderAttributes:{pickingColors:{divisor:0},instancePickingColors:{divisor:1}}}})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r}=n,{data:i}=this.props;return i[0]&&i[0].__source&&(n.object=i.find(o=>o.__source.index===r)),n}disablePickingIndex(e){const{data:n}=this.props;if(n[0]&&n[0].__source)for(let r=0;r<n.length;r++)n[r].__source.index===e&&this._disablePickingIndex(r);else super.disablePickingIndex(e)}draw({uniforms:e}){const{extruded:n,filled:r,wireframe:i,elevationScale:o}=this.props,{topModel:a,sideModel:s,polygonTesselator:u}=this.state,d={...e,extruded:!!n,elevationScale:o};s&&(s.setInstanceCount(u.instanceCount-1),s.setUniforms(d),i&&(s.setDrawMode(3),s.setUniforms({isWireframe:!0}).draw()),r&&(s.setDrawMode(6),s.setUniforms({isWireframe:!1}).draw())),a&&(a.setVertexCount(u.vertexCount),a.setUniforms(d).draw())}updateState(e){super.updateState(e),this.updateGeometry(e);const{props:n,oldProps:r,changeFlags:i}=e,o=this.getAttributeManager();if(i.extensionsChanged||n.filled!==r.filled||n.extruded!==r.extruded){var s;(s=this.state.models)===null||s===void 0||s.forEach(u=>u.delete()),this.setState(this._getModels(this.context.gl)),o.invalidateAll()}}updateGeometry({props:e,oldProps:n,changeFlags:r}){if(r.dataChanged||r.updateTriggersChanged&&(r.updateTriggersChanged.all||r.updateTriggersChanged.getPolygon)){const{polygonTesselator:o}=this.state,a=e.data.attributes||{};o.updateGeometry({data:e.data,normalize:e._normalize,geometryBuffer:a.getPolygon,buffers:a,getGeometry:e.getPolygon,positionFormat:e.positionFormat,wrapLongitude:e.wrapLongitude,resolution:this.context.viewport.resolution,fp64:this.use64bitPositions(),dataChanged:r.dataChanged,full3d:e._full3d}),this.setState({numInstances:o.instanceCount,startIndices:o.vertexStarts}),r.dataChanged||this.getAttributeManager().invalidateAll()}}_getModels(e){const{id:n,filled:r,extruded:i}=this.props;let o,a;if(r){const s=this.getShaders("top");s.defines.NON_INSTANCED_MODEL=1,o=new Oa(e,{...s,id:"".concat(n,"-top"),drawMode:4,attributes:{vertexPositions:new Float32Array([0,1])},uniforms:{isWireframe:!1,isSideVertex:!1},vertexCount:0,isIndexed:!0})}return i&&(a=new Oa(e,{...this.getShaders("side"),id:"".concat(n,"-side"),geometry:new Cs({drawMode:1,vertexCount:4,attributes:{vertexPositions:{size:2,value:new Float32Array([1,0,0,0,0,1,1,1])}}}),instanceCount:0,isInstanced:1}),a.userData.excludeAttributes={indices:!0}),{models:[a,o].filter(Boolean),topModel:o,sideModel:a}}calculateIndices(e){const{polygonTesselator:n}=this.state;e.startIndices=n.indexStarts,e.value=n.get("indices")}calculatePositions(e){const{polygonTesselator:n}=this.state;e.startIndices=n.vertexStarts,e.value=n.get("positions")}calculateVertexValid(e){e.value=this.state.polygonTesselator.get("vertexValid")}}q(c2,"defaultProps",E5e);q(c2,"layerName","SolidPolygonLayer");function Coe({data:t,getIndex:e,dataRange:n,replace:r}){const{startRow:i=0,endRow:o=1/0}=n,a=t.length;let s=a,u=a;for(let E=0;E<a;E++){const P=e(t[E]);if(s>E&&P>=i&&(s=E),P>=o){u=E;break}}let d=s;const _=u-s!==r.length?t.slice(u):void 0;for(let E=0;E<r.length;E++)t[d++]=r[E];if(_){for(let E=0;E<_.length;E++)t[d++]=_[E];t.length=d}return{startRow:s,endRow:s+r.length}}const Poe=[0,0,0,255],S5e=[0,0,0,255],T5e={stroked:!0,filled:!0,extruded:!1,elevationScale:1,wireframe:!1,_normalize:!0,_windingOrder:"CW",lineWidthUnits:"meters",lineWidthScale:1,lineWidthMinPixels:0,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineJointRounded:!1,lineMiterLimit:4,getPolygon:{type:"accessor",value:t=>t.polygon},getFillColor:{type:"accessor",value:S5e},getLineColor:{type:"accessor",value:Poe},getLineWidth:{type:"accessor",value:1},getElevation:{type:"accessor",value:1e3},material:!0};class EA extends Uh{initializeState(){this.state={paths:[]},this.props.getLineDashArray&&Or.removed("getLineDashArray","PathStyleExtension")()}updateState({changeFlags:e}){const n=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getPolygon);if(n&&Array.isArray(e.dataChanged)){const r=this.state.paths.slice(),i=e.dataChanged.map(o=>Coe({data:r,getIndex:a=>a.__source.index,dataRange:o,replace:this._getPaths(o)}));this.setState({paths:r,pathsDiff:i})}else n&&this.setState({paths:this._getPaths(),pathsDiff:null})}_getPaths(e={}){const{data:n,getPolygon:r,positionFormat:i,_normalize:o}=this.props,a=[],s=i==="XY"?2:3,{startRow:u,endRow:d}=e,{iterable:g,objectInfo:_}=Tg(n,u,d);for(const E of g){_.index++;let P=r(E,_);o&&(P=Soe(P,s));const{holeIndices:O}=P,D=P.positions||P;if(O)for(let V=0;V<=O.length;V++){const k=D.slice(O[V-1]||0,O[V]||D.length);a.push(this.getSubLayerRow({path:k},E,_.index))}else a.push(this.getSubLayerRow({path:D},E,_.index))}return a}renderLayers(){const{data:e,_dataDiff:n,stroked:r,filled:i,extruded:o,wireframe:a,_normalize:s,_windingOrder:u,elevationScale:d,transitions:g,positionFormat:_}=this.props,{lineWidthUnits:E,lineWidthScale:P,lineWidthMinPixels:O,lineWidthMaxPixels:D,lineJointRounded:V,lineMiterLimit:k,lineDashJustified:F}=this.props,{getFillColor:z,getLineColor:X,getLineWidth:Y,getLineDashArray:J,getElevation:re,getPolygon:ue,updateTriggers:ie,material:ce}=this.props,{paths:se,pathsDiff:me}=this.state,Ce=this.getSubLayerClass("fill",c2),we=this.getSubLayerClass("stroke",W1),Ye=this.shouldRenderSubLayer("fill",se)&&new Ce({_dataDiff:n,extruded:o,elevationScale:d,filled:i,wireframe:a,_normalize:s,_windingOrder:u,getElevation:re,getFillColor:z,getLineColor:o&&a?X:Poe,material:ce,transitions:g},this.getSubLayerProps({id:"fill",updateTriggers:ie&&{getPolygon:ie.getPolygon,getElevation:ie.getElevation,getFillColor:ie.getFillColor,lineColors:o&&a,getLineColor:ie.getLineColor}}),{data:e,positionFormat:_,getPolygon:ue}),at=!o&&r&&this.shouldRenderSubLayer("stroke",se)&&new we({_dataDiff:me&&(()=>me),widthUnits:E,widthScale:P,widthMinPixels:O,widthMaxPixels:D,jointRounded:V,miterLimit:k,dashJustified:F,_pathType:"loop",transitions:g&&{getWidth:g.getLineWidth,getColor:g.getLineColor,getPath:g.getPolygon},getColor:this.getSubLayerAccessor(X),getWidth:this.getSubLayerAccessor(Y),getDashArray:this.getSubLayerAccessor(J)},this.getSubLayerProps({id:"stroke",updateTriggers:ie&&{getWidth:ie.getLineWidth,getColor:ie.getLineColor,getDashArray:ie.getLineDashArray}}),{data:se,positionFormat:_,getPath:yt=>yt.path});return[!o&&Ye,at,o&&Ye]}}q(EA,"layerName","PolygonLayer");q(EA,"defaultProps",T5e);function C5e(t,e){if(!t)return null;const n="startIndices"in t?t.startIndices[e]:e,r=t.featureIds.value[n];return n!==-1?P5e(t,r,n):null}function P5e(t,e,n){const r={properties:{...t.properties[e]}};for(const i in t.numericProps)r.properties[i]=t.numericProps[i].value[n];return r}function I5e(t,e){const n={points:null,lines:null,polygons:null};for(const r in n){const i=t[r].globalFeatureIds.value;n[r]=new Uint8ClampedArray(i.length*3);const o=[];for(let a=0;a<i.length;a++)e(i[a],o),n[r][a*3+0]=o[0],n[r][a*3+1]=o[1],n[r][a*3+2]=o[2]}return n}const M5e=`#define SHADER_NAME multi-icon-layer-fragment-shader

precision highp float;

uniform float opacity;
uniform sampler2D iconsTexture;
uniform float gamma;
uniform bool sdf;
uniform float alphaCutoff;
uniform float sdfBuffer;
uniform float outlineBuffer;
uniform vec4 outlineColor;

varying vec4 vColor;
varying vec2 vTextureCoords;
varying vec2 uv;

void main(void) {
  geometry.uv = uv;

  if (!picking_uActive) {
    float alpha = texture2D(iconsTexture, vTextureCoords).a;
    vec4 color = vColor;
    if (sdf) {
      float distance = alpha;
      alpha = smoothstep(sdfBuffer - gamma, sdfBuffer + gamma, distance);

      if (outlineBuffer > 0.0) {
        float inFill = alpha;
        float inBorder = smoothstep(outlineBuffer - gamma, outlineBuffer + gamma, distance);
        color = mix(outlineColor, vColor, inFill);
        alpha = inBorder;
      }
    }
    float a = alpha * color.a;
    
    if (a < alphaCutoff) {
      discard;
    }

    gl_FragColor = vec4(color.rgb, a * opacity);
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,IB=192/256,$W=[],O5e={getIconOffsets:{type:"accessor",value:t=>t.offsets},alphaCutoff:.001,smoothing:.1,outlineWidth:0,outlineColor:{type:"color",value:[0,0,0,255]}};class nL extends l2{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(){return{...super.getShaders(),fs:M5e}}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({instanceOffsets:{size:2,accessor:"getIconOffsets"},instancePickingColors:{type:5121,size:3,accessor:(n,{index:r,target:i})=>this.encodePickingColor(r,i)}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;let{outlineColor:i}=n;i!==r.outlineColor&&(i=i.map(o=>o/255),i[3]=Number.isFinite(i[3])?i[3]:1,this.setState({outlineColor:i})),!n.sdf&&n.outlineWidth&&Or.warn("".concat(this.id,": fontSettings.sdf is required to render outline"))()}draw(e){const{sdf:n,smoothing:r,outlineWidth:i}=this.props,{outlineColor:o}=this.state,a=i?Math.max(r,IB*(1-i)):-1;if(e.uniforms={...e.uniforms,sdfBuffer:IB,outlineBuffer:a,gamma:r,sdf:!!n,outlineColor:o},super.draw(e),n&&i){const{iconManager:s}=this.state;s.getTexture()&&this.state.model.draw({uniforms:{outlineBuffer:IB}})}}getInstanceOffset(e){return e?Array.from(e).flatMap(n=>super.getInstanceOffset(n)):$W}getInstanceColorMode(e){return 1}getInstanceIconFrame(e){return e?Array.from(e).flatMap(n=>super.getInstanceIconFrame(n)):$W}}q(nL,"defaultProps",O5e);q(nL,"layerName","MultiIconLayer");const _w=1e20;class R5e{constructor({fontSize:e=24,buffer:n=3,radius:r=8,cutoff:i=.25,fontFamily:o="sans-serif",fontWeight:a="normal",fontStyle:s="normal"}={}){this.buffer=n,this.cutoff=i,this.radius=r;const u=this.size=e+n*4,d=this._createCanvas(u),g=this.ctx=d.getContext("2d",{willReadFrequently:!0});g.font=`${s} ${a} ${e}px ${o}`,g.textBaseline="alphabetic",g.textAlign="left",g.fillStyle="black",this.gridOuter=new Float64Array(u*u),this.gridInner=new Float64Array(u*u),this.f=new Float64Array(u),this.z=new Float64Array(u+1),this.v=new Uint16Array(u)}_createCanvas(e){const n=document.createElement("canvas");return n.width=n.height=e,n}draw(e){const{width:n,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:o,actualBoundingBoxRight:a}=this.ctx.measureText(e),s=Math.ceil(r),u=0,d=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(a-o))),g=Math.min(this.size-this.buffer,s+Math.ceil(i)),_=d+2*this.buffer,E=g+2*this.buffer,P=Math.max(_*E,0),O=new Uint8ClampedArray(P),D={data:O,width:_,height:E,glyphWidth:d,glyphHeight:g,glyphTop:s,glyphLeft:u,glyphAdvance:n};if(d===0||g===0)return D;const{ctx:V,buffer:k,gridInner:F,gridOuter:z}=this;V.clearRect(k,k,d,g),V.fillText(e,k,k+s);const X=V.getImageData(k,k,d,g);z.fill(_w,0,P),F.fill(0,0,P);for(let Y=0;Y<g;Y++)for(let J=0;J<d;J++){const re=X.data[4*(Y*d+J)+3]/255;if(re===0)continue;const ue=(Y+k)*_+J+k;if(re===1)z[ue]=0,F[ue]=_w;else{const ie=.5-re;z[ue]=ie>0?ie*ie:0,F[ue]=ie<0?ie*ie:0}}HW(z,0,0,_,E,_,this.f,this.v,this.z),HW(F,k,k,d,g,_,this.f,this.v,this.z);for(let Y=0;Y<P;Y++){const J=Math.sqrt(z[Y])-Math.sqrt(F[Y]);O[Y]=Math.round(255-255*(J/this.radius+this.cutoff))}return D}}function HW(t,e,n,r,i,o,a,s,u){for(let d=e;d<e+r;d++)WW(t,n*o+d,o,i,a,s,u);for(let d=n;d<n+i;d++)WW(t,d*o+e,1,r,a,s,u)}function WW(t,e,n,r,i,o,a){o[0]=0,a[0]=-_w,a[1]=_w,i[0]=t[e];for(let s=1,u=0,d=0;s<r;s++){i[s]=t[e+s*n];const g=s*s;do{const _=o[u];d=(i[s]-i[_]+g-_*_)/(s-_)/2}while(d<=a[u]&&--u>-1);u++,o[u]=s,a[u]=d,a[u+1]=_w}for(let s=0,u=0;s<r;s++){for(;a[u+1]<s;)u++;const d=o[u],g=s-d;t[e+s*n]=i[d]+g*g}}const L5e=32,D5e=[];function B5e(t){return Math.pow(2,Math.ceil(Math.log2(t)))}function N5e({characterSet:t,getFontWidth:e,fontHeight:n,buffer:r,maxCanvasWidth:i,mapping:o={},xOffset:a=0,yOffset:s=0}){let u=0,d=a;const g=n+r*2;for(const _ of t)if(!o[_]){const E=e(_);d+E+r*2>i&&(d=0,u++),o[_]={x:d+r,y:s+u*g+r,width:E,height:g,layoutWidth:E,layoutHeight:n},d+=E+r*2}return{mapping:o,xOffset:d,yOffset:s+u*g,canvasHeight:B5e(s+(u+1)*g)}}function Ioe(t,e,n,r){let i=0;for(let a=e;a<n;a++){var o;const s=t[a];i+=((o=r[s])===null||o===void 0?void 0:o.layoutWidth)||0}return i}function Moe(t,e,n,r,i,o){let a=e,s=0;for(let u=e;u<n;u++){const d=Ioe(t,u,u+1,i);s+d>r&&(a<u&&o.push(u),a=u,s=0),s+=d}return s}function F5e(t,e,n,r,i,o){let a=e,s=e,u=e,d=0;for(let g=e;g<n;g++)if((t[g]===" "||t[g+1]===" "||g+1===n)&&(u=g+1),u>s){let _=Ioe(t,s,u,i);d+_>r&&(a<s&&(o.push(s),a=s,d=0),_>r&&(_=Moe(t,s,u,r,i,o),a=o[o.length-1])),s=u,d+=_}return d}function k5e(t,e,n,r,i=0,o){o===void 0&&(o=t.length);const a=[];return e==="break-all"?Moe(t,i,o,n,r,a):F5e(t,i,o,n,r,a),a}function z5e(t,e,n,r,i,o){let a=0,s=0;for(let u=e;u<n;u++){const d=t[u],g=r[d];g?(s||(s=g.layoutHeight),i[u]=a+g.layoutWidth/2,a+=g.layoutWidth):(Or.warn("Missing character: ".concat(d," (").concat(d.codePointAt(0),")"))(),i[u]=a,a+=L5e)}o[0]=a,o[1]=s}function U5e(t,e,n,r,i){const o=Array.from(t),a=o.length,s=new Array(a),u=new Array(a),d=new Array(a),g=(n==="break-word"||n==="break-all")&&isFinite(r)&&r>0,_=[0,0],E=[0,0];let P=0,O=0,D=0;for(let k=0;k<=a;k++){const F=o[k];if((F===`
`||k===a)&&(D=k),D>O){const z=g?k5e(o,n,r,i,O,D):D5e;for(let X=0;X<=z.length;X++){const Y=X===0?O:z[X-1],J=X<z.length?z[X]:D;z5e(o,Y,J,i,s,E);for(let re=Y;re<J;re++){var V;const ue=o[re],ie=((V=i[ue])===null||V===void 0?void 0:V.layoutOffsetY)||0;u[re]=P+E[1]/2+ie,d[re]=E[0]}P=P+E[1]*e,_[0]=Math.max(_[0],E[0])}O=D}F===`
`&&(s[O]=0,u[O]=0,d[O]=0,O++)}return _[1]=P,{x:s,y:u,rowWidth:d,size:_}}function G5e({value:t,length:e,stride:n,offset:r,startIndices:i,characterSet:o}){const a=t.BYTES_PER_ELEMENT,s=n?n/a:1,u=r?r/a:0,d=i[e]||Math.ceil((t.length-u)/s),g=o&&new Set,_=new Array(e);let E=t;if(s>1||u>0){const P=t.constructor;E=new P(d);for(let O=0;O<d;O++)E[O]=t[O*s+u]}for(let P=0;P<e;P++){const O=i[P],D=i[P+1]||d,V=E.subarray(O,D);_[P]=String.fromCodePoint.apply(null,V),g&&V.forEach(g.add,g)}if(g)for(const P of g)o.add(String.fromCodePoint(P));return{texts:_,characterCount:d}}class Ooe{constructor(e=5){q(this,"limit",void 0),q(this,"_cache",{}),q(this,"_order",[]),this.limit=e}get(e){const n=this._cache[e];return n&&(this._deleteOrder(e),this._appendOrder(e)),n}set(e,n){this._cache[e]?(this.delete(e),this._cache[e]=n,this._appendOrder(e)):(Object.keys(this._cache).length===this.limit&&this.delete(this._order[0]),this._cache[e]=n,this._appendOrder(e))}delete(e){this._cache[e]&&(delete this._cache[e],this._deleteOrder(e))}_deleteOrder(e){const n=this._order.indexOf(e);n>=0&&this._order.splice(n,1)}_appendOrder(e){this._order.push(e)}}function j5e(){const t=[];for(let e=32;e<128;e++)t.push(String.fromCharCode(e));return t}const bv={fontFamily:"Monaco, monospace",fontWeight:"normal",characterSet:j5e(),fontSize:64,buffer:4,sdf:!1,cutoff:.25,radius:12,smoothing:.1},qW=1024,XW=.9,ZW=1.2,Roe=3;let aM=new Ooe(Roe);function V5e(t,e){let n;typeof e=="string"?n=new Set(Array.from(e)):n=new Set(e);const r=aM.get(t);if(!r)return n;for(const i in r.mapping)n.has(i)&&n.delete(i);return n}function $5e(t,e){for(let n=0;n<t.length;n++)e.data[4*n+3]=t[n]}function YW(t,e,n,r){t.font="".concat(r," ").concat(n,"px ").concat(e),t.fillStyle="#000",t.textBaseline="alphabetic",t.textAlign="left"}function H5e(t){Or.assert(Number.isFinite(t)&&t>=Roe,"Invalid cache limit"),aM=new Ooe(t)}class W5e{constructor(){q(this,"props",{...bv}),q(this,"_key",void 0),q(this,"_atlas",void 0)}get texture(){return this._atlas}get mapping(){return this._atlas&&this._atlas.mapping}get scale(){const{fontSize:e,buffer:n}=this.props;return(e*ZW+n*2)/e}setProps(e={}){Object.assign(this.props,e),this._key=this._getKey();const n=V5e(this._key,this.props.characterSet),r=aM.get(this._key);if(r&&n.size===0){this._atlas!==r&&(this._atlas=r);return}const i=this._generateFontAtlas(n,r);this._atlas=i,aM.set(this._key,i)}_generateFontAtlas(e,n){const{fontFamily:r,fontWeight:i,fontSize:o,buffer:a,sdf:s,radius:u,cutoff:d}=this.props;let g=n&&n.data;g||(g=document.createElement("canvas"),g.width=qW);const _=g.getContext("2d",{willReadFrequently:!0});YW(_,r,o,i);const{mapping:E,canvasHeight:P,xOffset:O,yOffset:D}=N5e({getFontWidth:V=>_.measureText(V).width,fontHeight:o*ZW,buffer:a,characterSet:e,maxCanvasWidth:qW,...n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset}});if(g.height!==P){const V=_.getImageData(0,0,g.width,g.height);g.height=P,_.putImageData(V,0,0)}if(YW(_,r,o,i),s){const V=new R5e({fontSize:o,buffer:a,radius:u,cutoff:d,fontFamily:r,fontWeight:"".concat(i)});for(const k of e){const{data:F,width:z,height:X,glyphTop:Y}=V.draw(k);E[k].width=z,E[k].layoutOffsetY=o*XW-Y;const J=_.createImageData(z,X);$5e(F,J),_.putImageData(J,E[k].x,E[k].y)}}else for(const V of e)_.fillText(V,E[V].x,E[V].y+a+o*XW);return{xOffset:O,yOffset:D,mapping:E,data:g,width:g.width,height:g.height}}_getKey(){const{fontFamily:e,fontWeight:n,fontSize:r,buffer:i,sdf:o,radius:a,cutoff:s}=this.props;return o?"".concat(e," ").concat(n," ").concat(r," ").concat(i," ").concat(a," ").concat(s):"".concat(e," ").concat(n," ").concat(r," ").concat(i)}}const q5e=`#define SHADER_NAME text-background-layer-vertex-shader

attribute vec2 positions;

attribute vec3 instancePositions;
attribute vec3 instancePositions64Low;
attribute vec4 instanceRects;
attribute float instanceSizes;
attribute float instanceAngles;
attribute vec2 instancePixelOffsets;
attribute float instanceLineWidths;
attribute vec4 instanceFillColors;
attribute vec4 instanceLineColors;
attribute vec3 instancePickingColors;

uniform bool billboard;
uniform float opacity;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform vec4 padding;
uniform int sizeUnits;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

vec2 rotate_by_angle(vec2 vertex, float angle) {
  float angle_radian = radians(angle);
  float cos_angle = cos(angle_radian);
  float sin_angle = sin(angle_radian);
  mat2 rotationMatrix = mat2(cos_angle, -sin_angle, sin_angle, cos_angle);
  return rotationMatrix * vertex;
}

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = positions;
  geometry.pickingColor = instancePickingColors;
  uv = positions;
  vLineWidth = instanceLineWidths;
  float sizePixels = clamp(
    project_size_to_pixel(instanceSizes * sizeScale, sizeUnits),
    sizeMinPixels, sizeMaxPixels
  );

  dimensions = instanceRects.zw * sizePixels + padding.xy + padding.zw;

  vec2 pixelOffset = (positions * instanceRects.zw + instanceRects.xy) * sizePixels + mix(-padding.xy, padding.zw, positions);
  pixelOffset = rotate_by_angle(pixelOffset, instanceAngles);
  pixelOffset += instancePixelOffsets;
  pixelOffset.y *= -1.0;

  if (billboard)  {
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
    vec3 offset = vec3(pixelOffset, 0.0);
    DECKGL_FILTER_SIZE(offset, geometry);
    gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
  } else {
    vec3 offset_common = vec3(project_pixel_size(pixelOffset), 0.0);
    DECKGL_FILTER_SIZE(offset_common, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset_common, geometry.position);
    DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
  }
  vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * opacity);
  DECKGL_FILTER_COLOR(vFillColor, geometry);
  vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * opacity);
  DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,X5e=`#define SHADER_NAME text-background-layer-fragment-shader

precision highp float;

uniform bool stroked;

varying vec4 vFillColor;
varying vec4 vLineColor;
varying float vLineWidth;
varying vec2 uv;
varying vec2 dimensions;

void main(void) {
  geometry.uv = uv;

  vec2 pixelPosition = uv * dimensions;
  if (stroked) {
    float distToEdge = min(
      min(pixelPosition.x, dimensions.x - pixelPosition.x),
      min(pixelPosition.y, dimensions.y - pixelPosition.y)
    );
    float isBorder = smoothedge(distToEdge, vLineWidth);
    gl_FragColor = mix(vFillColor, vLineColor, isBorder);
  } else {
    gl_FragColor = vFillColor;
  }

  DECKGL_FILTER_COLOR(gl_FragColor, geometry);
}
`,Z5e={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,padding:{type:"array",value:[0,0,0,0]},getPosition:{type:"accessor",value:t=>t.position},getSize:{type:"accessor",value:1},getAngle:{type:"accessor",value:0},getPixelOffset:{type:"accessor",value:[0,0]},getBoundingRect:{type:"accessor",value:[0,0,0,0]},getFillColor:{type:"accessor",value:[0,0,0,255]},getLineColor:{type:"accessor",value:[0,0,0,255]},getLineWidth:{type:"accessor",value:1}};class rL extends nl{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(){return super.getShaders({vs:q5e,fs:X5e,modules:[Mc,Oc]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceSizes:{size:1,transition:!0,accessor:"getSize",defaultValue:1},instanceAngles:{size:1,transition:!0,accessor:"getAngle"},instanceRects:{size:4,accessor:"getBoundingRect"},instancePixelOffsets:{size:2,transition:!0,accessor:"getPixelOffset"},instanceFillColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:4,transition:!0,normalized:!0,type:5121,accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){super.updateState(e);const{changeFlags:n}=e;if(n.extensionsChanged){var r;const{gl:i}=this.context;(r=this.state.model)===null||r===void 0||r.delete(),this.state.model=this._getModel(i),this.getAttributeManager().invalidateAll()}}draw({uniforms:e}){const{billboard:n,sizeScale:r,sizeUnits:i,sizeMinPixels:o,sizeMaxPixels:a,getLineWidth:s}=this.props;let{padding:u}=this.props;u.length<4&&(u=[u[0],u[1],u[0],u[1]]),this.state.model.setUniforms(e).setUniforms({billboard:n,stroked:!!s,padding:u,sizeUnits:Bu[i],sizeScale:r,sizeMinPixels:o,sizeMaxPixels:a}).draw()}_getModel(e){const n=[0,0,1,0,1,1,0,1];return new Oa(e,{...this.getShaders(),id:this.props.id,geometry:new Cs({drawMode:6,vertexCount:4,attributes:{positions:{size:2,value:new Float32Array(n)}}}),isInstanced:!0})}}q(rL,"defaultProps",Z5e);q(rL,"layerName","TextBackgroundLayer");const QW={start:1,middle:0,end:-1},KW={top:1,center:0,bottom:-1},MB=[0,0,0,255],Y5e=1,Q5e={billboard:!0,sizeScale:1,sizeUnits:"pixels",sizeMinPixels:0,sizeMaxPixels:Number.MAX_SAFE_INTEGER,background:!1,getBackgroundColor:{type:"accessor",value:[255,255,255,255]},getBorderColor:{type:"accessor",value:MB},getBorderWidth:{type:"accessor",value:0},backgroundPadding:{type:"array",value:[0,0,0,0]},characterSet:{type:"object",value:bv.characterSet},fontFamily:bv.fontFamily,fontWeight:bv.fontWeight,lineHeight:Y5e,outlineWidth:{type:"number",value:0,min:0},outlineColor:{type:"color",value:MB},fontSettings:{type:"object",value:{},compare:1},wordBreak:"break-word",maxWidth:{type:"number",value:-1},getText:{type:"accessor",value:t=>t.text},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:MB},getSize:{type:"accessor",value:32},getAngle:{type:"accessor",value:0},getTextAnchor:{type:"accessor",value:"middle"},getAlignmentBaseline:{type:"accessor",value:"center"},getPixelOffset:{type:"accessor",value:[0,0]},backgroundColor:{deprecatedFor:["background","getBackgroundColor"]}};class iL extends Uh{constructor(...e){super(...e),q(this,"state",void 0),q(this,"getBoundingRect",(n,r)=>{let{size:[i,o]}=this.transformParagraph(n,r);const{fontSize:a}=this.state.fontAtlasManager.props;i/=a,o/=a;const{getTextAnchor:s,getAlignmentBaseline:u}=this.props,d=QW[typeof s=="function"?s(n,r):s],g=KW[typeof u=="function"?u(n,r):u];return[(d-1)*i/2,(g-1)*o/2,i,o]}),q(this,"getIconOffsets",(n,r)=>{const{getTextAnchor:i,getAlignmentBaseline:o}=this.props,{x:a,y:s,rowWidth:u,size:[d,g]}=this.transformParagraph(n,r),_=QW[typeof i=="function"?i(n,r):i],E=KW[typeof o=="function"?o(n,r):o],P=a.length,O=new Array(P*2);let D=0;for(let V=0;V<P;V++){const k=(1-_)*(d-u[V])/2;O[D++]=(_-1)*d/2+k+a[V],O[D++]=(E-1)*g/2+s[V]}return O})}initializeState(){this.state={styleVersion:0,fontAtlasManager:new W5e},this.props.maxWidth>0&&Or.warn("v8.9 breaking change: TextLayer maxWidth is now relative to text size")()}updateState(e){const{props:n,oldProps:r,changeFlags:i}=e;(i.dataChanged||i.updateTriggersChanged&&(i.updateTriggersChanged.all||i.updateTriggersChanged.getText))&&this._updateText(),(this._updateFontAtlas()||n.lineHeight!==r.lineHeight||n.wordBreak!==r.wordBreak||n.maxWidth!==r.maxWidth)&&this.setState({styleVersion:this.state.styleVersion+1})}getPickingInfo({info:e}){return e.object=e.index>=0?this.props.data[e.index]:null,e}_updateFontAtlas(){const{fontSettings:e,fontFamily:n,fontWeight:r}=this.props,{fontAtlasManager:i,characterSet:o}=this.state,a={...e,characterSet:o,fontFamily:n,fontWeight:r};if(!i.mapping)return i.setProps(a),!0;for(const s in a)if(a[s]!==i.props[s])return i.setProps(a),!0;return!1}_updateText(){var e;const{data:n,characterSet:r}=this.props,i=(e=n.attributes)===null||e===void 0?void 0:e.getText;let{getText:o}=this.props,a=n.startIndices,s;const u=r==="auto"&&new Set;if(i&&a){const{texts:d,characterCount:g}=G5e({...ArrayBuffer.isView(i)?{value:i}:i,length:n.length,startIndices:a,characterSet:u});s=g,o=(_,{index:E})=>d[E]}else{const{iterable:d,objectInfo:g}=Tg(n);a=[0],s=0;for(const _ of d){g.index++;const E=Array.from(o(_,g)||"");u&&E.forEach(u.add,u),s+=E.length,a.push(s)}}this.setState({getText:o,startIndices:a,numInstances:s,characterSet:u||r})}transformParagraph(e,n){const{fontAtlasManager:r}=this.state,i=r.mapping,o=this.state.getText,{wordBreak:a,lineHeight:s,maxWidth:u}=this.props,d=o(e,n)||"";return U5e(d,s,a,u*r.props.fontSize,i)}renderLayers(){const{startIndices:e,numInstances:n,getText:r,fontAtlasManager:{scale:i,texture:o,mapping:a},styleVersion:s}=this.state,{data:u,_dataDiff:d,getPosition:g,getColor:_,getSize:E,getAngle:P,getPixelOffset:O,getBackgroundColor:D,getBorderColor:V,getBorderWidth:k,backgroundPadding:F,background:z,billboard:X,fontSettings:Y,outlineWidth:J,outlineColor:re,sizeScale:ue,sizeUnits:ie,sizeMinPixels:ce,sizeMaxPixels:se,transitions:me,updateTriggers:Ce}=this.props,we=this.getSubLayerClass("characters",nL),Ye=this.getSubLayerClass("background",rL);return[z&&new Ye({getFillColor:D,getLineColor:V,getLineWidth:k,padding:F,getPosition:g,getSize:E,getAngle:P,getPixelOffset:O,billboard:X,sizeScale:ue,sizeUnits:ie,sizeMinPixels:ce,sizeMaxPixels:se,transitions:me&&{getPosition:me.getPosition,getAngle:me.getAngle,getSize:me.getSize,getFillColor:me.getBackgroundColor,getLineColor:me.getBorderColor,getLineWidth:me.getBorderWidth,getPixelOffset:me.getPixelOffset}},this.getSubLayerProps({id:"background",updateTriggers:{getPosition:Ce.getPosition,getAngle:Ce.getAngle,getSize:Ce.getSize,getFillColor:Ce.getBackgroundColor,getLineColor:Ce.getBorderColor,getLineWidth:Ce.getBorderWidth,getPixelOffset:Ce.getPixelOffset,getBoundingRect:{getText:Ce.getText,getTextAnchor:Ce.getTextAnchor,getAlignmentBaseline:Ce.getAlignmentBaseline,styleVersion:s}}}),{data:u.attributes&&u.attributes.background?{length:u.length,attributes:u.attributes.background}:u,_dataDiff:d,autoHighlight:!1,getBoundingRect:this.getBoundingRect}),new we({sdf:Y.sdf,smoothing:Number.isFinite(Y.smoothing)?Y.smoothing:bv.smoothing,outlineWidth:J/(Y.radius||bv.radius),outlineColor:re,iconAtlas:o,iconMapping:a,getPosition:g,getColor:_,getSize:E,getAngle:P,getPixelOffset:O,billboard:X,sizeScale:ue*i,sizeUnits:ie,sizeMinPixels:ce*i,sizeMaxPixels:se*i,transitions:me&&{getPosition:me.getPosition,getAngle:me.getAngle,getColor:me.getColor,getSize:me.getSize,getPixelOffset:me.getPixelOffset}},this.getSubLayerProps({id:"characters",updateTriggers:{all:Ce.getText,getPosition:Ce.getPosition,getAngle:Ce.getAngle,getColor:Ce.getColor,getSize:Ce.getSize,getPixelOffset:Ce.getPixelOffset,getIconOffsets:{getTextAnchor:Ce.getTextAnchor,getAlignmentBaseline:Ce.getAlignmentBaseline,styleVersion:s}}}),{data:u,_dataDiff:d,startIndices:e,numInstances:n,getIconOffsets:this.getIconOffsets,getIcon:r})]}static set fontAtlasCacheLimit(e){H5e(e)}}q(iL,"defaultProps",Q5e);q(iL,"layerName","TextLayer");const cP={circle:{type:KR,props:{filled:"filled",stroked:"stroked",lineWidthMaxPixels:"lineWidthMaxPixels",lineWidthMinPixels:"lineWidthMinPixels",lineWidthScale:"lineWidthScale",lineWidthUnits:"lineWidthUnits",pointRadiusMaxPixels:"radiusMaxPixels",pointRadiusMinPixels:"radiusMinPixels",pointRadiusScale:"radiusScale",pointRadiusUnits:"radiusUnits",pointAntialiasing:"antialiasing",pointBillboard:"billboard",getFillColor:"getFillColor",getLineColor:"getLineColor",getLineWidth:"getLineWidth",getPointRadius:"getRadius"}},icon:{type:l2,props:{iconAtlas:"iconAtlas",iconMapping:"iconMapping",iconSizeMaxPixels:"sizeMaxPixels",iconSizeMinPixels:"sizeMinPixels",iconSizeScale:"sizeScale",iconSizeUnits:"sizeUnits",iconAlphaCutoff:"alphaCutoff",iconBillboard:"billboard",getIcon:"getIcon",getIconAngle:"getAngle",getIconColor:"getColor",getIconPixelOffset:"getPixelOffset",getIconSize:"getSize"}},text:{type:iL,props:{textSizeMaxPixels:"sizeMaxPixels",textSizeMinPixels:"sizeMinPixels",textSizeScale:"sizeScale",textSizeUnits:"sizeUnits",textBackground:"background",textBackgroundPadding:"backgroundPadding",textFontFamily:"fontFamily",textFontWeight:"fontWeight",textLineHeight:"lineHeight",textMaxWidth:"maxWidth",textOutlineColor:"outlineColor",textOutlineWidth:"outlineWidth",textWordBreak:"wordBreak",textCharacterSet:"characterSet",textBillboard:"billboard",textFontSettings:"fontSettings",getText:"getText",getTextAngle:"getAngle",getTextColor:"getColor",getTextPixelOffset:"getPixelOffset",getTextSize:"getSize",getTextAnchor:"getTextAnchor",getTextAlignmentBaseline:"getAlignmentBaseline",getTextBackgroundColor:"getBackgroundColor",getTextBorderColor:"getBorderColor",getTextBorderWidth:"getBorderWidth"}}},fP={type:W1,props:{lineWidthUnits:"widthUnits",lineWidthScale:"widthScale",lineWidthMinPixels:"widthMinPixels",lineWidthMaxPixels:"widthMaxPixels",lineJointRounded:"jointRounded",lineCapRounded:"capRounded",lineMiterLimit:"miterLimit",lineBillboard:"billboard",getLineColor:"getColor",getLineWidth:"getWidth"}},S4={type:c2,props:{extruded:"extruded",filled:"filled",wireframe:"wireframe",elevationScale:"elevationScale",material:"material",_full3d:"_full3d",getElevation:"getElevation",getFillColor:"getFillColor",getLineColor:"getLineColor"}};function wb({type:t,props:e}){const n={};for(const r in e)n[r]=t.defaultProps[e[r]];return n}function OB(t,e){const{transitions:n,updateTriggers:r}=t.props,i={updateTriggers:{},transitions:n&&{getPosition:n.geometry}};for(const o in e){const a=e[o];let s=t.props[o];o.startsWith("get")&&(s=t.getSubLayerAccessor(s),i.updateTriggers[a]=r[o],n&&(i.transitions[a]=n[o])),i[a]=s}return i}function K5e(t){if(Array.isArray(t))return t;switch(Or.assert(t.type,"GeoJSON does not have type"),t.type){case"Feature":return[t];case"FeatureCollection":return Or.assert(Array.isArray(t.features),"GeoJSON does not have features array"),t.features;default:return[{geometry:t}]}}function JW(t,e,n={}){const r={pointFeatures:[],lineFeatures:[],polygonFeatures:[],polygonOutlineFeatures:[]},{startRow:i=0,endRow:o=t.length}=n;for(let a=i;a<o;a++){const s=t[a],{geometry:u}=s;if(u)if(u.type==="GeometryCollection"){Or.assert(Array.isArray(u.geometries),"GeoJSON does not have geometries array");const{geometries:d}=u;for(let g=0;g<d.length;g++){const _=d[g];eq(_,r,e,s,a)}}else eq(u,r,e,s,a)}return r}function eq(t,e,n,r,i){const{type:o,coordinates:a}=t,{pointFeatures:s,lineFeatures:u,polygonFeatures:d,polygonOutlineFeatures:g}=e;if(!e6e(o,a)){Or.warn("".concat(o," coordinates are malformed"))();return}switch(o){case"Point":s.push(n({geometry:t},r,i));break;case"MultiPoint":a.forEach(_=>{s.push(n({geometry:{type:"Point",coordinates:_}},r,i))});break;case"LineString":u.push(n({geometry:t},r,i));break;case"MultiLineString":a.forEach(_=>{u.push(n({geometry:{type:"LineString",coordinates:_}},r,i))});break;case"Polygon":d.push(n({geometry:t},r,i)),a.forEach(_=>{g.push(n({geometry:{type:"LineString",coordinates:_}},r,i))});break;case"MultiPolygon":a.forEach(_=>{d.push(n({geometry:{type:"Polygon",coordinates:_}},r,i)),_.forEach(E=>{g.push(n({geometry:{type:"LineString",coordinates:E}},r,i))})});break}}const J5e={Point:1,MultiPoint:2,LineString:2,MultiLineString:3,Polygon:3,MultiPolygon:4};function e6e(t,e){let n=J5e[t];for(Or.assert(n,"Unknown GeoJSON type ".concat(t));e&&--n>0;)e=e[0];return e&&Number.isFinite(e[0])}function Loe(){return{points:{},lines:{},polygons:{},polygonsOutline:{}}}function aT(t){return t.geometry.coordinates}function t6e(t,e){const n=Loe(),{pointFeatures:r,lineFeatures:i,polygonFeatures:o,polygonOutlineFeatures:a}=t;return n.points.data=r,n.points._dataDiff=e.pointFeatures&&(()=>e.pointFeatures),n.points.getPosition=aT,n.lines.data=i,n.lines._dataDiff=e.lineFeatures&&(()=>e.lineFeatures),n.lines.getPath=aT,n.polygons.data=o,n.polygons._dataDiff=e.polygonFeatures&&(()=>e.polygonFeatures),n.polygons.getPolygon=aT,n.polygonsOutline.data=a,n.polygonsOutline._dataDiff=e.polygonOutlineFeatures&&(()=>e.polygonOutlineFeatures),n.polygonsOutline.getPath=aT,n}function n6e(t,e){const n=Loe(),{points:r,lines:i,polygons:o}=t,a=I5e(t,e);return n.points.data={length:r.positions.value.length/r.positions.size,attributes:{...r.attributes,getPosition:r.positions,instancePickingColors:{size:3,value:a.points}},properties:r.properties,numericProps:r.numericProps,featureIds:r.featureIds},n.lines.data={length:i.pathIndices.value.length-1,startIndices:i.pathIndices.value,attributes:{...i.attributes,getPath:i.positions,instancePickingColors:{size:3,value:a.lines}},properties:i.properties,numericProps:i.numericProps,featureIds:i.featureIds},n.lines._pathType="open",n.polygons.data={length:o.polygonIndices.value.length-1,startIndices:o.polygonIndices.value,attributes:{...o.attributes,getPolygon:o.positions,pickingColors:{size:3,value:a.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygons._normalize=!1,o.triangles&&(n.polygons.data.attributes.indices=o.triangles.value),n.polygonsOutline.data={length:o.primitivePolygonIndices.value.length-1,startIndices:o.primitivePolygonIndices.value,attributes:{...o.attributes,getPath:o.positions,instancePickingColors:{size:3,value:a.polygons}},properties:o.properties,numericProps:o.numericProps,featureIds:o.featureIds},n.polygonsOutline._pathType="open",n}const r6e=["points","linestrings","polygons"],i6e={...wb(cP.circle),...wb(cP.icon),...wb(cP.text),...wb(fP),...wb(S4),stroked:!0,filled:!0,extruded:!1,wireframe:!1,_full3d:!1,iconAtlas:{type:"object",value:null},iconMapping:{type:"object",value:{}},getIcon:{type:"accessor",value:t=>t.properties.icon},getText:{type:"accessor",value:t=>t.properties.text},pointType:"circle",getRadius:{deprecatedFor:"getPointRadius"}};class q1 extends Uh{initializeState(){this.state={layerProps:{},features:{}}}updateState({props:e,changeFlags:n}){if(!n.dataChanged)return;const{data:r}=this.props,i=r&&"points"in r&&"polygons"in r&&"lines"in r;this.setState({binary:i}),i?this._updateStateBinary({props:e,changeFlags:n}):this._updateStateJSON({props:e,changeFlags:n})}_updateStateBinary({props:e,changeFlags:n}){const r=n6e(e.data,this.encodePickingColor);this.setState({layerProps:r})}_updateStateJSON({props:e,changeFlags:n}){const r=K5e(e.data),i=this.getSubLayerRow.bind(this);let o={};const a={};if(Array.isArray(n.dataChanged)){const u=this.state.features;for(const d in u)o[d]=u[d].slice(),a[d]=[];for(const d of n.dataChanged){const g=JW(r,i,d);for(const _ in u)a[_].push(Coe({data:o[_],getIndex:E=>E.__source.index,dataRange:d,replace:g[_]}))}}else o=JW(r,i);const s=t6e(o,a);this.setState({features:o,featuresDiff:a,layerProps:s})}getPickingInfo(e){const n=super.getPickingInfo(e),{index:r,sourceLayer:i}=n;return n.featureType=r6e.find(o=>i.id.startsWith("".concat(this.id,"-").concat(o,"-"))),r>=0&&i.id.startsWith("".concat(this.id,"-points-text"))&&this.state.binary&&(n.index=this.props.data.points.globalFeatureIds.value[r]),n}_updateAutoHighlight(e){const n="".concat(this.id,"-points-"),r=e.featureType==="points";for(const i of this.getSubLayers())i.id.startsWith(n)===r&&i.updateAutoHighlight(e)}_renderPolygonLayer(){const{extruded:e,wireframe:n}=this.props,{layerProps:r}=this.state,i="polygons-fill",o=this.shouldRenderSubLayer(i,r.polygons.data)&&this.getSubLayerClass(i,S4.type);if(o){const a=OB(this,S4.props),s=e&&n;return s||delete a.getLineColor,a.updateTriggers.lineColors=s,new o(a,this.getSubLayerProps({id:i,updateTriggers:a.updateTriggers}),r.polygons)}return null}_renderLineLayers(){const{extruded:e,stroked:n}=this.props,{layerProps:r}=this.state,i="polygons-stroke",o="linestrings",a=!e&&n&&this.shouldRenderSubLayer(i,r.polygonsOutline.data)&&this.getSubLayerClass(i,fP.type),s=this.shouldRenderSubLayer(o,r.lines.data)&&this.getSubLayerClass(o,fP.type);if(a||s){const u=OB(this,fP.props);return[a&&new a(u,this.getSubLayerProps({id:i,updateTriggers:u.updateTriggers}),r.polygonsOutline),s&&new s(u,this.getSubLayerProps({id:o,updateTriggers:u.updateTriggers}),r.lines)]}return null}_renderPointLayers(){const{pointType:e}=this.props,{layerProps:n,binary:r}=this.state;let{highlightedObjectIndex:i}=this.props;!r&&Number.isFinite(i)&&(i=n.points.data.findIndex(s=>s.__source.index===i));const o=new Set(e.split("+")),a=[];for(const s of o){const u="points-".concat(s),d=cP[s],g=d&&this.shouldRenderSubLayer(u,n.points.data)&&this.getSubLayerClass(u,d.type);if(g){const _=OB(this,d.props);let E=n.points;if(s==="text"&&r){const{instancePickingColors:P,...O}=E.data.attributes;E={...E,data:{...E.data,attributes:O}}}a.push(new g(_,this.getSubLayerProps({id:u,updateTriggers:_.updateTriggers,highlightedObjectIndex:i}),E))}}return a}renderLayers(){const{extruded:e}=this.props,n=this._renderPolygonLayer(),r=this._renderLineLayers(),i=this._renderPointLayers();return[!e&&n,r,i,e&&n]}getSubLayerAccessor(e){const{binary:n}=this.state;return!n||typeof e!="function"?super.getSubLayerAccessor(e):(r,i)=>{const{data:o,index:a}=i,s=C5e(o,a);return e(s,i)}}}q(q1,"layerName","GeoJsonLayer");q(q1,"defaultProps",i6e);const o6e=Object.freeze(Object.defineProperty({__proto__:null,ArcLayer:ZR,BitmapLayer:YR,ColumnLayer:u2,GeoJsonLayer:q1,GridCellLayer:K6,IconLayer:l2,LineLayer:Z6,PathLayer:W1,PointCloudLayer:QR,PolygonLayer:EA,ScatterplotLayer:KR,SolidPolygonLayer:c2,TextLayer:iL,_MultiIconLayer:nL,_TextBackgroundLayer:rL},Symbol.toStringTag,{value:"Module"})),b_=ti(o6e);var fA={};Object.defineProperty(fA,"__esModule",{value:!0});fA.UNIT=fA.PROJECTED_PIXEL_SIZE_MULTIPLIER=void 0;var s6e=2/3;fA.PROJECTED_PIXEL_SIZE_MULTIPLIER=s6e;var a6e={common:0,meters:1,pixels:2};fA.UNIT=a6e;var eU={};const f2=ti(RCe);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=f2;function n(Y){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(re){return typeof re}:n=function(re){return re&&typeof Symbol=="function"&&re.constructor===Symbol&&re!==Symbol.prototype?"symbol":typeof re},n(Y)}function r(Y,J){var re=Object.keys(Y);if(Object.getOwnPropertySymbols){var ue=Object.getOwnPropertySymbols(Y);J&&(ue=ue.filter(function(ie){return Object.getOwnPropertyDescriptor(Y,ie).enumerable})),re.push.apply(re,ue)}return re}function i(Y){for(var J=1;J<arguments.length;J++){var re=arguments[J]!=null?arguments[J]:{};J%2?r(Object(re),!0).forEach(function(ue){F(Y,ue,re[ue])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Y,Object.getOwnPropertyDescriptors(re)):r(Object(re)).forEach(function(ue){Object.defineProperty(Y,ue,Object.getOwnPropertyDescriptor(re,ue))})}return Y}function o(Y){if(typeof Symbol>"u"||Y[Symbol.iterator]==null){if(Array.isArray(Y)||(Y=a(Y))){var J=0,re=function(){};return{s:re,n:function(){return J>=Y.length?{done:!0}:{done:!1,value:Y[J++]}},e:function(Ce){throw Ce},f:re}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var ue,ie=!0,ce=!1,se;return{s:function(){ue=Y[Symbol.iterator]()},n:function(){var Ce=ue.next();return ie=Ce.done,Ce},e:function(Ce){ce=!0,se=Ce},f:function(){try{!ie&&ue.return!=null&&ue.return()}finally{if(ce)throw se}}}}function a(Y,J){if(Y){if(typeof Y=="string")return s(Y,J);var re=Object.prototype.toString.call(Y).slice(8,-1);if(re==="Object"&&Y.constructor&&(re=Y.constructor.name),re==="Map"||re==="Set")return Array.from(re);if(re==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(re))return s(Y,J)}}function s(Y,J){(J==null||J>Y.length)&&(J=Y.length);for(var re=0,ue=new Array(J);re<J;re++)ue[re]=Y[re];return ue}function u(Y,J){if(!(Y instanceof J))throw new TypeError("Cannot call a class as a function")}function d(Y,J){for(var re=0;re<J.length;re++){var ue=J[re];ue.enumerable=ue.enumerable||!1,ue.configurable=!0,"value"in ue&&(ue.writable=!0),Object.defineProperty(Y,ue.key,ue)}}function g(Y,J,re){return J&&d(Y.prototype,J),re&&d(Y,re),Y}function _(Y){return function(){var J=D(Y),re;if(O()){var ue=D(this).constructor;re=Reflect.construct(J,arguments,ue)}else re=J.apply(this,arguments);return E(this,re)}}function E(Y,J){return J&&(n(J)==="object"||typeof J=="function")?J:P(Y)}function P(Y){if(Y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Y}function O(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function D(Y){return D=Object.setPrototypeOf?Object.getPrototypeOf:function(re){return re.__proto__||Object.getPrototypeOf(re)},D(Y)}function V(Y,J){if(typeof J!="function"&&J!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(J&&J.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),J&&k(Y,J)}function k(Y,J){return k=Object.setPrototypeOf||function(ue,ie){return ue.__proto__=ie,ue},k(Y,J)}function F(Y,J,re){return J in Y?Object.defineProperty(Y,J,{value:re,enumerable:!0,configurable:!0,writable:!0}):Y[J]=re,Y}var z=["anyclick","pointermove","panstart","panmove","panend","keyup"],X=function(Y){V(re,Y);var J=_(re);function re(){return u(this,re),J.apply(this,arguments)}return g(re,[{key:"onLayerClick",value:function(ie){}},{key:"onStartDragging",value:function(ie){}},{key:"onStopDragging",value:function(ie){}},{key:"onDragging",value:function(ie){}},{key:"onPointerMove",value:function(ie){}},{key:"onLayerKeyUp",value:function(ie){}},{key:"initializeState",value:function(){this.setState({_editableLayerState:{pointerDownPicks:null,pointerDownScreenCoords:null,pointerDownMapCoords:null,eventHandler:this._forwardEventToCurrentLayer.bind(this)}}),this._addEventHandlers()}},{key:"finalizeState",value:function(){this._removeEventHandlers()}},{key:"_addEventHandlers",value:function(){var ie=this.context.deck.eventManager,ce=this.state._editableLayerState.eventHandler,se=o(z),me;try{for(se.s();!(me=se.n()).done;){var Ce=me.value;ie.on(Ce,ce,{priority:100})}}catch(we){se.e(we)}finally{se.f()}}},{key:"_removeEventHandlers",value:function(){var ie=this.context.deck.eventManager,ce=this.state._editableLayerState.eventHandler,se=o(z),me;try{for(se.s();!(me=se.n()).done;){var Ce=me.value;ie.off(Ce,ce)}}catch(we){se.e(we)}finally{se.f()}}},{key:"_forwardEventToCurrentLayer",value:function(ie){var ce=this.getCurrentLayer(),se=ce["_on".concat(ie.type)].bind(ce);if(!se){console.warn("no handler for mjolnir.js event ".concat(ie.type));return}se(ie)}},{key:"_onanyclick",value:function(ie){var ce=ie.srcEvent,se=this.getScreenCoords(ce),me=this.getMapCoords(se),Ce=this.getPicks(se);this.onLayerClick({mapCoords:me,screenCoords:se,picks:Ce,sourceEvent:ce})}},{key:"_onkeyup",value:function(ie){var ce=ie.srcEvent;this.onLayerKeyUp(ce)}},{key:"_onpanstart",value:function(ie){var ce=this.getScreenCoords(ie.srcEvent),se=this.getMapCoords(ce),me=this.getPicks(ce);this.setState({_editableLayerState:i({},this.state._editableLayerState,{pointerDownScreenCoords:ce,pointerDownMapCoords:se,pointerDownPicks:me})}),this.onStartDragging({picks:me,screenCoords:ce,mapCoords:se,pointerDownScreenCoords:ce,pointerDownMapCoords:se,cancelPan:ie.stopImmediatePropagation,sourceEvent:ie.srcEvent})}},{key:"_onpanmove",value:function(ie){var ce=ie.srcEvent,se=this.getScreenCoords(ce),me=this.getMapCoords(se),Ce=this.state._editableLayerState,we=Ce.pointerDownPicks,Ye=Ce.pointerDownScreenCoords,at=Ce.pointerDownMapCoords,yt=this.getPicks(se);this.onDragging({screenCoords:se,mapCoords:me,picks:yt,pointerDownPicks:we,pointerDownScreenCoords:Ye,pointerDownMapCoords:at,sourceEvent:ce,cancelPan:ie.stopImmediatePropagation})}},{key:"_onpanend",value:function(ie){var ce=ie.srcEvent,se=this.getScreenCoords(ce),me=this.getMapCoords(se),Ce=this.state._editableLayerState,we=Ce.pointerDownPicks,Ye=Ce.pointerDownScreenCoords,at=Ce.pointerDownMapCoords,yt=this.getPicks(se);this.onStopDragging({picks:yt,screenCoords:se,mapCoords:me,pointerDownPicks:we,pointerDownScreenCoords:Ye,pointerDownMapCoords:at,sourceEvent:ce}),this.setState({_editableLayerState:i({},this.state._editableLayerState,{pointerDownScreenCoords:null,pointerDownMapCoords:null,pointerDownPicks:null})})}},{key:"_onpointermove",value:function(ie){var ce=ie.srcEvent,se=this.getScreenCoords(ce),me=this.getMapCoords(se),Ce=this.state._editableLayerState,we=Ce.pointerDownPicks,Ye=Ce.pointerDownScreenCoords,at=Ce.pointerDownMapCoords,yt=this.getPicks(se);this.onPointerMove({screenCoords:se,mapCoords:me,picks:yt,pointerDownPicks:we,pointerDownScreenCoords:Ye,pointerDownMapCoords:at,sourceEvent:ce})}},{key:"getPicks",value:function(ie){return this.context.deck.pickMultipleObjects({x:ie[0],y:ie[1],layerIds:[this.props.id],radius:this.props.pickingRadius,depth:this.props.pickingDepth})}},{key:"getScreenCoords",value:function(ie){return[ie.clientX-this.context.gl.canvas.getBoundingClientRect().left,ie.clientY-this.context.gl.canvas.getBoundingClientRect().top]}},{key:"getMapCoords",value:function(ie){return this.context.viewport.unproject([ie[0],ie[1]])}}]),re}(e.CompositeLayer);t.default=X,F(X,"layerName","EditableLayer")})(eU);var Doe={},rp={};Object.defineProperty(rp,"__esModule",{value:!0});rp.toDeckColor=y6e;rp.recursivelyTraverseNestedArrays=Noe;rp.generatePointsParallelToLinePoints=v6e;rp.distance2d=C4;rp.mix=Foe;rp.nearestPointOnProjectedLine=x6e;rp.insertBefore=b6e;var tq=oL(rR),l6e=oL(Kd),u6e=oL(Mre),c6e=rl,f6e=oL(p6);function oL(t){return t&&t.__esModule?t:{default:t}}function Py(t,e){return p6e(t)||d6e(t,e)||Boe(t,e)||h6e()}function h6e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d6e(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,o=void 0;try{for(var a=t[Symbol.iterator](),s;!(r=(s=a.next()).done)&&(n.push(s.value),!(e&&n.length===e));r=!0);}catch(u){i=!0,o=u}finally{try{!r&&a.return!=null&&a.return()}finally{if(i)throw o}}return n}}function p6e(t){if(Array.isArray(t))return t}function g6e(t){return _6e(t)||A6e(t)||Boe(t)||m6e()}function m6e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Boe(t,e){if(t){if(typeof t=="string")return T4(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(n);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T4(t,e)}}function A6e(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function _6e(t){if(Array.isArray(t))return T4(t)}function T4(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function y6e(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[255,0,0,255];return Array.isArray(t)?[t[0]*255,t[1]*255,t[2]*255,t[3]*255]:e}function Noe(t,e,n){if(!Array.isArray(t[0]))return!0;for(var r=0;r<t.length;r++)if(Noe(t[r],[].concat(g6e(e),[r]),n)){n(t,e);break}return!1}function v6e(t,e,n){var r={type:"LineString",coordinates:[t,e]},i=(0,c6e.point)(n),o=(0,u6e.default)(i,r),a=(0,l6e.default)(t,e),s=(n[0]-t[0])*(e[1]-t[1])-(n[1]-t[1])*(e[0]-t[0]),u=s<0?a-90:a-270,d=(0,tq.default)(e,o,u),g=(0,tq.default)(t,o,u);return[d.geometry.coordinates,g.geometry.coordinates]}function C4(t,e,n,r){var i=t-n,o=e-r;return Math.sqrt(i*i+o*o)}function Foe(t,e,n){return e*n+t*(1-n)}function x6e(t,e,n){var r=new f6e.default(n),i=t.geometry.coordinates,o=i.map(function(we){var Ye=Py(we,3),at=Ye[0],yt=Ye[1],be=Ye[2],De=be===void 0?0:be;return r.project([at,yt,De])}),a=r.project(e.geometry.coordinates),s=Py(a,2),u=s[0],d=s[1],g=1/0,_={};o.forEach(function(we,Ye){var at=Py(we,2),yt=at[0],be=at[1];if(Ye!==0){var De=Py(o[Ye-1],2),Re=De[0],qe=De[1],ct=qe-be,Ct=yt-Re,Dt=Re*be-yt*qe,In=ct*ct+Ct*Ct,Mn=Math.abs(ct*u+Ct*d+Dt)/Math.sqrt(In);Mn<g&&(g=Mn,_={index:Ye,x0:(Ct*(Ct*u-ct*d)-ct*Dt)/In,y0:(ct*(-Ct*u+ct*d)-Ct*Dt)/In})}});var E=_,P=E.index,O=E.x0,D=E.y0,V=Py(o[P-1],3),k=V[0],F=V[1],z=V[2],X=z===void 0?0:z,Y=Py(o[P],3),J=Y[0],re=Y[1],ue=Y[2],ie=ue===void 0?0:ue,ce=C4(k,F,J,re),se=C4(k,F,O,D),me=se/ce,Ce=Foe(X,ie,me);return{type:"Feature",geometry:{type:"Point",coordinates:r.unproject([O,D,Ce])},properties:{dist:g,index:P-1}}}function b6e(t,e,n){var r=t.indexOf(e);return r<0?t:t.slice(0,r)+n+t.slice(r)}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=b_,n=rp;function r(Y){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?r=function(re){return typeof re}:r=function(re){return re&&typeof Symbol=="function"&&re.constructor===Symbol&&re!==Symbol.prototype?"symbol":typeof re},r(Y)}function i(Y,J){if(!(Y instanceof J))throw new TypeError("Cannot call a class as a function")}function o(Y,J){for(var re=0;re<J.length;re++){var ue=J[re];ue.enumerable=ue.enumerable||!1,ue.configurable=!0,"value"in ue&&(ue.writable=!0),Object.defineProperty(Y,ue.key,ue)}}function a(Y,J,re){return J&&o(Y.prototype,J),re&&o(Y,re),Y}function s(Y,J,re){return typeof Reflect<"u"&&Reflect.get?s=Reflect.get:s=function(ie,ce,se){var me=u(ie,ce);if(me){var Ce=Object.getOwnPropertyDescriptor(me,ce);return Ce.get?Ce.get.call(se):Ce.value}},s(Y,J,re||Y)}function u(Y,J){for(;!Object.prototype.hasOwnProperty.call(Y,J)&&(Y=P(Y),Y!==null););return Y}function d(Y){return function(){var J=P(Y),re;if(E()){var ue=P(this).constructor;re=Reflect.construct(J,arguments,ue)}else re=J.apply(this,arguments);return g(this,re)}}function g(Y,J){return J&&(r(J)==="object"||typeof J=="function")?J:_(Y)}function _(Y){if(Y===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Y}function E(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function P(Y){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(re){return re.__proto__||Object.getPrototypeOf(re)},P(Y)}function O(Y,J){if(typeof J!="function"&&J!==null)throw new TypeError("Super expression must either be null or a function");Y.prototype=Object.create(J&&J.prototype,{constructor:{value:Y,writable:!0,configurable:!0}}),J&&D(Y,J)}function D(Y,J){return D=Object.setPrototypeOf||function(ue,ie){return ue.__proto__=ie,ue},D(Y,J)}function V(Y,J){var re=Object.keys(Y);if(Object.getOwnPropertySymbols){var ue=Object.getOwnPropertySymbols(Y);J&&(ue=ue.filter(function(ie){return Object.getOwnPropertyDescriptor(Y,ie).enumerable})),re.push.apply(re,ue)}return re}function k(Y){for(var J=1;J<arguments.length;J++){var re=arguments[J]!=null?arguments[J]:{};J%2?V(Object(re),!0).forEach(function(ue){F(Y,ue,re[ue])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Y,Object.getOwnPropertyDescriptors(re)):V(Object(re)).forEach(function(ue){Object.defineProperty(Y,ue,Object.getOwnPropertyDescriptor(re,ue))})}return Y}function F(Y,J,re){return J in Y?Object.defineProperty(Y,J,{value:re,enumerable:!0,configurable:!0,writable:!0}):Y[J]=re,Y}var z=k({},e.PathLayer.defaultProps,{pickingLineWidthExtraPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER}}),X=function(Y){O(re,Y);var J=d(re);function re(){return i(this,re),J.apply(this,arguments)}return a(re,[{key:"getShaders",value:function(){var ie,ce=s(P(re.prototype),"getShaders",this).call(this);return ce.vs=(0,n.insertBefore)(ce.vs,"vec3 width;",`
       if(picking_uActive){
        widthPixels.xy += pickingLineWidthExtraPixels;
       }
      `),k({},ce,{inject:k({},ce.inject||{},{"vs:#decl":(((ie=ce.inject)===null||ie===void 0?void 0:ie["vs:#decl"])||"").concat("uniform float pickingLineWidthExtraPixels;")})})}},{key:"draw",value:function(ie){s(P(re.prototype),"draw",this).call(this,k({},ie,{uniforms:k({},ie.uniforms,{pickingLineWidthExtraPixels:this.props.pickingLineWidthExtraPixels})}))}}]),re}(e.PathLayer);t.default=X,X.defaultProps=z,X.layerName="EditablePathLayer"})(Doe);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=b_,n=Hp,r=fA,i=a(eU),o=a(Doe);function a(It){return It&&It.__esModule?It:{default:It}}function s(It){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?s=function($t){return typeof $t}:s=function($t){return $t&&typeof Symbol=="function"&&$t.constructor===Symbol&&$t!==Symbol.prototype?"symbol":typeof $t},s(It)}function u(It,Xt){var $t=Object.keys(It);if(Object.getOwnPropertySymbols){var cn=Object.getOwnPropertySymbols(It);Xt&&(cn=cn.filter(function(Jt){return Object.getOwnPropertyDescriptor(It,Jt).enumerable})),$t.push.apply($t,cn)}return $t}function d(It){for(var Xt=1;Xt<arguments.length;Xt++){var $t=arguments[Xt]!=null?arguments[Xt]:{};Xt%2?u(Object($t),!0).forEach(function(cn){ie(It,cn,$t[cn])}):Object.getOwnPropertyDescriptors?Object.defineProperties(It,Object.getOwnPropertyDescriptors($t)):u(Object($t)).forEach(function(cn){Object.defineProperty(It,cn,Object.getOwnPropertyDescriptor($t,cn))})}return It}function g(It){if(typeof Symbol>"u"||It[Symbol.iterator]==null){if(Array.isArray(It)||(It=_(It))){var Xt=0,$t=function(){};return{s:$t,n:function(){return Xt>=It.length?{done:!0}:{done:!1,value:It[Xt++]}},e:function(cr){throw cr},f:$t}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var cn,Jt=!0,Ln=!1,qn;return{s:function(){cn=It[Symbol.iterator]()},n:function(){var cr=cn.next();return Jt=cr.done,cr},e:function(cr){Ln=!0,qn=cr},f:function(){try{!Jt&&cn.return!=null&&cn.return()}finally{if(Ln)throw qn}}}}function _(It,Xt){if(It){if(typeof It=="string")return E(It,Xt);var $t=Object.prototype.toString.call(It).slice(8,-1);if($t==="Object"&&It.constructor&&($t=It.constructor.name),$t==="Map"||$t==="Set")return Array.from($t);if($t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test($t))return E(It,Xt)}}function E(It,Xt){(Xt==null||Xt>It.length)&&(Xt=It.length);for(var $t=0,cn=new Array(Xt);$t<Xt;$t++)cn[$t]=It[$t];return cn}function P(It,Xt){if(!(It instanceof Xt))throw new TypeError("Cannot call a class as a function")}function O(It,Xt){for(var $t=0;$t<Xt.length;$t++){var cn=Xt[$t];cn.enumerable=cn.enumerable||!1,cn.configurable=!0,"value"in cn&&(cn.writable=!0),Object.defineProperty(It,cn.key,cn)}}function D(It,Xt,$t){return Xt&&O(It.prototype,Xt),$t&&O(It,$t),It}function V(It,Xt,$t){return typeof Reflect<"u"&&Reflect.get?V=Reflect.get:V=function(Jt,Ln,qn){var or=k(Jt,Ln);if(or){var cr=Object.getOwnPropertyDescriptor(or,Ln);return cr.get?cr.get.call(qn):cr.value}},V(It,Xt,$t||It)}function k(It,Xt){for(;!Object.prototype.hasOwnProperty.call(It,Xt)&&(It=J(It),It!==null););return It}function F(It){return function(){var Xt=J(It),$t;if(Y()){var cn=J(this).constructor;$t=Reflect.construct(Xt,arguments,cn)}else $t=Xt.apply(this,arguments);return z(this,$t)}}function z(It,Xt){return Xt&&(s(Xt)==="object"||typeof Xt=="function")?Xt:X(It)}function X(It){if(It===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return It}function Y(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function J(It){return J=Object.setPrototypeOf?Object.getPrototypeOf:function($t){return $t.__proto__||Object.getPrototypeOf($t)},J(It)}function re(It,Xt){if(typeof Xt!="function"&&Xt!==null)throw new TypeError("Super expression must either be null or a function");It.prototype=Object.create(Xt&&Xt.prototype,{constructor:{value:It,writable:!0,configurable:!0}}),Xt&&ue(It,Xt)}function ue(It,Xt){return ue=Object.setPrototypeOf||function(cn,Jt){return cn.__proto__=Jt,cn},ue(It,Xt)}function ie(It,Xt,$t){return Xt in It?Object.defineProperty(It,Xt,{value:$t,enumerable:!0,configurable:!0,writable:!0}):It[Xt]=$t,It}var ce=[0,0,0,153],se=[0,0,0,144],me=[0,0,0,255],Ce=[0,0,144,144],we=[144,144,144,255],Ye=[144,144,144,144],at=[192,0,0,255],yt=[0,0,0,128],be=[124,0,192,255],De=[255,255,255,255],Re=5,qe=3,ct=7,Ct=32*r.PROJECTED_PIXEL_SIZE_MULTIPLIER,Dt=n.DrawPolygonMode;function In(It){return!It||typeof It!="function"?It:function(Xt){return It(Mn(Xt))}}function Mn(It){return It.__source?It.__source.object:It.sourceFeature?It.sourceFeature.feature:It}function Tn(It){switch(It.properties.editHandleType){case"existing":return at;case"snap-source":return be;case"intermediate":default:return yt}}function Nt(It){return De}function Zt(It){switch(It.properties.editHandleType){case"existing":return Re;case"snap":return ct;case"intermediate":default:return qe}}var Wt={mode:Dt,onEdit:function(){},pickable:!0,pickingRadius:10,pickingDepth:5,fp64:!1,filled:!0,stroked:!0,lineWidthScale:r.PROJECTED_PIXEL_SIZE_MULTIPLIER,lineWidthMinPixels:1,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,pickingLineWidthExtraPixels:0,lineWidthUnits:"pixels",lineJointRounded:!1,lineCapRounded:!1,lineMiterLimit:4,pointRadiusScale:1,pointRadiusMinPixels:2,pointRadiusMaxPixels:Number.MAX_SAFE_INTEGER,getLineColor:function(Xt,$t,cn){return $t?me:ce},getFillColor:function(Xt,$t,cn){return $t?Ce:se},getRadius:function(Xt){return Xt&&Xt.properties&&Xt.properties.radius||Xt&&Xt.properties&&Xt.properties.size||1},getLineWidth:function(Xt){return Xt&&Xt.properties&&Xt.properties.lineWidth||3},getTentativeLineColor:function(Xt){return we},getTentativeFillColor:function(Xt){return Ye},getTentativeLineWidth:function(Xt){return Xt&&Xt.properties&&Xt.properties.lineWidth||3},editHandleType:"point",editHandlePointRadiusScale:1,editHandlePointOutline:!0,editHandlePointStrokeWidth:2,editHandlePointRadiusUnits:"pixels",editHandlePointRadiusMinPixels:4,editHandlePointRadiusMaxPixels:8,getEditHandlePointColor:Tn,getEditHandlePointOutlineColor:Nt,getEditHandlePointRadius:Zt,editHandleIconAtlas:null,editHandleIconMapping:null,editHandleIconSizeScale:1,editHandleIconSizeUnits:"pixels",getEditHandleIcon:function(Xt){return Xt.properties.editHandleType},getEditHandleIconSize:10,getEditHandleIconColor:Tn,getEditHandleIconAngle:0,billboard:!0},hn={view:n.ViewMode,modify:n.ModifyMode,translate:new n.SnappableMode(new n.TranslateMode),transform:new n.SnappableMode(new n.TransformMode),scale:n.ScaleMode,rotate:n.RotateMode,duplicate:n.DuplicateMode,split:n.SplitPolygonMode,extrude:n.ExtrudeMode,elevation:n.ElevationMode,drawPoint:n.DrawPointMode,drawLineString:n.DrawLineStringMode,drawPolygon:n.DrawPolygonMode,drawRectangle:n.DrawRectangleMode,drawSquare:n.DrawSquareMode,drawRectangleFromCenter:n.DrawRectangleFromCenterMode,drawSquareFromCenter:n.DrawSquareFromCenterMode,drawCircleFromCenter:n.DrawCircleFromCenterMode,drawCircleByBoundingBox:n.DrawCircleByDiameterMode,drawEllipseByBoundingBox:n.DrawEllipseByBoundingBoxMode,drawRectangleUsing3Points:n.DrawRectangleUsingThreePointsMode,drawEllipseUsing3Points:n.DrawEllipseUsingThreePointsMode,draw90DegreePolygon:n.Draw90DegreePolygonMode,drawPolygonByDragging:n.DrawPolygonByDraggingMode},lr=function(It){re($t,It);var Xt=F($t);function $t(){return P(this,$t),Xt.apply(this,arguments)}return D($t,[{key:"renderLayers",value:function(){var Jt=this.getSubLayerProps({id:"geojson",data:this.props.data,fp64:this.props.fp64,filled:this.props.filled,stroked:this.props.stroked,lineWidthScale:this.props.lineWidthScale,lineWidthMinPixels:this.props.lineWidthMinPixels,lineWidthMaxPixels:this.props.lineWidthMaxPixels,lineWidthUnits:this.props.lineWidthUnits,lineJointRounded:this.props.lineJointRounded,lineCapRounded:this.props.lineCapRounded,lineMiterLimit:this.props.lineMiterLimit,pointRadiusScale:this.props.pointRadiusScale,pointRadiusMinPixels:this.props.pointRadiusMinPixels,pointRadiusMaxPixels:this.props.pointRadiusMaxPixels,getLineColor:this.selectionAwareAccessor(this.props.getLineColor),getFillColor:this.selectionAwareAccessor(this.props.getFillColor),getPointRadius:this.selectionAwareAccessor(this.props.getRadius),getLineWidth:this.selectionAwareAccessor(this.props.getLineWidth),_subLayerProps:{linestrings:{billboard:this.props.billboard,updateTriggers:{all:[this.props.selectedFeatureIndexes,this.props.mode]}},"polygons-stroke":{billboard:this.props.billboard,pickingLineWidthExtraPixels:this.props.pickingLineWidthExtraPixels,type:o.default,updateTriggers:{all:[this.props.selectedFeatureIndexes,this.props.mode]}}},updateTriggers:{getLineColor:[this.props.selectedFeatureIndexes,this.props.mode],getFillColor:[this.props.selectedFeatureIndexes,this.props.mode],getPointRadius:[this.props.selectedFeatureIndexes,this.props.mode],getLineWidth:[this.props.selectedFeatureIndexes,this.props.mode]}}),Ln=[new e.GeoJsonLayer(Jt)];return Ln=Ln.concat(this.createGuidesLayers(),this.createTooltipsLayers()),Ln}},{key:"initializeState",value:function(){V(J($t.prototype),"initializeState",this).call(this),this.setState({selectedFeatures:[],editHandles:[]})}},{key:"shouldUpdateState",value:function(Jt){return V(J($t.prototype),"shouldUpdateState",this).call(this,Jt)||Jt.changeFlags.stateChanged}},{key:"updateState",value:function(Jt){var Ln=Jt.props,qn=Jt.oldProps,or=Jt.changeFlags,cr=Jt.context;if(V(J($t.prototype),"updateState",this).call(this,{oldProps:qn,props:Ln,changeFlags:or,context:cr}),or.propsOrDataChanged){var cs=Object.keys(qn).length===0||Ln.mode!==qn.mode;if(cs){var Ri;if(typeof Ln.mode=="function"){var Do=Ln.mode;Ri=new Do}else typeof Ln.mode=="string"?(Ri=hn[Ln.mode],console.warn("Deprecated use of passing `mode` as a string. Pass the mode's class constructor instead.")):Ri=Ln.mode;Ri||(console.warn("No mode configured for ".concat(String(Ln.mode))),Ri=new Dt),Ri!==this.state.mode&&this.setState({mode:Ri,cursor:null})}}var Fa=[];Array.isArray(Ln.selectedFeatureIndexes)&&(Fa=Ln.selectedFeatureIndexes.map(function(Nl){return Ln.data.features[Nl]})),this.setState({selectedFeatures:Fa})}},{key:"getModeProps",value:function(Jt){var Ln=this;return{modeConfig:Jt.modeConfig,data:Jt.data,selectedIndexes:Jt.selectedFeatureIndexes,lastPointerMoveEvent:this.state.lastPointerMoveEvent,cursor:this.state.cursor,onEdit:function(or){Ln.setNeedsUpdate(),Jt.onEdit(or)},onUpdateCursor:function(or){Ln.setState({cursor:or})}}}},{key:"selectionAwareAccessor",value:function(Jt){var Ln=this;return typeof Jt!="function"?Jt:function(qn){return Jt(qn,Ln.isFeatureSelected(qn),Ln.props.mode)}}},{key:"isFeatureSelected",value:function(Jt){if(!this.props.data||!this.props.selectedFeatureIndexes||!this.props.selectedFeatureIndexes.length)return!1;var Ln=this.props.data.features.indexOf(Jt);return this.props.selectedFeatureIndexes.includes(Ln)}},{key:"getPickingInfo",value:function(Jt){var Ln=Jt.info,qn=Jt.sourceLayer;return qn.id.endsWith("guides")&&(Ln.isGuide=!0),Ln}},{key:"_updateAutoHighlight",value:function(Jt){if(Jt!=null&&Jt.sourceLayer)if(Jt.isGuide){var Ln=g(Jt.sourceLayer.getSubLayers()),qn;try{for(Ln.s();!(qn=Ln.n()).done;){var or=qn.value;or.updateAutoHighlight(Jt)}}catch(cr){Ln.e(cr)}finally{Ln.f()}}else Jt.sourceLayer.updateAutoHighlight(Jt)}},{key:"createGuidesLayers",value:function(){var Jt=this.getActiveMode(),Ln=Jt.getGuides(this.getModeProps(this.props));if(!Ln||!Ln.features.length)return[];var qn={linestrings:{billboard:this.props.billboard,autoHighlight:!1},"polygons-fill":{autoHighlight:!1},"polygons-stroke":{billboard:this.props.billboard}};this.props.editHandleType==="icon"?qn["points-icon"]={type:e.IconLayer,iconAtlas:this.props.editHandleIconAtlas,iconMapping:this.props.editHandleIconMapping,sizeUnits:this.props.editHandleIconSizeUnits,sizeScale:this.props.editHandleIconSizeScale,getIcon:In(this.props.getEditHandleIcon),getSize:In(this.props.getEditHandleIconSize),getColor:In(this.props.getEditHandleIconColor),getAngle:In(this.props.getEditHandleIconAngle)}:qn["points-circle"]={type:e.ScatterplotLayer,radiusScale:this.props.editHandlePointRadiusScale,stroked:this.props.editHandlePointOutline,getLineWidth:this.props.editHandlePointStrokeWidth,radiusUnits:this.props.editHandlePointRadiusUnits,radiusMinPixels:this.props.editHandlePointRadiusMinPixels,radiusMaxPixels:this.props.editHandlePointRadiusMaxPixels,getRadius:In(this.props.getEditHandlePointRadius),getFillColor:In(this.props.getEditHandlePointColor),getLineColor:In(this.props.getEditHandlePointOutlineColor)};var or=new e.GeoJsonLayer(this.getSubLayerProps({id:"guides",data:Ln,fp64:this.props.fp64,_subLayerProps:qn,lineWidthScale:this.props.lineWidthScale,lineWidthMinPixels:this.props.lineWidthMinPixels,lineWidthMaxPixels:this.props.lineWidthMaxPixels,lineWidthUnits:this.props.lineWidthUnits,lineJointRounded:this.props.lineJointRounded,lineCapRounded:this.props.lineCapRounded,lineMiterLimit:this.props.lineMiterLimit,getLineColor:In(this.props.getTentativeLineColor),getLineWidth:In(this.props.getTentativeLineWidth),getFillColor:In(this.props.getTentativeFillColor),pointType:this.props.editHandleType==="icon"?"icon":"circle",iconAtlas:this.props.editHandleIconAtlas}));return[or]}},{key:"createTooltipsLayers",value:function(){var Jt=this.getActiveMode(),Ln=Jt.getTooltips(this.getModeProps(this.props)),qn=new e.TextLayer(d({getSize:Ct},this.getSubLayerProps({id:"tooltips",data:Ln})));return[qn]}},{key:"onLayerClick",value:function(Jt){this.getActiveMode().handleClick(Jt,this.getModeProps(this.props))}},{key:"onLayerKeyUp",value:function(Jt){this.getActiveMode().handleKeyUp(Jt,this.getModeProps(this.props))}},{key:"onStartDragging",value:function(Jt){this.getActiveMode().handleStartDragging(Jt,this.getModeProps(this.props))}},{key:"onDragging",value:function(Jt){this.getActiveMode().handleDragging(Jt,this.getModeProps(this.props))}},{key:"onStopDragging",value:function(Jt){this.getActiveMode().handleStopDragging(Jt,this.getModeProps(this.props))}},{key:"onPointerMove",value:function(Jt){this.setState({lastPointerMoveEvent:Jt}),this.getActiveMode().handlePointerMove(Jt,this.getModeProps(this.props))}},{key:"getCursor",value:function(Jt){var Ln=Jt.isDragging;if(this.state===null||this.state===void 0)return null;var qn=this.state.cursor;return qn||(qn=Ln?"grabbing":"grab"),qn}},{key:"getActiveMode",value:function(){return this.state.mode}}]),$t}(i.default);t.default=lr,ie(lr,"layerName","EditableGeoJsonLayer"),ie(lr,"defaultProps",Wt)})(XR);var koe={},tU={},sL={};(function(t){const e=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",n=e+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",r="["+e+"]["+n+"]*",i=new RegExp("^"+r+"$"),o=function(s,u){const d=[];let g=u.exec(s);for(;g;){const _=[];_.startIndex=u.lastIndex-g[0].length;const E=g.length;for(let P=0;P<E;P++)_.push(g[P]);d.push(_),g=u.exec(s)}return d},a=function(s){const u=i.exec(s);return!(u===null||typeof u>"u")};t.isExist=function(s){return typeof s<"u"},t.isEmptyObject=function(s){return Object.keys(s).length===0},t.merge=function(s,u,d){if(u){const g=Object.keys(u),_=g.length;for(let E=0;E<_;E++)d==="strict"?s[g[E]]=[u[g[E]]]:s[g[E]]=u[g[E]]}},t.getValue=function(s){return t.isExist(s)?s:""},t.isName=a,t.getAllMatches=o,t.nameRegexp=r})(sL);const nU=sL,w6e={allowBooleanAttributes:!1,unpairedTags:[]};tU.validate=function(t,e){e=Object.assign({},w6e,e);const n=[];let r=!1,i=!1;t[0]==="\uFEFF"&&(t=t.substr(1));for(let o=0;o<t.length;o++)if(t[o]==="<"&&t[o+1]==="?"){if(o+=2,o=rq(t,o),o.err)return o}else if(t[o]==="<"){let a=o;if(o++,t[o]==="!"){o=iq(t,o);continue}else{let s=!1;t[o]==="/"&&(s=!0,o++);let u="";for(;o<t.length&&t[o]!==">"&&t[o]!==" "&&t[o]!=="	"&&t[o]!==`
`&&t[o]!=="\r";o++)u+=t[o];if(u=u.trim(),u[u.length-1]==="/"&&(u=u.substring(0,u.length-1),o--),!O6e(u)){let _;return u.trim().length===0?_="Invalid space after '<'.":_="Tag '"+u+"' is an invalid name.",zs("InvalidTag",_,xu(t,o))}const d=T6e(t,o);if(d===!1)return zs("InvalidAttr","Attributes for '"+u+"' have open quote.",xu(t,o));let g=d.value;if(o=d.index,g[g.length-1]==="/"){const _=o-g.length;g=g.substring(0,g.length-1);const E=oq(g,e);if(E===!0)r=!0;else return zs(E.err.code,E.err.msg,xu(t,_+E.err.line))}else if(s)if(d.tagClosed){if(g.trim().length>0)return zs("InvalidTag","Closing tag '"+u+"' can't have attributes or invalid starting.",xu(t,a));{const _=n.pop();if(u!==_.tagName){let E=xu(t,_.tagStartPos);return zs("InvalidTag","Expected closing tag '"+_.tagName+"' (opened in line "+E.line+", col "+E.col+") instead of closing tag '"+u+"'.",xu(t,a))}n.length==0&&(i=!0)}}else return zs("InvalidTag","Closing tag '"+u+"' doesn't have proper closing.",xu(t,o));else{const _=oq(g,e);if(_!==!0)return zs(_.err.code,_.err.msg,xu(t,o-g.length+_.err.line));if(i===!0)return zs("InvalidXml","Multiple possible root nodes found.",xu(t,o));e.unpairedTags.indexOf(u)!==-1||n.push({tagName:u,tagStartPos:a}),r=!0}for(o++;o<t.length;o++)if(t[o]==="<")if(t[o+1]==="!"){o++,o=iq(t,o);continue}else if(t[o+1]==="?"){if(o=rq(t,++o),o.err)return o}else break;else if(t[o]==="&"){const _=I6e(t,o);if(_==-1)return zs("InvalidChar","char '&' is not expected.",xu(t,o));o=_}else if(i===!0&&!nq(t[o]))return zs("InvalidXml","Extra text at the end",xu(t,o));t[o]==="<"&&o--}}else{if(nq(t[o]))continue;return zs("InvalidChar","char '"+t[o]+"' is not expected.",xu(t,o))}if(r){if(n.length==1)return zs("InvalidTag","Unclosed tag '"+n[0].tagName+"'.",xu(t,n[0].tagStartPos));if(n.length>0)return zs("InvalidXml","Invalid '"+JSON.stringify(n.map(o=>o.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return zs("InvalidXml","Start tag expected.",1);return!0};function nq(t){return t===" "||t==="	"||t===`
`||t==="\r"}function rq(t,e){const n=e;for(;e<t.length;e++)if(t[e]=="?"||t[e]==" "){const r=t.substr(n,e-n);if(e>5&&r==="xml")return zs("InvalidXml","XML declaration allowed only at the start of the document.",xu(t,e));if(t[e]=="?"&&t[e+1]==">"){e++;break}else continue}return e}function iq(t,e){if(t.length>e+5&&t[e+1]==="-"&&t[e+2]==="-"){for(e+=3;e<t.length;e++)if(t[e]==="-"&&t[e+1]==="-"&&t[e+2]===">"){e+=2;break}}else if(t.length>e+8&&t[e+1]==="D"&&t[e+2]==="O"&&t[e+3]==="C"&&t[e+4]==="T"&&t[e+5]==="Y"&&t[e+6]==="P"&&t[e+7]==="E"){let n=1;for(e+=8;e<t.length;e++)if(t[e]==="<")n++;else if(t[e]===">"&&(n--,n===0))break}else if(t.length>e+9&&t[e+1]==="["&&t[e+2]==="C"&&t[e+3]==="D"&&t[e+4]==="A"&&t[e+5]==="T"&&t[e+6]==="A"&&t[e+7]==="["){for(e+=8;e<t.length;e++)if(t[e]==="]"&&t[e+1]==="]"&&t[e+2]===">"){e+=2;break}}return e}const E6e='"',S6e="'";function T6e(t,e){let n="",r="",i=!1;for(;e<t.length;e++){if(t[e]===E6e||t[e]===S6e)r===""?r=t[e]:r!==t[e]||(r="");else if(t[e]===">"&&r===""){i=!0;break}n+=t[e]}return r!==""?!1:{value:n,index:e,tagClosed:i}}const C6e=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function oq(t,e){const n=nU.getAllMatches(t,C6e),r={};for(let i=0;i<n.length;i++){if(n[i][1].length===0)return zs("InvalidAttr","Attribute '"+n[i][2]+"' has no space in starting.",Eb(n[i]));if(n[i][3]!==void 0&&n[i][4]===void 0)return zs("InvalidAttr","Attribute '"+n[i][2]+"' is without value.",Eb(n[i]));if(n[i][3]===void 0&&!e.allowBooleanAttributes)return zs("InvalidAttr","boolean attribute '"+n[i][2]+"' is not allowed.",Eb(n[i]));const o=n[i][2];if(!M6e(o))return zs("InvalidAttr","Attribute '"+o+"' is an invalid name.",Eb(n[i]));if(!r.hasOwnProperty(o))r[o]=1;else return zs("InvalidAttr","Attribute '"+o+"' is repeated.",Eb(n[i]))}return!0}function P6e(t,e){let n=/\d/;for(t[e]==="x"&&(e++,n=/[\da-fA-F]/);e<t.length;e++){if(t[e]===";")return e;if(!t[e].match(n))break}return-1}function I6e(t,e){if(e++,t[e]===";")return-1;if(t[e]==="#")return e++,P6e(t,e);let n=0;for(;e<t.length;e++,n++)if(!(t[e].match(/\w/)&&n<20)){if(t[e]===";")break;return-1}return e}function zs(t,e,n){return{err:{code:t,msg:e,line:n.line||n,col:n.col}}}function M6e(t){return nU.isName(t)}function O6e(t){return nU.isName(t)}function xu(t,e){const n=t.substring(0,e).split(/\r?\n/);return{line:n.length,col:n[n.length-1].length+1}}function Eb(t){return t.startIndex+t[1].length}var rU={};const zoe={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(t,e,n){return t}},R6e=function(t){return Object.assign({},zoe,t)};rU.buildOptions=R6e;rU.defaultOptions=zoe;class L6e{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,n){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:n})}addChild(e){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}}var D6e=L6e;const B6e=sL;function N6e(t,e){const n={};if(t[e+3]==="O"&&t[e+4]==="C"&&t[e+5]==="T"&&t[e+6]==="Y"&&t[e+7]==="P"&&t[e+8]==="E"){e=e+9;let r=1,i=!1,o=!1,a="";for(;e<t.length;e++)if(t[e]==="<"&&!o){if(i&&z6e(t,e))e+=7,[entityName,val,e]=F6e(t,e+1),val.indexOf("&")===-1&&(n[V6e(entityName)]={regx:RegExp(`&${entityName};`,"g"),val});else if(i&&U6e(t,e))e+=8;else if(i&&G6e(t,e))e+=8;else if(i&&j6e(t,e))e+=9;else if(k6e)o=!0;else throw new Error("Invalid DOCTYPE");r++,a=""}else if(t[e]===">"){if(o?t[e-1]==="-"&&t[e-2]==="-"&&(o=!1,r--):r--,r===0)break}else t[e]==="["?i=!0:a+=t[e];if(r!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:n,i:e}}function F6e(t,e){let n="";for(;e<t.length&&t[e]!=="'"&&t[e]!=='"';e++)n+=t[e];if(n=n.trim(),n.indexOf(" ")!==-1)throw new Error("External entites are not supported");const r=t[e++];let i="";for(;e<t.length&&t[e]!==r;e++)i+=t[e];return[n,i,e]}function k6e(t,e){return t[e+1]==="!"&&t[e+2]==="-"&&t[e+3]==="-"}function z6e(t,e){return t[e+1]==="!"&&t[e+2]==="E"&&t[e+3]==="N"&&t[e+4]==="T"&&t[e+5]==="I"&&t[e+6]==="T"&&t[e+7]==="Y"}function U6e(t,e){return t[e+1]==="!"&&t[e+2]==="E"&&t[e+3]==="L"&&t[e+4]==="E"&&t[e+5]==="M"&&t[e+6]==="E"&&t[e+7]==="N"&&t[e+8]==="T"}function G6e(t,e){return t[e+1]==="!"&&t[e+2]==="A"&&t[e+3]==="T"&&t[e+4]==="T"&&t[e+5]==="L"&&t[e+6]==="I"&&t[e+7]==="S"&&t[e+8]==="T"}function j6e(t,e){return t[e+1]==="!"&&t[e+2]==="N"&&t[e+3]==="O"&&t[e+4]==="T"&&t[e+5]==="A"&&t[e+6]==="T"&&t[e+7]==="I"&&t[e+8]==="O"&&t[e+9]==="N"}function V6e(t){if(B6e.isName(t))return t;throw new Error(`Invalid entity name ${t}`)}var $6e=N6e;const H6e=/^[-+]?0x[a-fA-F0-9]+$/,W6e=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt);!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const q6e={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function X6e(t,e={}){if(e=Object.assign({},q6e,e),!t||typeof t!="string")return t;let n=t.trim();if(e.skipLike!==void 0&&e.skipLike.test(n))return t;if(e.hex&&H6e.test(n))return Number.parseInt(n,16);{const r=W6e.exec(n);if(r){const i=r[1],o=r[2];let a=Z6e(r[3]);const s=r[4]||r[6];if(!e.leadingZeros&&o.length>0&&i&&n[2]!==".")return t;if(!e.leadingZeros&&o.length>0&&!i&&n[1]!==".")return t;{const u=Number(n),d=""+u;return d.search(/[eE]/)!==-1||s?e.eNotation?u:t:n.indexOf(".")!==-1?d==="0"&&a===""||d===a||i&&d==="-"+a?u:t:o?a===d||i+a===d?u:t:n===d||n===i+d?u:t}}else return t}}function Z6e(t){return t&&t.indexOf(".")!==-1&&(t=t.replace(/0+$/,""),t==="."?t="0":t[0]==="."?t="0"+t:t[t.length-1]==="."&&(t=t.substr(0,t.length-1))),t}var Y6e=X6e;const iU=sL,Sb=D6e,Q6e=$6e,K6e=Y6e;"<((!\\[CDATA\\[([\\s\\S]*?)(]]>))|((NAME:)?(NAME))([^>]*)>|((\\/)(NAME)\\s*>))([^<]*)".replace(/NAME/g,iU.nameRegexp);let J6e=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""}},this.addExternalEntities=eUe,this.parseXml=oUe,this.parseTextData=tUe,this.resolveNameSpace=nUe,this.buildAttributesMap=iUe,this.isItStopNode=uUe,this.replaceEntitiesValue=aUe,this.readStopNodeData=fUe,this.saveTextToParentTag=lUe,this.addChild=sUe}};function eUe(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const r=e[n];this.lastEntities[r]={regex:new RegExp("&"+r+";","g"),val:t[r]}}}function tUe(t,e,n,r,i,o,a){if(t!==void 0&&(this.options.trimValues&&!r&&(t=t.trim()),t.length>0)){a||(t=this.replaceEntitiesValue(t));const s=this.options.tagValueProcessor(e,t,n,i,o);return s==null?t:typeof s!=typeof t||s!==t?s:this.options.trimValues?I4(t,this.options.parseTagValue,this.options.numberParseOptions):t.trim()===t?I4(t,this.options.parseTagValue,this.options.numberParseOptions):t}}function nUe(t){if(this.options.removeNSPrefix){const e=t.split(":"),n=t.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(t=n+e[1])}return t}const rUe=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function iUe(t,e,n){if(!this.options.ignoreAttributes&&typeof t=="string"){const r=iU.getAllMatches(t,rUe),i=r.length,o={};for(let a=0;a<i;a++){const s=this.resolveNameSpace(r[a][1]);let u=r[a][4],d=this.options.attributeNamePrefix+s;if(s.length)if(this.options.transformAttributeName&&(d=this.options.transformAttributeName(d)),d==="__proto__"&&(d="#__proto__"),u!==void 0){this.options.trimValues&&(u=u.trim()),u=this.replaceEntitiesValue(u);const g=this.options.attributeValueProcessor(s,u,e);g==null?o[d]=u:typeof g!=typeof u||g!==u?o[d]=g:o[d]=I4(u,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(o[d]=!0)}if(!Object.keys(o).length)return;if(this.options.attributesGroupName){const a={};return a[this.options.attributesGroupName]=o,a}return o}}const oUe=function(t){t=t.replace(/\r\n?/g,`
`);const e=new Sb("!xml");let n=e,r="",i="";for(let o=0;o<t.length;o++)if(t[o]==="<")if(t[o+1]==="/"){const s=S0(t,">",o,"Closing Tag is not closed.");let u=t.substring(o+2,s).trim();if(this.options.removeNSPrefix){const _=u.indexOf(":");_!==-1&&(u=u.substr(_+1))}this.options.transformTagName&&(u=this.options.transformTagName(u)),n&&(r=this.saveTextToParentTag(r,n,i));const d=i.substring(i.lastIndexOf(".")+1);if(u&&this.options.unpairedTags.indexOf(u)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${u}>`);let g=0;d&&this.options.unpairedTags.indexOf(d)!==-1?(g=i.lastIndexOf(".",i.lastIndexOf(".")-1),this.tagsNodeStack.pop()):g=i.lastIndexOf("."),i=i.substring(0,g),n=this.tagsNodeStack.pop(),r="",o=s}else if(t[o+1]==="?"){let s=P4(t,o,!1,"?>");if(!s)throw new Error("Pi Tag is not closed.");if(r=this.saveTextToParentTag(r,n,i),!(this.options.ignoreDeclaration&&s.tagName==="?xml"||this.options.ignorePiTags)){const u=new Sb(s.tagName);u.add(this.options.textNodeName,""),s.tagName!==s.tagExp&&s.attrExpPresent&&(u[":@"]=this.buildAttributesMap(s.tagExp,i,s.tagName)),this.addChild(n,u,i)}o=s.closeIndex+1}else if(t.substr(o+1,3)==="!--"){const s=S0(t,"-->",o+4,"Comment is not closed.");if(this.options.commentPropName){const u=t.substring(o+4,s-2);r=this.saveTextToParentTag(r,n,i),n.add(this.options.commentPropName,[{[this.options.textNodeName]:u}])}o=s}else if(t.substr(o+1,2)==="!D"){const s=Q6e(t,o);this.docTypeEntities=s.entities,o=s.i}else if(t.substr(o+1,2)==="!["){const s=S0(t,"]]>",o,"CDATA is not closed.")-2,u=t.substring(o+9,s);if(r=this.saveTextToParentTag(r,n,i),this.options.cdataPropName)n.add(this.options.cdataPropName,[{[this.options.textNodeName]:u}]);else{let d=this.parseTextData(u,n.tagname,i,!0,!1,!0);d==null&&(d=""),n.add(this.options.textNodeName,d)}o=s+2}else{let s=P4(t,o,this.options.removeNSPrefix),u=s.tagName;const d=s.rawTagName;let g=s.tagExp,_=s.attrExpPresent,E=s.closeIndex;this.options.transformTagName&&(u=this.options.transformTagName(u)),n&&r&&n.tagname!=="!xml"&&(r=this.saveTextToParentTag(r,n,i,!1));const P=n;if(P&&this.options.unpairedTags.indexOf(P.tagname)!==-1&&(n=this.tagsNodeStack.pop(),i=i.substring(0,i.lastIndexOf("."))),u!==e.tagname&&(i+=i?"."+u:u),this.isItStopNode(this.options.stopNodes,i,u)){let O="";if(g.length>0&&g.lastIndexOf("/")===g.length-1)o=s.closeIndex;else if(this.options.unpairedTags.indexOf(u)!==-1)o=s.closeIndex;else{const V=this.readStopNodeData(t,d,E+1);if(!V)throw new Error(`Unexpected end of ${d}`);o=V.i,O=V.tagContent}const D=new Sb(u);u!==g&&_&&(D[":@"]=this.buildAttributesMap(g,i,u)),O&&(O=this.parseTextData(O,u,i,!0,_,!0,!0)),i=i.substr(0,i.lastIndexOf(".")),D.add(this.options.textNodeName,O),this.addChild(n,D,i)}else{if(g.length>0&&g.lastIndexOf("/")===g.length-1){u[u.length-1]==="/"?(u=u.substr(0,u.length-1),i=i.substr(0,i.length-1),g=u):g=g.substr(0,g.length-1),this.options.transformTagName&&(u=this.options.transformTagName(u));const O=new Sb(u);u!==g&&_&&(O[":@"]=this.buildAttributesMap(g,i,u)),this.addChild(n,O,i),i=i.substr(0,i.lastIndexOf("."))}else{const O=new Sb(u);this.tagsNodeStack.push(n),u!==g&&_&&(O[":@"]=this.buildAttributesMap(g,i,u)),this.addChild(n,O,i),n=O}r="",o=E}}else r+=t[o];return e.child};function sUe(t,e,n){const r=this.options.updateTag(e.tagname,n,e[":@"]);r===!1||(typeof r=="string"&&(e.tagname=r),t.addChild(e))}const aUe=function(t){if(this.options.processEntities){for(let e in this.docTypeEntities){const n=this.docTypeEntities[e];t=t.replace(n.regx,n.val)}for(let e in this.lastEntities){const n=this.lastEntities[e];t=t.replace(n.regex,n.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const n=this.htmlEntities[e];t=t.replace(n.regex,n.val)}t=t.replace(this.ampEntity.regex,this.ampEntity.val)}return t};function lUe(t,e,n,r){return t&&(r===void 0&&(r=Object.keys(e.child).length===0),t=this.parseTextData(t,e.tagname,n,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,r),t!==void 0&&t!==""&&e.add(this.options.textNodeName,t),t=""),t}function uUe(t,e,n){const r="*."+n;for(const i in t){const o=t[i];if(r===o||e===o)return!0}return!1}function cUe(t,e,n=">"){let r,i="";for(let o=e;o<t.length;o++){let a=t[o];if(r)a===r&&(r="");else if(a==='"'||a==="'")r=a;else if(a===n[0])if(n[1]){if(t[o+1]===n[1])return{data:i,index:o}}else return{data:i,index:o};else a==="	"&&(a=" ");i+=a}}function S0(t,e,n,r){const i=t.indexOf(e,n);if(i===-1)throw new Error(r);return i+e.length-1}function P4(t,e,n,r=">"){const i=cUe(t,e+1,r);if(!i)return;let o=i.data;const a=i.index,s=o.search(/\s/);let u=o,d=!0;s!==-1&&(u=o.substr(0,s).replace(/\s\s*$/,""),o=o.substr(s+1));const g=u;if(n){const _=u.indexOf(":");_!==-1&&(u=u.substr(_+1),d=u!==i.data.substr(_+1))}return{tagName:u,tagExp:o,closeIndex:a,attrExpPresent:d,rawTagName:g}}function fUe(t,e,n){const r=n;let i=1;for(;n<t.length;n++)if(t[n]==="<")if(t[n+1]==="/"){const o=S0(t,">",n,`${e} is not closed`);if(t.substring(n+2,o).trim()===e&&(i--,i===0))return{tagContent:t.substring(r,n),i:o};n=o}else if(t[n+1]==="?")n=S0(t,"?>",n+1,"StopNode is not closed.");else if(t.substr(n+1,3)==="!--")n=S0(t,"-->",n+3,"StopNode is not closed.");else if(t.substr(n+1,2)==="![")n=S0(t,"]]>",n,"StopNode is not closed.")-2;else{const o=P4(t,n,">");o&&((o&&o.tagName)===e&&o.tagExp[o.tagExp.length-1]!=="/"&&i++,n=o.closeIndex)}}function I4(t,e,n){if(e&&typeof t=="string"){const r=t.trim();return r==="true"?!0:r==="false"?!1:K6e(t,n)}else return iU.isExist(t)?t:""}var hUe=J6e,Uoe={};function dUe(t,e){return Goe(t,e)}function Goe(t,e,n){let r;const i={};for(let o=0;o<t.length;o++){const a=t[o],s=pUe(a);let u="";if(n===void 0?u=s:u=n+"."+s,s===e.textNodeName)r===void 0?r=a[s]:r+=""+a[s];else{if(s===void 0)continue;if(a[s]){let d=Goe(a[s],e,u);const g=mUe(d,e);a[":@"]?gUe(d,a[":@"],u,e):Object.keys(d).length===1&&d[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?d=d[e.textNodeName]:Object.keys(d).length===0&&(e.alwaysCreateTextNode?d[e.textNodeName]="":d=""),i[s]!==void 0&&i.hasOwnProperty(s)?(Array.isArray(i[s])||(i[s]=[i[s]]),i[s].push(d)):e.isArray(s,u,g)?i[s]=[d]:i[s]=d}}}return typeof r=="string"?r.length>0&&(i[e.textNodeName]=r):r!==void 0&&(i[e.textNodeName]=r),i}function pUe(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const r=e[n];if(r!==":@")return r}}function gUe(t,e,n,r){if(e){const i=Object.keys(e),o=i.length;for(let a=0;a<o;a++){const s=i[a];r.isArray(s,n+"."+s,!0,!0)?t[s]=[e[s]]:t[s]=e[s]}}}function mUe(t,e){const{textNodeName:n}=e,r=Object.keys(t).length;return!!(r===0||r===1&&(t[n]||typeof t[n]=="boolean"||t[n]===0))}Uoe.prettify=dUe;const{buildOptions:AUe}=rU,_Ue=hUe,{prettify:yUe}=Uoe,vUe=tU;let xUe=class{constructor(e){this.externalEntities={},this.options=AUe(e)}parse(e,n){if(typeof e!="string")if(e.toString)e=e.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(n){n===!0&&(n={});const o=vUe.validate(e,n);if(o!==!0)throw Error(`${o.err.msg}:${o.err.line}:${o.err.col}`)}const r=new _Ue(this.options);r.addExternalEntities(this.externalEntities);const i=r.parseXml(e);return this.options.preserveOrder||i===void 0?i:yUe(i,this.options)}addEntity(e,n){if(n.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(n==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=n}};var bUe=xUe;const wUe=`
`;function EUe(t,e){let n="";return e.format&&e.indentBy.length>0&&(n=wUe),joe(t,e,"",n)}function joe(t,e,n,r){let i="",o=!1;for(let a=0;a<t.length;a++){const s=t[a],u=SUe(s);if(u===void 0)continue;let d="";if(n.length===0?d=u:d=`${n}.${u}`,u===e.textNodeName){let O=s[u];TUe(d,e)||(O=e.tagValueProcessor(u,O),O=Voe(O,e)),o&&(i+=r),i+=O,o=!1;continue}else if(u===e.cdataPropName){o&&(i+=r),i+=`<![CDATA[${s[u][0][e.textNodeName]}]]>`,o=!1;continue}else if(u===e.commentPropName){i+=r+`<!--${s[u][0][e.textNodeName]}-->`,o=!0;continue}else if(u[0]==="?"){const O=sq(s[":@"],e),D=u==="?xml"?"":r;let V=s[u][0][e.textNodeName];V=V.length!==0?" "+V:"",i+=D+`<${u}${V}${O}?>`,o=!0;continue}let g=r;g!==""&&(g+=e.indentBy);const _=sq(s[":@"],e),E=r+`<${u}${_}`,P=joe(s[u],e,d,g);e.unpairedTags.indexOf(u)!==-1?e.suppressUnpairedNode?i+=E+">":i+=E+"/>":(!P||P.length===0)&&e.suppressEmptyNode?i+=E+"/>":P&&P.endsWith(">")?i+=E+`>${P}${r}</${u}>`:(i+=E+">",P&&r!==""&&(P.includes("/>")||P.includes("</"))?i+=r+e.indentBy+P+r:i+=P,i+=`</${u}>`),o=!0}return i}function SUe(t){const e=Object.keys(t);for(let n=0;n<e.length;n++){const r=e[n];if(t.hasOwnProperty(r)&&r!==":@")return r}}function sq(t,e){let n="";if(t&&!e.ignoreAttributes)for(let r in t){if(!t.hasOwnProperty(r))continue;let i=e.attributeValueProcessor(r,t[r]);i=Voe(i,e),i===!0&&e.suppressBooleanAttributes?n+=` ${r.substr(e.attributeNamePrefix.length)}`:n+=` ${r.substr(e.attributeNamePrefix.length)}="${i}"`}return n}function TUe(t,e){t=t.substr(0,t.length-e.textNodeName.length-1);let n=t.substr(t.lastIndexOf(".")+1);for(let r in e.stopNodes)if(e.stopNodes[r]===t||e.stopNodes[r]==="*."+n)return!0;return!1}function Voe(t,e){if(t&&t.length>0&&e.processEntities)for(let n=0;n<e.entities.length;n++){const r=e.entities[n];t=t.replace(r.regex,r.val)}return t}var CUe=EUe;const PUe=CUe,IUe={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(t,e){return e},attributeValueProcessor:function(t,e){return e},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function SA(t){this.options=Object.assign({},IUe,t),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=RUe),this.processTextOrObjNode=MUe,this.options.format?(this.indentate=OUe,this.tagEndChar=`>
`,this.newLine=`
`):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}SA.prototype.build=function(t){return this.options.preserveOrder?PUe(t,this.options):(Array.isArray(t)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(t={[this.options.arrayNodeName]:t}),this.j2x(t,0).val)};SA.prototype.j2x=function(t,e){let n="",r="";for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i))if(typeof t[i]>"u")this.isAttribute(i)&&(r+="");else if(t[i]===null)this.isAttribute(i)?r+="":i[0]==="?"?r+=this.indentate(e)+"<"+i+"?"+this.tagEndChar:r+=this.indentate(e)+"<"+i+"/"+this.tagEndChar;else if(t[i]instanceof Date)r+=this.buildTextValNode(t[i],i,"",e);else if(typeof t[i]!="object"){const o=this.isAttribute(i);if(o)n+=this.buildAttrPairStr(o,""+t[i]);else if(i===this.options.textNodeName){let a=this.options.tagValueProcessor(i,""+t[i]);r+=this.replaceEntitiesValue(a)}else r+=this.buildTextValNode(t[i],i,"",e)}else if(Array.isArray(t[i])){const o=t[i].length;let a="";for(let s=0;s<o;s++){const u=t[i][s];typeof u>"u"||(u===null?i[0]==="?"?r+=this.indentate(e)+"<"+i+"?"+this.tagEndChar:r+=this.indentate(e)+"<"+i+"/"+this.tagEndChar:typeof u=="object"?this.options.oneListGroup?a+=this.j2x(u,e+1).val:a+=this.processTextOrObjNode(u,i,e):a+=this.buildTextValNode(u,i,"",e))}this.options.oneListGroup&&(a=this.buildObjectNode(a,i,"",e)),r+=a}else if(this.options.attributesGroupName&&i===this.options.attributesGroupName){const o=Object.keys(t[i]),a=o.length;for(let s=0;s<a;s++)n+=this.buildAttrPairStr(o[s],""+t[i][o[s]])}else r+=this.processTextOrObjNode(t[i],i,e);return{attrStr:n,val:r}};SA.prototype.buildAttrPairStr=function(t,e){return e=this.options.attributeValueProcessor(t,""+e),e=this.replaceEntitiesValue(e),this.options.suppressBooleanAttributes&&e==="true"?" "+t:" "+t+'="'+e+'"'};function MUe(t,e,n){const r=this.j2x(t,n+1);return t[this.options.textNodeName]!==void 0&&Object.keys(t).length===1?this.buildTextValNode(t[this.options.textNodeName],e,r.attrStr,n):this.buildObjectNode(r.val,e,r.attrStr,n)}SA.prototype.buildObjectNode=function(t,e,n,r){if(t==="")return e[0]==="?"?this.indentate(r)+"<"+e+n+"?"+this.tagEndChar:this.indentate(r)+"<"+e+n+this.closeTag(e)+this.tagEndChar;{let i="</"+e+this.tagEndChar,o="";return e[0]==="?"&&(o="?",i=""),(n||n==="")&&t.indexOf("<")===-1?this.indentate(r)+"<"+e+n+o+">"+t+i:this.options.commentPropName!==!1&&e===this.options.commentPropName&&o.length===0?this.indentate(r)+`<!--${t}-->`+this.newLine:this.indentate(r)+"<"+e+n+o+this.tagEndChar+t+this.indentate(r)+i}};SA.prototype.closeTag=function(t){let e="";return this.options.unpairedTags.indexOf(t)!==-1?this.options.suppressUnpairedNode||(e="/"):this.options.suppressEmptyNode?e="/":e=`></${t}`,e};SA.prototype.buildTextValNode=function(t,e,n,r){if(this.options.cdataPropName!==!1&&e===this.options.cdataPropName)return this.indentate(r)+`<![CDATA[${t}]]>`+this.newLine;if(this.options.commentPropName!==!1&&e===this.options.commentPropName)return this.indentate(r)+`<!--${t}-->`+this.newLine;if(e[0]==="?")return this.indentate(r)+"<"+e+n+"?"+this.tagEndChar;{let i=this.options.tagValueProcessor(e,t);return i=this.replaceEntitiesValue(i),i===""?this.indentate(r)+"<"+e+n+this.closeTag(e)+this.tagEndChar:this.indentate(r)+"<"+e+n+">"+i+"</"+e+this.tagEndChar}};SA.prototype.replaceEntitiesValue=function(t){if(t&&t.length>0&&this.options.processEntities)for(let e=0;e<this.options.entities.length;e++){const n=this.options.entities[e];t=t.replace(n.regex,n.val)}return t};function OUe(t){return this.options.indentBy.repeat(t)}function RUe(t){return t.startsWith(this.options.attributeNamePrefix)&&t!==this.options.textNodeName?t.substr(this.attrPrefixLen):!1}var LUe=SA;const DUe=tU,BUe=bUe,NUe=LUe;var FUe={XMLParser:BUe,XMLValidator:DUe,XMLBuilder:NUe};function kUe(t,e){return new FUe.XMLParser({ignoreAttributes:!1,attributeNamePrefix:"",...e}).parse(t)}function zUe(t){return typeof t=="string"?t.charAt(0).toLowerCase()+t.slice(1):t}function M4(t){if(Array.isArray(t))return t.map(e=>M4(e));if(t&&typeof t=="object"){const e={};for(const[n,r]of Object.entries(t))e[zUe(n)]=M4(r);return e}return t}const UUe="3.4.14",i_={name:"XML",id:"xml",module:"xml",version:UUe,worker:!1,extensions:["xml"],mimeTypes:["application/xml","text/xml"],testText:GUe,options:{xml:{parser:"fast-xml-parser",uncapitalizeKeys:!1,removeNSPrefix:!1,textNodeName:"value",arrayPaths:[]}},parse:async(t,e)=>aq(new TextDecoder().decode(t),e),parseTextSync:(t,e)=>aq(t,e)};function GUe(t){return t.startsWith("<?xml")}function aq(t,e){var n;const r={...i_.options.xml,...e==null?void 0:e.xml};switch(r.parser){case"fast-xml-parser":const i={allowBooleanAttributes:!0,ignoreDeclaration:!0,removeNSPrefix:r.removeNSPrefix,textNodeName:r.textNodeName,isArray:(a,s,u,d)=>{var g;return!!(!(r==null||(g=r.arrayPaths)===null||g===void 0)&&g.some(E=>s===E))},...e==null?void 0:e._fastXML},o=kUe(t,i);return r.uncapitalizeKeys?M4(o):o;default:throw new Error(e==null||(n=e.xml)===null||n===void 0?void 0:n.parser)}}function jUe(t,e){var n,r,i;const o=(n=i_.parseTextSync)===null||n===void 0?void 0:n.call(i_,t,e),a=(o==null||(r=o.ServiceExceptionReport)===null||r===void 0?void 0:r.ServiceException)||(o==null||(i=o["ogc:ServiceExceptionReport"])===null||i===void 0?void 0:i["ogc:ServiceException"]);return typeof a=="string"?a:a.value||a.code||"Unknown error"}const VUe="3.4.14",hP={id:"wms-error",name:"WMS Error",module:"wms",version:VUe,worker:!1,extensions:["xml"],mimeTypes:["application/vnd.ogc.se_xml","application/xml","text/xml"],testText:$Ue,options:{wms:{throwOnError:!1}},parse:async(t,e)=>RB(new TextDecoder().decode(t),e),parseSync:(t,e)=>RB(new TextDecoder().decode(t),e),parseTextSync:(t,e)=>RB(t,e)};function $Ue(t){return t.startsWith("<?xml")}function RB(t,e){const n={...hP.options.wms,...e==null?void 0:e.wms},r=jUe(t,n),i=n.minimalErrors?r:"WMS Service error: ".concat(r);if(n.throwOnError)throw new Error(i);return i}function v1(t){return Array.isArray(t)?t:t?[t]:[]}function aL(t){const e=v1(t);return e.length>0&&e.every(n=>typeof n=="string")?e:[]}function lT(t){switch(typeof t){case"number":return t;case"string":return parseFloat(t);default:return}}function LB(t){switch(typeof t){case"number":return t;case"string":return parseInt(t,10);default:return}}function wv(t){switch(t){case"true":return!0;case"false":return!1;case"1":return!0;case"0":return!1;default:return!1}}function lq(t,e){const n=i_.parseTextSync(t,e),r=n.WMT_MS_Capabilities||n.WMS_Capabilities||n,i=HUe(r);if(e!=null&&e.inheritedLayerProps)for(const o of i.layers)Hoe(o,null);return(e!=null&&e.includeRawData||e!=null&&e.raw)&&(i.raw=r),e!=null&&e.includeXMLText&&(i.xml=t),i}function HUe(t){var e,n,r,i,o,a,s,u,d,g,_,E,P,O,D,V;const k={version:String(t.version||""),name:String(((e=t.Service)===null||e===void 0?void 0:e.Name)||"unnamed"),title:(n=t.Service)!==null&&n!==void 0&&n.Title?String((r=t.Service)===null||r===void 0?void 0:r.Title):void 0,abstract:(i=t.Service)!==null&&i!==void 0&&i.Abstract?String((o=t.Service)===null||o===void 0?void 0:o.Abstract):void 0,keywords:aL((a=t.Service)===null||a===void 0||(s=a.KeywordList)===null||s===void 0?void 0:s.Keyword),fees:(u=t.Service)!==null&&u!==void 0&&u.Fees?JSON.stringify((d=t.Service)===null||d===void 0?void 0:d.Fees):void 0,accessConstraints:(g=t.Service)!==null&&g!==void 0&&g.AccessConstraints?JSON.stringify((_=t.Service)===null||_===void 0?void 0:_.AccessConstraints):void 0,layerLimit:LB((E=t.Service)===null||E===void 0?void 0:E.LayerLimit),maxWidth:LB((P=t.Service)===null||P===void 0?void 0:P.maxWidth),maxHeight:LB((O=t.Service)===null||O===void 0?void 0:O.maxHeight),layers:[],requests:WUe((D=t.Capability)===null||D===void 0?void 0:D.Request),exceptions:qUe(t.Exception)},F=v1((V=t.Capability)===null||V===void 0?void 0:V.Layer);for(const z of F)k.layers.push($oe(z));for(const[z,X]of Object.entries(k))X===void 0&&delete k[z];return k}function WUe(t){const e={};for(const[n,r]of Object.entries(t||{})){const i=aL(r==null?void 0:r.Format);e[n]={mimeTypes:i}}return e}function qUe(t){if(v1(t==null?void 0:t.Format).length>0)return{mimeTypes:aL(t)}}function $oe(t){var e;const n={title:String((t==null?void 0:t.Title)||""),name:(t==null?void 0:t.Name)&&String(t==null?void 0:t.Name),abstract:(t==null?void 0:t.Name)&&String(t==null?void 0:t.Abstract),keywords:aL((e=t.KeywordList)===null||e===void 0?void 0:e.Keyword)},r=(t==null?void 0:t.CRS)||(t==null?void 0:t.SRS);r&&Array.isArray(r)&&r.every(g=>typeof g=="string")&&(n.crs=r);let i=(t==null?void 0:t.EX_GeographicBoundingBox)&&XUe(t==null?void 0:t.EX_GeographicBoundingBox);i&&(n.geographicBoundingBox=i),i=(t==null?void 0:t.LatLonBoundingBox)&&ZUe(t==null?void 0:t.LatLonBoundingBox),i&&(n.geographicBoundingBox=i);const o=(t==null?void 0:t.BoundingBox)&&YUe(t==null?void 0:t.BoundingBox);o&&o.length>0&&(n.boundingBoxes=o);const s=v1(t==null?void 0:t.Dimension).map(g=>KUe(g));s.length&&(n.dimensions=s),t!=null&&t.opaque&&(n.opaque=wv(t==null?void 0:t.opaque)),t!=null&&t.cascaded&&(n.cascaded=wv(t==null?void 0:t.cascaded)),t!=null&&t.queryable&&(n.queryable=wv(t==null?void 0:t.queryable));const u=v1(t==null?void 0:t.Layer),d=[];for(const g of u)d.push($oe(g));d.length>0&&(n.layers=d);for(const[g,_]of Object.entries(n))_===void 0&&delete n[g];return n}function XUe(t){const{westBoundLongitude:e,northBoundLatitude:n,eastBoundLongitude:r,southBoundLatitude:i}=t;return[[e,i],[r,n]]}function ZUe(t){const{minx:e,miny:n,maxx:r,maxy:i}=t;return[[e,n],[r,i]]}function YUe(t){return v1(t).map(n=>QUe(n))}function QUe(t){const{CRS:e,SRS:n,minx:r,miny:i,maxx:o,maxy:a,resx:s,resy:u}=t,d={crs:e||n,boundingBox:[[lT(r),lT(i)],[lT(o),lT(a)]]};return s&&(d.xResolution=s),u&&(d.yResolution=u),d}function KUe(t){const{name:e,units:n,value:r}=t,i={name:e,units:n,extent:r};return t.unitSymbol&&(i.unitSymbol=t.unitSymbol),t.default&&(i.defaultValue=t.default),t.multipleValues&&(i.multipleValues=wv(t.multipleValues)),t.nearestValue&&(i.nearestValue=wv(t.nearestValue)),t.current&&(i.current=wv(t.current)),i}function Hoe(t,e){e!=null&&e.geographicBoundingBox&&!t.geographicBoundingBox&&(t.geographicBoundingBox=[...e.geographicBoundingBox]),e!=null&&e.crs&&!t.crs&&(t.crs=[...e.crs]),e!=null&&e.boundingBoxes&&!t.boundingBoxes&&(t.boundingBoxes=[...e.boundingBoxes]),e!=null&&e.dimensions&&!t.dimensions&&(t.dimensions=[...e.dimensions]);for(const n of t.layers||[])Hoe(n,t)}const JUe="3.4.14",oU={id:"wms-capabilities",name:"WMS Capabilities",module:"wms",version:JUe,worker:!1,extensions:["xml"],mimeTypes:["application/vnd.ogc.wms_xml","application/xml","text/xml"],testText:e8e,options:{wms:{}},parse:async(t,e)=>lq(new TextDecoder().decode(t),e==null?void 0:e.wms),parseTextSync:(t,e)=>lq(t,e==null?void 0:e.wms)};function e8e(t){return t.startsWith("<?xml")}function uq(t,e){var n;const i=((n=i_.parseTextSync(t,e).FeatureInfoResponse)===null||n===void 0?void 0:n.FIELDS)||[];return{features:(Array.isArray(i)?i:[i]).map(a=>t8e(a))}}function t8e(t){return{attributes:t||{},type:"",bounds:{bottom:0,top:0,left:0,right:0}}}const n8e={...oU,id:"wms-feature-info",name:"WMS FeatureInfo",parse:async(t,e)=>uq(new TextDecoder().decode(t),e),parseTextSync:(t,e)=>uq(t,e)};function cq(t,e){var n;return(n=i_.parseTextSync)===null||n===void 0?void 0:n.call(i_,t,e)}const r8e={...oU,id:"wms-layer-description",name:"WMS DescribeLayer",parse:async(t,e)=>cq(new TextDecoder().decode(t),e),parseTextSync:(t,e)=>cq(t,e)};class i8e{constructor(e){q(this,"fetch",void 0),q(this,"loadOptions",void 0),q(this,"_needsRefresh",!0),q(this,"props",void 0),this.props={...e},this.loadOptions={...e.loadOptions},this.fetch=o8e(this.loadOptions)}setProps(e){this.props=Object.assign(this.props,e),this.setNeedsRefresh()}setNeedsRefresh(){this._needsRefresh=!0}getNeedsRefresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;const n=this._needsRefresh;return e&&(this._needsRefresh=!1),n}}function o8e(t){const e=t==null?void 0:t.fetch;if(e&&typeof e=="function")return(r,i)=>e(r,i);const n=t==null?void 0:t.fetch;return n&&typeof n!="function"?r=>fetch(r,n):r=>fetch(r)}class lL extends i8e{}class uL extends lL{constructor(e){super(e)}async getMetadata(){throw new Error("ImageSource.getMetadata not implemented")}async getImage(e){const n=this.getGranularParameters(e),r=this.getURLFromTemplate(n),o=await(await this.fetch(r)).arrayBuffer();return await Uw.parse(o)}getGranularParameters(e){const[n,r,i,o]=e.bbox;return{...e,east:n,north:r,south:o,west:i}}getURLFromTemplate(e){let n=this.props.url;for(const[r,i]of Object.entries(e))n=n.replace("${".concat(r,"}"),String(i)),n=n.replace("{".concat(r,"}"),String(i));return n}}q(uL,"type","template");q(uL,"testURL",t=>t.toLowerCase().includes("{"));class cL extends lL{constructor(e){var n;super(e),q(this,"url",void 0),q(this,"substituteCRS84",void 0),q(this,"flipCRS",void 0),q(this,"wmsParameters",void 0),q(this,"vendorParameters",void 0),q(this,"capabilities",null),this.url=e.url,this.substituteCRS84=(n=e.substituteCRS84)!==null&&n!==void 0?n:!1,this.flipCRS=["EPSG:4326"],this.wmsParameters={layers:void 0,query_layers:void 0,styles:void 0,version:"1.3.0",crs:"EPSG:4326",format:"image/png",info_format:"text/plain",transparent:void 0,time:void 0,elevation:void 0,...e.wmsParameters},this.vendorParameters=e.vendorParameters||{}}async getMetadata(){const e=await this.getCapabilities();return this.normalizeMetadata(e)}async getImage(e){return await this.getMap(e)}normalizeMetadata(e){return e}async getCapabilities(e,n){const r=this.getCapabilitiesURL(e,n),i=await this.fetch(r),o=await i.arrayBuffer();this._checkResponse(i,o);const a=await oU.parse(o,this.loadOptions);return this.capabilities=a,a}async getMap(e,n){const r=this.getMapURL(e,n),i=await this.fetch(r),o=await i.arrayBuffer();this._checkResponse(i,o);try{return await Uw.parse(o,this.loadOptions)}catch{throw this._parseError(o)}}async getFeatureInfo(e,n){const r=this.getFeatureInfoURL(e,n),i=await this.fetch(r),o=await i.arrayBuffer();return this._checkResponse(i,o),await n8e.parse(o,this.loadOptions)}async getFeatureInfoText(e,n){const r=this.getFeatureInfoURL(e,n),i=await this.fetch(r),o=await i.arrayBuffer();return this._checkResponse(i,o),new TextDecoder().decode(o)}async describeLayer(e,n){const r=this.describeLayerURL(e,n),i=await this.fetch(r),o=await i.arrayBuffer();return this._checkResponse(i,o),await r8e.parse(o,this.loadOptions)}async getLegendGraphic(e,n){const r=this.getLegendGraphicURL(e,n),i=await this.fetch(r),o=await i.arrayBuffer();this._checkResponse(i,o);try{return await Uw.parse(o,this.loadOptions)}catch{throw this._parseError(o)}}getCapabilitiesURL(e,n){const r={version:this.wmsParameters.version,...e};return this._getWMSUrl("GetCapabilities",r,n)}getMapURL(e,n){e=this._getWMS130Parameters(e);const r={version:this.wmsParameters.version,format:this.wmsParameters.format,transparent:this.wmsParameters.transparent,time:this.wmsParameters.time,elevation:this.wmsParameters.elevation,layers:this.wmsParameters.layers,styles:this.wmsParameters.styles,crs:this.wmsParameters.crs,...e};return this._getWMSUrl("GetMap",r,n)}getFeatureInfoURL(e,n){const r={version:this.wmsParameters.version,info_format:this.wmsParameters.info_format,layers:this.wmsParameters.layers,query_layers:this.wmsParameters.query_layers,styles:this.wmsParameters.styles,crs:this.wmsParameters.crs,...e};return this._getWMSUrl("GetFeatureInfo",r,n)}describeLayerURL(e,n){const r={version:this.wmsParameters.version,...e};return this._getWMSUrl("DescribeLayer",r,n)}getLegendGraphicURL(e,n){const r={version:this.wmsParameters.version,...e};return this._getWMSUrl("GetLegendGraphic",r,n)}_parseWMSUrl(e){const[n,r]=e.split("?"),i=r.split("&"),o={};for(const a of i){const[s,u]=a.split("=");o[s]=u}return{url:n,parameters:o}}_getWMSUrl(e,n,r){let i=this.url,o=!0;const a={service:"WMS",version:n.version,request:e,...n,...this.vendorParameters,...r},s=["transparent","time","elevation"];for(const[u,d]of Object.entries(a))(!s.includes(u)||d)&&(i+=o?"?":"&",o=!1,i+=this._getURLParameter(u,d,n));return encodeURI(i)}_getWMS130Parameters(e){const n={...e};return n.srs&&(n.crs=n.crs||n.srs,delete n.srs),n}_getURLParameter(e,n,r){switch(e){case"crs":r.version!=="1.3.0"?e="srs":this.substituteCRS84&&n==="EPSG:4326"&&(n="CRS:84");break;case"srs":r.version==="1.3.0"&&(e="crs");break;case"bbox":const i=this._flipBoundingBox(n,r);i&&(n=i);break}return e=e.toUpperCase(),Array.isArray(n)?"".concat(e,"=").concat(n.join(",")):"".concat(e,"=").concat(n?String(n):"")}_flipBoundingBox(e,n){if(!Array.isArray(e)||e.length!==4)return null;const r=n.version==="1.3.0"&&this.flipCRS.includes(n.crs||"")&&!(this.substituteCRS84&&n.crs==="EPSG:4326"),i=e;return r?[i[1],i[0],i[3],i[2]]:i}async _fetchArrayBuffer(e){const n=await this.fetch(e),r=await n.arrayBuffer();return this._checkResponse(n,r),r}_checkResponse(e,n){const r=e.headers["content-type"];if(!e.ok||hP.mimeTypes.includes(r)){const i=rAe(this.loadOptions,{wms:{throwOnError:!0}}),o=hP.parseSync(n,i);throw new Error(o)}}_parseError(e){const n=hP.parseSync(e,this.loadOptions);return new Error(n)}}q(cL,"type","wms");q(cL,"testURL",t=>t.toLowerCase().includes("wms"));class sU extends lL{constructor(e){super(e)}async getMetadata(){return await this.metadata()}async getImage(e){throw new Error("not implemented")}async metadata(){throw new Error("not implemented")}exportImage(e){throw new Error("not implemented")}metadataURL(e){return"".concat(this.props.url,"?f=pjson")}exportImageURL(e){const n="bbox=".concat(e.bbox[0],",").concat(e.bbox[1],",").concat(e.bbox[2],",").concat(e.bbox[3]),r="size=".concat(e.width,",").concat(e.height),i={...e,bbox:n,size:r};return delete i.width,delete i.height,this.getUrl("exportImage",i)}getUrl(e,n,r){let i="".concat(this.props.url,"/").concat(e),o=!0;for(const[a,s]of Object.entries(n))i+=o?"?":"&",o=!1,Array.isArray(s)?i+="".concat(a.toUpperCase(),"=").concat(s.join(",")):i+="".concat(a.toUpperCase(),"=").concat(s?String(s):"");return i}async checkResponse(e){if(!e.ok)throw new Error("error")}}q(sU,"type","arcgis-image-server");q(sU,"testURL",t=>t.toLowerCase().includes("ImageServer"));const s8e=[cL,sU,uL];function a8e(t){const{type:e="auto"}=t;switch(e==="auto"?l8e(t.url):e){case"template":return new uL(t);case"wms":return new cL(t);default:throw new Error("Not a valid image source type")}}function l8e(t){for(const e of s8e)if(e.testURL&&e.testURL(t))return e.type;return"wms"}const fq=6378137*Math.PI;function hq(t){const e=El(t);return e[0]=(e[0]/256-1)*fq,e[1]=(e[1]/256-1)*fq,e}const u8e={id:"imagery-layer",data:"",serviceType:"auto",srs:"auto",layers:{type:"array",compare:!0,value:[]},onMetadataLoad:{type:"function",value:()=>{}},onMetadataLoadError:{type:"function",value:console.error},onImageLoadStart:{type:"function",value:()=>{}},onImageLoad:{type:"function",value:()=>{}},onImageLoadError:{type:"function",compare:!1,value:(t,e)=>console.error(e,t)}};class aU extends Uh{constructor(...e){super(...e),q(this,"state",void 0)}get isLoaded(){return!!this.state&&this.state.loadCounter===0&&super.isLoaded}shouldUpdateState(){return!0}initializeState(){this.state._nextRequestId=0,this.state.lastRequestId=-1,this.state.loadCounter=0}updateState({changeFlags:e,props:n,oldProps:r}){const{viewport:i}=this.context;e.dataChanged||n.serviceType!==r.serviceType?(this.state.imageSource=this._createImageSource(n),this._loadMetadata(),this.debounce(()=>this.loadImage(i,"image source changed"),0)):uc(n.layers,r.layers,1)?e.viewportChanged&&this.debounce(()=>this.loadImage(i,"viewport changed")):this.debounce(()=>this.loadImage(i,"layers changed"),0)}finalizeState(){}renderLayers(){const{bounds:e,image:n,lastRequestParameters:r}=this.state;return n&&new YR({...this.getSubLayerProps({id:"bitmap"}),_imageCoordinateSystem:r.srs==="EPSG:4326"?Br.LNGLAT:Br.CARTESIAN,bounds:e,image:n})}async getFeatureInfoText(e,n){const{lastRequestParameters:r}=this.state;if(r){var i,o;return await((i=(o=this.state.imageSource).getFeatureInfoText)===null||i===void 0?void 0:i.call(o,{...r,query_layers:r.layers,x:e,y:n,info_format:"application/vnd.ogc.gml"}))}return""}_createImageSource(e){if(e.data instanceof lL)return e.data;if(typeof e.data=="string")return a8e({url:e.data,loadOptions:e.loadOptions,type:e.serviceType});throw new Error("invalid image source in props.data")}async _loadMetadata(){const{imageSource:e}=this.state;try{this.state.loadCounter++;const i=await e.getMetadata();if(this.state.imageSource===e){var n;(n=this.getCurrentLayer())===null||n===void 0||n.props.onMetadataLoad(i)}}catch(i){var r;(r=this.getCurrentLayer())===null||r===void 0||r.props.onMetadataLoadError(i)}finally{this.state.loadCounter--}}async loadImage(e,n){const{layers:r,serviceType:i}=this.props;if(i==="wms"&&r.length===0)return;const o=e.getBounds(),{width:a,height:s}=e,u=this.getRequestId();let{srs:d}=this.props;d==="auto"&&(d=e.resolution?"EPSG:4326":"EPSG:3857");const g={width:a,height:s,bbox:o,layers:r,srs:d};if(d==="EPSG:3857"){const[P,O]=hq([o[0],o[1]]),[D,V]=hq([o[2],o[3]]);g.bbox=[P,O,D,V]}try{this.state.loadCounter++,this.props.onImageLoadStart(u);const P=await this.state.imageSource.getImage(g);if(this.state.lastRequestId<u){var _;(_=this.getCurrentLayer())===null||_===void 0||_.props.onImageLoad(u),this.setState({image:P,bounds:o,lastRequestParameters:g,lastRequestId:u})}}catch(P){var E;this.raiseError(P,"Load image"),(E=this.getCurrentLayer())===null||E===void 0||E.props.onImageLoadError(u,P)}finally{this.state.loadCounter--}}getRequestId(){return this.state._nextRequestId++}debounce(e,n=500){clearTimeout(this.state._timeoutId),this.state._timeoutId=setTimeout(()=>e(),n)}}q(aU,"layerName","WMSLayer");q(aU,"defaultProps",u8e);const c8e={getHeight:{type:"accessor",value:0},greatCircle:!0};class lU extends ZR{}q(lU,"layerName","GreatCircleLayer");q(lU,"defaultProps",c8e);const f8e={...EA.defaultProps};class w_ extends Uh{indexToBounds(){return null}renderLayers(){const{elevationScale:e,extruded:n,wireframe:r,filled:i,stroked:o,lineWidthUnits:a,lineWidthScale:s,lineWidthMinPixels:u,lineWidthMaxPixels:d,lineJointRounded:g,lineMiterLimit:_,lineDashJustified:E,getElevation:P,getFillColor:O,getLineColor:D,getLineWidth:V}=this.props,{updateTriggers:k,material:F,transitions:z}=this.props,X=this.getSubLayerClass("cell",EA),{updateTriggers:Y,...J}=this.indexToBounds()||{};return new X({filled:i,wireframe:r,extruded:n,elevationScale:e,stroked:o,lineWidthUnits:a,lineWidthScale:s,lineWidthMinPixels:u,lineWidthMaxPixels:d,lineJointRounded:g,lineMiterLimit:_,lineDashJustified:E,material:F,transitions:z,getElevation:P,getFillColor:O,getLineColor:D,getLineWidth:V},this.getSubLayerProps({id:"cell",updateTriggers:k&&{...Y,getElevation:k.getElevation,getFillColor:k.getFillColor,getLineColor:k.getLineColor,getLineWidth:k.getLineWidth}}),J)}}q(w_,"layerName","GeoCellLayer");q(w_,"defaultProps",f8e);function h8e(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Woe={exports:{}};(function(t){/**
 * @license long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 * Released under the Apache License, Version 2.0
 * see: https://github.com/dcodeIO/long.js for details
 */(function(e,n){typeof h8e=="function"&&t&&t.exports?t.exports=n():(e.dcodeIO=e.dcodeIO||{}).Long=n()})(Ya,function(){function e(ce,se,me){this.low=ce|0,this.high=se|0,this.unsigned=!!me}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0,enumerable:!1,configurable:!1});function n(ce){return(ce&&ce.__isLong__)===!0}e.isLong=n;var r={},i={};function o(ce,se){var me,Ce,we;return se?(ce>>>=0,(we=0<=ce&&ce<256)&&(Ce=i[ce],Ce)?Ce:(me=s(ce,(ce|0)<0?-1:0,!0),we&&(i[ce]=me),me)):(ce|=0,(we=-128<=ce&&ce<128)&&(Ce=r[ce],Ce)?Ce:(me=s(ce,ce<0?-1:0,!1),we&&(r[ce]=me),me))}e.fromInt=o;function a(ce,se){if(isNaN(ce)||!isFinite(ce))return se?F:k;if(se){if(ce<0)return F;if(ce>=O)return re}else{if(ce<=-D)return ue;if(ce+1>=D)return J}return ce<0?a(-ce,se).neg():s(ce%P|0,ce/P|0,se)}e.fromNumber=a;function s(ce,se,me){return new e(ce,se,me)}e.fromBits=s;var u=Math.pow;function d(ce,se,me){if(ce.length===0)throw Error("empty string");if(ce==="NaN"||ce==="Infinity"||ce==="+Infinity"||ce==="-Infinity")return k;if(typeof se=="number"?(me=se,se=!1):se=!!se,me=me||10,me<2||36<me)throw RangeError("radix");var Ce;if((Ce=ce.indexOf("-"))>0)throw Error("interior hyphen");if(Ce===0)return d(ce.substring(1),se,me).neg();for(var we=a(u(me,8)),Ye=k,at=0;at<ce.length;at+=8){var yt=Math.min(8,ce.length-at),be=parseInt(ce.substring(at,at+yt),me);if(yt<8){var De=a(u(me,yt));Ye=Ye.mul(De).add(a(be))}else Ye=Ye.mul(we),Ye=Ye.add(a(be))}return Ye.unsigned=se,Ye}e.fromString=d;function g(ce){return ce instanceof e?ce:typeof ce=="number"?a(ce):typeof ce=="string"?d(ce):s(ce.low,ce.high,ce.unsigned)}e.fromValue=g;var _=65536,E=1<<24,P=_*_,O=P*P,D=O/2,V=o(E),k=o(0);e.ZERO=k;var F=o(0,!0);e.UZERO=F;var z=o(1);e.ONE=z;var X=o(1,!0);e.UONE=X;var Y=o(-1);e.NEG_ONE=Y;var J=s(-1,2147483647,!1);e.MAX_VALUE=J;var re=s(-1,-1,!0);e.MAX_UNSIGNED_VALUE=re;var ue=s(0,-2147483648,!1);e.MIN_VALUE=ue;var ie=e.prototype;return ie.toInt=function(){return this.unsigned?this.low>>>0:this.low},ie.toNumber=function(){return this.unsigned?(this.high>>>0)*P+(this.low>>>0):this.high*P+(this.low>>>0)},ie.toString=function(se){if(se=se||10,se<2||36<se)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ue)){var me=a(se),Ce=this.div(me),we=Ce.mul(me).sub(this);return Ce.toString(se)+we.toInt().toString(se)}else return"-"+this.neg().toString(se);for(var Ye=a(u(se,6),this.unsigned),at=this,yt="";;){var be=at.div(Ye),De=at.sub(be.mul(Ye)).toInt()>>>0,Re=De.toString(se);if(at=be,at.isZero())return Re+yt;for(;Re.length<6;)Re="0"+Re;yt=""+Re+yt}},ie.getHighBits=function(){return this.high},ie.getHighBitsUnsigned=function(){return this.high>>>0},ie.getLowBits=function(){return this.low},ie.getLowBitsUnsigned=function(){return this.low>>>0},ie.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ue)?64:this.neg().getNumBitsAbs();for(var se=this.high!=0?this.high:this.low,me=31;me>0&&!(se&1<<me);me--);return this.high!=0?me+33:me+1},ie.isZero=function(){return this.high===0&&this.low===0},ie.isNegative=function(){return!this.unsigned&&this.high<0},ie.isPositive=function(){return this.unsigned||this.high>=0},ie.isOdd=function(){return(this.low&1)===1},ie.isEven=function(){return(this.low&1)===0},ie.equals=function(se){return n(se)||(se=g(se)),this.unsigned!==se.unsigned&&this.high>>>31===1&&se.high>>>31===1?!1:this.high===se.high&&this.low===se.low},ie.eq=ie.equals,ie.notEquals=function(se){return!this.eq(se)},ie.neq=ie.notEquals,ie.lessThan=function(se){return this.comp(se)<0},ie.lt=ie.lessThan,ie.lessThanOrEqual=function(se){return this.comp(se)<=0},ie.lte=ie.lessThanOrEqual,ie.greaterThan=function(se){return this.comp(se)>0},ie.gt=ie.greaterThan,ie.greaterThanOrEqual=function(se){return this.comp(se)>=0},ie.gte=ie.greaterThanOrEqual,ie.compare=function(se){if(n(se)||(se=g(se)),this.eq(se))return 0;var me=this.isNegative(),Ce=se.isNegative();return me&&!Ce?-1:!me&&Ce?1:this.unsigned?se.high>>>0>this.high>>>0||se.high===this.high&&se.low>>>0>this.low>>>0?-1:1:this.sub(se).isNegative()?-1:1},ie.comp=ie.compare,ie.negate=function(){return!this.unsigned&&this.eq(ue)?ue:this.not().add(z)},ie.neg=ie.negate,ie.add=function(se){n(se)||(se=g(se));var me=this.high>>>16,Ce=this.high&65535,we=this.low>>>16,Ye=this.low&65535,at=se.high>>>16,yt=se.high&65535,be=se.low>>>16,De=se.low&65535,Re=0,qe=0,ct=0,Ct=0;return Ct+=Ye+De,ct+=Ct>>>16,Ct&=65535,ct+=we+be,qe+=ct>>>16,ct&=65535,qe+=Ce+yt,Re+=qe>>>16,qe&=65535,Re+=me+at,Re&=65535,s(ct<<16|Ct,Re<<16|qe,this.unsigned)},ie.subtract=function(se){return n(se)||(se=g(se)),this.add(se.neg())},ie.sub=ie.subtract,ie.multiply=function(se){if(this.isZero()||(n(se)||(se=g(se)),se.isZero()))return k;if(this.eq(ue))return se.isOdd()?ue:k;if(se.eq(ue))return this.isOdd()?ue:k;if(this.isNegative())return se.isNegative()?this.neg().mul(se.neg()):this.neg().mul(se).neg();if(se.isNegative())return this.mul(se.neg()).neg();if(this.lt(V)&&se.lt(V))return a(this.toNumber()*se.toNumber(),this.unsigned);var me=this.high>>>16,Ce=this.high&65535,we=this.low>>>16,Ye=this.low&65535,at=se.high>>>16,yt=se.high&65535,be=se.low>>>16,De=se.low&65535,Re=0,qe=0,ct=0,Ct=0;return Ct+=Ye*De,ct+=Ct>>>16,Ct&=65535,ct+=we*De,qe+=ct>>>16,ct&=65535,ct+=Ye*be,qe+=ct>>>16,ct&=65535,qe+=Ce*De,Re+=qe>>>16,qe&=65535,qe+=we*be,Re+=qe>>>16,qe&=65535,qe+=Ye*yt,Re+=qe>>>16,qe&=65535,Re+=me*De+Ce*be+we*yt+Ye*at,Re&=65535,s(ct<<16|Ct,Re<<16|qe,this.unsigned)},ie.mul=ie.multiply,ie.divide=function(se){if(n(se)||(se=g(se)),se.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?F:k;var me,Ce,we;if(this.unsigned){if(se.unsigned||(se=se.toUnsigned()),se.gt(this))return F;if(se.gt(this.shru(1)))return X;we=F}else{if(this.eq(ue)){if(se.eq(z)||se.eq(Y))return ue;if(se.eq(ue))return z;var Ye=this.shr(1);return me=Ye.div(se).shl(1),me.eq(k)?se.isNegative()?z:Y:(Ce=this.sub(se.mul(me)),we=me.add(Ce.div(se)),we)}else if(se.eq(ue))return this.unsigned?F:k;if(this.isNegative())return se.isNegative()?this.neg().div(se.neg()):this.neg().div(se).neg();if(se.isNegative())return this.div(se.neg()).neg();we=k}for(Ce=this;Ce.gte(se);){me=Math.max(1,Math.floor(Ce.toNumber()/se.toNumber()));for(var at=Math.ceil(Math.log(me)/Math.LN2),yt=at<=48?1:u(2,at-48),be=a(me),De=be.mul(se);De.isNegative()||De.gt(Ce);)me-=yt,be=a(me,this.unsigned),De=be.mul(se);be.isZero()&&(be=z),we=we.add(be),Ce=Ce.sub(De)}return we},ie.div=ie.divide,ie.modulo=function(se){return n(se)||(se=g(se)),this.sub(this.div(se).mul(se))},ie.mod=ie.modulo,ie.not=function(){return s(~this.low,~this.high,this.unsigned)},ie.and=function(se){return n(se)||(se=g(se)),s(this.low&se.low,this.high&se.high,this.unsigned)},ie.or=function(se){return n(se)||(se=g(se)),s(this.low|se.low,this.high|se.high,this.unsigned)},ie.xor=function(se){return n(se)||(se=g(se)),s(this.low^se.low,this.high^se.high,this.unsigned)},ie.shiftLeft=function(se){return n(se)&&(se=se.toInt()),(se&=63)===0?this:se<32?s(this.low<<se,this.high<<se|this.low>>>32-se,this.unsigned):s(0,this.low<<se-32,this.unsigned)},ie.shl=ie.shiftLeft,ie.shiftRight=function(se){return n(se)&&(se=se.toInt()),(se&=63)===0?this:se<32?s(this.low>>>se|this.high<<32-se,this.high>>se,this.unsigned):s(this.high>>se-32,this.high>=0?0:-1,this.unsigned)},ie.shr=ie.shiftRight,ie.shiftRightUnsigned=function(se){if(n(se)&&(se=se.toInt()),se&=63,se===0)return this;var me=this.high;if(se<32){var Ce=this.low;return s(Ce>>>se|me<<32-se,me>>>se,this.unsigned)}else return se===32?s(me,0,this.unsigned):s(me>>>se-32,0,this.unsigned)},ie.shru=ie.shiftRightUnsigned,ie.toSigned=function(){return this.unsigned?s(this.low,this.high,!1):this},ie.toUnsigned=function(){return this.unsigned?this:s(this.low,this.high,!0)},ie.toBytes=function(ce){return ce?this.toBytesLE():this.toBytesBE()},ie.toBytesLE=function(){var ce=this.high,se=this.low;return[se&255,se>>>8&255,se>>>16&255,se>>>24&255,ce&255,ce>>>8&255,ce>>>16&255,ce>>>24&255]},ie.toBytesBE=function(){var ce=this.high,se=this.low;return[ce>>>24&255,ce>>>16&255,ce>>>8&255,ce&255,se>>>24&255,se>>>16&255,se>>>8&255,se&255]},e})})(Woe);var d8e=Woe.exports;const dP=_A(d8e),p8e=3,g8e=30,m8e=2*g8e+1,dq=180/Math.PI;function A8e(t,e,n){const r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function pq(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function _8e(t){return[pq(t[0]),pq(t[1])]}function y8e(t,[e,n]){switch(t){case 0:return[1,e,n];case 1:return[-e,1,n];case 2:return[-e,-n,1];case 3:return[-1,-n,-e];case 4:return[n,-1,-e];case 5:return[n,e,-1];default:throw new Error("Invalid face")}}function v8e([t,e,n]){const r=Math.atan2(n,Math.sqrt(t*t+e*e));return[Math.atan2(e,t)*dq,r*dq]}function x8e(t){let e=dP.fromString(t,!0,10).toString(2);for(;e.length<p8e+m8e;)e="0"+e;const n=e.lastIndexOf("1"),r=e.substring(0,3),i=e.substring(3,n),o=i.length/2,a=dP.fromString(r,!0,2).toString(10);let s=dP.fromString(i,!0,2).toString(4);for(;s.length<o;)s="0"+s;return"".concat(a,"/").concat(s)}function b8e(t,e,n,r){if(r===0){n===1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const i=e[0];e[0]=e[1],e[1]=i}}function w8e(t){const e=t.split("/"),n=parseInt(e[0],10),r=e[1],i=r.length,o=[0,0];let a;for(let s=i-1;s>=0;s--){a=i-s;const u=r[s];let d=0,g=0;u==="1"?g=1:u==="2"?(d=1,g=1):u==="3"&&(d=1);const _=Math.pow(2,a-1);b8e(_,o,d,g),o[0]+=_*d,o[1]+=_*g}if(n%2===1){const s=o[0];o[0]=o[1],o[1]=s}return{face:n,ij:o,level:a}}function E8e(t){const e=t.padEnd(16,"0");return dP.fromString(e,16)}const S8e=100;function T8e({face:t,ij:e,level:n}){const r=[[0,0],[0,1],[1,1],[1,0],[0,0]],i=Math.max(1,Math.ceil(S8e*Math.pow(2,-n))),o=new Float64Array(4*i*2+2);let a=0,s=0;for(let u=0;u<4;u++){const d=r[u].slice(0),g=r[u+1],_=(g[0]-d[0])/i,E=(g[1]-d[1])/i;for(let P=0;P<i;P++){d[0]+=_,d[1]+=E;const O=A8e(e,n,d),D=_8e(O),V=y8e(t,D),k=v8e(V);Math.abs(k[1])>89.999&&(k[0]=s);const F=k[0]-s;k[0]+=F>180?-360:F<-180?360:0,o[a++]=k[0],o[a++]=k[1],s=k[0]}}return o[a++]=o[0],o[a++]=o[1],o}function C8e(t){if(typeof t=="string"){if(t.indexOf("/")>0)return t;t=E8e(t)}return x8e(t.toString())}function P8e(t){const e=C8e(t),n=w8e(e);return T8e(n)}const I8e={getS2Token:{type:"accessor",value:t=>t.token}};class uU extends w_{indexToBounds(){const{data:e,getS2Token:n}=this.props;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(r,i)=>P8e(n(r,i))}}}q(uU,"layerName","S2Layer");q(uU,"defaultProps",I8e);const DB=512;function M8e(t,e){let n=0,r=0,i=1<<t.length;const o=i/DB;for(let a=0;a<t.length;a++){i>>=1;const s=parseInt(t[a]);s%2&&(n|=i),s>1&&(r|=i)}return[[n/o,DB-r/o],[(n+e)/o,DB-(r+e)/o]]}function O8e(t,e=1){const[n,r]=M8e(t,e),[i,o]=gc(n),[a,s]=gc(r);return[a,o,a,s,i,s,i,o,a,o]}const R8e={getQuadkey:{type:"accessor",value:t=>t.quadkey}};class cU extends w_{indexToBounds(){const{data:e,extruded:n,getQuadkey:r}=this.props,i=n?.99:1;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(o,a)=>O8e(r(o,a),i),updateTriggers:{getPolygon:i}}}}q(cU,"layerName","QuadkeyLayer");q(cU,"defaultProps",R8e);class qoe{constructor(e){q(this,"index",void 0),q(this,"isVisible",void 0),q(this,"isSelected",void 0),q(this,"parent",void 0),q(this,"children",void 0),q(this,"content",void 0),q(this,"state",void 0),q(this,"layers",void 0),q(this,"id",void 0),q(this,"zoom",void 0),q(this,"userData",void 0),q(this,"boundingBox",void 0),q(this,"_abortController",void 0),q(this,"_loader",void 0),q(this,"_loaderId",void 0),q(this,"_isLoaded",void 0),q(this,"_isCancelled",void 0),q(this,"_needsReload",void 0),q(this,"_bbox",void 0),this.index=e,this.isVisible=!1,this.isSelected=!1,this.parent=null,this.children=[],this.content=null,this._loader=void 0,this._abortController=null,this._loaderId=0,this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1}get bbox(){return this._bbox}set bbox(e){this._bbox||(this._bbox=e,"west"in e?this.boundingBox=[[e.west,e.south],[e.east,e.north]]:this.boundingBox=[[e.left,e.top],[e.right,e.bottom]])}get data(){return this.isLoading&&this._loader?this._loader.then(()=>this.data):this.content}get isLoaded(){return this._isLoaded&&!this._needsReload}get isLoading(){return!!this._loader&&!this._isCancelled}get needsReload(){return this._needsReload||this._isCancelled}get byteLength(){const e=this.content?this.content.byteLength:0;return Number.isFinite(e)||console.error("byteLength not defined in tile data"),e}async _loadData({getData:e,requestScheduler:n,onLoad:r,onError:i}){const{index:o,id:a,bbox:s,userData:u,zoom:d}=this,g=this._loaderId;this._abortController=new AbortController;const{signal:_}=this._abortController,E=await n.scheduleRequest(this,D=>D.isSelected?1:-1);if(!E){this._isCancelled=!0;return}if(this._isCancelled){E.done();return}let P=null,O;try{P=await e({index:o,id:a,bbox:s,userData:u,zoom:d,signal:_})}catch(D){O=D||!0}finally{E.done()}if(g===this._loaderId){if(this._loader=void 0,this.content=P,this._isCancelled&&!P){this._isLoaded=!1;return}this._isLoaded=!0,this._isCancelled=!1,O?i(O,this):r(this)}}loadData(e){return this._isLoaded=!1,this._isCancelled=!1,this._needsReload=!1,this._loaderId++,this._loader=this._loadData(e),this._loader}setNeedsReload(){this.isLoading&&(this.abort(),this._loader=void 0),this._needsReload=!0}abort(){var e;this.isLoaded||(this._isCancelled=!0,(e=this._abortController)===null||e===void 0||e.abort())}}const yl={OUTSIDE:-1,INTERSECTING:0,INSIDE:1},gq=new _t,L8e=new _t;class fU{constructor(e=[0,0,0],n=[0,0,0],r){q(this,"center",void 0),q(this,"halfDiagonal",void 0),q(this,"minimum",void 0),q(this,"maximum",void 0),r=r||gq.copy(e).add(n).scale(.5),this.center=new _t(r),this.halfDiagonal=new _t(n).subtract(this.center),this.minimum=new _t(e),this.maximum=new _t(n)}clone(){return new fU(this.minimum,this.maximum,this.center)}equals(e){return this===e||!!e&&this.minimum.equals(e.minimum)&&this.maximum.equals(e.maximum)}transform(e){return this.center.transformAsPoint(e),this.halfDiagonal.transform(e),this.minimum.transform(e),this.maximum.transform(e),this}intersectPlane(e){const{halfDiagonal:n}=this,r=L8e.from(e.normal),i=n.x*Math.abs(r.x)+n.y*Math.abs(r.y)+n.z*Math.abs(r.z),o=this.center.dot(r)+e.distance;return o-i>0?yl.INSIDE:o+i<0?yl.OUTSIDE:yl.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=gq.from(e).subtract(this.center),{halfDiagonal:r}=this;let i=0,o;return o=Math.abs(n.x)-r.x,o>0&&(i+=o*o),o=Math.abs(n.y)-r.y,o>0&&(i+=o*o),o=Math.abs(n.z)-r.z,o>0&&(i+=o*o),i}}const Tb=new _t,mq=new _t;class h2{constructor(e=[0,0,0],n=0){q(this,"center",void 0),q(this,"radius",void 0),this.radius=-0,this.center=new _t,this.fromCenterRadius(e,n)}fromCenterRadius(e,n){return this.center.from(e),this.radius=n,this}fromCornerPoints(e,n){return n=Tb.from(n),this.center=new _t().from(e).add(n).scale(.5),this.radius=this.center.distance(n),this}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.radius===e.radius}clone(){return new h2(this.center,this.radius)}union(e){const n=this.center,r=this.radius,i=e.center,o=e.radius,a=Tb.copy(i).subtract(n),s=a.magnitude();if(r>=s+o)return this.clone();if(o>=s+r)return e.clone();const u=(r+s+o)*.5;return mq.copy(a).scale((-r+u)/s).add(n),this.center.copy(mq),this.radius=u,this}expand(e){const r=Tb.from(e).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(e){this.center.transform(e);const n=Lbe(Tb,e);return this.radius=Math.max(n[0],Math.max(n[1],n[2]))*this.radius,this}distanceSquaredTo(e){const n=this.distanceTo(e);return n*n}distanceTo(e){const r=Tb.from(e).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(e){const n=this.center,r=this.radius,o=e.normal.dot(n)+e.distance;return o<-r?yl.OUTSIDE:o<r?yl.INTERSECTING:yl.INSIDE}}const D8e=new _t,B8e=new _t,uT=new _t,cT=new _t,fT=new _t,N8e=new _t,F8e=new _t,zp={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class d2{constructor(e=[0,0,0],n=[0,0,0,0,0,0,0,0,0]){q(this,"center",void 0),q(this,"halfAxes",void 0),this.center=new _t().from(e),this.halfAxes=new is(n)}get halfSize(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2);return[new _t(e).len(),new _t(n).len(),new _t(r).len()]}get quaternion(){const e=this.halfAxes.getColumn(0),n=this.halfAxes.getColumn(1),r=this.halfAxes.getColumn(2),i=new _t(e).normalize(),o=new _t(n).normalize(),a=new _t(r).normalize();return new Qm().fromMatrix3(new is([...i,...o,...a]))}fromCenterHalfSizeQuaternion(e,n,r){const i=new Qm(r),o=new is().fromQuaternion(i);return o[0]=o[0]*n[0],o[1]=o[1]*n[0],o[2]=o[2]*n[0],o[3]=o[3]*n[1],o[4]=o[4]*n[1],o[5]=o[5]*n[1],o[6]=o[6]*n[2],o[7]=o[7]*n[2],o[8]=o[8]*n[2],this.center=new _t().from(e),this.halfAxes=o,this}clone(){return new d2(this.center,this.halfAxes)}equals(e){return this===e||!!e&&this.center.equals(e.center)&&this.halfAxes.equals(e.halfAxes)}getBoundingSphere(e=new h2){const n=this.halfAxes,r=n.getColumn(0,uT),i=n.getColumn(1,cT),o=n.getColumn(2,fT),a=D8e.copy(r).add(i).add(o);return e.center.copy(this.center),e.radius=a.magnitude(),e}intersectPlane(e){const n=this.center,r=e.normal,i=this.halfAxes,o=r.x,a=r.y,s=r.z,u=Math.abs(o*i[zp.COLUMN0ROW0]+a*i[zp.COLUMN0ROW1]+s*i[zp.COLUMN0ROW2])+Math.abs(o*i[zp.COLUMN1ROW0]+a*i[zp.COLUMN1ROW1]+s*i[zp.COLUMN1ROW2])+Math.abs(o*i[zp.COLUMN2ROW0]+a*i[zp.COLUMN2ROW1]+s*i[zp.COLUMN2ROW2]),d=r.dot(n)+e.distance;return d<=-u?yl.OUTSIDE:d>=u?yl.INSIDE:yl.INTERSECTING}distanceTo(e){return Math.sqrt(this.distanceSquaredTo(e))}distanceSquaredTo(e){const n=B8e.from(e).subtract(this.center),r=this.halfAxes,i=r.getColumn(0,uT),o=r.getColumn(1,cT),a=r.getColumn(2,fT),s=i.magnitude(),u=o.magnitude(),d=a.magnitude();i.normalize(),o.normalize(),a.normalize();let g=0,_;return _=Math.abs(n.dot(i))-s,_>0&&(g+=_*_),_=Math.abs(n.dot(o))-u,_>0&&(g+=_*_),_=Math.abs(n.dot(a))-d,_>0&&(g+=_*_),g}computePlaneDistances(e,n,r=[-0,-0]){let i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY;const a=this.center,s=this.halfAxes,u=s.getColumn(0,uT),d=s.getColumn(1,cT),g=s.getColumn(2,fT),_=N8e.copy(u).add(d).add(g).add(a),E=F8e.copy(_).subtract(e);let P=n.dot(E);return i=Math.min(P,i),o=Math.max(P,o),_.copy(a).add(u).add(d).subtract(g),E.copy(_).subtract(e),P=n.dot(E),i=Math.min(P,i),o=Math.max(P,o),_.copy(a).add(u).subtract(d).add(g),E.copy(_).subtract(e),P=n.dot(E),i=Math.min(P,i),o=Math.max(P,o),_.copy(a).add(u).subtract(d).subtract(g),E.copy(_).subtract(e),P=n.dot(E),i=Math.min(P,i),o=Math.max(P,o),a.copy(_).subtract(u).add(d).add(g),E.copy(_).subtract(e),P=n.dot(E),i=Math.min(P,i),o=Math.max(P,o),a.copy(_).subtract(u).add(d).subtract(g),E.copy(_).subtract(e),P=n.dot(E),i=Math.min(P,i),o=Math.max(P,o),a.copy(_).subtract(u).subtract(d).add(g),E.copy(_).subtract(e),P=n.dot(E),i=Math.min(P,i),o=Math.max(P,o),a.copy(_).subtract(u).subtract(d).subtract(g),E.copy(_).subtract(e),P=n.dot(E),i=Math.min(P,i),o=Math.max(P,o),r[0]=i,r[1]=o,r}transform(e){this.center.transformAsPoint(e);const n=this.halfAxes.getColumn(0,uT);n.transformAsPoint(e);const r=this.halfAxes.getColumn(1,cT);r.transformAsPoint(e);const i=this.halfAxes.getColumn(2,fT);return i.transformAsPoint(e),this.halfAxes=new is([...n,...r,...i]),this}getTransform(){throw new Error("not implemented")}}const Aq=new _t,_q=new _t;class cf{constructor(e=[0,0,1],n=0){q(this,"normal",void 0),q(this,"distance",void 0),this.normal=new _t,this.distance=-0,this.fromNormalDistance(e,n)}fromNormalDistance(e,n){return ac(Number.isFinite(n)),this.normal.from(e).normalize(),this.distance=n,this}fromPointNormal(e,n){e=Aq.from(e),this.normal.from(n).normalize();const r=-this.normal.dot(e);return this.distance=r,this}fromCoefficients(e,n,r,i){return this.normal.set(e,n,r),ac(Sl(this.normal.len(),1)),this.distance=i,this}clone(){return new cf(this.normal,this.distance)}equals(e){return Sl(this.distance,e.distance)&&Sl(this.normal,e.normal)}getPointDistance(e){return this.normal.dot(e)+this.distance}transform(e){const n=_q.copy(this.normal).transformAsVector(e).normalize(),r=this.normal.scale(-this.distance).transform(e);return this.fromPointNormal(r,n)}projectPointOntoPlane(e,n=[0,0,0]){e=Aq.from(e);const r=this.getPointDistance(e),i=_q.copy(this.normal).scale(r);return e.subtract(i).to(n)}}const yq=[new _t([1,0,0]),new _t([0,1,0]),new _t([0,0,1])],vq=new _t,k8e=new _t;new cf(new _t(1,0,0),0);class cc{constructor(e=[]){q(this,"planes",void 0),this.planes=e}fromBoundingSphere(e){this.planes.length=2*yq.length;const n=e.center,r=e.radius;let i=0;for(const o of yq){let a=this.planes[i],s=this.planes[i+1];a||(a=this.planes[i]=new cf),s||(s=this.planes[i+1]=new cf);const u=vq.copy(o).scale(-r).add(n);-o.dot(u),a.fromPointNormal(u,o);const d=vq.copy(o).scale(r).add(n),g=k8e.copy(o).negate();-g.dot(d),s.fromPointNormal(d,g),i+=2}return this}computeVisibility(e){let n=yl.INSIDE;for(const r of this.planes)switch(e.intersectPlane(r)){case yl.OUTSIDE:return yl.OUTSIDE;case yl.INTERSECTING:n=yl.INTERSECTING;break}return n}computeVisibilityWithPlaneMask(e,n){if(ac(Number.isFinite(n),"parentPlaneMask is required."),n===cc.MASK_OUTSIDE||n===cc.MASK_INSIDE)return n;let r=cc.MASK_INSIDE;const i=this.planes;for(let o=0;o<this.planes.length;++o){const a=o<31?1<<o:0;if(o<31&&!(n&a))continue;const s=i[o],u=e.intersectPlane(s);if(u===yl.OUTSIDE)return cc.MASK_OUTSIDE;u===yl.INTERSECTING&&(r|=a)}return r}}q(cc,"MASK_OUTSIDE",4294967295);q(cc,"MASK_INSIDE",0);q(cc,"MASK_INDETERMINATE",2147483647);new _t;new _t;new _t;new _t;new _t;new _t;new _t;new _t;new _t;new _t;new _t;new _t;new _t;new _t;new _t;new _t;new _t;const vd=new is,z8e=new is,U8e=new is,hT=new is,xq=new is;function G8e(t,e={}){const n=Uv.EPSILON20,r=10;let i=0,o=0;const a=z8e,s=U8e;a.identity(),s.copy(t);const u=n*j8e(s);for(;o<r&&V8e(s)>u;)$8e(s,hT),xq.copy(hT).transpose(),s.multiplyRight(hT),s.multiplyLeft(xq),a.multiplyRight(hT),++i>2&&(++o,i=0);return e.unitary=a.toTarget(e.unitary),e.diagonal=s.toTarget(e.diagonal),e}function j8e(t){let e=0;for(let n=0;n<9;++n){const r=t[n];e+=r*r}return Math.sqrt(e)}const O4=[1,0,0],R4=[2,2,1];function V8e(t){let e=0;for(let n=0;n<3;++n){const r=t[vd.getElementIndex(R4[n],O4[n])];e+=2*r*r}return Math.sqrt(e)}function $8e(t,e){const n=Uv.EPSILON15;let r=0,i=1;for(let d=0;d<3;++d){const g=Math.abs(t[vd.getElementIndex(R4[d],O4[d])]);g>r&&(i=d,r=g)}const o=O4[i],a=R4[i];let s=1,u=0;if(Math.abs(t[vd.getElementIndex(a,o)])>n){const d=t[vd.getElementIndex(a,a)],g=t[vd.getElementIndex(o,o)],_=t[vd.getElementIndex(a,o)],E=(d-g)/2/_;let P;E<0?P=-1/(-E+Math.sqrt(1+E*E)):P=1/(E+Math.sqrt(1+E*E)),s=1/Math.sqrt(1+P*P),u=P*s}return is.IDENTITY.to(e),e[vd.getElementIndex(o,o)]=e[vd.getElementIndex(a,a)]=s,e[vd.getElementIndex(a,o)]=u,e[vd.getElementIndex(o,a)]=-u,e}const gm=new _t,H8e=new _t,W8e=new _t,q8e=new _t,X8e=new _t,Z8e=new is,Y8e={diagonal:new is,unitary:new is};function Xoe(t,e=new d2){if(!t||t.length===0)return e.halfAxes=new is([0,0,0,0,0,0,0,0,0]),e.center=new _t,e;const n=t.length,r=new _t(0,0,0);for(const ie of t)r.add(ie);const i=1/n;r.multiplyByScalar(i);let o=0,a=0,s=0,u=0,d=0,g=0;for(const ie of t){const ce=gm.copy(ie).subtract(r);o+=ce.x*ce.x,a+=ce.x*ce.y,s+=ce.x*ce.z,u+=ce.y*ce.y,d+=ce.y*ce.z,g+=ce.z*ce.z}o*=i,a*=i,s*=i,u*=i,d*=i,g*=i;const _=Z8e;_[0]=o,_[1]=a,_[2]=s,_[3]=a,_[4]=u,_[5]=d,_[6]=s,_[7]=d,_[8]=g;const{unitary:E}=G8e(_,Y8e),P=e.halfAxes.copy(E);let O=P.getColumn(0,W8e),D=P.getColumn(1,q8e),V=P.getColumn(2,X8e),k=-Number.MAX_VALUE,F=-Number.MAX_VALUE,z=-Number.MAX_VALUE,X=Number.MAX_VALUE,Y=Number.MAX_VALUE,J=Number.MAX_VALUE;for(const ie of t)gm.copy(ie),k=Math.max(gm.dot(O),k),F=Math.max(gm.dot(D),F),z=Math.max(gm.dot(V),z),X=Math.min(gm.dot(O),X),Y=Math.min(gm.dot(D),Y),J=Math.min(gm.dot(V),J);O=O.multiplyByScalar(.5*(X+k)),D=D.multiplyByScalar(.5*(Y+F)),V=V.multiplyByScalar(.5*(J+z)),e.center.copy(O).add(D).add(V);const re=H8e.set(k-X,F-Y,z-J).multiplyByScalar(.5),ue=new is([re[0],0,0,0,re[1],0,0,0,re[2]]);return e.halfAxes.multiplyRight(ue),e}const lv=512,bq=3,Zoe=[[.5,.5],[0,0],[0,1],[1,0],[1,1]],Yoe=Zoe.concat([[0,.5],[.5,0],[1,.5],[.5,1]]),Q8e=Yoe.concat([[.25,.5],[.75,.5]]);class uv{constructor(e,n,r){q(this,"x",void 0),q(this,"y",void 0),q(this,"z",void 0),q(this,"childVisible",void 0),q(this,"selected",void 0),q(this,"_children",void 0),this.x=e,this.y=n,this.z=r}get children(){if(!this._children){const e=this.x*2,n=this.y*2,r=this.z+1;this._children=[new uv(e,n,r),new uv(e,n+1,r),new uv(e+1,n,r),new uv(e+1,n+1,r)]}return this._children}update(e){const{viewport:n,cullingVolume:r,elevationBounds:i,minZ:o,maxZ:a,bounds:s,offset:u,project:d}=e,g=this.getBoundingVolume(i,u,d);if(s&&!this.insideBounds(s)||r.computeVisibility(g)<0)return!1;if(!this.childVisible){let{z:E}=this;if(E<a&&E>=o){const P=g.distanceTo(n.cameraPosition)*n.scale/n.height;E+=Math.floor(Math.log2(P))}if(E>=a)return this.selected=!0,!0}this.selected=!1,this.childVisible=!0;for(const E of this.children)E.update(e);return!0}getSelected(e=[]){if(this.selected&&e.push(this),this._children)for(const n of this._children)n.getSelected(e);return e}insideBounds([e,n,r,i]){const o=Math.pow(2,this.z),a=lv/o;return this.x*a<r&&this.y*a<i&&(this.x+1)*a>e&&(this.y+1)*a>n}getBoundingVolume(e,n,r){if(r){const u=this.z<1?Q8e:this.z<2?Yoe:Zoe,d=[];for(const g of u){const _=D4(this.x+g[0],this.y+g[1],this.z);_[2]=e[0],d.push(r(_)),e[0]!==e[1]&&(_[2]=e[1],d.push(r(_)))}return Xoe(d)}const i=Math.pow(2,this.z),o=lv/i,a=this.x*o+n*lv,s=lv-(this.y+1)*o;return new fU([a,s,e[0]],[a+o,s+o,e[1]])}}function K8e(t,e,n,r){const i=t instanceof n6&&t.resolution?t.projectPosition:null,o=Object.values(t.getFrustumPlanes()).map(({normal:P,distance:O})=>new cf(P.clone().negate(),O)),a=new cc(o),s=t.distanceScales.unitsPerMeter[2],u=n&&n[0]*s||0,d=n&&n[1]*s||0,g=t instanceof ug&&t.pitch<=60?e:0;if(r){const[P,O,D,V]=r,k=El([P,V]),F=El([D,O]);r=[k[0],lv-k[1],F[0],lv-F[1]]}const _=new uv(0,0,0),E={viewport:t,project:i,cullingVolume:a,elevationBounds:[u,d],minZ:g,maxZ:e,bounds:r,offset:0};if(_.update(E),t instanceof ug&&t.subViewports&&t.subViewports.length>1){for(E.offset=-1;_.update(E)&&!(--E.offset<-bq););for(E.offset=1;_.update(E)&&!(++E.offset>bq););}return _.getSelected()}const yg=512,J8e=[-1/0,-1/0,1/0,1/0],lM={type:"object",value:null,validate:(t,e)=>e.optional&&t===null||typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string"),equal:(t,e)=>{if(t===e)return!0;if(!Array.isArray(t)||!Array.isArray(e))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}};function Qoe(t,e){const n=[e.transformAsPoint([t[0],t[1]]),e.transformAsPoint([t[2],t[1]]),e.transformAsPoint([t[0],t[3]]),e.transformAsPoint([t[2],t[3]])];return[Math.min(...n.map(i=>i[0])),Math.min(...n.map(i=>i[1])),Math.max(...n.map(i=>i[0])),Math.max(...n.map(i=>i[1]))]}function eGe(t){return Math.abs(t.split("").reduce((e,n)=>(e<<5)-e+n.charCodeAt(0)|0,0))}function mE(t,e){if(!t||!t.length)return null;const{index:n,id:r}=e;if(Array.isArray(t)){const o=eGe(r)%t.length;t=t[o]}let i=t;for(const o of Object.keys(n)){const a=new RegExp("{".concat(o,"}"),"g");i=i.replace(a,String(n[o]))}return Number.isInteger(n.y)&&Number.isInteger(n.z)&&(i=i.replace(/\{-y\}/g,String(Math.pow(2,n.z)-n.y-1))),i}function tGe(t,e,n){let r;if(e&&e.length===2){const[i,o]=e,a=t.getBounds({z:i}),s=t.getBounds({z:o});r=[Math.min(a[0],s[0]),Math.min(a[1],s[1]),Math.max(a[2],s[2]),Math.max(a[3],s[3])]}else r=t.getBounds();return t.isGeospatial?[Math.max(r[0],n[0]),Math.max(r[1],n[1]),Math.min(r[2],n[2]),Math.min(r[3],n[3])]:[Math.max(Math.min(r[0],n[2]),n[0]),Math.max(Math.min(r[1],n[3]),n[1]),Math.min(Math.max(r[2],n[0]),n[2]),Math.min(Math.max(r[3],n[1]),n[3])]}function nGe({viewport:t,z:e=0,cullRect:n}){return(t.subViewports||[t]).map(i=>L4(i,e,n))}function L4(t,e,n){if(!Array.isArray(e)){const o=n.x-t.x,a=n.y-t.y,{width:s,height:u}=n,d={targetZ:e},g=t.unproject([o,a],d),_=t.unproject([o+s,a],d),E=t.unproject([o,a+u],d),P=t.unproject([o+s,a+u],d);return[Math.min(g[0],_[0],E[0],P[0]),Math.min(g[1],_[1],E[1],P[1]),Math.max(g[0],_[0],E[0],P[0]),Math.max(g[1],_[1],E[1],P[1])]}const r=L4(t,e[0],n),i=L4(t,e[1],n);return[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[2],i[2]),Math.max(r[3],i[3])]}function rGe(t,e,n){return n?Qoe(t,n).map(i=>i*e/yg):t.map(r=>r*e/yg)}function hU(t,e){return Math.pow(2,t)*yg/e}function D4(t,e,n){const r=hU(n,yg),i=t/r*360-180,o=Math.PI-2*Math.PI*e/r,a=180/Math.PI*Math.atan(.5*(Math.exp(o)-Math.exp(-o)));return[i,a]}function wq(t,e,n,r){const i=hU(n,r);return[t/i*yg,e/i*yg]}function iGe(t,e,n,r,i=yg){if(t.isGeospatial){const[d,g]=D4(e,n,r),[_,E]=D4(e+1,n+1,r);return{west:d,north:g,east:_,south:E}}const[o,a]=wq(e,n,r,i),[s,u]=wq(e+1,n+1,r,i);return{left:o,top:a,right:s,bottom:u}}function oGe(t,e,n,r,i){const o=tGe(t,null,r),a=hU(e,n),[s,u,d,g]=rGe(o,a,i),_=[];for(let E=Math.floor(s);E<d;E++)for(let P=Math.floor(u);P<g;P++)_.push({x:E,y:P,z:e});return _}function sGe({viewport:t,maxZoom:e,minZoom:n,zRange:r,extent:i,tileSize:o=yg,modelMatrix:a,modelMatrixInverse:s,zoomOffset:u=0}){let d=t.isGeospatial?Math.round(t.zoom+Math.log2(yg/o))+u:Math.ceil(t.zoom)+u;if(typeof n=="number"&&Number.isFinite(n)&&d<n){if(!i)return[];d=n}typeof e=="number"&&Number.isFinite(e)&&d>e&&(d=e);let g=i;return a&&s&&i&&!t.isGeospatial&&(g=Qoe(i,a)),t.isGeospatial?K8e(t,d,r,i):oGe(t,d,o,g||J8e,s)}function aGe(t){return/(?=.*{z})(?=.*{x})(?=.*({y}|{-y}))/.test(t)}function lGe(t){return Number.isFinite(t.west)&&Number.isFinite(t.north)&&Number.isFinite(t.east)&&Number.isFinite(t.south)}function uGe(t){let e={},n;return r=>{for(const i in r)if(!cGe(r[i],e[i])){n=t(r),e=r;break}return n}}function cGe(t,e){if(t===e)return!0;if(Array.isArray(t)){const n=t.length;if(!e||e.length!==n)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}return!1}const Eq=1,fL=2,fGe="never",hGe="no-overlap",dU="best-available",dGe=5,pGe={[dU]:mGe,[hGe]:AGe,[fGe]:()=>{}},gGe={extent:null,tileSize:512,maxZoom:null,minZoom:null,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:"best-available",zRange:null,maxRequests:6,zoomOffset:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{}};class Koe{constructor(e){q(this,"opts",void 0),q(this,"_requestScheduler",void 0),q(this,"_cache",void 0),q(this,"_dirty",void 0),q(this,"_tiles",void 0),q(this,"_cacheByteSize",void 0),q(this,"_viewport",void 0),q(this,"_zRange",void 0),q(this,"_selectedTiles",void 0),q(this,"_frameNumber",void 0),q(this,"_modelMatrix",void 0),q(this,"_modelMatrixInverse",void 0),q(this,"_maxZoom",void 0),q(this,"_minZoom",void 0),q(this,"onTileLoad",void 0),q(this,"_getCullBounds",uGe(nGe)),this.opts={...gGe,...e},this.onTileLoad=n=>{var r,i;(r=(i=this.opts).onTileLoad)===null||r===void 0||r.call(i,n),this.opts.maxCacheByteSize&&(this._cacheByteSize+=n.byteLength,this._resizeCache())},this._requestScheduler=new Ree({maxRequests:e.maxRequests,throttleRequests:!!(e.maxRequests&&e.maxRequests>0)}),this._cache=new Map,this._tiles=[],this._dirty=!1,this._cacheByteSize=0,this._viewport=null,this._selectedTiles=null,this._frameNumber=0,this._modelMatrix=new vr,this._modelMatrixInverse=new vr,this.setOptions(e)}get tiles(){return this._tiles}get selectedTiles(){return this._selectedTiles}get isLoaded(){return this._selectedTiles!==null&&this._selectedTiles.every(e=>e.isLoaded)}get needsReload(){return this._selectedTiles!==null&&this._selectedTiles.some(e=>e.needsReload)}setOptions(e){Object.assign(this.opts,e),Number.isFinite(e.maxZoom)&&(this._maxZoom=Math.floor(e.maxZoom)),Number.isFinite(e.minZoom)&&(this._minZoom=Math.ceil(e.minZoom))}finalize(){for(const e of this._cache.values())e.isLoading&&e.abort();this._cache.clear(),this._tiles=[],this._selectedTiles=null}reloadAll(){for(const e of this._cache.keys()){const n=this._cache.get(e);!this._selectedTiles||!this._selectedTiles.includes(n)?this._cache.delete(e):n.setNeedsReload()}}update(e,{zRange:n,modelMatrix:r}={}){const i=new vr(r),o=!i.equals(this._modelMatrix);if(!this._viewport||!e.equals(this._viewport)||!Sl(this._zRange,n)||o){o&&(this._modelMatrixInverse=i.clone().invert(),this._modelMatrix=i),this._viewport=e,this._zRange=n;const s=this.getTileIndices({viewport:e,maxZoom:this._maxZoom,minZoom:this._minZoom,zRange:n,modelMatrix:this._modelMatrix,modelMatrixInverse:this._modelMatrixInverse});this._selectedTiles=s.map(u=>this._getTile(u,!0)),this._dirty&&this._rebuildTree()}else this.needsReload&&(this._selectedTiles=this._selectedTiles.map(s=>this._getTile(s.index,!0)));const a=this.updateTileStates();return this._pruneRequests(),this._dirty&&this._resizeCache(),a&&this._frameNumber++,this._frameNumber}isTileVisible(e,n){if(!e.isVisible)return!1;if(n&&this._viewport){const r=this._getCullBounds({viewport:this._viewport,z:this._zRange,cullRect:n}),{bbox:i}=e;for(const[o,a,s,u]of r){let d;if("west"in i)d=i.west<s&&i.east>o&&i.south<u&&i.north>a;else{const g=Math.min(i.top,i.bottom),_=Math.max(i.top,i.bottom);d=i.left<s&&i.right>o&&g<u&&_>a}if(d)return!0}return!1}return!0}getTileIndices({viewport:e,maxZoom:n,minZoom:r,zRange:i,modelMatrix:o,modelMatrixInverse:a}){const{tileSize:s,extent:u,zoomOffset:d}=this.opts;return sGe({viewport:e,maxZoom:n,minZoom:r,zRange:i,tileSize:s,extent:u,modelMatrix:o,modelMatrixInverse:a,zoomOffset:d})}getTileId(e){return"".concat(e.x,"-").concat(e.y,"-").concat(e.z)}getTileZoom(e){return e.z}getTileMetadata(e){const{tileSize:n}=this.opts;return{bbox:iGe(this._viewport,e.x,e.y,e.z,n)}}getParentIndex(e){const n=Math.floor(e.x/2),r=Math.floor(e.y/2),i=e.z-1;return{x:n,y:r,z:i}}updateTileStates(){const e=this.opts.refinementStrategy||dU,n=new Array(this._cache.size);let r=0;for(const i of this._cache.values())n[r++]=i.isVisible,i.isSelected=!1,i.isVisible=!1;for(const i of this._selectedTiles)i.isSelected=!0,i.isVisible=!0;(typeof e=="function"?e:pGe[e])(Array.from(this._cache.values())),r=0;for(const i of this._cache.values())if(n[r++]!==i.isVisible)return!0;return!1}_pruneRequests(){const{maxRequests:e=0}=this.opts,n=[];let r=0;for(const i of this._cache.values())i.isLoading&&(r++,!i.isSelected&&!i.isVisible&&n.push(i));for(;e>0&&r>e&&n.length>0;)n.shift().abort(),r--}_rebuildTree(){const{_cache:e}=this;for(const n of e.values())n.parent=null,n.children&&(n.children.length=0);for(const n of e.values()){const r=this._getNearestAncestor(n);n.parent=r,r!=null&&r.children&&r.children.push(n)}}_resizeCache(){const{_cache:e,opts:n}=this,r=n.maxCacheSize||(n.maxCacheByteSize?1/0:dGe*this.selectedTiles.length),i=n.maxCacheByteSize||1/0;if(e.size>r||this._cacheByteSize>i){for(const[u,d]of e){if(!d.isVisible&&!d.isSelected){var a,s;this._cacheByteSize-=n.maxCacheByteSize?d.byteLength:0,e.delete(u),(a=(s=this.opts).onTileUnload)===null||a===void 0||a.call(s,d)}if(e.size<=r&&this._cacheByteSize<=i)break}this._rebuildTree(),this._dirty=!0}this._dirty&&(this._tiles=Array.from(this._cache.values()).sort((u,d)=>u.zoom-d.zoom),this._dirty=!1)}_getTile(e,n){const r=this.getTileId(e);let i=this._cache.get(r),o=!1;return!i&&n?(i=new qoe(e),Object.assign(i,this.getTileMetadata(i.index)),Object.assign(i,{id:r,zoom:this.getTileZoom(i.index)}),o=!0,this._cache.set(r,i),this._dirty=!0):i&&i.needsReload&&(o=!0),i&&o&&i.loadData({getData:this.opts.getTileData,requestScheduler:this._requestScheduler,onLoad:this.onTileLoad,onError:this.opts.onTileError}),i}_getNearestAncestor(e){const{_minZoom:n=0}=this;let r=e.index;for(;this.getTileZoom(r)>n;){r=this.getParentIndex(r);const i=this._getTile(r);if(i)return i}return null}}function mGe(t){for(const e of t)e.state=0;for(const e of t)e.isSelected&&!Joe(e)&&pU(e);for(const e of t)e.isVisible=!!(e.state&fL)}function AGe(t){for(const n of t)n.state=0;for(const n of t)n.isSelected&&Joe(n);const e=Array.from(t).sort((n,r)=>n.zoom-r.zoom);for(const n of e)if(n.isVisible=!!(n.state&fL),n.children&&(n.isVisible||n.state&Eq))for(const r of n.children)r.state=Eq;else n.isSelected&&pU(n)}function Joe(t){let e=t;for(;e;){if(e.isLoaded||e.content)return e.state|=fL,!0;e=e.parent}return!1}function pU(t){for(const e of t.children)e.isLoaded||e.content?e.state|=fL:pU(e)}const _Ge={TilesetClass:Koe,data:{type:"data",value:[]},dataComparator:lM.equal,renderSubLayers:{type:"function",value:t=>new q1(t)},getTileData:{type:"function",optional:!0,value:null},onViewportLoad:{type:"function",optional:!0,value:null},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:t=>console.error(t)},extent:{type:"array",optional:!0,value:null,compare:!0},tileSize:512,maxZoom:null,minZoom:0,maxCacheSize:null,maxCacheByteSize:null,refinementStrategy:dU,zRange:null,maxRequests:6,zoomOffset:0};class X1 extends Uh{initializeState(){this.state={tileset:null,isLoaded:!1}}finalizeState(){var e,n;(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||n.finalize()}get isLoaded(){var e,n,r;return(e=this.state)===null||e===void 0||(n=e.tileset)===null||n===void 0||(r=n.selectedTiles)===null||r===void 0?void 0:r.every(i=>i.isLoaded&&i.layers&&i.layers.every(o=>o.isLoaded))}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({changeFlags:e}){let{tileset:n}=this.state;const r=e.propsOrDataChanged||e.updateTriggersChanged,i=e.dataChanged||e.updateTriggersChanged&&(e.updateTriggersChanged.all||e.updateTriggersChanged.getTileData);n?r&&(n.setOptions(this._getTilesetOptions()),i?n.reloadAll():this.state.tileset.tiles.forEach(o=>{o.layers=null})):(n=new this.props.TilesetClass(this._getTilesetOptions()),this.setState({tileset:n})),this._updateTileset()}_getTilesetOptions(){const{tileSize:e,maxCacheSize:n,maxCacheByteSize:r,refinementStrategy:i,extent:o,maxZoom:a,minZoom:s,maxRequests:u,zoomOffset:d}=this.props;return{maxCacheSize:n,maxCacheByteSize:r,maxZoom:a,minZoom:s,tileSize:e,refinementStrategy:i,extent:o,maxRequests:u,zoomOffset:d,getTileData:this.getTileData.bind(this),onTileLoad:this._onTileLoad.bind(this),onTileError:this._onTileError.bind(this),onTileUnload:this._onTileUnload.bind(this)}}_updateTileset(){const{tileset:e}=this.state,{zRange:n,modelMatrix:r}=this.props,i=e.update(this.context.viewport,{zRange:n,modelMatrix:r}),{isLoaded:o}=e,a=this.state.isLoaded!==o,s=this.state.frameNumber!==i;o&&(a||s)&&this._onViewportLoad(),s&&this.setState({frameNumber:i}),this.state.isLoaded=o}_onViewportLoad(){const{tileset:e}=this.state,{onViewportLoad:n}=this.props;n&&n(e.selectedTiles)}_onTileLoad(e){this.props.onTileLoad(e),e.layers=null,this.setNeedsUpdate()}_onTileError(e,n){this.props.onTileError(e),n.layers=null,this.setNeedsUpdate()}_onTileUnload(e){this.props.onTileUnload(e)}getTileData(e){const{data:n,getTileData:r,fetch:i}=this.props,{signal:o}=e;return e.url=typeof n=="string"||Array.isArray(n)?mE(n,e):null,r?r(e):i&&e.url?i(e.url,{propName:"data",layer:this,signal:o}):null}renderSubLayers(e){return this.props.renderSubLayers(e)}getSubLayerPropsByTile(e){return null}getPickingInfo({info:e,sourceLayer:n}){const r=n.props.tile;return e.picked&&(e.tile=r),e.sourceTile=r,e}_updateAutoHighlight(e){const n=e.sourceTile;if(n&&n.layers)for(const r of n.layers)r.updateAutoHighlight(e)}renderLayers(){return this.state.tileset.tiles.map(e=>{const n=this.getSubLayerPropsByTile(e);if(!(!e.isLoaded&&!e.content))if(e.layers)n&&e.layers[0]&&Object.keys(n).some(r=>e.layers[0].props[r]!==n[r])&&(e.layers=e.layers.map(r=>r.clone(n)));else{const r=this.renderSubLayers({...this.props,...this.getSubLayerProps({id:e.id,updateTriggers:this.props.updateTriggers}),data:e.content,_offset:0,tile:e});e.layers=GE(r,Boolean).map(i=>i.clone({tile:e,...n}))}return e.layers})}filterSubLayer({layer:e,cullRect:n}){const{tile:r}=e.props;return this.state.tileset.isTileVisible(r,n)}}q(X1,"defaultProps",_Ge);q(X1,"layerName","TileLayer");const yGe={fadeTrail:!0,trailLength:{type:"number",value:120,min:0},currentTime:{type:"number",value:0,min:0},getTimestamps:{type:"accessor",value:t=>t.timestamps}};class gU extends W1{getShaders(){const e=super.getShaders();return e.inject={"vs:#decl":`uniform float trailLength;
attribute float instanceTimestamps;
attribute float instanceNextTimestamps;
varying float vTime;
`,"vs:#main-end":`vTime = instanceTimestamps + (instanceNextTimestamps - instanceTimestamps) * vPathPosition.y / vPathLength;
`,"fs:#decl":`uniform bool fadeTrail;
uniform float trailLength;
uniform float currentTime;
varying float vTime;
`,"fs:#main-start":`if(vTime > currentTime || (fadeTrail && (vTime < currentTime - trailLength))) {
  discard;
}
`,"fs:DECKGL_FILTER_COLOR":`if(fadeTrail) {
  color.a *= 1.0 - (currentTime - vTime) / trailLength;
}
`},e}initializeState(){super.initializeState(),this.getAttributeManager().addInstanced({timestamps:{size:1,accessor:"getTimestamps",shaderAttributes:{instanceTimestamps:{vertexOffset:0},instanceNextTimestamps:{vertexOffset:1}}}})}draw(e){const{fadeTrail:n,trailLength:r,currentTime:i}=this.props;e.uniforms={...e.uniforms,fadeTrail:n,trailLength:r,currentTime:i},super.draw(e)}}q(gU,"layerName","TripsLayer");q(gU,"defaultProps",yGe);var mn=function(t){t=t||{};var e=typeof t<"u"?t:{},n={},r;for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);var i="";function o(ot){return e.locateFile?e.locateFile(ot,i):i+ot}var a;document.currentScript&&(i=document.currentScript.src),i.indexOf("blob:")!==0?i=i.substr(0,i.lastIndexOf("/")+1):i="",a=function(Pt,rn,Gn){var w=new XMLHttpRequest;w.open("GET",Pt,!0),w.responseType="arraybuffer",w.onload=function(){if(w.status==200||w.status==0&&w.response){rn(w.response);return}var Ir=ge(Pt);if(Ir){rn(Ir.buffer);return}Gn()},w.onerror=Gn,w.send(null)};var s=e.print||console.log.bind(console),u=e.printErr||console.warn.bind(console);for(r in n)n.hasOwnProperty(r)&&(e[r]=n[r]);n=null,e.arguments&&e.arguments;var d=0,g=function(ot){d=ot},_=function(){return d},E=8;function P(ot,Pt,rn,Gn){switch(rn=rn||"i8",rn.charAt(rn.length-1)==="*"&&(rn="i32"),rn){case"i1":me[ot>>0]=Pt;break;case"i8":me[ot>>0]=Pt;break;case"i16":we[ot>>1]=Pt;break;case"i32":Ye[ot>>2]=Pt;break;case"i64":Fa=[Pt>>>0,(Do=Pt,+It(Do)>=1?Do>0?(cn(+$t(Do/4294967296),4294967295)|0)>>>0:~~+Xt((Do-+(~~Do>>>0))/4294967296)>>>0:0)],Ye[ot>>2]=Fa[0],Ye[ot+4>>2]=Fa[1];break;case"float":at[ot>>2]=Pt;break;case"double":yt[ot>>3]=Pt;break;default:tr("invalid type for setValue: "+rn)}}function O(ot,Pt,rn){switch(Pt=Pt||"i8",Pt.charAt(Pt.length-1)==="*"&&(Pt="i32"),Pt){case"i1":return me[ot>>0];case"i8":return me[ot>>0];case"i16":return we[ot>>1];case"i32":return Ye[ot>>2];case"i64":return Ye[ot>>2];case"float":return at[ot>>2];case"double":return yt[ot>>3];default:tr("invalid type for getValue: "+Pt)}return null}var D=!1;function V(ot,Pt){ot||tr("Assertion failed: "+Pt)}function k(ot){var Pt=e["_"+ot];return V(Pt,"Cannot call unknown function "+ot+", make sure it is exported"),Pt}function F(ot,Pt,rn,Gn,w){var Ue={string:function(ro){var ca=0;if(ro!=null&&ro!==0){var kc=(ro.length<<2)+1;ca=ht(kc),ue(ro,ca,kc)}return ca},array:function(ro){var ca=ht(ro.length);return ie(ro,ca),ca}};function Ir(ro){return Pt==="string"?J(ro):Pt==="boolean"?!!ro:ro}var fr=k(ot),rr=[],Tr=0;if(Gn)for(var qi=0;qi<Gn.length;qi++){var qr=Ue[rn[qi]];qr?(Tr===0&&(Tr=nt()),rr[qi]=qr(Gn[qi])):rr[qi]=Gn[qi]}var jn=fr.apply(null,rr);return jn=Ir(jn),Tr!==0&&ft(Tr),jn}function z(ot,Pt,rn,Gn){rn=rn||[];var w=rn.every(function(Ir){return Ir==="number"}),Ue=Pt!=="string";return Ue&&w&&!Gn?k(ot):function(){return F(ot,Pt,rn,arguments)}}var X=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0;function Y(ot,Pt,rn){for(var Gn=Pt+rn,w=Pt;ot[w]&&!(w>=Gn);)++w;if(w-Pt>16&&ot.subarray&&X)return X.decode(ot.subarray(Pt,w));for(var Ue="";Pt<w;){var Ir=ot[Pt++];if(!(Ir&128)){Ue+=String.fromCharCode(Ir);continue}var fr=ot[Pt++]&63;if((Ir&224)==192){Ue+=String.fromCharCode((Ir&31)<<6|fr);continue}var rr=ot[Pt++]&63;if((Ir&240)==224?Ir=(Ir&15)<<12|fr<<6|rr:Ir=(Ir&7)<<18|fr<<12|rr<<6|ot[Pt++]&63,Ir<65536)Ue+=String.fromCharCode(Ir);else{var Tr=Ir-65536;Ue+=String.fromCharCode(55296|Tr>>10,56320|Tr&1023)}}return Ue}function J(ot,Pt){return ot?Y(Ce,ot,Pt):""}function re(ot,Pt,rn,Gn){if(!(Gn>0))return 0;for(var w=rn,Ue=rn+Gn-1,Ir=0;Ir<ot.length;++Ir){var fr=ot.charCodeAt(Ir);if(fr>=55296&&fr<=57343){var rr=ot.charCodeAt(++Ir);fr=65536+((fr&1023)<<10)|rr&1023}if(fr<=127){if(rn>=Ue)break;Pt[rn++]=fr}else if(fr<=2047){if(rn+1>=Ue)break;Pt[rn++]=192|fr>>6,Pt[rn++]=128|fr&63}else if(fr<=65535){if(rn+2>=Ue)break;Pt[rn++]=224|fr>>12,Pt[rn++]=128|fr>>6&63,Pt[rn++]=128|fr&63}else{if(rn+3>=Ue)break;Pt[rn++]=240|fr>>18,Pt[rn++]=128|fr>>12&63,Pt[rn++]=128|fr>>6&63,Pt[rn++]=128|fr&63}}return Pt[rn]=0,rn-w}function ue(ot,Pt,rn){return re(ot,Ce,Pt,rn)}typeof TextDecoder<"u"&&new TextDecoder("utf-16le");function ie(ot,Pt){me.set(ot,Pt)}function ce(ot,Pt){return ot%Pt>0&&(ot+=Pt-ot%Pt),ot}var se,me,Ce,we,Ye,at,yt;function be(ot){se=ot,e.HEAP8=me=new Int8Array(ot),e.HEAP16=we=new Int16Array(ot),e.HEAP32=Ye=new Int32Array(ot),e.HEAPU8=Ce=new Uint8Array(ot),e.HEAPU16=new Uint16Array(ot),e.HEAPU32=new Uint32Array(ot),e.HEAPF32=at=new Float32Array(ot),e.HEAPF64=yt=new Float64Array(ot)}var De=5266928,Re=24016,qe=e.TOTAL_MEMORY||33554432;e.buffer?se=e.buffer:se=new ArrayBuffer(qe),qe=se.byteLength,be(se),Ye[Re>>2]=De;function ct(ot){for(;ot.length>0;){var Pt=ot.shift();if(typeof Pt=="function"){Pt();continue}var rn=Pt.func;typeof rn=="number"?Pt.arg===void 0?e.dynCall_v(rn):e.dynCall_vi(rn,Pt.arg):rn(Pt.arg===void 0?null:Pt.arg)}}var Ct=[],Dt=[],In=[],Mn=[];function Tn(){if(e.preRun)for(typeof e.preRun=="function"&&(e.preRun=[e.preRun]);e.preRun.length;)hn(e.preRun.shift());ct(Ct)}function Nt(){ct(Dt)}function Zt(){ct(In)}function Wt(){if(e.postRun)for(typeof e.postRun=="function"&&(e.postRun=[e.postRun]);e.postRun.length;)lr(e.postRun.shift());ct(Mn)}function hn(ot){Ct.unshift(ot)}function lr(ot){Mn.unshift(ot)}var It=Math.abs,Xt=Math.ceil,$t=Math.floor,cn=Math.min,Jt=0,Ln=null;function qn(ot){Jt++,e.monitorRunDependencies&&e.monitorRunDependencies(Jt)}function or(ot){if(Jt--,e.monitorRunDependencies&&e.monitorRunDependencies(Jt),Jt==0&&Ln){var Pt=Ln;Ln=null,Pt()}}e.preloadedImages={},e.preloadedAudios={};var cr=null,cs="data:application/octet-stream;base64,";function Ri(ot){return String.prototype.startsWith?ot.startsWith(cs):ot.indexOf(cs)===0}var Do,Fa;cr="data:application/octet-stream;base64,AAAAAAAAAAACAAAAAwAAAAEAAAAFAAAABAAAAAYAAAAAAAAAAAAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAYAAAABAAAABAAAAAMAAAAGAAAABQAAAAIAAAAAAAAAAgAAAAMAAAABAAAABAAAAAYAAAAAAAAABQAAAAMAAAAGAAAABAAAAAUAAAAAAAAAAQAAAAIAAAAEAAAABQAAAAYAAAAAAAAAAgAAAAMAAAABAAAABQAAAAIAAAAAAAAAAQAAAAMAAAAGAAAABAAAAAYAAAAAAAAABQAAAAIAAAABAAAABAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAgAAAAMAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAABgAAAAAAAAAFAAAAAAAAAAAAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAABgAAAAAAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAEAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAACAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAwAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAQAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAFAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABgAAAAAAAAABAAAAAgAAAAMAAAAEAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAAAAAAABgAAAAAAAAADAAAAAgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAUAAAAEAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAEAAAAAAAAAAYAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAUAAAACAAAABAAAAAMAAAAIAAAAAQAAAAcAAAAGAAAACQAAAAAAAAADAAAAAgAAAAIAAAAGAAAACgAAAAsAAAAAAAAAAQAAAAUAAAADAAAADQAAAAEAAAAHAAAABAAAAAwAAAAAAAAABAAAAH8AAAAPAAAACAAAAAMAAAAAAAAADAAAAAUAAAACAAAAEgAAAAoAAAAIAAAAAAAAABAAAAAGAAAADgAAAAsAAAARAAAAAQAAAAkAAAACAAAABwAAABUAAAAJAAAAEwAAAAMAAAANAAAAAQAAAAgAAAAFAAAAFgAAABAAAAAEAAAAAAAAAA8AAAAJAAAAEwAAAA4AAAAUAAAAAQAAAAcAAAAGAAAACgAAAAsAAAAYAAAAFwAAAAUAAAACAAAAEgAAAAsAAAARAAAAFwAAABkAAAACAAAABgAAAAoAAAAMAAAAHAAAAA0AAAAaAAAABAAAAA8AAAADAAAADQAAABoAAAAVAAAAHQAAAAMAAAAMAAAABwAAAA4AAAB/AAAAEQAAABsAAAAJAAAAFAAAAAYAAAAPAAAAFgAAABwAAAAfAAAABAAAAAgAAAAMAAAAEAAAABIAAAAhAAAAHgAAAAgAAAAFAAAAFgAAABEAAAALAAAADgAAAAYAAAAjAAAAGQAAABsAAAASAAAAGAAAAB4AAAAgAAAABQAAAAoAAAAQAAAAEwAAACIAAAAUAAAAJAAAAAcAAAAVAAAACQAAABQAAAAOAAAAEwAAAAkAAAAoAAAAGwAAACQAAAAVAAAAJgAAABMAAAAiAAAADQAAAB0AAAAHAAAAFgAAABAAAAApAAAAIQAAAA8AAAAIAAAAHwAAABcAAAAYAAAACwAAAAoAAAAnAAAAJQAAABkAAAAYAAAAfwAAACAAAAAlAAAACgAAABcAAAASAAAAGQAAABcAAAARAAAACwAAAC0AAAAnAAAAIwAAABoAAAAqAAAAHQAAACsAAAAMAAAAHAAAAA0AAAAbAAAAKAAAACMAAAAuAAAADgAAABQAAAARAAAAHAAAAB8AAAAqAAAALAAAAAwAAAAPAAAAGgAAAB0AAAArAAAAJgAAAC8AAAANAAAAGgAAABUAAAAeAAAAIAAAADAAAAAyAAAAEAAAABIAAAAhAAAAHwAAACkAAAAsAAAANQAAAA8AAAAWAAAAHAAAACAAAAAeAAAAGAAAABIAAAA0AAAAMgAAACUAAAAhAAAAHgAAADEAAAAwAAAAFgAAABAAAAApAAAAIgAAABMAAAAmAAAAFQAAADYAAAAkAAAAMwAAACMAAAAuAAAALQAAADgAAAARAAAAGwAAABkAAAAkAAAAFAAAACIAAAATAAAANwAAACgAAAA2AAAAJQAAACcAAAA0AAAAOQAAABgAAAAXAAAAIAAAACYAAAB/AAAAIgAAADMAAAAdAAAALwAAABUAAAAnAAAAJQAAABkAAAAXAAAAOwAAADkAAAAtAAAAKAAAABsAAAAkAAAAFAAAADwAAAAuAAAANwAAACkAAAAxAAAANQAAAD0AAAAWAAAAIQAAAB8AAAAqAAAAOgAAACsAAAA+AAAAHAAAACwAAAAaAAAAKwAAAD4AAAAvAAAAQAAAABoAAAAqAAAAHQAAACwAAAA1AAAAOgAAAEEAAAAcAAAAHwAAACoAAAAtAAAAJwAAACMAAAAZAAAAPwAAADsAAAA4AAAALgAAADwAAAA4AAAARAAAABsAAAAoAAAAIwAAAC8AAAAmAAAAKwAAAB0AAABFAAAAMwAAAEAAAAAwAAAAMQAAAB4AAAAhAAAAQwAAAEIAAAAyAAAAMQAAAH8AAAA9AAAAQgAAACEAAAAwAAAAKQAAADIAAAAwAAAAIAAAAB4AAABGAAAAQwAAADQAAAAzAAAARQAAADYAAABHAAAAJgAAAC8AAAAiAAAANAAAADkAAABGAAAASgAAACAAAAAlAAAAMgAAADUAAAA9AAAAQQAAAEsAAAAfAAAAKQAAACwAAAA2AAAARwAAADcAAABJAAAAIgAAADMAAAAkAAAANwAAACgAAAA2AAAAJAAAAEgAAAA8AAAASQAAADgAAABEAAAAPwAAAE0AAAAjAAAALgAAAC0AAAA5AAAAOwAAAEoAAABOAAAAJQAAACcAAAA0AAAAOgAAAH8AAAA+AAAATAAAACwAAABBAAAAKgAAADsAAAA/AAAATgAAAE8AAAAnAAAALQAAADkAAAA8AAAASAAAAEQAAABQAAAAKAAAADcAAAAuAAAAPQAAADUAAAAxAAAAKQAAAFEAAABLAAAAQgAAAD4AAAArAAAAOgAAACoAAABSAAAAQAAAAEwAAAA/AAAAfwAAADgAAAAtAAAATwAAADsAAABNAAAAQAAAAC8AAAA+AAAAKwAAAFQAAABFAAAAUgAAAEEAAAA6AAAANQAAACwAAABWAAAATAAAAEsAAABCAAAAQwAAAFEAAABVAAAAMQAAADAAAAA9AAAAQwAAAEIAAAAyAAAAMAAAAFcAAABVAAAARgAAAEQAAAA4AAAAPAAAAC4AAABaAAAATQAAAFAAAABFAAAAMwAAAEAAAAAvAAAAWQAAAEcAAABUAAAARgAAAEMAAAA0AAAAMgAAAFMAAABXAAAASgAAAEcAAABZAAAASQAAAFsAAAAzAAAARQAAADYAAABIAAAAfwAAAEkAAAA3AAAAUAAAADwAAABYAAAASQAAAFsAAABIAAAAWAAAADYAAABHAAAANwAAAEoAAABOAAAAUwAAAFwAAAA0AAAAOQAAAEYAAABLAAAAQQAAAD0AAAA1AAAAXgAAAFYAAABRAAAATAAAAFYAAABSAAAAYAAAADoAAABBAAAAPgAAAE0AAAA/AAAARAAAADgAAABdAAAATwAAAFoAAABOAAAASgAAADsAAAA5AAAAXwAAAFwAAABPAAAATwAAAE4AAAA/AAAAOwAAAF0AAABfAAAATQAAAFAAAABEAAAASAAAADwAAABjAAAAWgAAAFgAAABRAAAAVQAAAF4AAABlAAAAPQAAAEIAAABLAAAAUgAAAGAAAABUAAAAYgAAAD4AAABMAAAAQAAAAFMAAAB/AAAASgAAAEYAAABkAAAAVwAAAFwAAABUAAAARQAAAFIAAABAAAAAYQAAAFkAAABiAAAAVQAAAFcAAABlAAAAZgAAAEIAAABDAAAAUQAAAFYAAABMAAAASwAAAEEAAABoAAAAYAAAAF4AAABXAAAAUwAAAGYAAABkAAAAQwAAAEYAAABVAAAAWAAAAEgAAABbAAAASQAAAGMAAABQAAAAaQAAAFkAAABhAAAAWwAAAGcAAABFAAAAVAAAAEcAAABaAAAATQAAAFAAAABEAAAAagAAAF0AAABjAAAAWwAAAEkAAABZAAAARwAAAGkAAABYAAAAZwAAAFwAAABTAAAATgAAAEoAAABsAAAAZAAAAF8AAABdAAAATwAAAFoAAABNAAAAbQAAAF8AAABqAAAAXgAAAFYAAABRAAAASwAAAGsAAABoAAAAZQAAAF8AAABcAAAATwAAAE4AAABtAAAAbAAAAF0AAABgAAAAaAAAAGIAAABuAAAATAAAAFYAAABSAAAAYQAAAH8AAABiAAAAVAAAAGcAAABZAAAAbwAAAGIAAABuAAAAYQAAAG8AAABSAAAAYAAAAFQAAABjAAAAUAAAAGkAAABYAAAAagAAAFoAAABxAAAAZAAAAGYAAABTAAAAVwAAAGwAAAByAAAAXAAAAGUAAABmAAAAawAAAHAAAABRAAAAVQAAAF4AAABmAAAAZQAAAFcAAABVAAAAcgAAAHAAAABkAAAAZwAAAFsAAABhAAAAWQAAAHQAAABpAAAAbwAAAGgAAABrAAAAbgAAAHMAAABWAAAAXgAAAGAAAABpAAAAWAAAAGcAAABbAAAAcQAAAGMAAAB0AAAAagAAAF0AAABjAAAAWgAAAHUAAABtAAAAcQAAAGsAAAB/AAAAZQAAAF4AAABzAAAAaAAAAHAAAABsAAAAZAAAAF8AAABcAAAAdgAAAHIAAABtAAAAbQAAAGwAAABdAAAAXwAAAHUAAAB2AAAAagAAAG4AAABiAAAAaAAAAGAAAAB3AAAAbwAAAHMAAABvAAAAYQAAAG4AAABiAAAAdAAAAGcAAAB3AAAAcAAAAGsAAABmAAAAZQAAAHgAAABzAAAAcgAAAHEAAABjAAAAdAAAAGkAAAB1AAAAagAAAHkAAAByAAAAcAAAAGQAAABmAAAAdgAAAHgAAABsAAAAcwAAAG4AAABrAAAAaAAAAHgAAAB3AAAAcAAAAHQAAABnAAAAdwAAAG8AAABxAAAAaQAAAHkAAAB1AAAAfwAAAG0AAAB2AAAAcQAAAHkAAABqAAAAdgAAAHgAAABsAAAAcgAAAHUAAAB5AAAAbQAAAHcAAABvAAAAcwAAAG4AAAB5AAAAdAAAAHgAAAB4AAAAcwAAAHIAAABwAAAAeQAAAHcAAAB2AAAAeQAAAHQAAAB4AAAAdwAAAHUAAABxAAAAdgAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAIAAAAFAAAAAQAAAAAAAAD/////AQAAAAAAAAADAAAABAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAUAAAABAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAFAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAQAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAABAAAAAwAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAADAAAABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAUAAAAFAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAADAAAAAAAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAAAAAADAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAwAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAAAAAP////8DAAAAAAAAAAUAAAACAAAAAAAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAADAAAAAQAAAAAAAAABAAAAAAAAAAAAAAADAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAMAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAMAAAADAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAADAAAAAAAAAAAAAAD/////AwAAAAAAAAAFAAAAAgAAAAAAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAADAAAAAAAAAAMAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAAAAAADAAAABQAAAAEAAAAAAAAA/////wMAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAEAAAABQAAAAEAAAAAAAAAAwAAAAMAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAgAAAAUAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAMAAAABAAAAAAAAAAEAAAAAAAAABQAAAAAAAAAAAAAABQAAAAUAAAAAAAAAAAAAAP////8BAAAAAAAAAAMAAAAEAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAAAAAAAAAAAAAUAAAAFAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAABQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAQAAAP//////////AQAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAIAAAAAAAAAAAAAAAEAAAACAAAABgAAAAQAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAoAAAACAAAAAAAAAAAAAAABAAAAAQAAAAUAAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAEAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAIAAAAAAAAAAAAAAAEAAAADAAAABwAAAAYAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAMAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAAAAAAAAAAAAQAAAAAAAAAJAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAwAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAgAAAAAAAAAAAAAAAQAAAAQAAAAIAAAACgAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAsAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAACAAAAAAAAAAAAAAABAAAACwAAAA8AAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAgAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAACAAAAAAAAAAAAAAABAAAADAAAABAAAAAMAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA8AAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAANAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAIAAAAAAAAAAAAAAAEAAAAKAAAAEwAAAAgAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAADAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAABAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAJAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAAgAAAAAAAAAAAAAAAQAAAA0AAAARAAAADQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAARAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAAAAAAAAAAAAAEAAAAOAAAAEgAAAA8AAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAPAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAABAAAAAQAAAAAAAAAAAAAAAAAAABIAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAEQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAABMAAAACAAAAAAAAAAAAAAABAAAA//////////8TAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAASAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAABIAAAAAAAAAGAAAAAAAAAAhAAAAAAAAAB4AAAAAAAAAIAAAAAMAAAAxAAAAAQAAADAAAAADAAAAMgAAAAMAAAAIAAAAAAAAAAUAAAAFAAAACgAAAAUAAAAWAAAAAAAAABAAAAAAAAAAEgAAAAAAAAApAAAAAQAAACEAAAAAAAAAHgAAAAAAAAAEAAAAAAAAAAAAAAAFAAAAAgAAAAUAAAAPAAAAAQAAAAgAAAAAAAAABQAAAAUAAAAfAAAAAQAAABYAAAAAAAAAEAAAAAAAAAACAAAAAAAAAAYAAAAAAAAADgAAAAAAAAAKAAAAAAAAAAsAAAAAAAAAEQAAAAMAAAAYAAAAAQAAABcAAAADAAAAGQAAAAMAAAAAAAAAAAAAAAEAAAAFAAAACQAAAAUAAAAFAAAAAAAAAAIAAAAAAAAABgAAAAAAAAASAAAAAQAAAAoAAAAAAAAACwAAAAAAAAAEAAAAAQAAAAMAAAAFAAAABwAAAAUAAAAIAAAAAQAAAAAAAAAAAAAAAQAAAAUAAAAQAAAAAQAAAAUAAAAAAAAAAgAAAAAAAAAHAAAAAAAAABUAAAAAAAAAJgAAAAAAAAAJAAAAAAAAABMAAAAAAAAAIgAAAAMAAAAOAAAAAQAAABQAAAADAAAAJAAAAAMAAAADAAAAAAAAAA0AAAAFAAAAHQAAAAUAAAABAAAAAAAAAAcAAAAAAAAAFQAAAAAAAAAGAAAAAQAAAAkAAAAAAAAAEwAAAAAAAAAEAAAAAgAAAAwAAAAFAAAAGgAAAAUAAAAAAAAAAQAAAAMAAAAAAAAADQAAAAUAAAACAAAAAQAAAAEAAAAAAAAABwAAAAAAAAAaAAAAAAAAACoAAAAAAAAAOgAAAAAAAAAdAAAAAAAAACsAAAAAAAAAPgAAAAMAAAAmAAAAAQAAAC8AAAADAAAAQAAAAAMAAAAMAAAAAAAAABwAAAAFAAAALAAAAAUAAAANAAAAAAAAABoAAAAAAAAAKgAAAAAAAAAVAAAAAQAAAB0AAAAAAAAAKwAAAAAAAAAEAAAAAwAAAA8AAAAFAAAAHwAAAAUAAAADAAAAAQAAAAwAAAAAAAAAHAAAAAUAAAAHAAAAAQAAAA0AAAAAAAAAGgAAAAAAAAAfAAAAAAAAACkAAAAAAAAAMQAAAAAAAAAsAAAAAAAAADUAAAAAAAAAPQAAAAMAAAA6AAAAAQAAAEEAAAADAAAASwAAAAMAAAAPAAAAAAAAABYAAAAFAAAAIQAAAAUAAAAcAAAAAAAAAB8AAAAAAAAAKQAAAAAAAAAqAAAAAQAAACwAAAAAAAAANQAAAAAAAAAEAAAABAAAAAgAAAAFAAAAEAAAAAUAAAAMAAAAAQAAAA8AAAAAAAAAFgAAAAUAAAAaAAAAAQAAABwAAAAAAAAAHwAAAAAAAAAyAAAAAAAAADAAAAAAAAAAMQAAAAMAAAAgAAAAAAAAAB4AAAADAAAAIQAAAAMAAAAYAAAAAwAAABIAAAADAAAAEAAAAAMAAABGAAAAAAAAAEMAAAAAAAAAQgAAAAMAAAA0AAAAAwAAADIAAAAAAAAAMAAAAAAAAAAlAAAAAwAAACAAAAAAAAAAHgAAAAMAAABTAAAAAAAAAFcAAAADAAAAVQAAAAMAAABKAAAAAwAAAEYAAAAAAAAAQwAAAAAAAAA5AAAAAQAAADQAAAADAAAAMgAAAAAAAAAZAAAAAAAAABcAAAAAAAAAGAAAAAMAAAARAAAAAAAAAAsAAAADAAAACgAAAAMAAAAOAAAAAwAAAAYAAAADAAAAAgAAAAMAAAAtAAAAAAAAACcAAAAAAAAAJQAAAAMAAAAjAAAAAwAAABkAAAAAAAAAFwAAAAAAAAAbAAAAAwAAABEAAAAAAAAACwAAAAMAAAA/AAAAAAAAADsAAAADAAAAOQAAAAMAAAA4AAAAAwAAAC0AAAAAAAAAJwAAAAAAAAAuAAAAAwAAACMAAAADAAAAGQAAAAAAAAAkAAAAAAAAABQAAAAAAAAADgAAAAMAAAAiAAAAAAAAABMAAAADAAAACQAAAAMAAAAmAAAAAwAAABUAAAADAAAABwAAAAMAAAA3AAAAAAAAACgAAAAAAAAAGwAAAAMAAAA2AAAAAwAAACQAAAAAAAAAFAAAAAAAAAAzAAAAAwAAACIAAAAAAAAAEwAAAAMAAABIAAAAAAAAADwAAAADAAAALgAAAAMAAABJAAAAAwAAADcAAAAAAAAAKAAAAAAAAABHAAAAAwAAADYAAAADAAAAJAAAAAAAAABAAAAAAAAAAC8AAAAAAAAAJgAAAAMAAAA+AAAAAAAAACsAAAADAAAAHQAAAAMAAAA6AAAAAwAAACoAAAADAAAAGgAAAAMAAABUAAAAAAAAAEUAAAAAAAAAMwAAAAMAAABSAAAAAwAAAEAAAAAAAAAALwAAAAAAAABMAAAAAwAAAD4AAAAAAAAAKwAAAAMAAABhAAAAAAAAAFkAAAADAAAARwAAAAMAAABiAAAAAwAAAFQAAAAAAAAARQAAAAAAAABgAAAAAwAAAFIAAAADAAAAQAAAAAAAAABLAAAAAAAAAEEAAAAAAAAAOgAAAAMAAAA9AAAAAAAAADUAAAADAAAALAAAAAMAAAAxAAAAAwAAACkAAAADAAAAHwAAAAMAAABeAAAAAAAAAFYAAAAAAAAATAAAAAMAAABRAAAAAwAAAEsAAAAAAAAAQQAAAAAAAABCAAAAAwAAAD0AAAAAAAAANQAAAAMAAABrAAAAAAAAAGgAAAADAAAAYAAAAAMAAABlAAAAAwAAAF4AAAAAAAAAVgAAAAAAAABVAAAAAwAAAFEAAAADAAAASwAAAAAAAAA5AAAAAAAAADsAAAAAAAAAPwAAAAMAAABKAAAAAAAAAE4AAAADAAAATwAAAAMAAABTAAAAAwAAAFwAAAADAAAAXwAAAAMAAAAlAAAAAAAAACcAAAADAAAALQAAAAMAAAA0AAAAAAAAADkAAAAAAAAAOwAAAAAAAABGAAAAAwAAAEoAAAAAAAAATgAAAAMAAAAYAAAAAAAAABcAAAADAAAAGQAAAAMAAAAgAAAAAwAAACUAAAAAAAAAJwAAAAMAAAAyAAAAAwAAADQAAAAAAAAAOQAAAAAAAAAuAAAAAAAAADwAAAAAAAAASAAAAAMAAAA4AAAAAAAAAEQAAAADAAAAUAAAAAMAAAA/AAAAAwAAAE0AAAADAAAAWgAAAAMAAAAbAAAAAAAAACgAAAADAAAANwAAAAMAAAAjAAAAAAAAAC4AAAAAAAAAPAAAAAAAAAAtAAAAAwAAADgAAAAAAAAARAAAAAMAAAAOAAAAAAAAABQAAAADAAAAJAAAAAMAAAARAAAAAwAAABsAAAAAAAAAKAAAAAMAAAAZAAAAAwAAACMAAAAAAAAALgAAAAAAAABHAAAAAAAAAFkAAAAAAAAAYQAAAAMAAABJAAAAAAAAAFsAAAADAAAAZwAAAAMAAABIAAAAAwAAAFgAAAADAAAAaQAAAAMAAAAzAAAAAAAAAEUAAAADAAAAVAAAAAMAAAA2AAAAAAAAAEcAAAAAAAAAWQAAAAAAAAA3AAAAAwAAAEkAAAAAAAAAWwAAAAMAAAAmAAAAAAAAAC8AAAADAAAAQAAAAAMAAAAiAAAAAwAAADMAAAAAAAAARQAAAAMAAAAkAAAAAwAAADYAAAAAAAAARwAAAAAAAABgAAAAAAAAAGgAAAAAAAAAawAAAAMAAABiAAAAAAAAAG4AAAADAAAAcwAAAAMAAABhAAAAAwAAAG8AAAADAAAAdwAAAAMAAABMAAAAAAAAAFYAAAADAAAAXgAAAAMAAABSAAAAAAAAAGAAAAAAAAAAaAAAAAAAAABUAAAAAwAAAGIAAAAAAAAAbgAAAAMAAAA6AAAAAAAAAEEAAAADAAAASwAAAAMAAAA+AAAAAwAAAEwAAAAAAAAAVgAAAAMAAABAAAAAAwAAAFIAAAAAAAAAYAAAAAAAAABVAAAAAAAAAFcAAAAAAAAAUwAAAAMAAABlAAAAAAAAAGYAAAADAAAAZAAAAAMAAABrAAAAAwAAAHAAAAADAAAAcgAAAAMAAABCAAAAAAAAAEMAAAADAAAARgAAAAMAAABRAAAAAAAAAFUAAAAAAAAAVwAAAAAAAABeAAAAAwAAAGUAAAAAAAAAZgAAAAMAAAAxAAAAAAAAADAAAAADAAAAMgAAAAMAAAA9AAAAAwAAAEIAAAAAAAAAQwAAAAMAAABLAAAAAwAAAFEAAAAAAAAAVQAAAAAAAABfAAAAAAAAAFwAAAAAAAAAUwAAAAAAAABPAAAAAAAAAE4AAAAAAAAASgAAAAMAAAA/AAAAAQAAADsAAAADAAAAOQAAAAMAAABtAAAAAAAAAGwAAAAAAAAAZAAAAAUAAABdAAAAAQAAAF8AAAAAAAAAXAAAAAAAAABNAAAAAQAAAE8AAAAAAAAATgAAAAAAAAB1AAAABAAAAHYAAAAFAAAAcgAAAAUAAABqAAAAAQAAAG0AAAAAAAAAbAAAAAAAAABaAAAAAQAAAF0AAAABAAAAXwAAAAAAAABaAAAAAAAAAE0AAAAAAAAAPwAAAAAAAABQAAAAAAAAAEQAAAAAAAAAOAAAAAMAAABIAAAAAQAAADwAAAADAAAALgAAAAMAAABqAAAAAAAAAF0AAAAAAAAATwAAAAUAAABjAAAAAQAAAFoAAAAAAAAATQAAAAAAAABYAAAAAQAAAFAAAAAAAAAARAAAAAAAAAB1AAAAAwAAAG0AAAAFAAAAXwAAAAUAAABxAAAAAQAAAGoAAAAAAAAAXQAAAAAAAABpAAAAAQAAAGMAAAABAAAAWgAAAAAAAABpAAAAAAAAAFgAAAAAAAAASAAAAAAAAABnAAAAAAAAAFsAAAAAAAAASQAAAAMAAABhAAAAAQAAAFkAAAADAAAARwAAAAMAAABxAAAAAAAAAGMAAAAAAAAAUAAAAAUAAAB0AAAAAQAAAGkAAAAAAAAAWAAAAAAAAABvAAAAAQAAAGcAAAAAAAAAWwAAAAAAAAB1AAAAAgAAAGoAAAAFAAAAWgAAAAUAAAB5AAAAAQAAAHEAAAAAAAAAYwAAAAAAAAB3AAAAAQAAAHQAAAABAAAAaQAAAAAAAAB3AAAAAAAAAG8AAAAAAAAAYQAAAAAAAABzAAAAAAAAAG4AAAAAAAAAYgAAAAMAAABrAAAAAQAAAGgAAAADAAAAYAAAAAMAAAB5AAAAAAAAAHQAAAAAAAAAZwAAAAUAAAB4AAAAAQAAAHcAAAAAAAAAbwAAAAAAAABwAAAAAQAAAHMAAAAAAAAAbgAAAAAAAAB1AAAAAQAAAHEAAAAFAAAAaQAAAAUAAAB2AAAAAQAAAHkAAAAAAAAAdAAAAAAAAAByAAAAAQAAAHgAAAABAAAAdwAAAAAAAAByAAAAAAAAAHAAAAAAAAAAawAAAAAAAABkAAAAAAAAAGYAAAAAAAAAZQAAAAMAAABTAAAAAQAAAFcAAAADAAAAVQAAAAMAAAB2AAAAAAAAAHgAAAAAAAAAcwAAAAUAAABsAAAAAQAAAHIAAAAAAAAAcAAAAAAAAABcAAAAAQAAAGQAAAAAAAAAZgAAAAAAAAB1AAAAAAAAAHkAAAAFAAAAdwAAAAUAAABtAAAAAQAAAHYAAAAAAAAAeAAAAAAAAABfAAAAAQAAAGwAAAABAAAAcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAQAAAAEAAAABAAAAAAAAAAAAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAB+ogX28rbpPxqumpJv+fM/165tC4ns9D+XaEnTqUsEQFrOtNlC4PA/3U+0XG6P9b9TdUUBxTTjP4PUp8ex1ty/B1rD/EN43z+lcDi6LLrZP/a45NWEHMY/oJ5ijLDZ+j/xw3rjxWPjP2B8A46ioQdAotff3wla2z+FMSpA1jj+v6b5Y1mtPbS/cIu8K0F457/2esiyJpDNv98k5Ts2NeA/pvljWa09tD88ClUJ60MDQPZ6yLImkM0/4ONKxa0UBcD2uOTVhBzGv5G7JRxGave/8cN648Vj47+HCwtkjAXIv6LX398JWtu/qyheaCAL9D9TdUUBxTTjv4gyTxslhwVAB1rD/EN4378EH/28teoFwH6iBfbytum/F6ztFYdK/r/Xrm0Liez0vwcS6wNGWeO/Ws602ULg8L9TCtRLiLT8P8pi5RexJsw/BlIKPVwR5T95Wyu0/QjnP5PjoT7YYcu/mBhKZ6zrwj8wRYS7NebuP3qW6geh+Ls/SLrixebL3r+pcyymN9XrPwmkNHp7xec/GWNMZVAA17+82s+x2BLiPwn2ytbJ9ek/LgEH1sMS1j8yp/2LhTfeP+SnWwtQBbu/d38gkp5X7z8ytsuHaADGPzUYObdf1+m/7IauECWhwz+cjSACjzniP76Z+wUhN9K/1+GEKzup67+/GYr/04baPw6idWOvsuc/ZedTWsRa5b/EJQOuRzi0v/OncYhHPes/h49PixY53j+i8wWfC03Nvw2idWOvsue/ZedTWsRa5T/EJQOuRzi0P/KncYhHPeu/iY9PixY53r+i8wWfC03NP9anWwtQBbs/d38gkp5X778ytsuHaADGvzUYObdf1+k/74auECWhw7+cjSACjzniv8CZ+wUhN9I/1uGEKzup6z+/GYr/04bavwmkNHp7xee/F2NMZVAA1z+82s+x2BLivwr2ytbJ9em/KwEH1sMS1r8yp/2LhTfev81i5RexJsy/BlIKPVwR5b95Wyu0/Qjnv5DjoT7YYcs/nBhKZ6zrwr8wRYS7Nebuv3OW6geh+Lu/SLrixebL3j+pcyymN9Xrv8rHIFfWehZAMBwUdlo0DECTUc17EOb2PxpVB1SWChdAzjbhb9pTDUDQhmdvECX5P9FlMKCC9+g/IIAzjELgE0DajDngMv8GQFhWDmDPjNs/y1guLh96EkAxPi8k7DIEQJCc4URlhRhA3eLKKLwkEECqpNAyTBD/P6xpjXcDiwVAFtl//cQm4z+Ibt3XKiYTQM7mCLUb3QdAoM1t8yVv7D8aLZv2Nk8UQEAJPV5nQwxAtSsfTCoE9z9TPjXLXIIWQBVanC5W9AtAYM3d7Adm9j++5mQz1FoWQBUThyaVBghAwH5muQsV7T89Q1qv82MUQJoWGOfNuBdAzrkClkmwDkDQjKq77t37Py+g0dtitsE/ZwAMTwVPEUBojepluNwBQGYbtuW+t9w/HNWIJs6MEkDTNuQUSlgEQKxktPP5TcQ/ixbLB8JjEUCwuWjXMQYCQAS/R09FkRdAowpiZjhhDkB7LmlczD/7P01iQmhhsAVAnrtTwDy84z/Z6jfQ2TgTQChOCXMnWwpAhrW3daoz8z/HYJvVPI4VQLT3ik5FcA5Angi7LOZd+z+NNVzDy5gXQBXdvVTFUA1AYNMgOeYe+T8+qHXGCwkXQKQTOKwa5AJA8gFVoEMW0T+FwzJyttIRQAEAAAD/////BwAAAP////8xAAAA/////1cBAAD/////YQkAAP////+nQQAA/////5HLAQD/////95AMAP/////B9lcAAAAAAAAAAAAAAAAAAgAAAP////8OAAAA/////2IAAAD/////rgIAAP/////CEgAA/////06DAAD/////IpcDAP/////uIRkA/////4LtrwAAAAAAAAAAAAAAAAAAAAAAAgAAAP//////////AQAAAAMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////////////////////wEAAAAAAAAAAgAAAP///////////////wMAAAD//////////////////////////////////////////////////////////wIAAAD//////////wEAAAAAAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA/////////////////////wEAAAD///////////////8CAAAA////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAA////////////////AgAAAAEAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AQAAAAIAAAD///////////////8AAAAA/////////////////////wMAAAD///////////////////////////////8CAAAA////////////////AQAAAP////////////////////8AAAAA/////////////////////wMAAAD/////////////////////////////////////////////////////AwAAAP////////////////////8AAAAAAQAAAP//////////AgAAAP//////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAP///////////////wIAAAAAAAAAAQAAAP//////////////////////////////////////////////////////////////////////////AwAAAAEAAAD//////////wIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAgAAAAAAAAACAAAAAQAAAAEAAAACAAAAAgAAAAAAAAAFAAAABQAAAAAAAAACAAAAAgAAAAMAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAIAAAABAAAAAgAAAAIAAAACAAAAAAAAAAUAAAAGAAAAAAAAAAIAAAACAAAAAwAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAIAAAAAAAAAAgAAAAEAAAADAAAAAgAAAAIAAAAAAAAABQAAAAcAAAAAAAAAAgAAAAIAAAADAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAAgAAAAAAAAACAAAAAQAAAAQAAAACAAAAAgAAAAAAAAAFAAAACAAAAAAAAAACAAAAAgAAAAMAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAACAAAAAAAAAAIAAAABAAAAAAAAAAIAAAACAAAAAAAAAAUAAAAJAAAAAAAAAAIAAAACAAAAAwAAAAUAAAAAAAAAAAAAAAAAAAAAAAAACgAAAAIAAAACAAAAAAAAAAMAAAAOAAAAAgAAAAAAAAACAAAAAwAAAAAAAAAAAAAAAgAAAAIAAAADAAAABgAAAAAAAAAAAAAAAAAAAAAAAAALAAAAAgAAAAIAAAAAAAAAAwAAAAoAAAACAAAAAAAAAAIAAAADAAAAAQAAAAAAAAACAAAAAgAAAAMAAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAACAAAAAgAAAAAAAAADAAAACwAAAAIAAAAAAAAAAgAAAAMAAAACAAAAAAAAAAIAAAACAAAAAwAAAAgAAAAAAAAAAAAAAAAAAAAAAAAADQAAAAIAAAACAAAAAAAAAAMAAAAMAAAAAgAAAAAAAAACAAAAAwAAAAMAAAAAAAAAAgAAAAIAAAADAAAACQAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAgAAAAIAAAAAAAAAAwAAAA0AAAACAAAAAAAAAAIAAAADAAAABAAAAAAAAAACAAAAAgAAAAMAAAAKAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAACAAAAAgAAAAAAAAADAAAABgAAAAIAAAAAAAAAAgAAAAMAAAAPAAAAAAAAAAIAAAACAAAAAwAAAAsAAAAAAAAAAAAAAAAAAAAAAAAABgAAAAIAAAACAAAAAAAAAAMAAAAHAAAAAgAAAAAAAAACAAAAAwAAABAAAAAAAAAAAgAAAAIAAAADAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAgAAAAIAAAAAAAAAAwAAAAgAAAACAAAAAAAAAAIAAAADAAAAEQAAAAAAAAACAAAAAgAAAAMAAAANAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAACAAAAAgAAAAAAAAADAAAACQAAAAIAAAAAAAAAAgAAAAMAAAASAAAAAAAAAAIAAAACAAAAAwAAAA4AAAAAAAAAAAAAAAAAAAAAAAAACQAAAAIAAAACAAAAAAAAAAMAAAAFAAAAAgAAAAAAAAACAAAAAwAAABMAAAAAAAAAAgAAAAIAAAADAAAADwAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAgAAAAAAAAACAAAAAQAAABMAAAACAAAAAgAAAAAAAAAFAAAACgAAAAAAAAACAAAAAgAAAAMAAAAQAAAAAAAAAAAAAAAAAAAAAAAAABEAAAACAAAAAAAAAAIAAAABAAAADwAAAAIAAAACAAAAAAAAAAUAAAALAAAAAAAAAAIAAAACAAAAAwAAABEAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAAIAAAAAAAAAAgAAAAEAAAAQAAAAAgAAAAIAAAAAAAAABQAAAAwAAAAAAAAAAgAAAAIAAAADAAAAEgAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAgAAAAAAAAACAAAAAQAAABEAAAACAAAAAgAAAAAAAAAFAAAADQAAAAAAAAACAAAAAgAAAAMAAAATAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAACAAAAAAAAAAIAAAABAAAAEgAAAAIAAAACAAAAAAAAAAUAAAAOAAAAAAAAAAIAAAACAAAAAwAAAAIAAAABAAAAAAAAAAEAAAACAAAAAAAAAAAAAAACAAAAAQAAAAAAAAABAAAAAgAAAAEAAAAAAAAAAgAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAAAAAAAgAAAAEAAAAAAAAAAQAAAAIAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAEAAAACAAAAAQAAAAAAAAACAAAAAgAAAAAAAAABAAAAAAAAAAAAAAAFAAAABAAAAAAAAAABAAAABQAAAAAAAAAAAAAABQAAAAQAAAAAAAAAAQAAAAUAAAAEAAAAAAAAAAUAAAAFAAAAAAAAAAEAAAAAAAAAAAAAAMuhRbbsNlBBYqHW9OmHIkF9XBuqnS31QAK37uYhNMhAOSo3UUupm0DC+6pc6JxvQHV9eseEEEJAzURsCyqlFEB8BQ4NMJjnPyy3tBoS97o/xawXQznRjj89J2K2CZxhP6vX43RIIDQ/S8isgygEBz+LvFHQkmzaPjFFFO7wMq4+AADMLkTtjkIAAOgkJqxhQgAAU7B0MjRCAADwpBcVB0IAAACYP2HaQQAAAIn/Ja5BzczM4Eg6gUHNzMxMU7BTQTMzMzNfgCZBAAAAAEi3+UAAAAAAwGPNQDMzMzMzy6BAmpmZmZkxc0AzMzMzM/NFQDMzMzMzMxlAzczMzMzM7D+ygXSx2U6RQKimJOvQKnpA23hmONTHY0A/AGcxyudNQNb3K647mzZA+S56rrwWIUAm4kUQ+9UJQKre9hGzh/M/BLvoy9WG3T+LmqMf8VHGP2m3nYNV37A/gbFHcyeCmT+cBPWBckiDP61tZACjKW0/q2RbYVUYVj8uDypVyLNAP6jGS5cA5zBBwcqhBdCNGUEGEhQ/JVEDQT6WPnRbNO1AB/AWSJgT1kDfUWNCNLDAQNk+5C33OqlAchWL34QSk0DKvtDIrNV8QNF0G3kFzGVASSeWhBl6UED+/0mNGuk4QGjA/dm/1CJALPLPMql6DEDSHoDrwpP1P2jouzWST+A/egAAAAAAAABKAwAAAAAAAPoWAAAAAAAAyqAAAAAAAAB6ZQQAAAAAAErGHgAAAAAA+mvXAAAAAADK8+MFAAAAAHqqOykAAAAASqmhIAEAAAD6oGvkBwAAAMpm8T43AAAAes+ZuIIBAABKrDQMkwoAAPq1cFUFSgAAyvkUViUGAgAAAAAAAwAAAAYAAAACAAAABQAAAAEAAAAEAAAAAAAAAAAAAAAFAAAAAwAAAAEAAAAGAAAABAAAAAIAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAA/////wAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAP////8AAAAAAAAAAAEAAAABAAAAAAAAAAAAAAD/////AAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAA/////wUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////////////////////////////////////AAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////wAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAUAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////////////////////////////////////8AAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAAAAAAAAAAABAAAAAQAAAAEAAAAAAAAAAQAAAAAAAAAFAAAAAQAAAAEAAAAAAAAAAAAAAAEAAAABAAAAAAAAAAEAAAABAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEBAAAAAAABAAEAAAEBAAAAAAABAAAAAQAAAAEAAQAAAAAAAAAAAAAAAAAAAAAEAAAABAAAAAAAAAACAAAAAQAAAAMAAAAOAAAABgAAAAsAAAACAAAABwAAAAEAAAAYAAAABQAAAAoAAAABAAAABgAAAAAAAAAmAAAABwAAAAwAAAADAAAACAAAAAIAAAAxAAAACQAAAA4AAAAAAAAABQAAAAQAAAA6AAAACAAAAA0AAAAEAAAACQAAAAMAAAA/AAAACwAAAAYAAAAPAAAACgAAABAAAABIAAAADAAAAAcAAAAQAAAACwAAABEAAABTAAAACgAAAAUAAAATAAAADgAAAA8AAABhAAAADQAAAAgAAAARAAAADAAAABIAAABrAAAADgAAAAkAAAASAAAADQAAABMAAAB1AAAADwAAABMAAAARAAAAEgAAABAAAAAHAAAABwAAAAEAAAACAAAABAAAAAMAAAAAAAAAAAAAAAcAAAADAAAAAQAAAAIAAAAFAAAABAAAAAAAAAAAAAAAYWxnb3MuYwBfcG9seWZpbGxJbnRlcm5hbABhZGphY2VudEZhY2VEaXJbdG1wRmlqay5mYWNlXVtmaWprLmZhY2VdID09IEtJAGZhY2VpamsuYwBfZmFjZUlqa1BlbnRUb0dlb0JvdW5kYXJ5AGFkamFjZW50RmFjZURpcltjZW50ZXJJSksuZmFjZV1bZmFjZTJdID09IEtJAF9mYWNlSWprVG9HZW9Cb3VuZGFyeQBwb2x5Z29uLT5uZXh0ID09IE5VTEwAbGlua2VkR2VvLmMAYWRkTmV3TGlua2VkUG9seWdvbgBuZXh0ICE9IE5VTEwAbG9vcCAhPSBOVUxMAGFkZE5ld0xpbmtlZExvb3AAcG9seWdvbi0+Zmlyc3QgPT0gTlVMTABhZGRMaW5rZWRMb29wAGNvb3JkICE9IE5VTEwAYWRkTGlua2VkQ29vcmQAbG9vcC0+Zmlyc3QgPT0gTlVMTABpbm5lckxvb3BzICE9IE5VTEwAbm9ybWFsaXplTXVsdGlQb2x5Z29uAGJib3hlcyAhPSBOVUxMAGNhbmRpZGF0ZXMgIT0gTlVMTABmaW5kUG9seWdvbkZvckhvbGUAY2FuZGlkYXRlQkJveGVzICE9IE5VTEwAcmV2RGlyICE9IElOVkFMSURfRElHSVQAbG9jYWxpai5jAGgzVG9Mb2NhbElqawBiYXNlQ2VsbCAhPSBvcmlnaW5CYXNlQ2VsbAAhKG9yaWdpbk9uUGVudCAmJiBpbmRleE9uUGVudCkAcGVudGFnb25Sb3RhdGlvbnMgPj0gMABkaXJlY3Rpb25Sb3RhdGlvbnMgPj0gMABiYXNlQ2VsbCA9PSBvcmlnaW5CYXNlQ2VsbABiYXNlQ2VsbCAhPSBJTlZBTElEX0JBU0VfQ0VMTABsb2NhbElqa1RvSDMAIV9pc0Jhc2VDZWxsUGVudGFnb24oYmFzZUNlbGwpAGJhc2VDZWxsUm90YXRpb25zID49IDAAd2l0aGluUGVudGFnb25Sb3RhdGlvbnMgPj0gMABncmFwaC0+YnVja2V0cyAhPSBOVUxMAHZlcnRleEdyYXBoLmMAaW5pdFZlcnRleEdyYXBoAG5vZGUgIT0gTlVMTABhZGRWZXJ0ZXhOb2Rl";var Nl=24032;function _s(ot){return ot}function mo(ot){var Pt=/\b__Z[\w\d_]+/g;return ot.replace(Pt,function(rn){var Gn=rn;return rn===Gn?rn:Gn+" ["+rn+"]"})}function Fl(){var ot=new Error;if(!ot.stack){try{throw new Error(0)}catch(Pt){ot=Pt}if(!ot.stack)return"(no stack trace available)"}return ot.stack.toString()}function su(){var ot=Fl();return e.extraStackTrace&&(ot+=`
`+e.extraStackTrace()),mo(ot)}function kl(ot,Pt,rn,Gn){tr("Assertion failed: "+J(ot)+", at: "+[Pt?J(Pt):"unknown filename",rn,Gn?J(Gn):"unknown function"])}function au(){return me.length}function $u(ot,Pt,rn){Ce.set(Ce.subarray(Pt,Pt+rn),ot)}function lu(ot){return e.___errno_location&&(Ye[e.___errno_location()>>2]=ot),ot}function Hu(ot){tr("OOM")}function uu(ot){try{var Pt=new ArrayBuffer(ot);return Pt.byteLength!=ot?void 0:(new Int8Array(Pt).set(me),rt(Pt),be(Pt),1)}catch{}}function Fc(ot){var Pt=au(),rn=16777216,Gn=2147483648-rn;if(ot>Gn)return!1;for(var w=16777216,Ue=Math.max(Pt,w);Ue<ot;)Ue<=536870912?Ue=ce(2*Ue,rn):Ue=Math.min(ce((3*Ue+2147483648)/4,rn),Gn);var Ir=uu(Ue);return!!Ir}var Wu=typeof atob=="function"?atob:function(ot){var Pt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",rn="",Gn,w,Ue,Ir,fr,rr,Tr,qi=0;ot=ot.replace(/[^A-Za-z0-9\+\/\=]/g,"");do Ir=Pt.indexOf(ot.charAt(qi++)),fr=Pt.indexOf(ot.charAt(qi++)),rr=Pt.indexOf(ot.charAt(qi++)),Tr=Pt.indexOf(ot.charAt(qi++)),Gn=Ir<<2|fr>>4,w=(fr&15)<<4|rr>>2,Ue=(rr&3)<<6|Tr,rn=rn+String.fromCharCode(Gn),rr!==64&&(rn=rn+String.fromCharCode(w)),Tr!==64&&(rn=rn+String.fromCharCode(Ue));while(qi<ot.length);return rn};function Ge(ot){try{for(var Pt=Wu(ot),rn=new Uint8Array(Pt.length),Gn=0;Gn<Pt.length;++Gn)rn[Gn]=Pt.charCodeAt(Gn);return rn}catch{throw new Error("Converting base64 string to bytes failed.")}}function ge(ot){if(Ri(ot))return Ge(ot.slice(cs.length))}var Ae={Math,Int8Array,Int32Array,Uint8Array,Float32Array,Float64Array},ze={a:tr,b:g,c:_,d:kl,e:lu,f:au,g:$u,h:Fc,i:Hu,j:_s,k:mo,l:uu,m:Fl,n:su,o:Nl,p:Re},Me=function(ot,Pt,rn){"almost asm";var Gn=new ot.Int8Array(rn),w=new ot.Int32Array(rn);new ot.Uint8Array(rn),new ot.Float32Array(rn);var Ue=new ot.Float64Array(rn),Ir=Pt.p|0,fr=ot.Math.floor,rr=ot.Math.abs,Tr=ot.Math.sqrt,qi=ot.Math.pow,qr=ot.Math.cos,jn=ot.Math.sin,ro=ot.Math.tan,ca=ot.Math.acos,kc=ot.Math.asin,zl=ot.Math.atan,Qr=ot.Math.atan2,Vo=ot.Math.ceil,Bo=ot.Math.imul,ka=ot.Math.min,$o=ot.Math.clz32,Hn=Pt.b,Ke=Pt.c,pt=Pt.d,za=Pt.e,Vi=Pt.f,gi=Pt.g,Nf=Pt.h,fa=Pt.i,Ve=24048;function $h(y){return Gn=new Int8Array(y),w=new Int32Array(y),Ue=new Float64Array(y),rn=y,!0}function cu(y){y=y|0;var x=0;return x=Ve,Ve=Ve+y|0,Ve=Ve+15&-16,x|0}function _n(){return Ve|0}function ur(y){y=y|0,Ve=y}function Cr(y,x){y=y|0,Ve=y}function Os(y){return y=y|0,(Bo(y*3|0,y+1|0)|0)+1|0}function Rs(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0;var B=0,j=0;ys(y,x,T,R,0)|0&&(j=(Bo(T*3|0,T+1|0)|0)+1|0,Aa(R|0,0,j<<3|0)|0,B=ma(j,4)|0,B&&(Ls(y,x,T,R,B,j,0),Mr(B)))}function xr(y,x,T,R,B){y=y|0,x=x|0,T=T|0,R=R|0,B=B|0;var j=0;if(ys(y,x,T,R,B)|0){if(j=(Bo(T*3|0,T+1|0)|0)+1|0,Aa(R|0,0,j<<3|0)|0,B|0){Aa(B|0,0,j<<2|0)|0,Ls(y,x,T,R,B,j,0);return}B=ma(j,4)|0,B&&(Ls(y,x,T,R,B,j,0),Mr(B))}}function ys(y,x,T,R,B){y=y|0,x=x|0,T=T|0,R=R|0,B=B|0;var j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0;if(gt=Ve,Ve=Ve+16|0,tt=gt,j=R,w[j>>2]=y,w[j+4>>2]=x,j=(B|0)!=0,j&&(w[B>>2]=0),No(y,x)|0)return tt=1,Ve=gt,tt|0;w[tt>>2]=0;e:do if((T|0)>=1)if(j)for(pe=0,_e=1,Xe=1,G=0,j=y;;){if(!(G|pe)){if(j=ye(j,x,4,tt)|0,x=Ke()|0,(j|0)==0&(x|0)==0){j=2;break e}if(No(j,x)|0){j=1;break e}}if(j=ye(j,x,w[16+(pe<<2)>>2]|0,tt)|0,x=Ke()|0,(j|0)==0&(x|0)==0){j=2;break e}if(y=R+(Xe<<3)|0,w[y>>2]=j,w[y+4>>2]=x,w[B+(Xe<<2)>>2]=_e,G=G+1|0,y=(G|0)==(_e|0),Z=pe+1|0,ae=(Z|0)==6,No(j,x)|0){j=1;break e}if(_e=_e+(ae&y&1)|0,(_e|0)>(T|0)){j=0;break}else pe=y?ae?0:Z:pe,Xe=Xe+1|0,G=y?0:G}else for(pe=0,_e=1,Xe=1,G=0,j=y;;){if(!(G|pe)){if(j=ye(j,x,4,tt)|0,x=Ke()|0,(j|0)==0&(x|0)==0){j=2;break e}if(No(j,x)|0){j=1;break e}}if(j=ye(j,x,w[16+(pe<<2)>>2]|0,tt)|0,x=Ke()|0,(j|0)==0&(x|0)==0){j=2;break e}if(y=R+(Xe<<3)|0,w[y>>2]=j,w[y+4>>2]=x,G=G+1|0,y=(G|0)==(_e|0),Z=pe+1|0,ae=(Z|0)==6,No(j,x)|0){j=1;break e}if(_e=_e+(ae&y&1)|0,(_e|0)>(T|0)){j=0;break}else pe=y?ae?0:Z:pe,Xe=Xe+1|0,G=y?0:G}else j=0;while(0);return tt=j,Ve=gt,tt|0}function Ls(y,x,T,R,B,j,G){y=y|0,x=x|0,T=T|0,R=R|0,B=B|0,j=j|0,G=G|0;var Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0;if(Xe=Ve,Ve=Ve+16|0,_e=Xe,(y|0)==0&(x|0)==0){Ve=Xe;return}if(Z=Hc(y|0,x|0,j|0,((j|0)<0)<<31>>31|0)|0,Ke()|0,ae=R+(Z<<3)|0,tt=ae,gt=w[tt>>2]|0,tt=w[tt+4>>2]|0,pe=(gt|0)==(y|0)&(tt|0)==(x|0),!((gt|0)==0&(tt|0)==0|pe))do Z=(Z+1|0)%(j|0)|0,ae=R+(Z<<3)|0,gt=ae,tt=w[gt>>2]|0,gt=w[gt+4>>2]|0,pe=(tt|0)==(y|0)&(gt|0)==(x|0);while(!((tt|0)==0&(gt|0)==0|pe));if(Z=B+(Z<<2)|0,pe&&(w[Z>>2]|0)<=(G|0)){Ve=Xe;return}if(gt=ae,w[gt>>2]=y,w[gt+4>>2]=x,w[Z>>2]=G,(G|0)>=(T|0)){Ve=Xe;return}gt=G+1|0,w[_e>>2]=0,tt=ye(y,x,2,_e)|0,Ls(tt,Ke()|0,T,R,B,j,gt),w[_e>>2]=0,tt=ye(y,x,3,_e)|0,Ls(tt,Ke()|0,T,R,B,j,gt),w[_e>>2]=0,tt=ye(y,x,1,_e)|0,Ls(tt,Ke()|0,T,R,B,j,gt),w[_e>>2]=0,tt=ye(y,x,5,_e)|0,Ls(tt,Ke()|0,T,R,B,j,gt),w[_e>>2]=0,tt=ye(y,x,4,_e)|0,Ls(tt,Ke()|0,T,R,B,j,gt),w[_e>>2]=0,tt=ye(y,x,6,_e)|0,Ls(tt,Ke()|0,T,R,B,j,gt),Ve=Xe}function ye(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0;var B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0;if((w[R>>2]|0)>0){B=0;do T=Gl(T)|0,B=B+1|0;while((B|0)<(w[R>>2]|0))}Z=An(y|0,x|0,45)|0,Ke()|0,ae=Z&127,j=fs(y,x)|0,B=An(y|0,x|0,52)|0,Ke()|0,B=B&15;e:do if(!B)G=6;else for(;;){if(Xe=(15-B|0)*3|0,tt=An(y|0,x|0,Xe|0)|0,Ke()|0,tt=tt&7,gt=(Ua(B)|0)==0,B=B+-1|0,_e=Dn(7,0,Xe|0)|0,x=x&~(Ke()|0),Xe=Dn(w[(gt?464:48)+(tt*28|0)+(T<<2)>>2]|0,0,Xe|0)|0,pe=Ke()|0,T=w[(gt?672:256)+(tt*28|0)+(T<<2)>>2]|0,y=Xe|y&~_e,x=pe|x,!T){T=0;break e}if(!B){G=6;break}}while(0);(G|0)==6&&(gt=w[880+(ae*28|0)+(T<<2)>>2]|0,tt=Dn(gt|0,0,45)|0,y=tt|y,x=Ke()|0|x&-1040385,T=w[4304+(ae*28|0)+(T<<2)>>2]|0,(gt&127|0)==127&&(gt=Dn(w[880+(ae*28|0)+20>>2]|0,0,45)|0,x=Ke()|0|x&-1040385,T=w[4304+(ae*28|0)+20>>2]|0,y=ws(gt|y,x)|0,x=Ke()|0,w[R>>2]=(w[R>>2]|0)+1)),G=An(y|0,x|0,45)|0,Ke()|0,G=G&127;e:do if(Lr(G)|0){t:do if((fs(y,x)|0)==1){if((ae|0)!=(G|0))if(lo(G,w[7728+(ae*28|0)>>2]|0)|0){y=mp(y,x)|0,j=1,x=Ke()|0;break}else{y=ws(y,x)|0,j=1,x=Ke()|0;break}switch(j|0){case 5:{y=mp(y,x)|0,x=Ke()|0,w[R>>2]=(w[R>>2]|0)+5,j=0;break t}case 3:{y=ws(y,x)|0,x=Ke()|0,w[R>>2]=(w[R>>2]|0)+1,j=0;break t}default:return tt=0,gt=0,Hn(tt|0),gt|0}}else j=0;while(0);if((T|0)>0){B=0;do y=gp(y,x)|0,x=Ke()|0,B=B+1|0;while((B|0)!=(T|0))}if((ae|0)!=(G|0)){if(!(ao(G)|0)){if((j|0)!=0|(fs(y,x)|0)!=5)break;w[R>>2]=(w[R>>2]|0)+1;break}switch(Z&127){case 8:case 118:break e}(fs(y,x)|0)!=3&&(w[R>>2]=(w[R>>2]|0)+1)}}else if((T|0)>0){B=0;do y=ws(y,x)|0,x=Ke()|0,B=B+1|0;while((B|0)!=(T|0))}while(0);return w[R>>2]=((w[R>>2]|0)+T|0)%6|0,tt=x,gt=y,Hn(tt|0),gt|0}function Oe(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0;var B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0;if(Xe=Ve,Ve=Ve+16|0,_e=Xe,!T)return _e=R,w[_e>>2]=y,w[_e+4>>2]=x,_e=0,Ve=Xe,_e|0;w[_e>>2]=0;e:do if(No(y,x)|0)y=1;else{if(j=(T|0)>0,j){B=0,pe=y;do{if(pe=ye(pe,x,4,_e)|0,x=Ke()|0,(pe|0)==0&(x|0)==0){y=2;break e}if(B=B+1|0,No(pe,x)|0){y=1;break e}}while((B|0)<(T|0));if(ae=R,w[ae>>2]=pe,w[ae+4>>2]=x,ae=T+-1|0,j){j=0,G=1,B=pe,y=x;do{if(B=ye(B,y,2,_e)|0,y=Ke()|0,(B|0)==0&(y|0)==0){y=2;break e}if(Z=R+(G<<3)|0,w[Z>>2]=B,w[Z+4>>2]=y,G=G+1|0,No(B,y)|0){y=1;break e}j=j+1|0}while((j|0)<(T|0));Z=0,j=G;do{if(B=ye(B,y,3,_e)|0,y=Ke()|0,(B|0)==0&(y|0)==0){y=2;break e}if(G=R+(j<<3)|0,w[G>>2]=B,w[G+4>>2]=y,j=j+1|0,No(B,y)|0){y=1;break e}Z=Z+1|0}while((Z|0)<(T|0));G=0;do{if(B=ye(B,y,1,_e)|0,y=Ke()|0,(B|0)==0&(y|0)==0){y=2;break e}if(Z=R+(j<<3)|0,w[Z>>2]=B,w[Z+4>>2]=y,j=j+1|0,No(B,y)|0){y=1;break e}G=G+1|0}while((G|0)<(T|0));G=0;do{if(B=ye(B,y,5,_e)|0,y=Ke()|0,(B|0)==0&(y|0)==0){y=2;break e}if(Z=R+(j<<3)|0,w[Z>>2]=B,w[Z+4>>2]=y,j=j+1|0,No(B,y)|0){y=1;break e}G=G+1|0}while((G|0)<(T|0));G=0;do{if(B=ye(B,y,4,_e)|0,y=Ke()|0,(B|0)==0&(y|0)==0){y=2;break e}if(Z=R+(j<<3)|0,w[Z>>2]=B,w[Z+4>>2]=y,j=j+1|0,No(B,y)|0){y=1;break e}G=G+1|0}while((G|0)<(T|0));for(G=0;;){if(B=ye(B,y,6,_e)|0,y=Ke()|0,(B|0)==0&(y|0)==0){y=2;break e}if((G|0)!=(ae|0))if(Z=R+(j<<3)|0,w[Z>>2]=B,w[Z+4>>2]=y,!(No(B,y)|0))j=j+1|0;else{y=1;break e}if(G=G+1|0,(G|0)>=(T|0)){G=pe,j=x;break}}}else G=pe,B=pe,j=x,y=x}else G=R,w[G>>2]=y,w[G+4>>2]=x,G=y,B=y,j=x,y=x;y=((G|0)!=(B|0)|(j|0)!=(y|0))&1}while(0);return _e=y,Ve=Xe,_e|0}function He(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0;if(j=Ve,Ve=Ve+48|0,B=j+8|0,R=j,Z=y,G=w[Z+4>>2]|0,T=R,w[T>>2]=w[Z>>2],w[T+4>>2]=G,jc(R,B),B=Xi(B,x)|0,x=w[R>>2]|0,R=w[y+8>>2]|0,(R|0)<=0)return Z=x,G=(B|0)<(Z|0),Z=G?Z:B,Z=Z+12|0,Ve=j,Z|0;T=w[y+12>>2]|0,y=0;do x=(w[T+(y<<3)>>2]|0)+x|0,y=y+1|0;while((y|0)<(R|0));return Z=(B|0)<(x|0),Z=Z?x:B,Z=Z+12|0,Ve=j,Z|0}function Ot(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0,ae=0;if(Z=Ve,Ve=Ve+48|0,R=Z+8|0,B=Z,!(on(y,x,T)|0)){Ve=Z;return}if(ae=y,j=w[ae+4>>2]|0,G=B,w[G>>2]=w[ae>>2],w[G+4>>2]=j,jc(B,R),G=Xi(R,x)|0,x=w[B>>2]|0,j=w[y+8>>2]|0,(j|0)>0){B=w[y+12>>2]|0,R=0;do x=(w[B+(R<<3)>>2]|0)+x|0,R=R+1|0;while((R|0)!=(j|0))}if(x=(G|0)<(x|0)?x:G,(x|0)<=-12){Ve=Z;return}ae=x+11|0,Aa(T|0,0,(((ae|0)>0?ae:0)<<3)+8|0)|0,Ve=Z}function on(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0,Vt=0,yn=0,Cn=0,Rt=0,fn=0,it=0,On=0,Bn=0,Pn=0,Mt=0,br=0,ui=0,Vr=0,Jr=0,qt=0,xi=0,$i=0,gr=0;if(gr=Ve,Ve=Ve+112|0,Jr=gr+80|0,ae=gr+72|0,qt=gr,xi=gr+56|0,pe=y+8|0,$i=Ga((w[pe>>2]<<5)+32|0)|0,$i||pt(22848,22448,800,22456),$g(y,$i),j=y,R=w[j+4>>2]|0,Z=ae,w[Z>>2]=w[j>>2],w[Z+4>>2]=R,jc(ae,Jr),Z=Xi(Jr,x)|0,R=w[ae>>2]|0,j=w[pe>>2]|0,(j|0)>0){G=w[y+12>>2]|0,B=0;do R=(w[G+(B<<3)>>2]|0)+R|0,B=B+1|0;while((B|0)!=(j|0))}if(Z=(Z|0)<(R|0)?R:Z,Vr=Z+12|0,B=ma(Vr,8)|0,_e=ma(Vr,8)|0,w[Jr>>2]=0,br=y,ui=w[br+4>>2]|0,R=ae,w[R>>2]=w[br>>2],w[R+4>>2]=ui,R=Fn(ae,Vr,x,Jr,B,_e)|0,R|0)return Mr(B),Mr(_e),Mr($i),$i=R,Ve=gr,$i|0;e:do if((w[pe>>2]|0)>0){for(j=y+12|0,R=0;G=Fn((w[j>>2]|0)+(R<<3)|0,Vr,x,Jr,B,_e)|0,R=R+1|0,!(G|0);)if((R|0)>=(w[pe>>2]|0))break e;return Mr(B),Mr(_e),Mr($i),$i=G,Ve=gr,$i|0}while(0);(Z|0)>-12&&Aa(_e|0,0,((Vr|0)>1?Vr:1)<<3|0)|0;e:do if((w[Jr>>2]|0)>0){ui=((Vr|0)<0)<<31>>31,it=B,On=_e,Bn=B,Pn=B,Mt=_e,br=B,R=B,yn=B,Cn=_e,Rt=_e,fn=_e,B=_e;t:for(;;){for(Vt=w[Jr>>2]|0,gt=0,kt=0,j=0;;){G=qt,Z=G+56|0;do w[G>>2]=0,G=G+4|0;while((G|0)<(Z|0));if(x=it+(gt<<3)|0,ae=w[x>>2]|0,x=w[x+4>>2]|0,ys(ae,x,1,qt,0)|0){G=qt,Z=G+56|0;do w[G>>2]=0,G=G+4|0;while((G|0)<(Z|0));G=ma(7,4)|0,G|0&&(Ls(ae,x,1,qt,G,7,0),Mr(G))}tt=0;do{Xe=qt+(tt<<3)|0,_e=w[Xe>>2]|0,Xe=w[Xe+4>>2]|0;n:do if(!((_e|0)==0&(Xe|0)==0)){if(ae=Hc(_e|0,Xe|0,Vr|0,ui|0)|0,Ke()|0,G=T+(ae<<3)|0,Z=G,x=w[Z>>2]|0,Z=w[Z+4>>2]|0,!((x|0)==0&(Z|0)==0))for(pe=0;;){if((pe|0)>(Vr|0))break t;if((x|0)==(_e|0)&(Z|0)==(Xe|0))break n;if(ae=(ae+1|0)%(Vr|0)|0,G=T+(ae<<3)|0,Z=G,x=w[Z>>2]|0,Z=w[Z+4>>2]|0,(x|0)==0&(Z|0)==0)break;pe=pe+1|0}(_e|0)==0&(Xe|0)==0||(du(_e,Xe,xi),Hg(y,$i,xi)|0&&(pe=G,w[pe>>2]=_e,w[pe+4>>2]=Xe,pe=On+(j<<3)|0,w[pe>>2]=_e,w[pe+4>>2]=Xe,j=j+1|0))}while(0);tt=tt+1|0}while(tt>>>0<7);if(kt=kt+1|0,(kt|0)>=(Vt|0))break;gt=gt+1|0}if((Vt|0)>0&&Aa(Bn|0,0,Vt<<3|0)|0,w[Jr>>2]=j,(j|0)>0)_e=B,Xe=fn,tt=br,gt=Rt,kt=Cn,Vt=On,B=yn,fn=R,Rt=Pn,Cn=Bn,yn=_e,R=Xe,br=Mt,Mt=tt,Pn=gt,Bn=kt,On=it,it=Vt;else break e}return Mr(Pn),Mr(Mt),Mr($i),$i=-1,Ve=gr,$i|0}else R=_e;while(0);return Mr($i),Mr(B),Mr(R),$i=0,Ve=gr,$i|0}function Fn(y,x,T,R,B,j){y=y|0,x=x|0,T=T|0,R=R|0,B=B|0,j=j|0;var G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0,Vt=0,yn=0,Cn=0,Rt=0,fn=0,it=0,On=0,Bn=0,Pn=0,Mt=0,br=0,ui=0,Vr=0,Jr=0;if(ui=Ve,Ve=Ve+48|0,Bn=ui+32|0,Pn=ui+16|0,Mt=ui,G=w[y>>2]|0,(G|0)<=0)return br=0,Ve=ui,br|0;Cn=y+4|0,Rt=Bn+8|0,fn=Pn+8|0,it=Mt+8|0,On=((x|0)<0)<<31>>31,yn=0;e:for(;;){Z=w[Cn>>2]|0,kt=Z+(yn<<4)|0,w[Bn>>2]=w[kt>>2],w[Bn+4>>2]=w[kt+4>>2],w[Bn+8>>2]=w[kt+8>>2],w[Bn+12>>2]=w[kt+12>>2],(yn|0)==(G+-1|0)?(w[Pn>>2]=w[Z>>2],w[Pn+4>>2]=w[Z+4>>2],w[Pn+8>>2]=w[Z+8>>2],w[Pn+12>>2]=w[Z+12>>2]):(kt=Z+(yn+1<<4)|0,w[Pn>>2]=w[kt>>2],w[Pn+4>>2]=w[kt+4>>2],w[Pn+8>>2]=w[kt+8>>2],w[Pn+12>>2]=w[kt+12>>2]),kt=ap(Bn,Pn,T)|0;t:do if((kt|0)>0){Vt=+(kt|0),gt=0;n:for(;;){Jr=+(kt-gt|0),Vr=+(gt|0),Ue[Mt>>3]=+Ue[Bn>>3]*Jr/Vt+ +Ue[Pn>>3]*Vr/Vt,Ue[it>>3]=+Ue[Rt>>3]*Jr/Vt+ +Ue[fn>>3]*Vr/Vt,Xe=zg(Mt,T)|0,tt=Ke()|0,Z=Hc(Xe|0,tt|0,x|0,On|0)|0,Ke()|0,G=j+(Z<<3)|0,ae=G,pe=w[ae>>2]|0,ae=w[ae+4>>2]|0;r:do if((pe|0)==0&(ae|0)==0)br=14;else for(_e=0;;){if((_e|0)>(x|0)){G=1;break r}if((pe|0)==(Xe|0)&(ae|0)==(tt|0)){G=7;break r}if(Z=(Z+1|0)%(x|0)|0,G=j+(Z<<3)|0,ae=G,pe=w[ae>>2]|0,ae=w[ae+4>>2]|0,(pe|0)==0&(ae|0)==0){br=14;break}else _e=_e+1|0}while(0);switch((br|0)==14&&(br=0,(Xe|0)==0&(tt|0)==0?G=7:(w[G>>2]=Xe,w[G+4>>2]=tt,G=w[R>>2]|0,_e=B+(G<<3)|0,w[_e>>2]=Xe,w[_e+4>>2]=tt,w[R>>2]=G+1,G=0)),G&7){case 7:case 0:break;default:break n}if(gt=gt+1|0,(kt|0)<=(gt|0)){br=8;break t}}if(G|0){G=-1,br=20;break e}}else br=8;while(0);if((br|0)==8&&(br=0),yn=yn+1|0,G=w[y>>2]|0,(yn|0)>=(G|0)){G=0,br=20;break}}return(br|0)==20?(Ve=ui,G|0):0}function Rr(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0;if(pe=Ve,Ve=Ve+176|0,ae=pe,(x|0)<1){Kh(T,0,0),Ve=pe;return}G=y,G=An(w[G>>2]|0,w[G+4>>2]|0,52)|0,Ke()|0,Kh(T,(x|0)>6?x:6,G&15),G=0;do{if(R=y+(G<<3)|0,jl(w[R>>2]|0,w[R+4>>2]|0,ae),R=w[ae>>2]|0,(R|0)>0){Z=0;do j=ae+8+(Z<<4)|0,Z=Z+1|0,R=ae+8+(((Z|0)%(R|0)|0)<<4)|0,B=j_(T,R,j)|0,B?Sn(T,B)|0:Vl(T,j,R)|0,R=w[ae>>2]|0;while((Z|0)<(R|0))}G=G+1|0}while((G|0)!=(x|0));Ve=pe}function Ao(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0;if(j=Ve,Ve=Ve+32|0,R=j,B=j+16|0,Rr(y,x,B),w[T>>2]=0,w[T+4>>2]=0,w[T+8>>2]=0,y=Tp(B)|0,!y){GA(T)|0,Sp(B),Ve=j;return}do{x=cx(T)|0;do fx(x,y)|0,G=y+16|0,w[R>>2]=w[G>>2],w[R+4>>2]=w[G+4>>2],w[R+8>>2]=w[G+8>>2],w[R+12>>2]=w[G+12>>2],Sn(B,y)|0,y=Cp(B,R)|0;while(y|0);y=Tp(B)|0}while(y|0);GA(T)|0,Sp(B),Ve=j}function Lr(y){return y=y|0,w[7728+(y*28|0)+16>>2]|0}function ao(y){return y=y|0,(y|0)==4|(y|0)==117|0}function vs(y){return y=y|0,w[11152+((w[y>>2]|0)*216|0)+((w[y+4>>2]|0)*72|0)+((w[y+8>>2]|0)*24|0)+(w[y+12>>2]<<3)>>2]|0}function Ig(y){return y=y|0,w[11152+((w[y>>2]|0)*216|0)+((w[y+4>>2]|0)*72|0)+((w[y+8>>2]|0)*24|0)+(w[y+12>>2]<<3)+4>>2]|0}function Hh(y,x){y=y|0,x=x|0,y=7728+(y*28|0)|0,w[x>>2]=w[y>>2],w[x+4>>2]=w[y+4>>2],w[x+8>>2]=w[y+8>>2],w[x+12>>2]=w[y+12>>2]}function ha(y,x){y=y|0,x=x|0;var T=0,R=0;if(x>>>0>20)return x=-1,x|0;do if((w[11152+(x*216|0)>>2]|0)!=(y|0))if((w[11152+(x*216|0)+8>>2]|0)!=(y|0))if((w[11152+(x*216|0)+16>>2]|0)!=(y|0))if((w[11152+(x*216|0)+24>>2]|0)!=(y|0))if((w[11152+(x*216|0)+32>>2]|0)!=(y|0))if((w[11152+(x*216|0)+40>>2]|0)!=(y|0))if((w[11152+(x*216|0)+48>>2]|0)!=(y|0))if((w[11152+(x*216|0)+56>>2]|0)!=(y|0))if((w[11152+(x*216|0)+64>>2]|0)!=(y|0))if((w[11152+(x*216|0)+72>>2]|0)!=(y|0))if((w[11152+(x*216|0)+80>>2]|0)!=(y|0))if((w[11152+(x*216|0)+88>>2]|0)!=(y|0))if((w[11152+(x*216|0)+96>>2]|0)!=(y|0))if((w[11152+(x*216|0)+104>>2]|0)!=(y|0))if((w[11152+(x*216|0)+112>>2]|0)!=(y|0))if((w[11152+(x*216|0)+120>>2]|0)!=(y|0))if((w[11152+(x*216|0)+128>>2]|0)!=(y|0))if((w[11152+(x*216|0)+136>>2]|0)==(y|0))y=2,T=1,R=2;else{if((w[11152+(x*216|0)+144>>2]|0)==(y|0)){y=0,T=2,R=0;break}if((w[11152+(x*216|0)+152>>2]|0)==(y|0)){y=0,T=2,R=1;break}if((w[11152+(x*216|0)+160>>2]|0)==(y|0)){y=0,T=2,R=2;break}if((w[11152+(x*216|0)+168>>2]|0)==(y|0)){y=1,T=2,R=0;break}if((w[11152+(x*216|0)+176>>2]|0)==(y|0)){y=1,T=2,R=1;break}if((w[11152+(x*216|0)+184>>2]|0)==(y|0)){y=1,T=2,R=2;break}if((w[11152+(x*216|0)+192>>2]|0)==(y|0)){y=2,T=2,R=0;break}if((w[11152+(x*216|0)+200>>2]|0)==(y|0)){y=2,T=2,R=1;break}if((w[11152+(x*216|0)+208>>2]|0)==(y|0)){y=2,T=2,R=2;break}else y=-1;return y|0}else y=2,T=1,R=1;else y=2,T=1,R=0;else y=1,T=1,R=2;else y=1,T=1,R=1;else y=1,T=1,R=0;else y=0,T=1,R=2;else y=0,T=1,R=1;else y=0,T=1,R=0;else y=2,T=0,R=2;else y=2,T=0,R=1;else y=2,T=0,R=0;else y=1,T=0,R=2;else y=1,T=0,R=1;else y=1,T=0,R=0;else y=0,T=0,R=2;else y=0,T=0,R=1;else y=0,T=0,R=0;while(0);return x=w[11152+(x*216|0)+(T*72|0)+(y*24|0)+(R<<3)+4>>2]|0,x|0}function lo(y,x){return y=y|0,x=x|0,(w[7728+(y*28|0)+20>>2]|0)==(x|0)?(x=1,x|0):(x=(w[7728+(y*28|0)+24>>2]|0)==(x|0),x|0)}function op(y,x){return y=y|0,x=x|0,w[880+(y*28|0)+(x<<2)>>2]|0}function sp(y,x){return y=y|0,x=x|0,(w[880+(y*28|0)>>2]|0)==(x|0)?(x=0,x|0):(w[880+(y*28|0)+4>>2]|0)==(x|0)?(x=1,x|0):(w[880+(y*28|0)+8>>2]|0)==(x|0)?(x=2,x|0):(w[880+(y*28|0)+12>>2]|0)==(x|0)?(x=3,x|0):(w[880+(y*28|0)+16>>2]|0)==(x|0)?(x=4,x|0):(w[880+(y*28|0)+20>>2]|0)==(x|0)?(x=5,x|0):((w[880+(y*28|0)+24>>2]|0)==(x|0)?6:7)|0}function da(){return 122}function il(y){y=y|0;var x=0,T=0,R=0;x=0;do Dn(x|0,0,45)|0,R=Ke()|0|134225919,T=y+(x<<3)|0,w[T>>2]=-1,w[T+4>>2]=R,x=x+1|0;while((x|0)!=122)}function TA(y){return y=y|0,+Ue[y+16>>3]<+Ue[y+24>>3]|0}function Wh(y,x){y=y|0,x=x|0;var T=0,R=0,B=0;return T=+Ue[x>>3],!(T>=+Ue[y+8>>3])||!(T<=+Ue[y>>3])?(x=0,x|0):(R=+Ue[y+16>>3],T=+Ue[y+24>>3],B=+Ue[x+8>>3],x=B>=T,y=B<=R&1,R<T?x&&(y=1):x||(y=0),x=(y|0)!=0,x|0)}function Xi(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0;G=Ve,Ve=Ve+288|0,T=G+264|0,R=G+96|0,B=G,j=B,Z=j+96|0;do w[j>>2]=0,j=j+4|0;while((j|0)<(Z|0));return Ap(x,B),j=B,Z=w[j>>2]|0,j=w[j+4>>2]|0,du(Z,j,T),jl(Z,j,R),ae=+Uc(T,R+8|0),Ue[T>>3]=+Ue[y>>3],j=T+8|0,Ue[j>>3]=+Ue[y+16>>3],Ue[R>>3]=+Ue[y+8>>3],Z=R+8|0,Ue[Z>>3]=+Ue[y+24>>3],pe=+Uc(T,R),Z=~~+Vo(+(pe*pe/+Xg(+ +rr(+((+Ue[j>>3]-+Ue[Z>>3])/(+Ue[T>>3]-+Ue[R>>3]))),3)/(ae*(ae*2.59807621135)*.8))),Ve=G,(Z|0?Z:1)|0}function ap(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0;Z=Ve,Ve=Ve+288|0,R=Z+264|0,B=Z+96|0,j=Z,G=j,ae=G+96|0;do w[G>>2]=0,G=G+4|0;while((G|0)<(ae|0));return Ap(T,j),ae=j,G=w[ae>>2]|0,ae=w[ae+4>>2]|0,du(G,ae,R),jl(G,ae,B),pe=+Uc(R,B+8|0),ae=~~+Vo(+(+Uc(y,x)/(pe*2))),Ve=Z,(ae|0?ae:1)|0}function CA(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0,w[y>>2]=x,w[y+4>>2]=T,w[y+8>>2]=R}function Ff(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0;Xe=x+8|0,w[Xe>>2]=0,ae=+Ue[y>>3],G=+rr(+ae),pe=+Ue[y+8>>3],Z=+rr(+pe)/.8660254037844386,G=G+Z*.5,T=~~G,y=~~Z,G=G-+(T|0),Z=Z-+(y|0);do if(G<.5)if(G<.3333333333333333)if(w[x>>2]=T,Z<(G+1)*.5){w[x+4>>2]=y;break}else{y=y+1|0,w[x+4>>2]=y;break}else if(tt=1-G,y=(!(Z<tt)&1)+y|0,w[x+4>>2]=y,tt<=Z&Z<G*2){T=T+1|0,w[x>>2]=T;break}else{w[x>>2]=T;break}else{if(!(G<.6666666666666666))if(T=T+1|0,w[x>>2]=T,Z<G*.5){w[x+4>>2]=y;break}else{y=y+1|0,w[x+4>>2]=y;break}if(Z<1-G){if(w[x+4>>2]=y,G*2+-1<Z){w[x>>2]=T;break}}else y=y+1|0,w[x+4>>2]=y;T=T+1|0,w[x>>2]=T}while(0);do if(ae<0)if(y&1){_e=(y+1|0)/2|0,_e=$c(T|0,((T|0)<0)<<31>>31|0,_e|0,((_e|0)<0)<<31>>31|0)|0,T=~~(+(T|0)-((+(_e>>>0)+4294967296*+(Ke()|0))*2+1)),w[x>>2]=T;break}else{_e=(y|0)/2|0,_e=$c(T|0,((T|0)<0)<<31>>31|0,_e|0,((_e|0)<0)<<31>>31|0)|0,T=~~(+(T|0)-(+(_e>>>0)+4294967296*+(Ke()|0))*2),w[x>>2]=T;break}while(0);_e=x+4|0,pe<0&&(T=T-((y<<1|1|0)/2|0)|0,w[x>>2]=T,y=0-y|0,w[_e>>2]=y),R=y-T|0,(T|0)<0?(B=0-T|0,w[_e>>2]=R,w[Xe>>2]=B,w[x>>2]=0,y=R,T=0):B=0,(y|0)<0&&(T=T-y|0,w[x>>2]=T,B=B-y|0,w[Xe>>2]=B,w[_e>>2]=0,y=0),j=T-B|0,R=y-B|0,(B|0)<0&&(w[x>>2]=j,w[_e>>2]=R,w[Xe>>2]=0,y=R,T=j,B=0),R=(y|0)<(T|0)?y:T,R=(B|0)<(R|0)?B:R,!((R|0)<=0)&&(w[x>>2]=T-R,w[_e>>2]=y-R,w[Xe>>2]=B-R)}function li(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0;x=w[y>>2]|0,G=y+4|0,T=w[G>>2]|0,(x|0)<0&&(T=T-x|0,w[G>>2]=T,j=y+8|0,w[j>>2]=(w[j>>2]|0)-x,w[y>>2]=0,x=0),(T|0)<0?(x=x-T|0,w[y>>2]=x,j=y+8|0,B=(w[j>>2]|0)-T|0,w[j>>2]=B,w[G>>2]=0,T=0):(B=y+8|0,j=B,B=w[B>>2]|0),(B|0)<0&&(x=x-B|0,w[y>>2]=x,T=T-B|0,w[G>>2]=T,w[j>>2]=0,B=0),R=(T|0)<(x|0)?T:x,R=(B|0)<(R|0)?B:R,!((R|0)<=0)&&(w[y>>2]=x-R,w[G>>2]=T-R,w[j>>2]=B-R)}function qu(y,x){y=y|0,x=x|0;var T=0,R=0;R=w[y+8>>2]|0,T=+((w[y+4>>2]|0)-R|0),Ue[x>>3]=+((w[y>>2]|0)-R|0)-T*.5,Ue[x+8>>3]=T*.8660254037844386}function xs(y,x,T){y=y|0,x=x|0,T=T|0,w[T>>2]=(w[x>>2]|0)+(w[y>>2]|0),w[T+4>>2]=(w[x+4>>2]|0)+(w[y+4>>2]|0),w[T+8>>2]=(w[x+8>>2]|0)+(w[y+8>>2]|0)}function Ul(y,x,T){y=y|0,x=x|0,T=T|0,w[T>>2]=(w[y>>2]|0)-(w[x>>2]|0),w[T+4>>2]=(w[y+4>>2]|0)-(w[x+4>>2]|0),w[T+8>>2]=(w[y+8>>2]|0)-(w[x+8>>2]|0)}function Xu(y,x){y=y|0,x=x|0;var T=0,R=0;T=Bo(w[y>>2]|0,x)|0,w[y>>2]=T,T=y+4|0,R=Bo(w[T>>2]|0,x)|0,w[T>>2]=R,y=y+8|0,x=Bo(w[y>>2]|0,x)|0,w[y>>2]=x}function kf(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0;G=w[y>>2]|0,Z=(G|0)<0,R=(w[y+4>>2]|0)-(Z?G:0)|0,j=(R|0)<0,B=(j?0-R|0:0)+((w[y+8>>2]|0)-(Z?G:0))|0,T=(B|0)<0,y=T?0:B,x=(j?0:R)-(T?B:0)|0,B=(Z?0:G)-(j?R:0)-(T?B:0)|0,T=(x|0)<(B|0)?x:B,T=(y|0)<(T|0)?y:T,R=(T|0)>0,y=y-(R?T:0)|0,x=x-(R?T:0)|0;e:do switch(B-(R?T:0)|0){case 0:switch(x|0){case 0:return Z=y|0?(y|0)==1?1:7:0,Z|0;case 1:return Z=y|0?(y|0)==1?3:7:2,Z|0;default:break e}case 1:switch(x|0){case 0:return Z=y|0?(y|0)==1?5:7:4,Z|0;case 1:{if(!y)y=6;else break e;return y|0}default:break e}}while(0);return Z=7,Z|0}function I_(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0;G=y+8|0,T=w[G>>2]|0,x=(w[y>>2]|0)-T|0,Z=y+4|0,T=(w[Z>>2]|0)-T|0,R=Vc(+((x*3|0)-T|0)/7)|0,w[y>>2]=R,x=Vc(+((T<<1)+x|0)/7)|0,w[Z>>2]=x,w[G>>2]=0,T=x-R|0,(R|0)<0?(j=0-R|0,w[Z>>2]=T,w[G>>2]=j,w[y>>2]=0,x=T,R=0,T=j):T=0,(x|0)<0&&(R=R-x|0,w[y>>2]=R,T=T-x|0,w[G>>2]=T,w[Z>>2]=0,x=0),j=R-T|0,B=x-T|0,(T|0)<0?(w[y>>2]=j,w[Z>>2]=B,w[G>>2]=0,x=B,B=j,T=0):B=R,R=(x|0)<(B|0)?x:B,R=(T|0)<(R|0)?T:R,!((R|0)<=0)&&(w[y>>2]=B-R,w[Z>>2]=x-R,w[G>>2]=T-R)}function lp(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0;G=y+8|0,T=w[G>>2]|0,x=(w[y>>2]|0)-T|0,Z=y+4|0,T=(w[Z>>2]|0)-T|0,R=Vc(+((x<<1)+T|0)/7)|0,w[y>>2]=R,x=Vc(+((T*3|0)-x|0)/7)|0,w[Z>>2]=x,w[G>>2]=0,T=x-R|0,(R|0)<0?(j=0-R|0,w[Z>>2]=T,w[G>>2]=j,w[y>>2]=0,x=T,R=0,T=j):T=0,(x|0)<0&&(R=R-x|0,w[y>>2]=R,T=T-x|0,w[G>>2]=T,w[Z>>2]=0,x=0),j=R-T|0,B=x-T|0,(T|0)<0?(w[y>>2]=j,w[Z>>2]=B,w[G>>2]=0,x=B,B=j,T=0):B=R,R=(x|0)<(B|0)?x:B,R=(T|0)<(R|0)?T:R,!((R|0)<=0)&&(w[y>>2]=B-R,w[Z>>2]=x-R,w[G>>2]=T-R)}function Zu(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0;x=w[y>>2]|0,G=y+4|0,T=w[G>>2]|0,Z=y+8|0,R=w[Z>>2]|0,B=T+(x*3|0)|0,w[y>>2]=B,T=R+(T*3|0)|0,w[G>>2]=T,x=(R*3|0)+x|0,w[Z>>2]=x,R=T-B|0,(B|0)<0?(x=x-B|0,w[G>>2]=R,w[Z>>2]=x,w[y>>2]=0,T=R,R=0):R=B,(T|0)<0&&(R=R-T|0,w[y>>2]=R,x=x-T|0,w[Z>>2]=x,w[G>>2]=0,T=0),j=R-x|0,B=T-x|0,(x|0)<0?(w[y>>2]=j,w[G>>2]=B,w[Z>>2]=0,R=j,x=0):B=T,T=(B|0)<(R|0)?B:R,T=(x|0)<(T|0)?x:T,!((T|0)<=0)&&(w[y>>2]=R-T,w[G>>2]=B-T,w[Z>>2]=x-T)}function Ds(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0;B=w[y>>2]|0,G=y+4|0,x=w[G>>2]|0,Z=y+8|0,T=w[Z>>2]|0,R=(x*3|0)+B|0,B=T+(B*3|0)|0,w[y>>2]=B,w[G>>2]=R,x=(T*3|0)+x|0,w[Z>>2]=x,T=R-B|0,(B|0)<0?(x=x-B|0,w[G>>2]=T,w[Z>>2]=x,w[y>>2]=0,B=0):T=R,(T|0)<0&&(B=B-T|0,w[y>>2]=B,x=x-T|0,w[Z>>2]=x,w[G>>2]=0,T=0),j=B-x|0,R=T-x|0,(x|0)<0?(w[y>>2]=j,w[G>>2]=R,w[Z>>2]=0,B=j,x=0):R=T,T=(R|0)<(B|0)?R:B,T=(x|0)<(T|0)?x:T,!((T|0)<=0)&&(w[y>>2]=B-T,w[G>>2]=R-T,w[Z>>2]=x-T)}function Mg(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0;(x+-1|0)>>>0>=6||(B=(w[15472+(x*12|0)>>2]|0)+(w[y>>2]|0)|0,w[y>>2]=B,Z=y+4|0,R=(w[15472+(x*12|0)+4>>2]|0)+(w[Z>>2]|0)|0,w[Z>>2]=R,G=y+8|0,x=(w[15472+(x*12|0)+8>>2]|0)+(w[G>>2]|0)|0,w[G>>2]=x,T=R-B|0,(B|0)<0?(x=x-B|0,w[Z>>2]=T,w[G>>2]=x,w[y>>2]=0,R=0):(T=R,R=B),(T|0)<0&&(R=R-T|0,w[y>>2]=R,x=x-T|0,w[G>>2]=x,w[Z>>2]=0,T=0),j=R-x|0,B=T-x|0,(x|0)<0?(w[y>>2]=j,w[Z>>2]=B,w[G>>2]=0,R=j,x=0):B=T,T=(B|0)<(R|0)?B:R,T=(x|0)<(T|0)?x:T,!((T|0)<=0)&&(w[y>>2]=R-T,w[Z>>2]=B-T,w[G>>2]=x-T))}function zc(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0;B=w[y>>2]|0,G=y+4|0,x=w[G>>2]|0,Z=y+8|0,T=w[Z>>2]|0,R=x+B|0,B=T+B|0,w[y>>2]=B,w[G>>2]=R,x=T+x|0,w[Z>>2]=x,T=R-B|0,(B|0)<0?(x=x-B|0,w[G>>2]=T,w[Z>>2]=x,w[y>>2]=0,R=0):(T=R,R=B),(T|0)<0&&(R=R-T|0,w[y>>2]=R,x=x-T|0,w[Z>>2]=x,w[G>>2]=0,T=0),j=R-x|0,B=T-x|0,(x|0)<0?(w[y>>2]=j,w[G>>2]=B,w[Z>>2]=0,R=j,x=0):B=T,T=(B|0)<(R|0)?B:R,T=(x|0)<(T|0)?x:T,!((T|0)<=0)&&(w[y>>2]=R-T,w[G>>2]=B-T,w[Z>>2]=x-T)}function ol(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0;x=w[y>>2]|0,G=y+4|0,R=w[G>>2]|0,Z=y+8|0,T=w[Z>>2]|0,B=R+x|0,w[y>>2]=B,R=T+R|0,w[G>>2]=R,x=T+x|0,w[Z>>2]=x,T=R-B|0,(B|0)<0?(x=x-B|0,w[G>>2]=T,w[Z>>2]=x,w[y>>2]=0,R=0):(T=R,R=B),(T|0)<0&&(R=R-T|0,w[y>>2]=R,x=x-T|0,w[Z>>2]=x,w[G>>2]=0,T=0),j=R-x|0,B=T-x|0,(x|0)<0?(w[y>>2]=j,w[G>>2]=B,w[Z>>2]=0,R=j,x=0):B=T,T=(B|0)<(R|0)?B:R,T=(x|0)<(T|0)?x:T,!((T|0)<=0)&&(w[y>>2]=R-T,w[G>>2]=B-T,w[Z>>2]=x-T)}function Gl(y){switch(y=y|0,y|0){case 1:{y=5;break}case 5:{y=4;break}case 4:{y=6;break}case 6:{y=2;break}case 2:{y=3;break}case 3:{y=1;break}}return y|0}function Bs(y){switch(y=y|0,y|0){case 1:{y=3;break}case 3:{y=2;break}case 2:{y=6;break}case 6:{y=4;break}case 4:{y=5;break}case 5:{y=1;break}}return y|0}function up(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0;x=w[y>>2]|0,G=y+4|0,T=w[G>>2]|0,Z=y+8|0,R=w[Z>>2]|0,B=T+(x<<1)|0,w[y>>2]=B,T=R+(T<<1)|0,w[G>>2]=T,x=(R<<1)+x|0,w[Z>>2]=x,R=T-B|0,(B|0)<0?(x=x-B|0,w[G>>2]=R,w[Z>>2]=x,w[y>>2]=0,T=R,R=0):R=B,(T|0)<0&&(R=R-T|0,w[y>>2]=R,x=x-T|0,w[Z>>2]=x,w[G>>2]=0,T=0),j=R-x|0,B=T-x|0,(x|0)<0?(w[y>>2]=j,w[G>>2]=B,w[Z>>2]=0,R=j,x=0):B=T,T=(B|0)<(R|0)?B:R,T=(x|0)<(T|0)?x:T,!((T|0)<=0)&&(w[y>>2]=R-T,w[G>>2]=B-T,w[Z>>2]=x-T)}function zf(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0;B=w[y>>2]|0,G=y+4|0,x=w[G>>2]|0,Z=y+8|0,T=w[Z>>2]|0,R=(x<<1)+B|0,B=T+(B<<1)|0,w[y>>2]=B,w[G>>2]=R,x=(T<<1)+x|0,w[Z>>2]=x,T=R-B|0,(B|0)<0?(x=x-B|0,w[G>>2]=T,w[Z>>2]=x,w[y>>2]=0,B=0):T=R,(T|0)<0&&(B=B-T|0,w[y>>2]=B,x=x-T|0,w[Z>>2]=x,w[G>>2]=0,T=0),j=B-x|0,R=T-x|0,(x|0)<0?(w[y>>2]=j,w[G>>2]=R,w[Z>>2]=0,B=j,x=0):R=T,T=(R|0)<(B|0)?R:B,T=(x|0)<(T|0)?x:T,!((T|0)<=0)&&(w[y>>2]=B-T,w[G>>2]=R-T,w[Z>>2]=x-T)}function Uf(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0;return G=(w[y>>2]|0)-(w[x>>2]|0)|0,Z=(G|0)<0,R=(w[y+4>>2]|0)-(w[x+4>>2]|0)-(Z?G:0)|0,j=(R|0)<0,B=(Z?0-G|0:0)+(w[y+8>>2]|0)-(w[x+8>>2]|0)+(j?0-R|0:0)|0,y=(B|0)<0,x=y?0:B,T=(j?0:R)-(y?B:0)|0,B=(Z?0:G)-(j?R:0)-(y?B:0)|0,y=(T|0)<(B|0)?T:B,y=(x|0)<(y|0)?x:y,R=(y|0)>0,x=x-(R?y:0)|0,T=T-(R?y:0)|0,y=B-(R?y:0)|0,y=(y|0)>-1?y:0-y|0,T=(T|0)>-1?T:0-T|0,x=(x|0)>-1?x:0-x|0,x=(T|0)>(x|0)?T:x,((y|0)>(x|0)?y:x)|0}function M_(y,x){y=y|0,x=x|0;var T=0;T=w[y+8>>2]|0,w[x>>2]=(w[y>>2]|0)-T,w[x+4>>2]=(w[y+4>>2]|0)-T}function Og(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0;R=w[y>>2]|0,w[x>>2]=R,y=w[y+4>>2]|0,G=x+4|0,w[G>>2]=y,Z=x+8|0,w[Z>>2]=0,T=y-R|0,(R|0)<0?(y=0-R|0,w[G>>2]=T,w[Z>>2]=y,w[x>>2]=0,R=0):(T=y,y=0),(T|0)<0&&(R=R-T|0,w[x>>2]=R,y=y-T|0,w[Z>>2]=y,w[G>>2]=0,T=0),j=R-y|0,B=T-y|0,(y|0)<0?(w[x>>2]=j,w[G>>2]=B,w[Z>>2]=0,T=B,B=j,y=0):B=R,R=(T|0)<(B|0)?T:B,R=(y|0)<(R|0)?y:R,!((R|0)<=0)&&(w[x>>2]=B-R,w[G>>2]=T-R,w[Z>>2]=y-R)}function Rg(y){y=y|0;var x=0,T=0,R=0,B=0;x=y+8|0,B=w[x>>2]|0,T=B-(w[y>>2]|0)|0,w[y>>2]=T,R=y+4|0,y=(w[R>>2]|0)-B|0,w[R>>2]=y,w[x>>2]=0-(y+T)}function PA(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0;T=w[y>>2]|0,x=0-T|0,w[y>>2]=x,G=y+8|0,w[G>>2]=0,Z=y+4|0,R=w[Z>>2]|0,B=R+T|0,(T|0)>0?(w[Z>>2]=B,w[G>>2]=T,w[y>>2]=0,x=0,R=B):T=0,(R|0)<0?(j=x-R|0,w[y>>2]=j,T=T-R|0,w[G>>2]=T,w[Z>>2]=0,B=j-T|0,x=0-T|0,(T|0)<0?(w[y>>2]=B,w[Z>>2]=x,w[G>>2]=0,R=x,T=0):(R=0,B=j)):B=x,x=(R|0)<(B|0)?R:B,x=(T|0)<(x|0)?T:x,!((x|0)<=0)&&(w[y>>2]=B-x,w[Z>>2]=R-x,w[G>>2]=T-x)}function qh(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0;R=Ve,Ve=Ve+16|0,B=R,Kr(y,x,T,B),Ff(B,T+4|0),Ve=R}function Kr(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0;var B=0,j=0,G=0,Z=0,ae=0;if(ae=Ve,Ve=Ve+32|0,j=ae,Qh(y,j),w[T>>2]=0,B=+Zi(15888,j),G=+Zi(15912,j),G<B&&(w[T>>2]=1,B=G),G=+Zi(15936,j),G<B&&(w[T>>2]=2,B=G),G=+Zi(15960,j),G<B&&(w[T>>2]=3,B=G),G=+Zi(15984,j),G<B&&(w[T>>2]=4,B=G),G=+Zi(16008,j),G<B&&(w[T>>2]=5,B=G),G=+Zi(16032,j),G<B&&(w[T>>2]=6,B=G),G=+Zi(16056,j),G<B&&(w[T>>2]=7,B=G),G=+Zi(16080,j),G<B&&(w[T>>2]=8,B=G),G=+Zi(16104,j),G<B&&(w[T>>2]=9,B=G),G=+Zi(16128,j),G<B&&(w[T>>2]=10,B=G),G=+Zi(16152,j),G<B&&(w[T>>2]=11,B=G),G=+Zi(16176,j),G<B&&(w[T>>2]=12,B=G),G=+Zi(16200,j),G<B&&(w[T>>2]=13,B=G),G=+Zi(16224,j),G<B&&(w[T>>2]=14,B=G),G=+Zi(16248,j),G<B&&(w[T>>2]=15,B=G),G=+Zi(16272,j),G<B&&(w[T>>2]=16,B=G),G=+Zi(16296,j),G<B&&(w[T>>2]=17,B=G),G=+Zi(16320,j),G<B&&(w[T>>2]=18,B=G),G=+Zi(16344,j),G<B&&(w[T>>2]=19,B=G),G=+ca(+(1-B*.5)),G<1e-16){w[R>>2]=0,w[R+4>>2]=0,w[R+8>>2]=0,w[R+12>>2]=0,Ve=ae;return}if(T=w[T>>2]|0,B=+Ue[16368+(T*24|0)>>3],B=+fu(B-+fu(+hp(15568+(T<<4)|0,y))),Ua(x)|0?Z=+fu(B+-.3334731722518321):Z=B,B=+ro(+G)/.381966011250105,(x|0)>0){j=0;do B=B*2.6457513110645907,j=j+1|0;while((j|0)!=(x|0))}G=+qr(+Z)*B,Ue[R>>3]=G,Z=+jn(+Z)*B,Ue[R+8>>3]=Z,Ve=ae}function cp(y,x,T,R,B){y=y|0,x=x|0,T=T|0,R=R|0,B=B|0;var j=0,G=0;if(j=+Qu(y),j<1e-16){x=15568+(x<<4)|0,w[B>>2]=w[x>>2],w[B+4>>2]=w[x+4>>2],w[B+8>>2]=w[x+8>>2],w[B+12>>2]=w[x+12>>2];return}if(G=+Qr(+ +Ue[y+8>>3],+ +Ue[y>>3]),(T|0)>0){y=0;do j=j/2.6457513110645907,y=y+1|0;while((y|0)!=(T|0))}R?(j=j/3,T=(Ua(T)|0)==0,j=+zl(+((T?j:j/2.6457513110645907)*.381966011250105))):(j=+zl(+(j*.381966011250105)),Ua(T)|0&&(G=+fu(G+.3334731722518321))),RA(15568+(x<<4)|0,+fu(+Ue[16368+(x*24|0)>>3]-G),j,B)}function IA(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0;R=Ve,Ve=Ve+16|0,B=R,qu(y+4|0,B),cp(B,w[y>>2]|0,x,0,T),Ve=R}function MA(y,x,T,R,B){y=y|0,x=x|0,T=T|0,R=R|0,B=B|0;var j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0,Vt=0,yn=0,Cn=0,Rt=0,fn=0,it=0,On=0,Bn=0,Pn=0,Mt=0,br=0,ui=0,Vr=0,Jr=0,qt=0,xi=0,$i=0,gr=0;if(xi=Ve,Ve=Ve+272|0,j=xi+256|0,Rt=xi+240|0,Vr=xi,Jr=xi+224|0,qt=xi+208|0,fn=xi+176|0,it=xi+160|0,On=xi+192|0,Bn=xi+144|0,Pn=xi+128|0,Mt=xi+112|0,br=xi+96|0,ui=xi+80|0,w[j>>2]=x,w[Rt>>2]=w[y>>2],w[Rt+4>>2]=w[y+4>>2],w[Rt+8>>2]=w[y+8>>2],w[Rt+12>>2]=w[y+12>>2],Lg(Rt,j,Vr),w[B>>2]=0,Rt=R+T+((R|0)==5&1)|0,(Rt|0)<=(T|0)){Ve=xi;return}ae=w[j>>2]|0,pe=Jr+4|0,_e=fn+4|0,Xe=T+5|0,tt=16848+(ae<<2)|0,gt=16928+(ae<<2)|0,kt=Pn+8|0,Vt=Mt+8|0,yn=br+8|0,Cn=qt+4|0,Z=T;e:for(;;){G=Vr+(((Z|0)%5|0)<<4)|0,w[qt>>2]=w[G>>2],w[qt+4>>2]=w[G+4>>2],w[qt+8>>2]=w[G+8>>2],w[qt+12>>2]=w[G+12>>2];do;while((Gf(qt,ae,0,1)|0)==2);if((Z|0)>(T|0)&(Ua(x)|0)!=0){if(w[fn>>2]=w[qt>>2],w[fn+4>>2]=w[qt+4>>2],w[fn+8>>2]=w[qt+8>>2],w[fn+12>>2]=w[qt+12>>2],qu(pe,it),R=w[fn>>2]|0,j=w[17008+(R*80|0)+(w[Jr>>2]<<2)>>2]|0,w[fn>>2]=w[18608+(R*80|0)+(j*20|0)>>2],G=w[18608+(R*80|0)+(j*20|0)+16>>2]|0,(G|0)>0){y=0;do zc(_e),y=y+1|0;while((y|0)<(G|0))}switch(G=18608+(R*80|0)+(j*20|0)+4|0,w[On>>2]=w[G>>2],w[On+4>>2]=w[G+4>>2],w[On+8>>2]=w[G+8>>2],Xu(On,(w[tt>>2]|0)*3|0),xs(_e,On,_e),li(_e),qu(_e,Bn),$i=+(w[gt>>2]|0),Ue[Pn>>3]=$i*3,Ue[kt>>3]=0,gr=$i*-1.5,Ue[Mt>>3]=gr,Ue[Vt>>3]=$i*2.598076211353316,Ue[br>>3]=gr,Ue[yn>>3]=$i*-2.598076211353316,w[17008+((w[fn>>2]|0)*80|0)+(w[qt>>2]<<2)>>2]|0){case 1:{y=Mt,R=Pn;break}case 3:{y=br,R=Mt;break}case 2:{y=Pn,R=br;break}default:{y=12;break e}}VA(it,Bn,R,y,ui),cp(ui,w[fn>>2]|0,ae,1,B+8+(w[B>>2]<<4)|0),w[B>>2]=(w[B>>2]|0)+1}if((Z|0)<(Xe|0)&&(qu(Cn,fn),cp(fn,w[qt>>2]|0,ae,1,B+8+(w[B>>2]<<4)|0),w[B>>2]=(w[B>>2]|0)+1),w[Jr>>2]=w[qt>>2],w[Jr+4>>2]=w[qt+4>>2],w[Jr+8>>2]=w[qt+8>>2],w[Jr+12>>2]=w[qt+12>>2],Z=Z+1|0,(Z|0)>=(Rt|0)){y=3;break}}if((y|0)==3){Ve=xi;return}else(y|0)==12&&pt(22474,22521,581,22531)}function Lg(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0,ae=0;ae=Ve,Ve=Ve+128|0,R=ae+64|0,B=ae,j=R,G=20208,Z=j+60|0;do w[j>>2]=w[G>>2],j=j+4|0,G=G+4|0;while((j|0)<(Z|0));j=B,G=20272,Z=j+60|0;do w[j>>2]=w[G>>2],j=j+4|0,G=G+4|0;while((j|0)<(Z|0));Z=(Ua(w[x>>2]|0)|0)==0,R=Z?R:B,B=y+4|0,up(B),zf(B),Ua(w[x>>2]|0)|0&&(Ds(B),w[x>>2]=(w[x>>2]|0)+1),w[T>>2]=w[y>>2],x=T+4|0,xs(B,R,x),li(x),w[T+16>>2]=w[y>>2],x=T+20|0,xs(B,R+12|0,x),li(x),w[T+32>>2]=w[y>>2],x=T+36|0,xs(B,R+24|0,x),li(x),w[T+48>>2]=w[y>>2],x=T+52|0,xs(B,R+36|0,x),li(x),w[T+64>>2]=w[y>>2],T=T+68|0,xs(B,R+48|0,T),li(T),Ve=ae}function Gf(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0;var B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0;if(kt=Ve,Ve=Ve+32|0,tt=kt+12|0,Z=kt,gt=y+4|0,Xe=w[16928+(x<<2)>>2]|0,_e=(R|0)!=0,Xe=_e?Xe*3|0:Xe,B=w[gt>>2]|0,pe=y+8|0,G=w[pe>>2]|0,_e){if(j=y+12|0,R=w[j>>2]|0,B=G+B+R|0,(B|0)==(Xe|0))return gt=1,Ve=kt,gt|0;ae=j}else ae=y+12|0,R=w[ae>>2]|0,B=G+B+R|0;if((B|0)<=(Xe|0))return gt=0,Ve=kt,gt|0;do if((R|0)>0){if(R=w[y>>2]|0,(G|0)>0){j=18608+(R*80|0)+60|0,R=y;break}R=18608+(R*80|0)+40|0,T?(CA(tt,Xe,0,0),Ul(gt,tt,Z),ol(Z),xs(Z,tt,gt),j=R,R=y):(j=R,R=y)}else j=18608+((w[y>>2]|0)*80|0)+20|0,R=y;while(0);if(w[R>>2]=w[j>>2],B=j+16|0,(w[B>>2]|0)>0){R=0;do zc(gt),R=R+1|0;while((R|0)<(w[B>>2]|0))}return y=j+4|0,w[tt>>2]=w[y>>2],w[tt+4>>2]=w[y+4>>2],w[tt+8>>2]=w[y+8>>2],x=w[16848+(x<<2)>>2]|0,Xu(tt,_e?x*3|0:x),xs(gt,tt,gt),li(gt),_e?R=((w[pe>>2]|0)+(w[gt>>2]|0)+(w[ae>>2]|0)|0)==(Xe|0)?1:2:R=2,gt=R,Ve=kt,gt|0}function OA(y,x){y=y|0,x=x|0;var T=0;do T=Gf(y,x,0,1)|0;while((T|0)==2);return T|0}function jf(y,x,T,R,B){y=y|0,x=x|0,T=T|0,R=R|0,B=B|0;var j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0,Vt=0,yn=0,Cn=0,Rt=0,fn=0,it=0,On=0,Bn=0,Pn=0,Mt=0,br=0,ui=0,Vr=0;if(br=Ve,Ve=Ve+240|0,j=br+224|0,On=br+208|0,Bn=br,Pn=br+192|0,Mt=br+176|0,yn=br+160|0,Cn=br+144|0,Rt=br+128|0,fn=br+112|0,it=br+96|0,w[j>>2]=x,w[On>>2]=w[y>>2],w[On+4>>2]=w[y+4>>2],w[On+8>>2]=w[y+8>>2],w[On+12>>2]=w[y+12>>2],fp(On,j,Bn),w[B>>2]=0,Vt=R+T+((R|0)==6&1)|0,(Vt|0)<=(T|0)){Ve=br;return}ae=w[j>>2]|0,pe=T+6|0,_e=16928+(ae<<2)|0,Xe=Cn+8|0,tt=Rt+8|0,gt=fn+8|0,kt=Pn+4|0,G=0,Z=T,R=-1;e:for(;;){if(j=(Z|0)%6|0,y=Bn+(j<<4)|0,w[Pn>>2]=w[y>>2],w[Pn+4>>2]=w[y+4>>2],w[Pn+8>>2]=w[y+8>>2],w[Pn+12>>2]=w[y+12>>2],y=G,G=Gf(Pn,ae,0,1)|0,(Z|0)>(T|0)&(Ua(x)|0)!=0&&(y|0)!=1&&(w[Pn>>2]|0)!=(R|0)){switch(qu(Bn+(((j+5|0)%6|0)<<4)+4|0,Mt),qu(Bn+(j<<4)+4|0,yn),ui=+(w[_e>>2]|0),Ue[Cn>>3]=ui*3,Ue[Xe>>3]=0,Vr=ui*-1.5,Ue[Rt>>3]=Vr,Ue[tt>>3]=ui*2.598076211353316,Ue[fn>>3]=Vr,Ue[gt>>3]=ui*-2.598076211353316,j=w[On>>2]|0,w[17008+(j*80|0)+(((R|0)==(j|0)?w[Pn>>2]|0:R)<<2)>>2]|0){case 1:{y=Rt,R=Cn;break}case 3:{y=fn,R=Rt;break}case 2:{y=Cn,R=fn;break}default:{y=8;break e}}VA(Mt,yn,R,y,it),!(wp(Mt,it)|0)&&!(wp(yn,it)|0)&&(cp(it,w[On>>2]|0,ae,1,B+8+(w[B>>2]<<4)|0),w[B>>2]=(w[B>>2]|0)+1)}if((Z|0)<(pe|0)&&(qu(kt,Mt),cp(Mt,w[Pn>>2]|0,ae,1,B+8+(w[B>>2]<<4)|0),w[B>>2]=(w[B>>2]|0)+1),Z=Z+1|0,(Z|0)>=(Vt|0)){y=3;break}else R=w[Pn>>2]|0}if((y|0)==3){Ve=br;return}else(y|0)==8&&pt(22557,22521,746,22602)}function fp(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0,ae=0;ae=Ve,Ve=Ve+160|0,R=ae+80|0,B=ae,j=R,G=20336,Z=j+72|0;do w[j>>2]=w[G>>2],j=j+4|0,G=G+4|0;while((j|0)<(Z|0));j=B,G=20416,Z=j+72|0;do w[j>>2]=w[G>>2],j=j+4|0,G=G+4|0;while((j|0)<(Z|0));Z=(Ua(w[x>>2]|0)|0)==0,R=Z?R:B,B=y+4|0,up(B),zf(B),Ua(w[x>>2]|0)|0&&(Ds(B),w[x>>2]=(w[x>>2]|0)+1),w[T>>2]=w[y>>2],x=T+4|0,xs(B,R,x),li(x),w[T+16>>2]=w[y>>2],x=T+20|0,xs(B,R+12|0,x),li(x),w[T+32>>2]=w[y>>2],x=T+36|0,xs(B,R+24|0,x),li(x),w[T+48>>2]=w[y>>2],x=T+52|0,xs(B,R+36|0,x),li(x),w[T+64>>2]=w[y>>2],x=T+68|0,xs(B,R+48|0,x),li(x),w[T+80>>2]=w[y>>2],T=T+84|0,xs(B,R+60|0,T),li(T),Ve=ae}function fu(y){y=+y;var x=0;return x=y<0?y+6.283185307179586:y,+(y>=6.283185307179586?x+-6.283185307179586:x)}function pa(y,x){return y=y|0,x=x|0,+rr(+(+Ue[y>>3]-+Ue[x>>3]))<17453292519943298e-27?(x=+rr(+(+Ue[y+8>>3]-+Ue[x+8>>3]))<17453292519943298e-27,x|0):(x=0,x|0)}function Vf(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0;return B=+Ue[x>>3],R=+Ue[y>>3],j=+jn(+((B-R)*.5)),T=+jn(+((+Ue[x+8>>3]-+Ue[y+8>>3])*.5)),T=j*j+T*(+qr(+B)*+qr(+R)*T),+(+Qr(+ +Tr(+T),+ +Tr(+(1-T)))*2)}function Uc(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0;return B=+Ue[x>>3],R=+Ue[y>>3],j=+jn(+((B-R)*.5)),T=+jn(+((+Ue[x+8>>3]-+Ue[y+8>>3])*.5)),T=j*j+T*(+qr(+B)*+qr(+R)*T),+(+Qr(+ +Tr(+T),+ +Tr(+(1-T)))*2*6371.007180918475)}function O_(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0;return B=+Ue[x>>3],R=+Ue[y>>3],j=+jn(+((B-R)*.5)),T=+jn(+((+Ue[x+8>>3]-+Ue[y+8>>3])*.5)),T=j*j+T*(+qr(+B)*+qr(+R)*T),+(+Qr(+ +Tr(+T),+ +Tr(+(1-T)))*2*6371.007180918475*1e3)}function hp(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0;return j=+Ue[x>>3],R=+qr(+j),B=+Ue[x+8>>3]-+Ue[y+8>>3],G=R*+jn(+B),T=+Ue[y>>3],+ +Qr(+G,+(+jn(+j)*+qr(+T)-+qr(+B)*(R*+jn(+T))))}function RA(y,x,T,R){y=y|0,x=+x,T=+T,R=R|0;var B=0,j=0,G=0,Z=0;if(T<1e-16){w[R>>2]=w[y>>2],w[R+4>>2]=w[y+4>>2],w[R+8>>2]=w[y+8>>2],w[R+12>>2]=w[y+12>>2];return}j=x<0?x+6.283185307179586:x,j=x>=6.283185307179586?j+-6.283185307179586:j;do if(j<1e-16)x=+Ue[y>>3]+T,Ue[R>>3]=x,B=R;else{if(B=+rr(+(j+-3.141592653589793))<1e-16,x=+Ue[y>>3],B){x=x-T,Ue[R>>3]=x,B=R;break}if(G=+qr(+T),T=+jn(+T),x=G*+jn(+x)+ +qr(+j)*(T*+qr(+x)),x=x>1?1:x,x=+kc(+(x<-1?-1:x)),Ue[R>>3]=x,+rr(+(x+-1.5707963267948966))<1e-16){Ue[R>>3]=1.5707963267948966,Ue[R+8>>3]=0;return}if(+rr(+(x+1.5707963267948966))<1e-16){Ue[R>>3]=-1.5707963267948966,Ue[R+8>>3]=0;return}if(Z=+qr(+x),j=T*+jn(+j)/Z,T=+Ue[y>>3],x=(G-+jn(+x)*+jn(+T))/+qr(+T)/Z,G=j>1?1:j,x=x>1?1:x,x=+Ue[y+8>>3]+ +Qr(+(G<-1?-1:G),+(x<-1?-1:x)),x>3.141592653589793)do x=x+-6.283185307179586;while(x>3.141592653589793);if(x<-3.141592653589793)do x=x+6.283185307179586;while(x<-3.141592653589793);Ue[R+8>>3]=x;return}while(0);if(+rr(+(x+-1.5707963267948966))<1e-16){Ue[B>>3]=1.5707963267948966,Ue[R+8>>3]=0;return}if(+rr(+(x+1.5707963267948966))<1e-16){Ue[B>>3]=-1.5707963267948966,Ue[R+8>>3]=0;return}if(x=+Ue[y+8>>3],x>3.141592653589793)do x=x+-6.283185307179586;while(x>3.141592653589793);if(x<-3.141592653589793)do x=x+6.283185307179586;while(x<-3.141592653589793);Ue[R+8>>3]=x}function LA(y){return y=y|0,+ +Ue[20496+(y<<3)>>3]}function Dg(y){return y=y|0,+ +Ue[20624+(y<<3)>>3]}function Bg(y){return y=y|0,+ +Ue[20752+(y<<3)>>3]}function DA(y){return y=y|0,+ +Ue[20880+(y<<3)>>3]}function jr(y){y=y|0;var x=0;return x=21008+(y<<3)|0,y=w[x>>2]|0,Hn(w[x+4>>2]|0),y|0}function hu(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0;return tt=+Ue[x>>3],_e=+Ue[y>>3],ae=+jn(+((tt-_e)*.5)),j=+Ue[x+8>>3],pe=+Ue[y+8>>3],G=+jn(+((j-pe)*.5)),Z=+qr(+_e),Xe=+qr(+tt),G=ae*ae+G*(Xe*Z*G),G=+Qr(+ +Tr(+G),+ +Tr(+(1-G)))*2,ae=+Ue[T>>3],tt=+jn(+((ae-tt)*.5)),R=+Ue[T+8>>3],j=+jn(+((R-j)*.5)),B=+qr(+ae),j=tt*tt+j*(Xe*B*j),j=+Qr(+ +Tr(+j),+ +Tr(+(1-j)))*2,ae=+jn(+((_e-ae)*.5)),R=+jn(+((pe-R)*.5)),R=ae*ae+R*(Z*B*R),R=+Qr(+ +Tr(+R),+ +Tr(+(1-R)))*2,B=(G+j+R)*.5,+(+zl(+ +Tr(+(+ro(+(B*.5))*+ro(+((B-G)*.5))*+ro(+((B-j)*.5))*+ro(+((B-R)*.5)))))*4)}function R_(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0;if(j=Ve,Ve=Ve+192|0,R=j+168|0,B=j,du(y,x,R),jl(y,x,B),x=w[B>>2]|0,(x|0)<=0)return T=0,Ve=j,+T;if(T=+hu(B+8|0,B+8+(((x|0)!=1&1)<<4)|0,R)+0,(x|0)==1)return Ve=j,+T;y=1;do G=y,y=y+1|0,T=T+ +hu(B+8+(G<<4)|0,B+8+(((y|0)%(x|0)|0)<<4)|0,R);while((y|0)<(x|0));return Ve=j,+T}function BA(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0;if(j=Ve,Ve=Ve+192|0,R=j+168|0,B=j,du(y,x,R),jl(y,x,B),x=w[B>>2]|0,(x|0)>0){if(T=+hu(B+8|0,B+8+(((x|0)!=1&1)<<4)|0,R)+0,(x|0)!=1){y=1;do G=y,y=y+1|0,T=T+ +hu(B+8+(G<<4)|0,B+8+(((y|0)%(x|0)|0)<<4)|0,R);while((y|0)<(x|0))}}else T=0;return Ve=j,+(T*6371.007180918475*6371.007180918475)}function L_(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0;if(j=Ve,Ve=Ve+192|0,R=j+168|0,B=j,du(y,x,R),jl(y,x,B),x=w[B>>2]|0,(x|0)>0){if(T=+hu(B+8|0,B+8+(((x|0)!=1&1)<<4)|0,R)+0,(x|0)!=1){y=1;do G=y,y=y+1|0,T=T+ +hu(B+8+(G<<4)|0,B+8+(((y|0)%(x|0)|0)<<4)|0,R);while((y|0)<(x|0))}}else T=0;return Ve=j,+(T*6371.007180918475*6371.007180918475*1e3*1e3)}function $f(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0;if(G=Ve,Ve=Ve+176|0,j=G,jg(y,x,j),y=w[j>>2]|0,(y|0)<=1)return B=0,Ve=G,+B;x=y+-1|0,y=0,T=0,R=+Ue[j+8>>3],B=+Ue[j+16>>3];do y=y+1|0,ae=R,R=+Ue[j+8+(y<<4)>>3],pe=+jn(+((R-ae)*.5)),Z=B,B=+Ue[j+8+(y<<4)+8>>3],Z=+jn(+((B-Z)*.5)),Z=pe*pe+Z*(+qr(+R)*+qr(+ae)*Z),T=T+ +Qr(+ +Tr(+Z),+ +Tr(+(1-Z)))*2;while((y|0)<(x|0));return Ve=G,+T}function NA(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0;if(G=Ve,Ve=Ve+176|0,j=G,jg(y,x,j),y=w[j>>2]|0,(y|0)<=1)return B=0,Ve=G,+B;x=y+-1|0,y=0,T=0,R=+Ue[j+8>>3],B=+Ue[j+16>>3];do y=y+1|0,ae=R,R=+Ue[j+8+(y<<4)>>3],pe=+jn(+((R-ae)*.5)),Z=B,B=+Ue[j+8+(y<<4)+8>>3],Z=+jn(+((B-Z)*.5)),Z=pe*pe+Z*(+qr(+ae)*+qr(+R)*Z),T=T+ +Qr(+ +Tr(+Z),+ +Tr(+(1-Z)))*2;while((y|0)!=(x|0));return pe=T*6371.007180918475,Ve=G,+pe}function ox(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0;if(G=Ve,Ve=Ve+176|0,j=G,jg(y,x,j),y=w[j>>2]|0,(y|0)<=1)return B=0,Ve=G,+B;x=y+-1|0,y=0,T=0,R=+Ue[j+8>>3],B=+Ue[j+16>>3];do y=y+1|0,ae=R,R=+Ue[j+8+(y<<4)>>3],pe=+jn(+((R-ae)*.5)),Z=B,B=+Ue[j+8+(y<<4)+8>>3],Z=+jn(+((B-Z)*.5)),Z=pe*pe+Z*(+qr(+ae)*+qr(+R)*Z),T=T+ +Qr(+ +Tr(+Z),+ +Tr(+(1-Z)))*2;while((y|0)!=(x|0));return pe=T*6371.007180918475*1e3,Ve=G,+pe}function sx(y,x){return y=y|0,x=x|0,x=An(y|0,x|0,52)|0,Ke()|0,x&15|0}function D_(y,x){return y=y|0,x=x|0,x=An(y|0,x|0,45)|0,Ke()|0,x&127|0}function Ng(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0;if(!(!0&(x&-16777216|0)==134217728)||(G=An(y|0,x|0,45)|0,Ke()|0,G=G&127,G>>>0>121))return x=0,x|0;T=An(y|0,x|0,52)|0,Ke()|0,T=T&15;do if(T|0){for(B=1,R=0;;){if(j=An(y|0,x|0,(15-B|0)*3|0)|0,Ke()|0,j=j&7,(j|0)!=0&(R^1))if((j|0)==1&(Lr(G)|0)!=0){Z=0,R=13;break}else R=1;if((j|0)==7){Z=0,R=13;break}if(B>>>0<T>>>0)B=B+1|0;else{R=9;break}}if((R|0)==9){if((T|0)==15)Z=1;else break;return Z|0}else if((R|0)==13)return Z|0}while(0);for(;;){if(Z=An(y|0,x|0,(14-T|0)*3|0)|0,Ke()|0,!((Z&7|0)==7&!0)){Z=0,R=13;break}if(T>>>0<14)T=T+1|0;else{Z=1,R=13;break}}return(R|0)==13?Z|0:0}function dp(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0;if(R=An(y|0,x|0,52)|0,Ke()|0,R=R&15,(R|0)>=(T|0)){if((R|0)!=(T|0))if(T>>>0<=15){if(B=Dn(T|0,0,52)|0,y=B|y,x=Ke()|0|x&-15728641,(R|0)>(T|0))do B=Dn(7,0,(14-T|0)*3|0)|0,T=T+1|0,y=B|y,x=Ke()|0|x;while((T|0)<(R|0))}else x=0,y=0}else x=0,y=0;return Hn(x|0),y|0}function FA(y,x,T){return y=y|0,x=x|0,T=T|0,y=An(y|0,x|0,52)|0,Ke()|0,y=y&15,(T|0)<16&(y|0)<=(T|0)?(T=xp(7,T-y|0)|0,T|0):(T=0,T|0)}function bs(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0;var B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0;if(G=An(y|0,x|0,52)|0,Ke()|0,G=G&15,!!((T|0)<16&(G|0)<=(T|0))){if((G|0)==(T|0)){T=R,w[T>>2]=y,w[T+4>>2]=x;return}if(ae=xp(7,T-G|0)|0,pe=(ae|0)/7|0,Z=An(y|0,x|0,45)|0,Ke()|0,!(Lr(Z&127)|0))j=0;else{e:do if(!G)B=0;else for(j=1;;){if(B=An(y|0,x|0,(15-j|0)*3|0)|0,Ke()|0,B=B&7,B|0)break e;if(j>>>0<G>>>0)j=j+1|0;else{B=0;break}}while(0);j=(B|0)==0}if(_e=Dn(G+1|0,0,52)|0,B=Ke()|0|x&-15728641,Z=(14-G|0)*3|0,x=Dn(7,0,Z|0)|0,x=(_e|y)&~x,G=B&~(Ke()|0),bs(x,G,T,R),B=R+(pe<<3)|0,!j){_e=Dn(1,0,Z|0)|0,bs(_e|x,Ke()|0|G,T,B),_e=B+(pe<<3)|0,ae=Dn(2,0,Z|0)|0,bs(ae|x,Ke()|0|G,T,_e),_e=_e+(pe<<3)|0,ae=Dn(3,0,Z|0)|0,bs(ae|x,Ke()|0|G,T,_e),_e=_e+(pe<<3)|0,ae=Dn(4,0,Z|0)|0,bs(ae|x,Ke()|0|G,T,_e),_e=_e+(pe<<3)|0,ae=Dn(5,0,Z|0)|0,bs(ae|x,Ke()|0|G,T,_e),ae=Dn(6,0,Z|0)|0,bs(ae|x,Ke()|0|G,T,_e+(pe<<3)|0);return}j=B+(pe<<3)|0,(ae|0)>6&&(ae=B+8|0,_e=(j>>>0>ae>>>0?j:ae)+-1+(0-B)|0,Aa(B|0,0,_e+8&-8|0)|0,B=ae+(_e>>>3<<3)|0),_e=Dn(2,0,Z|0)|0,bs(_e|x,Ke()|0|G,T,B),_e=B+(pe<<3)|0,ae=Dn(3,0,Z|0)|0,bs(ae|x,Ke()|0|G,T,_e),_e=_e+(pe<<3)|0,ae=Dn(4,0,Z|0)|0,bs(ae|x,Ke()|0|G,T,_e),_e=_e+(pe<<3)|0,ae=Dn(5,0,Z|0)|0,bs(ae|x,Ke()|0|G,T,_e),ae=Dn(6,0,Z|0)|0,bs(ae|x,Ke()|0|G,T,_e+(pe<<3)|0)}}function No(y,x){y=y|0,x=x|0;var T=0,R=0,B=0;if(B=An(y|0,x|0,45)|0,Ke()|0,!(Lr(B&127)|0))return B=0,B|0;B=An(y|0,x|0,52)|0,Ke()|0,B=B&15;e:do if(!B)T=0;else for(R=1;;){if(T=An(y|0,x|0,(15-R|0)*3|0)|0,Ke()|0,T=T&7,T|0)break e;if(R>>>0<B>>>0)R=R+1|0;else{T=0;break}}while(0);return B=(T|0)==0&1,B|0}function B_(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0;if(R=An(y|0,x|0,52)|0,Ke()|0,R=R&15,(T|0)<16&(R|0)<=(T|0)){if((R|0)!=(T|0)&&(B=Dn(T|0,0,52)|0,y=B|y,x=Ke()|0|x&-15728641,(R|0)<(T|0)))do B=Dn(7,0,(14-R|0)*3|0)|0,R=R+1|0,y=y&~B,x=x&~(Ke()|0);while((R|0)<(T|0))}else x=0,y=0;return Hn(x|0),y|0}function ax(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0,Vt=0,yn=0,Cn=0,Rt=0,fn=0,it=0,On=0,Bn=0,Pn=0,Mt=0;if(!T)return Pn=0,Pn|0;if(B=y,R=w[B>>2]|0,B=w[B+4>>2]|0,!0&(B&15728640|0)==0){if((T|0)<=0||(Pn=x,w[Pn>>2]=R,w[Pn+4>>2]=B,(T|0)==1))return Pn=0,Pn|0;R=1;do On=y+(R<<3)|0,Bn=w[On+4>>2]|0,Pn=x+(R<<3)|0,w[Pn>>2]=w[On>>2],w[Pn+4>>2]=Bn,R=R+1|0;while((R|0)!=(T|0));return R=0,R|0}if(On=T<<3,Bn=Ga(On)|0,!Bn)return Pn=-3,Pn|0;if(ed(Bn|0,y|0,On|0)|0,it=ma(T,8)|0,!it)return Mr(Bn),Pn=-3,Pn|0;R=T;e:for(;;){G=Bn,_e=w[G>>2]|0,G=w[G+4>>2]|0,Rt=An(_e|0,G|0,52)|0,Ke()|0,Rt=Rt&15,fn=Rt+-1|0,Cn=(R|0)>0;t:do if(Cn){if(yn=((R|0)<0)<<31>>31,kt=Dn(fn|0,0,52)|0,Vt=Ke()|0,fn>>>0>15)for(B=0,y=_e,T=G;;){if(!((y|0)==0&(T|0)==0)){if(j=An(y|0,T|0,52)|0,Ke()|0,j=j&15,Z=(j|0)<(fn|0),j=(j|0)==(fn|0),pe=Z?0:j?y:0,y=Z?0:j?T:0,T=Hc(pe|0,y|0,R|0,yn|0)|0,Ke()|0,j=it+(T<<3)|0,Z=j,ae=w[Z>>2]|0,Z=w[Z+4>>2]|0,(ae|0)==0&(Z|0)==0)T=pe;else for(kt=0,gt=T,tt=Z,T=pe;;){if((kt|0)>(R|0)){Pn=41;break e}if((ae|0)==(T|0)&(tt&-117440513|0)==(y|0)){pe=An(ae|0,tt|0,56)|0,Ke()|0,pe=pe&7,Xe=pe+1|0,Vt=An(ae|0,tt|0,45)|0,Ke()|0;n:do if(!(Lr(Vt&127)|0))Z=7;else{if(ae=An(ae|0,tt|0,52)|0,Ke()|0,ae=ae&15,!ae){Z=6;break}for(Z=1;;){if(Vt=Dn(7,0,(15-Z|0)*3|0)|0,!((Vt&T|0)==0&((Ke()|0)&y|0)==0)){Z=7;break n}if(Z>>>0<ae>>>0)Z=Z+1|0;else{Z=6;break}}}while(0);if((pe+2|0)>>>0>Z>>>0){Pn=51;break e}Vt=Dn(Xe|0,0,56)|0,y=Ke()|0|y&-117440513,Z=j,w[Z>>2]=0,w[Z+4>>2]=0,Z=gt,T=Vt|T}else Z=(gt+1|0)%(R|0)|0;if(j=it+(Z<<3)|0,tt=j,ae=w[tt>>2]|0,tt=w[tt+4>>2]|0,(ae|0)==0&(tt|0)==0)break;kt=kt+1|0,gt=Z}Vt=j,w[Vt>>2]=T,w[Vt+4>>2]=y}if(B=B+1|0,(B|0)>=(R|0))break t;T=Bn+(B<<3)|0,y=w[T>>2]|0,T=w[T+4>>2]|0}for(B=0,y=_e,T=G;;){if(!((y|0)==0&(T|0)==0)){if(Z=An(y|0,T|0,52)|0,Ke()|0,Z=Z&15,(Z|0)>=(fn|0)){if((Z|0)!=(fn|0)&&(y=y|kt,T=T&-15728641|Vt,Z>>>0>=Rt>>>0)){j=fn;do gt=Dn(7,0,(14-j|0)*3|0)|0,j=j+1|0,y=gt|y,T=Ke()|0|T;while(j>>>0<Z>>>0)}}else y=0,T=0;if(Z=Hc(y|0,T|0,R|0,yn|0)|0,Ke()|0,j=it+(Z<<3)|0,ae=j,pe=w[ae>>2]|0,ae=w[ae+4>>2]|0,!((pe|0)==0&(ae|0)==0))for(gt=0;;){if((gt|0)>(R|0)){Pn=41;break e}if((pe|0)==(y|0)&(ae&-117440513|0)==(T|0)){Xe=An(pe|0,ae|0,56)|0,Ke()|0,Xe=Xe&7,tt=Xe+1|0,Mt=An(pe|0,ae|0,45)|0,Ke()|0;n:do if(!(Lr(Mt&127)|0))ae=7;else{if(pe=An(pe|0,ae|0,52)|0,Ke()|0,pe=pe&15,!pe){ae=6;break}for(ae=1;;){if(Mt=Dn(7,0,(15-ae|0)*3|0)|0,!((Mt&y|0)==0&((Ke()|0)&T|0)==0)){ae=7;break n}if(ae>>>0<pe>>>0)ae=ae+1|0;else{ae=6;break}}}while(0);if((Xe+2|0)>>>0>ae>>>0){Pn=51;break e}Mt=Dn(tt|0,0,56)|0,T=Ke()|0|T&-117440513,tt=j,w[tt>>2]=0,w[tt+4>>2]=0,y=Mt|y}else Z=(Z+1|0)%(R|0)|0;if(j=it+(Z<<3)|0,ae=j,pe=w[ae>>2]|0,ae=w[ae+4>>2]|0,(pe|0)==0&(ae|0)==0)break;gt=gt+1|0}Mt=j,w[Mt>>2]=y,w[Mt+4>>2]=T}if(B=B+1|0,(B|0)>=(R|0))break t;T=Bn+(B<<3)|0,y=w[T>>2]|0,T=w[T+4>>2]|0}}while(0);if((R+5|0)>>>0<11){Pn=99;break}if(Vt=ma((R|0)/6|0,8)|0,!Vt){Pn=58;break}t:do if(Cn){gt=0,tt=0;do{if(Z=it+(gt<<3)|0,y=Z,B=w[y>>2]|0,y=w[y+4>>2]|0,!((B|0)==0&(y|0)==0)){ae=An(B|0,y|0,56)|0,Ke()|0,ae=ae&7,T=ae+1|0,pe=y&-117440513,Mt=An(B|0,y|0,45)|0,Ke()|0;n:do if(Lr(Mt&127)|0){if(Xe=An(B|0,y|0,52)|0,Ke()|0,Xe=Xe&15,Xe|0)for(j=1;;){if(Mt=Dn(7,0,(15-j|0)*3|0)|0,!((B&Mt|0)==0&(pe&(Ke()|0)|0)==0))break n;if(j>>>0<Xe>>>0)j=j+1|0;else break}y=Dn(T|0,0,56)|0,B=y|B,y=Ke()|0|pe,T=Z,w[T>>2]=B,w[T+4>>2]=y,T=ae+2|0}while(0);(T|0)==7&&(Mt=Vt+(tt<<3)|0,w[Mt>>2]=B,w[Mt+4>>2]=y&-117440513,tt=tt+1|0)}gt=gt+1|0}while((gt|0)!=(R|0));if(Cn){if(kt=((R|0)<0)<<31>>31,Xe=Dn(fn|0,0,52)|0,gt=Ke()|0,fn>>>0>15)for(y=0,B=0;;){do if(!((_e|0)==0&(G|0)==0)){for(ae=An(_e|0,G|0,52)|0,Ke()|0,ae=ae&15,j=(ae|0)<(fn|0),ae=(ae|0)==(fn|0),Z=j?0:ae?_e:0,ae=j?0:ae?G:0,j=Hc(Z|0,ae|0,R|0,kt|0)|0,Ke()|0,T=0;;){if((T|0)>(R|0)){Pn=98;break e}if(Mt=it+(j<<3)|0,pe=w[Mt+4>>2]|0,(pe&-117440513|0)==(ae|0)&&(w[Mt>>2]|0)==(Z|0)){Pn=70;break}if(j=(j+1|0)%(R|0)|0,Mt=it+(j<<3)|0,(w[Mt>>2]|0)==(Z|0)&&(w[Mt+4>>2]|0)==(ae|0))break;T=T+1|0}if((Pn|0)==70&&(Pn=0,!0&(pe&117440512|0)==100663296))break;Mt=x+(B<<3)|0,w[Mt>>2]=_e,w[Mt+4>>2]=G,B=B+1|0}while(0);if(y=y+1|0,(y|0)>=(R|0)){R=tt;break t}G=Bn+(y<<3)|0,_e=w[G>>2]|0,G=w[G+4>>2]|0}for(y=0,B=0;;){do if(!((_e|0)==0&(G|0)==0)){if(ae=An(_e|0,G|0,52)|0,Ke()|0,ae=ae&15,(ae|0)>=(fn|0))if((ae|0)!=(fn|0))if(T=_e|Xe,j=G&-15728641|gt,ae>>>0<Rt>>>0)ae=j;else{Z=fn;do Mt=Dn(7,0,(14-Z|0)*3|0)|0,Z=Z+1|0,T=Mt|T,j=Ke()|0|j;while(Z>>>0<ae>>>0);ae=j}else T=_e,ae=G;else T=0,ae=0;for(Z=Hc(T|0,ae|0,R|0,kt|0)|0,Ke()|0,j=0;;){if((j|0)>(R|0)){Pn=98;break e}if(Mt=it+(Z<<3)|0,pe=w[Mt+4>>2]|0,(pe&-117440513|0)==(ae|0)&&(w[Mt>>2]|0)==(T|0)){Pn=93;break}if(Z=(Z+1|0)%(R|0)|0,Mt=it+(Z<<3)|0,(w[Mt>>2]|0)==(T|0)&&(w[Mt+4>>2]|0)==(ae|0))break;j=j+1|0}if((Pn|0)==93&&(Pn=0,!0&(pe&117440512|0)==100663296))break;Mt=x+(B<<3)|0,w[Mt>>2]=_e,w[Mt+4>>2]=G,B=B+1|0}while(0);if(y=y+1|0,(y|0)>=(R|0)){R=tt;break t}G=Bn+(y<<3)|0,_e=w[G>>2]|0,G=w[G+4>>2]|0}}else B=0,R=tt}else B=0,R=0;while(0);if(Aa(it|0,0,On|0)|0,ed(Bn|0,Vt|0,R<<3|0)|0,Mr(Vt),R)x=x+(B<<3)|0;else break}return(Pn|0)==41?(Mr(Bn),Mr(it),Mt=-1,Mt|0):(Pn|0)==51?(Mr(Bn),Mr(it),Mt=-2,Mt|0):(Pn|0)==58?(Mr(Bn),Mr(it),Mt=-3,Mt|0):(Pn|0)==98?(Mr(Vt),Mr(Bn),Mr(it),Mt=-1,Mt|0):((Pn|0)==99&&ed(x|0,Bn|0,R<<3|0)|0,Mr(Bn),Mr(it),Mt=0,Mt|0)}function pp(y,x,T,R,B){y=y|0,x=x|0,T=T|0,R=R|0,B=B|0;var j=0,G=0,Z=0,ae=0,pe=0,_e=0;if((x|0)<=0)return B=0,B|0;if((B|0)>=16){for(j=0;;){if(_e=y+(j<<3)|0,!((w[_e>>2]|0)==0&(w[_e+4>>2]|0)==0)){j=14;break}if(j=j+1|0,(j|0)>=(x|0)){G=0,j=16;break}}if((j|0)==14)return((R|0)>0?-2:-1)|0;if((j|0)==16)return G|0}j=0,_e=0;e:for(;;){pe=y+(_e<<3)|0,Z=pe,G=w[Z>>2]|0,Z=w[Z+4>>2]|0;do if(!((G|0)==0&(Z|0)==0)){if((j|0)>=(R|0)){G=-1,j=16;break e}if(ae=An(G|0,Z|0,52)|0,Ke()|0,ae=ae&15,(ae|0)>(B|0)){G=-2,j=16;break e}if((ae|0)==(B|0)){pe=T+(j<<3)|0,w[pe>>2]=G,w[pe+4>>2]=Z,j=j+1|0;break}if(G=(xp(7,B-ae|0)|0)+j|0,(G|0)>(R|0)){G=-1,j=16;break e}bs(w[pe>>2]|0,w[pe+4>>2]|0,B,T+(j<<3)|0),j=G}while(0);if(_e=_e+1|0,(_e|0)>=(x|0)){G=0,j=16;break}}return(j|0)==16?G|0:0}function Xh(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0;if((x|0)<=0)return T=0,T|0;if((T|0)>=16){for(R=0;;){if(G=y+(R<<3)|0,!((w[G>>2]|0)==0&(w[G+4>>2]|0)==0)){R=-1,B=13;break}if(R=R+1|0,(R|0)>=(x|0)){R=0,B=13;break}}if((B|0)==13)return R|0}R=0,G=0;e:for(;;){B=y+(G<<3)|0,j=w[B>>2]|0,B=w[B+4>>2]|0;do if(!((j|0)==0&(B|0)==0)){if(B=An(j|0,B|0,52)|0,Ke()|0,B=B&15,(B|0)>(T|0)){R=-1,B=13;break e}if((B|0)==(T|0)){R=R+1|0;break}else{R=(xp(7,T-B|0)|0)+R|0;break}}while(0);if(G=G+1|0,(G|0)>=(x|0)){B=13;break}}return(B|0)==13?R|0:0}function kA(y,x){return y=y|0,x=x|0,x=An(y|0,x|0,52)|0,Ke()|0,x&1|0}function fs(y,x){y=y|0,x=x|0;var T=0,R=0,B=0;if(B=An(y|0,x|0,52)|0,Ke()|0,B=B&15,!B)return B=0,B|0;for(R=1;;){if(T=An(y|0,x|0,(15-R|0)*3|0)|0,Ke()|0,T=T&7,T|0){R=5;break}if(R>>>0<B>>>0)R=R+1|0;else{T=0,R=5;break}}return(R|0)==5?T|0:0}function gp(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0,ae=0;if(ae=An(y|0,x|0,52)|0,Ke()|0,ae=ae&15,!ae)return Z=x,ae=y,Hn(Z|0),ae|0;for(Z=1,T=0;;){j=(15-Z|0)*3|0,R=Dn(7,0,j|0)|0,B=Ke()|0,G=An(y|0,x|0,j|0)|0,Ke()|0,j=Dn(Gl(G&7)|0,0,j|0)|0,G=Ke()|0,y=j|y&~R,x=G|x&~B;e:do if(!T)if((j&R|0)==0&(G&B|0)==0)T=0;else if(R=An(y|0,x|0,52)|0,Ke()|0,R=R&15,!R)T=1;else{T=1;t:for(;;){switch(G=An(y|0,x|0,(15-T|0)*3|0)|0,Ke()|0,G&7){case 1:break t;case 0:break;default:{T=1;break e}}if(T>>>0<R>>>0)T=T+1|0;else{T=1;break e}}for(T=1;;)if(G=(15-T|0)*3|0,B=An(y|0,x|0,G|0)|0,Ke()|0,j=Dn(7,0,G|0)|0,x=x&~(Ke()|0),G=Dn(Gl(B&7)|0,0,G|0)|0,y=y&~j|G,x=x|(Ke()|0),T>>>0<R>>>0)T=T+1|0;else{T=1;break}}while(0);if(Z>>>0<ae>>>0)Z=Z+1|0;else break}return Hn(x|0),y|0}function ws(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0;if(R=An(y|0,x|0,52)|0,Ke()|0,R=R&15,!R)return T=x,R=y,Hn(T|0),R|0;for(T=1;j=(15-T|0)*3|0,G=An(y|0,x|0,j|0)|0,Ke()|0,B=Dn(7,0,j|0)|0,x=x&~(Ke()|0),j=Dn(Gl(G&7)|0,0,j|0)|0,y=j|y&~B,x=Ke()|0|x,T>>>0<R>>>0;)T=T+1|0;return Hn(x|0),y|0}function Fg(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0,ae=0;if(ae=An(y|0,x|0,52)|0,Ke()|0,ae=ae&15,!ae)return Z=x,ae=y,Hn(Z|0),ae|0;for(Z=1,T=0;;){j=(15-Z|0)*3|0,R=Dn(7,0,j|0)|0,B=Ke()|0,G=An(y|0,x|0,j|0)|0,Ke()|0,j=Dn(Bs(G&7)|0,0,j|0)|0,G=Ke()|0,y=j|y&~R,x=G|x&~B;e:do if(!T)if((j&R|0)==0&(G&B|0)==0)T=0;else if(R=An(y|0,x|0,52)|0,Ke()|0,R=R&15,!R)T=1;else{T=1;t:for(;;){switch(G=An(y|0,x|0,(15-T|0)*3|0)|0,Ke()|0,G&7){case 1:break t;case 0:break;default:{T=1;break e}}if(T>>>0<R>>>0)T=T+1|0;else{T=1;break e}}for(T=1;;)if(B=(15-T|0)*3|0,j=Dn(7,0,B|0)|0,G=x&~(Ke()|0),x=An(y|0,x|0,B|0)|0,Ke()|0,x=Dn(Bs(x&7)|0,0,B|0)|0,y=y&~j|x,x=G|(Ke()|0),T>>>0<R>>>0)T=T+1|0;else{T=1;break}}while(0);if(Z>>>0<ae>>>0)Z=Z+1|0;else break}return Hn(x|0),y|0}function mp(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0;if(R=An(y|0,x|0,52)|0,Ke()|0,R=R&15,!R)return T=x,R=y,Hn(T|0),R|0;for(T=1;G=(15-T|0)*3|0,j=Dn(7,0,G|0)|0,B=x&~(Ke()|0),x=An(y|0,x|0,G|0)|0,Ke()|0,x=Dn(Bs(x&7)|0,0,G|0)|0,y=x|y&~j,x=Ke()|0|B,T>>>0<R>>>0;)T=T+1|0;return Hn(x|0),y|0}function kg(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0;if(ae=Ve,Ve=Ve+64|0,Z=ae+40|0,R=ae+24|0,B=ae+12|0,j=ae,Dn(x|0,0,52)|0,T=Ke()|0|134225919,!x)return(w[y+4>>2]|0)>2||(w[y+8>>2]|0)>2||(w[y+12>>2]|0)>2?(G=0,Z=0,Hn(G|0),Ve=ae,Z|0):(Dn(vs(y)|0,0,45)|0,G=Ke()|0|T,Z=-1,Hn(G|0),Ve=ae,Z|0);if(w[Z>>2]=w[y>>2],w[Z+4>>2]=w[y+4>>2],w[Z+8>>2]=w[y+8>>2],w[Z+12>>2]=w[y+12>>2],G=Z+4|0,(x|0)>0)for(y=-1;w[R>>2]=w[G>>2],w[R+4>>2]=w[G+4>>2],w[R+8>>2]=w[G+8>>2],x&1?(I_(G),w[B>>2]=w[G>>2],w[B+4>>2]=w[G+4>>2],w[B+8>>2]=w[G+8>>2],Zu(B)):(lp(G),w[B>>2]=w[G>>2],w[B+4>>2]=w[G+4>>2],w[B+8>>2]=w[G+8>>2],Ds(B)),Ul(R,B,j),li(j),_e=(15-x|0)*3|0,pe=Dn(7,0,_e|0)|0,T=T&~(Ke()|0),_e=Dn(kf(j)|0,0,_e|0)|0,y=_e|y&~pe,T=Ke()|0|T,(x|0)>1;)x=x+-1|0;else y=-1;e:do if((w[G>>2]|0)<=2&&(w[Z+8>>2]|0)<=2&&(w[Z+12>>2]|0)<=2){if(R=vs(Z)|0,x=Dn(R|0,0,45)|0,x=x|y,y=Ke()|0|T&-1040385,j=Ig(Z)|0,!(Lr(R)|0)){if((j|0)<=0)break;for(B=0;;){if(R=An(x|0,y|0,52)|0,Ke()|0,R=R&15,R)for(T=1;_e=(15-T|0)*3|0,Z=An(x|0,y|0,_e|0)|0,Ke()|0,pe=Dn(7,0,_e|0)|0,y=y&~(Ke()|0),_e=Dn(Gl(Z&7)|0,0,_e|0)|0,x=x&~pe|_e,y=y|(Ke()|0),T>>>0<R>>>0;)T=T+1|0;if(B=B+1|0,(B|0)==(j|0))break e}}B=An(x|0,y|0,52)|0,Ke()|0,B=B&15;t:do if(B){T=1;n:for(;;){switch(_e=An(x|0,y|0,(15-T|0)*3|0)|0,Ke()|0,_e&7){case 1:break n;case 0:break;default:break t}if(T>>>0<B>>>0)T=T+1|0;else break t}if(lo(R,w[Z>>2]|0)|0)for(T=1;Z=(15-T|0)*3|0,pe=Dn(7,0,Z|0)|0,_e=y&~(Ke()|0),y=An(x|0,y|0,Z|0)|0,Ke()|0,y=Dn(Bs(y&7)|0,0,Z|0)|0,x=x&~pe|y,y=_e|(Ke()|0),T>>>0<B>>>0;)T=T+1|0;else for(T=1;_e=(15-T|0)*3|0,Z=An(x|0,y|0,_e|0)|0,Ke()|0,pe=Dn(7,0,_e|0)|0,y=y&~(Ke()|0),_e=Dn(Gl(Z&7)|0,0,_e|0)|0,x=x&~pe|_e,y=y|(Ke()|0),T>>>0<B>>>0;)T=T+1|0}while(0);if((j|0)>0){T=0;do x=gp(x,y)|0,y=Ke()|0,T=T+1|0;while((T|0)!=(j|0))}}else x=0,y=0;while(0);return pe=y,_e=x,Hn(pe|0),Ve=ae,_e|0}function Ua(y){return y=y|0,(y|0)%2|0|0}function zg(y,x){y=y|0,x=x|0;var T=0,R=0;return R=Ve,Ve=Ve+16|0,T=R,x>>>0<=15&&(w[y+4>>2]&2146435072|0)!=2146435072&&(w[y+8+4>>2]&2146435072|0)!=2146435072?(qh(y,x,T),x=kg(T,x)|0,y=Ke()|0):(y=0,x=0),Hn(y|0),Ve=R,x|0}function zA(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0;if(B=T+4|0,j=An(y|0,x|0,52)|0,Ke()|0,j=j&15,G=An(y|0,x|0,45)|0,Ke()|0,R=(j|0)==0,Lr(G&127)|0){if(R)return G=1,G|0;R=1}else{if(R)return G=0,G|0;!(w[B>>2]|0)&&!(w[T+8>>2]|0)?R=(w[T+12>>2]|0)!=0&1:R=1}for(T=1;T&1?Zu(B):Ds(B),G=An(y|0,x|0,(15-T|0)*3|0)|0,Ke()|0,Mg(B,G&7),T>>>0<j>>>0;)T=T+1|0;return R|0}function Hf(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0;_e=Ve,Ve=Ve+16|0,ae=_e,pe=An(y|0,x|0,45)|0,Ke()|0,pe=pe&127;e:do if(Lr(pe)|0&&(j=An(y|0,x|0,52)|0,Ke()|0,j=j&15,(j|0)!=0)){R=1;t:for(;;){switch(Z=An(y|0,x|0,(15-R|0)*3|0)|0,Ke()|0,Z&7){case 5:break t;case 0:break;default:{R=x;break e}}if(R>>>0<j>>>0)R=R+1|0;else{R=x;break e}}for(B=1,R=x;x=(15-B|0)*3|0,G=Dn(7,0,x|0)|0,Z=R&~(Ke()|0),R=An(y|0,R|0,x|0)|0,Ke()|0,R=Dn(Bs(R&7)|0,0,x|0)|0,y=y&~G|R,R=Z|(Ke()|0),B>>>0<j>>>0;)B=B+1|0}else R=x;while(0);if(Z=7728+(pe*28|0)|0,w[T>>2]=w[Z>>2],w[T+4>>2]=w[Z+4>>2],w[T+8>>2]=w[Z+8>>2],w[T+12>>2]=w[Z+12>>2],!(zA(y,R,T)|0)){Ve=_e;return}if(G=T+4|0,w[ae>>2]=w[G>>2],w[ae+4>>2]=w[G+4>>2],w[ae+8>>2]=w[G+8>>2],j=An(y|0,R|0,52)|0,Ke()|0,Z=j&15,j&1?(Ds(G),j=Z+1|0):j=Z,!(Lr(pe)|0))R=0;else{e:do if(!Z)R=0;else for(x=1;;){if(B=An(y|0,R|0,(15-x|0)*3|0)|0,Ke()|0,B=B&7,B|0){R=B;break e}if(x>>>0<Z>>>0)x=x+1|0;else{R=0;break}}while(0);R=(R|0)==4&1}if(!(Gf(T,j,R,0)|0))(j|0)!=(Z|0)&&(w[G>>2]=w[ae>>2],w[G+4>>2]=w[ae+4>>2],w[G+8>>2]=w[ae+8>>2]);else{if(Lr(pe)|0)do;while(Gf(T,j,0,0)|0);(j|0)!=(Z|0)&&lp(G)}Ve=_e}function du(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0;R=Ve,Ve=Ve+16|0,B=R,Hf(y,x,B),x=An(y|0,x|0,52)|0,Ke()|0,IA(B,x&15,T),Ve=R}function jl(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0;G=Ve,Ve=Ve+16|0,j=G,Hf(y,x,j),R=An(y|0,x|0,45)|0,Ke()|0,R=(Lr(R&127)|0)==0,B=An(y|0,x|0,52)|0,Ke()|0,B=B&15;e:do if(!R){if(B|0)for(R=1;;){if(Z=Dn(7,0,(15-R|0)*3|0)|0,!((Z&y|0)==0&((Ke()|0)&x|0)==0))break e;if(R>>>0<B>>>0)R=R+1|0;else break}MA(j,B,0,5,T),Ve=G;return}while(0);jf(j,B,0,6,T),Ve=G}function N_(y,x){y=y|0,x=x|0;var T=0,R=0,B=0;if(R=An(y|0,x|0,45)|0,Ke()|0,!(Lr(R&127)|0))return R=2,R|0;if(R=An(y|0,x|0,52)|0,Ke()|0,R=R&15,!R)return R=5,R|0;for(T=1;;){if(B=Dn(7,0,(15-T|0)*3|0)|0,!((B&y|0)==0&((Ke()|0)&x|0)==0)){T=2,y=6;break}if(T>>>0<R>>>0)T=T+1|0;else{T=5,y=6;break}}return(y|0)==6?T|0:0}function Ug(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0;Xe=Ve,Ve=Ve+128|0,pe=Xe+112|0,j=Xe+96|0,_e=Xe,B=An(y|0,x|0,52)|0,Ke()|0,Z=B&15,w[pe>>2]=Z,G=An(y|0,x|0,45)|0,Ke()|0,G=G&127;e:do if(Lr(G)|0){if(Z|0)for(R=1;;){if(ae=Dn(7,0,(15-R|0)*3|0)|0,!((ae&y|0)==0&((Ke()|0)&x|0)==0)){B=0;break e}if(R>>>0<Z>>>0)R=R+1|0;else break}if(B&1)B=1;else{ae=Dn(Z+1|0,0,52)|0,_e=Ke()|0|x&-15728641,pe=Dn(7,0,(14-Z|0)*3|0)|0,Ug((ae|y)&~pe,_e&~(Ke()|0),T),Ve=Xe;return}}else B=0;while(0);Hf(y,x,j),B?(Lg(j,pe,_e),ae=5):(fp(j,pe,_e),ae=6);e:do if(Lr(G)|0)if(!Z)R=20;else for(R=1;;){if(G=Dn(7,0,(15-R|0)*3|0)|0,!((G&y|0)==0&((Ke()|0)&x|0)==0)){R=8;break e}if(R>>>0<Z>>>0)R=R+1|0;else{R=20;break}}else R=8;while(0);if(Aa(T|0,-1,R|0)|0,B){B=0;do{for(j=_e+(B<<4)|0,OA(j,w[pe>>2]|0)|0,j=w[j>>2]|0,R=0;G=T+(R<<2)|0,Z=w[G>>2]|0,!((Z|0)==-1|(Z|0)==(j|0));)R=R+1|0;w[G>>2]=j,B=B+1|0}while((B|0)!=(ae|0))}else{B=0;do{for(j=_e+(B<<4)|0,Gf(j,w[pe>>2]|0,0,1)|0,j=w[j>>2]|0,R=0;G=T+(R<<2)|0,Z=w[G>>2]|0,!((Z|0)==-1|(Z|0)==(j|0));)R=R+1|0;w[G>>2]=j,B=B+1|0}while((B|0)!=(ae|0))}Ve=Xe}function lx(){return 12}function Ap(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0,ae=0;if(Dn(y|0,0,52)|0,Z=Ke()|0|134225919,(y|0)<1){R=0,T=0;do Lr(R)|0&&(Dn(R|0,0,45)|0,G=Z|(Ke()|0),y=x+(T<<3)|0,w[y>>2]=-1,w[y+4>>2]=G,T=T+1|0),R=R+1|0;while((R|0)!=122);return}G=0,T=0;do{if(Lr(G)|0){for(Dn(G|0,0,45)|0,R=1,B=-1,j=Z|(Ke()|0);ae=Dn(7,0,(15-R|0)*3|0)|0,B=B&~ae,j=j&~(Ke()|0),(R|0)!=(y|0);)R=R+1|0;ae=x+(T<<3)|0,w[ae>>2]=B,w[ae+4>>2]=j,T=T+1|0}G=G+1|0}while((G|0)!=122)}function UA(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0;var B=0,j=0,G=0,Z=0,ae=0,pe=0;if(Z=Ve,Ve=Ve+64|0,G=Z,(y|0)==(T|0)&(x|0)==(R|0)|(!1|(x&2013265920|0)!=134217728|(!1|(R&2013265920|0)!=134217728))||(B=An(y|0,x|0,52)|0,Ke()|0,B=B&15,j=An(T|0,R|0,52)|0,Ke()|0,(B|0)!=(j&15|0)))return G=0,Ve=Z,G|0;if(j=B+-1|0,B>>>0>1&&(pe=dp(y,x,j)|0,ae=Ke()|0,j=dp(T,R,j)|0,(pe|0)==(j|0)&(ae|0)==(Ke()|0))&&(j=(B^15)*3|0,B=An(y|0,x|0,j|0)|0,Ke()|0,B=B&7,j=An(T|0,R|0,j|0)|0,Ke()|0,j=j&7,(B|0)==0|(j|0)==0||(w[21136+(B<<2)>>2]|0)==(j|0)||(w[21168+(B<<2)>>2]|0)==(j|0)))return pe=1,Ve=Z,pe|0;B=G,j=B+56|0;do w[B>>2]=0,B=B+4|0;while((B|0)<(j|0));return Rs(y,x,1,G),pe=G,!((w[pe>>2]|0)==(T|0)&&(w[pe+4>>2]|0)==(R|0))&&(pe=G+8|0,!((w[pe>>2]|0)==(T|0)&&(w[pe+4>>2]|0)==(R|0)))&&(pe=G+16|0,!((w[pe>>2]|0)==(T|0)&&(w[pe+4>>2]|0)==(R|0)))&&(pe=G+24|0,!((w[pe>>2]|0)==(T|0)&&(w[pe+4>>2]|0)==(R|0)))&&(pe=G+32|0,!((w[pe>>2]|0)==(T|0)&&(w[pe+4>>2]|0)==(R|0)))&&(pe=G+40|0,!((w[pe>>2]|0)==(T|0)&&(w[pe+4>>2]|0)==(R|0)))?(B=G+48|0,B=((w[B>>2]|0)==(T|0)?(w[B+4>>2]|0)==(R|0):0)&1):B=1,pe=B,Ve=Z,pe|0}function _p(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0;var B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0;if(pe=Ve,Ve=Ve+16|0,G=pe,!(UA(y,x,T,R)|0))return Z=0,ae=0,Hn(Z|0),Ve=pe,ae|0;for(Z=x&-2130706433,B=(No(y,x)|0)==0,B=B?1:2;w[G>>2]=0,_e=ye(y,x,B,G)|0,j=B+1|0,!((_e|0)==(T|0)&(Ke()|0)==(R|0));)if(j>>>0<7)B=j;else{B=0,y=0,ae=6;break}return(ae|0)==6?(Hn(B|0),Ve=pe,y|0):(_e=Dn(B|0,0,56)|0,ae=Z|(Ke()|0)|268435456,_e=y|_e,Hn(ae|0),Ve=pe,_e|0)}function F_(y,x){y=y|0,x=x|0;var T=0;return T=!0&(x&2013265920|0)==268435456,Hn((T?x&-2130706433|134217728:0)|0),(T?y:0)|0}function Gg(y,x){y=y|0,x=x|0;var T=0,R=0,B=0;return R=Ve,Ve=Ve+16|0,T=R,!0&(x&2013265920|0)==268435456?(B=An(y|0,x|0,56)|0,Ke()|0,w[T>>2]=0,T=ye(y,x&-2130706433|134217728,B&7,T)|0,x=Ke()|0,Hn(x|0),Ve=R,T|0):(x=0,T=0,Hn(x|0),Ve=R,T|0)}function k_(y,x){y=y|0,x=x|0;var T=0;if(!(!0&(x&2013265920|0)==268435456))return T=0,T|0;switch(T=An(y|0,x|0,56)|0,Ke()|0,T&7){case 0:case 7:return T=0,T|0}return T=x&-2130706433|134217728,!0&(x&117440512|0)==16777216&(No(y,T)|0)!=0?(T=0,T|0):(T=Ng(y,T)|0,T|0)}function Zh(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0;j=Ve,Ve=Ve+16|0,R=j,G=!0&(x&2013265920|0)==268435456,B=x&-2130706433|134217728,Z=T,w[Z>>2]=G?y:0,w[Z+4>>2]=G?B:0,G?(x=An(y|0,x|0,56)|0,Ke()|0,w[R>>2]=0,y=ye(y,B,x&7,R)|0,x=Ke()|0):(y=0,x=0),Z=T+8|0,w[Z>>2]=y,w[Z+4>>2]=x,Ve=j}function ux(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0;B=(No(y,x)|0)==0,x=x&-2130706433,R=T,w[R>>2]=B?y:0,w[R+4>>2]=B?x|285212672:0,R=T+8|0,w[R>>2]=y,w[R+4>>2]=x|301989888,R=T+16|0,w[R>>2]=y,w[R+4>>2]=x|318767104,R=T+24|0,w[R>>2]=y,w[R+4>>2]=x|335544320,R=T+32|0,w[R>>2]=y,w[R+4>>2]=x|352321536,T=T+40|0,w[T>>2]=y,w[T+4>>2]=x|369098752}function jg(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0;if(G=Ve,Ve=Ve+16|0,j=G,R=An(y|0,x|0,56)|0,Ke()|0,Z=!0&(x&2013265920|0)==268435456,B=Z?y:0,y=Z?x&-2130706433|134217728:0,x=Ep(B,y,R&7)|0,(x|0)==-1){w[T>>2]=0,Ve=G;return}Hf(B,y,j),R=An(B|0,y|0,52)|0,Ke()|0,R=R&15,No(B,y)|0?MA(j,R,x,2,T):jf(j,R,x,2,T),Ve=G}function cx(y){y=y|0;var x=0,T=0,R=0;return x=ma(1,12)|0,x||pt(22691,22646,49,22704),T=y+4|0,R=w[T>>2]|0,R|0?(R=R+8|0,w[R>>2]=x,w[T>>2]=x,x|0):(w[y>>2]|0&&pt(22721,22646,61,22744),R=y,w[R>>2]=x,w[T>>2]=x,x|0)}function fx(y,x){y=y|0,x=x|0;var T=0,R=0;return R=Ga(24)|0,R||pt(22758,22646,78,22772),w[R>>2]=w[x>>2],w[R+4>>2]=w[x+4>>2],w[R+8>>2]=w[x+8>>2],w[R+12>>2]=w[x+12>>2],w[R+16>>2]=0,x=y+4|0,T=w[x>>2]|0,T|0?(w[T+16>>2]=R,w[x>>2]=R,R|0):(w[y>>2]|0&&pt(22787,22646,82,22772),w[y>>2]=R,w[x>>2]=R,R|0)}function hx(y){y=y|0;var x=0,T=0,R=0,B=0;if(y)for(R=1;;){if(x=w[y>>2]|0,x|0)do{if(T=w[x>>2]|0,T|0)do B=T,T=w[T+16>>2]|0,Mr(B);while(T|0);B=x,x=w[x+8>>2]|0,Mr(B)}while(x|0);if(x=y,y=w[y+8>>2]|0,R||Mr(x),y)R=0;else break}}function GA(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0,Vt=0,yn=0,Cn=0,Rt=0,fn=0,it=0,On=0,Bn=0,Pn=0,Mt=0,br=0,ui=0,Vr=0,Jr=0,qt=0,xi=0,$i=0,gr=0;if(B=y+8|0,w[B>>2]|0)return gr=1,gr|0;if(R=w[y>>2]|0,!R)return gr=0,gr|0;x=R,T=0;do T=T+1|0,x=w[x+8>>2]|0;while(x|0);if(T>>>0<2)return gr=0,gr|0;xi=Ga(T<<2)|0,xi||pt(22807,22646,317,22826),qt=Ga(T<<5)|0,qt||pt(22848,22646,321,22826),w[y>>2]=0,Bn=y+4|0,w[Bn>>2]=0,w[B>>2]=0,T=0,Jr=0,On=0,Xe=0;e:for(;;){if(_e=w[R>>2]|0,_e){j=0,G=_e;do{if(ae=+Ue[G+8>>3],x=G,G=w[G+16>>2]|0,pe=(G|0)==0,B=pe?_e:G,Z=+Ue[B+8>>3],+rr(+(ae-Z))>3.141592653589793){gr=14;break}j=j+(Z-ae)*(+Ue[x>>3]+ +Ue[B>>3])}while(!pe);if((gr|0)==14){gr=0,j=0,x=_e;do it=+Ue[x+8>>3],Vr=x+16|0,ui=w[Vr>>2]|0,ui=ui|0?ui:_e,fn=+Ue[ui+8>>3],j=j+(+Ue[x>>3]+ +Ue[ui>>3])*((fn<0?fn+6.283185307179586:fn)-(it<0?it+6.283185307179586:it)),x=w[(x|0?Vr:R)>>2]|0;while(x|0)}j>0?(w[xi+(Jr<<2)>>2]=R,Jr=Jr+1|0,B=On,x=Xe):gr=19}else gr=19;if((gr|0)==19){gr=0;do if(T){if(x=T+8|0,w[x>>2]|0){gr=21;break e}if(T=ma(1,12)|0,!T){gr=23;break e}w[x>>2]=T,B=T+4|0,G=T,x=Xe}else if(Xe){B=Bn,G=Xe+8|0,x=R,T=y;break}else if(w[y>>2]|0){gr=27;break e}else{B=Bn,G=y,x=R,T=y;break}while(0);if(w[G>>2]=R,w[B>>2]=R,G=qt+(On<<5)|0,pe=w[R>>2]|0,pe){for(_e=qt+(On<<5)+8|0,Ue[_e>>3]=17976931348623157e292,Xe=qt+(On<<5)+24|0,Ue[Xe>>3]=17976931348623157e292,Ue[G>>3]=-17976931348623157e292,tt=qt+(On<<5)+16|0,Ue[tt>>3]=-17976931348623157e292,Cn=17976931348623157e292,Rt=-17976931348623157e292,B=0,gt=pe,ae=17976931348623157e292,Vt=17976931348623157e292,yn=-17976931348623157e292,Z=-17976931348623157e292;j=+Ue[gt>>3],it=+Ue[gt+8>>3],gt=w[gt+16>>2]|0,kt=(gt|0)==0,fn=+Ue[(kt?pe:gt)+8>>3],j<ae&&(Ue[_e>>3]=j,ae=j),it<Vt&&(Ue[Xe>>3]=it,Vt=it),j>yn?Ue[G>>3]=j:j=yn,it>Z&&(Ue[tt>>3]=it,Z=it),Cn=it>0&it<Cn?it:Cn,Rt=it<0&it>Rt?it:Rt,B=B|+rr(+(it-fn))>3.141592653589793,!kt;)yn=j;B&&(Ue[tt>>3]=Rt,Ue[Xe>>3]=Cn)}else w[G>>2]=0,w[G+4>>2]=0,w[G+8>>2]=0,w[G+12>>2]=0,w[G+16>>2]=0,w[G+20>>2]=0,w[G+24>>2]=0,w[G+28>>2]=0;B=On+1|0}if(Vr=R+8|0,R=w[Vr>>2]|0,w[Vr>>2]=0,R)On=B,Xe=x;else{gr=45;break}}if((gr|0)==21)pt(22624,22646,35,22658);else if((gr|0)==23)pt(22678,22646,37,22658);else if((gr|0)==27)pt(22721,22646,61,22744);else if((gr|0)==45){e:do if((Jr|0)>0){for(Vr=(B|0)==0,br=B<<2,ui=(y|0)==0,Mt=0,x=0;;){if(Pn=w[xi+(Mt<<2)>>2]|0,Vr)gr=73;else{if(On=Ga(br)|0,!On){gr=50;break}if(Bn=Ga(br)|0,!Bn){gr=52;break}t:do if(ui)T=0;else{for(B=0,T=0,G=y;R=qt+(B<<5)|0,yp(w[G>>2]|0,R,w[Pn>>2]|0)|0?(w[On+(T<<2)>>2]=G,w[Bn+(T<<2)>>2]=R,kt=T+1|0):kt=T,G=w[G+8>>2]|0,G;)B=B+1|0,T=kt;if((kt|0)>0)if(R=w[On>>2]|0,(kt|0)==1)T=R;else for(tt=0,gt=-1,T=R,Xe=R;;){for(pe=w[Xe>>2]|0,R=0,G=0;B=w[w[On+(G<<2)>>2]>>2]|0,(B|0)==(pe|0)?_e=R:_e=R+((yp(B,w[Bn+(G<<2)>>2]|0,w[pe>>2]|0)|0)&1)|0,G=G+1|0,(G|0)!=(kt|0);)R=_e;if(B=(_e|0)>(gt|0),T=B?Xe:T,R=tt+1|0,(R|0)==(kt|0))break t;tt=R,gt=B?_e:gt,Xe=w[On+(R<<2)>>2]|0}else T=0}while(0);if(Mr(On),Mr(Bn),T){if(B=T+4|0,R=w[B>>2]|0,R)T=R+8|0;else if(w[T>>2]|0){gr=70;break}w[T>>2]=Pn,w[B>>2]=Pn}else gr=73}if((gr|0)==73){if(gr=0,x=w[Pn>>2]|0,x|0)do Bn=x,x=w[x+16>>2]|0,Mr(Bn);while(x|0);Mr(Pn),x=2}if(Mt=Mt+1|0,(Mt|0)>=(Jr|0)){$i=x;break e}}(gr|0)==50?pt(22863,22646,249,22882):(gr|0)==52?pt(22901,22646,252,22882):(gr|0)==70&&pt(22721,22646,61,22744)}else $i=0;while(0);return Mr(xi),Mr(qt),gr=$i,gr|0}return 0}function yp(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0;if(!(Wh(x,T)|0)||(x=TA(x)|0,pe=+Ue[T>>3],R=+Ue[T+8>>3],R=x&R<0?R+6.283185307179586:R,y=w[y>>2]|0,!y))return y=0,y|0;if(x){x=0,T=y;e:for(;;){for(;G=+Ue[T>>3],ae=+Ue[T+8>>3],T=T+16|0,_e=w[T>>2]|0,_e=_e|0?_e:y,j=+Ue[_e>>3],B=+Ue[_e+8>>3],G>j?(Z=G,G=ae):(Z=j,j=G,G=B,B=ae),!!(pe<j|pe>Z);)if(T=w[T>>2]|0,!T){T=22;break e}if(ae=B<0?B+6.283185307179586:B,G=G<0?G+6.283185307179586:G,R=G==R|ae==R?R+-2220446049250313e-31:R,ae=ae+(pe-j)/(Z-j)*(G-ae),(ae<0?ae+6.283185307179586:ae)>R&&(x=x^1),T=w[T>>2]|0,!T){T=22;break}}if((T|0)==22)return x|0}else{x=0,T=y;e:for(;;){for(;G=+Ue[T>>3],ae=+Ue[T+8>>3],T=T+16|0,_e=w[T>>2]|0,_e=_e|0?_e:y,j=+Ue[_e>>3],B=+Ue[_e+8>>3],G>j?(Z=G,G=ae):(Z=j,j=G,G=B,B=ae),!!(pe<j|pe>Z);)if(T=w[T>>2]|0,!T){T=22;break e}if(R=G==R|B==R?R+-2220446049250313e-31:R,B+(pe-j)/(Z-j)*(G-B)>R&&(x=x^1),T=w[T>>2]|0,!T){T=22;break}}if((T|0)==22)return x|0}return 0}function ga(y,x,T,R,B){y=y|0,x=x|0,T=T|0,R=R|0,B=B|0;var j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0,Vt=0,yn=0,Cn=0,Rt=0;if(Rt=Ve,Ve=Ve+32|0,Cn=Rt+16|0,yn=Rt,j=An(y|0,x|0,52)|0,Ke()|0,j=j&15,gt=An(T|0,R|0,52)|0,Ke()|0,(j|0)!=(gt&15|0))return Cn=1,Ve=Rt,Cn|0;if(pe=An(y|0,x|0,45)|0,Ke()|0,pe=pe&127,_e=An(T|0,R|0,45)|0,Ke()|0,_e=_e&127,gt=(pe|0)!=(_e|0),gt){if(Z=sp(pe,_e)|0,(Z|0)==7)return Cn=2,Ve=Rt,Cn|0;ae=sp(_e,pe)|0,(ae|0)==7?pt(22925,22949,151,22959):(kt=Z,G=ae)}else kt=0,G=0;Xe=Lr(pe)|0,tt=Lr(_e)|0,w[Cn>>2]=0,w[Cn+4>>2]=0,w[Cn+8>>2]=0,w[Cn+12>>2]=0;do if(kt){if(_e=w[4304+(pe*28|0)+(kt<<2)>>2]|0,Z=(_e|0)>0,tt)if(Z){pe=0,ae=T,Z=R;do ae=Fg(ae,Z)|0,Z=Ke()|0,G=Bs(G)|0,(G|0)==1&&(G=Bs(1)|0),pe=pe+1|0;while((pe|0)!=(_e|0));_e=G,pe=ae,ae=Z}else _e=G,pe=T,ae=R;else if(Z){pe=0,ae=T,Z=R;do ae=mp(ae,Z)|0,Z=Ke()|0,G=Bs(G)|0,pe=pe+1|0;while((pe|0)!=(_e|0));_e=G,pe=ae,ae=Z}else _e=G,pe=T,ae=R;if(zA(pe,ae,Cn)|0,gt||pt(22972,22949,181,22959),Z=(Xe|0)!=0,G=(tt|0)!=0,Z&G&&pt(22999,22949,182,22959),Z){if(G=fs(y,x)|0,Gn[22032+(G*7|0)+kt>>0]|0){j=3;break}ae=w[21200+(G*28|0)+(kt<<2)>>2]|0,pe=ae,Vt=26}else if(G){if(G=fs(pe,ae)|0,Gn[22032+(G*7|0)+_e>>0]|0){j=4;break}pe=0,ae=w[21200+(_e*28|0)+(G<<2)>>2]|0,Vt=26}else G=0;if((Vt|0)==26)if((ae|0)<=-1&&pt(23030,22949,212,22959),(pe|0)<=-1&&pt(23053,22949,213,22959),(ae|0)>0){Z=Cn+4|0,G=0;do ol(Z),G=G+1|0;while((G|0)!=(ae|0));G=pe}else G=pe;if(w[yn>>2]=0,w[yn+4>>2]=0,w[yn+8>>2]=0,Mg(yn,kt),j|0)for(;Ua(j)|0?Zu(yn):Ds(yn),(j|0)>1;)j=j+-1|0;if((G|0)>0){j=0;do ol(yn),j=j+1|0;while((j|0)!=(G|0))}Vt=Cn+4|0,xs(Vt,yn,Vt),li(Vt),Vt=50}else if(zA(T,R,Cn)|0,(Xe|0)!=0&(tt|0)!=0)if((_e|0)!=(pe|0)&&pt(23077,22949,243,22959),G=fs(y,x)|0,j=fs(T,R)|0,Gn[22032+(G*7|0)+j>>0]|0)j=5;else if(G=w[21200+(G*28|0)+(j<<2)>>2]|0,(G|0)>0){Z=Cn+4|0,j=0;do ol(Z),j=j+1|0;while((j|0)!=(G|0));Vt=50}else Vt=50;else Vt=50;while(0);return(Vt|0)==50&&(j=Cn+4|0,w[B>>2]=w[j>>2],w[B+4>>2]=w[j+4>>2],w[B+8>>2]=w[j+8>>2],j=0),Cn=j,Ve=Rt,Cn|0}function jA(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0;var B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0,Vt=0,yn=0,Cn=0,Rt=0;if(kt=Ve,Ve=Ve+48|0,G=kt+36|0,Z=kt+24|0,ae=kt+12|0,pe=kt,j=An(y|0,x|0,52)|0,Ke()|0,j=j&15,tt=An(y|0,x|0,45)|0,Ke()|0,tt=tt&127,_e=Lr(tt)|0,Dn(j|0,0,52)|0,yn=Ke()|0|134225919,Vt=R,w[Vt>>2]=-1,w[Vt+4>>2]=yn,!j)return(w[T>>2]|0)>1||(w[T+4>>2]|0)>1||(w[T+8>>2]|0)>1||(B=op(tt,kf(T)|0)|0,(B|0)==127)?(yn=1,Ve=kt,yn|0):(gt=Dn(B|0,0,45)|0,Vt=Ke()|0,tt=R,Vt=w[tt+4>>2]&-1040385|Vt,yn=R,w[yn>>2]=w[tt>>2]|gt,w[yn+4>>2]=Vt,yn=0,Ve=kt,yn|0);for(w[G>>2]=w[T>>2],w[G+4>>2]=w[T+4>>2],w[G+8>>2]=w[T+8>>2];w[Z>>2]=w[G>>2],w[Z+4>>2]=w[G+4>>2],w[Z+8>>2]=w[G+8>>2],Ua(j)|0?(I_(G),w[ae>>2]=w[G>>2],w[ae+4>>2]=w[G+4>>2],w[ae+8>>2]=w[G+8>>2],Zu(ae)):(lp(G),w[ae>>2]=w[G>>2],w[ae+4>>2]=w[G+4>>2],w[ae+8>>2]=w[G+8>>2],Ds(ae)),Ul(Z,ae,pe),li(pe),Vt=R,Cn=w[Vt>>2]|0,Vt=w[Vt+4>>2]|0,Rt=(15-j|0)*3|0,T=Dn(7,0,Rt|0)|0,Vt=Vt&~(Ke()|0),Rt=Dn(kf(pe)|0,0,Rt|0)|0,Vt=Ke()|0|Vt,yn=R,w[yn>>2]=Rt|Cn&~T,w[yn+4>>2]=Vt,(j|0)>1;)j=j+-1|0;e:do if((w[G>>2]|0)<=1&&(w[G+4>>2]|0)<=1&&(w[G+8>>2]|0)<=1){j=kf(G)|0,Z=op(tt,j)|0,(Z|0)==127?pe=0:pe=Lr(Z)|0;t:do if(j){if(_e){if(G=21408+((fs(y,x)|0)*28|0)+(j<<2)|0,G=w[G>>2]|0,(G|0)>0){T=0;do j=Gl(j)|0,T=T+1|0;while((T|0)!=(G|0))}if((j|0)==1){B=3;break e}T=op(tt,j)|0,(T|0)==127&&pt(23104,22949,376,23134),Lr(T)|0?pt(23147,22949,377,23134):(gt=G,Xe=j,B=T)}else gt=0,Xe=j,B=Z;if(ae=w[4304+(tt*28|0)+(Xe<<2)>>2]|0,(ae|0)<=-1&&pt(23178,22949,384,23134),!pe){if((gt|0)<=-1&&pt(23030,22949,417,23134),gt|0){G=R,j=0,T=w[G>>2]|0,G=w[G+4>>2]|0;do T=ws(T,G)|0,G=Ke()|0,Rt=R,w[Rt>>2]=T,w[Rt+4>>2]=G,j=j+1|0;while((j|0)<(gt|0))}if((ae|0)<=0){j=54;break}for(G=R,j=0,T=w[G>>2]|0,G=w[G+4>>2]|0;;)if(T=ws(T,G)|0,G=Ke()|0,Rt=R,w[Rt>>2]=T,w[Rt+4>>2]=G,j=j+1|0,(j|0)==(ae|0)){j=54;break t}}if(Z=sp(B,tt)|0,(Z|0)==7&&pt(22925,22949,393,23134),j=R,T=w[j>>2]|0,j=w[j+4>>2]|0,(ae|0)>0){G=0;do T=ws(T,j)|0,j=Ke()|0,Rt=R,w[Rt>>2]=T,w[Rt+4>>2]=j,G=G+1|0;while((G|0)!=(ae|0))}if(T=fs(T,j)|0,Rt=ao(B)|0,T=w[(Rt?21824:21616)+(Z*28|0)+(T<<2)>>2]|0,(T|0)<=-1&&pt(23030,22949,412,23134),!T)j=54;else{Z=R,j=0,G=w[Z>>2]|0,Z=w[Z+4>>2]|0;do G=gp(G,Z)|0,Z=Ke()|0,Rt=R,w[Rt>>2]=G,w[Rt+4>>2]=Z,j=j+1|0;while((j|0)<(T|0));j=54}}else if((_e|0)!=0&(pe|0)!=0)if(Rt=fs(y,x)|0,j=R,j=21408+(Rt*28|0)+((fs(w[j>>2]|0,w[j+4>>2]|0)|0)<<2)|0,j=w[j>>2]|0,(j|0)<=-1&&pt(23201,22949,433,23134),!j)B=Z,j=55;else{G=R,B=0,T=w[G>>2]|0,G=w[G+4>>2]|0;do T=ws(T,G)|0,G=Ke()|0,Rt=R,w[Rt>>2]=T,w[Rt+4>>2]=G,B=B+1|0;while((B|0)<(j|0));B=Z,j=54}else B=Z,j=54;while(0);if((j|0)==54&&pe&&(j=55),(j|0)==55&&(Rt=R,(fs(w[Rt>>2]|0,w[Rt+4>>2]|0)|0)==1)){B=4;break}Rt=R,yn=w[Rt>>2]|0,Rt=w[Rt+4>>2]&-1040385,Cn=Dn(B|0,0,45)|0,Rt=Rt|(Ke()|0),B=R,w[B>>2]=yn|Cn,w[B+4>>2]=Rt,B=0}else B=2;while(0);return Rt=B,Ve=kt,Rt|0}function z_(y,x,T,R,B){y=y|0,x=x|0,T=T|0,R=R|0,B=B|0;var j=0,G=0;return G=Ve,Ve=Ve+16|0,j=G,y=ga(y,x,T,R,j)|0,y||(M_(j,B),y=0),Ve=G,y|0}function Yu(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0;var B=0,j=0;return B=Ve,Ve=Ve+16|0,j=B,Og(T,j),R=jA(y,x,j,R)|0,Ve=B,R|0}function Vg(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0;var B=0,j=0,G=0;return G=Ve,Ve=Ve+32|0,B=G+12|0,j=G,!(ga(y,x,y,x,B)|0)&&!(ga(y,x,T,R,j)|0)?y=Uf(B,j)|0:y=-1,Ve=G,y|0}function sl(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0;var B=0,j=0,G=0;return G=Ve,Ve=Ve+32|0,B=G+12|0,j=G,!(ga(y,x,y,x,B)|0)&&!(ga(y,x,T,R,j)|0)?y=Uf(B,j)|0:y=-1,Ve=G,(y>>>31^1)+y|0}function vp(y,x,T,R,B){y=y|0,x=x|0,T=T|0,R=R|0,B=B|0;var j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0,Vt=0,yn=0,Cn=0,Rt=0,fn=0,it=0,On=0,Bn=0;if(On=Ve,Ve=Ve+48|0,j=On+24|0,G=On+12|0,it=On,!(ga(y,x,y,x,j)|0)&&!(ga(y,x,T,R,G)|0)){if(fn=Uf(j,G)|0,(fn|0)<0)return it=fn,Ve=On,it|0;for(w[j>>2]=0,w[j+4>>2]=0,w[j+8>>2]=0,w[G>>2]=0,w[G+4>>2]=0,w[G+8>>2]=0,ga(y,x,y,x,j)|0,ga(y,x,T,R,G)|0,Rg(j),Rg(G),fn?(_e=w[j>>2]|0,gt=+(fn|0),yn=j+4|0,Xe=w[yn>>2]|0,Cn=j+8|0,tt=w[Cn>>2]|0,Rt=j,T=_e,R=Xe,j=tt,kt=+((w[G>>2]|0)-_e|0)/gt,Vt=+((w[G+4>>2]|0)-Xe|0)/gt,gt=+((w[G+8>>2]|0)-tt|0)/gt):(R=j+4|0,tt=j+8|0,yn=R,Cn=tt,Rt=j,T=w[j>>2]|0,R=w[R>>2]|0,j=w[tt>>2]|0,kt=0,Vt=0,gt=0),w[it>>2]=T,tt=it+4|0,w[tt>>2]=R,Xe=it+8|0,w[Xe>>2]=j,_e=0;;){ae=+(_e|0),Bn=kt*ae+ +(T|0),Z=Vt*ae+ +(w[yn>>2]|0),ae=gt*ae+ +(w[Cn>>2]|0),R=~~+Jh(+Bn),G=~~+Jh(+Z),T=~~+Jh(+ae),Bn=+rr(+(+(R|0)-Bn)),Z=+rr(+(+(G|0)-Z)),ae=+rr(+(+(T|0)-ae));do if(Bn>Z&Bn>ae)R=0-(G+T)|0,j=G;else if(pe=0-R|0,Z>ae){j=pe-T|0;break}else{j=G,T=pe-G|0;break}while(0);if(w[it>>2]=R,w[tt>>2]=j,w[Xe>>2]=T,PA(it),jA(y,x,it,B+(_e<<3)|0)|0,(_e|0)==(fn|0))break;_e=_e+1|0,T=w[Rt>>2]|0}return it=0,Ve=On,it|0}return it=-1,Ve=On,it|0}function xp(y,x){y=y|0,x=x|0;var T=0;if(!x)return T=1,T|0;T=y,y=1;do y=Bo(x&1|0?T:1,y)|0,x=x>>1,T=Bo(T,T)|0;while(x|0);return y|0}function Gc(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0;if(!(Wh(x,T)|0)||(x=TA(x)|0,tt=+Ue[T>>3],R=+Ue[T+8>>3],R=x&R<0?R+6.283185307179586:R,Xe=w[y>>2]|0,(Xe|0)<=0))return Xe=0,Xe|0;if(_e=w[y+4>>2]|0,x){x=0,T=-1,y=0;e:for(;;){for(pe=y;G=+Ue[_e+(pe<<4)>>3],ae=+Ue[_e+(pe<<4)+8>>3],y=(T+2|0)%(Xe|0)|0,j=+Ue[_e+(y<<4)>>3],B=+Ue[_e+(y<<4)+8>>3],G>j?(Z=G,G=ae):(Z=j,j=G,G=B,B=ae),!!(tt<j|tt>Z);)if(T=pe+1|0,(T|0)<(Xe|0))y=pe,pe=T,T=y;else{T=22;break e}if(ae=B<0?B+6.283185307179586:B,G=G<0?G+6.283185307179586:G,R=G==R|ae==R?R+-2220446049250313e-31:R,ae=ae+(tt-j)/(Z-j)*(G-ae),(ae<0?ae+6.283185307179586:ae)>R&&(x=x^1),y=pe+1|0,(y|0)>=(Xe|0)){T=22;break}else T=pe}if((T|0)==22)return x|0}else{x=0,T=-1,y=0;e:for(;;){for(pe=y;G=+Ue[_e+(pe<<4)>>3],ae=+Ue[_e+(pe<<4)+8>>3],y=(T+2|0)%(Xe|0)|0,j=+Ue[_e+(y<<4)>>3],B=+Ue[_e+(y<<4)+8>>3],G>j?(Z=G,G=ae):(Z=j,j=G,G=B,B=ae),!!(tt<j|tt>Z);)if(T=pe+1|0,(T|0)<(Xe|0))y=pe,pe=T,T=y;else{T=22;break e}if(R=G==R|B==R?R+-2220446049250313e-31:R,B+(tt-j)/(Z-j)*(G-B)>R&&(x=x^1),y=pe+1|0,(y|0)>=(Xe|0)){T=22;break}else T=pe}if((T|0)==22)return x|0}return 0}function jc(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0,Vt=0,yn=0,Cn=0,Rt=0;if(kt=w[y>>2]|0,!kt){w[x>>2]=0,w[x+4>>2]=0,w[x+8>>2]=0,w[x+12>>2]=0,w[x+16>>2]=0,w[x+20>>2]=0,w[x+24>>2]=0,w[x+28>>2]=0;return}if(Vt=x+8|0,Ue[Vt>>3]=17976931348623157e292,yn=x+24|0,Ue[yn>>3]=17976931348623157e292,Ue[x>>3]=-17976931348623157e292,Cn=x+16|0,Ue[Cn>>3]=-17976931348623157e292,!((kt|0)<=0)){for(tt=w[y+4>>2]|0,pe=17976931348623157e292,_e=-17976931348623157e292,Xe=0,y=-1,j=17976931348623157e292,G=17976931348623157e292,ae=-17976931348623157e292,R=-17976931348623157e292,gt=0;T=+Ue[tt+(gt<<4)>>3],Z=+Ue[tt+(gt<<4)+8>>3],y=y+2|0,B=+Ue[tt+(((y|0)==(kt|0)?0:y)<<4)+8>>3],T<j&&(Ue[Vt>>3]=T,j=T),Z<G&&(Ue[yn>>3]=Z,G=Z),T>ae?Ue[x>>3]=T:T=ae,Z>R&&(Ue[Cn>>3]=Z,R=Z),pe=Z>0&Z<pe?Z:pe,_e=Z<0&Z>_e?Z:_e,Xe=Xe|+rr(+(Z-B))>3.141592653589793,y=gt+1|0,(y|0)!=(kt|0);)Rt=gt,ae=T,gt=y,y=Rt;Xe&&(Ue[Cn>>3]=_e,Ue[yn>>3]=pe)}}function $g(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0,Vt=0,yn=0,Cn=0,Rt=0,fn=0,it=0,On=0,Bn=0,Pn=0;if(kt=w[y>>2]|0,kt){if(Vt=x+8|0,Ue[Vt>>3]=17976931348623157e292,yn=x+24|0,Ue[yn>>3]=17976931348623157e292,Ue[x>>3]=-17976931348623157e292,Cn=x+16|0,Ue[Cn>>3]=-17976931348623157e292,(kt|0)>0){for(B=w[y+4>>2]|0,tt=17976931348623157e292,gt=-17976931348623157e292,R=0,T=-1,ae=17976931348623157e292,pe=17976931348623157e292,Xe=-17976931348623157e292,G=-17976931348623157e292,Rt=0;j=+Ue[B+(Rt<<4)>>3],_e=+Ue[B+(Rt<<4)+8>>3],Bn=T+2|0,Z=+Ue[B+(((Bn|0)==(kt|0)?0:Bn)<<4)+8>>3],j<ae&&(Ue[Vt>>3]=j,ae=j),_e<pe&&(Ue[yn>>3]=_e,pe=_e),j>Xe?Ue[x>>3]=j:j=Xe,_e>G&&(Ue[Cn>>3]=_e,G=_e),tt=_e>0&_e<tt?_e:tt,gt=_e<0&_e>gt?_e:gt,R=R|+rr(+(_e-Z))>3.141592653589793,T=Rt+1|0,(T|0)!=(kt|0);)Bn=Rt,Xe=j,Rt=T,T=Bn;R&&(Ue[Cn>>3]=gt,Ue[yn>>3]=tt)}}else w[x>>2]=0,w[x+4>>2]=0,w[x+8>>2]=0,w[x+12>>2]=0,w[x+16>>2]=0,w[x+20>>2]=0,w[x+24>>2]=0,w[x+28>>2]=0;if(Bn=y+8|0,T=w[Bn>>2]|0,!((T|0)<=0)){On=y+12|0,it=0;do if(B=w[On>>2]|0,R=it,it=it+1|0,yn=x+(it<<5)|0,Cn=w[B+(R<<3)>>2]|0,Cn){if(Rt=x+(it<<5)+8|0,Ue[Rt>>3]=17976931348623157e292,y=x+(it<<5)+24|0,Ue[y>>3]=17976931348623157e292,Ue[yn>>3]=-17976931348623157e292,fn=x+(it<<5)+16|0,Ue[fn>>3]=-17976931348623157e292,(Cn|0)>0){for(kt=w[B+(R<<3)+4>>2]|0,tt=17976931348623157e292,gt=-17976931348623157e292,B=0,R=-1,Vt=0,ae=17976931348623157e292,pe=17976931348623157e292,_e=-17976931348623157e292,G=-17976931348623157e292;j=+Ue[kt+(Vt<<4)>>3],Xe=+Ue[kt+(Vt<<4)+8>>3],R=R+2|0,Z=+Ue[kt+(((R|0)==(Cn|0)?0:R)<<4)+8>>3],j<ae&&(Ue[Rt>>3]=j,ae=j),Xe<pe&&(Ue[y>>3]=Xe,pe=Xe),j>_e?Ue[yn>>3]=j:j=_e,Xe>G&&(Ue[fn>>3]=Xe,G=Xe),tt=Xe>0&Xe<tt?Xe:tt,gt=Xe<0&Xe>gt?Xe:gt,B=B|+rr(+(Xe-Z))>3.141592653589793,R=Vt+1|0,(R|0)!=(Cn|0);)Pn=Vt,Vt=R,_e=j,R=Pn;B&&(Ue[fn>>3]=gt,Ue[y>>3]=tt)}}else w[yn>>2]=0,w[yn+4>>2]=0,w[yn+8>>2]=0,w[yn+12>>2]=0,w[yn+16>>2]=0,w[yn+20>>2]=0,w[yn+24>>2]=0,w[yn+28>>2]=0,T=w[Bn>>2]|0;while((it|0)<(T|0))}}function Hg(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0;if(!(Gc(y,x,T)|0))return B=0,B|0;if(B=y+8|0,(w[B>>2]|0)<=0)return B=1,B|0;for(R=y+12|0,y=0;;){if(j=y,y=y+1|0,Gc((w[R>>2]|0)+(j<<3)|0,x+(y<<5)|0,T)|0){y=0,R=6;break}if((y|0)>=(w[B>>2]|0)){y=1,R=6;break}}return(R|0)==6?y|0:0}function Xr(){return 8}function bp(){return 16}function U_(){return 168}function Wg(){return 8}function Yh(){return 16}function G_(){return 12}function qg(){return 8}function Qu(y){y=y|0;var x=0,T=0;return T=+Ue[y>>3],x=+Ue[y+8>>3],+ +Tr(+(T*T+x*x))}function VA(y,x,T,R,B){y=y|0,x=x|0,T=T|0,R=R|0,B=B|0;var j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0;pe=+Ue[y>>3],ae=+Ue[x>>3]-pe,Z=+Ue[y+8>>3],G=+Ue[x+8>>3]-Z,Xe=+Ue[T>>3],j=+Ue[R>>3]-Xe,tt=+Ue[T+8>>3],_e=+Ue[R+8>>3]-tt,j=(j*(Z-tt)-(pe-Xe)*_e)/(ae*_e-G*j),Ue[B>>3]=pe+ae*j,Ue[B+8>>3]=Z+G*j}function wp(y,x){return y=y|0,x=x|0,+Ue[y>>3]!=+Ue[x>>3]?(x=0,x|0):(x=+Ue[y+8>>3]==+Ue[x+8>>3],x|0)}function Zi(y,x){y=y|0,x=x|0;var T=0,R=0,B=0;return B=+Ue[y>>3]-+Ue[x>>3],R=+Ue[y+8>>3]-+Ue[x+8>>3],T=+Ue[y+16>>3]-+Ue[x+16>>3],+(B*B+R*R+T*T)}function Qh(y,x){y=y|0,x=x|0;var T=0,R=0,B=0;T=+Ue[y>>3],R=+qr(+T),T=+jn(+T),Ue[x+16>>3]=T,T=+Ue[y+8>>3],B=R*+qr(+T),Ue[x>>3]=B,T=R*+jn(+T),Ue[x+8>>3]=T}function $A(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0;if(pe=Ve,Ve=Ve+32|0,B=pe+16|0,j=pe,Hf(y,x,B),G=D_(y,x)|0,ae=fs(y,x)|0,Hh(G,j),x=ha(G,w[B>>2]|0)|0,!(Lr(G)|0))return ae=x,Ve=pe,ae|0;do switch(G|0){case 4:{y=0,T=14;break}case 14:{y=1,T=14;break}case 24:{y=2,T=14;break}case 38:{y=3,T=14;break}case 49:{y=4,T=14;break}case 58:{y=5,T=14;break}case 63:{y=6,T=14;break}case 72:{y=7,T=14;break}case 83:{y=8,T=14;break}case 97:{y=9,T=14;break}case 107:{y=10,T=14;break}case 117:{y=11,T=14;break}default:Z=0,R=0}while(0);return(T|0)==14&&(Z=w[22096+(y*24|0)+8>>2]|0,R=w[22096+(y*24|0)+16>>2]|0),y=w[B>>2]|0,(y|0)!=(w[j>>2]|0)&&(G=ao(G)|0,y=w[B>>2]|0,G|(y|0)==(R|0)&&(x=(x+1|0)%6|0)),(ae|0)==3&(y|0)==(R|0)?(ae=(x+5|0)%6|0,Ve=pe,ae|0):(ae|0)==5&(y|0)==(Z|0)?(ae=(x+1|0)%6|0,Ve=pe,ae|0):(ae=x,Ve=pe,ae|0)}function Ep(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0;return R=No(y,x)|0,(T+-1|0)>>>0>5||(B=(R|0)!=0,(T|0)==1&B)?(T=-1,T|0):(R=$A(y,x)|0,B?(T=(5-R+(w[22384+(T<<2)>>2]|0)|0)%5|0,T|0):(T=(6-R+(w[22416+(T<<2)>>2]|0)|0)%6|0,T|0))}function Kh(y,x,T){y=y|0,x=x|0,T=T|0;var R=0;(x|0)>0?(R=ma(x,4)|0,w[y>>2]=R,R||pt(23230,23253,40,23267)):w[y>>2]=0,w[y+4>>2]=x,w[y+8>>2]=0,w[y+12>>2]=T}function Sp(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0;B=y+4|0,j=y+12|0,G=y+8|0;e:for(;;){for(T=w[B>>2]|0,x=0;;){if((x|0)>=(T|0))break e;if(R=w[y>>2]|0,Z=w[R+(x<<2)>>2]|0,!Z)x=x+1|0;else break}x=R+(~~(+rr(+(+qi(10,+ +(15-(w[j>>2]|0)|0))*(+Ue[Z>>3]+ +Ue[Z+8>>3])))%+(T|0))>>>0<<2)|0,T=w[x>>2]|0;t:do if(T|0){if(R=Z+32|0,(T|0)==(Z|0))w[x>>2]=w[R>>2];else{if(T=T+32|0,x=w[T>>2]|0,!x)break;for(;(x|0)!=(Z|0);)if(T=x+32|0,x=w[T>>2]|0,!x)break t;w[T>>2]=w[R>>2]}Mr(Z),w[G>>2]=(w[G>>2]|0)+-1}while(0)}Mr(w[y>>2]|0)}function Tp(y){y=y|0;var x=0,T=0,R=0;for(R=w[y+4>>2]|0,T=0;;){if((T|0)>=(R|0)){x=0,T=4;break}if(x=w[(w[y>>2]|0)+(T<<2)>>2]|0,!x)T=T+1|0;else{T=4;break}}return(T|0)==4?x|0:0}function Sn(y,x){y=y|0,x=x|0;var T=0,R=0,B=0,j=0;if(T=~~(+rr(+(+qi(10,+ +(15-(w[y+12>>2]|0)|0))*(+Ue[x>>3]+ +Ue[x+8>>3])))%+(w[y+4>>2]|0))>>>0,T=(w[y>>2]|0)+(T<<2)|0,R=w[T>>2]|0,!R)return j=1,j|0;j=x+32|0;do if((R|0)!=(x|0)){if(T=w[R+32>>2]|0,!T)return j=1,j|0;for(B=T;;){if((B|0)==(x|0)){B=8;break}if(T=w[B+32>>2]|0,T)R=B,B=T;else{T=1,B=10;break}}if((B|0)==8){w[R+32>>2]=w[j>>2];break}else if((B|0)==10)return T|0}else w[T>>2]=w[j>>2];while(0);return Mr(x),j=y+8|0,w[j>>2]=(w[j>>2]|0)+-1,j=0,j|0}function Vl(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0;j=Ga(40)|0,j||pt(23283,23253,98,23296),w[j>>2]=w[x>>2],w[j+4>>2]=w[x+4>>2],w[j+8>>2]=w[x+8>>2],w[j+12>>2]=w[x+12>>2],B=j+16|0,w[B>>2]=w[T>>2],w[B+4>>2]=w[T+4>>2],w[B+8>>2]=w[T+8>>2],w[B+12>>2]=w[T+12>>2],w[j+32>>2]=0,B=~~(+rr(+(+qi(10,+ +(15-(w[y+12>>2]|0)|0))*(+Ue[x>>3]+ +Ue[x+8>>3])))%+(w[y+4>>2]|0))>>>0,B=(w[y>>2]|0)+(B<<2)|0,R=w[B>>2]|0;do if(!R)w[B>>2]=j;else{for(;!(pa(R,x)|0&&pa(R+16|0,T)|0);)if(B=w[R+32>>2]|0,R=B|0?B:R,!(w[R+32>>2]|0)){G=10;break}if((G|0)==10){w[R+32>>2]=j;break}return Mr(j),G=R,G|0}while(0);return G=y+8|0,w[G>>2]=(w[G>>2]|0)+1,G=j,G|0}function j_(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0;if(B=~~(+rr(+(+qi(10,+ +(15-(w[y+12>>2]|0)|0))*(+Ue[x>>3]+ +Ue[x+8>>3])))%+(w[y+4>>2]|0))>>>0,B=w[(w[y>>2]|0)+(B<<2)>>2]|0,!B)return T=0,T|0;if(!T){for(y=B;;){if(pa(y,x)|0){R=10;break}if(y=w[y+32>>2]|0,!y){y=0,R=10;break}}if((R|0)==10)return y|0}for(y=B;;){if(pa(y,x)|0&&pa(y+16|0,T)|0){R=10;break}if(y=w[y+32>>2]|0,!y){y=0,R=10;break}}return(R|0)==10?y|0:0}function Cp(y,x){y=y|0,x=x|0;var T=0;if(T=~~(+rr(+(+qi(10,+ +(15-(w[y+12>>2]|0)|0))*(+Ue[x>>3]+ +Ue[x+8>>3])))%+(w[y+4>>2]|0))>>>0,y=w[(w[y>>2]|0)+(T<<2)>>2]|0,!y)return T=0,T|0;for(;;){if(pa(y,x)|0){x=5;break}if(y=w[y+32>>2]|0,!y){y=0,x=5;break}}return(x|0)==5?y|0:0}function Pp(){return 23312}function hs(y){return y=+y,+ +td(+y)}function Vc(y){return y=+y,~~+hs(y)|0}function Ga(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0,Vt=0,yn=0,Cn=0,Rt=0,fn=0,it=0,On=0;On=Ve,Ve=Ve+16|0,tt=On;do if(y>>>0<245){if(pe=y>>>0<11?16:y+11&-8,y=pe>>>3,Xe=w[5829]|0,T=Xe>>>y,T&3|0)return x=(T&1^1)+y|0,y=23356+(x<<1<<2)|0,T=y+8|0,R=w[T>>2]|0,B=R+8|0,j=w[B>>2]|0,(j|0)==(y|0)?w[5829]=Xe&~(1<<x):(w[j+12>>2]=y,w[T>>2]=j),it=x<<3,w[R+4>>2]=it|3,it=R+it+4|0,w[it>>2]=w[it>>2]|1,it=B,Ve=On,it|0;if(_e=w[5831]|0,pe>>>0>_e>>>0){if(T|0)return x=2<<y,x=T<<y&(x|0-x),x=(x&0-x)+-1|0,Z=x>>>12&16,x=x>>>Z,T=x>>>5&8,x=x>>>T,j=x>>>2&4,x=x>>>j,y=x>>>1&2,x=x>>>y,R=x>>>1&1,R=(T|Z|j|y|R)+(x>>>R)|0,x=23356+(R<<1<<2)|0,y=x+8|0,j=w[y>>2]|0,Z=j+8|0,T=w[Z>>2]|0,(T|0)==(x|0)?(y=Xe&~(1<<R),w[5829]=y):(w[T+12>>2]=x,w[y>>2]=T,y=Xe),it=R<<3,G=it-pe|0,w[j+4>>2]=pe|3,B=j+pe|0,w[B+4>>2]=G|1,w[j+it>>2]=G,_e|0&&(R=w[5834]|0,x=_e>>>3,T=23356+(x<<1<<2)|0,x=1<<x,y&x?(y=T+8|0,x=w[y>>2]|0):(w[5829]=y|x,x=T,y=T+8|0),w[y>>2]=R,w[x+12>>2]=R,w[R+8>>2]=x,w[R+12>>2]=T),w[5831]=G,w[5834]=B,it=Z,Ve=On,it|0;if(j=w[5830]|0,j){for(T=(j&0-j)+-1|0,B=T>>>12&16,T=T>>>B,R=T>>>5&8,T=T>>>R,G=T>>>2&4,T=T>>>G,Z=T>>>1&2,T=T>>>Z,ae=T>>>1&1,ae=w[23620+((R|B|G|Z|ae)+(T>>>ae)<<2)>>2]|0,T=ae,Z=ae,ae=(w[ae+4>>2]&-8)-pe|0;y=w[T+16>>2]|0,!(!y&&(y=w[T+20>>2]|0,!y));)G=(w[y+4>>2]&-8)-pe|0,B=G>>>0<ae>>>0,T=y,Z=B?y:Z,ae=B?G:ae;if(G=Z+pe|0,G>>>0>Z>>>0){B=w[Z+24>>2]|0,x=w[Z+12>>2]|0;do if((x|0)==(Z|0)){if(y=Z+20|0,x=w[y>>2]|0,!x&&(y=Z+16|0,x=w[y>>2]|0,!x)){T=0;break}for(;;)if(R=x+20|0,T=w[R>>2]|0,T)x=T,y=R;else if(R=x+16|0,T=w[R>>2]|0,T)x=T,y=R;else break;w[y>>2]=0,T=x}else T=w[Z+8>>2]|0,w[T+12>>2]=x,w[x+8>>2]=T,T=x;while(0);do if(B|0){if(x=w[Z+28>>2]|0,y=23620+(x<<2)|0,(Z|0)==(w[y>>2]|0)){if(w[y>>2]=T,!T){w[5830]=j&~(1<<x);break}}else if(it=B+16|0,w[((w[it>>2]|0)==(Z|0)?it:B+20|0)>>2]=T,!T)break;w[T+24>>2]=B,x=w[Z+16>>2]|0,x|0&&(w[T+16>>2]=x,w[x+24>>2]=T),x=w[Z+20>>2]|0,x|0&&(w[T+20>>2]=x,w[x+24>>2]=T)}while(0);return ae>>>0<16?(it=ae+pe|0,w[Z+4>>2]=it|3,it=Z+it+4|0,w[it>>2]=w[it>>2]|1):(w[Z+4>>2]=pe|3,w[G+4>>2]=ae|1,w[G+ae>>2]=ae,_e|0&&(R=w[5834]|0,x=_e>>>3,T=23356+(x<<1<<2)|0,x=1<<x,x&Xe?(y=T+8|0,x=w[y>>2]|0):(w[5829]=x|Xe,x=T,y=T+8|0),w[y>>2]=R,w[x+12>>2]=R,w[R+8>>2]=x,w[R+12>>2]=T),w[5831]=ae,w[5834]=G),it=Z+8|0,Ve=On,it|0}else Xe=pe}else Xe=pe}else Xe=pe}else if(y>>>0<=4294967231)if(y=y+11|0,pe=y&-8,R=w[5830]|0,R){B=0-pe|0,y=y>>>8,y?pe>>>0>16777215?ae=31:(Xe=(y+1048320|0)>>>16&8,Vt=y<<Xe,Z=(Vt+520192|0)>>>16&4,Vt=Vt<<Z,ae=(Vt+245760|0)>>>16&2,ae=14-(Z|Xe|ae)+(Vt<<ae>>>15)|0,ae=pe>>>(ae+7|0)&1|ae<<1):ae=0,T=w[23620+(ae<<2)>>2]|0;e:do if(!T)T=0,y=0,Vt=61;else for(y=0,Z=pe<<((ae|0)==31?0:25-(ae>>>1)|0),j=0;;){if(G=(w[T+4>>2]&-8)-pe|0,G>>>0<B>>>0)if(G)y=T,B=G;else{y=T,B=0,Vt=65;break e}if(Vt=w[T+20>>2]|0,T=w[T+16+(Z>>>31<<2)>>2]|0,j=(Vt|0)==0|(Vt|0)==(T|0)?j:Vt,T)Z=Z<<1;else{T=j,Vt=61;break}}while(0);if((Vt|0)==61){if((T|0)==0&(y|0)==0){if(y=2<<ae,y=(y|0-y)&R,!y){Xe=pe;break}Xe=(y&0-y)+-1|0,G=Xe>>>12&16,Xe=Xe>>>G,j=Xe>>>5&8,Xe=Xe>>>j,Z=Xe>>>2&4,Xe=Xe>>>Z,ae=Xe>>>1&2,Xe=Xe>>>ae,T=Xe>>>1&1,y=0,T=w[23620+((j|G|Z|ae|T)+(Xe>>>T)<<2)>>2]|0}T?Vt=65:(Z=y,G=B)}if((Vt|0)==65)for(j=T;;)if(Xe=(w[j+4>>2]&-8)-pe|0,T=Xe>>>0<B>>>0,B=T?Xe:B,y=T?j:y,T=w[j+16>>2]|0,T||(T=w[j+20>>2]|0),T)j=T;else{Z=y,G=B;break}if(Z|0&&G>>>0<((w[5831]|0)-pe|0)>>>0&&(_e=Z+pe|0,_e>>>0>Z>>>0)){j=w[Z+24>>2]|0,x=w[Z+12>>2]|0;do if((x|0)==(Z|0)){if(y=Z+20|0,x=w[y>>2]|0,!x&&(y=Z+16|0,x=w[y>>2]|0,!x)){x=0;break}for(;;)if(B=x+20|0,T=w[B>>2]|0,T)x=T,y=B;else if(B=x+16|0,T=w[B>>2]|0,T)x=T,y=B;else break;w[y>>2]=0}else it=w[Z+8>>2]|0,w[it+12>>2]=x,w[x+8>>2]=it;while(0);do if(j){if(y=w[Z+28>>2]|0,T=23620+(y<<2)|0,(Z|0)==(w[T>>2]|0)){if(w[T>>2]=x,!x){R=R&~(1<<y),w[5830]=R;break}}else if(it=j+16|0,w[((w[it>>2]|0)==(Z|0)?it:j+20|0)>>2]=x,!x)break;w[x+24>>2]=j,y=w[Z+16>>2]|0,y|0&&(w[x+16>>2]=y,w[y+24>>2]=x),y=w[Z+20>>2]|0,y&&(w[x+20>>2]=y,w[y+24>>2]=x)}while(0);e:do if(G>>>0<16)it=G+pe|0,w[Z+4>>2]=it|3,it=Z+it+4|0,w[it>>2]=w[it>>2]|1;else{if(w[Z+4>>2]=pe|3,w[_e+4>>2]=G|1,w[_e+G>>2]=G,x=G>>>3,G>>>0<256){T=23356+(x<<1<<2)|0,y=w[5829]|0,x=1<<x,y&x?(y=T+8|0,x=w[y>>2]|0):(w[5829]=y|x,x=T,y=T+8|0),w[y>>2]=_e,w[x+12>>2]=_e,w[_e+8>>2]=x,w[_e+12>>2]=T;break}if(x=G>>>8,x?G>>>0>16777215?T=31:(fn=(x+1048320|0)>>>16&8,it=x<<fn,Rt=(it+520192|0)>>>16&4,it=it<<Rt,T=(it+245760|0)>>>16&2,T=14-(Rt|fn|T)+(it<<T>>>15)|0,T=G>>>(T+7|0)&1|T<<1):T=0,x=23620+(T<<2)|0,w[_e+28>>2]=T,y=_e+16|0,w[y+4>>2]=0,w[y>>2]=0,y=1<<T,!(R&y)){w[5830]=R|y,w[x>>2]=_e,w[_e+24>>2]=x,w[_e+12>>2]=_e,w[_e+8>>2]=_e;break}x=w[x>>2]|0;t:do if((w[x+4>>2]&-8|0)!=(G|0)){for(R=G<<((T|0)==31?0:25-(T>>>1)|0);T=x+16+(R>>>31<<2)|0,y=w[T>>2]|0,!!y;)if((w[y+4>>2]&-8|0)==(G|0)){x=y;break t}else R=R<<1,x=y;w[T>>2]=_e,w[_e+24>>2]=x,w[_e+12>>2]=_e,w[_e+8>>2]=_e;break e}while(0);fn=x+8|0,it=w[fn>>2]|0,w[it+12>>2]=_e,w[fn>>2]=_e,w[_e+8>>2]=it,w[_e+12>>2]=x,w[_e+24>>2]=0}while(0);return it=Z+8|0,Ve=On,it|0}else Xe=pe}else Xe=pe;else Xe=-1;while(0);if(T=w[5831]|0,T>>>0>=Xe>>>0)return x=T-Xe|0,y=w[5834]|0,x>>>0>15?(it=y+Xe|0,w[5834]=it,w[5831]=x,w[it+4>>2]=x|1,w[y+T>>2]=x,w[y+4>>2]=Xe|3):(w[5831]=0,w[5834]=0,w[y+4>>2]=T|3,it=y+T+4|0,w[it>>2]=w[it>>2]|1),it=y+8|0,Ve=On,it|0;if(G=w[5832]|0,G>>>0>Xe>>>0)return Rt=G-Xe|0,w[5832]=Rt,it=w[5835]|0,fn=it+Xe|0,w[5835]=fn,w[fn+4>>2]=Rt|1,w[it+4>>2]=Xe|3,it=it+8|0,Ve=On,it|0;if(w[5947]|0?y=w[5949]|0:(w[5949]=4096,w[5948]=4096,w[5950]=-1,w[5951]=-1,w[5952]=0,w[5940]=0,w[5947]=tt&-16^1431655768,y=4096),Z=Xe+48|0,ae=Xe+47|0,j=y+ae|0,B=0-y|0,pe=j&B,pe>>>0<=Xe>>>0||(y=w[5939]|0,y|0&&(_e=w[5937]|0,tt=_e+pe|0,tt>>>0<=_e>>>0|tt>>>0>y>>>0)))return it=0,Ve=On,it|0;e:do if(w[5940]&4)x=0,Vt=143;else{T=w[5835]|0;t:do if(T){for(R=23764;tt=w[R>>2]|0,!(tt>>>0<=T>>>0&&(tt+(w[R+4>>2]|0)|0)>>>0>T>>>0);)if(y=w[R+8>>2]|0,y)R=y;else{Vt=128;break t}if(x=j-G&B,x>>>0<2147483647)if(y=al(x|0)|0,(y|0)==((w[R>>2]|0)+(w[R+4>>2]|0)|0)){if((y|0)!=-1){G=x,j=y,Vt=145;break e}}else R=y,Vt=136;else x=0}else Vt=128;while(0);do if((Vt|0)==128)if(T=al(0)|0,(T|0)!=-1&&(x=T,gt=w[5948]|0,kt=gt+-1|0,x=(kt&x|0?(kt+x&0-gt)-x|0:0)+pe|0,gt=w[5937]|0,kt=x+gt|0,x>>>0>Xe>>>0&x>>>0<2147483647)){if(tt=w[5939]|0,tt|0&&kt>>>0<=gt>>>0|kt>>>0>tt>>>0){x=0;break}if(y=al(x|0)|0,(y|0)==(T|0)){G=x,j=T,Vt=145;break e}else R=y,Vt=136}else x=0;while(0);do if((Vt|0)==136){if(T=0-x|0,!(Z>>>0>x>>>0&(x>>>0<2147483647&(R|0)!=-1)))if((R|0)==-1){x=0;break}else{G=x,j=R,Vt=145;break e}if(y=w[5949]|0,y=ae-x+y&0-y,y>>>0>=2147483647){G=x,j=R,Vt=145;break e}if((al(y|0)|0)==-1){al(T|0)|0,x=0;break}else{G=y+x|0,j=R,Vt=145;break e}}while(0);w[5940]=w[5940]|4,Vt=143}while(0);if((Vt|0)==143&&pe>>>0<2147483647&&(Rt=al(pe|0)|0,kt=al(0)|0,yn=kt-Rt|0,Cn=yn>>>0>(Xe+40|0)>>>0,!((Rt|0)==-1|Cn^1|Rt>>>0<kt>>>0&((Rt|0)!=-1&(kt|0)!=-1)^1))&&(G=Cn?yn:x,j=Rt,Vt=145),(Vt|0)==145){x=(w[5937]|0)+G|0,w[5937]=x,x>>>0>(w[5938]|0)>>>0&&(w[5938]=x),ae=w[5835]|0;e:do if(ae){for(x=23764;;){if(y=w[x>>2]|0,T=w[x+4>>2]|0,(j|0)==(y+T|0)){Vt=154;break}if(R=w[x+8>>2]|0,R)x=R;else break}if((Vt|0)==154&&(fn=x+4|0,(w[x+12>>2]&8|0)==0)&&j>>>0>ae>>>0&y>>>0<=ae>>>0){w[fn>>2]=T+G,it=(w[5832]|0)+G|0,Rt=ae+8|0,Rt=Rt&7|0?0-Rt&7:0,fn=ae+Rt|0,Rt=it-Rt|0,w[5835]=fn,w[5832]=Rt,w[fn+4>>2]=Rt|1,w[ae+it+4>>2]=40,w[5836]=w[5951];break}for(j>>>0<(w[5833]|0)>>>0&&(w[5833]=j),T=j+G|0,x=23764;;){if((w[x>>2]|0)==(T|0)){Vt=162;break}if(y=w[x+8>>2]|0,y)x=y;else break}if((Vt|0)==162&&!(w[x+12>>2]&8|0)){w[x>>2]=j,_e=x+4|0,w[_e>>2]=(w[_e>>2]|0)+G,_e=j+8|0,_e=j+(_e&7|0?0-_e&7:0)|0,x=T+8|0,x=T+(x&7|0?0-x&7:0)|0,pe=_e+Xe|0,Z=x-_e-Xe|0,w[_e+4>>2]=Xe|3;t:do if((ae|0)==(x|0))it=(w[5832]|0)+Z|0,w[5832]=it,w[5835]=pe,w[pe+4>>2]=it|1;else{if((w[5834]|0)==(x|0)){it=(w[5831]|0)+Z|0,w[5831]=it,w[5834]=pe,w[pe+4>>2]=it|1,w[pe+it>>2]=it;break}if(y=w[x+4>>2]|0,(y&3|0)==1){G=y&-8,R=y>>>3;n:do if(y>>>0<256)if(y=w[x+8>>2]|0,T=w[x+12>>2]|0,(T|0)==(y|0)){w[5829]=w[5829]&~(1<<R);break}else{w[y+12>>2]=T,w[T+8>>2]=y;break}else{j=w[x+24>>2]|0,y=w[x+12>>2]|0;do if((y|0)==(x|0)){if(T=x+16|0,R=T+4|0,y=w[R>>2]|0,y)T=R;else if(y=w[T>>2]|0,!y){y=0;break}for(;;)if(B=y+20|0,R=w[B>>2]|0,R)y=R,T=B;else if(B=y+16|0,R=w[B>>2]|0,R)y=R,T=B;else break;w[T>>2]=0}else it=w[x+8>>2]|0,w[it+12>>2]=y,w[y+8>>2]=it;while(0);if(!j)break;T=w[x+28>>2]|0,R=23620+(T<<2)|0;do if((w[R>>2]|0)!=(x|0)){if(it=j+16|0,w[((w[it>>2]|0)==(x|0)?it:j+20|0)>>2]=y,!y)break n}else{if(w[R>>2]=y,y|0)break;w[5830]=w[5830]&~(1<<T);break n}while(0);if(w[y+24>>2]=j,T=x+16|0,R=w[T>>2]|0,R|0&&(w[y+16>>2]=R,w[R+24>>2]=y),T=w[T+4>>2]|0,!T)break;w[y+20>>2]=T,w[T+24>>2]=y}while(0);x=x+G|0,B=G+Z|0}else B=Z;if(x=x+4|0,w[x>>2]=w[x>>2]&-2,w[pe+4>>2]=B|1,w[pe+B>>2]=B,x=B>>>3,B>>>0<256){T=23356+(x<<1<<2)|0,y=w[5829]|0,x=1<<x,y&x?(y=T+8|0,x=w[y>>2]|0):(w[5829]=y|x,x=T,y=T+8|0),w[y>>2]=pe,w[x+12>>2]=pe,w[pe+8>>2]=x,w[pe+12>>2]=T;break}x=B>>>8;do if(!x)R=0;else{if(B>>>0>16777215){R=31;break}fn=(x+1048320|0)>>>16&8,it=x<<fn,Rt=(it+520192|0)>>>16&4,it=it<<Rt,R=(it+245760|0)>>>16&2,R=14-(Rt|fn|R)+(it<<R>>>15)|0,R=B>>>(R+7|0)&1|R<<1}while(0);if(x=23620+(R<<2)|0,w[pe+28>>2]=R,y=pe+16|0,w[y+4>>2]=0,w[y>>2]=0,y=w[5830]|0,T=1<<R,!(y&T)){w[5830]=y|T,w[x>>2]=pe,w[pe+24>>2]=x,w[pe+12>>2]=pe,w[pe+8>>2]=pe;break}x=w[x>>2]|0;n:do if((w[x+4>>2]&-8|0)!=(B|0)){for(R=B<<((R|0)==31?0:25-(R>>>1)|0);T=x+16+(R>>>31<<2)|0,y=w[T>>2]|0,!!y;)if((w[y+4>>2]&-8|0)==(B|0)){x=y;break n}else R=R<<1,x=y;w[T>>2]=pe,w[pe+24>>2]=x,w[pe+12>>2]=pe,w[pe+8>>2]=pe;break t}while(0);fn=x+8|0,it=w[fn>>2]|0,w[it+12>>2]=pe,w[fn>>2]=pe,w[pe+8>>2]=it,w[pe+12>>2]=x,w[pe+24>>2]=0}while(0);return it=_e+8|0,Ve=On,it|0}for(x=23764;y=w[x>>2]|0,!(y>>>0<=ae>>>0&&(it=y+(w[x+4>>2]|0)|0,it>>>0>ae>>>0));)x=w[x+8>>2]|0;B=it+-47|0,y=B+8|0,y=B+(y&7|0?0-y&7:0)|0,B=ae+16|0,y=y>>>0<B>>>0?ae:y,x=y+8|0,T=G+-40|0,Rt=j+8|0,Rt=Rt&7|0?0-Rt&7:0,fn=j+Rt|0,Rt=T-Rt|0,w[5835]=fn,w[5832]=Rt,w[fn+4>>2]=Rt|1,w[j+T+4>>2]=40,w[5836]=w[5951],T=y+4|0,w[T>>2]=27,w[x>>2]=w[5941],w[x+4>>2]=w[5942],w[x+8>>2]=w[5943],w[x+12>>2]=w[5944],w[5941]=j,w[5942]=G,w[5944]=0,w[5943]=x,x=y+24|0;do fn=x,x=x+4|0,w[x>>2]=7;while((fn+8|0)>>>0<it>>>0);if((y|0)!=(ae|0)){if(j=y-ae|0,w[T>>2]=w[T>>2]&-2,w[ae+4>>2]=j|1,w[y>>2]=j,x=j>>>3,j>>>0<256){T=23356+(x<<1<<2)|0,y=w[5829]|0,x=1<<x,y&x?(y=T+8|0,x=w[y>>2]|0):(w[5829]=y|x,x=T,y=T+8|0),w[y>>2]=ae,w[x+12>>2]=ae,w[ae+8>>2]=x,w[ae+12>>2]=T;break}if(x=j>>>8,x?j>>>0>16777215?R=31:(fn=(x+1048320|0)>>>16&8,it=x<<fn,Rt=(it+520192|0)>>>16&4,it=it<<Rt,R=(it+245760|0)>>>16&2,R=14-(Rt|fn|R)+(it<<R>>>15)|0,R=j>>>(R+7|0)&1|R<<1):R=0,T=23620+(R<<2)|0,w[ae+28>>2]=R,w[ae+20>>2]=0,w[B>>2]=0,x=w[5830]|0,y=1<<R,!(x&y)){w[5830]=x|y,w[T>>2]=ae,w[ae+24>>2]=T,w[ae+12>>2]=ae,w[ae+8>>2]=ae;break}x=w[T>>2]|0;t:do if((w[x+4>>2]&-8|0)!=(j|0)){for(R=j<<((R|0)==31?0:25-(R>>>1)|0);T=x+16+(R>>>31<<2)|0,y=w[T>>2]|0,!!y;)if((w[y+4>>2]&-8|0)==(j|0)){x=y;break t}else R=R<<1,x=y;w[T>>2]=ae,w[ae+24>>2]=x,w[ae+12>>2]=ae,w[ae+8>>2]=ae;break e}while(0);fn=x+8|0,it=w[fn>>2]|0,w[it+12>>2]=ae,w[fn>>2]=ae,w[ae+8>>2]=it,w[ae+12>>2]=x,w[ae+24>>2]=0}}else it=w[5833]|0,(it|0)==0|j>>>0<it>>>0&&(w[5833]=j),w[5941]=j,w[5942]=G,w[5944]=0,w[5838]=w[5947],w[5837]=-1,w[5842]=23356,w[5841]=23356,w[5844]=23364,w[5843]=23364,w[5846]=23372,w[5845]=23372,w[5848]=23380,w[5847]=23380,w[5850]=23388,w[5849]=23388,w[5852]=23396,w[5851]=23396,w[5854]=23404,w[5853]=23404,w[5856]=23412,w[5855]=23412,w[5858]=23420,w[5857]=23420,w[5860]=23428,w[5859]=23428,w[5862]=23436,w[5861]=23436,w[5864]=23444,w[5863]=23444,w[5866]=23452,w[5865]=23452,w[5868]=23460,w[5867]=23460,w[5870]=23468,w[5869]=23468,w[5872]=23476,w[5871]=23476,w[5874]=23484,w[5873]=23484,w[5876]=23492,w[5875]=23492,w[5878]=23500,w[5877]=23500,w[5880]=23508,w[5879]=23508,w[5882]=23516,w[5881]=23516,w[5884]=23524,w[5883]=23524,w[5886]=23532,w[5885]=23532,w[5888]=23540,w[5887]=23540,w[5890]=23548,w[5889]=23548,w[5892]=23556,w[5891]=23556,w[5894]=23564,w[5893]=23564,w[5896]=23572,w[5895]=23572,w[5898]=23580,w[5897]=23580,w[5900]=23588,w[5899]=23588,w[5902]=23596,w[5901]=23596,w[5904]=23604,w[5903]=23604,it=G+-40|0,Rt=j+8|0,Rt=Rt&7|0?0-Rt&7:0,fn=j+Rt|0,Rt=it-Rt|0,w[5835]=fn,w[5832]=Rt,w[fn+4>>2]=Rt|1,w[j+it+4>>2]=40,w[5836]=w[5951];while(0);if(x=w[5832]|0,x>>>0>Xe>>>0)return Rt=x-Xe|0,w[5832]=Rt,it=w[5835]|0,fn=it+Xe|0,w[5835]=fn,w[fn+4>>2]=Rt|1,w[it+4>>2]=Xe|3,it=it+8|0,Ve=On,it|0}return it=Pp()|0,w[it>>2]=12,it=0,Ve=On,it|0}function Mr(y){y=y|0;var x=0,T=0,R=0,B=0,j=0,G=0,Z=0,ae=0;if(y){T=y+-8|0,B=w[5833]|0,y=w[y+-4>>2]|0,x=y&-8,ae=T+x|0;do if(y&1)Z=T,G=T;else{if(R=w[T>>2]|0,!(y&3)||(G=T+(0-R)|0,j=R+x|0,G>>>0<B>>>0))return;if((w[5834]|0)==(G|0)){if(y=ae+4|0,x=w[y>>2]|0,(x&3|0)!=3){Z=G,x=j;break}w[5831]=j,w[y>>2]=x&-2,w[G+4>>2]=j|1,w[G+j>>2]=j;return}if(T=R>>>3,R>>>0<256)if(y=w[G+8>>2]|0,x=w[G+12>>2]|0,(x|0)==(y|0)){w[5829]=w[5829]&~(1<<T),Z=G,x=j;break}else{w[y+12>>2]=x,w[x+8>>2]=y,Z=G,x=j;break}B=w[G+24>>2]|0,y=w[G+12>>2]|0;do if((y|0)==(G|0)){if(x=G+16|0,T=x+4|0,y=w[T>>2]|0,y)x=T;else if(y=w[x>>2]|0,!y){y=0;break}for(;;)if(R=y+20|0,T=w[R>>2]|0,T)y=T,x=R;else if(R=y+16|0,T=w[R>>2]|0,T)y=T,x=R;else break;w[x>>2]=0}else Z=w[G+8>>2]|0,w[Z+12>>2]=y,w[y+8>>2]=Z;while(0);if(B){if(x=w[G+28>>2]|0,T=23620+(x<<2)|0,(w[T>>2]|0)==(G|0)){if(w[T>>2]=y,!y){w[5830]=w[5830]&~(1<<x),Z=G,x=j;break}}else if(Z=B+16|0,w[((w[Z>>2]|0)==(G|0)?Z:B+20|0)>>2]=y,!y){Z=G,x=j;break}w[y+24>>2]=B,x=G+16|0,T=w[x>>2]|0,T|0&&(w[y+16>>2]=T,w[T+24>>2]=y),x=w[x+4>>2]|0,x?(w[y+20>>2]=x,w[x+24>>2]=y,Z=G,x=j):(Z=G,x=j)}else Z=G,x=j}while(0);if(!(G>>>0>=ae>>>0)&&(y=ae+4|0,R=w[y>>2]|0,!!(R&1))){if(R&2)w[y>>2]=R&-2,w[Z+4>>2]=x|1,w[G+x>>2]=x,B=x;else{if((w[5835]|0)==(ae|0)){if(ae=(w[5832]|0)+x|0,w[5832]=ae,w[5835]=Z,w[Z+4>>2]=ae|1,(Z|0)!=(w[5834]|0))return;w[5834]=0,w[5831]=0;return}if((w[5834]|0)==(ae|0)){ae=(w[5831]|0)+x|0,w[5831]=ae,w[5834]=G,w[Z+4>>2]=ae|1,w[G+ae>>2]=ae;return}B=(R&-8)+x|0,T=R>>>3;do if(R>>>0<256)if(x=w[ae+8>>2]|0,y=w[ae+12>>2]|0,(y|0)==(x|0)){w[5829]=w[5829]&~(1<<T);break}else{w[x+12>>2]=y,w[y+8>>2]=x;break}else{j=w[ae+24>>2]|0,y=w[ae+12>>2]|0;do if((y|0)==(ae|0)){if(x=ae+16|0,T=x+4|0,y=w[T>>2]|0,y)x=T;else if(y=w[x>>2]|0,!y){T=0;break}for(;;)if(R=y+20|0,T=w[R>>2]|0,T)y=T,x=R;else if(R=y+16|0,T=w[R>>2]|0,T)y=T,x=R;else break;w[x>>2]=0,T=y}else T=w[ae+8>>2]|0,w[T+12>>2]=y,w[y+8>>2]=T,T=y;while(0);if(j|0){if(y=w[ae+28>>2]|0,x=23620+(y<<2)|0,(w[x>>2]|0)==(ae|0)){if(w[x>>2]=T,!T){w[5830]=w[5830]&~(1<<y);break}}else if(R=j+16|0,w[((w[R>>2]|0)==(ae|0)?R:j+20|0)>>2]=T,!T)break;w[T+24>>2]=j,y=ae+16|0,x=w[y>>2]|0,x|0&&(w[T+16>>2]=x,w[x+24>>2]=T),y=w[y+4>>2]|0,y|0&&(w[T+20>>2]=y,w[y+24>>2]=T)}}while(0);if(w[Z+4>>2]=B|1,w[G+B>>2]=B,(Z|0)==(w[5834]|0)){w[5831]=B;return}}if(y=B>>>3,B>>>0<256){T=23356+(y<<1<<2)|0,x=w[5829]|0,y=1<<y,x&y?(x=T+8|0,y=w[x>>2]|0):(w[5829]=x|y,y=T,x=T+8|0),w[x>>2]=Z,w[y+12>>2]=Z,w[Z+8>>2]=y,w[Z+12>>2]=T;return}y=B>>>8,y?B>>>0>16777215?R=31:(G=(y+1048320|0)>>>16&8,ae=y<<G,j=(ae+520192|0)>>>16&4,ae=ae<<j,R=(ae+245760|0)>>>16&2,R=14-(j|G|R)+(ae<<R>>>15)|0,R=B>>>(R+7|0)&1|R<<1):R=0,y=23620+(R<<2)|0,w[Z+28>>2]=R,w[Z+20>>2]=0,w[Z+16>>2]=0,x=w[5830]|0,T=1<<R;e:do if(!(x&T))w[5830]=x|T,w[y>>2]=Z,w[Z+24>>2]=y,w[Z+12>>2]=Z,w[Z+8>>2]=Z;else{y=w[y>>2]|0;t:do if((w[y+4>>2]&-8|0)!=(B|0)){for(R=B<<((R|0)==31?0:25-(R>>>1)|0);T=y+16+(R>>>31<<2)|0,x=w[T>>2]|0,!!x;)if((w[x+4>>2]&-8|0)==(B|0)){y=x;break t}else R=R<<1,y=x;w[T>>2]=Z,w[Z+24>>2]=y,w[Z+12>>2]=Z,w[Z+8>>2]=Z;break e}while(0);G=y+8|0,ae=w[G>>2]|0,w[ae+12>>2]=Z,w[G>>2]=Z,w[Z+8>>2]=ae,w[Z+12>>2]=y,w[Z+24>>2]=0}while(0);if(ae=(w[5837]|0)+-1|0,w[5837]=ae,!(ae|0)){for(y=23772;y=w[y>>2]|0,y;)y=y+8|0;w[5837]=-1}}}}function ma(y,x){y=y|0,x=x|0;var T=0;return y?(T=Bo(x,y)|0,(x|y)>>>0>65535&&(T=((T>>>0)/(y>>>0)|0|0)==(x|0)?T:-1)):T=0,y=Ga(T)|0,!y||!(w[y+-4>>2]&3)||Aa(y|0,0,T|0)|0,y|0}function V_(y,x,T,R){return y=y|0,x=x|0,T=T|0,R=R|0,T=y+T>>>0,Hn(x+R+(T>>>0<y>>>0|0)>>>0|0),T|0|0}function $c(y,x,T,R){return y=y|0,x=x|0,T=T|0,R=R|0,R=x-R-(T>>>0>y>>>0|0)>>>0,Hn(R|0),y-T>>>0|0|0}function Wf(y){return y=y|0,(y?31-($o(y^y-1)|0)|0:32)|0}function HA(y,x,T,R,B){y=y|0,x=x|0,T=T|0,R=R|0,B=B|0;var j=0,G=0,Z=0,ae=0,pe=0,_e=0,Xe=0,tt=0,gt=0,kt=0;if(_e=y,ae=x,pe=ae,G=T,tt=R,Z=tt,!pe)return j=(B|0)!=0,Z?j?(w[B>>2]=y|0,w[B+4>>2]=x&0,tt=0,B=0,Hn(tt|0),B|0):(tt=0,B=0,Hn(tt|0),B|0):(j&&(w[B>>2]=(_e>>>0)%(G>>>0),w[B+4>>2]=0),tt=0,B=(_e>>>0)/(G>>>0)>>>0,Hn(tt|0),B|0);j=(Z|0)==0;do if(G){if(!j){if(j=($o(Z|0)|0)-($o(pe|0)|0)|0,j>>>0<=31){Xe=j+1|0,Z=31-j|0,x=j-31>>31,G=Xe,y=_e>>>(Xe>>>0)&x|pe<<Z,x=pe>>>(Xe>>>0)&x,j=0,Z=_e<<Z;break}return B?(w[B>>2]=y|0,w[B+4>>2]=ae|x&0,tt=0,B=0,Hn(tt|0),B|0):(tt=0,B=0,Hn(tt|0),B|0)}if(j=G-1|0,j&G|0){Z=($o(G|0)|0)+33-($o(pe|0)|0)|0,kt=64-Z|0,Xe=32-Z|0,ae=Xe>>31,gt=Z-32|0,x=gt>>31,G=Z,y=Xe-1>>31&pe>>>(gt>>>0)|(pe<<Xe|_e>>>(Z>>>0))&x,x=x&pe>>>(Z>>>0),j=_e<<kt&ae,Z=(pe<<kt|_e>>>(gt>>>0))&ae|_e<<Xe&Z-33>>31;break}return B|0&&(w[B>>2]=j&_e,w[B+4>>2]=0),(G|0)==1?(gt=ae|x&0,kt=y|0|0,Hn(gt|0),kt|0):(kt=Wf(G|0)|0,gt=pe>>>(kt>>>0)|0,kt=pe<<32-kt|_e>>>(kt>>>0)|0,Hn(gt|0),kt|0)}else{if(j)return B|0&&(w[B>>2]=(pe>>>0)%(G>>>0),w[B+4>>2]=0),gt=0,kt=(pe>>>0)/(G>>>0)>>>0,Hn(gt|0),kt|0;if(!_e)return B|0&&(w[B>>2]=0,w[B+4>>2]=(pe>>>0)%(Z>>>0)),gt=0,kt=(pe>>>0)/(Z>>>0)>>>0,Hn(gt|0),kt|0;if(j=Z-1|0,!(j&Z))return B|0&&(w[B>>2]=y|0,w[B+4>>2]=j&pe|x&0),gt=0,kt=pe>>>((Wf(Z|0)|0)>>>0),Hn(gt|0),kt|0;if(j=($o(Z|0)|0)-($o(pe|0)|0)|0,j>>>0<=30){x=j+1|0,Z=31-j|0,G=x,y=pe<<Z|_e>>>(x>>>0),x=pe>>>(x>>>0),j=0,Z=_e<<Z;break}return B?(w[B>>2]=y|0,w[B+4>>2]=ae|x&0,gt=0,kt=0,Hn(gt|0),kt|0):(gt=0,kt=0,Hn(gt|0),kt|0)}while(0);if(!G)pe=Z,ae=0,Z=0;else{Xe=T|0|0,_e=tt|R&0,pe=V_(Xe|0,_e|0,-1,-1)|0,T=Ke()|0,ae=Z,Z=0;do R=ae,ae=j>>>31|ae<<1,j=Z|j<<1,R=y<<1|R>>>31|0,tt=y>>>31|x<<1|0,$c(pe|0,T|0,R|0,tt|0)|0,kt=Ke()|0,gt=kt>>31|((kt|0)<0?-1:0)<<1,Z=gt&1,y=$c(R|0,tt|0,gt&Xe|0,(((kt|0)<0?-1:0)>>31|((kt|0)<0?-1:0)<<1)&_e|0)|0,x=Ke()|0,G=G-1|0;while(G|0);pe=ae,ae=0}return G=0,B|0&&(w[B>>2]=y,w[B+4>>2]=x),gt=(j|0)>>>31|(pe|G)<<1|(G<<1|j>>>31)&0|ae,kt=(j<<1|0)&-2|Z,Hn(gt|0),kt|0}function Hc(y,x,T,R){y=y|0,x=x|0,T=T|0,R=R|0;var B=0,j=0;return j=Ve,Ve=Ve+16|0,B=j|0,HA(y,x,T,R,B)|0,Ve=j,Hn(w[B+4>>2]|0),w[B>>2]|0|0}function An(y,x,T){return y=y|0,x=x|0,T=T|0,(T|0)<32?(Hn(x>>>T|0),y>>>T|(x&(1<<T)-1)<<32-T):(Hn(0),x>>>T-32|0)}function Dn(y,x,T){return y=y|0,x=x|0,T=T|0,(T|0)<32?(Hn(x<<T|(y&(1<<T)-1<<32-T)>>>32-T|0),y<<T):(Hn(y<<T-32|0),0)}function Xg(y,x){return y=+y,x=+x,y!=y?+x:x!=x?+y:+ka(+y,+x)}function Jh(y){return y=+y,y>=0?+fr(y+.5):+Vo(y-.5)}function ed(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0;if((T|0)>=8192)return gi(y|0,x|0,T|0)|0,y|0;if(j=y|0,B=y+T|0,(y&3)==(x&3)){for(;y&3;){if(!T)return j|0;Gn[y>>0]=Gn[x>>0]|0,y=y+1|0,x=x+1|0,T=T-1|0}for(T=B&-4|0,R=T-64|0;(y|0)<=(R|0);)w[y>>2]=w[x>>2],w[y+4>>2]=w[x+4>>2],w[y+8>>2]=w[x+8>>2],w[y+12>>2]=w[x+12>>2],w[y+16>>2]=w[x+16>>2],w[y+20>>2]=w[x+20>>2],w[y+24>>2]=w[x+24>>2],w[y+28>>2]=w[x+28>>2],w[y+32>>2]=w[x+32>>2],w[y+36>>2]=w[x+36>>2],w[y+40>>2]=w[x+40>>2],w[y+44>>2]=w[x+44>>2],w[y+48>>2]=w[x+48>>2],w[y+52>>2]=w[x+52>>2],w[y+56>>2]=w[x+56>>2],w[y+60>>2]=w[x+60>>2],y=y+64|0,x=x+64|0;for(;(y|0)<(T|0);)w[y>>2]=w[x>>2],y=y+4|0,x=x+4|0}else for(T=B-4|0;(y|0)<(T|0);)Gn[y>>0]=Gn[x>>0]|0,Gn[y+1>>0]=Gn[x+1>>0]|0,Gn[y+2>>0]=Gn[x+2>>0]|0,Gn[y+3>>0]=Gn[x+3>>0]|0,y=y+4|0,x=x+4|0;for(;(y|0)<(B|0);)Gn[y>>0]=Gn[x>>0]|0,y=y+1|0,x=x+1|0;return j|0}function Aa(y,x,T){y=y|0,x=x|0,T=T|0;var R=0,B=0,j=0,G=0;if(j=y+T|0,x=x&255,(T|0)>=67){for(;y&3;)Gn[y>>0]=x,y=y+1|0;for(R=j&-4|0,G=x|x<<8|x<<16|x<<24,B=R-64|0;(y|0)<=(B|0);)w[y>>2]=G,w[y+4>>2]=G,w[y+8>>2]=G,w[y+12>>2]=G,w[y+16>>2]=G,w[y+20>>2]=G,w[y+24>>2]=G,w[y+28>>2]=G,w[y+32>>2]=G,w[y+36>>2]=G,w[y+40>>2]=G,w[y+44>>2]=G,w[y+48>>2]=G,w[y+52>>2]=G,w[y+56>>2]=G,w[y+60>>2]=G,y=y+64|0;for(;(y|0)<(R|0);)w[y>>2]=G,y=y+4|0}for(;(y|0)<(j|0);)Gn[y>>0]=x,y=y+1|0;return j-T|0}function td(y){return y=+y,y>=0?+fr(y+.5):+Vo(y-.5)}function al(y){y=y|0;var x=0,T=0,R=0;return R=Vi()|0,T=w[Ir>>2]|0,x=T+y|0,(y|0)>0&(x|0)<(T|0)|(x|0)<0?(fa(x|0)|0,za(12),-1):(x|0)>(R|0)&&!(Nf(x|0)|0)?(za(12),-1):(w[Ir>>2]=x,T|0)}return{___uremdi3:Hc,_bitshift64Lshr:An,_bitshift64Shl:Dn,_calloc:ma,_cellAreaKm2:BA,_cellAreaM2:L_,_cellAreaRads2:R_,_compact:ax,_destroyLinkedPolygon:hx,_edgeLengthKm:Bg,_edgeLengthM:DA,_emscripten_replace_memory:$h,_exactEdgeLengthKm:NA,_exactEdgeLengthM:ox,_exactEdgeLengthRads:$f,_experimentalH3ToLocalIj:z_,_experimentalLocalIjToH3:Yu,_free:Mr,_geoToH3:zg,_getDestinationH3IndexFromUnidirectionalEdge:Gg,_getH3IndexesFromUnidirectionalEdge:Zh,_getH3UnidirectionalEdge:_p,_getH3UnidirectionalEdgeBoundary:jg,_getH3UnidirectionalEdgesFromHexagon:ux,_getOriginH3IndexFromUnidirectionalEdge:F_,_getPentagonIndexes:Ap,_getRes0Indexes:il,_h3Distance:Vg,_h3GetBaseCell:D_,_h3GetFaces:Ug,_h3GetResolution:sx,_h3IndexesAreNeighbors:UA,_h3IsPentagon:No,_h3IsResClassIII:kA,_h3IsValid:Ng,_h3Line:vp,_h3LineSize:sl,_h3SetToLinkedGeo:Ao,_h3ToCenterChild:B_,_h3ToChildren:bs,_h3ToGeo:du,_h3ToGeoBoundary:jl,_h3ToParent:dp,_h3UnidirectionalEdgeIsValid:k_,_hexAreaKm2:LA,_hexAreaM2:Dg,_hexRing:Oe,_i64Subtract:$c,_kRing:Rs,_kRingDistances:xr,_llvm_minnum_f64:Xg,_llvm_round_f64:Jh,_malloc:Ga,_maxFaceCount:N_,_maxH3ToChildrenSize:FA,_maxKringSize:Os,_maxPolyfillSize:He,_maxUncompactSize:Xh,_memcpy:ed,_memset:Aa,_numHexagons:jr,_pentagonIndexCount:lx,_pointDistKm:Uc,_pointDistM:O_,_pointDistRads:Vf,_polyfill:Ot,_res0IndexCount:da,_round:td,_sbrk:al,_sizeOfCoordIJ:qg,_sizeOfGeoBoundary:U_,_sizeOfGeoCoord:bp,_sizeOfGeoPolygon:Yh,_sizeOfGeofence:Wg,_sizeOfH3Index:Xr,_sizeOfLinkedGeoPolygon:G_,_uncompact:pp,establishStackSpace:Cr,stackAlloc:cu,stackRestore:ur,stackSave:_n}}(Ae,ze,se);e.___uremdi3=Me.___uremdi3,e._bitshift64Lshr=Me._bitshift64Lshr,e._bitshift64Shl=Me._bitshift64Shl,e._calloc=Me._calloc,e._cellAreaKm2=Me._cellAreaKm2,e._cellAreaM2=Me._cellAreaM2,e._cellAreaRads2=Me._cellAreaRads2,e._compact=Me._compact,e._destroyLinkedPolygon=Me._destroyLinkedPolygon,e._edgeLengthKm=Me._edgeLengthKm,e._edgeLengthM=Me._edgeLengthM;var rt=e._emscripten_replace_memory=Me._emscripten_replace_memory;e._exactEdgeLengthKm=Me._exactEdgeLengthKm,e._exactEdgeLengthM=Me._exactEdgeLengthM,e._exactEdgeLengthRads=Me._exactEdgeLengthRads,e._experimentalH3ToLocalIj=Me._experimentalH3ToLocalIj,e._experimentalLocalIjToH3=Me._experimentalLocalIjToH3,e._free=Me._free,e._geoToH3=Me._geoToH3,e._getDestinationH3IndexFromUnidirectionalEdge=Me._getDestinationH3IndexFromUnidirectionalEdge,e._getH3IndexesFromUnidirectionalEdge=Me._getH3IndexesFromUnidirectionalEdge,e._getH3UnidirectionalEdge=Me._getH3UnidirectionalEdge,e._getH3UnidirectionalEdgeBoundary=Me._getH3UnidirectionalEdgeBoundary,e._getH3UnidirectionalEdgesFromHexagon=Me._getH3UnidirectionalEdgesFromHexagon,e._getOriginH3IndexFromUnidirectionalEdge=Me._getOriginH3IndexFromUnidirectionalEdge,e._getPentagonIndexes=Me._getPentagonIndexes,e._getRes0Indexes=Me._getRes0Indexes,e._h3Distance=Me._h3Distance,e._h3GetBaseCell=Me._h3GetBaseCell,e._h3GetFaces=Me._h3GetFaces,e._h3GetResolution=Me._h3GetResolution,e._h3IndexesAreNeighbors=Me._h3IndexesAreNeighbors,e._h3IsPentagon=Me._h3IsPentagon,e._h3IsResClassIII=Me._h3IsResClassIII,e._h3IsValid=Me._h3IsValid,e._h3Line=Me._h3Line,e._h3LineSize=Me._h3LineSize,e._h3SetToLinkedGeo=Me._h3SetToLinkedGeo,e._h3ToCenterChild=Me._h3ToCenterChild,e._h3ToChildren=Me._h3ToChildren,e._h3ToGeo=Me._h3ToGeo,e._h3ToGeoBoundary=Me._h3ToGeoBoundary,e._h3ToParent=Me._h3ToParent,e._h3UnidirectionalEdgeIsValid=Me._h3UnidirectionalEdgeIsValid,e._hexAreaKm2=Me._hexAreaKm2,e._hexAreaM2=Me._hexAreaM2,e._hexRing=Me._hexRing,e._i64Subtract=Me._i64Subtract,e._kRing=Me._kRing,e._kRingDistances=Me._kRingDistances,e._llvm_minnum_f64=Me._llvm_minnum_f64,e._llvm_round_f64=Me._llvm_round_f64,e._malloc=Me._malloc,e._maxFaceCount=Me._maxFaceCount,e._maxH3ToChildrenSize=Me._maxH3ToChildrenSize,e._maxKringSize=Me._maxKringSize,e._maxPolyfillSize=Me._maxPolyfillSize,e._maxUncompactSize=Me._maxUncompactSize,e._memcpy=Me._memcpy,e._memset=Me._memset,e._numHexagons=Me._numHexagons,e._pentagonIndexCount=Me._pentagonIndexCount,e._pointDistKm=Me._pointDistKm,e._pointDistM=Me._pointDistM,e._pointDistRads=Me._pointDistRads,e._polyfill=Me._polyfill,e._res0IndexCount=Me._res0IndexCount,e._round=Me._round,e._sbrk=Me._sbrk,e._sizeOfCoordIJ=Me._sizeOfCoordIJ,e._sizeOfGeoBoundary=Me._sizeOfGeoBoundary,e._sizeOfGeoCoord=Me._sizeOfGeoCoord,e._sizeOfGeoPolygon=Me._sizeOfGeoPolygon,e._sizeOfGeofence=Me._sizeOfGeofence,e._sizeOfH3Index=Me._sizeOfH3Index,e._sizeOfLinkedGeoPolygon=Me._sizeOfLinkedGeoPolygon,e._uncompact=Me._uncompact,e.establishStackSpace=Me.establishStackSpace;var ht=e.stackAlloc=Me.stackAlloc,ft=e.stackRestore=Me.stackRestore,nt=e.stackSave=Me.stackSave;if(e.asm=Me,e.cwrap=z,e.setValue=P,e.getValue=O,e.getTempRet0=_,cr){Ri(cr)||(cr=o(cr));{qn();var wt=function(ot){ot.byteLength&&(ot=new Uint8Array(ot)),Ce.set(ot,E),e.memoryInitializerRequest&&delete e.memoryInitializerRequest.response,or()},sn=function(){a(cr,wt,function(){throw"could not load memory initializer "+cr})},dn=ge(cr);if(dn)wt(dn.buffer);else if(e.memoryInitializerRequest){var Qt=function(){var ot=e.memoryInitializerRequest,Pt=ot.response;if(ot.status!==200&&ot.status!==0){var rn=ge(e.memoryInitializerRequestURL);if(rn)Pt=rn.buffer;else{console.warn("a problem seems to have happened with Module.memoryInitializerRequest, status: "+ot.status+", retrying "+cr),sn();return}}wt(Pt)};e.memoryInitializerRequest.response?setTimeout(Qt,0):e.memoryInitializerRequest.addEventListener("load",Qt)}else sn()}}var sr;Ln=function ot(){sr||pr(),sr||(Ln=ot)};function pr(ot){if(Jt>0||(Tn(),Jt>0))return;function Pt(){sr||(sr=!0,!D&&(Nt(),Zt(),e.onRuntimeInitialized&&e.onRuntimeInitialized(),Wt()))}e.setStatus?(e.setStatus("Running..."),setTimeout(function(){setTimeout(function(){e.setStatus("")},1),Pt()},1)):Pt()}e.run=pr;function tr(ot){throw e.onAbort&&e.onAbort(ot),ot+="",s(ot),u(ot),D=!0,"abort("+ot+"). Build with -s ASSERTIONS=1 for more info."}if(e.abort=tr,e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();return pr(),t}(typeof mn=="object"?mn:{}),dr="number",Cb=dr,Dr=dr,$r=dr,yu=dr,mi=dr,vGe=[["sizeOfH3Index",dr],["sizeOfGeoCoord",dr],["sizeOfGeoBoundary",dr],["sizeOfGeoPolygon",dr],["sizeOfGeofence",dr],["sizeOfLinkedGeoPolygon",dr],["sizeOfCoordIJ",dr],["h3IsValid",Cb,[Dr,$r]],["geoToH3",Dr,[dr,dr,yu]],["h3ToGeo",null,[Dr,$r,mi]],["h3ToGeoBoundary",null,[Dr,$r,mi]],["maxKringSize",dr,[dr]],["kRing",null,[Dr,$r,dr,mi]],["kRingDistances",null,[Dr,$r,dr,mi,mi]],["hexRing",null,[Dr,$r,dr,mi]],["maxPolyfillSize",dr,[mi,yu]],["polyfill",null,[mi,yu,mi]],["h3SetToLinkedGeo",null,[mi,dr,mi]],["destroyLinkedPolygon",null,[mi]],["compact",dr,[mi,mi,dr]],["uncompact",dr,[mi,dr,mi,dr,yu]],["maxUncompactSize",dr,[mi,dr,yu]],["h3IsPentagon",Cb,[Dr,$r]],["h3IsResClassIII",Cb,[Dr,$r]],["h3GetBaseCell",dr,[Dr,$r]],["h3GetResolution",dr,[Dr,$r]],["maxFaceCount",dr,[Dr,$r]],["h3GetFaces",null,[Dr,$r,mi]],["h3ToParent",Dr,[Dr,$r,yu]],["h3ToChildren",null,[Dr,$r,yu,mi]],["h3ToCenterChild",Dr,[Dr,$r,yu]],["maxH3ToChildrenSize",dr,[Dr,$r,yu]],["h3IndexesAreNeighbors",Cb,[Dr,$r,Dr,$r]],["getH3UnidirectionalEdge",Dr,[Dr,$r,Dr,$r]],["getOriginH3IndexFromUnidirectionalEdge",Dr,[Dr,$r]],["getDestinationH3IndexFromUnidirectionalEdge",Dr,[Dr,$r]],["h3UnidirectionalEdgeIsValid",Cb,[Dr,$r]],["getH3IndexesFromUnidirectionalEdge",null,[Dr,$r,mi]],["getH3UnidirectionalEdgesFromHexagon",null,[Dr,$r,mi]],["getH3UnidirectionalEdgeBoundary",null,[Dr,$r,mi]],["h3Distance",dr,[Dr,$r,Dr,$r]],["h3Line",dr,[Dr,$r,Dr,$r,mi]],["h3LineSize",dr,[Dr,$r,Dr,$r]],["experimentalH3ToLocalIj",dr,[Dr,$r,Dr,$r,mi]],["experimentalLocalIjToH3",dr,[Dr,$r,mi,mi]],["hexAreaM2",dr,[yu]],["hexAreaKm2",dr,[yu]],["edgeLengthM",dr,[yu]],["edgeLengthKm",dr,[yu]],["pointDistM",dr,[mi,mi]],["pointDistKm",dr,[mi,mi]],["pointDistRads",dr,[mi,mi]],["cellAreaM2",dr,[Dr,$r]],["cellAreaKm2",dr,[Dr,$r]],["cellAreaRads2",dr,[Dr,$r]],["exactEdgeLengthM",dr,[Dr,$r]],["exactEdgeLengthKm",dr,[Dr,$r]],["exactEdgeLengthRads",dr,[Dr,$r]],["numHexagons",dr,[yu]],["getRes0Indexes",null,[mi]],["res0IndexCount",dr],["getPentagonIndexes",null,[dr,mi]],["pentagonIndexCount",dr]],$n={};vGe.forEach(function(e){$n[e[0]]=mn.cwrap.apply(mn,e)});var cv=16,Xl=4,Sq=4,hA=8,Ll=$n.sizeOfH3Index(),hL=$n.sizeOfGeoCoord(),ese=$n.sizeOfGeoBoundary(),xGe=$n.sizeOfGeoPolygon(),yw=$n.sizeOfGeofence(),bGe=$n.sizeOfLinkedGeoPolygon(),tse=$n.sizeOfCoordIJ(),Du={m:"m",m2:"m2",km:"km",km2:"km2",rads:"rads",rads2:"rads2"};function Z1(t){if(typeof t!="number"||t<0||t>15||Math.floor(t)!==t)throw new Error("Invalid resolution: "+t)}var wGe=/[^0-9a-fA-F]/;function pi(t){if(Array.isArray(t)&&t.length===2&&Number.isInteger(t[0])&&Number.isInteger(t[1]))return t;if(typeof t!="string"||wGe.test(t))return[0,0];var e=parseInt(t.substring(0,t.length-8),cv),n=parseInt(t.substring(t.length-8),cv);return[n,e]}function Tq(t){if(t>=0)return t.toString(cv);t=t&2147483647;var e=nse(8,t.toString(cv)),n=(parseInt(e[0],cv)+8).toString(cv);return e=n+e.substring(1),e}function dL(t,e){return Tq(e)+nse(8,Tq(t))}function nse(t,e){for(var n=t-e.length,r="",i=0;i<n;i++)r+="0";return r=r+e,r}function Cq(t,e,n){for(var r=t.length,i=mn._calloc(r,hL),o=n?1:0,a=n?0:1,s=0;s<r*2;s+=2)mn.HEAPF64.set([t[s/2][o],t[s/2][a]].map(gL),i/hA+s);return mn.HEAPU32.set([r,i],e/Xl),e}function EGe(t,e){var n=t.length-1,r=mn._calloc(xGe),i=0,o=i+yw,a=o+Xl;Cq(t[0],r+i,e);var s;if(n>0){s=mn._calloc(n,yw);for(var u=0;u<n;u++)Cq(t[u+1],s+yw*u,e)}return mn.setValue(r+o,n,"i32"),mn.setValue(r+a,s,"i32"),r}function SGe(t){var e=0,n=e+yw,r=n+Xl,i=Xl;mn._free(mn.getValue(t+e+i,"i8*"));var o=mn.getValue(t+n,"i32");if(o>0){for(var a=mn.getValue(t+r,"i32"),s=0;s<o;s++)mn._free(mn.getValue(a+yw*s+i,"i8*"));mn._free(a)}mn._free(t)}function rse(t){var e=mn.getTempRet0();return[t,e]}function Y1(t){var e=rse(t),n=e[0],r=e[1];return r?dL(n,r):null}function ise(t,e){e===void 0&&(e=0);var n=mn.getValue(t+Xl*e*2,"i32"),r=mn.getValue(t+Xl*(e*2+1),"i32");return r?dL(n,r):null}function TGe(t,e,n){mn.HEAPU32.set(pi(t),e/Xl+2*n)}function jh(t,e){for(var n=[],r=0;r<e;r++){var i=ise(t,r);i!==null&&n.push(i)}return n}function mU(t,e){for(var n=e.length,r=0;r<n;r++)TGe(e[r],t,r)}function Pq(t,e){var n=mn._calloc(1,hL);return mn.HEAPF64.set([t,e].map(gL),n/hA),n}function uM(t){return gse(mn.getValue(t,"double"))}function AU(t){return[uM(t),uM(t+hA)]}function ose(t){return[uM(t+hA),uM(t)]}function sse(t,e,n){for(var r=mn.getValue(t,"i32"),i=t+hA,o=[],a=e?ose:AU,s=0;s<r*2;s+=2)o.push(a(i+hA*s));return n&&o.push(o[0]),o}function CGe(t,e){for(var n=[],r=e?ose:AU,i,o,a,s;t;){for(n.push(i=[]),o=mn.getValue(t,"i8*");o;){for(i.push(a=[]),s=mn.getValue(o,"i8*");s;)a.push(r(s)),s=mn.getValue(s+hA*2,"i8*");e&&a.push(a[0]),o=mn.getValue(o+Sq*2,"i8*")}t=mn.getValue(t+Sq*2,"i8*")}return n}function PGe(t){return{i:mn.getValue(t,"i32"),j:mn.getValue(t+Xl,"i32")}}function IGe(t,e){var n=e.i,r=e.j;mn.setValue(t,n,"i32"),mn.setValue(t+Xl,r,"i32")}function MGe(t,e){for(var n=[],r=0;r<e;r++){var i=mn.getValue(t+Xl*r,"i32");i>=0&&n.push(i)}return n}function ase(t){var e=pi(t),n=e[0],r=e[1];return!!$n.h3IsValid(n,r)}function lse(t){var e=pi(t),n=e[0],r=e[1];return!!$n.h3IsPentagon(n,r)}function OGe(t){var e=pi(t),n=e[0],r=e[1];return!!$n.h3IsResClassIII(n,r)}function RGe(t){var e=pi(t),n=e[0],r=e[1];return $n.h3GetBaseCell(n,r)}function LGe(t){var e=pi(t),n=e[0],r=e[1],i=$n.maxFaceCount(n,r),o=mn._malloc(Xl*i);$n.h3GetFaces(n,r,o);var a=MGe(o,i);return mn._free(o),a}function use(t){var e=pi(t),n=e[0],r=e[1];return $n.h3IsValid(n,r)?$n.h3GetResolution(n,r):-1}function cse(t,e,n){var r=mn._malloc(hL);mn.HEAPF64.set([t,e].map(gL),r/hA);var i=Y1($n.geoToH3(r,n));return mn._free(r),i}function pL(t){var e=mn._malloc(hL),n=pi(t),r=n[0],i=n[1];$n.h3ToGeo(r,i,e);var o=AU(e);return mn._free(e),o}function fse(t,e){var n=mn._malloc(ese),r=pi(t),i=r[0],o=r[1];$n.h3ToGeoBoundary(i,o,n);var a=sse(n,e,e);return mn._free(n),a}function DGe(t,e){var n=pi(t),r=n[0],i=n[1];return Y1($n.h3ToParent(r,i,e))}function BGe(t,e){if(!ase(t))return[];var n=pi(t),r=n[0],i=n[1],o=$n.maxH3ToChildrenSize(r,i,e),a=mn._calloc(o,Ll);$n.h3ToChildren(r,i,e,a);var s=jh(a,o);return mn._free(a),s}function NGe(t,e){var n=pi(t),r=n[0],i=n[1];return Y1($n.h3ToCenterChild(r,i,e))}function FGe(t,e){var n=pi(t),r=n[0],i=n[1],o=$n.maxKringSize(e),a=mn._calloc(o,Ll);$n.kRing(r,i,e,a);var s=jh(a,o);return mn._free(a),s}function kGe(t,e){var n=pi(t),r=n[0],i=n[1],o=$n.maxKringSize(e),a=mn._calloc(o,Ll),s=mn._calloc(o,Xl);$n.kRingDistances(r,i,e,a,s);for(var u=[],d=0;d<e+1;d++)u.push([]);for(var g=0;g<o*2;g+=2){var _=mn.getValue(a+Xl*g,"i32"),E=mn.getValue(a+Xl*(g+1),"i32"),P=mn.getValue(s+Xl*(g/2),"i32");(_!==0||E!==0)&&u[P].push(dL(_,E))}return mn._free(a),mn._free(s),u}function zGe(t,e){var n=e===0?1:6*e,r=mn._calloc(n,Ll),i=$n.hexRing.apply($n,pi(t).concat([e],[r]));if(i!==0)throw mn._free(r),new Error("Failed to get hexRing (encountered a pentagon?)");var o=jh(r,n);return mn._free(r),o}function UGe(t,e,n){if(Z1(e),n=!!n,t.length===0||t[0].length===0)return[];typeof t[0][0]=="number"&&(t=[t]);var r=EGe(t,n),i=$n.maxPolyfillSize(r,e),o=mn._calloc(i,Ll);$n.polyfill(r,e,o);var a=jh(o,i);return mn._free(o),SGe(r),a}function hse(t,e){if(!t||!t.length)return[];var n=t.length,r=mn._calloc(n,Ll);mU(r,t);var i=mn._calloc(bGe),o=i;$n.h3SetToLinkedGeo(r,n,i);var a=CGe(i,e);return $n.destroyLinkedPolygon(o),mn._free(o),mn._free(r),a}function GGe(t){if(!t||!t.length)return[];var e=t.length,n=mn._calloc(e,Ll);mU(n,t);var r=mn._calloc(e,Ll),i=$n.compact(n,r,e);if(i!==0)throw mn._free(n),mn._free(r),new Error("Failed to compact, malformed input data (duplicate hexagons?)");var o=jh(r,e);return mn._free(n),mn._free(r),o}function jGe(t,e){if(Z1(e),!t||!t.length)return[];var n=t.length,r=mn._calloc(n,Ll);mU(r,t);var i=$n.maxUncompactSize(r,n,e),o=mn._calloc(i,Ll),a=$n.uncompact(r,n,o,i,e);if(a!==0)throw mn._free(r),mn._free(o),new Error("Failed to uncompact (bad resolution?)");var s=jh(o,i);return mn._free(r),mn._free(o),s}function VGe(t,e){var n=pi(t),r=n[0],i=n[1],o=pi(e),a=o[0],s=o[1];return!!$n.h3IndexesAreNeighbors(r,i,a,s)}function $Ge(t,e){var n=pi(t),r=n[0],i=n[1],o=pi(e),a=o[0],s=o[1];return Y1($n.getH3UnidirectionalEdge(r,i,a,s))}function HGe(t){var e=pi(t),n=e[0],r=e[1];return Y1($n.getOriginH3IndexFromUnidirectionalEdge(n,r))}function WGe(t){var e=pi(t),n=e[0],r=e[1];return Y1($n.getDestinationH3IndexFromUnidirectionalEdge(n,r))}function qGe(t){var e=pi(t),n=e[0],r=e[1];return!!$n.h3UnidirectionalEdgeIsValid(n,r)}function XGe(t){var e=pi(t),n=e[0],r=e[1],i=2,o=mn._calloc(i,Ll);$n.getH3IndexesFromUnidirectionalEdge(n,r,o);var a=jh(o,i);return mn._free(o),a}function ZGe(t){var e=pi(t),n=e[0],r=e[1],i=6,o=mn._calloc(i,Ll);$n.getH3UnidirectionalEdgesFromHexagon(n,r,o);var a=jh(o,i);return mn._free(o),a}function YGe(t,e){var n=mn._malloc(ese),r=pi(t),i=r[0],o=r[1];$n.getH3UnidirectionalEdgeBoundary(i,o,n);var a=sse(n,e);return mn._free(n),a}function dse(t,e){var n=pi(t),r=n[0],i=n[1],o=pi(e),a=o[0],s=o[1];return $n.h3Distance(r,i,a,s)}function QGe(t,e){var n=pi(t),r=n[0],i=n[1],o=pi(e),a=o[0],s=o[1],u=$n.h3LineSize(r,i,a,s);if(u<0)throw new Error("Line cannot be calculated");var d=mn._calloc(u,Ll);$n.h3Line(r,i,a,s,d);var g=jh(d,u);return mn._free(d),g}function KGe(t,e){var n=mn._malloc(tse),r=$n.experimentalH3ToLocalIj.apply($n,pi(t).concat(pi(e),[n])),i=PGe(n);switch(mn._free(n),r){case 0:return i;case 1:throw new Error("Incompatible origin and index.");case 2:default:throw new Error("Local IJ coordinates undefined for this origin and index pair. The index may be too far from the origin.");case 3:case 4:case 5:throw new Error("Encountered possible pentagon distortion")}}function JGe(t,e){if(!e||typeof e.i!="number"||typeof e.j!="number")throw new Error("Coordinates must be provided as an {i, j} object");var n=mn._malloc(tse),r=mn._malloc(Ll);IGe(n,e);var i=$n.experimentalLocalIjToH3.apply($n,pi(t).concat([n],[r])),o=ise(r);if(mn._free(n),mn._free(r),i!==0)throw new Error("Index not defined for this origin and IJ coordinates pair. IJ coordinates may be too far from origin, or a pentagon distortion was encountered.");return o}function eje(t,e,n){var r=Pq(t[0],t[1]),i=Pq(e[0],e[1]),o;switch(n){case Du.m:o=$n.pointDistM(r,i);break;case Du.km:o=$n.pointDistKm(r,i);break;case Du.rads:o=$n.pointDistRads(r,i);break;default:o=null}if(mn._free(r),mn._free(i),o===null)throw new Error("Unknown unit: "+n);return o}function tje(t,e){var n=pi(t),r=n[0],i=n[1];switch(e){case Du.m2:return $n.cellAreaM2(r,i);case Du.km2:return $n.cellAreaKm2(r,i);case Du.rads2:return $n.cellAreaRads2(r,i);default:throw new Error("Unknown unit: "+e)}}function nje(t,e){var n=pi(t),r=n[0],i=n[1];switch(e){case Du.m:return $n.exactEdgeLengthM(r,i);case Du.km:return $n.exactEdgeLengthKm(r,i);case Du.rads:return $n.exactEdgeLengthRads(r,i);default:throw new Error("Unknown unit: "+e)}}function rje(t,e){switch(Z1(t),e){case Du.m2:return $n.hexAreaM2(t);case Du.km2:return $n.hexAreaKm2(t);default:throw new Error("Unknown unit: "+e)}}function pse(t,e){switch(Z1(t),e){case Du.m:return $n.edgeLengthM(t);case Du.km:return $n.edgeLengthKm(t);default:throw new Error("Unknown unit: "+e)}}function ije(t){Z1(t);var e=rse($n.numHexagons(t)),n=e[0],r=e[1];return r?r*Math.pow(2,32)+n:n}function oje(){var t=$n.res0IndexCount(),e=mn._malloc(Ll*t);$n.getRes0Indexes(e);var n=jh(e,t);return mn._free(e),n}function sje(t){Z1(t);var e=$n.pentagonIndexCount(),n=mn._malloc(Ll*e);$n.getPentagonIndexes(t,n);var r=jh(n,e);return mn._free(n),r}function gL(t){return t*Math.PI/180}function gse(t){return t*180/Math.PI}const aje=Object.freeze(Object.defineProperty({__proto__:null,UNITS:Du,cellArea:tje,compact:GGe,degsToRads:gL,edgeLength:pse,exactEdgeLength:nje,experimentalH3ToLocalIj:KGe,experimentalLocalIjToH3:JGe,geoToH3:cse,getDestinationH3IndexFromUnidirectionalEdge:WGe,getH3IndexesFromUnidirectionalEdge:XGe,getH3UnidirectionalEdge:$Ge,getH3UnidirectionalEdgeBoundary:YGe,getH3UnidirectionalEdgesFromHexagon:ZGe,getOriginH3IndexFromUnidirectionalEdge:HGe,getPentagonIndexes:sje,getRes0Indexes:oje,h3Distance:dse,h3GetBaseCell:RGe,h3GetFaces:LGe,h3GetResolution:use,h3IndexToSplitLong:pi,h3IndexesAreNeighbors:VGe,h3IsPentagon:lse,h3IsResClassIII:OGe,h3IsValid:ase,h3Line:QGe,h3SetToMultiPolygon:hse,h3ToCenterChild:NGe,h3ToChildren:BGe,h3ToGeo:pL,h3ToGeoBoundary:fse,h3ToParent:DGe,h3UnidirectionalEdgeIsValid:qGe,hexArea:rje,hexRing:zGe,kRing:FGe,kRingDistances:kGe,numHexagons:ije,pointDist:eje,polyfill:UGe,radsToDegs:gse,splitLongToh3Index:dL,uncompact:jGe},Symbol.toStringTag,{value:"Module"})),lje=10;function mse(t,e){e=e===void 0?t[0][0]:e;for(const n of t){const r=n[0]-e;r>180?n[0]-=360:r<-180&&(n[0]+=360)}}function uje(t,e,n){const[r,i]=pL(t),o=e.length;mse(e,i);const a=e[0]===e[o-1]?o-1:o;for(let s=0;s<a;s++)e[s][0]=pc(i,e[s][0],n),e[s][1]=pc(r,e[s][1],n)}function cje(t,e,n){const r=t(e,n),[i,o]=pL(r);return[o,i]}function Iq(t,e=1){const n=fse(t,!0);return e!==1?uje(t,n,e):mse(n),n}function fje(t){const e=new Float64Array(t.length*2);let n=0;for(const r of t)e[n++]=r[0],e[n++]=r[1];return e}function hje(t,e){let n;return t==null?n=e:typeof t=="object"?n={...t,coverage:e}:n={getHexagon:t,coverage:e},n}const dje={...EA.defaultProps,highPrecision:"auto",coverage:{type:"number",min:0,max:1,value:1},centerHexagon:null,getHexagon:{type:"accessor",value:t=>t.hexagon},extruded:!0};class E_ extends Uh{constructor(...e){super(...e),q(this,"state",void 0)}initializeState(){E_._checkH3Lib(),this.state={edgeLengthKM:0,resolution:-1}}shouldUpdateState({changeFlags:e}){return this._shouldUseHighPrecision()?e.propsOrDataChanged:e.somethingChanged}updateState({props:e,changeFlags:n}){if(e.highPrecision!==!0&&(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagon)){const r=this._calculateH3DataProps();this.setState(r)}this._updateVertices(this.context.viewport)}_calculateH3DataProps(){let e=-1,n=!1,r=!1;const{iterable:i,objectInfo:o}=Tg(this.props.data);for(const a of i){o.index++;const s=this.props.getHexagon(a,o),u=use(s);if(e<0){if(e=u,!this.props.highPrecision)break}else if(e!==u){r=!0;break}if(lse(s)){n=!0;break}}return{resolution:e,edgeLengthKM:e>=0?pse(e,"km"):0,hasMultipleRes:r,hasPentagon:n}}_shouldUseHighPrecision(){if(this.props.highPrecision==="auto"){const{resolution:e,hasPentagon:n,hasMultipleRes:r}=this.state,{viewport:i}=this.context;return!!(i!=null&&i.resolution)||r||n||e>=0&&e<=5}return this.props.highPrecision}_updateVertices(e){if(this._shouldUseHighPrecision())return;const{resolution:n,edgeLengthKM:r,centerHex:i}=this.state;if(n<0)return;const o=this.props.centerHexagon||cse(e.latitude,e.longitude,n);if(i===o)return;if(i){const E=dse(i,o);if(E>=0&&E*r<lje)return}const{unitsPerMeter:a}=e.distanceScales;let s=Iq(o);const[u,d]=pL(o),[g,_]=e.projectFlat([d,u]);s=s.map(E=>{const P=e.projectFlat(E);return[(P[0]-g)/a[0],(P[1]-_)/a[1]]}),this.setState({centerHex:o,vertices:s})}renderLayers(){return this._shouldUseHighPrecision()?this._renderPolygonLayer():this._renderColumnLayer()}_getForwardProps(){const{elevationScale:e,material:n,coverage:r,extruded:i,wireframe:o,stroked:a,filled:s,lineWidthUnits:u,lineWidthScale:d,lineWidthMinPixels:g,lineWidthMaxPixels:_,getFillColor:E,getElevation:P,getLineColor:O,getLineWidth:D,transitions:V,updateTriggers:k}=this.props;return{elevationScale:e,extruded:i,coverage:r,wireframe:o,stroked:a,filled:s,lineWidthUnits:u,lineWidthScale:d,lineWidthMinPixels:g,lineWidthMaxPixels:_,material:n,getElevation:P,getFillColor:E,getLineColor:O,getLineWidth:D,transitions:V,updateTriggers:{getFillColor:k.getFillColor,getElevation:k.getElevation,getLineColor:k.getLineColor,getLineWidth:k.getLineWidth}}}_renderPolygonLayer(){const{data:e,getHexagon:n,updateTriggers:r,coverage:i}=this.props,o=this.getSubLayerClass("hexagon-cell-hifi",EA),a=this._getForwardProps();return a.updateTriggers.getPolygon=hje(r.getHexagon,i),new o(a,this.getSubLayerProps({id:"hexagon-cell-hifi",updateTriggers:a.updateTriggers}),{data:e,_normalize:!1,_windingOrder:"CCW",positionFormat:"XY",getPolygon:(s,u)=>{const d=n(s,u);return fje(Iq(d,i))}})}_renderColumnLayer(){const{data:e,getHexagon:n,updateTriggers:r}=this.props,i=this.getSubLayerClass("hexagon-cell",u2),o=this._getForwardProps();return o.updateTriggers.getPosition=r.getHexagon,new i(o,this.getSubLayerProps({id:"hexagon-cell",flatShading:!0,updateTriggers:o.updateTriggers}),{data:e,diskResolution:6,radius:1,vertices:this.state.vertices,getPosition:cje.bind(null,n)})}}q(E_,"defaultProps",dje);q(E_,"layerName","H3HexagonLayer");q(E_,"_checkH3Lib",()=>{});const pje={getHexagons:{type:"accessor",value:t=>t.hexagons}};class _U extends w_{initializeState(){E_._checkH3Lib()}updateState({props:e,changeFlags:n}){if(n.dataChanged||n.updateTriggersChanged&&n.updateTriggersChanged.getHexagons){const{data:r,getHexagons:i}=e,o=[],{iterable:a,objectInfo:s}=Tg(r);for(const u of a){s.index++;const d=i(u,s),g=hse(d,!0);for(const _ of g)o.push(this.getSubLayerRow({polygon:_},u,s.index))}this.setState({polygons:o})}}indexToBounds(){const{getElevation:e,getFillColor:n,getLineColor:r,getLineWidth:i}=this.props;return{data:this.state.polygons,getPolygon:o=>o.polygon,getElevation:this.getSubLayerAccessor(e),getFillColor:this.getSubLayerAccessor(n),getLineColor:this.getSubLayerAccessor(r),getLineWidth:this.getSubLayerAccessor(i)}}}q(_U,"layerName","H3ClusterLayer");q(_U,"defaultProps",pje);const BB=Math.PI/180,dT=new Float32Array(16),Mq=new Float32Array(12);function Oq(t,e,n){const r=e[0]*BB,i=e[1]*BB,o=e[2]*BB,a=Math.sin(o),s=Math.sin(r),u=Math.sin(i),d=Math.cos(o),g=Math.cos(r),_=Math.cos(i),E=n[0],P=n[1],O=n[2];t[0]=E*_*g,t[1]=E*u*g,t[2]=E*-s,t[3]=P*(-u*d+_*s*a),t[4]=P*(_*d+u*s*a),t[5]=P*g*a,t[6]=O*(u*a+_*s*d),t[7]=O*(-_*a+u*s*d),t[8]=O*g*d}function Rq(t){return t[0]=t[0],t[1]=t[1],t[2]=t[2],t[3]=t[4],t[4]=t[5],t[5]=t[6],t[6]=t[8],t[7]=t[9],t[8]=t[10],t[9]=t[12],t[10]=t[13],t[11]=t[14],t.subarray(0,12)}const Ase={size:12,accessor:["getOrientation","getScale","getTranslation","getTransformMatrix"],shaderAttributes:{instanceModelMatrix__LOCATION_0:{size:3,elementOffset:0},instanceModelMatrix__LOCATION_1:{size:3,elementOffset:3},instanceModelMatrix__LOCATION_2:{size:3,elementOffset:6},instanceTranslation:{size:3,elementOffset:9}},update(t,{startRow:e,endRow:n}){const{data:r,getOrientation:i,getScale:o,getTranslation:a,getTransformMatrix:s}=this.props,u=Array.isArray(s),d=u&&s.length===16,g=Array.isArray(o),_=Array.isArray(i),E=Array.isArray(a),P=d||!u&&!!s(r[0]);P?t.constant=d:t.constant=_&&g&&E;const O=t.value;if(t.constant){let D;P?(dT.set(s),D=Rq(dT)):(D=Mq,Oq(D,i,o),D.set(a,9)),t.value=new Float32Array(D)}else{let D=e*t.size;const{iterable:V,objectInfo:k}=Tg(r,e,n);for(const F of V){k.index++;let z;if(P)dT.set(d?s:s(F,k)),z=Rq(dT);else{z=Mq;const X=_?i:i(F,k),Y=g?o:o(F,k);Oq(z,X,Y),z.set(E?a:a(F,k),9)}O[D++]=z[0],O[D++]=z[1],O[D++]=z[2],O[D++]=z[3],O[D++]=z[4],O[D++]=z[5],O[D++]=z[6],O[D++]=z[7],O[D++]=z[8],O[D++]=z[9],O[D++]=z[10],O[D++]=z[11]}}}};function _se(t,e){return e===Br.CARTESIAN||e===Br.METER_OFFSETS||e===Br.DEFAULT&&!t.isGeospatial}const gje=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

void main(void) {
  geometry.worldPosition = instancePositions;
  geometry.uv = texCoords;
  geometry.pickingColor = instancePickingColors;

  vTexCoord = texCoords;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale + instanceTranslation;

  if (composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    normals_commonspace = project_normal(instanceModelMatrix * normals);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), position_commonspace);
    geometry.position = position_commonspace;
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, position_commonspace);
    geometry.position = position_commonspace;
    normals_commonspace = project_normal(instanceModelMatrix * normals);
  }

  geometry.normal = normals_commonspace;
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,mje=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  DECKGL_FILTER_COLOR(color, geometry);

  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);
}
`;function yU(t){let e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0;const s=t.POSITION?t.POSITION.value:[],u=s&&s.length;for(let d=0;d<u;d+=3){const g=s[d],_=s[d+1],E=s[d+2];e=g<e?g:e,n=_<n?_:n,r=E<r?E:r,i=g>i?g:i,o=_>o?_:o,a=E>a?E:a}return[[e,n,r],[i,o,a]]}function Aje(t,e){if(!t)throw new Error(e||"loader assertion failed.")}class fv{constructor(e,n){q(this,"fields",void 0),q(this,"metadata",void 0),Aje(Array.isArray(e)),_je(e),this.fields=e,this.metadata=n||new Map}compareTo(e){if(this.metadata!==e.metadata||this.fields.length!==e.fields.length)return!1;for(let n=0;n<this.fields.length;++n)if(!this.fields[n].compareTo(e.fields[n]))return!1;return!0}select(){const e=Object.create(null);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(const a of r)e[a]=!0;const o=this.fields.filter(a=>e[a.name]);return new fv(o,this.metadata)}selectAt(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];const i=n.map(o=>this.fields[o]).filter(Boolean);return new fv(i,this.metadata)}assign(e){let n,r=this.metadata;if(e instanceof fv){const a=e;n=a.fields,r=Lq(Lq(new Map,this.metadata),a.metadata)}else n=e;const i=Object.create(null);for(const a of this.fields)i[a.name]=a;for(const a of n)i[a.name]=a;const o=Object.values(i);return new fv(o,r)}}function _je(t){const e={};for(const n of t)e[n.name]&&console.warn("Schema: duplicated field name",n.name,n),e[n.name]=!0}function Lq(t,e){return new Map([...t||new Map,...e||new Map])}class cM{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:new Map;q(this,"name",void 0),q(this,"type",void 0),q(this,"nullable",void 0),q(this,"metadata",void 0),this.name=e,this.type=n,this.nullable=r,this.metadata=i}get typeId(){return this.type&&this.type.typeId}clone(){return new cM(this.name,this.type,this.nullable,this.metadata)}compareTo(e){return this.name===e.name&&this.type===e.type&&this.nullable===e.nullable&&this.metadata===e.metadata}toString(){return"".concat(this.type).concat(this.nullable?", nullable":"").concat(this.metadata?", metadata: ".concat(this.metadata):"")}}let gs=function(t){return t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t}({}),yse,vse,xse;class vU{static isNull(e){return e&&e.typeId===gs.Null}static isInt(e){return e&&e.typeId===gs.Int}static isFloat(e){return e&&e.typeId===gs.Float}static isBinary(e){return e&&e.typeId===gs.Binary}static isUtf8(e){return e&&e.typeId===gs.Utf8}static isBool(e){return e&&e.typeId===gs.Bool}static isDecimal(e){return e&&e.typeId===gs.Decimal}static isDate(e){return e&&e.typeId===gs.Date}static isTime(e){return e&&e.typeId===gs.Time}static isTimestamp(e){return e&&e.typeId===gs.Timestamp}static isInterval(e){return e&&e.typeId===gs.Interval}static isList(e){return e&&e.typeId===gs.List}static isStruct(e){return e&&e.typeId===gs.Struct}static isUnion(e){return e&&e.typeId===gs.Union}static isFixedSizeBinary(e){return e&&e.typeId===gs.FixedSizeBinary}static isFixedSizeList(e){return e&&e.typeId===gs.FixedSizeList}static isMap(e){return e&&e.typeId===gs.Map}static isDictionary(e){return e&&e.typeId===gs.Dictionary}get typeId(){return gs.NONE}compareTo(e){return this===e}}yse=Symbol.toStringTag;class Q1 extends vU{constructor(e,n){super(),q(this,"isSigned",void 0),q(this,"bitWidth",void 0),this.isSigned=e,this.bitWidth=n}get typeId(){return gs.Int}get[yse](){return"Int"}toString(){return"".concat(this.isSigned?"I":"Ui","nt").concat(this.bitWidth)}}class yje extends Q1{constructor(){super(!0,8)}}class vje extends Q1{constructor(){super(!0,16)}}class xje extends Q1{constructor(){super(!0,32)}}class bje extends Q1{constructor(){super(!1,8)}}class wje extends Q1{constructor(){super(!1,16)}}class Eje extends Q1{constructor(){super(!1,32)}}const bse={HALF:16,SINGLE:32,DOUBLE:64};vse=Symbol.toStringTag;class wse extends vU{constructor(e){super(),q(this,"precision",void 0),this.precision=e}get typeId(){return gs.Float}get[vse](){return"Float"}toString(){return"Float".concat(this.precision)}}class Sje extends wse{constructor(){super(bse.SINGLE)}}class Tje extends wse{constructor(){super(bse.DOUBLE)}}xse=Symbol.toStringTag;class Cje extends vU{constructor(e,n){super(),q(this,"listSize",void 0),q(this,"children",void 0),this.listSize=e,this.children=[n]}get typeId(){return gs.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get[xse](){return"FixedSizeList"}toString(){return"FixedSizeList[".concat(this.listSize,"]<").concat(this.valueType,">")}}function Pje(t){switch(t.constructor){case Int8Array:return new yje;case Uint8Array:return new bje;case Int16Array:return new vje;case Uint16Array:return new wje;case Int32Array:return new xje;case Uint32Array:return new Eje;case Float32Array:return new Sje;case Float64Array:return new Tje;default:throw new Error("array type not supported")}}function Ije(t,e,n){const r=Pje(e.value),i=n||Mje(e);return new cM(t,new Cje(e.size,new cM("value",r)),!1,i)}function Mje(t){const e=new Map;return"byteOffset"in t&&e.set("byteOffset",t.byteOffset.toString(10)),"byteStride"in t&&e.set("byteStride",t.byteStride.toString(10)),"normalized"in t&&e.set("normalized",t.normalized.toString()),e}function Dq(t,e){(t.COLOR_0||t.colors)&&e||(t.colors={constant:!0,value:new Float32Array([1,1,1])}),Or.assert(t.positions||t.POSITION,'no "postions" or "POSITION" attribute in mesh')}function Bq(t,e){if(t.attributes)return Dq(t.attributes,e),t instanceof Cs?t:new Cs(t);if(t.positions||t.POSITION)return Dq(t,e),new Cs({attributes:t});throw Error("Invalid mesh")}const Oje=[0,0,0,255],Rje={mesh:{type:"object",value:null,async:!0},texture:{type:"image",value:null,async:!0},sizeScale:{type:"number",value:1,min:0},_useMeshColors:{type:"boolean",value:!1},_instanced:!0,wireframe:!1,material:!0,getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:Oje},getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},textureParameters:{type:"object",ignore:!0}};class x1 extends nl{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(){const e=!Hr(this.context.gl),n={};return FE(this.context.gl,Qi.GLSL_DERIVATIVES)&&(n.DERIVATIVES_AVAILABLE=1),super.getShaders({vs:gje,fs:mje,modules:[Mc,HO,Oc],transpileToGLSL100:e,defines:n})}getBounds(){var e;if(this.props._instanced)return super.getBounds();let n=this.state.positionBounds;if(n)return n;const{mesh:r}=this.props;if(!r)return null;if(n=(e=r.header)===null||e===void 0?void 0:e.boundingBox,!n){const{attributes:i}=Bq(r,this.props._useMeshColors);i.POSITION=i.POSITION||i.positions,n=yU(i)}return this.state.positionBounds=n,n}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{transition:!0,type:5130,fp64:this.use64bitPositions(),size:3,accessor:"getPosition"},instanceColors:{type:5121,transition:!0,size:this.props.colorFormat.length,normalized:!0,accessor:"getColor",defaultValue:[0,0,0,255]},instanceModelMatrix:Ase}),this.setState({emptyTexture:new Pl(this.context.gl,{data:new Uint8Array(4),width:1,height:1})})}updateState(e){super.updateState(e);const{props:n,oldProps:r,changeFlags:i}=e;if(n.mesh!==r.mesh||i.extensionsChanged){var o;if(this.state.positionBounds=null,(o=this.state.model)===null||o===void 0||o.delete(),n.mesh){this.state.model=this.getModel(n.mesh);const a=n.mesh.attributes||n.mesh;this.setState({hasNormals:!!(a.NORMAL||a.normals)})}this.getAttributeManager().invalidateAll()}n.texture!==r.texture&&this.setTexture(n.texture),this.state.model&&this.state.model.setDrawMode(this.props.wireframe?3:4)}finalizeState(e){super.finalizeState(e),this.state.emptyTexture.delete()}draw({uniforms:e}){if(!this.state.model)return;const{viewport:n}=this.context,{sizeScale:r,coordinateSystem:i,_instanced:o}=this.props;this.state.model.setUniforms(e).setUniforms({sizeScale:r,composeModelMatrix:!o||_se(n,i),flatShading:!this.state.hasNormals}).draw()}getModel(e){const n=new Oa(this.context.gl,{...this.getShaders(),id:this.props.id,geometry:Bq(e,this.props._useMeshColors),isInstanced:!0}),{texture:r}=this.props,{emptyTexture:i}=this.state;return n.setUniforms({sampler:r||i,hasTexture:!!r}),n}setTexture(e){const{emptyTexture:n,model:r}=this.state;r&&r.setUniforms({sampler:e||n,hasTexture:!!e})}}q(x1,"defaultProps",Rje);q(x1,"layerName","SimpleMeshLayer");class Ev{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{id:n}=e;this.id=n||Ma(this.constructor.name),this.display=!0,this.position=new _t,this.rotation=new _t,this.scale=new _t(1,1,1),this.matrix=new vr,this.userData={},this.props={},this._setScenegraphNodeProps(e)}delete(){}setProps(e){return this._setScenegraphNodeProps(e),this}toString(){return"{type: ScenegraphNode, id: ".concat(this.id,")}")}getBounds(){return null}setPosition(e){return Nn(e.length===3,"setPosition requires vector argument"),this.position=e,this}setRotation(e){return Nn(e.length===3,"setRotation requires vector argument"),this.rotation=e,this}setScale(e){return Nn(e.length===3,"setScale requires vector argument"),this.scale=e,this}setMatrix(e){(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?this.matrix.copy(e):this.matrix=e}setMatrixComponents(e){let{position:n,rotation:r,scale:i,update:o=!0}=e;return n&&this.setPosition(n),r&&this.setRotation(r),i&&this.setScale(i),o&&this.updateMatrix(),this}updateMatrix(){const e=this.position,n=this.rotation,r=this.scale;return this.matrix.identity(),this.matrix.translate(e),this.matrix.rotateXYZ(n),this.matrix.scale(r),this}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{position:n,rotation:r,scale:i}=e;return n&&this.setPosition(n),r&&this.setRotation(r),i&&this.setScale(i),this.updateMatrix(),this}getCoordinateUniforms(e,n){Nn(e),n=n||this.matrix;const r=new vr(e).multiplyRight(n),i=r.invert(),o=i.transpose();return{viewMatrix:e,modelMatrix:n,objectMatrix:n,worldMatrix:r,worldInverseMatrix:i,worldInverseTransposeMatrix:o}}_setScenegraphNodeProps(e){"display"in e&&(this.display=e.display),"position"in e&&this.setPosition(e.position),"rotation"in e&&this.setRotation(e.rotation),"scale"in e&&this.setScale(e.scale),"matrix"in e&&this.setMatrix(e.matrix),Object.assign(this.props,e)}}class vw extends Ev{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e=Array.isArray(e)?{children:e}:e;const{children:n=[]}=e;Yn.assert(n.every(r=>r instanceof Ev),"every child must an instance of ScenegraphNode"),super(e),this.children=n}add(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];for(const i of n)Array.isArray(i)?this.add(...i):this.children.push(i);return this}remove(e){const n=this.children,r=n.indexOf(e);return r>-1&&n.splice(r,1),this}removeAll(){return this.children=[],this}delete(){this.children.forEach(e=>e.delete()),this.removeAll(),super.delete()}getBounds(){const e=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]];return this.traverse((n,r)=>{let{worldMatrix:i}=r;const o=n.getBounds();if(!o)return;const[a,s]=o,u=new _t(a).add(s).divide([2,2,2]);i.transformAsPoint(u,u);const d=new _t(s).subtract(a).divide([2,2,2]);i.transformAsVector(d,d);for(let g=0;g<8;g++){const _=new _t(g&1?-1:1,g&2?-1:1,g&4?-1:1).multiply(d).add(u);for(let E=0;E<3;E++)e[0][E]=Math.min(e[0][E],_[E]),e[1][E]=Math.max(e[1][E],_[E])}}),Number.isFinite(e[0][0])?e:null}traverse(e){let{worldMatrix:n=new vr}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new vr(n).multiplyRight(this.matrix);for(const i of this.children)i instanceof vw?i.traverse(e,{worldMatrix:r}):e(i,{worldMatrix:r})}}const Lje={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Dje={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Nq(t){if(!t._animation){const e=Dje[t.componentType],n=Lje[t.type],r=n*t.count,{buffer:i,byteOffset:o}=t.bufferView.data,a=new e(i,o+(t.byteOffset||0),r);if(n===1)t._animation=Array.from(a);else{const s=[];for(let u=0;u<a.length;u+=n)s.push(Array.from(a.slice(u,u+n)));t._animation=s}}return t._animation}const Bje=new vr;function Nje(t,e){if(e.matrix.identity(),t.translation&&e.matrix.translate(t.translation),t.rotation){const n=Bje.fromQuaternion(t.rotation);e.matrix.multiplyRight(n)}t.scale&&e.matrix.scale(t.scale)}const NB=new Qm;function Fje(t,e,n,r,i){if(e==="rotation"){NB.slerp({start:n,target:r,ratio:i});for(let o=0;o<NB.length;o++)t[e][o]=NB[o]}else for(let o=0;o<n.length;o++)t[e][o]=i*r[o]+(1-i)*n[o]}function kje(t,e,n){let{p0:r,outTangent0:i,inTangent1:o,p1:a,tDiff:s,ratio:u}=n;for(let d=0;d<t[e].length;d++){const g=i[d]*s,_=o[d]*s;t[e][d]=(2*Math.pow(u,3)-3*Math.pow(u,2)+1)*r[d]+(Math.pow(u,3)-2*Math.pow(u,2)+u)*g+(-2*Math.pow(u,3)+3*Math.pow(u,2))*a[d]+(Math.pow(u,3)-Math.pow(u,2))*_}}function zje(t,e,n){for(let r=0;r<n.length;r++)t[e][r]=n[r]}function Uje(t,e,n,r){let{input:i,interpolation:o,output:a}=e;const s=i[i.length-1],u=t%s,d=i.findIndex(P=>P>=u),g=Math.max(0,d-1);if(!Array.isArray(n[r]))switch(r){case"translation":n[r]=[0,0,0];break;case"rotation":n[r]=[0,0,0,1];break;case"scale":n[r]=[1,1,1];break;default:Yn.warn("Bad animation path ".concat(r))()}Nn(n[r].length===a[g].length);const _=i[g],E=i[d];switch(o){case"STEP":zje(n,r,a[g]);break;case"LINEAR":if(E>_){const P=(u-_)/(E-_);Fje(n,r,a[g],a[d],P)}break;case"CUBICSPLINE":if(E>_){const P=(u-_)/(E-_),O=E-_,D=a[3*g+1],V=a[3*g+2],k=a[3*d+0],F=a[3*d+1];kje(n,r,{p0:D,outTangent0:V,inTangent1:k,p1:F,tDiff:O,ratio:P})}break;default:Yn.warn("Interpolation ".concat(o," not supported"))();break}}class Gje{constructor(e){this.startTime=0,this.playing=!0,this.speed=1,this.channels=[],Object.assign(this,e)}animate(e){if(!this.playing)return;const r=(e/1e3-this.startTime)*this.speed;this.channels.forEach(i=>{let{sampler:o,target:a,path:s}=i;Uje(r,o,a,s),Nje(a,a._node)})}}class jje{constructor(e){this.animations=e.animations.map((n,r)=>{const i=n.name||"Animation-".concat(r),o=n.samplers.map(s=>{let{input:u,interpolation:d="LINEAR",output:g}=s;return{input:Nq(e.accessors[u]),interpolation:d,output:Nq(e.accessors[g])}}),a=n.channels.map(s=>{let{sampler:u,target:d}=s;return{sampler:o[u],target:e.nodes[d.node],path:d.path}});return new Gje({name:i,channels:a})})}animate(e){this.setTime(e)}setTime(e){this.animations.forEach(n=>n.animate(e))}getAnimations(){return this.animations}}class Vje extends Ev{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(n),this.onBeforeRender=null,this.AfterRender=null,e instanceof Oa?(this.model=e,this._setModelNodeProps(n)):this.model=new Oa(e,n),this.bounds=null,this.managedResources=n.managedResources||[]}setProps(e){return super.setProps(e),this._setModelNodeProps(e),this}getBounds(){return this.bounds}delete(){this.model&&(this.model.delete(),this.model=null),this.managedResources.forEach(e=>e.delete()),this.managedResources=[]}draw(){return this.model.draw(...arguments)}setUniforms(){return this.model.setUniforms(...arguments),this}setAttributes(){return this.model.setAttributes(...arguments),this}updateModuleSettings(){return this.model.updateModuleSettings(...arguments),this}_setModelNodeProps(e){this.model.setProps(e)}}class Ese{constructor(e,n){let{attributes:r,material:i,pbrDebug:o,imageBasedLightingEnvironment:a,lights:s,useTangents:u}=n;this.gl=e,this.defines={MANUAL_SRGB:1,SRGB_FAST_APPROXIMATION:1},FE(e,Qi.GLSL_TEXTURE_LOD)&&(this.defines.USE_TEX_LOD=1),this.uniforms={u_Camera:[0,0,0],u_MetallicRoughnessValues:[1,1]},this.parameters={},this.generatedTextures=[],a&&(this.uniforms.u_DiffuseEnvSampler=a.getDiffuseEnvSampler(),this.uniforms.u_SpecularEnvSampler=a.getSpecularEnvSampler(),this.uniforms.u_brdfLUT=a.getBrdfTexture(),this.uniforms.u_ScaleIBLAmbient=[1,1]),o&&(this.uniforms.u_ScaleDiffBaseMR=[0,0,0,0],this.uniforms.u_ScaleFGDSpec=[0,0,0,0]),this.defineIfPresent(r.NORMAL,"HAS_NORMALS"),this.defineIfPresent(r.TANGENT&&u,"HAS_TANGENTS"),this.defineIfPresent(r.TEXCOORD_0,"HAS_UV"),this.defineIfPresent(a,"USE_IBL"),this.defineIfPresent(s,"USE_LIGHTS"),this.defineIfPresent(o,"PBR_DEBUG"),i&&this.parseMaterial(i)}defineIfPresent(e,n){e&&(this.defines[n]=1)}parseTexture(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=e.texture&&e.texture.sampler&&e.texture.sampler.parameters||{},o=e.texture.source.image;let a,s={};o.compressed?(a=o,s={[this.gl.TEXTURE_MIN_FILTER]:o.data.length>1?this.gl.LINEAR_MIPMAP_NEAREST:this.gl.LINEAR}):a={data:o};const u=new Pl(this.gl,{id:e.name||e.id,parameters:{...i,...s},pixelStore:{[this.gl.UNPACK_FLIP_Y_WEBGL]:!1},...a});this.uniforms[n]=u,this.defineIfPresent(r,r),this.generatedTextures.push(u)}parsePbrMetallicRoughness(e){e.baseColorTexture&&this.parseTexture(e.baseColorTexture,"u_BaseColorSampler","HAS_BASECOLORMAP"),this.uniforms.u_BaseColorFactor=e.baseColorFactor||[1,1,1,1],e.metallicRoughnessTexture&&this.parseTexture(e.metallicRoughnessTexture,"u_MetallicRoughnessSampler","HAS_METALROUGHNESSMAP");const{metallicFactor:n=1,roughnessFactor:r=1}=e;this.uniforms.u_MetallicRoughnessValues=[n,r]}parseMaterial(e){if(this.uniforms.pbr_uUnlit=!!e.unlit,e.pbrMetallicRoughness&&this.parsePbrMetallicRoughness(e.pbrMetallicRoughness),e.normalTexture){this.parseTexture(e.normalTexture,"u_NormalSampler","HAS_NORMALMAP");const{scale:n=1}=e.normalTexture;this.uniforms.u_NormalScale=n}if(e.occlusionTexture){this.parseTexture(e.occlusionTexture,"u_OcclusionSampler","HAS_OCCLUSIONMAP");const{strength:n=1}=e.occlusionTexture;this.uniforms.u_OcclusionStrength=n}if(e.emissiveTexture&&(this.parseTexture(e.emissiveTexture,"u_EmissiveSampler","HAS_EMISSIVEMAP"),this.uniforms.u_EmissiveFactor=e.emissiveFactor||[0,0,0]),e.alphaMode==="MASK"){const{alphaCutoff:n=.5}=e;this.defines.ALPHA_CUTOFF=1,this.uniforms.u_AlphaCutoff=n}else e.alphaMode==="BLEND"&&(Yn.warn("BLEND alphaMode might not work well because it requires mesh sorting")(),Object.assign(this.parameters,{blend:!0,blendEquation:this.gl.FUNC_ADD,blendFunc:[this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA,this.gl.ONE,this.gl.ONE_MINUS_SRC_ALPHA]}))}delete(){this.generatedTextures.forEach(e=>e.delete())}}const $je=`
#if (__VERSION__ < 300)
  #define _attr attribute
#else
  #define _attr in
#endif

  _attr vec4 POSITION;

  #ifdef HAS_NORMALS
    _attr vec4 NORMAL;
  #endif

  #ifdef HAS_TANGENTS
    _attr vec4 TANGENT;
  #endif

  #ifdef HAS_UV
    _attr vec2 TEXCOORD_0;
  #endif

  void main(void) {
    vec4 _NORMAL = vec4(0.);
    vec4 _TANGENT = vec4(0.);
    vec2 _TEXCOORD_0 = vec2(0.);

    #ifdef HAS_NORMALS
      _NORMAL = NORMAL;
    #endif

    #ifdef HAS_TANGENTS
      _TANGENT = TANGENT;
    #endif

    #ifdef HAS_UV
      _TEXCOORD_0 = TEXCOORD_0;
    #endif

    pbr_setPositionNormalTangentUV(POSITION, _NORMAL, _TANGENT, _TEXCOORD_0);
    gl_Position = u_MVPMatrix * POSITION;
  }
`,Hje=`
#if (__VERSION__ < 300)
  #define fragmentColor gl_FragColor
#else
  out vec4 fragmentColor;
#endif

  void main(void) {
    fragmentColor = pbr_filterColor(vec4(0));
  }
`;function Fq(t,e){return Hr(t)?`#version 300 es
`.concat(e):e}function Wje(t,e){const{id:n,drawMode:r,vertexCount:i,attributes:o,modelOptions:a}=e,s=new Ese(t,e);Yn.info(4,"createGLTFModel defines: ",s.defines)();const u=[];u.push(...s.generatedTextures),u.push(...Object.values(o).map(g=>g.buffer));const d=new Vje(t,{id:n,drawMode:r,vertexCount:i,modules:[WO],parameters:s.parameters,vs:Fq(t,$je),fs:Fq(t,Hje),managedResources:u,...a,defines:{...s.defines,...a.defines}});return d.setProps({attributes:o}),d.setUniforms(s.uniforms),d}const qje={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Xje={modelOptions:{},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1};class Zje{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.gl=e,this.options=Object.assign({},Xje,n)}instantiate(e){return this.gltf=e,(e.scenes||[]).map(r=>this.createScene(r))}createAnimator(){return Array.isArray(this.gltf.animations)?new jje(this.gltf):null}createScene(e){const r=(e.nodes||[]).map(o=>this.createNode(o));return new vw({id:e.name||e.id,children:r})}createNode(e){if(!e._node){const r=(e.children||[]).map(o=>this.createNode(o));e.mesh&&r.push(this.createMesh(e.mesh));const i=new vw({id:e.name||e.id,children:r});if(e.matrix)i.setMatrix(e.matrix);else{if(i.matrix.identity(),e.translation&&i.matrix.translate(e.translation),e.rotation){const o=new vr().fromQuaternion(e.rotation);i.matrix.multiplyRight(o)}e.scale&&i.matrix.scale(e.scale)}e._node=i}return e._node}createMesh(e){if(!e._mesh){const r=(e.primitives||[]).map((o,a)=>this.createPrimitive(o,a,e)),i=new vw({id:e.name||e.id,children:r});e._mesh=i}return e._mesh}getVertexCount(e){Yn.warn("getVertexCount() not found")()}createPrimitive(e,n,r){const i=Wje(this.gl,Object.assign({id:e.name||"".concat(r.name||r.id,"-primitive-").concat(n),drawMode:e.mode||4,vertexCount:e.indices?e.indices.count:this.getVertexCount(e.attributes),attributes:this.createAttributes(e.attributes,e.indices),material:e.material},this.options));return i.bounds=[e.attributes.POSITION.min,e.attributes.POSITION.max],i}createAttributes(e,n){const r={};return Object.keys(e).forEach(i=>{r[i]=this.createAccessor(e[i],this.createBuffer(e[i],this.gl.ARRAY_BUFFER))}),n&&(r.indices=this.createAccessor(n,this.createBuffer(n,this.gl.ELEMENT_ARRAY_BUFFER))),Yn.info(4,"glTF Attributes",{attributes:e,indices:n,generated:r})(),r}createBuffer(e,n){e.bufferView||(e.bufferView={});const{bufferView:r}=e;return r.lumaBuffers||(r.lumaBuffers={}),r.lumaBuffers[n]||(r.lumaBuffers[n]=new ji(this.gl,{id:"from-".concat(r.id),data:r.data||e.value,target:n})),r.lumaBuffers[n]}createAccessor(e,n){return new wu({buffer:n,offset:e.byteOffset||0,stride:e.bufferView.byteStride||0,type:e.componentType,size:qje[e.type]})}createSampler(e){return e}needsPOT(){return!1}}function Yje(t,e,n){const r=new Zje(t,n),i=r.instantiate(e),o=r.createAnimator();return{scenes:i,animator:o}}const Qje="3.4.14",Kje="3.4.14",Sse="3.4.14",Jje="https://unpkg.com/@loaders.gl/textures@".concat(Sse,"/dist/libs/basis_encoder.wasm"),eVe="https://unpkg.com/@loaders.gl/textures@".concat(Sse,"/dist/libs/basis_encoder.js");let FB;async function kq(t){const e=t.modules||{};return e.basis?e.basis:(FB=FB||tVe(t),await FB)}async function tVe(t){let e=null,n=null;return[e,n]=await Promise.all([await I0("basis_transcoder.js","textures",t),await I0("basis_transcoder.wasm","textures",t)]),e=e||globalThis.BASIS,await nVe(e,n)}function nVe(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(i=>{const{BasisFile:o,initializeBasis:a}=i;a(),r({BasisFile:o})})})}let kB;async function zq(t){const e=t.modules||{};return e.basisEncoder?e.basisEncoder:(kB=kB||rVe(t),await kB)}async function rVe(t){let e=null,n=null;return[e,n]=await Promise.all([await I0(eVe,"textures",t),await I0(Jje,"textures",t)]),e=e||globalThis.BASIS,await iVe(e,n)}function iVe(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t(n).then(i=>{const{BasisFile:o,KTX2File:a,initializeBasis:s,BasisEncoder:u}=i;s(),r({BasisFile:o,KTX2File:a,BasisEncoder:u})})})}const Iy={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},oVe=["","WEBKIT_","MOZ_"],Uq={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let pT=null;function sVe(t){if(!pT){t=t||aVe()||void 0,pT=new Set;for(const e of oVe)for(const n in Uq)if(t&&t.getExtension("".concat(e).concat(n))){const r=Uq[n];pT.add(r)}}return pT}function aVe(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}var Gq,jq,Vq,$q,Hq,Wq,qq,Xq;(function(t){t[t.NONE=0]="NONE",t[t.BASISLZ=1]="BASISLZ",t[t.ZSTD=2]="ZSTD",t[t.ZLIB=3]="ZLIB"})(Gq||(Gq={})),function(t){t[t.BASICFORMAT=0]="BASICFORMAT"}(jq||(jq={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.ETC1S=163]="ETC1S",t[t.UASTC=166]="UASTC"}(Vq||(Vq={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.SRGB=1]="SRGB"}($q||($q={})),function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LINEAR=1]="LINEAR",t[t.SRGB=2]="SRGB",t[t.ITU=3]="ITU",t[t.NTSC=4]="NTSC",t[t.SLOG=5]="SLOG",t[t.SLOG2=6]="SLOG2"}(Hq||(Hq={})),function(t){t[t.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",t[t.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(Wq||(Wq={})),function(t){t[t.RGB=0]="RGB",t[t.RRR=3]="RRR",t[t.GGG=4]="GGG",t[t.AAA=15]="AAA"}(qq||(qq={})),function(t){t[t.RGB=0]="RGB",t[t.RGBA=3]="RGBA",t[t.RRR=4]="RRR",t[t.RRRG=5]="RRRG"}(Xq||(Xq={}));const rc=[171,75,84,88,32,50,48,187,13,10,26,10];function lVe(t){const e=new Uint8Array(t);return!(e.byteLength<rc.length||e[0]!==rc[0]||e[1]!==rc[1]||e[2]!==rc[2]||e[3]!==rc[3]||e[4]!==rc[4]||e[5]!==rc[5]||e[6]!==rc[6]||e[7]!==rc[7]||e[8]!==rc[8]||e[9]!==rc[9]||e[10]!==rc[10]||e[11]!==rc[11])}const uVe={etc1:{basisFormat:0,compressed:!0,format:Iy.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:Iy.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:Iy.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:Iy.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:Iy.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:Iy.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function cVe(t,e){if(e.basis.containerFormat==="auto"){if(lVe(t)){const r=await zq(e);return Zq(r.KTX2File,t,e)}const{BasisFile:n}=await kq(e);return zB(n,t,e)}switch(e.basis.module){case"encoder":const n=await zq(e);switch(e.basis.containerFormat){case"ktx2":return Zq(n.KTX2File,t,e);case"basis":default:return zB(n.BasisFile,t,e)}case"transcoder":default:const{BasisFile:r}=await kq(e);return zB(r,t,e)}}function zB(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("Failed to start basis transcoding");const i=r.getNumImages(),o=[];for(let a=0;a<i;a++){const s=r.getNumLevels(a),u=[];for(let d=0;d<s;d++)u.push(fVe(r,a,d,n));o.push(u)}return o}finally{r.close(),r.delete()}}function fVe(t,e,n,r){const i=t.getImageWidth(e,n),o=t.getImageHeight(e,n),a=t.getHasAlpha(),{compressed:s,format:u,basisFormat:d}=Tse(r,a),g=t.getImageTranscodedSizeInBytes(e,n,d),_=new Uint8Array(g);if(!t.transcodeImage(_,e,n,d,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:o,data:_,compressed:s,format:u,hasAlpha:a}}function Zq(t,e,n){const r=new t(new Uint8Array(e));try{if(!r.startTranscoding())throw new Error("failed to start KTX2 transcoding");const i=r.getLevels(),o=[];for(let a=0;a<i;a++){o.push(hVe(r,a,n));break}return[o]}finally{r.close(),r.delete()}}function hVe(t,e,n){const{alphaFlag:r,height:i,width:o}=t.getImageLevelInfo(e,0,0),{compressed:a,format:s,basisFormat:u}=Tse(n,r),d=t.getImageTranscodedSizeInBytes(e,0,0,u),g=new Uint8Array(d);if(!t.transcodeImage(g,e,0,0,u,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:o,height:i,data:g,compressed:a,levelSize:d,hasAlpha:r,format:s}}function Tse(t,e){let n=t&&t.basis&&t.basis.format;return n==="auto"&&(n=Cse()),typeof n=="object"&&(n=e?n.alpha:n.noAlpha),n=n.toLowerCase(),uVe[n]}function Cse(){const t=sVe();return t.has("astc")?"astc-4x4":t.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:t.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:t.has("etc1")?"etc1":t.has("etc2")?"etc2":"rgb565"}const dVe={name:"Basis",id:Kp?"basis":"basis-nodejs",module:"textures",version:Kje,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},pVe={...dVe,parse:cVe};function fc(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function Pse(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const r=e.baseUri||e.uri;if(!r)throw new Error("'baseUri' must be provided to resolve relative url ".concat(t));return r.substr(0,r.lastIndexOf("/")+1)+t}function gVe(t,e,n){const r=t.bufferViews[n];fc(r);const i=r.buffer,o=e[i];fc(o);const a=(r.byteOffset||0)+o.byteOffset;return new Uint8Array(o.arrayBuffer,a,r.byteLength)}const Yq=["SCALAR","VEC2","VEC3","VEC4"],mVe=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],AVe=new Map(mVe),_Ve={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},yVe={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},vVe={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Ise(t){return Yq[t-1]||Yq[0]}function Mse(t){const e=AVe.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function xU(t,e){const n=vVe[t.componentType],r=_Ve[t.type],i=yVe[t.componentType],o=t.count*r,a=t.count*r*i;return fc(a>=0&&a<=e.byteLength),{ArrayType:n,length:o,byteLength:a}}function Ose(t){let{images:e,bufferViews:n}=t;e=e||[],n=n||[];const r=e.map(a=>a.bufferView);n=n.filter(a=>!r.includes(a));const i=n.reduce((a,s)=>a+s.byteLength,0),o=e.reduce((a,s)=>{const{width:u,height:d}=s.image;return a+u*d},0);return i+Math.ceil(4*o*1.33)}const xVe={asset:{version:"2.0",generator:"loaders.gl"},buffers:[]};class ju{constructor(e){q(this,"gltf",void 0),q(this,"sourceBuffers",void 0),q(this,"byteLength",void 0),this.gltf=e||{json:{...xVe},buffers:[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(e){return this.json[e]}getExtraData(e){return(this.json.extras||{})[e]}getExtension(e){const n=this.getUsedExtensions().find(i=>i===e),r=this.json.extensions||{};return n?r[e]||!0:null}getRequiredExtension(e){return this.getRequiredExtensions().find(r=>r===e)?this.getExtension(e):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(e,n){return(e.extensions||{})[n]}getScene(e){return this.getObject("scenes",e)}getNode(e){return this.getObject("nodes",e)}getSkin(e){return this.getObject("skins",e)}getMesh(e){return this.getObject("meshes",e)}getMaterial(e){return this.getObject("materials",e)}getAccessor(e){return this.getObject("accessors",e)}getTexture(e){return this.getObject("textures",e)}getSampler(e){return this.getObject("samplers",e)}getImage(e){return this.getObject("images",e)}getBufferView(e){return this.getObject("bufferViews",e)}getBuffer(e){return this.getObject("buffers",e)}getObject(e,n){if(typeof n=="object")return n;const r=this.json[e]&&this.json[e][n];if(!r)throw new Error("glTF file error: Could not find ".concat(e,"[").concat(n,"]"));return r}getTypedArrayForBufferView(e){e=this.getBufferView(e);const n=e.buffer,r=this.gltf.buffers[n];fc(r);const i=(e.byteOffset||0)+r.byteOffset;return new Uint8Array(r.arrayBuffer,i,e.byteLength)}getTypedArrayForAccessor(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),i=this.getBuffer(n.buffer).data,{ArrayType:o,length:a}=xU(e,n),s=n.byteOffset+e.byteOffset;return new o(i,s,a)}getTypedArrayForImageData(e){e=this.getAccessor(e);const n=this.getBufferView(e.bufferView),i=this.getBuffer(n.buffer).data,o=n.byteOffset||0;return new Uint8Array(i,o,n.byteLength)}addApplicationData(e,n){return this.json[e]=n,this}addExtraData(e,n){return this.json.extras=this.json.extras||{},this.json.extras[e]=n,this}addObjectExtension(e,n,r){return e.extensions=e.extensions||{},e.extensions[n]=r,this.registerUsedExtension(n),this}setObjectExtension(e,n,r){const i=e.extensions||{};i[n]=r}removeObjectExtension(e,n){const r=e.extensions||{},i=r[n];return delete r[n],i}addExtension(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return fc(n),this.json.extensions=this.json.extensions||{},this.json.extensions[e]=n,this.registerUsedExtension(e),n}addRequiredExtension(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return fc(n),this.addExtension(e,n),this.registerRequiredExtension(e),n}registerUsedExtension(e){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(n=>n===e)||this.json.extensionsUsed.push(e)}registerRequiredExtension(e){this.registerUsedExtension(e),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(n=>n===e)||this.json.extensionsRequired.push(e)}removeExtension(e){if(!this.getExtension(e))return;this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,e),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,e),this.json.extensions&&delete this.json.extensions[e],Array.isArray(this.json.extensionsRemoved)||(this.json.extensionsRemoved=[]);const n=this.json.extensionsRemoved;n.includes(e)||n.push(e)}setDefaultScene(e){this.json.scene=e}addScene(e){const{nodeIndices:n}=e;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:n}),this.json.scenes.length-1}addNode(e){const{meshIndex:n,matrix:r}=e;this.json.nodes=this.json.nodes||[];const i={mesh:n};return r&&(i.matrix=r),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(e){const{attributes:n,indices:r,material:i,mode:o=4}=e,s={primitives:[{attributes:this._addAttributes(n),mode:o}]};if(r){const u=this._addIndices(r);s.primitives[0].indices=u}return Number.isFinite(i)&&(s.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(s),this.json.meshes.length-1}addPointCloud(e){const r={primitives:[{attributes:this._addAttributes(e),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(r),this.json.meshes.length-1}addImage(e,n){const r=d5(e),i=n||(r==null?void 0:r.mimeType),a={bufferView:this.addBufferView(e),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(a),this.json.images.length-1}addBufferView(e){const n=e.byteLength;fc(Number.isFinite(n)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(e);const r={buffer:0,byteOffset:this.byteLength,byteLength:n};return this.byteLength+=IE(n,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(r),this.json.bufferViews.length-1}addAccessor(e,n){const r={bufferView:e,type:Ise(n.size),componentType:n.componentType,count:n.count,max:n.max,min:n.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(r),this.json.accessors.length-1}addBinaryBuffer(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{size:3};const r=this.addBufferView(e);let i={min:n.min,max:n.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(e,n.size));const o={size:n.size,componentType:Mse(e),count:Math.round(e.length/n.size),min:i.min,max:i.max};return this.addAccessor(r,Object.assign(o,n))}addTexture(e){const{imageIndex:n}=e,r={source:n};return this.json.textures=this.json.textures||[],this.json.textures.push(r),this.json.textures.length-1}addMaterial(e){return this.json.materials=this.json.materials||[],this.json.materials.push(e),this.json.materials.length-1}createBinaryChunk(){var e,n;this.gltf.buffers=[];const r=this.byteLength,i=new ArrayBuffer(r),o=new Uint8Array(i);let a=0;for(const s of this.sourceBuffers||[])a=RAe(s,o,a);(e=this.json)!==null&&e!==void 0&&(n=e.buffers)!==null&&n!==void 0&&n[0]?this.json.buffers[0].byteLength=r:this.json.buffers=[{byteLength:r}],this.gltf.binary=i,this.sourceBuffers=[i]}_removeStringFromArray(e,n){let r=!0;for(;r;){const i=e.indexOf(n);i>-1?e.splice(i,1):r=!1}}_addAttributes(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n={};for(const r in e){const i=e[r],o=this._getGltfAttributeName(r),a=this.addBinaryBuffer(i.value,i);n[o]=a}return n}_addIndices(e){return this.addBinaryBuffer(e,{size:1})}_getGltfAttributeName(e){switch(e.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return e}}_getAccessorMinMax(e,n){const r={min:null,max:null};if(e.length<n)return r;r.min=[],r.max=[];const i=e.subarray(0,n);for(const o of i)r.min.push(o),r.max.push(o);for(let o=n;o<e.length;o+=n)for(let a=0;a<n;a++)r.min[0+a]=Math.min(r.min[0+a],e[o+a]),r.max[0+a]=Math.max(r.max[0+a],e[o+a]);return r}}const bVe="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB",wVe="B9h9z9tFBBBF8dL9gBB9gLaaaaaFa9gEaaaB9gGaaB9gFaFaEQSBBFBFFGEGEGIILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBNn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBcI9z9iqlBMc/j9JSIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMkRIbaG97FaK978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAnDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAnDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAnDeBJAeCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPD8dBhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBAeCx+YUUBJDBBBHnAnDQBBBBBBBBBBBBBBBBAPD8dFhUg/8/4/w/goB9+h84k7HeCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAnDeBJAeCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBRnCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBHiCFD9tAiAPD9OD9hD9RHiDQBTFtGmEYIPLdKeOnH8ZAIAQJDBIBHpCFD9tApAPD9OD9hD9RHpAIASJDBIBHyCFD9tAyAPD9OD9hD9RHyDQBTFtGmEYIPLdKeOnH8cDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAnD9uHnDyBjGBAEAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnA8ZA8cDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNiV8ZcpMyS8cQ8df8eb8fHdApAyDQNiV8ZcpMyS8cQ8df8eb8fHiDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJHIAnAdAiDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHnDyBjGBAIAGJHIAnAPAPDQILKOILKOILKOILKOD9uHnDyBjGBAIAGJHIAnAPAPDQNVcMNVcMNVcMNVcMD9uHnDyBjGBAIAGJHIAnAPAPDQSQfbSQfbSQfbSQfbD9uHnDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/xLGEaK978jUUUUBCAlHE8kUUUUBGXGXAGCI9HQBGXAFC98ZHI9FQBABRGCBRLEXAGAGDBBBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMBBAGCTJRGALCIJHLAI9JQBMMAIAF9PQFAEAFCEZHLCGWHGqCBCTAGl/8MBAEABAICGWJHIAG/8cBBGXAL9FQBAEAEDBIBHKCiD+rFCiD+sFD/6FHOAKCND+rFCiD+sFD/6FAOD/gFAKCTD+rFCiD+sFD/6FHND/gFD/kFD/lFHVCBDtD+2FHcAOCUUUU94DtHMD9OD9RD/kFHO9DBB/+hDYAOAOD/mFAVAVD/mFANAcANAMD9OD9RD/kFHOAOD/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHcD/kFCgFDtD9OAKCUUU94DtD9OD9QAOAND/mFAcD/kFCND+rFCU/+EDtD9OD9QAVAND/mFAcD/kFCTD+rFCUU/8ODtD9OD9QDMIBMAIAEAG/8cBBSFMABAFC98ZHGT+HUUUBAGAF9PQBAEAFCEZHICEWHLJCBCAALl/8MBAEABAGCEWJHGAL/8cBBAEAIT+HUUUBAGAEAL/8cBBMAECAJ8kUUUUBM+yEGGaO97GXAF9FQBCBRGEXABCTJHEAEDBBBHICBDtHLCUU98D8cFCUU98D8cEHKD9OABDBBBHOAIDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAOAIDQBFGENVcMTtmYi8ZpyHICTD+sFD/6FHND/gFAICTD+rFCTD+sFD/6FHVD/gFD/kFD/lFHI9DB/+g6DYAVAIALD+2FHLAVCUUUU94DtHcD9OD9RD/kFHVAVD/mFAIAID/mFANALANAcD9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHND/mF9DBBX9LDYHLD/kFCTD+rFAVAND/mFALD/kFCggEDtD9OD9QHVAIAND/mFALD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHIDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAOAKD9OAVAIDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM94FEa8jUUUUBCAlHE8kUUUUBABAFC98ZHIT+JUUUBGXAIAF9PQBAEAFCEZHLCEWHFJCBCAAFl/8MBAEABAICEWJHBAF/8cBBAEALT+JUUUBABAEAF/8cBBMAECAJ8kUUUUBM/hEIGaF97FaL978jUUUUBCTlRGGXAF9FQBCBREEXAGABDBBBHIABCTJHLDBBBHKDQILKOSQfbPden8c8d8e8fHOCTD+sFHNCID+rFDMIBAB9DBBU8/DY9D/zI818/DYANCEDtD9QD/6FD/nFHNAIAKDQBFGENVcMTtmYi8ZpyHICTD+rFCTD+sFD/6FD/mFHKAKD/mFANAICTD+sFD/6FD/mFHVAVD/mFANAOCTD+rFCTD+sFD/6FD/mFHOAOD/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHND/mF9DBBX9LDYHID/kFCggEDtHcD9OAVAND/mFAID/kFCTD+rFD9QHVAOAND/mFAID/kFCTD+rFAKAND/mFAID/kFAcD9OD9QHNDQBFTtGEmYILPdKOenHID8dBAGDBIBDyB+t+J83EBABCNJAID8dFAGDBIBDyF+t+J83EBALAVANDQNVi8ZcMpySQ8c8dfb8e8fHND8dBAGDBIBDyG+t+J83EBABCiJAND8dFAGDBIBDyE+t+J83EBABCAJRBAECIJHEAF9JQBMMM/3FGEaF978jUUUUBCoBlREGXAGCGrAF9sHIC98ZHL9FQBCBRGABRFEXAFAFDBBBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBAFCTJRFAGCIJHGAL9JQBMMGXALAI9PQBAEAICEZHGCGWHFqCBCoBAFl/8MBAEABALCGWJHLAF/8cBBGXAG9FQBAEAEDBIBHKCND+rFCND+sFD/6FAKCiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMIBMALAEAF/8cBBMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",EVe=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),SVe=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),TVe={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},CVe={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function PVe(t,e,n,r,i){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"NONE";const a=await IVe();RVe(a,a.exports[CVe[i]],t,e,n,r,a.exports[TVe[o||"NONE"]])}let UB;async function IVe(){return UB||(UB=MVe()),UB}async function MVe(){let t=bVe;WebAssembly.validate(EVe)&&(t=wVe,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const e=await WebAssembly.instantiate(OVe(t),{});return await e.instance.exports.__wasm_call_ctors(),e.instance}function OVe(t){const e=new Uint8Array(t.length);for(let r=0;r<t.length;++r){const i=t.charCodeAt(r);e[r]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let n=0;for(let r=0;r<t.length;++r)e[n++]=e[r]<60?SVe[e[r]]:(e[r]-60)*64+e[++r];return e.buffer.slice(0,n)}function RVe(t,e,n,r,i,o,a){const s=t.exports.sbrk,u=r+3&-4,d=s(u*i),g=s(o.length),_=new Uint8Array(t.exports.memory.buffer);_.set(o,g);const E=e(d,r,i,g,o.length);if(E===0&&a&&a(d,u,i),n.set(_.subarray(d,d+r*i)),s(d-s(0)),E!==0)throw new Error("Malformed buffer data: ".concat(E))}const bU="EXT_meshopt_compression",LVe=bU;async function DVe(t,e){var n;const r=new ju(t);if(!(e!=null&&(n=e.gltf)!==null&&n!==void 0&&n.decompressMeshes))return;const i=[];for(const o of t.json.bufferViews||[])i.push(BVe(r,o));await Promise.all(i),r.removeExtension(bU)}async function BVe(t,e){const n=t.getObjectExtension(e,bU);if(n){const{byteOffset:r=0,byteLength:i=0,byteStride:o,count:a,mode:s,filter:u="NONE",buffer:d}=n,g=t.gltf.buffers[d],_=new Uint8Array(g.arrayBuffer,g.byteOffset+r,i),E=new Uint8Array(t.gltf.buffers[e.buffer].arrayBuffer,e.byteOffset,e.byteLength);return await PVe(E,a,o,_,s,u),E}return null}const NVe=Object.freeze(Object.defineProperty({__proto__:null,decode:DVe,name:LVe},Symbol.toStringTag,{value:"Module"})),Gy="EXT_texture_webp",FVe=Gy;function kVe(t,e){const n=new ju(t);if(!O_e("image/webp")){if(n.getRequiredExtensions().includes(Gy))throw new Error("gltf: Required extension ".concat(Gy," not supported by browser"));return}const{json:r}=n;for(const i of r.textures||[]){const o=n.getObjectExtension(i,Gy);o&&(i.source=o.source),n.removeObjectExtension(i,Gy)}n.removeExtension(Gy)}const zVe=Object.freeze(Object.defineProperty({__proto__:null,name:FVe,preprocess:kVe},Symbol.toStringTag,{value:"Module"})),pP="KHR_texture_basisu",UVe=pP;function GVe(t,e){const n=new ju(t),{json:r}=n;for(const i of r.textures||[]){const o=n.getObjectExtension(i,pP);o&&(i.source=o.source),n.removeObjectExtension(i,pP)}n.removeExtension(pP)}const jVe=Object.freeze(Object.defineProperty({__proto__:null,name:UVe,preprocess:GVe},Symbol.toStringTag,{value:"Module"})),VVe="3.4.14",$Ve={draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}},HVe={name:"Draco",id:Kp?"draco":"draco-nodejs",module:"draco",shapes:["mesh"],version:VVe,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:$Ve};function WVe(t,e,n){const r=Rse(e.metadata),i=[],o=qVe(e.attributes);for(const a in t){const s=t[a],u=Qq(a,s,o[a]);i.push(u)}if(n){const a=Qq("indices",n);i.push(a)}return new fv(i,r)}function qVe(t){const e={};for(const n in t){const r=t[n];e[r.name||"undefined"]=r}return e}function Qq(t,e,n){const r=n?Rse(n.metadata):void 0;return Ije(t,e,r)}function Rse(t){const e=new Map;for(const n in t)e.set("".concat(n,".string"),JSON.stringify(t[n]));return e}const Kq={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},XVe={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},ZVe=4;class YVe{constructor(e){q(this,"draco",void 0),q(this,"decoder",void 0),q(this,"metadataQuerier",void 0),this.draco=e,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new this.draco.DecoderBuffer;r.Init(new Int8Array(e),e.byteLength),this._disableAttributeTransforms(n);const i=this.decoder.GetEncodedGeometryType(r),o=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let a;switch(i){case this.draco.TRIANGULAR_MESH:a=this.decoder.DecodeBufferToMesh(r,o);break;case this.draco.POINT_CLOUD:a=this.decoder.DecodeBufferToPointCloud(r,o);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!a.ok()||!o.ptr){const E="DRACO decompression failed: ".concat(a.error_msg());throw new Error(E)}const s=this._getDracoLoaderData(o,i,n),u=this._getMeshData(o,s,n),d=yU(u.attributes),g=WVe(u.attributes,s,u.indices);return{loader:"draco",loaderData:s,header:{vertexCount:o.num_points(),boundingBox:d},...u,schema:g}}finally{this.draco.destroy(r),o&&this.draco.destroy(o)}}_getDracoLoaderData(e,n,r){const i=this._getTopLevelMetadata(e),o=this._getDracoAttributes(e,r);return{geometry_type:n,num_attributes:e.num_attributes(),num_points:e.num_points(),num_faces:e instanceof this.draco.Mesh?e.num_faces():0,metadata:i,attributes:o}}_getDracoAttributes(e,n){const r={};for(let i=0;i<e.num_attributes();i++){const o=this.decoder.GetAttribute(e,i),a=this._getAttributeMetadata(e,i);r[o.unique_id()]={unique_id:o.unique_id(),attribute_type:o.attribute_type(),data_type:o.data_type(),num_components:o.num_components(),byte_offset:o.byte_offset(),byte_stride:o.byte_stride(),normalized:o.normalized(),attribute_index:i,metadata:a};const s=this._getQuantizationTransform(o,n);s&&(r[o.unique_id()].quantization_transform=s);const u=this._getOctahedronTransform(o,n);u&&(r[o.unique_id()].octahedron_transform=u)}return r}_getMeshData(e,n,r){const i=this._getMeshAttributes(n,e,r);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");if(e instanceof this.draco.Mesh)switch(r.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(e),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(e),size:1}}}return{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(e,n,r){const i={};for(const o of Object.values(e.attributes)){const a=this._deduceAttributeName(o,r);o.name=a;const{value:s,size:u}=this._getAttributeValues(n,o);i[a]={value:s,size:u,byteOffset:o.byte_offset,byteStride:o.byte_stride,normalized:o.normalized}}return i}_getTriangleListIndices(e){const r=e.num_faces()*3,i=r*ZVe,o=this.draco._malloc(i);try{return this.decoder.GetTrianglesUInt32Array(e,i,o),new Uint32Array(this.draco.HEAPF32.buffer,o,r).slice()}finally{this.draco._free(o)}}_getTriangleStripIndices(e){const n=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(e,n),JVe(n)}finally{this.draco.destroy(n)}}_getAttributeValues(e,n){const r=XVe[n.data_type],i=n.num_components,a=e.num_points()*i,s=a*r.BYTES_PER_ELEMENT,u=QVe(this.draco,r);let d;const g=this.draco._malloc(s);try{const _=this.decoder.GetAttribute(e,n.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(e,_,u,s,g),d=new r(this.draco.HEAPF32.buffer,g,a).slice()}finally{this.draco._free(g)}return{value:d,size:i}}_deduceAttributeName(e,n){const r=e.unique_id;for(const[a,s]of Object.entries(n.extraAttributes||{}))if(s===r)return a;const i=e.attribute_type;for(const a in Kq)if(this.draco[a]===i)return Kq[a];const o=n.attributeNameEntry||"name";return e.metadata[o]?e.metadata[o].string:"CUSTOM_ATTRIBUTE_".concat(r)}_getTopLevelMetadata(e){const n=this.decoder.GetMetadata(e);return this._getDracoMetadata(n)}_getAttributeMetadata(e,n){const r=this.decoder.GetAttributeMetadata(e,n);return this._getDracoMetadata(r)}_getDracoMetadata(e){if(!e||!e.ptr)return{};const n={},r=this.metadataQuerier.NumEntries(e);for(let i=0;i<r;i++){const o=this.metadataQuerier.GetEntryName(e,i);n[o]=this._getDracoMetadataField(e,o)}return n}_getDracoMetadataField(e,n){const r=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(e,n,r);const i=KVe(r);return{int:this.metadataQuerier.GetIntEntry(e,n),string:this.metadataQuerier.GetStringEntry(e,n),double:this.metadataQuerier.GetDoubleEntry(e,n),intArray:i}}finally{this.draco.destroy(r)}}_disableAttributeTransforms(e){const{quantizedAttributes:n=[],octahedronAttributes:r=[]}=e,i=[...n,...r];for(const o of i)this.decoder.SkipAttributeTransform(this.draco[o])}_getQuantizationTransform(e,n){const{quantizedAttributes:r=[]}=n,i=e.attribute_type();if(r.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(e))return{quantization_bits:a.quantization_bits(),range:a.range(),min_values:new Float32Array([1,2,3]).map(s=>a.min_value(s))}}finally{this.draco.destroy(a)}}return null}_getOctahedronTransform(e,n){const{octahedronAttributes:r=[]}=n,i=e.attribute_type();if(r.map(a=>this.decoder[a]).includes(i)){const a=new this.draco.AttributeQuantizationTransform;try{if(a.InitFromAttribute(e))return{quantization_bits:a.quantization_bits()}}finally{this.draco.destroy(a)}}return null}}function QVe(t,e){switch(e){case Float32Array:return t.DT_FLOAT32;case Int8Array:return t.DT_INT8;case Int16Array:return t.DT_INT16;case Int32Array:return t.DT_INT32;case Uint8Array:return t.DT_UINT8;case Uint16Array:return t.DT_UINT16;case Uint32Array:return t.DT_UINT32;default:return t.DT_INVALID}}function KVe(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}function JVe(t){const e=t.size(),n=new Int32Array(e);for(let r=0;r<e;r++)n[r]=t.GetValue(r);return n}const e9e="1.5.5",wU="https://www.gstatic.com/draco/versioned/decoders/".concat(e9e),t9e="".concat(wU,"/draco_decoder.js"),n9e="".concat(wU,"/draco_wasm_wrapper.js"),r9e="".concat(wU,"/draco_decoder.wasm");let Pb;async function i9e(t){const e=t.modules||{};return e.draco3d?Pb=Pb||e.draco3d.createDecoderModule({}).then(n=>({draco:n})):Pb=Pb||o9e(t),await Pb}async function o9e(t){let e,n;switch(t.draco&&t.draco.decoderType){case"js":e=await I0(t9e,"draco",t);break;case"wasm":default:[e,n]=await Promise.all([await I0(n9e,"draco",t),await I0(r9e,"draco",t)])}return e=e||globalThis.DracoDecoderModule,await s9e(e,n)}function s9e(t,e){const n={};return e&&(n.wasmBinary=e),new Promise(r=>{t({...n,onModuleLoaded:i=>r({draco:i})})})}const Lse={...HVe,parse:a9e};async function a9e(t,e){const{draco:n}=await i9e(e),r=new YVe(n);try{return r.parseSync(t,e==null?void 0:e.draco)}finally{r.destroy()}}function l9e(t){const e={};for(const n in t){const r=t[n];if(n!=="indices"){const i=Dse(r);e[n]=i}}return e}function Dse(t){const{buffer:e,size:n,count:r}=u9e(t);return{value:e,size:n,byteOffset:0,count:r,type:Ise(n),componentType:Mse(e)}}function u9e(t){let e=t,n=1,r=0;return t&&t.value&&(e=t.value,n=t.size||1),e&&(ArrayBuffer.isView(e)||(e=c9e(e,Float32Array)),r=e.length/n),{buffer:e,size:n,count:r}}function c9e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return t?Array.isArray(t)?new e(t):n&&!(t instanceof e)?new e(t):t:null}const o_="KHR_draco_mesh_compression",f9e=o_;function h9e(t,e,n){const r=new ju(t);for(const i of Bse(r))r.getObjectExtension(i,o_)}async function d9e(t,e,n){var r;if(!(e!=null&&(r=e.gltf)!==null&&r!==void 0&&r.decompressMeshes))return;const i=new ju(t),o=[];for(const a of Bse(i))i.getObjectExtension(a,o_)&&o.push(g9e(i,a,e,n));await Promise.all(o),i.removeExtension(o_)}function p9e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n=new ju(t);for(const r of n.json.meshes||[])m9e(r,e),n.addRequiredExtension(o_)}async function g9e(t,e,n,r){const i=t.getObjectExtension(e,o_);if(!i)return;const o=t.getTypedArrayForBufferView(i.bufferView),a=i5(o.buffer,o.byteOffset),{parse:s}=r,u={...n};delete u["3d-tiles"];const d=await s(a,Lse,u,r),g=l9e(d.attributes);for(const[_,E]of Object.entries(g))if(_ in e.attributes){const P=e.attributes[_],O=t.getAccessor(P);O!=null&&O.min&&O!==null&&O!==void 0&&O.max&&(E.min=O.min,E.max=O.max)}e.attributes=g,d.indices&&(e.indices=Dse(d.indices)),A9e(e)}function m9e(t,e){var n;let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:4,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const a=i.DracoWriter.encodeSync({attributes:t}),s=o==null||(n=o.parseSync)===null||n===void 0?void 0:n.call(o,{attributes:t}),u=i._addFauxAttributes(s.attributes),d=i.addBufferView(a);return{primitives:[{attributes:u,mode:r,extensions:{[o_]:{bufferView:d,attributes:u}}}]}}function A9e(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*Bse(t){for(const e of t.json.meshes||[])for(const n of e.primitives)yield n}const _9e=Object.freeze(Object.defineProperty({__proto__:null,decode:d9e,encode:p9e,name:f9e,preprocess:h9e},Symbol.toStringTag,{value:"Module"})),y9e={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},v9e={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},EU="KHR_texture_transform",x9e=EU,gT=new _t,b9e=new is,w9e=new is;async function E9e(t,e){if(!new ju(t).getExtension(EU))return;const i=t.json.materials||[];for(let o=0;o<i.length;o++)S9e(o,t)}function S9e(t,e){var n,r,i;const o=[],a=(n=e.json.materials)===null||n===void 0?void 0:n[t],s=a==null||(r=a.pbrMetallicRoughness)===null||r===void 0?void 0:r.baseColorTexture;s&&Ib(e,t,s,o);const u=a==null?void 0:a.emissiveTexture;u&&Ib(e,t,u,o);const d=a==null?void 0:a.normalTexture;d&&Ib(e,t,d,o);const g=a==null?void 0:a.occlusionTexture;g&&Ib(e,t,g,o);const _=a==null||(i=a.pbrMetallicRoughness)===null||i===void 0?void 0:i.metallicRoughnessTexture;_&&Ib(e,t,_,o)}function Ib(t,e,n,r){const i=T9e(n,r);if(!i)return;const o=t.json.meshes||[];for(const a of o)for(const s of a.primitives){const u=s.material;Number.isFinite(u)&&e===u&&C9e(t,s,i)}}function T9e(t,e){var n;const r=(n=t.extensions)===null||n===void 0?void 0:n[EU],{texCoord:i=0}=t,{texCoord:o=i}=r;if(!(e.findIndex(s=>{let[u,d]=s;return u===i&&d===o})!==-1)){const s=M9e(r);return i!==o&&(t.texCoord=o),e.push([i,o]),{originalTexCoord:i,texCoord:o,matrix:s}}return null}function C9e(t,e,n){const{originalTexCoord:r,texCoord:i,matrix:o}=n,a=e.attributes["TEXCOORD_".concat(r)];if(Number.isFinite(a)){var s;const d=(s=t.json.accessors)===null||s===void 0?void 0:s[a];if(d&&d.bufferView){var u;const g=(u=t.json.bufferViews)===null||u===void 0?void 0:u[d.bufferView];if(g){const{arrayBuffer:_,byteOffset:E}=t.buffers[g.buffer],P=(E||0)+(d.byteOffset||0)+(g.byteOffset||0),{ArrayType:O,length:D}=xU(d,g),V=v9e[d.componentType],k=y9e[d.type],F=g.byteStride||V*k,z=new Float32Array(D);for(let X=0;X<d.count;X++){const Y=new O(_,P+X*F,2);gT.set(Y[0],Y[1],1),gT.transformByMatrix3(o),z.set([gT[0],gT[1]],X*k)}r===i?P9e(d,g,t.buffers,z):I9e(i,d,e,t,z)}}}}function P9e(t,e,n,r){t.componentType=5126,n.push({arrayBuffer:r.buffer,byteOffset:0,byteLength:r.buffer.byteLength}),e.buffer=n.length-1,e.byteLength=r.buffer.byteLength,e.byteOffset=0,delete e.byteStride}function I9e(t,e,n,r,i){r.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const o=r.json.bufferViews;if(!o)return;o.push({buffer:r.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const a=r.json.accessors;a&&(a.push({bufferView:(o==null?void 0:o.length)-1,byteOffset:0,componentType:5126,count:e.count,type:"VEC2"}),n.attributes["TEXCOORD_".concat(t)]=a.length-1)}function M9e(t){const{offset:e=[0,0],rotation:n=0,scale:r=[1,1]}=t,i=new is().set(1,0,0,0,1,0,e[0],e[1],1),o=b9e.set(Math.cos(n),Math.sin(n),0,-Math.sin(n),Math.cos(n),0,0,0,1),a=w9e.set(r[0],0,0,0,r[1],0,0,0,1);return i.multiplyRight(o).multiplyRight(a)}const O9e=Object.freeze(Object.defineProperty({__proto__:null,decode:E9e,name:x9e},Symbol.toStringTag,{value:"Module"})),T0="KHR_lights_punctual",R9e=T0;async function L9e(t){const e=new ju(t),{json:n}=e,r=e.getExtension(T0);r&&(e.json.lights=r.lights,e.removeExtension(T0));for(const i of n.nodes||[]){const o=e.getObjectExtension(i,T0);o&&(i.light=o.light),e.removeObjectExtension(i,T0)}}async function D9e(t){const e=new ju(t),{json:n}=e;if(n.lights){const r=e.addExtension(T0);fc(!r.lights),r.lights=n.lights,delete n.lights}if(e.json.lights){for(const r of e.json.lights){const i=r.node;e.addObjectExtension(i,T0,r)}delete e.json.lights}}const B9e=Object.freeze(Object.defineProperty({__proto__:null,decode:L9e,encode:D9e,name:R9e},Symbol.toStringTag,{value:"Module"})),AE="KHR_materials_unlit",N9e=AE;async function F9e(t){const e=new ju(t),{json:n}=e;for(const r of n.materials||[])r.extensions&&r.extensions.KHR_materials_unlit&&(r.unlit=!0),e.removeObjectExtension(r,AE);e.removeExtension(AE)}function k9e(t){const e=new ju(t),{json:n}=e;if(e.materials)for(const r of n.materials||[])r.unlit&&(delete r.unlit,e.addObjectExtension(r,AE,{}),e.addExtension(AE))}const z9e=Object.freeze(Object.defineProperty({__proto__:null,decode:F9e,encode:k9e,name:N9e},Symbol.toStringTag,{value:"Module"})),nw="KHR_techniques_webgl",U9e=nw;async function G9e(t){const e=new ju(t),{json:n}=e,r=e.getExtension(nw);if(r){const i=V9e(r,e);for(const o of n.materials||[]){const a=e.getObjectExtension(o,nw);a&&(o.technique=Object.assign({},a,i[a.technique]),o.technique.values=$9e(o.technique,e)),e.removeObjectExtension(o,nw)}e.removeExtension(nw)}}async function j9e(t,e){}function V9e(t,e){const{programs:n=[],shaders:r=[],techniques:i=[]}=t,o=new TextDecoder;return r.forEach(a=>{if(Number.isFinite(a.bufferView))a.code=o.decode(e.getTypedArrayForBufferView(a.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),n.forEach(a=>{a.fragmentShader=r[a.fragmentShader],a.vertexShader=r[a.vertexShader]}),i.forEach(a=>{a.program=n[a.program]}),i}function $9e(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(r=>{t.uniforms[r].value&&!(r in n)&&(n[r]=t.uniforms[r].value)}),Object.keys(n).forEach(r=>{typeof n[r]=="object"&&n[r].index!==void 0&&(n[r].texture=e.getTexture(n[r].index))}),n}const H9e=Object.freeze(Object.defineProperty({__proto__:null,decode:G9e,encode:j9e,name:U9e},Symbol.toStringTag,{value:"Module"})),Nse="EXT_feature_metadata",W9e=Nse;async function q9e(t){const e=new ju(t);X9e(e)}function X9e(t){var e;const n=t.getExtension(Nse),r=n==null||(e=n.schema)===null||e===void 0?void 0:e.classes,i=n==null?void 0:n.featureTables;if((n==null?void 0:n.featureTextures)&&console.warn('featureTextures is not yet supported in the "EXT_feature_metadata" extension.'),r&&i)for(const a in r){const s=r[a],u=Q9e(i,a);u&&Z9e(t,u,s)}}function Z9e(t,e,n){for(const i in n.properties){var r;const o=n.properties[i],a=e==null||(r=e.properties)===null||r===void 0?void 0:r[i],s=e.count;if(a){const u=Y9e(t,o,s,a);a.data=u}}}function Y9e(t,e,n,r){const i=r.bufferView;let o=t.getTypedArrayForBufferView(i);switch(e.type){case"STRING":{const a=r.stringOffsetBufferView,s=t.getTypedArrayForBufferView(a);o=K9e(o,s,n);break}}return o}function Q9e(t,e){for(const n in t){const r=t[n];if(r.class===e)return r}return null}function K9e(t,e,n){const r=[],i=new TextDecoder("utf8");let o=0;const a=4;for(let s=0;s<n;s++){const u=e[(s+1)*a]-e[s*a],d=t.subarray(o,u+o),g=i.decode(d);r.push(g),o+=u}return r}const J9e=Object.freeze(Object.defineProperty({__proto__:null,decode:q9e,name:W9e},Symbol.toStringTag,{value:"Module"})),Fse=[NVe,zVe,jVe,_9e,B9e,z9e,H9e,O9e,J9e];function e$e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=Fse.filter(o=>kse(o.name,e));for(const o of r){var i;(i=o.preprocess)===null||i===void 0||i.call(o,t,e,n)}}async function t$e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;const r=Fse.filter(o=>kse(o.name,e));for(const o of r){var i;await((i=o.decode)===null||i===void 0?void 0:i.call(o,t,e,n))}}function kse(t,e){var n;const r=(e==null||(n=e.gltf)===null||n===void 0?void 0:n.excludeExtensions)||{};return!(t in r&&!r[t])}const GB="KHR_binary_glTF";function n$e(t){const e=new ju(t),{json:n}=e;for(const r of n.images||[]){const i=e.getObjectExtension(r,GB);i&&Object.assign(r,i),e.removeObjectExtension(r,GB)}n.buffers&&n.buffers[0]&&delete n.buffers[0].uri,e.removeExtension(GB)}const Jq={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},r$e={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class i$e{constructor(){q(this,"idToIndexMap",{animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}}),q(this,"json",void 0)}normalize(e,n){this.json=e.json;const r=e.json;switch(r.asset&&r.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn("glTF: Unknown version ".concat(r.asset.version));return}if(!n.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(r),this._convertTopLevelObjectsToArrays(r),n$e(e),this._convertObjectIdsToArrayIndices(r),this._updateObjects(r),this._updateMaterial(r)}_addAsset(e){e.asset=e.asset||{},e.asset.version="2.0",e.asset.generator=e.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(e){for(const n in Jq)this._convertTopLevelObjectToArray(e,n)}_convertTopLevelObjectToArray(e,n){const r=e[n];if(!(!r||Array.isArray(r))){e[n]=[];for(const i in r){const o=r[i];o.id=o.id||i;const a=e[n].length;e[n].push(o),this.idToIndexMap[n][i]=a}}}_convertObjectIdsToArrayIndices(e){for(const n in Jq)this._convertIdsToIndices(e,n);"scene"in e&&(e.scene=this._convertIdToIndex(e.scene,"scene"));for(const n of e.textures)this._convertTextureIds(n);for(const n of e.meshes)this._convertMeshIds(n);for(const n of e.nodes)this._convertNodeIds(n);for(const n of e.scenes)this._convertSceneIds(n)}_convertTextureIds(e){e.source&&(e.source=this._convertIdToIndex(e.source,"image"))}_convertMeshIds(e){for(const n of e.primitives){const{attributes:r,indices:i,material:o}=n;for(const a in r)r[a]=this._convertIdToIndex(r[a],"accessor");i&&(n.indices=this._convertIdToIndex(i,"accessor")),o&&(n.material=this._convertIdToIndex(o,"material"))}}_convertNodeIds(e){e.children&&(e.children=e.children.map(n=>this._convertIdToIndex(n,"node"))),e.meshes&&(e.meshes=e.meshes.map(n=>this._convertIdToIndex(n,"mesh")))}_convertSceneIds(e){e.nodes&&(e.nodes=e.nodes.map(n=>this._convertIdToIndex(n,"node")))}_convertIdsToIndices(e,n){e[n]||(console.warn("gltf v1: json doesn't contain attribute ".concat(n)),e[n]=[]);for(const r of e[n])for(const i in r){const o=r[i],a=this._convertIdToIndex(o,i);r[i]=a}}_convertIdToIndex(e,n){const r=r$e[n];if(r in this.idToIndexMap){const i=this.idToIndexMap[r][e];if(!Number.isFinite(i))throw new Error("gltf v1: failed to resolve ".concat(n," with id ").concat(e));return i}return e}_updateObjects(e){for(const n of this.json.buffers)delete n.type}_updateMaterial(e){for(const o of e.materials){var n,r,i;o.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const a=((n=o.values)===null||n===void 0?void 0:n.tex)||((r=o.values)===null||r===void 0?void 0:r.texture2d_0)||((i=o.values)===null||i===void 0?void 0:i.diffuseTex),s=e.textures.findIndex(u=>u.id===a);s!==-1&&(o.pbrMetallicRoughness.baseColorTexture={index:s})}}}function o$e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new i$e().normalize(t,e)}const s$e={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},a$e={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},rf={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},l$e={magFilter:rf.TEXTURE_MAG_FILTER,minFilter:rf.TEXTURE_MIN_FILTER,wrapS:rf.TEXTURE_WRAP_S,wrapT:rf.TEXTURE_WRAP_T},u$e={[rf.TEXTURE_MAG_FILTER]:rf.LINEAR,[rf.TEXTURE_MIN_FILTER]:rf.NEAREST_MIPMAP_LINEAR,[rf.TEXTURE_WRAP_S]:rf.REPEAT,[rf.TEXTURE_WRAP_T]:rf.REPEAT};function c$e(t){return a$e[t]}function f$e(t){return s$e[t]}class h$e{constructor(){q(this,"baseUri",""),q(this,"json",{}),q(this,"buffers",[]),q(this,"images",[])}postProcess(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{json:r,buffers:i=[],images:o=[],baseUri:a=""}=e;return fc(r),this.baseUri=a,this.json=r,this.buffers=i,this.images=o,this._resolveTree(this.json,n),this.json}_resolveTree(e){e.bufferViews&&(e.bufferViews=e.bufferViews.map((n,r)=>this._resolveBufferView(n,r))),e.images&&(e.images=e.images.map((n,r)=>this._resolveImage(n,r))),e.samplers&&(e.samplers=e.samplers.map((n,r)=>this._resolveSampler(n,r))),e.textures&&(e.textures=e.textures.map((n,r)=>this._resolveTexture(n,r))),e.accessors&&(e.accessors=e.accessors.map((n,r)=>this._resolveAccessor(n,r))),e.materials&&(e.materials=e.materials.map((n,r)=>this._resolveMaterial(n,r))),e.meshes&&(e.meshes=e.meshes.map((n,r)=>this._resolveMesh(n,r))),e.nodes&&(e.nodes=e.nodes.map((n,r)=>this._resolveNode(n,r))),e.skins&&(e.skins=e.skins.map((n,r)=>this._resolveSkin(n,r))),e.scenes&&(e.scenes=e.scenes.map((n,r)=>this._resolveScene(n,r))),e.scene!==void 0&&(e.scene=e.scenes[this.json.scene])}getScene(e){return this._get("scenes",e)}getNode(e){return this._get("nodes",e)}getSkin(e){return this._get("skins",e)}getMesh(e){return this._get("meshes",e)}getMaterial(e){return this._get("materials",e)}getAccessor(e){return this._get("accessors",e)}getCamera(e){return null}getTexture(e){return this._get("textures",e)}getSampler(e){return this._get("samplers",e)}getImage(e){return this._get("images",e)}getBufferView(e){return this._get("bufferViews",e)}getBuffer(e){return this._get("buffers",e)}_get(e,n){if(typeof n=="object")return n;const r=this.json[e]&&this.json[e][n];return r||console.warn("glTF file error: Could not find ".concat(e,"[").concat(n,"]")),r}_resolveScene(e,n){return e.id=e.id||"scene-".concat(n),e.nodes=(e.nodes||[]).map(r=>this.getNode(r)),e}_resolveNode(e,n){return e.id=e.id||"node-".concat(n),e.children&&(e.children=e.children.map(r=>this.getNode(r))),e.mesh!==void 0?e.mesh=this.getMesh(e.mesh):e.meshes!==void 0&&e.meshes.length&&(e.mesh=e.meshes.reduce((r,i)=>{const o=this.getMesh(i);return r.id=o.id,r.primitives=r.primitives.concat(o.primitives),r},{primitives:[]})),e.camera!==void 0&&(e.camera=this.getCamera(e.camera)),e.skin!==void 0&&(e.skin=this.getSkin(e.skin)),e}_resolveSkin(e,n){return e.id=e.id||"skin-".concat(n),e.inverseBindMatrices=this.getAccessor(e.inverseBindMatrices),e}_resolveMesh(e,n){return e.id=e.id||"mesh-".concat(n),e.primitives&&(e.primitives=e.primitives.map(r=>{r={...r};const i=r.attributes;r.attributes={};for(const o in i)r.attributes[o]=this.getAccessor(i[o]);return r.indices!==void 0&&(r.indices=this.getAccessor(r.indices)),r.material!==void 0&&(r.material=this.getMaterial(r.material)),r})),e}_resolveMaterial(e,n){if(e.id=e.id||"material-".concat(n),e.normalTexture&&(e.normalTexture={...e.normalTexture},e.normalTexture.texture=this.getTexture(e.normalTexture.index)),e.occlusionTexture&&(e.occlustionTexture={...e.occlustionTexture},e.occlusionTexture.texture=this.getTexture(e.occlusionTexture.index)),e.emissiveTexture&&(e.emmisiveTexture={...e.emmisiveTexture},e.emissiveTexture.texture=this.getTexture(e.emissiveTexture.index)),e.emissiveFactor||(e.emissiveFactor=e.emmisiveTexture?[1,1,1]:[0,0,0]),e.pbrMetallicRoughness){e.pbrMetallicRoughness={...e.pbrMetallicRoughness};const r=e.pbrMetallicRoughness;r.baseColorTexture&&(r.baseColorTexture={...r.baseColorTexture},r.baseColorTexture.texture=this.getTexture(r.baseColorTexture.index)),r.metallicRoughnessTexture&&(r.metallicRoughnessTexture={...r.metallicRoughnessTexture},r.metallicRoughnessTexture.texture=this.getTexture(r.metallicRoughnessTexture.index))}return e}_resolveAccessor(e,n){if(e.id=e.id||"accessor-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView)),e.bytesPerComponent=c$e(e.componentType),e.components=f$e(e.type),e.bytesPerElement=e.bytesPerComponent*e.components,e.bufferView){const r=e.bufferView.buffer,{ArrayType:i,byteLength:o}=xU(e,e.bufferView),a=(e.bufferView.byteOffset||0)+(e.byteOffset||0)+r.byteOffset;let s=r.arrayBuffer.slice(a,a+o);e.bufferView.byteStride&&(s=this._getValueFromInterleavedBuffer(r,a,e.bufferView.byteStride,e.bytesPerElement,e.count)),e.value=new i(s)}return e}_getValueFromInterleavedBuffer(e,n,r,i,o){const a=new Uint8Array(o*i);for(let s=0;s<o;s++){const u=n+s*r;a.set(new Uint8Array(e.arrayBuffer.slice(u,u+i)),s*i)}return a.buffer}_resolveTexture(e,n){return e.id=e.id||"texture-".concat(n),e.sampler="sampler"in e?this.getSampler(e.sampler):u$e,e.source=this.getImage(e.source),e}_resolveSampler(e,n){e.id=e.id||"sampler-".concat(n),e.parameters={};for(const r in e){const i=this._enumSamplerParameter(r);i!==void 0&&(e.parameters[i]=e[r])}return e}_enumSamplerParameter(e){return l$e[e]}_resolveImage(e,n){e.id=e.id||"image-".concat(n),e.bufferView!==void 0&&(e.bufferView=this.getBufferView(e.bufferView));const r=this.images[n];return r&&(e.image=r),e}_resolveBufferView(e,n){const r=e.buffer,i={id:"bufferView-".concat(n),...e,buffer:this.buffers[r]},o=this.buffers[r].arrayBuffer;let a=this.buffers[r].byteOffset||0;return"byteOffset"in e&&(a+=e.byteOffset),i.data=new Uint8Array(o,a,e.byteLength),i}_resolveCamera(e,n){return e.id=e.id||"camera-".concat(n),e.perspective,e.orthographic,e}}function d$e(t,e){return new h$e().postProcess(t,e)}const eX=1735152710,SU=12,fM=8,p$e=1313821514,g$e=5130562,m$e=0,A$e=1,_$e=0,b1=!0;function y$e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return"".concat(String.fromCharCode(t.getUint8(e+0))).concat(String.fromCharCode(t.getUint8(e+1))).concat(String.fromCharCode(t.getUint8(e+2))).concat(String.fromCharCode(t.getUint8(e+3)))}function v$e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const r=new DataView(t),{magic:i=eX}=n,o=r.getUint32(e,!1);return o===i||o===eX}function x$e(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=new DataView(e),i=y$e(r,n+0),o=r.getUint32(n+4,b1),a=r.getUint32(n+8,b1);switch(Object.assign(t,{header:{byteOffset:n,byteLength:a,hasBinChunk:!1},type:i,version:o,json:{},binChunks:[]}),n+=SU,t.version){case 1:return b$e(t,r,n);case 2:return w$e(t,r,n,{});default:throw new Error("Invalid GLB version ".concat(t.version,". Only supports v1 and v2."))}}function b$e(t,e,n){co(t.header.byteLength>SU+fM);const r=e.getUint32(n+0,b1),i=e.getUint32(n+4,b1);return n+=fM,co(i===_$e),B4(t,e,n,r),n+=r,n+=N4(t,e,n,t.header.byteLength),n}function w$e(t,e,n,r){return co(t.header.byteLength>SU+fM),E$e(t,e,n,r),n+t.header.byteLength}function E$e(t,e,n,r){for(;n+8<=t.header.byteLength;){const i=e.getUint32(n+0,b1),o=e.getUint32(n+4,b1);switch(n+=fM,o){case p$e:B4(t,e,n,i);break;case g$e:N4(t,e,n,i);break;case m$e:r.strict||B4(t,e,n,i);break;case A$e:r.strict||N4(t,e,n,i);break}n+=IE(i,4)}return n}function B4(t,e,n,r){const i=new Uint8Array(e.buffer,n,r),a=new TextDecoder("utf8").decode(i);return t.json=JSON.parse(a),IE(r,4)}function N4(t,e,n,r){return t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer}),IE(r,4)}async function S$e(t,e){var n,r,i,o;let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3?arguments[3]:void 0,u=arguments.length>4?arguments[4]:void 0;T$e(t,e,a,s),o$e(t,{normalize:s==null||(n=s.gltf)===null||n===void 0?void 0:n.normalize}),e$e(t,s,u);const d=[];if(s!=null&&(r=s.gltf)!==null&&r!==void 0&&r.loadBuffers&&t.json.buffers&&await C$e(t,s,u),s!=null&&(i=s.gltf)!==null&&i!==void 0&&i.loadImages){const _=P$e(t,s,u);d.push(_)}const g=t$e(t,s,u);return d.push(g),await Promise.all(d),s!=null&&(o=s.gltf)!==null&&o!==void 0&&o.postProcess?d$e(t,s):t}function T$e(t,e,n,r){if(r.uri&&(t.baseUri=r.uri),e instanceof ArrayBuffer&&!v$e(e,n,r)&&(e=new TextDecoder().decode(e)),typeof e=="string")t.json=IAe(e);else if(e instanceof ArrayBuffer){const a={};n=x$e(a,e,n,r.glb),fc(a.type==="glTF","Invalid GLB magic string ".concat(a.type)),t._glb=a,t.json=a.json}else fc(!1,"GLTF: must be ArrayBuffer or string");const i=t.json.buffers||[];if(t.buffers=new Array(i.length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:a}=t._glb;t.buffers[0]={arrayBuffer:a[0].arrayBuffer,byteOffset:a[0].byteOffset,byteLength:a[0].byteLength}}const o=t.json.images||[];t.images=new Array(o.length).fill({})}async function C$e(t,e,n){const r=t.json.buffers||[];for(let a=0;a<r.length;++a){const s=r[a];if(s.uri){var i,o;const{fetch:u}=n;fc(u);const d=Pse(s.uri,e),g=await(n==null||(i=n.fetch)===null||i===void 0?void 0:i.call(n,d)),_=await(g==null||(o=g.arrayBuffer)===null||o===void 0?void 0:o.call(g));t.buffers[a]={arrayBuffer:_,byteOffset:0,byteLength:_.byteLength},delete s.uri}else t.buffers[a]===null&&(t.buffers[a]={arrayBuffer:new ArrayBuffer(s.byteLength),byteOffset:0,byteLength:s.byteLength})}}async function P$e(t,e,n){const r=I$e(t),i=t.json.images||[],o=[];for(const a of r)o.push(M$e(t,i[a],a,e,n));return await Promise.all(o)}function I$e(t){const e=new Set,n=t.json.textures||[];for(const r of n)r.source!==void 0&&e.add(r.source);return Array.from(e).sort()}async function M$e(t,e,n,r,i){const{fetch:o,parse:a}=i;let s;if(e.uri&&!e.hasOwnProperty("bufferView")){const d=Pse(e.uri,r);s=await(await o(d)).arrayBuffer(),e.bufferView={data:s}}if(Number.isFinite(e.bufferView)){const d=gVe(t.json,t.buffers,e.bufferView);s=i5(d.buffer,d.byteOffset,d.byteLength)}fc(s,"glTF image has no data");let u=await a(s,[Uw,pVe],{mimeType:e.mimeType,basis:r.basis||{format:Cse()}},i);u&&u[0]&&(u={compressed:!0,mipmaps:!1,width:u[0].width,height:u[0].height,data:u[0]}),t.images=t.images||[],t.images[n]=u}const _E={name:"glTF",id:"gltf",module:"gltf",version:Qje,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:O$e,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},log:console},deprecatedOptions:{fetchImages:"gltf.loadImages",createImages:"gltf.loadImages",decompress:"gltf.decompressMeshes",postProcess:"gltf.postProcess",gltf:{decompress:"gltf.decompressMeshes"}}};async function O$e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;e={..._E.options,...e},e.gltf={..._E.options.gltf,...e.gltf};const{byteOffset:r=0}=e;return await S$e({},t,r,e,n)}async function R$e(t){const e=[];return t.scenes.forEach(n=>{n.traverse(r=>{Object.values(r.model.getUniforms()).forEach(i=>{i.loaded===!1&&e.push(i)})})}),await L$e(()=>e.some(n=>!n.loaded))}async function L$e(t){for(;t();)await new Promise(e=>requestAnimationFrame(e))}const D$e=`#version 300 es
in vec3 instancePositions;
in vec3 instancePositions64Low;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
in vec3 instanceTranslation;
uniform float sizeScale;
uniform float sizeMinPixels;
uniform float sizeMaxPixels;
uniform mat4 sceneModelMatrix;
uniform bool composeModelMatrix;
in vec4 POSITION;

#ifdef HAS_UV
  in vec2 TEXCOORD_0;
#endif

#ifdef MODULE_PBR
  #ifdef HAS_NORMALS
    in vec4 NORMAL;
  #endif
#endif
out vec4 vColor;
#ifndef MODULE_PBR
  #ifdef HAS_UV
    out vec2 vTEXCOORD_0;
  #endif
#endif
void main(void) {
  #if defined(HAS_UV) && !defined(MODULE_PBR)
    vTEXCOORD_0 = TEXCOORD_0;
    geometry.uv = vTEXCOORD_0;
  #endif

  geometry.worldPosition = instancePositions;
  geometry.pickingColor = instancePickingColors;

  vec3 normal = vec3(0.0, 0.0, 1.0);
  #ifdef MODULE_PBR
    #ifdef HAS_NORMALS
      normal = instanceModelMatrix * (sceneModelMatrix * vec4(NORMAL.xyz, 0.0)).xyz;
    #endif
  #endif

  float originalSize = project_size_to_pixel(sizeScale);
  float clampedSize = clamp(originalSize, sizeMinPixels, sizeMaxPixels);

  vec3 pos = (instanceModelMatrix * (sceneModelMatrix * POSITION).xyz) * sizeScale * (clampedSize / originalSize) + instanceTranslation;
  if(composeModelMatrix) {
    DECKGL_FILTER_SIZE(pos, geometry);
    geometry.normal = project_normal(normal);
    geometry.worldPosition += pos;
    gl_Position = project_position_to_clipspace(pos + instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
  }
  else {
    pos = project_size(pos);
    DECKGL_FILTER_SIZE(pos, geometry);
    gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, pos, geometry.position);
    geometry.normal = project_normal(normal);
  }
  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = TEXCOORD_0;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  vColor = instanceColors;
  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,B$e=`#version 300 es
uniform float opacity;
in vec4 vColor;

out vec4 fragmentColor;
#ifndef MODULE_PBR
  #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
    in vec2 vTEXCOORD_0;
    uniform sampler2D u_BaseColorSampler;
  #endif
#endif

void main(void) {
  #ifdef MODULE_PBR
    fragmentColor = vColor * pbr_filterColor(vec4(0));
    geometry.uv = pbr_vUV;
  #else
    #if defined(HAS_UV) && defined(HAS_BASECOLORMAP)
      fragmentColor = vColor * texture2D(u_BaseColorSampler, vTEXCOORD_0);
      geometry.uv = vTEXCOORD_0;
    #else
      fragmentColor = vColor;
    #endif
  #endif

  fragmentColor.a *= opacity;
  DECKGL_FILTER_COLOR(fragmentColor, geometry);
}
`,zse=[255,255,255,255],N$e={scenegraph:{type:"object",value:null,async:!0},getScene:t=>t&&t.scenes?typeof t.scene=="object"?t.scene:t.scenes[t.scene||0]:t,getAnimator:t=>t&&t.animator,_animations:null,sizeScale:{type:"number",value:1,min:0},sizeMinPixels:{type:"number",min:0,value:0},sizeMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},getPosition:{type:"accessor",value:t=>t.position},getColor:{type:"accessor",value:zse},_lighting:"flat",_imageBasedLightingEnvironment:null,getOrientation:{type:"accessor",value:[0,0,0]},getScale:{type:"accessor",value:[1,1,1]},getTranslation:{type:"accessor",value:[0,0,0]},getTransformMatrix:{type:"accessor",value:[]},loaders:[_E]};class mL extends nl{constructor(...e){super(...e),q(this,"state",void 0)}getShaders(){const e=[Mc,Oc];return this.props._lighting==="pbr"&&e.push(WO),super.getShaders({vs:D$e,fs:B$e,modules:e})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:5130,fp64:this.use64bitPositions(),accessor:"getPosition",transition:!0},instanceColors:{type:5121,size:this.props.colorFormat.length,accessor:"getColor",normalized:!0,defaultValue:zse,transition:!0},instanceModelMatrix:Ase})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;n.scenegraph!==r.scenegraph?this._updateScenegraph():n._animations!==r._animations&&this._applyAnimationsProp(this.state.scenegraph,this.state.animator,n._animations)}finalizeState(e){super.finalizeState(e),this._deleteScenegraph()}_updateScenegraph(){const e=this.props,{gl:n}=this.context;let r=null;if(e.scenegraph instanceof Ev)r={scenes:[e.scenegraph]};else if(e.scenegraph&&!e.scenegraph.gltf){const s=e.scenegraph,u=Yje(n,s,this._getModelOptions());r={gltf:s,...u},R$e(u).then(()=>this.setNeedsRedraw())}else e.scenegraph&&(Or.deprecated("ScenegraphLayer.props.scenegraph","Use GLTFLoader instead of GLTFScenegraphLoader")(),r=e.scenegraph);const i={layer:this,gl:n},o=e.getScene(r,i),a=e.getAnimator(r,i);o instanceof Ev?(this._deleteScenegraph(),this._applyAllAttributes(o),this._applyAnimationsProp(o,a,e._animations),this.setState({scenegraph:o,animator:a})):o!==null&&Or.warn("invalid scenegraph:",o)()}_applyAllAttributes(e){if(this.state.attributesAvailable){const n=this.getAttributeManager().getAttributes();e.traverse(r=>{this._setModelAttributes(r.model,n)})}}_applyAnimationsProp(e,n,r){if(!e||!n||!r)return;const i=n.getAnimations();Object.keys(r).sort().forEach(o=>{const a=r[o];if(o==="*")i.forEach(s=>{Object.assign(s,a)});else if(Number.isFinite(Number(o))){const s=Number(o);s>=0&&s<i.length?Object.assign(i[s],a):Or.warn("animation ".concat(o," not found"))()}else{const s=i.find(({name:u})=>u===o);s?Object.assign(s,a):Or.warn("animation ".concat(o," not found"))()}})}_deleteScenegraph(){const{scenegraph:e}=this.state;e instanceof Ev&&e.delete()}_getModelOptions(){const{_imageBasedLightingEnvironment:e}=this.props;let n=null;return e&&(typeof e=="function"?n=e({gl:this.context.gl,layer:this}):n=e),{gl:this.context.gl,waitForFullLoad:!0,imageBasedLightingEnvironment:n,modelOptions:{isInstanced:!0,transpileToGLSL100:!Hr(this.context.gl),...this.getShaders()},useTangents:!1}}updateAttributes(e){this.setState({attributesAvailable:!0}),this.state.scenegraph&&this.state.scenegraph.traverse(n=>{this._setModelAttributes(n.model,e)})}draw({moduleParameters:e=null,parameters:n={},context:r}){if(!this.state.scenegraph)return;this.props._animations&&this.state.animator&&(this.state.animator.animate(r.timeline.getTime()),this.setNeedsRedraw());const{viewport:i}=this.context,{sizeScale:o,sizeMinPixels:a,sizeMaxPixels:s,opacity:u,coordinateSystem:d}=this.props,g=this.getNumInstances();this.state.scenegraph.traverse((_,{worldMatrix:E})=>{_.model.setInstanceCount(g),_.updateModuleSettings(e),_.draw({parameters:n,uniforms:{sizeScale:o,opacity:u,sizeMinPixels:a,sizeMaxPixels:s,composeModelMatrix:_se(i,d),sceneModelMatrix:E,u_Camera:_.model.getUniforms().project_uCameraPosition}})})}}q(mL,"defaultProps",N$e);q(mL,"layerName","ScenegraphLayer");const F$e=Object.freeze(Object.defineProperty({__proto__:null,ScenegraphLayer:mL,SimpleMeshLayer:x1},Symbol.toStringTag,{value:"Module"})),k$e=`#version 300 es
#define SHADER_NAME simple-mesh-layer-vs
uniform float sizeScale;
uniform bool composeModelMatrix;
uniform bool pickFeatureIds;
in vec3 positions;
in vec3 normals;
in vec3 colors;
in vec2 texCoords;
in vec4 uvRegions;
in vec3 featureIdsPickingColors;
in vec4 instanceColors;
in vec3 instancePickingColors;
in mat3 instanceModelMatrix;
out vec2 vTexCoord;
out vec3 cameraPosition;
out vec3 normals_commonspace;
out vec4 position_commonspace;
out vec4 vColor;

vec2 applyUVRegion(vec2 uv) {
  #ifdef HAS_UV_REGIONS
    return fract(uv) * (uvRegions.zw - uvRegions.xy) + uvRegions.xy;
  #else
    return uv;
  #endif
}

void main(void) {
  vec2 uv = applyUVRegion(texCoords);
  geometry.uv = uv;

  if (pickFeatureIds) {
    geometry.pickingColor = featureIdsPickingColors;
  } else {
    geometry.pickingColor = instancePickingColors;
  }

  vTexCoord = uv;
  cameraPosition = project_uCameraPosition;
  vColor = vec4(colors * instanceColors.rgb, instanceColors.a);

  vec3 pos = (instanceModelMatrix * positions) * sizeScale;
  vec3 projectedPosition = project_position(positions);
  position_commonspace = vec4(projectedPosition, 1.0);
  gl_Position = project_common_position_to_clipspace(position_commonspace);

  geometry.position = position_commonspace;
  normals_commonspace = project_normal(instanceModelMatrix * normals);
  geometry.normal = normals_commonspace;

  DECKGL_FILTER_GL_POSITION(gl_Position, geometry);

  #ifdef MODULE_PBR
    pbr_vPosition = geometry.position.xyz;
    #ifdef HAS_NORMALS
      pbr_vNormal = geometry.normal;
    #endif

    #ifdef HAS_UV
      pbr_vUV = uv;
    #else
      pbr_vUV = vec2(0., 0.);
    #endif
    geometry.uv = pbr_vUV;
  #endif

  DECKGL_FILTER_COLOR(vColor, geometry);
}
`,z$e=`#version 300 es
#define SHADER_NAME simple-mesh-layer-fs

precision highp float;

uniform bool hasTexture;
uniform sampler2D sampler;
uniform bool flatShading;
uniform float opacity;

in vec2 vTexCoord;
in vec3 cameraPosition;
in vec3 normals_commonspace;
in vec4 position_commonspace;
in vec4 vColor;

out vec4 fragColor;

void main(void) {
  
#ifdef MODULE_PBR

  fragColor = vColor * pbr_filterColor(vec4(0));
  geometry.uv = pbr_vUV;
  fragColor.a *= opacity;

#else

  geometry.uv = vTexCoord;

  vec3 normal;
  if (flatShading) {
#ifdef DERIVATIVES_AVAILABLE
    normal = normalize(cross(dFdx(position_commonspace.xyz), dFdy(position_commonspace.xyz)));
#else
    normal = vec3(0.0, 0.0, 1.0);
#endif
  } else {
    normal = normals_commonspace;
  }

  vec4 color = hasTexture ? texture(sampler, vTexCoord) : vColor;
  vec3 lightColor = lighting_getLightColor(color.rgb, cameraPosition, position_commonspace.xyz, normal);
  fragColor = vec4(lightColor, color.a * opacity);

#endif

  DECKGL_FILTER_COLOR(fragColor, geometry);
}
`;function U$e(t){t.COLOR_0||t.colors||(t.colors={constant:!0,value:new Float32Array([1,1,1])})}const G$e={pbrMaterial:{type:"object",value:null},featureIds:{type:"array",value:null,optional:!0}};class TU extends x1{getShaders(){const e=super.getShaders();return e.modules.push(WO),{...e,vs:k$e,fs:z$e}}initializeState(){const{featureIds:e}=this.props;super.initializeState();const n=this.getAttributeManager();e&&n.add({featureIdsPickingColors:{type:5121,size:3,noAlloc:!0,update:this.calculateFeatureIdsPickingColors}})}updateState(e){super.updateState(e);const{props:n,oldProps:r}=e;n.pbrMaterial!==r.pbrMaterial&&this.updatePbrMaterialUniforms(n.pbrMaterial)}draw(e){const{featureIds:n}=this.props;this.state.model&&(this.state.model.setUniforms({u_Camera:this.state.model.getUniforms().project_uCameraPosition,pickFeatureIds:!!n}),super.draw(e))}getModel(e){const{id:n,pbrMaterial:r}=this.props,i=this.parseMaterial(r,e);this.setState({materialParser:i});const o=this.getShaders();return U$e(e.attributes),new Oa(this.context.gl,{...this.getShaders(),id:n,geometry:e,defines:{...o.defines,...i==null?void 0:i.defines,HAS_UV_REGIONS:e.attributes.uvRegions},parameters:i==null?void 0:i.parameters,isInstanced:!0})}updatePbrMaterialUniforms(e){const{model:n}=this.state;if(n){const{mesh:r}=this.props,i=this.parseMaterial(e,r);this.setState({materialParser:i}),n.setUniforms(i.uniforms)}}parseMaterial(e,n){var r;const i=!!(e.pbrMetallicRoughness&&e.pbrMetallicRoughness.baseColorTexture);return(r=this.state.materialParser)===null||r===void 0||r.delete(),new Ese(this.context.gl,{attributes:{NORMAL:n.attributes.normals,TEXCOORD_0:n.attributes.texCoords},material:{unlit:i,...e},pbrDebug:!1,imageBasedLightingEnvironment:null,lights:!0,useTangents:!1})}calculateFeatureIdsPickingColors(e){const n=this.props.featureIds,r=new Uint8ClampedArray(n.length*e.size),i=[];for(let o=0;o<n.length;o++)this.encodePickingColor(n[o],i),r[o*3]=i[0],r[o*3+1]=i[1],r[o*3+2]=i[2];e.value=r}finalizeState(e){var n;super.finalizeState(e),(n=this.state.materialParser)===null||n===void 0||n.delete(),this.setState({materialParser:null})}}q(TU,"layerName","MeshLayer");q(TU,"defaultProps",G$e);const j$e=6378137,V$e=6378137,$$e=6356752314245179e-9;function AL(t){return t}new _t;function H$e(t,e=[],n=AL){return"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):"x"in t?(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function W$e(t,e=[]){return H$e(t,e,fo._cartographicRadians?AL:Nte)}function q$e(t,e,n=AL){return"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):"x"in e?(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]):(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]),e}function X$e(t,e){return q$e(t,e,fo._cartographicRadians?AL:Fte)}const My=new _t,Z$e=new _t,Y$e=new _t;function Q$e(t,e,n=[]){const{oneOverRadii:r,oneOverRadiiSquared:i,centerToleranceSquared:o}=e;My.from(t);const a=My.x,s=My.y,u=My.z,d=r.x,g=r.y,_=r.z,E=a*a*d*d,P=s*s*g*g,O=u*u*_*_,D=E+P+O,V=Math.sqrt(1/D);if(!Number.isFinite(V))return;const k=Z$e;if(k.copy(t).scale(V),D<o)return k.to(n);const F=i.x,z=i.y,X=i.z,Y=Y$e;Y.set(k.x*F*2,k.y*z*2,k.z*X*2);let J=(1-V)*My.len()/(.5*Y.len()),re=0,ue,ie,ce,se;do{J-=re,ue=1/(1+J*F),ie=1/(1+J*z),ce=1/(1+J*X);const me=ue*ue,Ce=ie*ie,we=ce*ce,Ye=me*ue,at=Ce*ie,yt=we*ce;se=E*me+P*Ce+O*we-1;const De=-2*(E*Ye*F+P*at*z+O*yt*X);re=se/De}while(Math.abs(se)>Uv.EPSILON12);return My.scale([ue,ie,ce]).to(n)}const tX=1e-14,K$e=new _t,nX={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},jB={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Mb={east:new _t,north:new _t,up:new _t,west:new _t,south:new _t,down:new _t},J$e=new _t,eHe=new _t,tHe=new _t;function rX(t,e,n,r,i,o){const a=nX[e]&&nX[e][n];ac(a&&(!r||r===a));let s,u,d;const g=K$e.copy(i);if(Sl(g.x,0,tX)&&Sl(g.y,0,tX)){const E=Math.sign(g.z);s=J$e.fromArray(jB[e]),e!=="east"&&e!=="west"&&s.scale(E),u=eHe.fromArray(jB[n]),n!=="east"&&n!=="west"&&u.scale(E),d=tHe.fromArray(jB[r]),r!=="east"&&r!=="west"&&d.scale(E)}else{const{up:E,east:P,north:O}=Mb;P.set(-g.y,g.x,0).normalize(),t.geodeticSurfaceNormal(g,E),O.copy(E).cross(P);const{down:D,west:V,south:k}=Mb;D.copy(E).scale(-1),V.copy(P).scale(-1),k.copy(O).scale(-1),s=Mb[e],u=Mb[n],d=Mb[r]}return o[0]=s.x,o[1]=s.y,o[2]=s.z,o[3]=0,o[4]=u.x,o[5]=u.y,o[6]=u.z,o[7]=0,o[8]=d.x,o[9]=d.y,o[10]=d.z,o[11]=0,o[12]=g.x,o[13]=g.y,o[14]=g.z,o[15]=1,o}const mT=new _t,iX=new _t,nHe=new _t,oh=new _t,rHe=new _t,AT=new _t;class ss{constructor(e=0,n=0,r=0){q(this,"radii",void 0),q(this,"radiiSquared",void 0),q(this,"radiiToTheFourth",void 0),q(this,"oneOverRadii",void 0),q(this,"oneOverRadiiSquared",void 0),q(this,"minimumRadius",void 0),q(this,"maximumRadius",void 0),q(this,"centerToleranceSquared",Uv.EPSILON1),q(this,"squaredXOverSquaredZ",void 0),ac(e>=0),ac(n>=0),ac(r>=0),this.radii=new _t(e,n,r),this.radiiSquared=new _t(e*e,n*n,r*r),this.radiiToTheFourth=new _t(e*e*e*e,n*n*n*n,r*r*r*r),this.oneOverRadii=new _t(e===0?0:1/e,n===0?0:1/n,r===0?0:1/r),this.oneOverRadiiSquared=new _t(e===0?0:1/(e*e),n===0?0:1/(n*n),r===0?0:1/(r*r)),this.minimumRadius=Math.min(e,n,r),this.maximumRadius=Math.max(e,n,r),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(e){return this===e||!!(e&&this.radii.equals(e.radii))}toString(){return this.radii.toString()}cartographicToCartesian(e,n=[0,0,0]){const r=iX,i=nHe,[,,o]=e;this.geodeticSurfaceNormalCartographic(e,r),i.copy(this.radiiSquared).scale(r);const a=Math.sqrt(r.dot(i));return i.scale(1/a),r.scale(o),i.add(r),i.to(n)}cartesianToCartographic(e,n=[0,0,0]){AT.from(e);const r=this.scaleToGeodeticSurface(AT,oh);if(!r)return;const i=this.geodeticSurfaceNormal(r,iX),o=rHe;o.copy(AT).subtract(r);const a=Math.atan2(i.y,i.x),s=Math.asin(i.z),u=Math.sign(R5(o,AT))*O5(o);return X$e([a,s,u],n)}eastNorthUpToFixedFrame(e,n=new vr){return rX(this,"east","north","up",e,n)}localFrameToFixedFrame(e,n,r,i,o=new vr){return rX(this,e,n,r,i,o)}geocentricSurfaceNormal(e,n=[0,0,0]){return mT.from(e).normalize().to(n)}geodeticSurfaceNormalCartographic(e,n=[0,0,0]){const r=W$e(e),i=r[0],o=r[1],a=Math.cos(o);return mT.set(a*Math.cos(i),a*Math.sin(i),Math.sin(o)).normalize(),mT.to(n)}geodeticSurfaceNormal(e,n=[0,0,0]){return mT.from(e).scale(this.oneOverRadiiSquared).normalize().to(n)}scaleToGeodeticSurface(e,n){return Q$e(e,this,n)}scaleToGeocentricSurface(e,n=[0,0,0]){oh.from(e);const r=oh.x,i=oh.y,o=oh.z,a=this.oneOverRadiiSquared,s=1/Math.sqrt(r*r*a.x+i*i*a.y+o*o*a.z);return oh.multiplyScalar(s).to(n)}transformPositionToScaledSpace(e,n=[0,0,0]){return oh.from(e).scale(this.oneOverRadii).to(n)}transformPositionFromScaledSpace(e,n=[0,0,0]){return oh.from(e).scale(this.radii).to(n)}getSurfaceNormalIntersectionWithZAxis(e,n=0,r=[0,0,0]){ac(Sl(this.radii.x,this.radii.y,Uv.EPSILON15)),ac(this.radii.z>0),oh.from(e);const i=oh.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-n))return oh.set(0,0,i).to(r)}}q(ss,"WGS84",new ss(j$e,V$e,$$e));function oX(){let t;if(typeof window<"u"&&window.performance)t=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();t=e[0]*1e3+e[1]/1e6}else t=Date.now();return t}class sX{constructor(e,n){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=n,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=oX(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(oX()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class iHe{constructor(e){this.id=void 0,this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:e,type:n})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const n of Object.values(this.stats))e(n)}getTable(){const e={};return this.forEach(n=>{e[n.name]={time:n.time||0,count:n.count||0,average:n.getAverageTime()||0,hz:n.getHz()||0}}),e}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>this._getOrCreate(n))}_getOrCreate(e){const{name:n,type:r}=e;let i=this.stats[n];return i||(e instanceof sX?i=e:i=new sX(n,r),this.stats[n]=i),i}}class oHe{constructor(e,n,r){q(this,"item",void 0),q(this,"previous",void 0),q(this,"next",void 0),this.item=e,this.previous=n,this.next=r}}class sHe{constructor(){q(this,"head",null),q(this,"tail",null),q(this,"_length",0)}get length(){return this._length}add(e){const n=new oHe(e,this.tail,null);return this.tail?(this.tail.next=n,this.tail=n):(this.head=n,this.tail=n),++this._length,n}remove(e){e&&(e.previous&&e.next?(e.previous.next=e.next,e.next.previous=e.previous):e.previous?(e.previous.next=null,this.tail=e.previous):e.next?(e.next.previous=null,this.head=e.next):(this.head=null,this.tail=null),e.next=null,e.previous=null,--this._length)}splice(e,n){e!==n&&(this.remove(n),this._insert(e,n))}_insert(e,n){const r=e.next;e.next=n,this.tail===e?this.tail=n:r.previous=n,n.next=r,n.previous=e,++this._length}}class aHe{constructor(){q(this,"_list",void 0),q(this,"_sentinel",void 0),q(this,"_trimTiles",void 0),this._list=new sHe,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(e){const n=e._cacheNode;n&&this._list.splice(this._sentinel,n)}add(e,n,r){n._cacheNode||(n._cacheNode=this._list.add(n),r&&r(e,n))}unloadTile(e,n,r){const i=n._cacheNode;i&&(this._list.remove(i),n._cacheNode=null,r&&r(e,n))}unloadTiles(e,n){const r=this._trimTiles;this._trimTiles=!1;const i=this._list,o=e.maximumMemoryUsage*1024*1024,a=this._sentinel;let s=i.head;for(;s!==a&&(e.gpuMemoryUsageInBytes>o||r);){const u=s.item;s=s.next,this.unloadTile(e,u,n)}}trim(){this._trimTiles=!0}}function lHe(t,e){co(t),co(e);const{rtcCenter:n,gltfUpAxis:r}=e,{computedTransform:i,boundingVolume:{center:o}}=t;let a=new vr(i);switch(n&&a.translate(n),r){case"Z":break;case"Y":const _=new vr().rotateX(Math.PI/2);a=a.multiplyRight(_);break;case"X":const E=new vr().rotateY(-Math.PI/2);a=a.multiplyRight(E);break}e.isQuantized&&a.translate(e.quantizedVolumeOffset).scale(e.quantizedVolumeScale);const s=new _t(o);e.cartesianModelMatrix=a,e.cartesianOrigin=s;const u=ss.WGS84.cartesianToCartographic(s,new _t),g=ss.WGS84.eastNorthUpToFixedFrame(s).invert();e.cartographicModelMatrix=g.multiplyRight(a),e.cartographicOrigin=u,e.coordinateSystem||(e.modelMatrix=e.cartographicModelMatrix)}const aX=new _t,VB=new _t,F4=new cc([new cf,new cf,new cf,new cf,new cf,new cf]);function uHe(t,e){const{cameraDirection:n,cameraUp:r,height:i}=t,{metersPerUnit:o}=t.distanceScales,a=gP(t,t.center),s=ss.WGS84.eastNorthUpToFixedFrame(a),u=t.unprojectPosition(t.cameraPosition),d=ss.WGS84.cartographicToCartesian(u,new _t),g=new _t(s.transformAsVector(new _t(n).scale(o))).normalize(),_=new _t(s.transformAsVector(new _t(r).scale(o))).normalize();fHe(t);const E=t.constructor,{longitude:P,latitude:O,width:D,bearing:V,zoom:k}=t,F=new E({longitude:P,latitude:O,height:i,width:D,bearing:V,zoom:k,pitch:0});return{camera:{position:d,direction:g,up:_},viewport:t,topDownViewport:F,height:i,cullingVolume:F4,frameNumber:e,sseDenominator:1.15}}function cHe(t,e,n){if(n===0||t.length<=n)return[t,[]];const r=[],{longitude:i,latitude:o}=e.viewport;for(const[d,g]of t.entries()){const[_,E]=g.header.mbs,P=Math.abs(i-_),O=Math.abs(o-E),D=Math.sqrt(O*O+P*P);r.push([d,D])}const a=r.sort((d,g)=>d[1]-g[1]),s=[];for(let d=0;d<n;d++)s.push(t[a[d][0]]);const u=[];for(let d=n;d<a.length;d++)u.push(t[a[d][0]]);return[s,u]}function fHe(t){const e=t.getFrustumPlanes(),n=lX(e.near,t.cameraPosition),r=gP(t,n),i=gP(t,t.cameraPosition,VB);let o=0;F4.planes[o++].fromPointNormal(r,aX.copy(r).subtract(i));for(const a in e){if(a==="near")continue;const s=e[a],u=lX(s,n,VB),d=gP(t,u,VB);F4.planes[o++].fromPointNormal(d,aX.copy(r).subtract(d))}}function lX(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new _t;const r=t.normal.dot(e);return n.copy(t.normal).scale(t.distance-r).add(e),n}function gP(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new _t;const r=t.unprojectPosition(e);return ss.WGS84.cartographicToCartesian(r,n)}const hHe=6378137,dHe=6378137,k4=6356752314245179e-9,uX=new _t;function pHe(t,e){if(t instanceof d2){const{halfAxes:n}=t,r=mHe(n);return Math.log2(k4/(r+e[2]))}else if(t instanceof h2){const{radius:n}=t;return Math.log2(k4/(n+e[2]))}else if(t.width&&t.height){const{width:n,height:r}=t,i=Math.log2(hHe/n),o=Math.log2(dHe/r);return(i+o)/2}return 1}function Use(t,e,n){const r=ss.WGS84.cartographicToCartesian([t.xmax,t.ymax,t.zmax],new _t),i=Math.sqrt(Math.pow(r[0]-n[0],2)+Math.pow(r[1]-n[1],2)+Math.pow(r[2]-n[2],2));return Math.log2(k4/(i+e[2]))}function gHe(t,e,n){const[r,i,o,a]=t;return Use({xmin:r,xmax:o,ymin:i,ymax:a,zmin:0,zmax:0},e,n)}function mHe(t){t.getColumn(0,uX);const e=t.getColumn(1),n=t.getColumn(2);return uX.add(e).add(n).len()}const ic={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5},tg={ADD:1,REPLACE:2},Sv={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},tf={I3S:"I3S",TILES3D:"TILES3D"},_L={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},AHe={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};function Gse(t){return t!=null}const vl=new _t,mP=new _t,_He=new _t,yHe=new _t;function $B(t,e,n){if(co(t,"3D Tile: boundingVolume must be defined"),t.box)return xHe(t.box,e,n);if(t.region){const[r,i,o,a,s,u]=t.region,d=ss.WGS84.cartographicToCartesian([bl(r),bl(a),s],_He),g=ss.WGS84.cartographicToCartesian([bl(o),bl(i),u],yHe),_=new _t().addVectors(d,g).multiplyScalar(.5),E=new _t().subVectors(d,g).len()/2;return cX([_[0],_[1],_[2],E],new vr)}if(t.sphere)return cX(t.sphere,e,n);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function vHe(t,e){if(t.box)return bHe(e);if(t.region){const[n,r,i,o,a,s]=t.region;return[[bl(n),bl(r),a],[bl(i),bl(o),s]]}if(t.sphere)return wHe(e);throw new Error("Unkown boundingVolume type")}function xHe(t,e,n){const r=new _t(t[0],t[1],t[2]);e.transform(r,r);let i=[];if(t.length===10){const d=t.slice(3,6),g=new Qm;g.fromArray(t,6);const _=new _t([1,0,0]),E=new _t([0,1,0]),P=new _t([0,0,1]);_.transformByQuaternion(g),_.scale(d[0]),E.transformByQuaternion(g),E.scale(d[1]),P.transformByQuaternion(g),P.scale(d[2]),i=[..._.toArray(),...E.toArray(),...P.toArray()]}else i=[...t.slice(3,6),...t.slice(6,9),...t.slice(9,12)];const o=e.transformAsVector(i.slice(0,3)),a=e.transformAsVector(i.slice(3,6)),s=e.transformAsVector(i.slice(6,9)),u=new is([o[0],o[1],o[2],a[0],a[1],a[2],s[0],s[1],s[2]]);return Gse(n)?(n.center=r,n.halfAxes=u,n):new d2(r,u)}function cX(t,e,n){const r=new _t(t[0],t[1],t[2]);e.transform(r,r);const i=e.getScale(mP),o=Math.max(Math.max(i[0],i[1]),i[2]),a=t[3]*o;return Gse(n)?(n.center=r,n.radius=a,n):new h2(r,a)}function bHe(t){const e=jse(),{halfAxes:n}=t,r=new _t(n.getColumn(0)),i=new _t(n.getColumn(1)),o=new _t(n.getColumn(2));for(let a=0;a<2;a++){for(let s=0;s<2;s++){for(let u=0;u<2;u++)vl.copy(t.center),vl.add(r),vl.add(i),vl.add(o),Vse(e,vl),o.negate();i.negate()}r.negate()}return e}function wHe(t){const e=jse(),{center:n,radius:r}=t,i=ss.WGS84.scaleToGeodeticSurface(n,vl);let o;i?o=ss.WGS84.geodeticSurfaceNormal(i):o=new _t(0,0,1);let a=new _t(o[2],-o[1],0);a.len()>0?a.normalize():a=new _t(0,1,0);const s=a.clone().cross(o);for(const u of[a,s,o]){mP.copy(u).scale(r);for(let d=0;d<2;d++)vl.copy(n),vl.add(mP),Vse(e,vl),mP.negate()}return e}function jse(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function Vse(t,e){ss.WGS84.cartesianToCartographic(e,vl),t[0][0]=Math.min(t[0][0],vl[0]),t[0][1]=Math.min(t[0][1],vl[1]),t[0][2]=Math.min(t[0][2],vl[2]),t[1][0]=Math.max(t[1][0],vl[0]),t[1][1]=Math.max(t[1][1],vl[1]),t[1][2]=Math.max(t[1][2],vl[2])}new _t;new _t;new vr;new _t;new _t;new _t;function EHe(t,e){const n=t*e;return 1-Math.exp(-(n*n))}function SHe(t,e){if(t.dynamicScreenSpaceError&&t.dynamicScreenSpaceErrorComputedDensity){const n=t.dynamicScreenSpaceErrorComputedDensity,r=t.dynamicScreenSpaceErrorFactor;return EHe(e,n)*r}return 0}function THe(t,e,n){const r=t.tileset,i=t.parent&&t.parent.lodMetricValue||t.lodMetricValue,o=n?i:t.lodMetricValue;if(o===0)return 0;const a=Math.max(t._distanceToCamera,1e-7),{height:s,sseDenominator:u}=e,{viewDistanceScale:d}=r.options;let g=o*s*(d||1)/(a*u);return g-=SHe(r,a),g}const HB=new _t,fX=new _t,mm=new _t,hX=new _t,CHe=new _t,WB=new vr,dX=new vr;function PHe(t,e){if(t.lodMetricValue===0||isNaN(t.lodMetricValue))return"DIG";const n=2*$se(t,e);return n<2?"OUT":!t.header.children||n<=t.lodMetricValue?"DRAW":t.header.children?"DIG":"OUT"}function $se(t,e){const{topDownViewport:n}=e,r=t.header.mbs[1],i=t.header.mbs[0],o=t.header.mbs[2],a=t.header.mbs[3],s=[...t.boundingVolume.center],u=n.unprojectPosition(n.cameraPosition);ss.WGS84.cartographicToCartesian(u,HB),fX.copy(HB).subtract(s).normalize(),ss.WGS84.eastNorthUpToFixedFrame(s,WB),dX.copy(WB).invert(),mm.copy(HB).transform(dX);const d=Math.sqrt(mm[0]*mm[0]+mm[1]*mm[1]),g=d*d/mm[2];hX.copy([mm[0],mm[1],g]);const E=hX.transform(WB).subtract(s).normalize(),O=fX.cross(E).normalize().scale(a).add(s),D=ss.WGS84.cartesianToCartographic(O),V=n.project([i,r,o]),k=n.project(D);return CHe.copy(V).subtract(k).magnitude()}function IHe(t){return{assetGltfUpAxis:t.asset&&t.asset.gltfUpAxis||"Y"}}class pX{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;q(this,"_map",new Map),q(this,"_array",void 0),q(this,"_length",void 0),this._array=new Array(e),this._length=e}get length(){return this._length}set length(e){this._length=e,e>this._array.length&&(this._array.length=e)}get values(){return this._array}get(e){return co(e<this._array.length),this._array[e]}set(e,n){co(e>=0),e>=this.length&&(this.length=e+1),this._map.has(this._array[e])&&this._map.delete(this._array[e]),this._array[e]=n,this._map.set(n,e)}delete(e){const n=this._map.get(e);n>=0&&(this._array.splice(n,1),this._map.delete(e),this.length--)}peek(){return this._array[this._length-1]}push(e){if(!this._map.has(e)){const n=this.length++;this._array[n]=e,this._map.set(e,n)}}pop(){const e=this._array[--this.length];return this._map.delete(e),e}reserve(e){co(e>=0),e>this._array.length&&(this._array.length=e)}resize(e){co(e>=0),this.length=e}trim(e){e==null&&(e=this.length),this._array.length=e}reset(){this._array=[],this._map=new Map,this._length=0}find(e){return this._map.has(e)}}const MHe={loadSiblings:!1,skipLevelOfDetail:!1,maximumScreenSpaceError:2,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class yL{traversalFinished(e){return!0}constructor(e){q(this,"options",void 0),q(this,"root",null),q(this,"selectedTiles",{}),q(this,"requestedTiles",{}),q(this,"emptyTiles",{}),q(this,"lastUpdate",new Date().getTime()),q(this,"updateDebounceTime",1e3),q(this,"_traversalStack",new pX),q(this,"_emptyTraversalStack",new pX),q(this,"_frameNumber",null),this.options={...MHe,...e}}traverse(e,n,r){this.root=e,this.options={...this.options,...r},this.reset(),this.updateTile(e,n),this._frameNumber=n.frameNumber,this.executeTraversal(e,n)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(e,n){const r=this._traversalStack;for(e._selectionDepth=1,r.push(e);r.length>0;){const o=r.pop();let a=!1;this.canTraverse(o,n)&&(this.updateChildTiles(o,n),a=this.updateAndPushChildren(o,n,r,o.hasRenderContent?o._selectionDepth+1:o._selectionDepth));const s=o.parent,u=!!(!s||s._shouldRefine),d=!a;o.hasRenderContent?o.refine===tg.ADD?(this.loadTile(o,n),this.selectTile(o,n)):o.refine===tg.REPLACE&&(this.loadTile(o,n),d&&this.selectTile(o,n)):(this.emptyTiles[o.id]=o,this.loadTile(o,n),d&&this.selectTile(o,n)),this.touchTile(o,n),o._shouldRefine=a&&u}const i=new Date().getTime();(this.traversalFinished(n)||i-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=i,this.options.onTraversalEnd(n))}updateChildTiles(e,n){const r=e.children;for(const i of r)this.updateTile(i,n)}updateAndPushChildren(e,n,r,i){const{loadSiblings:o,skipLevelOfDetail:a}=this.options,s=e.children;s.sort(this.compareDistanceToCamera.bind(this));const u=e.refine===tg.REPLACE&&e.hasRenderContent&&!a;let d=!1,g=!0;for(const _ of s)if(_._selectionDepth=i,_.isVisibleAndInRequestVolume?(r.find(_)&&r.delete(_),r.push(_),d=!0):(u||o)&&(this.loadTile(_,n),this.touchTile(_,n)),u){let E;if(_._inRequestVolume?_.hasRenderContent?E=_.contentAvailable:E=this.executeEmptyTraversal(_,n):E=!1,g=g&&E,!g)return!1}return d||(g=!1),g}updateTile(e,n){this.updateTileVisibility(e,n)}selectTile(e,n){this.shouldSelectTile(e)&&(e._selectedFrame=n.frameNumber,this.selectedTiles[e.id]=e)}loadTile(e,n){this.shouldLoadTile(e)&&(e._requestedFrame=n.frameNumber,e._priority=e._getPriority(),this.requestedTiles[e.id]=e)}touchTile(e,n){e.tileset._cache.touch(e),e._touchedFrame=n.frameNumber}canTraverse(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.hasChildren?e.hasTilesetContent?!e.contentExpired:!i&&!e.isVisibleAndInRequestVolume?!1:this.shouldRefine(e,n,r):!1}shouldLoadTile(e){return e.hasUnloadedContent||e.contentExpired}shouldSelectTile(e){return e.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=e._screenSpaceError;return r&&(i=e.getScreenSpaceError(n,!0)),i>this.options.maximumScreenSpaceError}updateTileVisibility(e,n){const r=[];if(this.options.viewportTraversersMap)for(const i in this.options.viewportTraversersMap)this.options.viewportTraversersMap[i]===n.viewport.id&&r.push(i);else r.push(n.viewport.id);e.updateVisibility(n,r)}compareDistanceToCamera(e,n){return e._distanceToCamera-n._distanceToCamera}anyChildrenVisible(e,n){let r=!1;for(const i of e.children)i.updateVisibility(n),r=r||i.isVisibleAndInRequestVolume;return r}executeEmptyTraversal(e,n){let r=!0;const i=this._emptyTraversalStack;for(i.push(e);i.length>0&&r;){const o=i.pop();if(this.updateTile(o,n),o.isVisibleAndInRequestVolume||this.loadTile(o,n),this.touchTile(o,n),!o.hasRenderContent&&this.canTraverse(o,n,!1,!0)){const s=o.children;for(const u of s)i.find(u)&&i.delete(u),i.push(u)}else!o.contentAvailable&&!o.hasEmptyContent&&(r=!1)}return r}}const gX=new _t;function OHe(t){return t!=null}class z4{constructor(e,n,r){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"";q(this,"tileset",void 0),q(this,"header",void 0),q(this,"id",void 0),q(this,"url",void 0),q(this,"parent",void 0),q(this,"refine",void 0),q(this,"type",void 0),q(this,"contentUrl",void 0),q(this,"lodMetricType","geometricError"),q(this,"lodMetricValue",0),q(this,"boundingVolume",null),q(this,"content",null),q(this,"contentState",ic.UNLOADED),q(this,"gpuMemoryUsageInBytes",0),q(this,"children",[]),q(this,"depth",0),q(this,"viewportIds",[]),q(this,"transform",new vr),q(this,"extensions",null),q(this,"implicitTiling",null),q(this,"userData",{}),q(this,"computedTransform",void 0),q(this,"hasEmptyContent",!1),q(this,"hasTilesetContent",!1),q(this,"traverser",new yL({})),q(this,"_cacheNode",null),q(this,"_frameNumber",null),q(this,"_expireDate",null),q(this,"_expiredContent",null),q(this,"_boundingBox",void 0),q(this,"_distanceToCamera",0),q(this,"_screenSpaceError",0),q(this,"_visibilityPlaneMask",void 0),q(this,"_visible",void 0),q(this,"_contentBoundingVolume",void 0),q(this,"_viewerRequestVolume",void 0),q(this,"_initialTransform",new vr),q(this,"_priority",0),q(this,"_selectedFrame",0),q(this,"_requestedFrame",0),q(this,"_selectionDepth",0),q(this,"_touchedFrame",0),q(this,"_centerZDepth",0),q(this,"_shouldRefine",!1),q(this,"_stackLength",0),q(this,"_visitedFrame",0),q(this,"_inRequestVolume",!1),q(this,"_lodJudge",null),this.header=n,this.tileset=e,this.id=i||n.id,this.url=n.url,this.parent=r,this.refine=this._getRefine(n.refine),this.type=n.type,this.contentUrl=n.contentUrl,this._initializeLodMetric(n),this._initializeTransforms(n),this._initializeBoundingVolumes(n),this._initializeContent(n),this._initializeRenderingState(n),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===ic.READY||this.hasEmptyContent}get contentAvailable(){return!!(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===ic.UNLOADED}get contentExpired(){return this.contentState===ic.EXPIRED}get contentFailed(){return this.contentState===ic.FAILED}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=vHe(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(e,n){switch(this.tileset.type){case tf.I3S:return $se(this,e);case tf.TILES3D:return THe(this,e,n);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){const e=this.tileset._traverser,{skipLevelOfDetail:n}=e.options,r=this.refine===tg.ADD||n;if(r&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===ic.UNLOADED)return-1;const i=this.parent,a=i&&(!r||this._screenSpaceError===0||i.hasTilesetContent)?i._screenSpaceError:this._screenSpaceError,s=e.root?e.root._screenSpaceError:0;return Math.max(s-a,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=ic.LOADING;const n=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!n)return this.contentState=ic.UNLOADED,!1;try{const r=this.tileset.getTileUrl(this.contentUrl),i=this.tileset.loader,o={...this.tileset.loadOptions,[i.id]:{...this.tileset.loadOptions[i.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(i.id)}};return this.content=await ag(r,i,o),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=ic.READY,this._onContentLoaded(),!0}catch(r){throw this.contentState=ic.FAILED,r}finally{n.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=ic.UNLOADED,!0}updateVisibility(e,n){if(this._frameNumber===e.frameNumber)return;const r=this.parent,i=r?r._visibilityPlaneMask:cc.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const o=r?r.computedTransform:this.tileset.modelMatrix;this._updateTransform(o)}this._distanceToCamera=this.distanceToTile(e),this._screenSpaceError=this.getScreenSpaceError(e,!1),this._visibilityPlaneMask=this.visibility(e,i),this._visible=this._visibilityPlaneMask!==cc.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(e),this._frameNumber=e.frameNumber,this.viewportIds=n}visibility(e,n){const{cullingVolume:r}=e,{boundingVolume:i}=this;return r.computeVisibilityWithPlaneMask(i,n)}contentVisibility(){return!0}distanceToTile(e){const n=this.boundingVolume;return Math.sqrt(Math.max(n.distanceSquaredTo(e.camera.position),0))}cameraSpaceZDepth(e){let{camera:n}=e;const r=this.boundingVolume;return gX.subVectors(r.center,n.position),n.direction.dot(gX)}insideViewerRequestVolume(e){const n=this._viewerRequestVolume;return!n||n.distanceSquaredTo(e.camera.position)<=0}updateExpiration(){if(OHe(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const e=Date.now();Date.lessThan(this._expireDate,e)&&(this.contentState=ic.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(e){"lodMetricType"in e?this.lodMetricType=e.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in e?this.lodMetricValue=e.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(e){this.transform=e.transform?new vr(e.transform):new vr;const n=this.parent,r=this.tileset,i=n&&n.computedTransform?n.computedTransform.clone():r.modelMatrix.clone();this.computedTransform=new vr(i).multiplyRight(this.transform);const o=n&&n._initialTransform?n._initialTransform.clone():new vr;this._initialTransform=new vr(o).multiplyRight(this.transform)}_initializeBoundingVolumes(e){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(e)}_initializeContent(e){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=ic.UNLOADED,this.hasTilesetContent=!1,e.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(e){this.depth=e.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=cc.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(e){return e||this.parent&&this.parent.refine||tg.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(e){this.boundingVolume=$B(e.boundingVolume,this.computedTransform,this.boundingVolume);const n=e.content;n&&(n.boundingVolume&&(this._contentBoundingVolume=$B(n.boundingVolume,this.computedTransform,this._contentBoundingVolume)),e.viewerRequestVolume&&(this._viewerRequestVolume=$B(e.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:new vr).clone().multiplyRight(this.transform);n.equals(this.computedTransform)||(this.computedTransform=n,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(e){switch(e){case"i3s":return{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return IHe(this.tileset.tileset)}}}class RHe extends yL{compareDistanceToCamera(e,n){return n._distanceToCamera===0&&e._distanceToCamera===0?n._centerZDepth-e._centerZDepth:n._distanceToCamera-e._distanceToCamera}updateTileVisibility(e,n){if(super.updateTileVisibility(e,n),!e.isVisibleAndInRequestVolume)return;const r=e.children.length>0;if(e.hasTilesetContent&&r){const a=e.children[0];this.updateTileVisibility(a,n),e._visible=a._visible;return}if(this.meetsScreenSpaceErrorEarly(e,n)){e._visible=!1;return}const i=e.refine===tg.REPLACE,o=e._optimChildrenWithinParent===AHe.USE_OPTIMIZATION;if(i&&o&&r&&!this.anyChildrenVisible(e,n)){e._visible=!1;return}}meetsScreenSpaceErrorEarly(e,n){const{parent:r}=e;return!r||r.hasTilesetContent||r.refine!==tg.ADD?!1:!this.shouldRefine(e,n,!0)}}class LHe{constructor(){q(this,"frameNumberMap",new Map)}register(e,n){const r=this.frameNumberMap.get(e)||new Map,i=r.get(n)||0;r.set(n,i+1),this.frameNumberMap.set(e,r)}deregister(e,n){const r=this.frameNumberMap.get(e);if(!r)return;const i=r.get(n)||1;r.set(n,i-1)}isZero(e,n){var r;return(((r=this.frameNumberMap.get(e))===null||r===void 0?void 0:r.get(n))||0)===0}}const qB={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"};class DHe{constructor(){q(this,"_statusMap",void 0),q(this,"pendingTilesRegister",new LHe),this._statusMap={}}add(e,n,r,i){if(!this._statusMap[n]){const{frameNumber:o,viewport:{id:a}}=i;this._statusMap[n]={request:e,callback:r,key:n,frameState:i,status:qB.REQUESTED},this.pendingTilesRegister.register(a,o),e().then(s=>{this._statusMap[n].status=qB.COMPLETED;const{frameNumber:u,viewport:{id:d}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(d,u),this._statusMap[n].callback(s,i)}).catch(s=>{this._statusMap[n].status=qB.ERROR;const{frameNumber:u,viewport:{id:d}}=this._statusMap[n].frameState;this.pendingTilesRegister.deregister(d,u),r(s)})}}update(e,n){if(this._statusMap[e]){const{frameNumber:r,viewport:{id:i}}=this._statusMap[e].frameState;this.pendingTilesRegister.deregister(i,r);const{frameNumber:o,viewport:{id:a}}=n;this.pendingTilesRegister.register(a,o),this._statusMap[e].frameState=n}}find(e){return this._statusMap[e]}hasPendingTiles(e,n){return!this.pendingTilesRegister.isZero(e,n)}}class BHe extends yL{constructor(e){super(e),q(this,"_tileManager",void 0),this._tileManager=new DHe}traversalFinished(e){return!this._tileManager.hasPendingTiles(e.viewport.id,this._frameNumber||0)}shouldRefine(e,n){return e._lodJudge=PHe(e,n),e._lodJudge==="DIG"}updateChildTiles(e,n){const r=e.header.children||[],i=e.children,o=e.tileset;for(const a of r){const s="".concat(a.id,"-").concat(n.viewport.id),u=i&&i.find(d=>d.id===s);if(u)u&&this.updateTile(u,n);else{let d=()=>this._loadTile(a.id,o);this._tileManager.find(s)?this._tileManager.update(s,n):(o.tileset.nodePages&&(d=()=>o.tileset.nodePagesTile.formTileFromNodePages(a.id)),this._tileManager.add(d,s,_=>this._onTileLoad(_,e,s),n))}}return!1}async _loadTile(e,n){const{loader:r}=n,i=n.getTileUrl("".concat(n.url,"/nodes/").concat(e)),o={...n.loadOptions,i3s:{...n.loadOptions.i3s,isTileHeader:!0}};return await ag(i,r,o)}_onTileLoad(e,n,r){const i=new z4(n.tileset,e,n,r);n.children.push(i);const o=this._tileManager.find(i.id).frameState;this.updateTile(i,o),this._frameNumber===o.frameNumber&&(this.traversalFinished(o)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(i,o)}}const NHe={description:"",ellipsoid:ss.WGS84,modelMatrix:new vr,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:t=>t,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},_T="Tiles In Tileset(s)",XB="Tiles In Memory",mX="Tiles In View",AX="Tiles To Render",_X="Tiles Loaded",ZB="Tiles Loading",yX="Tiles Unloaded",vX="Failed Tile Loads",xX="Points/Vertices",YB="Tile Memory Use";class FHe{constructor(e,n){q(this,"options",void 0),q(this,"loadOptions",void 0),q(this,"type",void 0),q(this,"tileset",void 0),q(this,"loader",void 0),q(this,"url",void 0),q(this,"basePath",void 0),q(this,"modelMatrix",void 0),q(this,"ellipsoid",void 0),q(this,"lodMetricType",void 0),q(this,"lodMetricValue",void 0),q(this,"refine",void 0),q(this,"root",null),q(this,"roots",{}),q(this,"asset",{}),q(this,"description",""),q(this,"properties",void 0),q(this,"extras",null),q(this,"attributions",{}),q(this,"credits",{}),q(this,"stats",void 0),q(this,"contentFormats",{draco:!1,meshopt:!1,dds:!1,ktx2:!1}),q(this,"cartographicCenter",null),q(this,"cartesianCenter",null),q(this,"zoom",1),q(this,"boundingVolume",null),q(this,"dynamicScreenSpaceErrorComputedDensity",0),q(this,"maximumMemoryUsage",32),q(this,"gpuMemoryUsageInBytes",0),q(this,"_frameNumber",0),q(this,"_queryParams",{}),q(this,"_extensionsUsed",[]),q(this,"_tiles",{}),q(this,"_pendingCount",0),q(this,"selectedTiles",[]),q(this,"traverseCounter",0),q(this,"geometricError",0),q(this,"lastUpdatedVieports",null),q(this,"_requestedTiles",[]),q(this,"_emptyTiles",[]),q(this,"frameStateData",{}),q(this,"_traverser",void 0),q(this,"_cache",new aHe),q(this,"_requestScheduler",void 0),q(this,"updatePromise",null),q(this,"tilesetInitializationPromise",void 0),this.options={...NHe,...n},this.tileset=e,this.loader=e.loader,this.type=e.type,this.url=e.url,this.basePath=e.basePath||o5(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=e.lodMetricType,this.lodMetricValue=e.lodMetricValue,this.refine=e.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new Ree({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.stats=new iHe({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(e)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(e){this.options={...this.options,...e}}setOptions(e){this.options={...this.options,...e}}getTileUrl(e){return e.startsWith("data:")?e:"".concat(e).concat(e.includes("?")?"&":"?").concat(this.queryParams)}hasExtension(e){return this._extensionsUsed.indexOf(e)>-1}update(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.tilesetInitializationPromise.then(()=>{!e&&this.lastUpdatedVieports?e=this.lastUpdatedVieports:this.lastUpdatedVieports=e,e&&this.doUpdate(e)})}async selectTiles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return await this.tilesetInitializationPromise,e&&(this.lastUpdatedVieports=e),this.updatePromise||(this.updatePromise=new Promise(n=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),n(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}doUpdate(e){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;const n=e instanceof Array?e:[e];this._cache.reset(),this._frameNumber++,this.traverseCounter=n.length;const r=[];for(const i of n){const o=i.id;this._needTraverse(o)?r.push(o):this.traverseCounter--}for(const i of n){const o=i.id;if(this.roots[o]||(this.roots[o]=this._initializeTileHeaders(this.tileset,null)),!r.includes(o))continue;const a=uHe(i,this._frameNumber);this._traverser.traverse(this.roots[o],a,this.options)}}_needTraverse(e){let n=e;return this.options.viewportTraversersMap&&(n=this.options.viewportTraversersMap[e]),n===e}_onTraversalEnd(e){const n=e.viewport.id;this.frameStateData[n]||(this.frameStateData[n]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const r=this.frameStateData[n],i=Object.values(this._traverser.selectedTiles),[o,a]=cHe(i,e,this.options.maximumTilesSelected);r.selectedTiles=o;for(const s of a)s.unselect();r._requestedTiles=Object.values(this._traverser.requestedTiles),r._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const e in this.frameStateData){const n=this.frameStateData[e];this.selectedTiles=this.selectedTiles.concat(n.selectedTiles),this._requestedTiles=this._requestedTiles.concat(n._requestedTiles),this._emptyTiles=this._emptyTiles.concat(n._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const e of this.selectedTiles)this._tiles[e.id]=e;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(e,n){if(e.length!==n.length)return!0;const r=new Set(e.map(a=>a.id)),i=new Set(n.map(a=>a.id));let o=e.filter(a=>!i.has(a.id)).length>0;return o=o||n.filter(a=>!r.has(a.id)).length>0,o}_loadTiles(){for(const e of this._requestedTiles)e.contentUnloaded&&this._loadTile(e)}_unloadTiles(){this._cache.unloadTiles(this,(e,n)=>e._unloadTile(n))}_updateStats(){let e=0,n=0;for(const r of this.selectedTiles)r.contentAvailable&&r.content&&(e++,r.content.pointCount?n+=r.content.pointCount:n+=r.content.vertexCount);this.stats.get(mX).count=this.selectedTiles.length,this.stats.get(AX).count=e,this.stats.get(xX).count=n}async _initializeTileSet(e){this.type===tf.I3S&&(this.calculateViewPropsI3S(),e.root=await e.root),this.root=this._initializeTileHeaders(e,null),this.type===tf.TILES3D&&(this._initializeTiles3DTileset(e),this.calculateViewPropsTiles3D()),this.type===tf.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){var e;const n=this.tileset.fullExtent;if(n){const{xmin:i,xmax:o,ymin:a,ymax:s,zmin:u,zmax:d}=n;this.cartographicCenter=new _t(i+(o-i)/2,a+(s-a)/2,u+(d-u)/2),this.cartesianCenter=ss.WGS84.cartographicToCartesian(this.cartographicCenter,new _t),this.zoom=Use(n,this.cartographicCenter,this.cartesianCenter);return}const r=(e=this.tileset.store)===null||e===void 0?void 0:e.extent;if(r){const[i,o,a,s]=r;this.cartographicCenter=new _t(i+(a-i)/2,o+(s-o)/2,0),this.cartesianCenter=ss.WGS84.cartographicToCartesian(this.cartographicCenter,new _t),this.zoom=gHe(r,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new _t,this.zoom=1}calculateViewPropsTiles3D(){const e=this.root,{center:n}=e.boundingVolume;if(!n){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new _t,this.zoom=1;return}n[0]!==0||n[1]!==0||n[2]!==0?this.cartographicCenter=ss.WGS84.cartesianToCartographic(n,new _t):this.cartographicCenter=new _t(0,0,-ss.WGS84.radii[0]),this.cartesianCenter=n,this.zoom=pHe(e.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(_T),this.stats.get(ZB),this.stats.get(XB),this.stats.get(mX),this.stats.get(AX),this.stats.get(_X),this.stats.get(yX),this.stats.get(vX),this.stats.get(xX),this.stats.get(YB,"memory")}_initializeTileHeaders(e,n){const r=new z4(this,e.root,n);if(n&&(n.children.push(r),r.depth=n.depth+1),this.type===tf.TILES3D){const o=[];for(o.push(r);o.length>0;){const a=o.pop();this.stats.get(_T).incrementCount();const s=a.header.children||[];for(const u of s){var i;const d=new z4(this,u,a);if((i=d.contentUrl)!==null&&i!==void 0&&i.includes("?session=")){const _=new URL(d.contentUrl).searchParams.get("session");_&&(this._queryParams.session=_)}a.children.push(d),d.depth=a.depth+1,o.push(d)}}}return r}_initializeTraverser(){let e;switch(this.type){case tf.TILES3D:e=RHe;break;case tf.I3S:e=BHe;break;default:e=yL}return new e({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(e){this._destroySubtree(e)}async _loadTile(e){let n;try{this._onStartTileLoading(),n=await e.loadContent()}catch(r){this._onTileLoadError(e,r instanceof Error?r:new Error("load failed"))}finally{this._onEndTileLoading(),this._onTileLoad(e,n)}}_onTileLoadError(e,n){this.stats.get(vX).incrementCount();const r=n.message||n.toString(),i=e.url;console.error("A 3D tile failed to load: ".concat(e.url," ").concat(r)),this.options.onTileError(e,r,i)}_onTileLoad(e,n){if(n){if(this.type===tf.I3S){var r,i;const o=((r=this.tileset)===null||r===void 0||(i=r.nodePagesTile)===null||i===void 0?void 0:i.nodesInNodePages)||0;this.stats.get(_T).reset(),this.stats.get(_T).addCount(o)}e&&e.content&&lHe(e,e.content),this.updateContentTypes(e),this._addTileToCache(e),this.options.onTileLoad(e)}}updateContentTypes(e){if(this.type===tf.I3S)switch(e.header.isDracoGeometry&&(this.contentFormats.draco=!0),e.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0;break}else if(this.type===tf.TILES3D){var n;const{extensionsRemoved:r=[]}=((n=e.content)===null||n===void 0?void 0:n.gltf)||{};r.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),r.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),r.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(ZB).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(ZB).decrementCount()}_addTileToCache(e){this._cache.add(this,e,n=>n._updateCacheStats(e))}_updateCacheStats(e){this.stats.get(_X).incrementCount(),this.stats.get(XB).incrementCount(),this.gpuMemoryUsageInBytes+=e.gpuMemoryUsageInBytes||0,this.stats.get(YB).count=this.gpuMemoryUsageInBytes}_unloadTile(e){this.gpuMemoryUsageInBytes-=e.gpuMemoryUsageInBytes||0,this.stats.get(XB).decrementCount(),this.stats.get(yX).incrementCount(),this.stats.get(YB).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(e),e.unloadContent()}_destroy(){const e=[];for(this.root&&e.push(this.root);e.length>0;){const n=e.pop();for(const r of n.children)e.push(r);this._destroyTile(n)}this.root=null}_destroySubtree(e){const n=e,r=[];for(r.push(n);r.length>0;){e=r.pop();for(const i of e.children)r.push(i);e!==n&&this._destroyTile(e)}n.children=[]}_destroyTile(e){this._cache.unloadTile(this,e),this._unloadTile(e),e.destroy()}_initializeTiles3DTileset(e){if(e.queryString){const n=new URLSearchParams(e.queryString),r=Object.fromEntries(n.entries());this._queryParams={...this._queryParams,...r}}if(this.asset=e.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0")throw new Error("The tileset must be 3D Tiles version 0.0 or 1.0.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=e.properties,this.geometricError=e.geometricError,this._extensionsUsed=e.extensionsUsed||[],this.extras=e.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}const Hse="3.4.14",Ob={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};function Wse(t,e,n){co(t instanceof ArrayBuffer);const r=new TextDecoder("utf8"),i=new Uint8Array(t,e,n);return r.decode(i)}function kHe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=new DataView(t);return"".concat(String.fromCharCode(n.getUint8(e+0))).concat(String.fromCharCode(n.getUint8(e+1))).concat(String.fromCharCode(n.getUint8(e+2))).concat(String.fromCharCode(n.getUint8(e+3)))}const zHe={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},Us={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},_i={...zHe,...Us},QB={[Us.DOUBLE]:Float64Array,[Us.FLOAT]:Float32Array,[Us.UNSIGNED_SHORT]:Uint16Array,[Us.UNSIGNED_INT]:Uint32Array,[Us.UNSIGNED_BYTE]:Uint8Array,[Us.BYTE]:Int8Array,[Us.SHORT]:Int16Array,[Us.INT]:Int32Array},UHe={DOUBLE:Us.DOUBLE,FLOAT:Us.FLOAT,UNSIGNED_SHORT:Us.UNSIGNED_SHORT,UNSIGNED_INT:Us.UNSIGNED_INT,UNSIGNED_BYTE:Us.UNSIGNED_BYTE,BYTE:Us.BYTE,SHORT:Us.SHORT,INT:Us.INT},KB="Failed to convert GL type";class Dd{static fromTypedArray(e){e=ArrayBuffer.isView(e)?e.constructor:e;for(const n in QB)if(QB[n]===e)return n;throw new Error(KB)}static fromName(e){const n=UHe[e];if(!n)throw new Error(KB);return n}static getArrayType(e){switch(e){case Us.UNSIGNED_SHORT_5_6_5:case Us.UNSIGNED_SHORT_4_4_4_4:case Us.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const n=QB[e];if(!n)throw new Error(KB);return n}}static getByteSize(e){return Dd.getArrayType(e).BYTES_PER_ELEMENT}static validate(e){return!!Dd.getArrayType(e)}static createTypedArray(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;i===void 0&&(i=(n.byteLength-r)/Dd.getByteSize(e));const o=Dd.getArrayType(e);return new o(n,r,i)}}function GHe(t,e){if(!t)throw new Error("math.gl assertion failed. ".concat(e))}function jHe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const n=t>>11&31,r=t>>5&63,i=t&31;return e[0]=n<<3,e[1]=r<<2,e[2]=i<<3,e}new jO;new _t;new jO;new jO;function bX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:255;return Wi(t,0,e)/e*2-1}function wX(t){return t<0?-1:1}function VHe(t,e,n,r){if(GHe(r),t<0||t>n||e<0||e>n)throw new Error("x and y must be unsigned normalized integers between 0 and ".concat(n));if(r.x=bX(t,n),r.y=bX(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){const i=r.x;r.x=(1-Math.abs(r.y))*wX(i),r.y=(1-Math.abs(i))*wX(r.y)}return r.normalize()}function $He(t,e,n){return VHe(t,e,255,n)}class CU{constructor(e,n){q(this,"json",void 0),q(this,"buffer",void 0),q(this,"featuresLength",0),q(this,"_cachedTypedArrays",{}),this.json=e,this.buffer=n}getExtension(e){return this.json.extensions&&this.json.extensions[e]}hasProperty(e){return!!this.json[e]}getGlobalProperty(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_i.UNSIGNED_INT,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(e,n,r,1,i.byteOffset):i}getPropertyArray(e,n,r){const i=this.json[e];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(n=Dd.fromName(i.componentType)),this._getTypedArrayFromBinary(e,n,r,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(e,n,i)}getProperty(e,n,r,i,o){const a=this.json[e];if(!a)return a;const s=this.getPropertyArray(e,n,r);if(r===1)return s[i];for(let u=0;u<r;++u)o[u]=s[r*i+u];return o}_getTypedArrayFromBinary(e,n,r,i,o){const a=this._cachedTypedArrays;let s=a[e];return s||(s=Dd.createTypedArray(n,this.buffer.buffer,this.buffer.byteOffset+o,i*r),a[e]=s),s}_getTypedArrayFromArray(e,n,r){const i=this._cachedTypedArrays;let o=i[e];return o||(o=Dd.createTypedArray(n,r),i[e]=o),o}}const HHe={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},WHe={SCALAR:(t,e)=>t[e],VEC2:(t,e)=>[t[2*e+0],t[2*e+1]],VEC3:(t,e)=>[t[3*e+0],t[3*e+1],t[3*e+2]],VEC4:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT2:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT3:(t,e)=>[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]],MAT4:(t,e)=>[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]},qHe={SCALAR:(t,e,n)=>{e[n]=t},VEC2:(t,e,n)=>{e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:(t,e,n)=>{e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:(t,e,n)=>{e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:(t,e,n)=>{e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}};function XHe(t,e,n,r){const{componentType:i}=t;co(t.componentType);const o=typeof i=="string"?Dd.fromName(i):i,a=HHe[t.type],s=WHe[t.type],u=qHe[t.type];return n+=t.byteOffset,{values:Dd.createTypedArray(o,e,n,a*r),type:o,size:a,unpacker:s,packer:u}}const Md=t=>t!==void 0;function ZHe(t,e,n){if(!e)return null;let r=t.getExtension("3DTILES_batch_table_hierarchy");const i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?YHe(r,n):null}function YHe(t,e){let n,r,i;const o=t.instancesLength,a=t.classes;let s=t.classIds,u=t.parentCounts,d=t.parentIds,g=o;Md(s.byteOffset)&&(s.componentType=defaultValue(s.componentType,GL.UNSIGNED_SHORT),s.type=AttributeType.SCALAR,i=getBinaryAccessor(s),s=i.createArrayBufferView(e.buffer,e.byteOffset+s.byteOffset,o));let _;if(Md(u))for(Md(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),u=i.createArrayBufferView(e.buffer,e.byteOffset+u.byteOffset,o)),_=new Uint16Array(o),g=0,n=0;n<o;++n)_[n]=g,g+=u[n];Md(d)&&Md(d.byteOffset)&&(d.componentType=defaultValue(d.componentType,GL.UNSIGNED_SHORT),d.type=AttributeType.SCALAR,i=getBinaryAccessor(d),d=i.createArrayBufferView(e.buffer,e.byteOffset+d.byteOffset,g));const E=a.length;for(n=0;n<E;++n){const V=a[n].length,k=a[n].instances,F=getBinaryProperties(V,k,e);a[n].instances=combine(F,k)}const P=new Array(E).fill(0),O=new Uint16Array(o);for(n=0;n<o;++n)r=s[n],O[n]=P[r],++P[r];const D={classes:a,classIds:s,classIndexes:O,parentCounts:u,parentIndexes:_,parentIds:d};return JHe(D),D}function Rb(t,e,n){if(!t)return;const r=t.parentCounts;return t.parentIds?n(t,e):r>0?QHe(t,e,n):KHe(t,e,n)}function QHe(t,e,n){const r=t.classIds,i=t.parentCounts,o=t.parentIds,a=t.parentIndexes,s=r.length,u=scratchVisited;u.length=Math.max(u.length,s);const d=++marker,g=scratchStack;for(g.length=0,g.push(e);g.length>0;){if(e=g.pop(),u[e]===d)continue;u[e]=d;const _=n(t,e);if(Md(_))return _;const E=i[e],P=a[e];for(let O=0;O<E;++O){const D=o[P+O];D!==e&&g.push(D)}}return null}function KHe(t,e,n){let r=!0;for(;r;){const i=n(t,e);if(Md(i))return i;const o=t.parentIds[e];r=o!==e,e=o}throw new Error("traverseHierarchySingleParent")}function JHe(t){const n=t.classIds.length;for(let r=0;r<n;++r)qse(t,r,stack)}function qse(t,e,n){const r=t.parentCounts,i=t.parentIds,o=t.parentIndexes,s=t.classIds.length;if(!Md(i))return;assert(e<s,"Parent index ".concat(e," exceeds the total number of instances: ").concat(s)),assert(n.indexOf(e)===-1,"Circular dependency detected in the batch table hierarchy."),n.push(e);const u=Md(r)?r[e]:1,d=Md(r)?o[e]:e;for(let g=0;g<u;++g){const _=i[d+g];_!==e&&qse(t,_,n)}n.pop(e)}function vu(t){return t!=null}const yT=(t,e)=>t,e7e={HIERARCHY:!0,extensions:!0,extras:!0};class Xse{constructor(e,n,r){var i;let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};q(this,"json",void 0),q(this,"binary",void 0),q(this,"featureCount",void 0),q(this,"_extensions",void 0),q(this,"_properties",void 0),q(this,"_binaryProperties",void 0),q(this,"_hierarchy",void 0),co(r>=0),this.json=e||{},this.binary=n,this.featureCount=r,this._extensions=((i=this.json)===null||i===void 0?void 0:i.extensions)||{},this._properties={};for(const a in this.json)e7e[a]||(this._properties[a]=this.json[a]);this._binaryProperties=this._initializeBinaryProperties(),o["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=ZHe(this,this.json,this.binary))}getExtension(e){return this.json&&this.json.extensions&&this.json.extensions[e]}memorySizeInBytes(){return 0}isClass(e,n){if(this._checkBatchId(e),co(typeof n=="string",n),this._hierarchy){const r=Rb(this._hierarchy,e,(i,o)=>{const a=i.classIds[o];return i.classes[a].name===n});return vu(r)}return!1}isExactClass(e,n){return co(typeof n=="string",n),this.getExactClassName(e)===n}getExactClassName(e){if(this._checkBatchId(e),this._hierarchy){const n=this._hierarchy.classIds[e];return this._hierarchy.classes[n].name}}hasProperty(e,n){return this._checkBatchId(e),co(typeof n=="string",n),vu(this._properties[n])||this._hasPropertyInHierarchy(e,n)}getPropertyNames(e,n){this._checkBatchId(e),n=vu(n)?n:[],n.length=0;const r=Object.keys(this._properties);return n.push(...r),this._hierarchy&&this._getPropertyNamesInHierarchy(e,n),n}getProperty(e,n){if(this._checkBatchId(e),co(typeof n=="string",n),this._binaryProperties){const i=this._binaryProperties[n];if(vu(i))return this._getBinaryProperty(i,e)}const r=this._properties[n];if(vu(r))return yT(r[e]);if(this._hierarchy){const i=this._getHierarchyProperty(e,n);if(vu(i))return i}}setProperty(e,n,r){const i=this.featureCount;if(this._checkBatchId(e),co(typeof n=="string",n),this._binaryProperties){const a=this._binaryProperties[n];if(a){this._setBinaryProperty(a,e,r);return}}if(this._hierarchy&&this._setHierarchyProperty(this,e,n,r))return;let o=this._properties[n];vu(o)||(this._properties[n]=new Array(i),o=this._properties[n]),o[e]=yT(r)}_checkBatchId(e){if(!(e>=0&&e<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(e,n){return e.unpack(e.typedArray,n)}_setBinaryProperty(e,n,r){e.pack(r,e.typedArray,n)}_initializeBinaryProperties(){let e=null;for(const n in this._properties){const r=this._properties[n],i=this._initializeBinaryProperty(n,r);i&&(e=e||{},e[n]=i)}return e}_initializeBinaryProperty(e,n){if("byteOffset"in n){const r=n;co(this.binary,"Property ".concat(e," requires a batch table binary.")),co(r.type,"Property ".concat(e," requires a type."));const i=XHe(r,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(e,n){if(!this._hierarchy)return!1;const r=Rb(this._hierarchy,e,(i,o)=>{const a=i.classIds[o],s=i.classes[a].instances;return vu(s[n])});return vu(r)}_getPropertyNamesInHierarchy(e,n){Rb(this._hierarchy,e,(r,i)=>{const o=r.classIds[i],a=r.classes[o].instances;for(const s in a)a.hasOwnProperty(s)&&n.indexOf(s)===-1&&n.push(s)})}_getHierarchyProperty(e,n){return Rb(this._hierarchy,e,(r,i)=>{const o=r.classIds[i],a=r.classes[o],s=r.classIndexes[i],u=a.instances[n];return vu(u)?vu(u.typedArray)?this._getBinaryProperty(u,s):yT(u[s]):null})}_setHierarchyProperty(e,n,r,i){const o=Rb(this._hierarchy,n,(a,s)=>{const u=a.classIds[s],d=a.classes[u],g=a.classIndexes[s],_=d.instances[r];return vu(_)?(co(s===n,'Inherited property "'.concat(r,'" is read-only.')),vu(_.typedArray)?this._setBinaryProperty(_,g,i):_[g]=yT(i),!0):!1});return vu(o)}}const JB=4;function vL(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=JB,t.version=r.getUint32(n,!0),n+=JB,t.byteLength=r.getUint32(n,!0),n+=JB,t.version!==1)throw new Error("3D Tile Version ".concat(t.version," not supported"));return n}const Oy=4,EX="b3dm tile in legacy format.";function PU(t,e,n){const r=new DataView(e);let i;t.header=t.header||{};let o=r.getUint32(n,!0);n+=Oy;let a=r.getUint32(n,!0);n+=Oy;let s=r.getUint32(n,!0);n+=Oy;let u=r.getUint32(n,!0);return n+=Oy,s>=570425344?(n-=Oy*2,i=o,s=a,u=0,o=0,a=0,console.warn(EX)):u>=570425344&&(n-=Oy,i=s,s=o,u=a,o=0,a=0,console.warn(EX)),t.header.featureTableJsonByteLength=o,t.header.featureTableBinaryByteLength=a,t.header.batchTableJsonByteLength=s,t.header.batchTableBinaryByteLength=u,t.header.batchLength=i,n}function IU(t,e,n,r){return n=t7e(t,e,n),n=n7e(t,e,n),n}function t7e(t,e,n,r){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:o,batchLength:a}=t.header;if(t.featureTableJson={BATCH_LENGTH:a||0},i>0){const s=Wse(e,n,i);t.featureTableJson=JSON.parse(s)}return n+=i,t.featureTableBinary=new Uint8Array(e,n,o),n+=o,n}function n7e(t,e,n,r){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:o}=t.header;if(i>0){const a=Wse(e,n,i);t.batchTableJson=JSON.parse(a),n+=i,o>0&&(t.batchTableBinary=new Uint8Array(e,n,o),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=o)}return n}function Zse(t,e,n){if(!e&&(!t||!t.batchIds||!n))return null;const{batchIds:r,isRGB565:i,pointCount:o}=t;if(r&&n){const a=new Uint8ClampedArray(o*3);for(let s=0;s<o;s++){const u=r[s],g=n.getProperty(u,"dimensions").map(_=>_*255);a[s*3]=g[0],a[s*3+1]=g[1],a[s*3+2]=g[2]}return{type:_i.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}if(i){const a=new Uint8ClampedArray(o*3);for(let s=0;s<o;s++){const u=jHe(e[s]);a[s*3]=u[0],a[s*3+1]=u[1],a[s*3+2]=u[2]}return{type:_i.UNSIGNED_BYTE,value:a,size:3,normalized:!0}}return e&&e.length===o*3?{type:_i.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:_i.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}const SX=new _t;function r7e(t,e){if(!e)return null;if(t.isOctEncoded16P){const n=new Float32Array(t.pointsLength*3);for(let r=0;r<t.pointsLength;r++)$He(e[r*2],e[r*2+1],SX),SX.toArray(n,r*3);return{type:_i.FLOAT,size:2,value:n}}return{type:_i.FLOAT,size:2,value:e}}function i7e(t,e,n){return t.isQuantized?n["3d-tiles"]&&n["3d-tiles"].decodeQuantizedPositions?(t.isQuantized=!1,o7e(t,e)):{type:_i.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}function o7e(t,e){const n=new _t,r=new Float32Array(t.pointCount*3);for(let i=0;i<t.pointCount;i++)n.set(e[i*3],e[i*3+1],e[i*3+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,i*3);return r}async function s7e(t,e,n,r,i){n=vL(t,e,n),n=PU(t,e,n),n=IU(t,e,n),a7e(t);const{featureTable:o,batchTable:a}=l7e(t);return await d7e(t,o,a,r,i),u7e(t,o,r),c7e(t,o,a),f7e(t,o),n}function a7e(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}function l7e(t){const e=new CU(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",_i.FLOAT,3);const r=h7e(t,e);return{featureTable:e,batchTable:r}}function u7e(t,e,n){if(!t.attributes.positions){if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",_i.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const r=e.getPropertyArray("POSITION_QUANTIZED",_i.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=65536-1,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",_i.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",_i.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=i7e(t,r,n)}}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function c7e(t,e,n){if(!t.attributes.colors){let r=null;e.hasProperty("RGBA")?(r=e.getPropertyArray("RGBA",_i.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?r=e.getPropertyArray("RGB",_i.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(r=e.getPropertyArray("RGB565",_i.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=Zse(t,r,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",_i.UNSIGNED_BYTE,4))}function f7e(t,e){if(!t.attributes.normals){let n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",_i.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",_i.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=r7e(t,n)}}function h7e(t,e){let n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",_i.UNSIGNED_SHORT,1),t.batchIds)){const r=e.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:o}=t;n=new Xse(i,o,r)}return n}async function d7e(t,e,n,r,i){let o,a,s;const u=t.batchTableJson&&t.batchTableJson.extensions&&t.batchTableJson.extensions["3DTILES_draco_point_compression"];u&&(s=u.properties);const d=e.getExtension("3DTILES_draco_point_compression");if(d){a=d.properties;const _=d.byteOffset,E=d.byteLength;if(!a||!Number.isFinite(_)||!E)throw new Error("Draco properties, byteOffset, and byteLength must be defined");o=t.featureTableBinary.slice(_,_+E),t.hasPositions=Number.isFinite(a.POSITION),t.hasColors=Number.isFinite(a.RGB)||Number.isFinite(a.RGBA),t.hasNormals=Number.isFinite(a.NORMAL),t.hasBatchIds=Number.isFinite(a.BATCH_ID),t.isTranslucent=Number.isFinite(a.RGBA)}if(!o)return!0;const g={buffer:o,properties:{...a,...s},featureTableProperties:a,batchTableProperties:s,dequantizeInShader:!1};return await p7e(t,g,r,i)}async function p7e(t,e,n,r){const{parse:i}=r,o={...n,draco:{...n.draco,extraAttributes:e.batchTableProperties||{}}};delete o["3d-tiles"];const a=await i(e.buffer,Lse,o),s=a.attributes.POSITION&&a.attributes.POSITION.value,u=a.attributes.COLOR_0&&a.attributes.COLOR_0.value,d=a.attributes.NORMAL&&a.attributes.NORMAL.value,g=a.attributes.BATCH_ID&&a.attributes.BATCH_ID.value,_=s&&a.attributes.POSITION.value.quantization,E=d&&a.attributes.NORMAL.value.quantization;if(_){const O=a.POSITION.data.quantization,D=O.range;t.quantizedVolumeScale=new _t(D,D,D),t.quantizedVolumeOffset=new _t(O.minValues),t.quantizedRange=(1<<O.quantizationBits)-1,t.isQuantizedDraco=!0}E&&(t.octEncodedRange=(1<<a.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0);const P={};if(e.batchTableProperties)for(const O of Object.keys(e.batchTableProperties))a.attributes[O]&&a.attributes[O].value&&(P[O.toLowerCase()]=a.attributes[O].value);t.attributes={positions:s,colors:Zse(t,u,void 0),normals:d,batchIds:g,...P}}const U4={URI:0,EMBEDDED:1};function Yse(t,e,n,r){t.rotateYtoZ=!0;const i=t.byteOffset+t.byteLength-n;if(i===0)throw new Error("glTF byte length must be greater than 0.");return t.gltfUpAxis=r["3d-tiles"]&&r["3d-tiles"].assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",t.gltfArrayBuffer=i5(e,n,i),t.gltfByteOffset=0,t.gltfByteLength=i,n%4===0||console.warn("".concat(t.type,": embedded glb is not aligned to a 4-byte boundary.")),t.byteOffset+t.byteLength}async function Qse(t,e,n,r){const i=n["3d-tiles"]||{};if(g7e(t,e),i.loadGLTF){const{parse:o,fetch:a}=r;t.gltfUrl&&(t.gltfArrayBuffer=await a(t.gltfUrl,n),t.gltfByteOffset=0),t.gltfArrayBuffer&&(t.gltf=await o(t.gltfArrayBuffer,_E,n,r),t.gpuMemoryUsageInBytes=Ose(t.gltf),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength)}}function g7e(t,e,n){switch(e){case U4.URI:const r=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),o=new TextDecoder().decode(r);t.gltfUrl=o.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case U4.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function m7e(t,e,n,r,i){var o;n=A7e(t,e,n,r),await Qse(t,U4.EMBEDDED,r,i);const a=t==null||(o=t.gltf)===null||o===void 0?void 0:o.extensions;return a&&a.CESIUM_RTC&&(t.rtcCenter=a.CESIUM_RTC.center),n}function A7e(t,e,n,r,i){n=vL(t,e,n),n=PU(t,e,n),n=IU(t,e,n),n=Yse(t,e,n,r);const o=new CU(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=o.getGlobalProperty("RTC_CENTER",_i.FLOAT,3),n}async function _7e(t,e,n,r,i){return n=y7e(t,e,n,r),await Qse(t,t.gltfFormat,r,i),n}function y7e(t,e,n,r,i){if(n=vL(t,e,n),t.version!==1)throw new Error("Instanced 3D Model version ".concat(t.version," is not supported"));n=PU(t,e,n);const o=new DataView(e);if(t.gltfFormat=o.getUint32(n,!0),n+=4,n=IU(t,e,n),n=Yse(t,e,n,r),t.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const a=new CU(t.featureTableJson,t.featureTableBinary),s=a.getGlobalProperty("INSTANCES_LENGTH");if(a.featuresLength=s,!Number.isFinite(s))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");t.eastNorthUp=a.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=a.getGlobalProperty("RTC_CENTER",_i.FLOAT,3);const u=new Xse(t.batchTableJson,t.batchTableBinary,s);return v7e(t,a,u,s),n}function v7e(t,e,n,r){const o={instances:new Array(r),batchTable:t._batchTable,cull:!1,url:void 0,gltf:void 0,basePath:void 0,incrementallyLoadTextures:!1,forwardAxis:[1,0,0]}.instances,a=new _t;new _t,new _t,new _t;const s=new is,u=new Qm,d=new _t,g={},_=new vr,E=[],P=[],O=new _t,D=new _t;for(let V=0;V<r;V++){let k;if(e.hasProperty("POSITION"))k=e.getProperty("POSITION",_i.FLOAT,3,V,a);else if(e.hasProperty("POSITION_QUANTIZED")){k=e.getProperty("POSITION_QUANTIZED",_i.UNSIGNED_SHORT,3,V,a);const re=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",_i.FLOAT,3,O);if(!re)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const ue=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",_i.FLOAT,3,D);if(!ue)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const ie=65535;for(let ce=0;ce<3;ce++)k[ce]=k[ce]/ie*ue[ce]+re[ce]}if(!k)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(a.copy(k),g.translation=a,t.normalUp=e.getProperty("NORMAL_UP",_i.FLOAT,3,V,E),t.normalRight=e.getProperty("NORMAL_RIGHT",_i.FLOAT,3,V,P),t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",_i.UNSIGNED_SHORT,2,E),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",_i.UNSIGNED_SHORT,2,P),t.octNormalUp)throw t.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");t.eastNorthUp?(ss.WGS84.eastNorthUpToFixedFrame(a,_),_.getRotationMatrix3(s)):s.identity()}u.fromMatrix3(s),g.rotation=u,d.set(1,1,1);const F=e.getProperty("SCALE",_i.FLOAT,1,V);Number.isFinite(F)&&d.multiplyByScalar(F);const z=e.getProperty("SCALE_NON_UNIFORM",_i.FLOAT,3,V,E);z&&d.scale(z),g.scale=d;let X=e.getProperty("BATCH_ID",_i.UNSIGNED_SHORT,1,V);X===void 0&&(X=V);const Y=new vr().fromQuaternion(g.rotation);_.identity(),_.translate(g.translation),_.multiplyRight(Y),_.scale(g.scale);const J=_.clone();o[V]={modelMatrix:J,batchId:X}}t.instances=o}async function x7e(t,e,n,r,i,o){n=vL(t,e,n);const a=new DataView(e);for(t.tilesLength=a.getUint32(n,!0),n+=4,t.tiles=[];t.tiles.length<t.tilesLength&&t.byteLength-n>12;){const s={};t.tiles.push(s),n=await o(e,n,r,i,s)}return n}async function b7e(t,e,n,r){t.rotateYtoZ=!0,t.gltfUpAxis=n["3d-tiles"]&&n["3d-tiles"].assetGltfUpAxis?n["3d-tiles"].assetGltfUpAxis:"Y";const{parse:i}=r;t.gltf=await i(e,_E,n,r),t.gpuMemoryUsageInBytes=Ose(t.gltf)}async function Kse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};switch(i.byteOffset=e,i.type=kHe(t,e),i.type){case Ob.COMPOSITE:return await x7e(i,t,e,n,r,Kse);case Ob.BATCHED_3D_MODEL:return await m7e(i,t,e,n,r);case Ob.GLTF:return await b7e(i,t,n,r);case Ob.INSTANCED_3D_MODEL:return await _7e(i,t,e,n,r);case Ob.POINT_CLOUD:return await s7e(i,t,e,n,r);default:throw new Error("3DTileLoader: unknown type ".concat(i.type))}}const w7e=1952609651,E7e=1;async function S7e(t,e,n){if(new Uint32Array(t.slice(0,4))[0]!==w7e)throw new Error("Wrong subtree file magic number");if(new Uint32Array(t.slice(4,8))[0]!==E7e)throw new Error("Wrong subtree file verson, must be 1");const o=TX(t.slice(8,16)),a=new Uint8Array(t,24,o),u=new TextDecoder("utf8").decode(a),d=JSON.parse(u),g=TX(t.slice(16,24));let _=new ArrayBuffer(0);return g&&(_=t.slice(24+o)),"bufferView"in d.tileAvailability&&(d.tileAvailability.explicitBitstream=await eN(d,"tileAvailability",_,n)),"bufferView"in d.contentAvailability&&(d.contentAvailability.explicitBitstream=await eN(d,"contentAvailability",_,n)),"bufferView"in d.childSubtreeAvailability&&(d.childSubtreeAvailability.explicitBitstream=await eN(d,"childSubtreeAvailability",_,n)),d}function T7e(t,e){if(e.startsWith("http")){const o=new URL(t,e);return decodeURI(o.toString())}const r="http://".concat(e),i=new URL(t,r);return"/".concat(i.host).concat(i.pathname)}async function eN(t,e,n,r){const i=t[e].bufferView,o=t.bufferViews[i],a=t.buffers[o.buffer];if(!(r!=null&&r.url)||!r.fetch)throw new Error("Url is not provided");if(!r.fetch)throw new Error("fetch is not provided");if(a.uri){const s=T7e(a.uri,r==null?void 0:r.url),d=await(await r.fetch(s)).arrayBuffer();return new Uint8Array(d,o.byteOffset,o.byteLength)}return new Uint8Array(n,o.byteOffset,o.byteLength)}function TX(t){const e=new DataView(t),n=e.getUint32(0,!0),r=e.getUint32(4,!0);return n+2**32*r}const Jse={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:Hse,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:S7e,options:{}};/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var hf=null;try{hf=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Ji(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Ji.prototype.__isLong__;Object.defineProperty(Ji.prototype,"__isLong__",{value:!0});function Dl(t){return(t&&t.__isLong__)===!0}function CX(t){var e=Math.clz32(t&-t);return t?31-e:e}Ji.isLong=Dl;var PX={},IX={};function S_(t,e){var n,r,i;return e?(t>>>=0,(i=0<=t&&t<256)&&(r=IX[t],r)?r:(n=Oi(t,0,!0),i&&(IX[t]=n),n)):(t|=0,(i=-128<=t&&t<128)&&(r=PX[t],r)?r:(n=Oi(t,t<0?-1:0,!1),i&&(PX[t]=n),n))}Ji.fromInt=S_;function df(t,e){if(isNaN(t))return e?Yp:mh;if(e){if(t<0)return Yp;if(t>=eae)return rae}else{if(t<=-OX)return Tu;if(t+1>=OX)return nae}return t<0?df(-t,e).neg():Oi(t%w1|0,t/w1|0,e)}Ji.fromNumber=df;function Oi(t,e,n){return new Ji(t,e,n)}Ji.fromBits=Oi;var hM=Math.pow;function MU(t,e,n){if(t.length===0)throw Error("empty string");if(typeof e=="number"?(n=e,e=!1):e=!!e,t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return e?Yp:mh;if(n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return MU(t.substring(1),e,n).neg();for(var i=df(hM(n,8)),o=mh,a=0;a<t.length;a+=8){var s=Math.min(8,t.length-a),u=parseInt(t.substring(a,a+s),n);if(s<8){var d=df(hM(n,s));o=o.mul(d).add(df(u))}else o=o.mul(i),o=o.add(df(u))}return o.unsigned=e,o}Ji.fromString=MU;function Vh(t,e){return typeof t=="number"?df(t,e):typeof t=="string"?MU(t,e):Oi(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Ji.fromValue=Vh;var MX=65536,C7e=1<<24,w1=MX*MX,eae=w1*w1,OX=eae/2,RX=S_(C7e),mh=S_(0);Ji.ZERO=mh;var Yp=S_(0,!0);Ji.UZERO=Yp;var hv=S_(1);Ji.ONE=hv;var tae=S_(1,!0);Ji.UONE=tae;var G4=S_(-1);Ji.NEG_ONE=G4;var nae=Oi(-1,2147483647,!1);Ji.MAX_VALUE=nae;var rae=Oi(-1,-1,!0);Ji.MAX_UNSIGNED_VALUE=rae;var Tu=Oi(0,-2147483648,!1);Ji.MIN_VALUE=Tu;var wn=Ji.prototype;wn.toInt=function(){return this.unsigned?this.low>>>0:this.low};wn.toNumber=function(){return this.unsigned?(this.high>>>0)*w1+(this.low>>>0):this.high*w1+(this.low>>>0)};wn.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Tu)){var n=df(e),r=this.div(n),i=r.mul(n).sub(this);return r.toString(e)+i.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=df(hM(e,6),this.unsigned),a=this,s="";;){var u=a.div(o),d=a.sub(u.mul(o)).toInt()>>>0,g=d.toString(e);if(a=u,a.isZero())return g+s;for(;g.length<6;)g="0"+g;s=""+g+s}};wn.getHighBits=function(){return this.high};wn.getHighBitsUnsigned=function(){return this.high>>>0};wn.getLowBits=function(){return this.low};wn.getLowBitsUnsigned=function(){return this.low>>>0};wn.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Tu)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};wn.isZero=function(){return this.high===0&&this.low===0};wn.eqz=wn.isZero;wn.isNegative=function(){return!this.unsigned&&this.high<0};wn.isPositive=function(){return this.unsigned||this.high>=0};wn.isOdd=function(){return(this.low&1)===1};wn.isEven=function(){return(this.low&1)===0};wn.equals=function(e){return Dl(e)||(e=Vh(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};wn.eq=wn.equals;wn.notEquals=function(e){return!this.eq(e)};wn.neq=wn.notEquals;wn.ne=wn.notEquals;wn.lessThan=function(e){return this.comp(e)<0};wn.lt=wn.lessThan;wn.lessThanOrEqual=function(e){return this.comp(e)<=0};wn.lte=wn.lessThanOrEqual;wn.le=wn.lessThanOrEqual;wn.greaterThan=function(e){return this.comp(e)>0};wn.gt=wn.greaterThan;wn.greaterThanOrEqual=function(e){return this.comp(e)>=0};wn.gte=wn.greaterThanOrEqual;wn.ge=wn.greaterThanOrEqual;wn.compare=function(e){if(Dl(e)||(e=Vh(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};wn.comp=wn.compare;wn.negate=function(){return!this.unsigned&&this.eq(Tu)?Tu:this.not().add(hv)};wn.neg=wn.negate;wn.add=function(e){Dl(e)||(e=Vh(e));var n=this.high>>>16,r=this.high&65535,i=this.low>>>16,o=this.low&65535,a=e.high>>>16,s=e.high&65535,u=e.low>>>16,d=e.low&65535,g=0,_=0,E=0,P=0;return P+=o+d,E+=P>>>16,P&=65535,E+=i+u,_+=E>>>16,E&=65535,_+=r+s,g+=_>>>16,_&=65535,g+=n+a,g&=65535,Oi(E<<16|P,g<<16|_,this.unsigned)};wn.subtract=function(e){return Dl(e)||(e=Vh(e)),this.add(e.neg())};wn.sub=wn.subtract;wn.multiply=function(e){if(this.isZero())return this;if(Dl(e)||(e=Vh(e)),hf){var n=hf.mul(this.low,this.high,e.low,e.high);return Oi(n,hf.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?Yp:mh;if(this.eq(Tu))return e.isOdd()?Tu:mh;if(e.eq(Tu))return this.isOdd()?Tu:mh;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(RX)&&e.lt(RX))return df(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,i=this.high&65535,o=this.low>>>16,a=this.low&65535,s=e.high>>>16,u=e.high&65535,d=e.low>>>16,g=e.low&65535,_=0,E=0,P=0,O=0;return O+=a*g,P+=O>>>16,O&=65535,P+=o*g,E+=P>>>16,P&=65535,P+=a*d,E+=P>>>16,P&=65535,E+=i*g,_+=E>>>16,E&=65535,E+=o*d,_+=E>>>16,E&=65535,E+=a*u,_+=E>>>16,E&=65535,_+=r*g+i*d+o*u+a*s,_&=65535,Oi(P<<16|O,_<<16|E,this.unsigned)};wn.mul=wn.multiply;wn.divide=function(e){if(Dl(e)||(e=Vh(e)),e.isZero())throw Error("division by zero");if(hf){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?hf.div_u:hf.div_s)(this.low,this.high,e.low,e.high);return Oi(n,hf.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Yp:mh;var r,i,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Yp;if(e.gt(this.shru(1)))return tae;o=Yp}else{if(this.eq(Tu)){if(e.eq(hv)||e.eq(G4))return Tu;if(e.eq(Tu))return hv;var a=this.shr(1);return r=a.div(e).shl(1),r.eq(mh)?e.isNegative()?hv:G4:(i=this.sub(e.mul(r)),o=r.add(i.div(e)),o)}else if(e.eq(Tu))return this.unsigned?Yp:mh;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=mh}for(i=this;i.gte(e);){r=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var s=Math.ceil(Math.log(r)/Math.LN2),u=s<=48?1:hM(2,s-48),d=df(r),g=d.mul(e);g.isNegative()||g.gt(i);)r-=u,d=df(r,this.unsigned),g=d.mul(e);d.isZero()&&(d=hv),o=o.add(d),i=i.sub(g)}return o};wn.div=wn.divide;wn.modulo=function(e){if(Dl(e)||(e=Vh(e)),hf){var n=(this.unsigned?hf.rem_u:hf.rem_s)(this.low,this.high,e.low,e.high);return Oi(n,hf.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};wn.mod=wn.modulo;wn.rem=wn.modulo;wn.not=function(){return Oi(~this.low,~this.high,this.unsigned)};wn.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};wn.clz=wn.countLeadingZeros;wn.countTrailingZeros=function(){return this.low?CX(this.low):CX(this.high)+32};wn.ctz=wn.countTrailingZeros;wn.and=function(e){return Dl(e)||(e=Vh(e)),Oi(this.low&e.low,this.high&e.high,this.unsigned)};wn.or=function(e){return Dl(e)||(e=Vh(e)),Oi(this.low|e.low,this.high|e.high,this.unsigned)};wn.xor=function(e){return Dl(e)||(e=Vh(e)),Oi(this.low^e.low,this.high^e.high,this.unsigned)};wn.shiftLeft=function(e){return Dl(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Oi(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Oi(0,this.low<<e-32,this.unsigned)};wn.shl=wn.shiftLeft;wn.shiftRight=function(e){return Dl(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Oi(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Oi(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};wn.shr=wn.shiftRight;wn.shiftRightUnsigned=function(e){return Dl(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Oi(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?Oi(this.high,0,this.unsigned):Oi(this.high>>>e-32,0,this.unsigned)};wn.shru=wn.shiftRightUnsigned;wn.shr_u=wn.shiftRightUnsigned;wn.rotateLeft=function(e){var n;return Dl(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?Oi(this.high,this.low,this.unsigned):e<32?(n=32-e,Oi(this.low<<e|this.high>>>n,this.high<<e|this.low>>>n,this.unsigned)):(e-=32,n=32-e,Oi(this.high<<e|this.low>>>n,this.low<<e|this.high>>>n,this.unsigned))};wn.rotl=wn.rotateLeft;wn.rotateRight=function(e){var n;return Dl(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?Oi(this.high,this.low,this.unsigned):e<32?(n=32-e,Oi(this.high<<n|this.low>>>e,this.low<<n|this.high>>>e,this.unsigned)):(e-=32,n=32-e,Oi(this.low<<n|this.high>>>e,this.high<<n|this.low>>>e,this.unsigned))};wn.rotr=wn.rotateRight;wn.toSigned=function(){return this.unsigned?Oi(this.low,this.high,!1):this};wn.toUnsigned=function(){return this.unsigned?this:Oi(this.low,this.high,!0)};wn.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};wn.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};wn.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Ji.fromBytes=function(e,n,r){return r?Ji.fromBytesLE(e,n):Ji.fromBytesBE(e,n)};Ji.fromBytesLE=function(e,n){return new Ji(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Ji.fromBytesBE=function(e,n){return new Ji(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const P7e=16;function iae(t){t==="X"&&(t="");const e=t.padEnd(P7e,"0");return Ji.fromString(e,!0,16)}function I7e(t){if(t.isZero())return"X";let e=t.countTrailingZeros();const n=e%4;e=(e-n)/4;const r=e;e*=4;const o=t.shiftRightUnsigned(e).toString(16).replace(/0+$/,"");return Array(17-r-o.length).join("0")+o}function M7e(t,e){const n=O7e(t).shiftRightUnsigned(2);return t.add(Ji.fromNumber(2*e+1-4).multiply(n))}function O7e(t){return t.and(t.not().add(1))}const R7e=3,L7e=30,D7e=2*L7e+1,LX=180/Math.PI;function B7e(t){if(t.length===0)throw new Error("Invalid Hilbert quad key ".concat(t));const e=t.split("/"),n=parseInt(e[0],10),r=e[1],i=r.length;let o=0;const a=[0,0];for(let s=i-1;s>=0;s--){o=i-s;const u=r[s];let d=0,g=0;u==="1"?g=1:u==="2"?(d=1,g=1):u==="3"&&(d=1);const _=Math.pow(2,o-1);F7e(_,a,d,g),a[0]+=_*d,a[1]+=_*g}if(n%2===1){const s=a[0];a[0]=a[1],a[1]=s}return{face:n,ij:a,level:o}}function N7e(t){if(t.isZero())return"";let e=t.toString(2);for(;e.length<R7e+D7e;)e="0"+e;const n=e.lastIndexOf("1"),r=e.substring(0,3),i=e.substring(3,n),o=i.length/2,a=Ji.fromString(r,!0,2).toString(10);let s="";if(o!==0)for(s=Ji.fromString(i,!0,2).toString(4);s.length<o;)s="0"+s;return"".concat(a,"/").concat(s)}function oae(t,e,n){const r=1<<e;return[(t[0]+n[0])/r,(t[1]+n[1])/r]}function DX(t){return t>=.5?1/3*(4*t*t-1):1/3*(1-4*(1-t)*(1-t))}function sae(t){return[DX(t[0]),DX(t[1])]}function aae(t,e){let[n,r]=e;switch(t){case 0:return[1,n,r];case 1:return[-n,1,r];case 2:return[-n,-r,1];case 3:return[-1,-r,-n];case 4:return[r,-1,-n];case 5:return[r,n,-1];default:throw new Error("Invalid face")}}function lae(t){let[e,n,r]=t;const i=Math.atan2(r,Math.sqrt(e*e+n*n));return[Math.atan2(n,e)*LX,i*LX]}function F7e(t,e,n,r){if(r===0){n===1&&(e[0]=t-1-e[0],e[1]=t-1-e[1]);const i=e[0];e[0]=e[1],e[1]=i}}function k7e(t){const e=oae(t.ij,t.level,[.5,.5]),n=sae(e),r=aae(t.face,n);return lae(r)}const z7e=100;function BX(t){const{face:e,ij:n,level:r}=t,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],o=Math.max(1,Math.ceil(z7e*Math.pow(2,-r))),a=new Float64Array(4*o*2+2);let s=0,u=0;for(let d=0;d<4;d++){const g=i[d].slice(0),_=i[d+1],E=(_[0]-g[0])/o,P=(_[1]-g[1])/o;for(let O=0;O<o;O++){g[0]+=E,g[1]+=P;const D=oae(n,r,g),V=sae(D),k=aae(e,V),F=lae(k);Math.abs(F[1])>89.999&&(F[0]=u);const z=F[0]-u;F[0]+=z>180?-360:z<-180?360:0,a[s++]=F[0],a[s++]=F[1],u=F[0]}}return a[s++]=a[0],a[s++]=a[1],a}function OU(t){const e=U7e(t);return B7e(e)}function U7e(t){if(t.indexOf("/")>0)return t;const e=iae(t);return N7e(e)}function G7e(t){const e=OU(t);return k7e(e)}function j7e(t){let e;if(t.face===2||t.face===5){let n=null,r=0;for(let i=0;i<4;i++){const o="".concat(t.face,"/").concat(i),a=OU(o),s=BX(a);(typeof n>"u"||n===null)&&(n=new Float64Array(4*s.length)),n.set(s,r),r+=s.length}e=NX(n)}else{const n=BX(t);e=NX(n)}return e}function NX(t){if(t.length%2!==0)throw new Error("Invalid corners");const e=[],n=[];for(let r=0;r<t.length;r+=2)e.push(t[r]),n.push(t[r+1]);return e.sort((r,i)=>r-i),n.sort((r,i)=>r-i),{west:e[0],east:e[e.length-1],north:n[n.length-1],south:n[0]}}function V7e(t,e){const n=(e==null?void 0:e.minimumHeight)||0,r=(e==null?void 0:e.maximumHeight)||0,i=OU(t),o=j7e(i),a=o.west,s=o.south,u=o.east,d=o.north,g=[];return g.push(new _t(a,d,n)),g.push(new _t(u,d,n)),g.push(new _t(u,s,n)),g.push(new _t(a,s,n)),g.push(new _t(a,d,r)),g.push(new _t(u,d,r)),g.push(new _t(u,s,r)),g.push(new _t(a,s,r)),g}function uae(t){const e=t.token,n={minimumHeight:t.minimumHeight,maximumHeight:t.maximumHeight},r=V7e(e,n),i=G7e(e),o=i[0],a=i[1],s=ss.WGS84.cartographicToCartesian([o,a,n.maximumHeight]),u=new _t(s[0],s[1],s[2]);r.push(u);const d=Xoe(r);return[...d.center,...d.halfAxes]}const $7e=4,H7e=8,W7e={QUADTREE:$7e,OCTREE:H7e};function q7e(t,e,n){if(t!=null&&t.box){const r=iae(t.s2VolumeInfo.token),i=M7e(r,e),o=I7e(i),a={...t.s2VolumeInfo};switch(a.token=o,n){case"OCTREE":const d=t.s2VolumeInfo,g=d.maximumHeight-d.minimumHeight,_=g/2,E=d.minimumHeight+g/2;d.minimumHeight=E-_,d.maximumHeight=E+_;break}return{box:uae(a),s2VolumeInfo:a}}}async function cae(t){const{options:e,parentData:n={mortonIndex:0,x:0,y:0,z:0},childIndex:r=0,globalData:i={level:0,mortonIndex:0,x:0,y:0,z:0},s2VolumeBox:o}=t;let{subtree:a,level:s=0}=t;const{subdivisionScheme:u,subtreeLevels:d,maximumLevel:g,contentUrlTemplate:_,subtreesUriTemplate:E,basePath:P}=e,O={children:[],lodMetricValue:0,contentUrl:""},D=W7e[u],V=r&1,k=r>>1&1,F=r>>2&1,z=(D**s-1)/(D-1);let X=f0(n.mortonIndex,r),Y=z+X,J=f0(n.x,V),re=f0(n.y,k),ue=f0(n.z,F),ie=!1;s+1>d&&(ie=tN(a.childSubtreeAvailability,X));const ce=f0(i.x,J),se=f0(i.y,re),me=f0(i.z,ue),Ce=s+i.level;if(ie){const be="".concat(P,"/").concat(E),De=j4(be,Ce,ce,se,me);a=await ag(De,Jse),i.mortonIndex=X,i.x=J,i.y=re,i.z=ue,i.level=s,X=0,Y=0,J=0,re=0,ue=0,s=0}if(!tN(a.tileAvailability,Y)||s>g)return O;tN(a.contentAvailability,Y)&&(O.contentUrl=j4(_,Ce,ce,se,me));const at=s+1,yt={mortonIndex:X,x:J,y:re,z:ue};for(let be=0;be<D;be++){const De=q7e(o,be,u),Re=await cae({subtree:a,options:e,parentData:yt,childIndex:be,level:at,globalData:i,s2VolumeBox:De});if(Re.contentUrl||Re.children.length){const qe=Ce+1,Ct=X7e(Re,qe,{childTileX:J,childTileY:re,childTileZ:ue},e,o);O.children.push(Ct)}}return O}function tN(t,e){return"constant"in t?!!t.constant:t.explicitBitstream?Q7e(e,t.explicitBitstream):!1}function X7e(t,e,n,r,i){const{basePath:o,refine:a,getRefine:s,lodMetricType:u,getTileType:d,rootLodMetricValue:g,rootBoundingVolume:_}=r,E=t.contentUrl&&t.contentUrl.replace("".concat(o,"/"),""),P=g/2**e,O=i!=null&&i.box?{box:i.box}:_,D=Z7e(e,O,n);return{children:t.children,contentUrl:t.contentUrl,content:{uri:E},id:t.contentUrl,refine:s(a),type:d(t),lodMetricType:u,lodMetricValue:P,geometricError:P,transform:t.transform,boundingVolume:D}}function Z7e(t,e,n){if(e.region){const{childTileX:r,childTileY:i,childTileZ:o}=n,[a,s,u,d,g,_]=e.region,E=2**t,P=(u-a)/E,O=(d-s)/E,D=(_-g)/E,[V,k]=[a+P*r,a+P*(r+1)],[F,z]=[s+O*i,s+O*(i+1)],[X,Y]=[g+D*o,g+D*(o+1)];return{region:[V,F,k,z,X,Y]}}if(e.box)return e;throw new Error("Unsupported bounding volume type ".concat(e))}function f0(t,e){return parseInt(t.toString(2)+e.toString(2),2)}function j4(t,e,n,r,i){const o=Y7e({level:e,x:n,y:r,z:i});return t.replace(/{level}|{x}|{y}|{z}/gi,a=>o[a])}function Y7e(t){const e={};for(const n in t)e["{".concat(n,"}")]=t[n];return e}function Q7e(t,e){const n=Math.floor(t/8),r=t%8;return(e[n]>>r&1)===1}function RU(t){if(!t.contentUrl)return Sv.EMPTY;const n=t.contentUrl.split("?")[0].split(".").pop();switch(n){case"pnts":return Sv.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return Sv.SCENEGRAPH;default:return n}}function LU(t){switch(t){case"REPLACE":case"replace":return tg.REPLACE;case"ADD":case"add":return tg.ADD;default:return t}}function V4(t,e){if(/^[a-z][0-9a-z+.-]*:/i.test(e)){const r=new URL(t,"".concat(e,"/"));return decodeURI(r.toString())}else if(t.startsWith("/"))return t;return"".concat(e,"/").concat(t)}function FX(t,e){if(!t)return null;if(t.content){const n=t.content.uri||t.content.url;t.contentUrl=V4(n,e.basePath)}return t.id=t.contentUrl,t.lodMetricType=_L.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=RU(t),t.refine=LU(t.refine),t}async function K7e(t,e){const n=t.basePath;let r;const i=zX(t==null?void 0:t.root);i&&t.root?r=await kX(t.root,t,i,e):r=FX(t.root,t);const o=[];for(o.push(r);o.length>0;){const s=(o.pop()||{}).children||[];for(let u of s){const d=zX(u);d?u=await kX(u,t,d,e):FX(u,{basePath:n}),o.push(u)}}return r}async function kX(t,e,n,r){var i,o;const a=e.basePath,{subdivisionScheme:s,maximumLevel:u,subtreeLevels:d,subtrees:{uri:g}}=n,_=j4(g,0,0,0,0),E=V4(_,a),P=await ag(E,Jse,r),O=V4(t.content.uri,a),D=e==null||(i=e.root)===null||i===void 0?void 0:i.refine,V=t.geometricError,k=(o=t.boundingVolume.extensions)===null||o===void 0?void 0:o["3DTILES_bounding_volume_S2"];if(k){const Y={box:uae(k),s2VolumeInfo:k};t.boundingVolume=Y}const F=t.boundingVolume,z={contentUrlTemplate:O,subtreesUriTemplate:g,subdivisionScheme:s,subtreeLevels:d,maximumLevel:u,refine:D,basePath:a,lodMetricType:_L.GEOMETRIC_ERROR,rootLodMetricValue:V,rootBoundingVolume:F,getTileType:RU,getRefine:LU};return await J7e(t,P,z)}async function J7e(t,e,n){if(!t)return null;t.lodMetricType=_L.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform;const{children:r,contentUrl:i}=await cae({subtree:e,options:n,s2VolumeBox:t});return i&&(t.contentUrl=i,t.content={uri:i.replace("".concat(n.basePath,"/"),"")}),t.refine=LU(t.refine),t.type=RU(t),t.children=r,t.id=t.contentUrl,t}function zX(t){var e;return(t==null||(e=t.extensions)===null||e===void 0?void 0:e["3DTILES_implicit_tiling"])||(t==null?void 0:t.implicitTiling)}const fae={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:Hse,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:rWe,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};function eWe(t){return o5(t.url)}async function tWe(t,e,n){const r={content:{featureIds:null}};return await Kse(t,0,e,n,r.content),r.content}async function nWe(t,e,n){var r;const i=JSON.parse(new TextDecoder().decode(t));return i.loader=e.loader||fae,i.url=n.url,i.queryString=n.queryString,i.basePath=eWe(i),i.root=await K7e(i,e),i.type=tf.TILES3D,i.lodMetricType=_L.GEOMETRIC_ERROR,i.lodMetricValue=((r=i.root)===null||r===void 0?void 0:r.lodMetricValue)||0,i}async function rWe(t,e,n){const r=e["3d-tiles"]||{};let i;return r.isTileset==="auto"?i=n.url&&n.url.indexOf(".json")!==-1:i=r.isTileset,i?t=await nWe(t,e,n):t=await tWe(t,e,n),t}const UX=[0],iWe={getPointColor:{type:"accessor",value:[0,0,0,255]},pointSize:1,data:"",loader:fae,onTilesetLoad:{type:"function",value:t=>{}},onTileLoad:{type:"function",value:t=>{}},onTileUnload:{type:"function",value:t=>{}},onTileError:{type:"function",value:(t,e,n)=>{}},_getMeshColor:{type:"function",value:t=>[255,255,255]}};class DU extends Uh{constructor(...e){super(...e),q(this,"state",void 0)}initializeState(){"onTileLoadFail"in this.props&&Or.removed("onTileLoadFail","onTileError")(),this.state={layerMap:{},tileset3d:null,activeViewports:{},lastUpdatedViewports:null}}get isLoaded(){const{tileset3d:e}=this.state;return e!==null&&e.isLoaded()}shouldUpdateState({changeFlags:e}){return e.somethingChanged}updateState({props:e,oldProps:n,changeFlags:r}){if(e.data&&e.data!==n.data&&this._loadTileset(e.data),r.viewportChanged){const{activeViewports:i}=this.state;Object.keys(i).length&&(this._updateTileset(i),this.state.lastUpdatedViewports=i,this.state.activeViewports={})}if(r.propsChanged){const{layerMap:i}=this.state;for(const o in i)i[o].needsUpdate=!0}}activateViewport(e){const{activeViewports:n,lastUpdatedViewports:r}=this.state;this.internalState.viewport=e,n[e.id]=e;const i=r==null?void 0:r[e.id];(!i||!e.equals(i))&&(this.setChangeFlags({viewportChanged:!0}),this.setNeedsUpdate())}getPickingInfo({info:e,sourceLayer:n}){const r=n&&n.props.tile;return e.picked&&(e.object=r),e.sourceTile=r,e}filterSubLayer({layer:e,viewport:n}){const{tile:r}=e.props,{id:i}=n;return r.selected&&r.viewportIds.includes(i)}_updateAutoHighlight(e){const n=e.sourceTile,r=this.state.layerMap[n==null?void 0:n.id];r&&r.layer&&r.layer.updateAutoHighlight(e)}async _loadTileset(e){const{loadOptions:n={}}=this.props;let r=this.props.loader||this.props.loaders;Array.isArray(r)&&(r=r[0]);const i={loadOptions:{...n}};let o=e;if(r.preload){const u=await r.preload(e,n);u.url&&(o=u.url),u.headers&&(i.loadOptions.fetch={...i.loadOptions.fetch,headers:u.headers}),Object.assign(i,u)}const a=await ag(o,r,i.loadOptions),s=new FHe(a,{onTileLoad:this._onTileLoad.bind(this),onTileUnload:this._onTileUnload.bind(this),onTileError:this.props.onTileError,...i});this.setState({tileset3d:s,layerMap:{}}),this._updateTileset(this.state.activeViewports),this.props.onTilesetLoad(s)}_onTileLoad(e){const{lastUpdatedViewports:n}=this.state;this.props.onTileLoad(e),this._updateTileset(n),this.setNeedsUpdate()}_onTileUnload(e){delete this.state.layerMap[e.id],this.props.onTileUnload(e)}_updateTileset(e){if(!e)return;const{tileset3d:n}=this.state,{timeline:r}=this.context,i=Object.keys(e).length;!r||!i||!n||n.selectTiles(Object.values(e)).then(o=>{this.state.frameNumber!==o&&this.setState({frameNumber:o})})}_getSubLayer(e,n){if(!e.content)return null;switch(e.type){case Sv.POINTCLOUD:return this._makePointCloudLayer(e,n);case Sv.SCENEGRAPH:return this._make3DModelLayer(e);case Sv.MESH:return this._makeSimpleMeshLayer(e,n);default:throw new Error("Tile3DLayer: Failed to render layer of type ".concat(e.content.type))}}_makePointCloudLayer(e,n){const{attributes:r,pointCount:i,constantRGBA:o,cartographicOrigin:a,modelMatrix:s}=e.content,{positions:u,normals:d,colors:g}=r;if(!u)return null;const _=n&&n.props.data||{header:{vertexCount:i},attributes:{POSITION:u,NORMAL:d,COLOR_0:g}},{pointSize:E,getPointColor:P}=this.props,O=this.getSubLayerClass("pointcloud",QR);return new O({pointSize:E},this.getSubLayerProps({id:"pointcloud"}),{id:"".concat(this.id,"-pointcloud-").concat(e.id),tile:e,data:_,coordinateSystem:Br.METER_OFFSETS,coordinateOrigin:a,modelMatrix:s,getColor:o||P,_offset:0})}_make3DModelLayer(e){const{gltf:n,instances:r,cartographicOrigin:i,modelMatrix:o}=e.content,a=this.getSubLayerClass("scenegraph",mL);return new a({_lighting:"pbr"},this.getSubLayerProps({id:"scenegraph"}),{id:"".concat(this.id,"-scenegraph-").concat(e.id),tile:e,data:r||UX,scenegraph:n,coordinateSystem:Br.METER_OFFSETS,coordinateOrigin:i,modelMatrix:o,getTransformMatrix:s=>s.modelMatrix,getPosition:[0,0,0],_offset:0})}_makeSimpleMeshLayer(e,n){const r=e.content,{attributes:i,indices:o,modelMatrix:a,cartographicOrigin:s,coordinateSystem:u=Br.METER_OFFSETS,material:d,featureIds:g}=r,{_getMeshColor:_}=this.props,E=n&&n.props.mesh||new Cs({drawMode:4,attributes:oWe(i),indices:o}),P=this.getSubLayerClass("mesh",TU);return new P(this.getSubLayerProps({id:"mesh"}),{id:"".concat(this.id,"-mesh-").concat(e.id),tile:e,mesh:E,data:UX,getColor:_(e),pbrMaterial:d,modelMatrix:a,coordinateOrigin:s,coordinateSystem:u,featureIds:g,_offset:0})}renderLayers(){const{tileset3d:e,layerMap:n}=this.state;return e?e.tiles.map(r=>{const i=n[r.id]=n[r.id]||{tile:r};let{layer:o}=i;return r.selected&&(o?i.needsUpdate&&(o=this._getSubLayer(r,o),i.needsUpdate=!1):o=this._getSubLayer(r)),i.layer=o,o}).filter(Boolean):null}}q(DU,"defaultProps",iWe);q(DU,"layerName","Tile3DLayer");function oWe(t){const e={};return e.positions={...t.positions,value:new Float32Array(t.positions.value)},t.normals&&(e.normals=t.normals),t.texCoords&&(e.texCoords=t.texCoords),t.colors&&(e.colors=t.colors),t.uvRegions&&(e.uvRegions=t.uvRegions),e}function sWe(t,e,n,r){const i=r?lWe(r,t.POSITION.value):aWe(e),o=new t.POSITION.value.constructor(i.length*6),a=new t.TEXCOORD_0.value.constructor(i.length*4),s=new e.constructor(i.length*6);for(let d=0;d<i.length;d++){const g=i[d];uWe({edge:g,edgeIndex:d,attributes:t,skirtHeight:n,newPosition:o,newTexcoord0:a,newTriangles:s})}t.POSITION.value=kD(t.POSITION.value,o),t.TEXCOORD_0.value=kD(t.TEXCOORD_0.value,a);const u=e instanceof Array?e.concat(s):kD(e,s);return{attributes:t,triangles:u}}function aWe(t){const e=[];for(let a=0;a<t.length;a+=3)e.push([t[a],t[a+1]]),e.push([t[a+1],t[a+2]]),e.push([t[a+2],t[a]]);e.sort((a,s)=>Math.min(...a)-Math.min(...s)||Math.max(...a)-Math.max(...s));const n=[];let r=0;for(;r<e.length;){var i,o;e[r][0]===((i=e[r+1])===null||i===void 0?void 0:i[1])&&e[r][1]===((o=e[r+1])===null||o===void 0?void 0:o[0])?r+=2:(n.push(e[r]),r++)}return n}function lWe(t,e){t.westIndices.sort((r,i)=>e[3*r+1]-e[3*i+1]),t.eastIndices.sort((r,i)=>e[3*i+1]-e[3*r+1]),t.southIndices.sort((r,i)=>e[3*i]-e[3*r]),t.northIndices.sort((r,i)=>e[3*r]-e[3*i]);const n=[];for(const r in t){const i=t[r];for(let o=0;o<i.length-1;o++)n.push([i[o],i[o+1]])}return n}function uWe(t){let{edge:e,edgeIndex:n,attributes:r,skirtHeight:i,newPosition:o,newTexcoord0:a,newTriangles:s}=t;const u=r.POSITION.value.length,d=n*2,g=n*2+1;o.set(r.POSITION.value.subarray(e[0]*3,e[0]*3+3),d*3),o[d*3+2]=o[d*3+2]-i,o.set(r.POSITION.value.subarray(e[1]*3,e[1]*3+3),g*3),o[g*3+2]=o[g*3+2]-i,a.set(r.TEXCOORD_0.value.subarray(e[0]*2,e[0]*2+2),d*2),a.set(r.TEXCOORD_0.value.subarray(e[1]*2,e[1]*2+2),g*2);const _=n*2*3;s[_]=e[0],s[_+1]=u/3+g,s[_+2]=e[1],s[_+3]=u/3+g,s[_+4]=e[0],s[_+5]=u/3+d}class cWe{constructor(e=257){this.gridSize=e;const n=e-1;if(n&n-1)throw new Error(`Expected grid size to be 2^n+1, got ${e}.`);this.numTriangles=n*n*2-2,this.numParentTriangles=this.numTriangles-n*n,this.indices=new Uint32Array(this.gridSize*this.gridSize),this.coords=new Uint16Array(this.numTriangles*4);for(let r=0;r<this.numTriangles;r++){let i=r+2,o=0,a=0,s=0,u=0,d=0,g=0;for(i&1?s=u=d=n:o=a=g=n;(i>>=1)>1;){const E=o+s>>1,P=a+u>>1;i&1?(s=o,u=a,o=d,a=g):(o=s,a=u,s=d,u=g),d=E,g=P}const _=r*4;this.coords[_+0]=o,this.coords[_+1]=a,this.coords[_+2]=s,this.coords[_+3]=u}}createTile(e){return new fWe(e,this)}}class fWe{constructor(e,n){const r=n.gridSize;if(e.length!==r*r)throw new Error(`Expected terrain data of length ${r*r} (${r} x ${r}), got ${e.length}.`);this.terrain=e,this.martini=n,this.errors=new Float32Array(e.length),this.update()}update(){const{numTriangles:e,numParentTriangles:n,coords:r,gridSize:i}=this.martini,{terrain:o,errors:a}=this;for(let s=e-1;s>=0;s--){const u=s*4,d=r[u+0],g=r[u+1],_=r[u+2],E=r[u+3],P=d+_>>1,O=g+E>>1,D=P+O-g,V=O+d-P,k=(o[g*i+d]+o[E*i+_])/2,F=O*i+P,z=Math.abs(k-o[F]);if(a[F]=Math.max(a[F],z),s<n){const X=(g+V>>1)*i+(d+D>>1),Y=(E+V>>1)*i+(_+D>>1);a[F]=Math.max(a[F],a[X],a[Y])}}}getMesh(e=0){const{gridSize:n,indices:r}=this.martini,{errors:i}=this;let o=0,a=0;const s=n-1;r.fill(0);function u(P,O,D,V,k,F){const z=P+D>>1,X=O+V>>1;Math.abs(P-k)+Math.abs(O-F)>1&&i[X*n+z]>e?(u(k,F,P,O,z,X),u(D,V,k,F,z,X)):(r[O*n+P]=r[O*n+P]||++o,r[V*n+D]=r[V*n+D]||++o,r[F*n+k]=r[F*n+k]||++o,a++)}u(0,0,s,s,s,0),u(s,s,0,0,0,s);const d=new Uint16Array(o*2),g=new Uint32Array(a*3);let _=0;function E(P,O,D,V,k,F){const z=P+D>>1,X=O+V>>1;if(Math.abs(P-k)+Math.abs(O-F)>1&&i[X*n+z]>e)E(k,F,P,O,z,X),E(D,V,k,F,z,X);else{const Y=r[O*n+P]-1,J=r[V*n+D]-1,re=r[F*n+k]-1;d[2*Y]=P,d[2*Y+1]=O,d[2*J]=D,d[2*J+1]=V,d[2*re]=k,d[2*re+1]=F,g[_++]=Y,g[_++]=J,g[_++]=re}}return E(0,0,s,s,s,0),E(s,s,0,0,0,s),{vertices:d,triangles:g}}}class hWe{constructor(e,n){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;this.data=e,this.width=n,this.height=r,this.coords=[],this.triangles=[],this._halfedges=[],this._candidates=[],this._queueIndices=[],this._queue=[],this._errors=[],this._rms=[],this._pending=[],this._pendingLen=0,this._rmsSum=0;const i=n-1,o=r-1,a=this._addPoint(0,0),s=this._addPoint(i,0),u=this._addPoint(0,o),d=this._addPoint(i,o),g=this._addTriangle(d,a,u,-1,-1,-1);this._addTriangle(a,d,s,g,-1,-1),this._flush()}run(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1;for(;this.getMaxError()>e;)this.refine()}refine(){this._step(),this._flush()}getMaxError(){return this._errors[0]}getRMSD(){return this._rmsSum>0?Math.sqrt(this._rmsSum/(this.width*this.height)):0}heightAt(e,n){return this.data[this.width*n+e]}_flush(){const e=this.coords;for(let n=0;n<this._pendingLen;n++){const r=this._pending[n],i=2*this.triangles[r*3+0],o=2*this.triangles[r*3+1],a=2*this.triangles[r*3+2];this._findCandidate(e[i],e[i+1],e[o],e[o+1],e[a],e[a+1],r)}this._pendingLen=0}_findCandidate(e,n,r,i,o,a,s){const u=Math.min(e,r,o),d=Math.min(n,i,a),g=Math.max(e,r,o),_=Math.max(n,i,a);let E=h0(r,i,o,a,u,d),P=h0(o,a,e,n,u,d),O=h0(e,n,r,i,u,d);const D=i-n,V=e-r,k=a-i,F=r-o,z=n-a,X=o-e,Y=h0(e,n,r,i,o,a),J=this.heightAt(e,n)/Y,re=this.heightAt(r,i)/Y,ue=this.heightAt(o,a)/Y;let ie=0,ce=0,se=0,me=0;for(let Ce=d;Ce<=_;Ce++){let we=0;E<0&&k!==0&&(we=Math.max(we,Math.floor(-E/k))),P<0&&z!==0&&(we=Math.max(we,Math.floor(-P/z))),O<0&&D!==0&&(we=Math.max(we,Math.floor(-O/D)));let Ye=E+k*we,at=P+z*we,yt=O+D*we,be=!1;for(let De=u+we;De<=g;De++){if(Ye>=0&&at>=0&&yt>=0){be=!0;const Re=J*Ye+re*at+ue*yt,qe=Math.abs(Re-this.heightAt(De,Ce));me+=qe*qe,qe>ie&&(ie=qe,ce=De,se=Ce)}else if(be)break;Ye+=k,at+=z,yt+=D}E+=F,P+=X,O+=V}(ce===e&&se===n||ce===r&&se===i||ce===o&&se===a)&&(ie=0),this._candidates[2*s]=ce,this._candidates[2*s+1]=se,this._rms[s]=me,this._queuePush(s,ie,me)}_step(){const e=this._queuePop(),n=e*3+0,r=e*3+1,i=e*3+2,o=this.triangles[n],a=this.triangles[r],s=this.triangles[i],u=this.coords[2*o],d=this.coords[2*o+1],g=this.coords[2*a],_=this.coords[2*a+1],E=this.coords[2*s],P=this.coords[2*s+1],O=this._candidates[2*e],D=this._candidates[2*e+1],V=this._addPoint(O,D);if(h0(u,d,g,_,O,D)===0)this._handleCollinear(V,n);else if(h0(g,_,E,P,O,D)===0)this._handleCollinear(V,r);else if(h0(E,P,u,d,O,D)===0)this._handleCollinear(V,i);else{const k=this._halfedges[n],F=this._halfedges[r],z=this._halfedges[i],X=this._addTriangle(o,a,V,k,-1,-1,n),Y=this._addTriangle(a,s,V,F,-1,X+1),J=this._addTriangle(s,o,V,z,X+2,Y+1);this._legalize(X),this._legalize(Y),this._legalize(J)}}_addPoint(e,n){const r=this.coords.length>>1;return this.coords.push(e,n),r}_addTriangle(e,n,r,i,o,a){let s=arguments.length>6&&arguments[6]!==void 0?arguments[6]:this.triangles.length;const u=s/3;return this.triangles[s+0]=e,this.triangles[s+1]=n,this.triangles[s+2]=r,this._halfedges[s+0]=i,this._halfedges[s+1]=o,this._halfedges[s+2]=a,i>=0&&(this._halfedges[i]=s+0),o>=0&&(this._halfedges[o]=s+1),a>=0&&(this._halfedges[a]=s+2),this._candidates[2*u+0]=0,this._candidates[2*u+1]=0,this._queueIndices[u]=-1,this._rms[u]=0,this._pending[this._pendingLen++]=u,s}_legalize(e){const n=this._halfedges[e];if(n<0)return;const r=e-e%3,i=n-n%3,o=r+(e+1)%3,a=r+(e+2)%3,s=i+(n+2)%3,u=i+(n+1)%3,d=this.triangles[a],g=this.triangles[e],_=this.triangles[o],E=this.triangles[s],P=this.coords;if(!dWe(P[2*d],P[2*d+1],P[2*g],P[2*g+1],P[2*_],P[2*_+1],P[2*E],P[2*E+1]))return;const O=this._halfedges[o],D=this._halfedges[a],V=this._halfedges[s],k=this._halfedges[u];this._queueRemove(r/3),this._queueRemove(i/3);const F=this._addTriangle(d,E,_,-1,V,O,r),z=this._addTriangle(E,d,g,F,D,k,i);this._legalize(F+1),this._legalize(z+2)}_handleCollinear(e,n){const r=n-n%3,i=r+(n+1)%3,o=r+(n+2)%3,a=this.triangles[o],s=this.triangles[n],u=this.triangles[i],d=this._halfedges[i],g=this._halfedges[o],_=this._halfedges[n];if(_<0){const J=this._addTriangle(e,a,s,-1,g,-1,r),re=this._addTriangle(a,e,u,J,-1,d);this._legalize(J+1),this._legalize(re+2);return}const E=_-_%3,P=E+(_+2)%3,O=E+(_+1)%3,D=this.triangles[P],V=this._halfedges[P],k=this._halfedges[O];this._queueRemove(E/3);const F=this._addTriangle(a,s,e,g,-1,-1,r),z=this._addTriangle(s,D,e,k,-1,F+1,E),X=this._addTriangle(D,u,e,V,-1,z+1),Y=this._addTriangle(u,a,e,d,F+2,X+1);this._legalize(F),this._legalize(z),this._legalize(X),this._legalize(Y)}_queuePush(e,n,r){const i=this._queue.length;this._queueIndices[e]=i,this._queue.push(e),this._errors.push(n),this._rmsSum+=r,this._queueUp(i)}_queuePop(){const e=this._queue.length-1;return this._queueSwap(0,e),this._queueDown(0,e),this._queuePopBack()}_queuePopBack(){const e=this._queue.pop();return this._errors.pop(),this._rmsSum-=this._rms[e],this._queueIndices[e]=-1,e}_queueRemove(e){const n=this._queueIndices[e];if(n<0){const i=this._pending.indexOf(e);if(i!==-1)this._pending[i]=this._pending[--this._pendingLen];else throw new Error("Broken triangulation (something went wrong).");return}const r=this._queue.length-1;r!==n&&(this._queueSwap(n,r),this._queueDown(n,r)||this._queueUp(n)),this._queuePopBack()}_queueLess(e,n){return this._errors[e]>this._errors[n]}_queueSwap(e,n){const r=this._queue[e],i=this._queue[n];this._queue[e]=i,this._queue[n]=r,this._queueIndices[r]=n,this._queueIndices[i]=e;const o=this._errors[e];this._errors[e]=this._errors[n],this._errors[n]=o}_queueUp(e){let n=e;for(;;){const r=n-1>>1;if(r===n||!this._queueLess(n,r))break;this._queueSwap(r,n),n=r}}_queueDown(e,n){let r=e;for(;;){const i=2*r+1;if(i>=n||i<0)break;const o=i+1;let a=i;if(o<n&&this._queueLess(o,i)&&(a=o),!this._queueLess(a,r))break;this._queueSwap(r,a),r=a}return r>e}}function h0(t,e,n,r,i,o){return(n-i)*(e-o)-(r-o)*(t-i)}function dWe(t,e,n,r,i,o,a,s){const u=t-a,d=e-s,g=n-a,_=r-s,E=i-a,P=o-s,O=u*u+d*d,D=g*g+_*_,V=E*E+P*P;return u*(_*V-D*P)-d*(g*V-D*E)+O*(g*P-_*E)<0}function vT(t,e,n,r,i){const{rScaler:o,bScaler:a,gScaler:s,offset:u}=r,d=new Float32Array((e+1)*(n+1));for(let g=0,_=0;_<n;_++)for(let E=0;E<e;E++,g++){const P=g*4,O=t[P+0],D=t[P+1],V=t[P+2];d[g+_]=O*o+D*s+V*a+u}if(i==="martini"){for(let g=(e+1)*e,_=0;_<e;_++,g++)d[g]=d[g-e-1];for(let g=n,_=0;_<n+1;_++,g+=n+1)d[g]=d[g-1]}return d}function pWe(t,e,n,r,i){const o=n+1,a=t.length/2,s=new Float32Array(a*3),u=new Float32Array(a*2),[d,g,_,E]=i||[0,0,n,r],P=(_-d)/n,O=(E-g)/r;for(let D=0;D<a;D++){const V=t[D*2],k=t[D*2+1],F=k*o+V;s[3*D+0]=V*P+d,s[3*D+1]=-k*O+E,s[3*D+2]=e[F],u[2*D+0]=V/n,u[2*D+1]=k/r}return{POSITION:{value:s,size:3},TEXCOORD_0:{value:u,size:2}}}function gWe(t,e){if(t===null)return null;const{meshMaxError:n,bounds:r,elevationDecoder:i}=e,{data:o,width:a,height:s}=t;let u,d;switch(e.tesselator){case"martini":u=vT(o,a,s,i,e.tesselator),d=GX(n,a,u);break;case"delatin":u=vT(o,a,s,i,e.tesselator),d=jX(n,a,s,u);break;default:a===s&&!(s&a-1)?(u=vT(o,a,s,i,"martini"),d=GX(n,a,u)):(u=vT(o,a,s,i,"delatin"),d=jX(n,a,s,u));break}const{vertices:g}=d;let{triangles:_}=d,E=pWe(g,u,a,s,r);const P=yU(E);if(e.skirtHeight){const{attributes:O,triangles:D}=sWe(E,_,e.skirtHeight);E=O,_=D}return{loaderData:{header:{}},header:{vertexCount:_.length,boundingBox:P},mode:4,indices:{value:Uint32Array.from(_),size:1},attributes:E}}function GX(t,e,n){const r=e+1,o=new cWe(r).createTile(n),{vertices:a,triangles:s}=o.getMesh(t);return{vertices:a,triangles:s}}function jX(t,e,n,r){const i=new hWe(r,e+1,n+1);i.run(t);const{coords:o,triangles:a}=i;return{vertices:o,triangles:a}}async function mWe(t,e,n){const r={...e,mimeType:"application/x.image",image:{...e.image,type:"data"}},i=await n.parse(t,r);return gWe(i,e.terrain)}const AWe="3.4.14",hae={name:"Terrain",id:"terrain",module:"terrain",version:AWe,worker:!0,extensions:["png","pngraw","jpg","jpeg","gif","webp","bmp"],mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp"],options:{terrain:{tesselator:"auto",bounds:null,meshMaxError:10,elevationDecoder:{rScaler:1,gScaler:0,bScaler:0,offset:0},skirtHeight:null}}};({...hae});const VX=[1],_We={...X1.defaultProps,elevationData:lM,texture:{...lM,optional:!0},meshMaxError:{type:"number",value:4},bounds:{type:"array",value:null,optional:!0,compare:!0},color:{type:"color",value:[255,255,255]},elevationDecoder:{type:"object",value:{rScaler:1,gScaler:0,bScaler:0,offset:0}},workerUrl:"",wireframe:!1,material:!0,loaders:[hae]};function $X(t){return Array.isArray(t)?t.join(";"):t||""}class BU extends Uh{constructor(...e){super(...e),q(this,"state",void 0)}updateState({props:e,oldProps:n}){const r=e.elevationData!==n.elevationData;if(r){const{elevationData:o}=e,a=o&&(Array.isArray(o)||o.includes("{x}")&&o.includes("{y}"));this.setState({isTiled:a})}const i=r||e.meshMaxError!==n.meshMaxError||e.elevationDecoder!==n.elevationDecoder||e.bounds!==n.bounds;if(!this.state.isTiled&&i){const o=this.loadTerrain(e);this.setState({terrain:o})}e.workerUrl&&Or.removed("workerUrl","loadOptions.terrain.workerUrl")()}loadTerrain({elevationData:e,bounds:n,elevationDecoder:r,meshMaxError:i,signal:o}){var a;if(!e)return null;let s=this.getLoadOptions();s={...s,terrain:{skirtHeight:this.state.isTiled?i*2:0,...(a=s)===null||a===void 0?void 0:a.terrain,bounds:n,meshMaxError:i,elevationDecoder:r}};const{fetch:u}=this.props;return u(e,{propName:"elevationData",layer:this,loadOptions:s,signal:o})}getTiledTerrainData(e){const{elevationData:n,fetch:r,texture:i,elevationDecoder:o,meshMaxError:a}=this.props,{viewport:s}=this.context,u=mE(n,e),d=i&&mE(i,e),{signal:g}=e;let _=[0,0],E=[0,0];if(s.isGeospatial){const V=e.bbox;_=s.projectFlat([V.west,V.south]),E=s.projectFlat([V.east,V.north])}else{const V=e.bbox;_=[V.left,V.bottom],E=[V.right,V.top]}const P=[_[0],_[1],E[0],E[1]],O=this.loadTerrain({elevationData:u,bounds:P,elevationDecoder:o,meshMaxError:a,signal:g}),D=d?r(d,{propName:"texture",layer:this,loaders:[],signal:g}).catch(V=>null):Promise.resolve(null);return Promise.all([O,D])}renderSubLayers(e){const n=this.getSubLayerClass("mesh",x1),{color:r,wireframe:i,material:o}=this.props,{data:a}=e;if(!a)return null;const[s,u]=a;return new n(e,{data:VX,mesh:s,texture:u,_instanced:!1,coordinateSystem:Br.CARTESIAN,getPosition:d=>[0,0,0],getColor:r,wireframe:i,material:o})}onViewportLoad(e){if(!e)return;const{zRange:n}=this.state,r=e.map(a=>a.content).filter(Boolean).map(a=>a[0].header.boundingBox.map(u=>u[2]));if(r.length===0)return;const i=Math.min(...r.map(a=>a[0])),o=Math.max(...r.map(a=>a[1]));(!n||i<n[0]||o>n[1])&&this.setState({zRange:[i,o]})}renderLayers(){const{color:e,material:n,elevationData:r,texture:i,wireframe:o,meshMaxError:a,elevationDecoder:s,tileSize:u,maxZoom:d,minZoom:g,extent:_,maxRequests:E,onTileLoad:P,onTileUnload:O,onTileError:D,maxCacheSize:V,maxCacheByteSize:k,refinementStrategy:F}=this.props;if(this.state.isTiled)return new X1(this.getSubLayerProps({id:"tiles"}),{getTileData:this.getTiledTerrainData.bind(this),renderSubLayers:this.renderSubLayers.bind(this),updateTriggers:{getTileData:{elevationData:$X(r),texture:$X(i),meshMaxError:a,elevationDecoder:s}},onViewportLoad:this.onViewportLoad.bind(this),zRange:this.state.zRange||null,tileSize:u,maxZoom:d,minZoom:g,extent:_,maxRequests:E,onTileLoad:P,onTileUnload:O,onTileError:D,maxCacheSize:V,maxCacheByteSize:k,refinementStrategy:F});const z=this.getSubLayerClass("mesh",x1);return new z(this.getSubLayerProps({id:"mesh"}),{data:VX,mesh:this.state.terrain,texture:i,_instanced:!1,getPosition:X=>[0,0,0],getColor:e,material:n,wireframe:o})}}q(BU,"defaultProps",_We);q(BU,"layerName","TerrainLayer");const yWe={clipBounds:[0,0,1,1],clipByInstance:void 0},dae=`
uniform vec4 clip_bounds;

bool clip_isInBounds(vec2 position) {
  return position.x >= clip_bounds[0] && position.y >= clip_bounds[1] && position.x < clip_bounds[2] && position.y < clip_bounds[3];
}
`,vWe={name:"clip-vs",vs:dae},xWe={"vs:#decl":`
varying float clip_isVisible;
`,"vs:DECKGL_FILTER_GL_POSITION":`
  clip_isVisible = float(clip_isInBounds(geometry.worldPosition.xy));
`,"fs:#decl":`
varying float clip_isVisible;
`,"fs:DECKGL_FILTER_COLOR":`
  if (clip_isVisible < 0.5) discard;
`},bWe={name:"clip-fs",fs:dae},wWe={"vs:#decl":`
varying vec2 clip_commonPosition;
`,"vs:DECKGL_FILTER_GL_POSITION":`
  clip_commonPosition = geometry.position.xy;
`,"fs:#decl":`
varying vec2 clip_commonPosition;
`,"fs:DECKGL_FILTER_COLOR":`
  if (!clip_isInBounds(clip_commonPosition)) discard;
`};class NU extends JO{getShaders(){let e="instancePositions"in this.getAttributeManager().attributes;return this.props.clipByInstance!==void 0&&(e=!!this.props.clipByInstance),this.state.clipByInstance=e,e?{modules:[vWe],inject:xWe}:{modules:[bWe],inject:wWe}}draw({uniforms:e}){const{clipBounds:n}=this.props;if(this.state.clipByInstance)e.clip_bounds=n;else{const r=this.projectPosition([n[0],n[1],0]),i=this.projectPosition([n[2],n[3],0]);e.clip_bounds=[Math.min(r[0],i[0]),Math.min(r[1],i[1]),Math.max(r[0],i[0]),Math.max(r[1],i[1])]}}}q(NU,"defaultProps",yWe);q(NU,"extensionName","ClipExtension");function EWe(t,e,n){const r=SWe(t),i=Object.keys(r).filter(o=>r[o]!==Array);return TWe(t,{propArrayTypes:r,...e},{numericPropKeys:n&&n.numericPropKeys||i,PositionDataType:n?n.PositionDataType:Float32Array,triangulate:n?n.triangulate:!0})}function SWe(t){const e={};for(const n of t)if(n.properties)for(const r in n.properties){const i=n.properties[r];e[r]=RWe(i,e[r])}return e}function TWe(t,e,n){const{pointPositionsCount:r,pointFeaturesCount:i,linePositionsCount:o,linePathsCount:a,lineFeaturesCount:s,polygonPositionsCount:u,polygonObjectsCount:d,polygonRingsCount:g,polygonFeaturesCount:_,propArrayTypes:E,coordLength:P}=e,{numericPropKeys:O=[],PositionDataType:D=Float32Array,triangulate:V=!0}=n,k=t[0]&&"id"in t[0],F=t.length>65535?Uint32Array:Uint16Array,z={type:"Point",positions:new D(r*P),globalFeatureIds:new F(r),featureIds:i>65535?new Uint32Array(r):new Uint16Array(r),numericProps:{},properties:[],fields:[]},X={type:"LineString",pathIndices:o>65535?new Uint32Array(a+1):new Uint16Array(a+1),positions:new D(o*P),globalFeatureIds:new F(o),featureIds:s>65535?new Uint32Array(o):new Uint16Array(o),numericProps:{},properties:[],fields:[]},Y={type:"Polygon",polygonIndices:u>65535?new Uint32Array(d+1):new Uint16Array(d+1),primitivePolygonIndices:u>65535?new Uint32Array(g+1):new Uint16Array(g+1),positions:new D(u*P),globalFeatureIds:new F(u),featureIds:_>65535?new Uint32Array(u):new Uint16Array(u),numericProps:{},properties:[],fields:[]};V&&(Y.triangles=[]);for(const re of[z,X,Y])for(const ue of O){const ie=E[ue];re.numericProps[ue]=new ie(re.positions.length/P)}X.pathIndices[a]=o,Y.polygonIndices[d]=u,Y.primitivePolygonIndices[g]=u;const J={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const re of t){const ue=re.geometry,ie=re.properties||{};switch(ue.type){case"Point":CWe(ue,z,J,P,ie),z.properties.push(rN(ie,O)),k&&z.fields.push({id:re.id}),J.pointFeature++;break;case"LineString":PWe(ue,X,J,P,ie),X.properties.push(rN(ie,O)),k&&X.fields.push({id:re.id}),J.lineFeature++;break;case"Polygon":IWe(ue,Y,J,P,ie),Y.properties.push(rN(ie,O)),k&&Y.fields.push({id:re.id}),J.polygonFeature++;break;default:throw new Error("Invalid geometry type")}J.feature++}return OWe(z,X,Y,P)}function CWe(t,e,n,r,i){e.positions.set(t.data,n.pointPosition*r);const o=t.data.length/r;FU(e,i,n.pointPosition,o),e.globalFeatureIds.fill(n.feature,n.pointPosition,n.pointPosition+o),e.featureIds.fill(n.pointFeature,n.pointPosition,n.pointPosition+o),n.pointPosition+=o}function PWe(t,e,n,r,i){e.positions.set(t.data,n.linePosition*r);const o=t.data.length/r;FU(e,i,n.linePosition,o),e.globalFeatureIds.fill(n.feature,n.linePosition,n.linePosition+o),e.featureIds.fill(n.lineFeature,n.linePosition,n.linePosition+o);for(let a=0,s=t.indices.length;a<s;++a){const u=t.indices[a],d=a===s-1?t.data.length:t.indices[a+1];e.pathIndices[n.linePath++]=n.linePosition,n.linePosition+=(d-u)/r}}function IWe(t,e,n,r,i){e.positions.set(t.data,n.polygonPosition*r);const o=t.data.length/r;FU(e,i,n.polygonPosition,o),e.globalFeatureIds.fill(n.feature,n.polygonPosition,n.polygonPosition+o),e.featureIds.fill(n.polygonFeature,n.polygonPosition,n.polygonPosition+o);for(let a=0,s=t.indices.length;a<s;++a){const u=n.polygonPosition;e.polygonIndices[n.polygonObject++]=u;const d=t.areas[a],g=t.indices[a],_=t.indices[a+1];for(let P=0,O=g.length;P<O;++P){const D=g[P],V=P===O-1?_===void 0?t.data.length:_[0]:g[P+1];e.primitivePolygonIndices[n.polygonRing++]=n.polygonPosition,n.polygonPosition+=(V-D)/r}const E=n.polygonPosition;MWe(e,d,g,{startPosition:u,endPosition:E,coordLength:r})}}function MWe(t,e,n,r){let{startPosition:i,endPosition:o,coordLength:a}=r;if(!t.triangles)return;const s=i*a,u=o*a,d=t.positions.subarray(s,u),g=n[0],_=n.slice(1).map(P=>(P-g)/a),E=pze(d,_,a,e);for(let P=0,O=E.length;P<O;++P)t.triangles.push(i+E[P])}function nN(t,e){const n={};for(const r in t)n[r]={value:t[r],size:e};return n}function OWe(t,e,n,r){const i={points:{...t,positions:{value:t.positions,size:r},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:nN(t.numericProps,1)},lines:{...e,positions:{value:e.positions,size:r},pathIndices:{value:e.pathIndices,size:1},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:nN(e.numericProps,1)},polygons:{...n,positions:{value:n.positions,size:r},polygonIndices:{value:n.polygonIndices,size:1},primitivePolygonIndices:{value:n.primitivePolygonIndices,size:1},globalFeatureIds:{value:n.globalFeatureIds,size:1},featureIds:{value:n.featureIds,size:1},numericProps:nN(n.numericProps,1)}};return n.triangles&&(i.polygons.triangles={value:new Uint32Array(n.triangles),size:1}),i}function FU(t,e,n,r){for(const i in t.numericProps)if(i in e){const o=e[i];t.numericProps[i].fill(o,n,n+r)}}function rN(t,e){const n={};for(const r in t)e.includes(r)||(n[r]=t[r]);return n}function RWe(t,e){return e===Array||!Number.isFinite(t)?Array:e===Float64Array||Math.fround(t)!==t?Float64Array:Float32Array}function HX(t,e){const n=e==null?void 0:e.globalFeatureId;return n!==void 0?LWe(t,n):DWe(t,e==null?void 0:e.type)}function LWe(t,e){const n=pae(t);for(const r of n){let i=0,o=r.featureIds.value[0];for(let a=0;a<r.featureIds.value.length;a++){const s=r.featureIds.value[a];if(s!==o){if(e===r.globalFeatureIds.value[i])return dM(r,i,a);i=a,o=s}}if(e===r.globalFeatureIds.value[i])return dM(r,i,r.featureIds.value.length)}throw new Error("featureId:".concat(e," not found"))}function DWe(t,e){const n=pae(t,e);return NWe(n)}function BWe(t,e,n){switch(t.type){case"Point":return UWe(t,e,n);case"LineString":return zWe(t,e,n);case"Polygon":return gae(t,e,n);default:const r=t;throw new Error("Unsupported geometry type: ".concat(r==null?void 0:r.type))}}function pae(t,e){if(!!!(t.points||t.lines||t.polygons))return t.type=e||GWe(t),[t];const r=[];return t.points&&(t.points.type="Point",r.push(t.points)),t.lines&&(t.lines.type="LineString",r.push(t.lines)),t.polygons&&(t.polygons.type="Polygon",r.push(t.polygons)),r}function NWe(t){const e=[];for(const n of t){if(n.featureIds.value.length===0)continue;let r=0,i=n.featureIds.value[0];for(let o=0;o<n.featureIds.value.length;o++){const a=n.featureIds.value[o];a!==i&&(e.push(dM(n,r,o)),r=o,i=a)}e.push(dM(n,r,n.featureIds.value.length))}return e}function dM(t,e,n){const r=BWe(t,e,n),i=kWe(t,e,n),o=FWe(t,e,n);return{type:"Feature",geometry:r,properties:i,...o}}function FWe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.fields&&t.fields[t.featureIds.value[e]]}function kWe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=Object.assign({},t.properties[t.featureIds.value[e]]);for(const r in t.numericProps)n[r]=t.numericProps[r].value[e];return n}function gae(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1/0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1/0;const{positions:r}=t,i=t.polygonIndices.value.filter(u=>u>=e&&u<=n),o=t.primitivePolygonIndices.value.filter(u=>u>=e&&u<=n);if(!(i.length>2)){const u=[];for(let d=0;d<o.length-1;d++){const g=o[d],_=o[d+1],E=pM(r,g,_);u.push(E)}return{type:"Polygon",coordinates:u}}const s=[];for(let u=0;u<i.length-1;u++){const d=i[u],g=i[u+1],_=gae(t,d,g).coordinates;s.push(_)}return{type:"MultiPolygon",coordinates:s}}function zWe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1/0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1/0;const{positions:r}=t,i=t.pathIndices.value.filter(s=>s>=e&&s<=n);if(!(i.length>2))return{type:"LineString",coordinates:pM(r,i[0],i[1])};const a=[];for(let s=0;s<i.length-1;s++){const u=pM(r,i[s],i[s+1]);a.push(u)}return{type:"MultiLineString",coordinates:a}}function UWe(t,e,n){const{positions:r}=t,i=pM(r,e,n);return i.length>1?{type:"MultiPoint",coordinates:i}:{type:"Point",coordinates:i[0]}}function pM(t,e,n){e=e||0,n=n||t.value.length/t.size;const r=[];for(let i=e;i<n;i++){const o=Array();for(let a=i*t.size;a<(i+1)*t.size;a++)o.push(Number(t.value[a]));r.push(o)}return r}function GWe(t){return t.pathIndices?"LineString":t.polygonIndices?"Polygon":"Point"}var kU={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */kU.read=function(t,e,n,r,i){var o,a,s=i*8-r-1,u=(1<<s)-1,d=u>>1,g=-7,_=n?i-1:0,E=n?-1:1,P=t[e+_];for(_+=E,o=P&(1<<-g)-1,P>>=-g,g+=s;g>0;o=o*256+t[e+_],_+=E,g-=8);for(a=o&(1<<-g)-1,o>>=-g,g+=r;g>0;a=a*256+t[e+_],_+=E,g-=8);if(o===0)o=1-d;else{if(o===u)return a?NaN:(P?-1:1)*(1/0);a=a+Math.pow(2,r),o=o-d}return(P?-1:1)*a*Math.pow(2,o-r)};kU.write=function(t,e,n,r,i,o){var a,s,u,d=o*8-i-1,g=(1<<d)-1,_=g>>1,E=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=r?0:o-1,O=r?1:-1,D=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=g):(a=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-a))<1&&(a--,u*=2),a+_>=1?e+=E/u:e+=E*Math.pow(2,1-_),e*u>=2&&(a++,u/=2),a+_>=g?(s=0,a=g):a+_>=1?(s=(e*u-1)*Math.pow(2,i),a=a+_):(s=e*Math.pow(2,_-1)*Math.pow(2,i),a=0));i>=8;t[n+P]=s&255,P+=O,s/=256,i-=8);for(a=a<<i|s,d+=i;d>0;t[n+P]=a&255,P+=O,a/=256,d-=8);t[n+P-O]|=D*128};var jWe=zi,xT=kU;function zi(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}zi.Varint=0;zi.Fixed64=1;zi.Bytes=2;zi.Fixed32=5;var $4=65536*65536,WX=1/$4,VWe=12,mae=typeof TextDecoder>"u"?null:new TextDecoder("utf8");zi.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var r=this.readVarint(),i=r>>3,o=this.pos;this.type=r&7,t(i,e,this),this.pos===o&&this.skip(r)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=bT(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=XX(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=bT(this.buf,this.pos)+bT(this.buf,this.pos+4)*$4;return this.pos+=8,t},readSFixed64:function(){var t=bT(this.buf,this.pos)+XX(this.buf,this.pos+4)*$4;return this.pos+=8,t},readFloat:function(){var t=xT.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=xT.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e=this.buf,n,r;return r=e[this.pos++],n=r&127,r<128||(r=e[this.pos++],n|=(r&127)<<7,r<128)||(r=e[this.pos++],n|=(r&127)<<14,r<128)||(r=e[this.pos++],n|=(r&127)<<21,r<128)?n:(r=e[this.pos],n|=(r&15)<<28,$We(n,t,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2===1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=VWe&&mae?iqe(this.buf,e,t):rqe(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==zi.Bytes)return t.push(this.readVarint(e));var n=Up(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==zi.Bytes)return t.push(this.readSVarint());var e=Up(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==zi.Bytes)return t.push(this.readBoolean());var e=Up(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==zi.Bytes)return t.push(this.readFloat());var e=Up(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==zi.Bytes)return t.push(this.readDouble());var e=Up(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==zi.Bytes)return t.push(this.readFixed32());var e=Up(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==zi.Bytes)return t.push(this.readSFixed32());var e=Up(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==zi.Bytes)return t.push(this.readFixed64());var e=Up(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==zi.Bytes)return t.push(this.readSFixed64());var e=Up(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=t&7;if(e===zi.Varint)for(;this.buf[this.pos++]>127;);else if(e===zi.Bytes)this.pos=this.readVarint()+this.pos;else if(e===zi.Fixed32)this.pos+=4;else if(e===zi.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+e)},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Ly(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Ly(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Ly(this.buf,t&-1,this.pos),Ly(this.buf,Math.floor(t*WX),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Ly(this.buf,t&-1,this.pos),Ly(this.buf,Math.floor(t*WX),this.pos+4),this.pos+=8},writeVarint:function(t){if(t=+t||0,t>268435455||t<0){HWe(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))},writeSVarint:function(t){this.writeVarint(t<0?-t*2-1:t*2)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(t.length*4),this.pos++;var e=this.pos;this.pos=oqe(this.buf,t,this.pos);var n=this.pos-e;n>=128&&qX(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),xT.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),xT.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var r=this.pos-n;r>=128&&qX(n,r,this),this.pos=n-1,this.writeVarint(r),this.pos+=r},writeMessage:function(t,e,n){this.writeTag(t,zi.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,XWe,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,ZWe,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,KWe,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,YWe,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,QWe,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,JWe,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,eqe,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,tqe,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,nqe,e)},writeBytesField:function(t,e){this.writeTag(t,zi.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,zi.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,zi.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,zi.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,zi.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,zi.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,zi.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,zi.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,zi.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,zi.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};function $We(t,e,n){var r=n.buf,i,o;if(o=r[n.pos++],i=(o&112)>>4,o<128||(o=r[n.pos++],i|=(o&127)<<3,o<128)||(o=r[n.pos++],i|=(o&127)<<10,o<128)||(o=r[n.pos++],i|=(o&127)<<17,o<128)||(o=r[n.pos++],i|=(o&127)<<24,o<128)||(o=r[n.pos++],i|=(o&1)<<31,o<128))return Ry(t,i,e);throw new Error("Expected varint not more than 10 bytes")}function Up(t){return t.type===zi.Bytes?t.readVarint()+t.pos:t.pos+1}function Ry(t,e,n){return n?e*4294967296+(t>>>0):(e>>>0)*4294967296+(t>>>0)}function HWe(t,e){var n,r;if(t>=0?(n=t%4294967296|0,r=t/4294967296|0):(n=~(-t%4294967296),r=~(-t/4294967296),n^4294967295?n=n+1|0:(n=0,r=r+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");e.realloc(10),WWe(n,r,e),qWe(r,e)}function WWe(t,e,n){n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos++]=t&127|128,t>>>=7,n.buf[n.pos]=t&127}function qWe(t,e){var n=(t&7)<<4;e.buf[e.pos++]|=n|((t>>>=3)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127|((t>>>=7)?128:0),t&&(e.buf[e.pos++]=t&127)))))}function qX(t,e,n){var r=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(Math.LN2*7));n.realloc(r);for(var i=n.pos-1;i>=t;i--)n.buf[i+r]=n.buf[i]}function XWe(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function ZWe(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function YWe(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function QWe(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function KWe(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function JWe(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function eqe(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function tqe(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function nqe(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function bT(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+t[e+3]*16777216}function Ly(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function XX(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function rqe(t,e,n){for(var r="",i=e;i<n;){var o=t[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s>n)break;var u,d,g;s===1?o<128&&(a=o):s===2?(u=t[i+1],(u&192)===128&&(a=(o&31)<<6|u&63,a<=127&&(a=null))):s===3?(u=t[i+1],d=t[i+2],(u&192)===128&&(d&192)===128&&(a=(o&15)<<12|(u&63)<<6|d&63,(a<=2047||a>=55296&&a<=57343)&&(a=null))):s===4&&(u=t[i+1],d=t[i+2],g=t[i+3],(u&192)===128&&(d&192)===128&&(g&192)===128&&(a=(o&15)<<18|(u&63)<<12|(d&63)<<6|g&63,(a<=65535||a>=1114112)&&(a=null))),a===null?(a=65533,s=1):a>65535&&(a-=65536,r+=String.fromCharCode(a>>>10&1023|55296),a=56320|a&1023),r+=String.fromCharCode(a),i+=s}return r}function iqe(t,e,n){return mae.decode(t.subarray(e,n))}function oqe(t,e,n){for(var r=0,i,o;r<e.length;r++){if(i=e.charCodeAt(r),i>55295&&i<57344)if(o)if(i<56320){t[n++]=239,t[n++]=191,t[n++]=189,o=i;continue}else i=o-55296<<10|i-56320|65536,o=null;else{i>56319||r+1===e.length?(t[n++]=239,t[n++]=191,t[n++]=189):o=i;continue}else o&&(t[n++]=239,t[n++]=191,t[n++]=189,o=null);i<128?t[n++]=i:(i<2048?t[n++]=i>>6|192:(i<65536?t[n++]=i>>12|224:(t[n++]=i>>18|240,t[n++]=i>>12&63|128),t[n++]=i>>6&63|128),t[n++]=i&63|128)}return n}const Aae=_A(jWe);function sqe(t){const e=t.length;if(e<=1)return[t];const n=[];let r,i;for(let o=0;o<e;o++){const a=aqe(t[o]);a!==0&&(i===void 0&&(i=a<0),i===a<0?(r&&n.push(r),r=[t[o]]):r&&r.push(t[o]))}return r&&n.push(r),n}function aqe(t){let e=0;for(let n=0,r=t.length-1,i,o;n<t.length;r=n++)i=t[n],o=t[r],e+=(o[0]-i[0])*(i[1]+o[1]);return e}function lqe(t,e,n){e&&n&&(t===1?e.id=n.readVarint():t===2?uqe(n,e):t===3?e.type=n.readVarint():t===4&&(e._geometry=n.pos))}function uqe(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}let cqe=class _ae{static get types(){return["Unknown","Point","LineString","Polygon"]}constructor(e,n,r,i,o){q(this,"properties",void 0),q(this,"extent",void 0),q(this,"type",void 0),q(this,"id",void 0),q(this,"_pbf",void 0),q(this,"_geometry",void 0),q(this,"_keys",void 0),q(this,"_values",void 0),this.properties={},this.extent=r,this.type=0,this.id=null,this._pbf=e,this._geometry=-1,this._keys=i,this._values=o,e.readFields(lqe,this,n)}loadGeometry(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos;let r=1,i=0,o=0,a=0;const s=[];let u;for(;e.pos<n;){if(i<=0){const d=e.readVarint();r=d&7,i=d>>3}if(i--,r===1||r===2)o+=e.readSVarint(),a+=e.readSVarint(),r===1&&(u&&s.push(u),u=[]),u&&u.push([o,a]);else if(r===7)u&&u.push(u[0].slice());else throw new Error("unknown command ".concat(r))}return u&&s.push(u),s}bbox(){const e=this._pbf;e.pos=this._geometry;const n=e.readVarint()+e.pos;let r=1,i=0,o=0,a=0,s=1/0,u=-1/0,d=1/0,g=-1/0;for(;e.pos<n;){if(i<=0){const _=e.readVarint();r=_&7,i=_>>3}if(i--,r===1||r===2)o+=e.readSVarint(),a+=e.readSVarint(),o<s&&(s=o),o>u&&(u=o),a<d&&(d=a),a>g&&(g=a);else if(r!==7)throw new Error("unknown command ".concat(r))}return[s,d,u,g]}_toGeoJSON(e){let n=this.loadGeometry(),r=_ae.types[this.type],i,o;switch(this.type){case 1:const s=[];for(i=0;i<n.length;i++)s[i]=n[i][0];n=s,e(n,this);break;case 2:for(i=0;i<n.length;i++)e(n[i],this);break;case 3:for(n=sqe(n),i=0;i<n.length;i++)for(o=0;o<n[i].length;o++)e(n[i][o],this);break}n.length===1?n=n[0]:r="Multi".concat(r);const a={type:"Feature",geometry:{type:r,coordinates:n},properties:this.properties};return this.id!==null&&(a.id=this.id),a}toGeoJSON(e){if(typeof e=="function")return this._toGeoJSON(e);const{x:n,y:r,z:i}=e,o=this.extent*Math.pow(2,i),a=this.extent*n,s=this.extent*r;function u(d){for(let g=0;g<d.length;g++){const _=d[g];_[0]=(_[0]+a)*360/o-180;const E=180-(_[1]+s)*360/o;_[1]=360/Math.PI*Math.atan(Math.exp(E*Math.PI/180))-90}}return this._toGeoJSON(u)}},fqe=class{constructor(e,n){q(this,"version",void 0),q(this,"name",void 0),q(this,"extent",void 0),q(this,"length",void 0),q(this,"_pbf",void 0),q(this,"_keys",void 0),q(this,"_values",void 0),q(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(hqe,this,n),this.length=this._features.length}feature(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const n=this._pbf.readVarint()+this._pbf.pos;return new cqe(this._pbf,n,this.extent,this._keys,this._values)}};function hqe(t,e,n){e&&n&&(t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(dqe(n)))}function dqe(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const r=t.readVarint()>>3;e=r===1?t.readString():r===2?t.readFloat():r===3?t.readDouble():r===4?t.readVarint64():r===5?t.readVarint():r===6?t.readSVarint():r===7?t.readBoolean():null}return e}let pqe=class{constructor(e,n){q(this,"layers",void 0),this.layers=e.readFields(gqe,{},n)}};function gqe(t,e,n){if(t===3&&n){const r=new fqe(n,n.readVarint()+n.pos);r.length&&e&&(e[r.name]=r)}}function mqe(t){const e=t.indices.length,n="Polygon";if(e<=1)return{type:n,data:t.data,areas:[[iM(t.data)]],indices:[t.indices]};const r=[],i=[];let o=[],a=[],s,u=0;for(let d,g=0,_;g<e;g++){_=t.indices[g]-u,d=t.indices[g+1]-u||t.data.length;const E=t.data.slice(_,d),P=iM(E);if(P===0){const O=t.data.slice(0,_),D=t.data.slice(d);t.data=O.concat(D),u+=d-_;continue}s===void 0&&(s=P<0),s===P<0?(a.length&&(r.push(o),i.push(a)),a=[_],o=[P]):(o.push(P),a.push(_))}return o&&r.push(o),a.length&&i.push(a),{type:n,areas:r,indices:i,data:t.data}}function Aqe(t,e,n,r){for(let i=0,o=t.length;i<o;i+=2){t[i]=(t[i]+e)*360/r-180;const a=180-(t[i+1]+n)*360/r;t[i+1]=360/Math.PI*Math.atan(Math.exp(a*Math.PI/180))-90}}function _qe(t,e,n){e&&n&&(t===1?e.id=n.readVarint():t===2?yqe(n,e):t===3?e.type=n.readVarint():t===4&&(e._geometry=n.pos))}function yqe(t,e){const n=t.readVarint()+t.pos;for(;t.pos<n;){const r=e._keys[t.readVarint()],i=e._values[t.readVarint()];e.properties[r]=i}}let ZX,d0,iN,wT,oN,sN,Lb;class vqe{constructor(e,n,r,i,o,a){q(this,"properties",void 0),q(this,"extent",void 0),q(this,"type",void 0),q(this,"id",void 0),q(this,"_pbf",void 0),q(this,"_geometry",void 0),q(this,"_keys",void 0),q(this,"_values",void 0),q(this,"_geometryInfo",void 0),this.properties={},this.extent=r,this.type=0,this.id=null,this._pbf=e,this._geometry=-1,this._keys=i,this._values=o,this._geometryInfo=a,e.readFields(_qe,this,n)}loadGeometry(){const e=this._pbf;e.pos=this._geometry,ZX=e.readVarint()+e.pos,d0=1,wT=0,oN=0,sN=0,Lb=0;const n=[],r=[];for(;e.pos<ZX;)if(wT<=0&&(iN=e.readVarint(),d0=iN&7,wT=iN>>3),wT--,d0===1||d0===2)oN+=e.readSVarint(),sN+=e.readSVarint(),d0===1&&n.push(Lb),r.push(oN,sN),Lb+=2;else if(d0===7){if(Lb>0){const i=n[n.length-1];r.push(r[i],r[i+1]),Lb+=2}}else throw new Error("unknown command ".concat(d0));return{data:r,indices:n}}_toBinaryCoordinates(e){const n=this.loadGeometry();let r;e(n.data,this);const i=2;switch(this.type){case 1:this._geometryInfo.pointFeaturesCount++,this._geometryInfo.pointPositionsCount+=n.indices.length,r={type:"Point",...n};break;case 2:this._geometryInfo.lineFeaturesCount++,this._geometryInfo.linePathsCount+=n.indices.length,this._geometryInfo.linePositionsCount+=n.data.length/i,r={type:"LineString",...n};break;case 3:r=mqe(n),this._geometryInfo.polygonFeaturesCount++,this._geometryInfo.polygonObjectsCount+=r.indices.length;for(const a of r.indices)this._geometryInfo.polygonRingsCount+=a.length;this._geometryInfo.polygonPositionsCount+=r.data.length/i;break;default:throw new Error("Invalid geometry type: ".concat(this.type))}const o={type:"Feature",geometry:r,properties:this.properties};return this.id!==null&&(o.id=this.id),o}toBinaryCoordinates(e){if(typeof e=="function")return this._toBinaryCoordinates(e);const{x:n,y:r,z:i}=e,o=this.extent*Math.pow(2,i),a=this.extent*n,s=this.extent*r;return this._toBinaryCoordinates(u=>Aqe(u,a,s,o))}}class xqe{constructor(e,n){q(this,"version",void 0),q(this,"name",void 0),q(this,"extent",void 0),q(this,"length",void 0),q(this,"_pbf",void 0),q(this,"_keys",void 0),q(this,"_values",void 0),q(this,"_features",void 0),this.version=1,this.name="",this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(bqe,this,n),this.length=this._features.length}feature(e,n){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];const r=this._pbf.readVarint()+this._pbf.pos;return new vqe(this._pbf,r,this.extent,this._keys,this._values,n)}}function bqe(t,e,n){e&&n&&(t===15?e.version=n.readVarint():t===1?e.name=n.readString():t===5?e.extent=n.readVarint():t===2?e._features.push(n.pos):t===3?e._keys.push(n.readString()):t===4&&e._values.push(wqe(n)))}function wqe(t){let e=null;const n=t.readVarint()+t.pos;for(;t.pos<n;){const r=t.readVarint()>>3;e=r===1?t.readString():r===2?t.readFloat():r===3?t.readDouble():r===4?t.readVarint64():r===5?t.readVarint():r===6?t.readSVarint():r===7?t.readBoolean():null}return e}class Eqe{constructor(e,n){q(this,"layers",void 0),this.layers=e.readFields(Sqe,{},n)}}function Sqe(t,e,n){if(t===3&&n){const r=new xqe(n,n.readVarint()+n.pos);r.length&&e&&(e[r.name]=r)}}function YX(t,e){var n,r;const i=Cqe(e),o=(e==null||(n=e.gis)===null||n===void 0?void 0:n.format)||(e==null||(r=e.mvt)===null||r===void 0?void 0:r.shape);switch(o){case"columnar-table":return{shape:"columnar-table",data:aN(t,i)};case"geojson-row-table":return{shape:"geojson-row-table",data:QX(t,i)};case"geojson":return QX(t,i);case"binary-geometry":return aN(t,i);case"binary":return aN(t,i);default:throw new Error(o)}}function aN(t,e){const[n,r]=Tqe(t,e),i=EWe(n,r);return i.byteLength=t.byteLength,i}function Tqe(t,e){const n=[],r={coordLength:2,pointPositionsCount:0,pointFeaturesCount:0,linePositionsCount:0,linePathsCount:0,lineFeaturesCount:0,polygonPositionsCount:0,polygonObjectsCount:0,polygonRingsCount:0,polygonFeaturesCount:0};if(t.byteLength<=0)return[n,r];const i=new Eqe(new Aae(t));return(e&&Array.isArray(e.layers)?e.layers:Object.keys(i.layers)).forEach(a=>{const s=i.layers[a];if(s)for(let u=0;u<s.length;u++){const d=s.feature(u,r),g=Iqe(d,e,a);n.push(g)}}),[n,r]}function QX(t,e){if(t.byteLength<=0)return[];const n=[],r=new pqe(new Aae(t));return(Array.isArray(e.layers)?e.layers:Object.keys(r.layers)).forEach(o=>{const a=r.layers[o];if(a)for(let s=0;s<a.length;s++){const u=a.feature(s),d=Pqe(u,e,o);n.push(d)}}),n}function Cqe(t){var e;if(!(t!=null&&t.mvt))throw new Error("mvt options required");const n=((e=t.mvt)===null||e===void 0?void 0:e.coordinates)==="wgs84",{tileIndex:r}=t.mvt,i=r&&Number.isFinite(r.x)&&Number.isFinite(r.y)&&Number.isFinite(r.z);if(n&&!i)throw new Error("MVT Loader: WGS84 coordinates need tileIndex property");return t.mvt}function Pqe(t,e,n){const r=t.toGeoJSON(e.coordinates==="wgs84"?e.tileIndex:Mqe);return e.layerProperty&&(r.properties[e.layerProperty]=n),r}function Iqe(t,e,n){const r=t.toBinaryCoordinates(e.coordinates==="wgs84"?e.tileIndex:Oqe);return e.layerProperty&&r.properties&&(r.properties[e.layerProperty]=n),r}function Mqe(t,e){const{extent:n}=e;for(let r=0;r<t.length;r++){const i=t[r];i[0]/=n,i[1]/=n}}function Oqe(t,e){const{extent:n}=e;for(let r=0,i=t.length;r<i;++r)t[r]/=n}const Rqe="3.4.14",Lqe={mvt:{shape:"geojson",coordinates:"local",layerProperty:"layerName",layers:void 0,tileIndex:null}},yae={name:"Mapbox Vector Tile",id:"mvt",module:"mvt",version:Rqe,extensions:["mvt","pbf"],mimeTypes:["application/vnd.mapbox-vector-tile","application/x-protobuf"],worker:!0,category:"geometry",options:Lqe};({...yae});const Dqe={Point:vae,MultiPoint:Bqe,LineString:xae,MultiLineString:Nqe,Polygon:bae,MultiPolygon:Fqe};function vae([t,e],[n,r],i){const o=pc(n[0],r[0],t),a=pc(n[1],r[1],e);return i.unprojectFlat([o,a])}function zU(t,e,n){return t.map(r=>vae(r,e,n))}function Bqe(t,e,n){return zU(t,e,n)}function xae(t,e,n){return zU(t,e,n)}function Nqe(t,e,n){return t.map(r=>xae(r,e,n))}function bae(t,e,n){return t.map(r=>zU(r,e,n))}function Fqe(t,e,n){return t.map(r=>bae(r,e,n))}function kqe(t,e,n){const r=n.projectFlat([e.west,e.north]),i=n.projectFlat([e.east,e.south]),o=[r,i];return{...t,coordinates:Dqe[t.type](t.coordinates,o,n)}}const zqe=["points","lines","polygons"];function Uqe(t,e,n,r){for(const i of zqe){const o=t[i]&&Gqe(t[i],e,n,r);if(o>=0)return o}return-1}function Gqe(t,e,n,r){const i=t.featureIds.value;if(!i.length)return-1;let o=0,a=i[i.length-1]+1;if(r){const u=jqe(t,r);if(u)o=u[0],a=u[1]+1;else return-1}let s=-1;if(e in t.numericProps){const u=t.numericProps[e].value.findIndex((d,g)=>d===n&&i[g]>=o&&i[g]<a);return u>=0?t.globalFeatureIds.value[u]:-1}else e?s=KX(t.properties,u=>u[e]===n,o,a):t.fields&&(s=KX(t.fields,u=>u.id===n,o,a));return s>=0?Vqe(t,s):-1}function jqe(t,e){if(!t.__layers){const n={},{properties:r}=t;for(let i=0;i<r.length;i++){const{layerName:o}=r[i];o&&(n[o]?n[o][1]=i:n[o]=[i,i])}t.__layers=n}return t.__layers[e]}function Vqe(t,e){if(!t.__ids){const n=[],r=t.featureIds.value,i=t.globalFeatureIds.value;for(let o=0;o<r.length;o++)n[r[o]]=i[o];t.__ids=n}return t.__ids[e]}function KX(t,e,n,r){for(let i=n;i<r;i++)if(e(t[i],i))return i;return-1}const lN=512,$qe={...q1.defaultProps,data:lM,onDataLoad:{type:"function",value:null,optional:!0,compare:!1},uniqueIdProperty:"",highlightedFeatureId:null,loaders:[yae],binary:!0};class UU extends X1{initializeState(){super.initializeState();const e=this.context.viewport.resolution!==void 0?!1:this.props.binary;this.setState({binary:e,data:null,tileJSON:null})}get isLoaded(){return this.state&&this.state.data&&this.state.tileset&&super.isLoaded}updateState({props:e,oldProps:n,context:r,changeFlags:i}){var o;i.dataChanged&&this._updateTileData(),(o=this.state)!==null&&o!==void 0&&o.data&&(super.updateState({props:e,oldProps:n,context:r,changeFlags:i}),this._setWGS84PropertyForTiles());const{highlightColor:a}=e;a!==n.highlightColor&&Array.isArray(a)&&this.setState({highlightColor:a})}async _updateTileData(){let e=this.props.data,n=null;if(typeof e=="string"&&!aGe(e)){const{onDataLoad:r,fetch:i}=this.props;this.setState({data:null,tileJSON:null});try{n=await i(e,{propName:"data",layer:this,loaders:[]})}catch(o){this.raiseError(o,"loading TileJSON"),e=null}r&&r(n,{propName:"data",layer:this})}else e.tilejson&&(n=e);n&&(e=n.tiles),this.setState({data:e,tileJSON:n})}_getTilesetOptions(){const e=super._getTilesetOptions(),n=this.state.tileJSON,{minZoom:r,maxZoom:i}=this.props;return n&&(Number.isFinite(n.minzoom)&&n.minzoom>r&&(e.minZoom=n.minzoom),Number.isFinite(n.maxzoom)&&(!Number.isFinite(i)||n.maxzoom<i)&&(e.maxZoom=n.maxzoom)),e}renderLayers(){var e;return(e=this.state)!==null&&e!==void 0&&e.data?super.renderLayers():null}getTileData(e){var n;const{data:r,binary:i}=this.state,{index:o,signal:a}=e,s=mE(r,e);if(!s)return Promise.reject("Invalid URL");let u=this.getLoadOptions();const{fetch:d}=this.props;return u={...u,mimeType:"application/x-protobuf",mvt:{...(n=u)===null||n===void 0?void 0:n.mvt,coordinates:this.context.viewport.resolution?"wgs84":"local",tileIndex:o},gis:i?{format:"binary"}:{}},d(s,{propName:"data",layer:this,loadOptions:u,signal:a})}renderSubLayers(e){const{x:n,y:r,z:i}=e.tile.index,o=Math.pow(2,i),a=lN/o,s=-a,u=lN*n/o,d=lN*(1-r/o),g=new vr().scale([a,s,1]);e.autoHighlight=!1,this.context.viewport.resolution||(e.modelMatrix=g,e.coordinateOrigin=[u,d,0],e.coordinateSystem=Br.CARTESIAN,e.extensions=[...e.extensions||[],new NU]);const _=super.renderSubLayers(e);return this.state.binary&&!(_ instanceof q1)&&Or.warn("renderSubLayers() must return GeoJsonLayer when using binary:true")(),_}_updateAutoHighlight(e){const{uniqueIdProperty:n}=this.props,{hoveredFeatureId:r,hoveredFeatureLayerName:i}=this.state,o=e.object;let a,s;o&&(a=uN(o,n),s=JX(o));let{highlightColor:u}=this.props;typeof u=="function"&&(u=u(e)),(r!==a||i!==s)&&this.setState({highlightColor:u,hoveredFeatureId:a,hoveredFeatureLayerName:s})}getPickingInfo(e){const n=super.getPickingInfo(e),r=!!this.context.viewport.resolution;if(this.state.binary&&n.index!==-1){const{data:i}=e.sourceLayer.props;n.object=HX(i,{globalFeatureId:n.index})}return n.object&&!r&&(n.object=tZ(n.object,n.tile.bbox,this.context.viewport)),n}getSubLayerPropsByTile(e){return{highlightedObjectIndex:this.getHighlightedObjectIndex(e),highlightColor:this.state.highlightColor}}getHighlightedObjectIndex(e){const{hoveredFeatureId:n,hoveredFeatureLayerName:r,binary:i}=this.state,{uniqueIdProperty:o,highlightedFeatureId:a}=this.props,s=e.content,u=eZ(a);if(!(eZ(n)||u))return-1;const g=u?a:n;return Array.isArray(s)?s.findIndex(_=>{const E=uN(_,o)===g,P=u||JX(_)===r;return E&&P}):s&&i?Uqe(s,o,g,u?"":r):-1}_pickObjects(e){const{deck:n,viewport:r}=this.context,i=r.width,o=r.height,a=r.x,s=r.y,u=[this.id];return n.pickObjects({x:a,y:s,width:i,height:o,layerIds:u,maxObjects:e})}getRenderedFeatures(e=null){const n=this._pickObjects(e),r=new Set,i=[];for(const o of n){const a=uN(o.object,this.props.uniqueIdProperty);a===void 0?i.push(o.object):r.has(a)||(r.add(a),i.push(o.object))}return i}_setWGS84PropertyForTiles(){const e="dataInWGS84";this.state.tileset.selectedTiles.forEach(r=>{r.hasOwnProperty(e)||Object.defineProperty(r,e,{get:()=>{if(!r.content)return null;if(this.state.binary&&Array.isArray(r.content)&&!r.content.length)return[];const{bbox:i}=r;if(r._contentWGS84===void 0&&lGe(i)){const o=this.state.binary?HX(r.content):r.content;r._contentWGS84=o.map(a=>tZ(a,i,this.context.viewport))}return r._contentWGS84}})})}}q(UU,"layerName","MVTLayer");q(UU,"defaultProps",$qe);function uN(t,e){if(t.properties&&e)return t.properties[e];if("id"in t)return t.id}function JX(t){var e;return((e=t.properties)===null||e===void 0?void 0:e.layerName)||null}function eZ(t){return t!=null&&t!==""}function tZ(t,e,n){const r={...t,geometry:{type:t.geometry.type}};return Object.defineProperty(r.geometry,"coordinates",{get:()=>kqe(t.geometry,e,n).coordinates}),r}const nZ="0123456789bcdefghjkmnpqrstuvwxyz",wae={};for(let t=0;t<nZ.length;t++)wae[nZ.charAt(t)]=t;const Hqe=-90,Wqe=90,qqe=-180,Xqe=180;function Zqe(t){let e=!0,n=Wqe,r=Hqe,i=Xqe,o=qqe,a,s=0;for(let u=0,d=t.length;u<d;u++){const g=t[u].toLowerCase();s=wae[g];for(let _=4;_>=0;_--){const E=s>>_&1;e?(a=(i+o)/2,E===1?o=a:i=a):(a=(n+r)/2,E===1?r=a:n=a),e=!e}}return[r,o,n,i]}function Yqe(t){const[e,n,r,i]=Zqe(t);return[i,r,i,e,n,e,n,r,i,r]}const Qqe={getGeohash:{type:"accessor",value:t=>t.geohash}};class GU extends w_{indexToBounds(){const{data:e,getGeohash:n}=this.props;return{data:e,_normalize:!1,positionFormat:"XY",getPolygon:(r,i)=>Yqe(n(r,i))}}}q(GU,"layerName","GeohashLayer");q(GU,"defaultProps",Qqe);const Kqe=Object.freeze(Object.defineProperty({__proto__:null,GeohashLayer:GU,GreatCircleLayer:lU,H3ClusterLayer:_U,H3HexagonLayer:E_,MVTLayer:UU,QuadkeyLayer:cU,S2Layer:uU,TerrainLayer:BU,Tile3DLayer:DU,TileLayer:X1,TripsLayer:gU,_GeoCellLayer:w_,_Tile2DHeader:qoe,_Tileset2D:Koe,_WMSLayer:aU,_getURLFromTemplate:mE},Symbol.toStringTag,{value:"Module"})),Jqe=ti(Kqe),eXe=ti(aje);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=Jqe,n=Hp,r=eXe,i=fA,o=s(XR),a=s(eU);function s(De){return De&&De.__esModule?De:{default:De}}function u(De){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?u=function(qe){return typeof qe}:u=function(qe){return qe&&typeof Symbol=="function"&&qe.constructor===Symbol&&qe!==Symbol.prototype?"symbol":typeof qe},u(De)}function d(De){return P(De)||E(De)||_(De)||g()}function g(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _(De,Re){if(De){if(typeof De=="string")return O(De,Re);var qe=Object.prototype.toString.call(De).slice(8,-1);if(qe==="Object"&&De.constructor&&(qe=De.constructor.name),qe==="Map"||qe==="Set")return Array.from(qe);if(qe==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(qe))return O(De,Re)}}function E(De){if(typeof Symbol<"u"&&Symbol.iterator in Object(De))return Array.from(De)}function P(De){if(Array.isArray(De))return O(De)}function O(De,Re){(Re==null||Re>De.length)&&(Re=De.length);for(var qe=0,ct=new Array(Re);qe<Re;qe++)ct[qe]=De[qe];return ct}function D(De,Re){if(!(De instanceof Re))throw new TypeError("Cannot call a class as a function")}function V(De,Re){for(var qe=0;qe<Re.length;qe++){var ct=Re[qe];ct.enumerable=ct.enumerable||!1,ct.configurable=!0,"value"in ct&&(ct.writable=!0),Object.defineProperty(De,ct.key,ct)}}function k(De,Re,qe){return Re&&V(De.prototype,Re),qe&&V(De,qe),De}function F(De,Re,qe){return typeof Reflect<"u"&&Reflect.get?F=Reflect.get:F=function(Ct,Dt,In){var Mn=z(Ct,Dt);if(Mn){var Tn=Object.getOwnPropertyDescriptor(Mn,Dt);return Tn.get?Tn.get.call(In):Tn.value}},F(De,Re,qe||De)}function z(De,Re){for(;!Object.prototype.hasOwnProperty.call(De,Re)&&(De=ue(De),De!==null););return De}function X(De){return function(){var Re=ue(De),qe;if(re()){var ct=ue(this).constructor;qe=Reflect.construct(Re,arguments,ct)}else qe=Re.apply(this,arguments);return Y(this,qe)}}function Y(De,Re){return Re&&(u(Re)==="object"||typeof Re=="function")?Re:J(De)}function J(De){if(De===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return De}function re(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function ue(De){return ue=Object.setPrototypeOf?Object.getPrototypeOf:function(qe){return qe.__proto__||Object.getPrototypeOf(qe)},ue(De)}function ie(De,Re){if(typeof Re!="function"&&Re!==null)throw new TypeError("Super expression must either be null or a function");De.prototype=Object.create(Re&&Re.prototype,{constructor:{value:De,writable:!0,configurable:!0}}),Re&&ce(De,Re)}function ce(De,Re){return ce=Object.setPrototypeOf||function(ct,Ct){return ct.__proto__=Ct,ct},ce(De,Re)}function se(De,Re){var qe=Object.keys(De);if(Object.getOwnPropertySymbols){var ct=Object.getOwnPropertySymbols(De);Re&&(ct=ct.filter(function(Ct){return Object.getOwnPropertyDescriptor(De,Ct).enumerable})),qe.push.apply(qe,ct)}return qe}function me(De){for(var Re=1;Re<arguments.length;Re++){var qe=arguments[Re]!=null?arguments[Re]:{};Re%2?se(Object(qe),!0).forEach(function(ct){Ce(De,ct,qe[ct])}):Object.getOwnPropertyDescriptors?Object.defineProperties(De,Object.getOwnPropertyDescriptors(qe)):se(Object(qe)).forEach(function(ct){Object.defineProperty(De,ct,Object.getOwnPropertyDescriptor(qe,ct))})}return De}function Ce(De,Re,qe){return Re in De?Object.defineProperty(De,Re,{value:qe,enumerable:!0,configurable:!0,writable:!0}):De[Re]=qe,De}var we=n.ViewMode,Ye=9,at={type:"FeatureCollection",features:[]},yt=me({mode:we},o.default.defaultProps,{data:[],selectedIndexes:[],filled:!1,stroked:!0,lineWidthScale:i.PROJECTED_PIXEL_SIZE_MULTIPLIER,lineWidthMinPixels:1,lineWidthMaxPixels:Number.MAX_SAFE_INTEGER,lineWidthUnits:"pixels",getHexagons:function(Re){return Re.hexIds},getEditedCluster:function(Re,qe){return qe?me({},qe,{hexIds:Re}):{hexIds:Re}},resolution:Ye}),be=function(De){ie(qe,De);var Re=X(qe);function qe(){return D(this,qe),Re.apply(this,arguments)}return k(qe,[{key:"initializeState",value:function(){F(ue(qe.prototype),"initializeState",this).call(this),this.setState({tentativeHexagonIDs:[]})}},{key:"getDerivedHexagonIDs",value:function(Ct){return(0,r.polyfill)(Ct,this.props.resolution,!0)}},{key:"getDerivedHexagonID",value:function(Ct){return(0,r.geoToH3)(Ct[1],Ct[0],this.props.resolution)}},{key:"renderLayers",value:function(){var Ct=this,Dt=[new o.default(this.getSubLayerProps({id:"editable-geojson",mode:this.props.mode,data:at,selectedFeatureIndexes:[],onEdit:function(Mn){var Tn=Mn.editType,Nt=Mn.editContext;switch(Tn){case"updateTentativeFeature":if(Nt.feature.geometry.type==="Polygon"){var Zt=Nt.feature.geometry.coordinates,Wt=Ct.getDerivedHexagonIDs(Zt);Ct.setState({tentativeHexagonIDs:Wt})}else if(Nt.feature.geometry.type==="Point"){var hn=Nt.feature.geometry.coordinates,lr=Ct.getDerivedHexagonID(hn);Ct.setState({tentativeHexagonIDs:[lr]})}break;case"addFeature":var It=d(Ct.props.data),Xt=Ct.props.modeConfig;if(!Xt||!Xt.booleanOperation)It.push(Ct.props.getEditedCluster(Ct.state.tentativeHexagonIDs,null));else if(Ct.props.selectedIndexes.length!==1)console.warn("booleanOperation only supported for single cluster selection");else{var $t,cn=new Set(Ct.getSelectedHexIDs()),Jt=new Set(Ct.state.tentativeHexagonIDs);switch(Xt.booleanOperation){case"union":default:$t=d(new Set([].concat(d(cn),d(Jt))));break;case"intersection":$t=d(cn).filter(function(or){return Jt.has(or)});break;case"difference":$t=d(cn).filter(function(or){return!Jt.has(or)});break}var Ln=Ct.props.selectedIndexes[0],qn=Ct.props.data[Ln];It[Ln]=Ct.props.getEditedCluster($t,qn)}Ct.setState({tentativeHexagonIDs:[]}),Ct.props.onEdit({updatedData:It});break}}})),new e.H3ClusterLayer(this.getSubLayerProps({id:"hexagons",data:this.props.data,getHexagons:this.props.getHexagons})),new e.H3ClusterLayer(this.getSubLayerProps({id:"tentative-hexagons",data:[{hexIds:this.state.tentativeHexagonIDs}],getHexagons:function(Mn){return Mn.hexIds}}))];return Dt}},{key:"getSelectedHexIDs",value:function(){var Ct=this,Dt=[];return this.props.selectedIndexes.forEach(function(In){var Mn=Ct.props.data[In],Tn=Ct.props.getHexagons(Mn);Dt=Dt.concat(Tn)}),Dt}},{key:"getCursor",value:function(Ct){var Dt=Ct.isDragging,In=this.state||{},Mn=In.cursor;return Mn||(Mn=Dt?"grabbing":"grab"),Mn}}]),qe}(a.default);t.default=be,Ce(be,"layerName","EditableH3ClusterLayer"),Ce(be,"defaultProps",yt)})(koe);var Eae={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.SELECTION_TYPE=void 0;var e=f2,n=b_,r=rl,i=d($ie),o=d(u6),a=Hp,s=d(XR),u;function d(Nt){return Nt&&Nt.__esModule?Nt:{default:Nt}}function g(Nt){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(Wt){return typeof Wt}:g=function(Wt){return Wt&&typeof Symbol=="function"&&Wt.constructor===Symbol&&Wt!==Symbol.prototype?"symbol":typeof Wt},g(Nt)}function _(Nt,Zt){var Wt=Object.keys(Nt);if(Object.getOwnPropertySymbols){var hn=Object.getOwnPropertySymbols(Nt);Zt&&(hn=hn.filter(function(lr){return Object.getOwnPropertyDescriptor(Nt,lr).enumerable})),Wt.push.apply(Wt,hn)}return Wt}function E(Nt){for(var Zt=1;Zt<arguments.length;Zt++){var Wt=arguments[Zt]!=null?arguments[Zt]:{};Zt%2?_(Object(Wt),!0).forEach(function(hn){yt(Nt,hn,Wt[hn])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Nt,Object.getOwnPropertyDescriptors(Wt)):_(Object(Wt)).forEach(function(hn){Object.defineProperty(Nt,hn,Object.getOwnPropertyDescriptor(Wt,hn))})}return Nt}function P(Nt){return V(Nt)||D(Nt)||z(Nt)||O()}function O(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D(Nt){if(typeof Symbol<"u"&&Symbol.iterator in Object(Nt))return Array.from(Nt)}function V(Nt){if(Array.isArray(Nt))return X(Nt)}function k(Nt,Zt){return J(Nt)||Y(Nt,Zt)||z(Nt,Zt)||F()}function F(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z(Nt,Zt){if(Nt){if(typeof Nt=="string")return X(Nt,Zt);var Wt=Object.prototype.toString.call(Nt).slice(8,-1);if(Wt==="Object"&&Nt.constructor&&(Wt=Nt.constructor.name),Wt==="Map"||Wt==="Set")return Array.from(Wt);if(Wt==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Wt))return X(Nt,Zt)}}function X(Nt,Zt){(Zt==null||Zt>Nt.length)&&(Zt=Nt.length);for(var Wt=0,hn=new Array(Zt);Wt<Zt;Wt++)hn[Wt]=Nt[Wt];return hn}function Y(Nt,Zt){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(Nt)))){var Wt=[],hn=!0,lr=!1,It=void 0;try{for(var Xt=Nt[Symbol.iterator](),$t;!(hn=($t=Xt.next()).done)&&(Wt.push($t.value),!(Zt&&Wt.length===Zt));hn=!0);}catch(cn){lr=!0,It=cn}finally{try{!hn&&Xt.return!=null&&Xt.return()}finally{if(lr)throw It}}return Wt}}function J(Nt){if(Array.isArray(Nt))return Nt}function re(Nt,Zt){if(!(Nt instanceof Zt))throw new TypeError("Cannot call a class as a function")}function ue(Nt,Zt){for(var Wt=0;Wt<Zt.length;Wt++){var hn=Zt[Wt];hn.enumerable=hn.enumerable||!1,hn.configurable=!0,"value"in hn&&(hn.writable=!0),Object.defineProperty(Nt,hn.key,hn)}}function ie(Nt,Zt,Wt){return Zt&&ue(Nt.prototype,Zt),Wt&&ue(Nt,Wt),Nt}function ce(Nt){return function(){var Zt=we(Nt),Wt;if(Ce()){var hn=we(this).constructor;Wt=Reflect.construct(Zt,arguments,hn)}else Wt=Zt.apply(this,arguments);return se(this,Wt)}}function se(Nt,Zt){return Zt&&(g(Zt)==="object"||typeof Zt=="function")?Zt:me(Nt)}function me(Nt){if(Nt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Nt}function Ce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function we(Nt){return we=Object.setPrototypeOf?Object.getPrototypeOf:function(Wt){return Wt.__proto__||Object.getPrototypeOf(Wt)},we(Nt)}function Ye(Nt,Zt){if(typeof Zt!="function"&&Zt!==null)throw new TypeError("Super expression must either be null or a function");Nt.prototype=Object.create(Zt&&Zt.prototype,{constructor:{value:Nt,writable:!0,configurable:!0}}),Zt&&at(Nt,Zt)}function at(Nt,Zt){return at=Object.setPrototypeOf||function(hn,lr){return hn.__proto__=lr,hn},at(Nt,Zt)}function yt(Nt,Zt,Wt){return Zt in Nt?Object.defineProperty(Nt,Zt,{value:Wt,enumerable:!0,configurable:!0,writable:!0}):Nt[Zt]=Wt,Nt}var be={NONE:null,RECTANGLE:"rectangle",POLYGON:"polygon"};t.SELECTION_TYPE=be;var De=(u={},yt(u,be.RECTANGLE,a.DrawRectangleMode),yt(u,be.POLYGON,a.DrawPolygonMode),u),Re=yt({},be.RECTANGLE,{dragToDraw:!0}),qe={selectionType:be.RECTANGLE,layerIds:[],onSelect:function(){}},ct={type:"FeatureCollection",features:[]},Ct=50,Dt="selection-geojson",In="selection-blocker",Mn=["lineWidthScale","lineWidthMinPixels","lineWidthMaxPixels","lineWidthUnits","lineJointRounded","lineCapRounded","lineMiterLimit","pointRadiusScale","pointRadiusMinPixels","pointRadiusMaxPixels","lineDashJustified","getLineColor","getFillColor","getRadius","getLineWidth","getLineDashArray","getTentativeLineDashArray","getTentativeLineColor","getTentativeFillColor","getTentativeLineWidth"],Tn=function(Nt){Ye(Wt,Nt);var Zt=ce(Wt);function Wt(){return re(this,Wt),Zt.apply(this,arguments)}return ie(Wt,[{key:"_selectRectangleObjects",value:function(lr){var It=this.props,Xt=It.layerIds,$t=It.onSelect,cn=this.context.viewport.project(lr[0][0]),Jt=k(cn,2),Ln=Jt[0],qn=Jt[1],or=this.context.viewport.project(lr[0][2]),cr=k(or,2),cs=cr[0],Ri=cr[1],Do=this.context.deck.pickObjects({x:Math.min(Ln,cs),y:Math.min(qn,Ri),width:Math.abs(cs-Ln),height:Math.abs(Ri-qn),layerIds:Xt});$t({pickingInfos:Do})}},{key:"_selectPolygonObjects",value:function(lr){var It=this,Xt=this.props,$t=Xt.layerIds,cn=Xt.onSelect,Jt=lr[0].map(function(mo){return It.context.viewport.project(mo)}),Ln=Jt.map(function(mo){return mo[0]}),qn=Jt.map(function(mo){return mo[1]}),or=Math.min.apply(Math,P(Ln)),cr=Math.min.apply(Math,P(qn)),cs=Math.max.apply(Math,P(Ln)),Ri=Math.max.apply(Math,P(qn)),Do=(0,r.polygon)(lr),Fa=(0,i.default)(Do,Ct),Nl;try{Nl=(0,o.default)(Fa,Do)}catch(mo){console.log("turfDifference() error",mo);return}this.setState({pendingPolygonSelection:{bigPolygon:Nl}});var _s="".concat(this.props.id,"-").concat(In);setTimeout(function(){var mo=It.context.deck.pickObjects({x:or,y:cr,width:cs-or,height:Ri-cr,layerIds:[_s].concat(P($t))});cn({pickingInfos:mo.filter(function(Fl){return Fl.layer.id!==It.props.id})})},250)}},{key:"renderLayers",value:function(){var lr=this,It=this.state.pendingPolygonSelection,Xt=De[this.props.selectionType]||a.ViewMode,$t=Re[this.props.selectionType],cn={};Mn.forEach(function(qn){lr.props[qn]!==void 0&&(cn[qn]=lr.props[qn])});var Jt=[new s.default(this.getSubLayerProps(E({id:Dt,pickable:!0,mode:Xt,modeConfig:$t,selectedFeatureIndexes:[],data:ct,onEdit:function(or){var cr=or.updatedData,cs=or.editType;if(cs==="addFeature"){var Ri=cr.features[0].geometry.coordinates;lr.props.selectionType===be.RECTANGLE?lr._selectRectangleObjects(Ri):lr.props.selectionType===be.POLYGON&&lr._selectPolygonObjects(Ri)}}},cn)))];if(It){var Ln=It.bigPolygon;Jt.push(new n.PolygonLayer(this.getSubLayerProps({id:In,pickable:!0,stroked:!1,opacity:1,data:[Ln],getLineColor:function(or){return[0,0,0,1]},getFillColor:function(or){return[0,0,0,1]},getPolygon:function(or){return or.geometry.coordinates}})))}return Jt}},{key:"shouldUpdateState",value:function(lr){var It=lr.changeFlags,Xt=It.stateChanged,$t=It.propsOrDataChanged;return Xt||$t}}]),Wt}(e.CompositeLayer);t.default=Tn,yt(Tn,"layerName","SelectionLayer"),yt(Tn,"defaultProps",qe)})(Eae);var Sae={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=f2,n=b_;function r(k){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?r=function(z){return typeof z}:r=function(z){return z&&typeof Symbol=="function"&&z.constructor===Symbol&&z!==Symbol.prototype?"symbol":typeof z},r(k)}function i(k,F){if(!(k instanceof F))throw new TypeError("Cannot call a class as a function")}function o(k,F){for(var z=0;z<F.length;z++){var X=F[z];X.enumerable=X.enumerable||!1,X.configurable=!0,"value"in X&&(X.writable=!0),Object.defineProperty(k,X.key,X)}}function a(k,F,z){return F&&o(k.prototype,F),z&&o(k,z),k}function s(k){return function(){var F=_(k),z;if(g()){var X=_(this).constructor;z=Reflect.construct(F,arguments,X)}else z=F.apply(this,arguments);return u(this,z)}}function u(k,F){return F&&(r(F)==="object"||typeof F=="function")?F:d(k)}function d(k){if(k===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k}function g(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function _(k){return _=Object.setPrototypeOf?Object.getPrototypeOf:function(z){return z.__proto__||Object.getPrototypeOf(z)},_(k)}function E(k,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(F&&F.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),F&&P(k,F)}function P(k,F){return P=Object.setPrototypeOf||function(X,Y){return X.__proto__=Y,X},P(k,F)}function O(k,F,z){return F in k?Object.defineProperty(k,F,{value:z,enumerable:!0,configurable:!0,writable:!0}):k[F]=z,k}var D={},V=function(k){E(z,k);var F=s(z);function z(){return i(this,z),F.apply(this,arguments)}return a(z,[{key:"renderLayers",value:function(){var Y=new n.ScatterplotLayer(Object.assign({},this.props,{id:"".concat(this.props.id,"-ScatterplotLayer"),data:this.props.data})),J=new n.LineLayer(Object.assign({},this.props,{id:"".concat(this.props.id,"-LineLayer"),data:this.props.data,pickable:!1,getSourcePosition:function(ue){var ie=ue.position;return[ie[0],ie[1],0]},getTargetPosition:function(ue){var ie=ue.position;return[ie[0],ie[1],ie[2]||0]},getColor:[150,150,150,200],getStrokeWidth:3}));return[Y,J]}}]),z}(e.CompositeLayer);t.default=V,O(V,"layerName","ElevatedEditHandleLayer"),O(V,"defaultProps",D)})(Sae);var jU={};const tXe={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,FUNC_ADD:32774,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,BLEND_COLOR:32773,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,VENDOR:7936,RENDERER:7937,VERSION:7938,IMPLEMENTATION_COLOR_READ_TYPE:35738,IMPLEMENTATION_COLOR_READ_FORMAT:35739,BROWSER_DEFAULT_WEBGL:37444,STATIC_DRAW:35044,STREAM_DRAW:35040,DYNAMIC_DRAW:35048,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,CULL_FACE:2884,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,BLEND:3042,DEPTH_TEST:2929,DITHER:3024,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,SCISSOR_TEST:3089,STENCIL_TEST:2960,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CONTEXT_LOST_WEBGL:37442,CW:2304,CCW:2305,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,COMPILE_STATUS:35713,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_ATTRIBUTES:35721,ACTIVE_UNIFORMS:35718,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,ALWAYS:519,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,GEQUAL:518,NOTEQUAL:517,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,TEXTURE_WIDTH:4096,TEXTURE_HEIGHT:4097,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,READ_FRAMEBUFFER:36008,DRAW_FRAMEBUFFER:36009,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,READ_BUFFER:3074,UNPACK_ROW_LENGTH:3314,UNPACK_SKIP_ROWS:3315,UNPACK_SKIP_PIXELS:3316,PACK_ROW_LENGTH:3330,PACK_SKIP_ROWS:3331,PACK_SKIP_PIXELS:3332,TEXTURE_BINDING_3D:32874,UNPACK_SKIP_IMAGES:32877,UNPACK_IMAGE_HEIGHT:32878,MAX_3D_TEXTURE_SIZE:32883,MAX_ELEMENTS_VERTICES:33e3,MAX_ELEMENTS_INDICES:33001,MAX_TEXTURE_LOD_BIAS:34045,MAX_FRAGMENT_UNIFORM_COMPONENTS:35657,MAX_VERTEX_UNIFORM_COMPONENTS:35658,MAX_ARRAY_TEXTURE_LAYERS:35071,MIN_PROGRAM_TEXEL_OFFSET:35076,MAX_PROGRAM_TEXEL_OFFSET:35077,MAX_VARYING_COMPONENTS:35659,FRAGMENT_SHADER_DERIVATIVE_HINT:35723,RASTERIZER_DISCARD:35977,VERTEX_ARRAY_BINDING:34229,MAX_VERTEX_OUTPUT_COMPONENTS:37154,MAX_FRAGMENT_INPUT_COMPONENTS:37157,MAX_SERVER_WAIT_TIMEOUT:37137,MAX_ELEMENT_INDEX:36203,RED:6403,RGB8:32849,RGBA8:32856,RGB10_A2:32857,TEXTURE_3D:32879,TEXTURE_WRAP_R:32882,TEXTURE_MIN_LOD:33082,TEXTURE_MAX_LOD:33083,TEXTURE_BASE_LEVEL:33084,TEXTURE_MAX_LEVEL:33085,TEXTURE_COMPARE_MODE:34892,TEXTURE_COMPARE_FUNC:34893,SRGB:35904,SRGB8:35905,SRGB8_ALPHA8:35907,COMPARE_REF_TO_TEXTURE:34894,RGBA32F:34836,RGB32F:34837,RGBA16F:34842,RGB16F:34843,TEXTURE_2D_ARRAY:35866,TEXTURE_BINDING_2D_ARRAY:35869,R11F_G11F_B10F:35898,RGB9_E5:35901,RGBA32UI:36208,RGB32UI:36209,RGBA16UI:36214,RGB16UI:36215,RGBA8UI:36220,RGB8UI:36221,RGBA32I:36226,RGB32I:36227,RGBA16I:36232,RGB16I:36233,RGBA8I:36238,RGB8I:36239,RED_INTEGER:36244,RGB_INTEGER:36248,RGBA_INTEGER:36249,R8:33321,RG8:33323,R16F:33325,R32F:33326,RG16F:33327,RG32F:33328,R8I:33329,R8UI:33330,R16I:33331,R16UI:33332,R32I:33333,R32UI:33334,RG8I:33335,RG8UI:33336,RG16I:33337,RG16UI:33338,RG32I:33339,RG32UI:33340,R8_SNORM:36756,RG8_SNORM:36757,RGB8_SNORM:36758,RGBA8_SNORM:36759,RGB10_A2UI:36975,TEXTURE_IMMUTABLE_FORMAT:37167,TEXTURE_IMMUTABLE_LEVELS:33503,UNSIGNED_INT_2_10_10_10_REV:33640,UNSIGNED_INT_10F_11F_11F_REV:35899,UNSIGNED_INT_5_9_9_9_REV:35902,FLOAT_32_UNSIGNED_INT_24_8_REV:36269,UNSIGNED_INT_24_8:34042,HALF_FLOAT:5131,RG:33319,RG_INTEGER:33320,INT_2_10_10_10_REV:36255,CURRENT_QUERY:34917,QUERY_RESULT:34918,QUERY_RESULT_AVAILABLE:34919,ANY_SAMPLES_PASSED:35887,ANY_SAMPLES_PASSED_CONSERVATIVE:36202,MAX_DRAW_BUFFERS:34852,DRAW_BUFFER0:34853,DRAW_BUFFER1:34854,DRAW_BUFFER2:34855,DRAW_BUFFER3:34856,DRAW_BUFFER4:34857,DRAW_BUFFER5:34858,DRAW_BUFFER6:34859,DRAW_BUFFER7:34860,DRAW_BUFFER8:34861,DRAW_BUFFER9:34862,DRAW_BUFFER10:34863,DRAW_BUFFER11:34864,DRAW_BUFFER12:34865,DRAW_BUFFER13:34866,DRAW_BUFFER14:34867,DRAW_BUFFER15:34868,MAX_COLOR_ATTACHMENTS:36063,COLOR_ATTACHMENT1:36065,COLOR_ATTACHMENT2:36066,COLOR_ATTACHMENT3:36067,COLOR_ATTACHMENT4:36068,COLOR_ATTACHMENT5:36069,COLOR_ATTACHMENT6:36070,COLOR_ATTACHMENT7:36071,COLOR_ATTACHMENT8:36072,COLOR_ATTACHMENT9:36073,COLOR_ATTACHMENT10:36074,COLOR_ATTACHMENT11:36075,COLOR_ATTACHMENT12:36076,COLOR_ATTACHMENT13:36077,COLOR_ATTACHMENT14:36078,COLOR_ATTACHMENT15:36079,SAMPLER_3D:35679,SAMPLER_2D_SHADOW:35682,SAMPLER_2D_ARRAY:36289,SAMPLER_2D_ARRAY_SHADOW:36292,SAMPLER_CUBE_SHADOW:36293,INT_SAMPLER_2D:36298,INT_SAMPLER_3D:36299,INT_SAMPLER_CUBE:36300,INT_SAMPLER_2D_ARRAY:36303,UNSIGNED_INT_SAMPLER_2D:36306,UNSIGNED_INT_SAMPLER_3D:36307,UNSIGNED_INT_SAMPLER_CUBE:36308,UNSIGNED_INT_SAMPLER_2D_ARRAY:36311,MAX_SAMPLES:36183,SAMPLER_BINDING:35097,PIXEL_PACK_BUFFER:35051,PIXEL_UNPACK_BUFFER:35052,PIXEL_PACK_BUFFER_BINDING:35053,PIXEL_UNPACK_BUFFER_BINDING:35055,COPY_READ_BUFFER:36662,COPY_WRITE_BUFFER:36663,COPY_READ_BUFFER_BINDING:36662,COPY_WRITE_BUFFER_BINDING:36663,FLOAT_MAT2x3:35685,FLOAT_MAT2x4:35686,FLOAT_MAT3x2:35687,FLOAT_MAT3x4:35688,FLOAT_MAT4x2:35689,FLOAT_MAT4x3:35690,UNSIGNED_INT_VEC2:36294,UNSIGNED_INT_VEC3:36295,UNSIGNED_INT_VEC4:36296,UNSIGNED_NORMALIZED:35863,SIGNED_NORMALIZED:36764,VERTEX_ATTRIB_ARRAY_INTEGER:35069,VERTEX_ATTRIB_ARRAY_DIVISOR:35070,TRANSFORM_FEEDBACK_BUFFER_MODE:35967,MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS:35968,TRANSFORM_FEEDBACK_VARYINGS:35971,TRANSFORM_FEEDBACK_BUFFER_START:35972,TRANSFORM_FEEDBACK_BUFFER_SIZE:35973,TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN:35976,MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS:35978,MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS:35979,INTERLEAVED_ATTRIBS:35980,SEPARATE_ATTRIBS:35981,TRANSFORM_FEEDBACK_BUFFER:35982,TRANSFORM_FEEDBACK_BUFFER_BINDING:35983,TRANSFORM_FEEDBACK:36386,TRANSFORM_FEEDBACK_PAUSED:36387,TRANSFORM_FEEDBACK_ACTIVE:36388,TRANSFORM_FEEDBACK_BINDING:36389,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING:33296,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE:33297,FRAMEBUFFER_ATTACHMENT_RED_SIZE:33298,FRAMEBUFFER_ATTACHMENT_GREEN_SIZE:33299,FRAMEBUFFER_ATTACHMENT_BLUE_SIZE:33300,FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE:33301,FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE:33302,FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE:33303,FRAMEBUFFER_DEFAULT:33304,DEPTH24_STENCIL8:35056,DRAW_FRAMEBUFFER_BINDING:36006,READ_FRAMEBUFFER_BINDING:36010,RENDERBUFFER_SAMPLES:36011,FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER:36052,FRAMEBUFFER_INCOMPLETE_MULTISAMPLE:36182,UNIFORM_BUFFER:35345,UNIFORM_BUFFER_BINDING:35368,UNIFORM_BUFFER_START:35369,UNIFORM_BUFFER_SIZE:35370,MAX_VERTEX_UNIFORM_BLOCKS:35371,MAX_FRAGMENT_UNIFORM_BLOCKS:35373,MAX_COMBINED_UNIFORM_BLOCKS:35374,MAX_UNIFORM_BUFFER_BINDINGS:35375,MAX_UNIFORM_BLOCK_SIZE:35376,MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS:35377,MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS:35379,UNIFORM_BUFFER_OFFSET_ALIGNMENT:35380,ACTIVE_UNIFORM_BLOCKS:35382,UNIFORM_TYPE:35383,UNIFORM_SIZE:35384,UNIFORM_BLOCK_INDEX:35386,UNIFORM_OFFSET:35387,UNIFORM_ARRAY_STRIDE:35388,UNIFORM_MATRIX_STRIDE:35389,UNIFORM_IS_ROW_MAJOR:35390,UNIFORM_BLOCK_BINDING:35391,UNIFORM_BLOCK_DATA_SIZE:35392,UNIFORM_BLOCK_ACTIVE_UNIFORMS:35394,UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES:35395,UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER:35396,UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER:35398,OBJECT_TYPE:37138,SYNC_CONDITION:37139,SYNC_STATUS:37140,SYNC_FLAGS:37141,SYNC_FENCE:37142,SYNC_GPU_COMMANDS_COMPLETE:37143,UNSIGNALED:37144,SIGNALED:37145,ALREADY_SIGNALED:37146,TIMEOUT_EXPIRED:37147,CONDITION_SATISFIED:37148,WAIT_FAILED:37149,SYNC_FLUSH_COMMANDS_BIT:1,COLOR:6144,DEPTH:6145,STENCIL:6146,MIN:32775,MAX:32776,DEPTH_COMPONENT24:33190,STREAM_READ:35041,STREAM_COPY:35042,STATIC_READ:35045,STATIC_COPY:35046,DYNAMIC_READ:35049,DYNAMIC_COPY:35050,DEPTH_COMPONENT32F:36012,DEPTH32F_STENCIL8:36013,INVALID_INDEX:4294967295,TIMEOUT_IGNORED:-1,MAX_CLIENT_WAIT_TIMEOUT_WEBGL:37447,VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,UNMASKED_VENDOR_WEBGL:37445,UNMASKED_RENDERER_WEBGL:37446,MAX_TEXTURE_MAX_ANISOTROPY_EXT:34047,TEXTURE_MAX_ANISOTROPY_EXT:34046,COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35986,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,UNSIGNED_INT_24_8_WEBGL:34042,HALF_FLOAT_OES:36193,RGBA32F_EXT:34836,RGB32F_EXT:34837,FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT:33297,UNSIGNED_NORMALIZED_EXT:35863,MIN_EXT:32775,MAX_EXT:32776,SRGB_EXT:35904,SRGB_ALPHA_EXT:35906,SRGB8_ALPHA8_EXT:35907,FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT:33296,FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723,COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067,COLOR_ATTACHMENT4_WEBGL:36068,COLOR_ATTACHMENT5_WEBGL:36069,COLOR_ATTACHMENT6_WEBGL:36070,COLOR_ATTACHMENT7_WEBGL:36071,COLOR_ATTACHMENT8_WEBGL:36072,COLOR_ATTACHMENT9_WEBGL:36073,COLOR_ATTACHMENT10_WEBGL:36074,COLOR_ATTACHMENT11_WEBGL:36075,COLOR_ATTACHMENT12_WEBGL:36076,COLOR_ATTACHMENT13_WEBGL:36077,COLOR_ATTACHMENT14_WEBGL:36078,COLOR_ATTACHMENT15_WEBGL:36079,DRAW_BUFFER0_WEBGL:34853,DRAW_BUFFER1_WEBGL:34854,DRAW_BUFFER2_WEBGL:34855,DRAW_BUFFER3_WEBGL:34856,DRAW_BUFFER4_WEBGL:34857,DRAW_BUFFER5_WEBGL:34858,DRAW_BUFFER6_WEBGL:34859,DRAW_BUFFER7_WEBGL:34860,DRAW_BUFFER8_WEBGL:34861,DRAW_BUFFER9_WEBGL:34862,DRAW_BUFFER10_WEBGL:34863,DRAW_BUFFER11_WEBGL:34864,DRAW_BUFFER12_WEBGL:34865,DRAW_BUFFER13_WEBGL:34866,DRAW_BUFFER14_WEBGL:34867,DRAW_BUFFER15_WEBGL:34868,MAX_COLOR_ATTACHMENTS_WEBGL:36063,MAX_DRAW_BUFFERS_WEBGL:34852,VERTEX_ARRAY_BINDING_OES:34229,QUERY_COUNTER_BITS_EXT:34916,CURRENT_QUERY_EXT:34917,QUERY_RESULT_EXT:34918,QUERY_RESULT_AVAILABLE_EXT:34919,TIME_ELAPSED_EXT:35007,TIMESTAMP_EXT:36392,GPU_DISJOINT_EXT:36795},nXe=Object.freeze(Object.defineProperty({__proto__:null,default:tXe},Symbol.toStringTag,{value:"Module"})),rXe=ti(nXe),Tae=ti(PEe);var Cae={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e={outlineEnabled:!1,outlineRenderShadowmap:!1,outlineShadowmap:null};function n(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:e,s=a.outlineEnabled,u=a.outlineRenderShadowmap,d=a.outlineShadowmap,g={};return s!==void 0&&(g.outline_uEnabled=s),u!==void 0&&(g.outline_uRenderOutlines=u),d!==void 0&&(g.outline_uShadowmap=d),g}var r=`attribute float instanceZLevel;
varying float outline_vzLevel;
varying vec4 outline_vPosition;

// Set the z level for the outline shadowmap rendering
void outline_setZLevel(float zLevel) {
  outline_vzLevel = zLevel;
}

// Store an adjusted position for texture2DProj
void outline_setUV(vec4 position) {
  // mat4(
  //   0.5, 0.0, 0.0, 0.0,
  //   0.0, 0.5, 0.0, 0.0,
  //   0.0, 0.0, 0.5, 0.0,
  //   0.5, 0.5, 0.5, 1.0
  // ) * position;
  outline_vPosition = vec4(position.xyz * 0.5 + position.w * 0.5, position.w);
}
`,i=`uniform bool outline_uEnabled;
uniform bool outline_uRenderOutlines;
uniform sampler2D outline_uShadowmap;

varying float outline_vzLevel;
// varying vec2 outline_vUV;
varying vec4 outline_vPosition;

const float OUTLINE_Z_LEVEL_ERROR = 0.01;

// Return a darker color in shadowmap
vec4 outline_filterShadowColor(vec4 color) {
  return vec4(outline_vzLevel / 255., outline_vzLevel / 255., outline_vzLevel / 255., 1.);
}

// Return a darker color if in shadowmap
vec4 outline_filterDarkenColor(vec4 color) {
  if (outline_uEnabled) {
    float maxZLevel;
    if (outline_vPosition.q > 0.0) {
      maxZLevel = texture2DProj(outline_uShadowmap, outline_vPosition).r * 255.;
    } else {
      discard;
    }
    if (maxZLevel < outline_vzLevel + OUTLINE_Z_LEVEL_ERROR) {
      vec4(color.rgb * 0.5, color.a);
    } else {
      discard;
    }
  }
  return color;
}

// if enabled and rendering outlines - Render depth to shadowmap
// if enabled and rendering colors - Return a darker color if in shadowmap
// if disabled, just return color
vec4 outline_filterColor(vec4 color) {
  if (outline_uEnabled) {
    return outline_uRenderOutlines ?
      outline_filterShadowColor(color) :
      outline_filterDarkenColor(color);
  }
  return color;
}
`,o={name:"outline",vs:r,fs:i,getUniforms:n};t.default=o})(Cae);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=b_,n=a(rXe),r=Tae,i=a(Cae),o=fA;function a(ce){return ce&&ce.__esModule?ce:{default:ce}}function s(ce){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?s=function(me){return typeof me}:s=function(me){return me&&typeof Symbol=="function"&&me.constructor===Symbol&&me!==Symbol.prototype?"symbol":typeof me},s(ce)}function u(ce,se){if(!(ce instanceof se))throw new TypeError("Cannot call a class as a function")}function d(ce,se){for(var me=0;me<se.length;me++){var Ce=se[me];Ce.enumerable=Ce.enumerable||!1,Ce.configurable=!0,"value"in Ce&&(Ce.writable=!0),Object.defineProperty(ce,Ce.key,Ce)}}function g(ce,se,me){return se&&d(ce.prototype,se),me&&d(ce,me),ce}function _(ce,se,me){return typeof Reflect<"u"&&Reflect.get?_=Reflect.get:_=function(we,Ye,at){var yt=E(we,Ye);if(yt){var be=Object.getOwnPropertyDescriptor(yt,Ye);return be.get?be.get.call(at):be.value}},_(ce,se,me||ce)}function E(ce,se){for(;!Object.prototype.hasOwnProperty.call(ce,se)&&(ce=k(ce),ce!==null););return ce}function P(ce){return function(){var se=k(ce),me;if(V()){var Ce=k(this).constructor;me=Reflect.construct(se,arguments,Ce)}else me=se.apply(this,arguments);return O(this,me)}}function O(ce,se){return se&&(s(se)==="object"||typeof se=="function")?se:D(ce)}function D(ce){if(ce===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ce}function V(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function k(ce){return k=Object.setPrototypeOf?Object.getPrototypeOf:function(me){return me.__proto__||Object.getPrototypeOf(me)},k(ce)}function F(ce,se){if(typeof se!="function"&&se!==null)throw new TypeError("Super expression must either be null or a function");ce.prototype=Object.create(se&&se.prototype,{constructor:{value:ce,writable:!0,configurable:!0}}),se&&z(ce,se)}function z(ce,se){return z=Object.setPrototypeOf||function(Ce,we){return Ce.__proto__=we,Ce},z(ce,se)}function X(ce,se,me){return se in ce?Object.defineProperty(ce,se,{value:me,enumerable:!0,configurable:!0,writable:!0}):ce[se]=me,ce}function Y(ce){var se=ce.source,me=ce.code,Ce=me===void 0?"":me,we=/}[^{}]*$/;return se.replace(we,Ce.concat(`
}
`))}var J=`  outline_setUV(gl_Position);
  outline_setZLevel(instanceZLevel);
`,re=`  gl_FragColor = outline_filterColor(gl_FragColor);
`,ue={getZLevel:function(){return 0}},ie=function(ce){F(me,ce);var se=P(me);function me(){return u(this,me),se.apply(this,arguments)}return g(me,[{key:"getShaders",value:function(){var we=_(k(me.prototype),"getShaders",this).call(this);return Object.assign({},we,{modules:we.modules.concat([i.default]),vs:Y({source:we.vs,code:J}),fs:Y({source:we.fs,code:re})})}},{key:"initializeState",value:function(we){_(k(me.prototype),"initializeState",this).call(this,we),this.setState({outlineFramebuffer:new r.Framebuffer(we.gl),dummyTexture:new r.Texture2D(we.gl)}),this.state.attributeManager.addInstanced({instanceZLevel:{size:1,type:n.default.UNSIGNED_BYTE,accessor:"getZLevel"}})}},{key:"draw",value:function(we){we.moduleParameters,we.parameters;var Ye=we.uniforms;we.context;var at=this.props,yt=at.jointRounded,be=at.capRounded,De=at.billboard,Re=at.miterLimit,qe=at.widthUnits,ct=at.widthScale,Ct=at.widthMinPixels,Dt=at.widthMaxPixels;Ye=Object.assign({},Ye,{jointType:Number(yt),capType:Number(be),billboard:De,widthUnits:o.UNIT[qe],widthScale:ct,miterLimit:Re,widthMinPixels:Ct,widthMaxPixels:Dt});var In=this.state,Mn=In.outlineFramebuffer,Tn=In.dummyTexture;Mn.resize(),Mn.clear({color:!0,depth:!0}),this.state.model.updateModuleSettings({outlineEnabled:!0,outlineRenderShadowmap:!0,outlineShadowmap:Tn}),this.state.model.draw({uniforms:Object.assign({},Ye,{jointType:0,widthScale:this.props.widthScale*1.3}),parameters:{depthTest:!1,blendEquation:n.default.MAX},framebuffer:Mn}),this.state.model.updateModuleSettings({outlineEnabled:!0,outlineRenderShadowmap:!1,outlineShadowmap:Mn}),this.state.model.draw({uniforms:Object.assign({},Ye,{jointType:Number(yt),capType:Number(be),widthScale:this.props.widthScale}),parameters:{depthTest:!1}})}}]),me}(e.PathLayer);t.default=ie,X(ie,"layerName","PathOutlineLayer"),X(ie,"defaultProps",ue)})(jU);var Pae={};const iXe=ti(F$e);var Iae={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=Tae;function n(P){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(D){return typeof D}:n=function(D){return D&&typeof Symbol=="function"&&D.constructor===Symbol&&D!==Symbol.prototype?"symbol":typeof D},n(P)}function r(P,O){if(!(P instanceof O))throw new TypeError("Cannot call a class as a function")}function i(P){return function(){var O=u(P),D;if(s()){var V=u(this).constructor;D=Reflect.construct(O,arguments,V)}else D=O.apply(this,arguments);return o(this,D)}}function o(P,O){return O&&(n(O)==="object"||typeof O=="function")?O:a(P)}function a(P){if(P===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P}function s(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function u(P){return u=Object.setPrototypeOf?Object.getPrototypeOf:function(D){return D.__proto__||Object.getPrototypeOf(D)},u(P)}function d(P,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function");P.prototype=Object.create(O&&O.prototype,{constructor:{value:P,writable:!0,configurable:!0}}),O&&g(P,O)}function g(P,O){return g=Object.setPrototypeOf||function(V,k){return V.__proto__=k,V},g(P,O)}var _=function(P){d(D,P);var O=i(D);function D(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return r(this,D),O.call(this,Object.assign({},V,{attributes:E(V)}))}return D}(e.Geometry);t.default=_;function E(P){for(var O=P.length,D=O===void 0?1:O,V=P.headSize,k=V===void 0?.2:V,F=P.tailWidth,z=F===void 0?.05:F,X=P.tailStart,Y=X===void 0?.05:X,J=[.5,1,0,.5-k/2,1-k,0,.5+k/2,1-k,0,.5-z/2,Y,0,.5+z/2,1-k,0,.5+z/2,Y,0,.5-z/2,Y,0,.5-z/2,1-k,0,.5+z/2,1-k,0],re=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1],ue=new Array(J.length),ie=0;ie<J.length/3;ie++){var ce=ie*3;ue[ce+0]=(J[ce+0]-.5)*D,ue[ce+1]=(J[ce+1]-.5)*D,ue[ce+2]=0}return{positions:new Float32Array(ue),normals:new Float32Array(re),texCoords:new Float32Array(J)}}})(Iae);var Mae={};const oXe=Object.freeze(Object.defineProperty({__proto__:null,Euler:ms,Matrix3:is,Matrix4:vr,Pose:L$,Quaternion:Qm,SphericalCoordinates:zv,Vector2:jO,Vector3:_t,Vector4:VO,_Euler:ms,_MathUtils:Uv,_Pose:L$,_SphericalCoordinates:zv,acos:$xe,asin:Vxe,assert:ac,atan:Hxe,clamp:Wi,clone:zxe,config:fo,configure:kxe,cos:Gxe,degrees:bl,equals:Sl,exactEquals:kte,formatValue:P5,isArray:wh,lerp:pc,radians:nv,sin:Uxe,tan:jxe,toDegrees:Fte,toRadians:Nte,withEpsilon:Wxe},Symbol.toStringTag,{value:"Module"})),Oae=ti(oXe);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=u;var e=Oae;function n(g){if(typeof Symbol>"u"||g[Symbol.iterator]==null){if(Array.isArray(g)||(g=r(g))){var _=0,E=function(){};return{s:E,n:function(){return _>=g.length?{done:!0}:{done:!1,value:g[_++]}},e:function(F){throw F},f:E}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var P,O=!0,D=!1,V;return{s:function(){P=g[Symbol.iterator]()},n:function(){var F=P.next();return O=F.done,F},e:function(F){D=!0,V=F},f:function(){try{!O&&P.return!=null&&P.return()}finally{if(D)throw V}}}}function r(g,_){if(g){if(typeof g=="string")return i(g,_);var E=Object.prototype.toString.call(g).slice(8,-1);if(E==="Object"&&g.constructor&&(E=g.constructor.name),E==="Map"||E==="Set")return Array.from(E);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return i(g,_)}}function i(g,_){(_==null||_>g.length)&&(_=g.length);for(var E=0,P=new Array(_);E<_;E++)P[E]=g[E];return P}function o(g){for(var _=0,E=0;E<g.length-1;E++)_+=g[E].distance(g[E+1]);return _}var a=[0,0,0,255],s={forward:!0,backward:!1};function u(g){var _=g.data,E=g.getPath,P=E===void 0?function(qe){return qe.path}:E,O=g.getDirection,D=O===void 0?function(qe){return qe.direction}:O,V=g.getColor,k=V===void 0?function(qe){return a}:V,F=g.getMarkerPercentages,z=F===void 0?function(qe,ct){return[.5]}:F,X=g.projectFlat,Y=[],J=n(_),re;try{for(J.s();!(re=J.n()).done;){var ue=re.value,ie=P(ue),ce=D(ue)||s,se=k(ue),me=ie.map(function(qe){return new e.Vector2(qe)}),Ce=me.slice(0).reverse(),we=o(me),Ye=z(ue,{lineLength:we}),at=n(Ye),yt;try{for(at.s();!(yt=at.n()).done;){var be=yt.value;if(ce.forward){var De=d({path:me,percentage:be,lineLength:we,color:se,object:ue,projectFlat:X});Y.push(De)}if(ce.backward){var Re=d({path:Ce,percentage:be,lineLength:we,color:se,object:ue,projectFlat:X});Y.push(Re)}}}catch(qe){at.e(qe)}finally{at.f()}}}catch(qe){J.e(qe)}finally{J.f()}return Y}function d(g){var _=g.path,E=g.percentage,P=g.lineLength,O=g.color,D=g.object,V=g.projectFlat,k=P*E,F=0,z=0,X=0;for(X=0;X<_.length-1&&(F+=_[X].distance(_[X+1]),!(F>k));X++)z=F;X===_.length-1&&(X-=1);var Y=_[X+1].clone().subtract(_[X]).normalize(),J=k-z,re=Y.clone().multiply(new e.Vector2(J,J)).add(_[X]),ue=new e.Vector2(V(_[X+1])).subtract(V(_[X])),ie=ue.verticalAngle()*180/Math.PI;return{position:[re.x,re.y,0],angle:ie,color:O,object:D}}})(Mae);var xL={};Object.defineProperty(xL,"__esModule",{value:!0});xL.getClosestPointOnLine=Rae;xL.getClosestPointOnPolyline=sXe;var AP=Oae;function Rae(t){var e=t.p,n=t.p1,r=t.p2,i=t.clampToLine,o=i===void 0?!0:i,a=new AP.Vector3(r).subtract(n),s=new AP.Vector3(e).subtract(n),u=a.dot(s);return o&&(u=(0,AP.clamp)(u,0,1)),a.lerp(u)}function sXe(t){var e=t.p,n=t.points;e=new AP.Vector3(e);for(var r=null,i=1/0,o=-1,a=0;a<n.length-1;++a){var s=n[a],u=n[a+1],d=Rae({p:e,p1:s,p2:u}),g=e.distanceSquared(d);g<i&&(i=g,r=d,o=a)}return{point:r,index:o,p1:n[o],p2:n[o+1],distanceSquared:i,distance:Math.sqrt(i)}}(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=f2,n=b_,r=iXe,i=u(jU),o=u(Iae),a=u(Mae),s=xL;function u(be){return be&&be.__esModule?be:{default:be}}function d(be){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?d=function(Re){return typeof Re}:d=function(Re){return Re&&typeof Symbol=="function"&&Re.constructor===Symbol&&Re!==Symbol.prototype?"symbol":typeof Re},d(be)}function g(be,De){return D(be)||O(be,De)||E(be,De)||_()}function _(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function E(be,De){if(be){if(typeof be=="string")return P(be,De);var Re=Object.prototype.toString.call(be).slice(8,-1);if(Re==="Object"&&be.constructor&&(Re=be.constructor.name),Re==="Map"||Re==="Set")return Array.from(Re);if(Re==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Re))return P(be,De)}}function P(be,De){(De==null||De>be.length)&&(De=be.length);for(var Re=0,qe=new Array(De);Re<De;Re++)qe[Re]=be[Re];return qe}function O(be,De){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(be)))){var Re=[],qe=!0,ct=!1,Ct=void 0;try{for(var Dt=be[Symbol.iterator](),In;!(qe=(In=Dt.next()).done)&&(Re.push(In.value),!(De&&Re.length===De));qe=!0);}catch(Mn){ct=!0,Ct=Mn}finally{try{!qe&&Dt.return!=null&&Dt.return()}finally{if(ct)throw Ct}}return Re}}function D(be){if(Array.isArray(be))return be}function V(be,De){if(!(be instanceof De))throw new TypeError("Cannot call a class as a function")}function k(be,De){for(var Re=0;Re<De.length;Re++){var qe=De[Re];qe.enumerable=qe.enumerable||!1,qe.configurable=!0,"value"in qe&&(qe.writable=!0),Object.defineProperty(be,qe.key,qe)}}function F(be,De,Re){return De&&k(be.prototype,De),Re&&k(be,Re),be}function z(be){return function(){var De=re(be),Re;if(J()){var qe=re(this).constructor;Re=Reflect.construct(De,arguments,qe)}else Re=De.apply(this,arguments);return X(this,Re)}}function X(be,De){return De&&(d(De)==="object"||typeof De=="function")?De:Y(be)}function Y(be){if(be===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return be}function J(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function re(be){return re=Object.setPrototypeOf?Object.getPrototypeOf:function(Re){return Re.__proto__||Object.getPrototypeOf(Re)},re(be)}function ue(be,De){if(typeof De!="function"&&De!==null)throw new TypeError("Super expression must either be null or a function");be.prototype=Object.create(De&&De.prototype,{constructor:{value:be,writable:!0,configurable:!0}}),De&&ie(be,De)}function ie(be,De){return ie=Object.setPrototypeOf||function(qe,ct){return qe.__proto__=ct,qe},ie(be,De)}function ce(be,De,Re){return De in be?Object.defineProperty(be,De,{value:Re,enumerable:!0,configurable:!0,writable:!0}):be[De]=Re,be}var se=.1,me=.2,Ce=.05,we=r.SimpleMeshLayer,Ye={mesh:new o.default({headSize:me,tailWidth:Ce})},at=Object.assign({},i.default.defaultProps,{MarkerLayer:we,markerLayerProps:Ye,sizeScale:100,fp64:!1,highlightIndex:-1,highlightPoint:null,getPath:function(De){return De.path},getColor:function(De){return De.color},getMarkerColor:function(De){return[0,0,0,255]},getDirection:function(De){return De.direction},getMarkerPercentages:function(De,Re){var qe=Re.lineLength;return qe>se?[.25,.5,.75]:[.5]}}),yt=function(be){ue(Re,be);var De=z(Re);function Re(){return V(this,Re),De.apply(this,arguments)}return F(Re,[{key:"initializeState",value:function(){this.state={markers:[],mesh:new o.default({headSize:me,tailWidth:Ce}),closestPoint:null}}},{key:"projectFlat",value:function(ct,Ct,Dt,In){if(Dt===e.COORDINATE_SYSTEM.METER_OFFSETS){var Mn=Ct.metersToLngLatDelta(ct),Tn=g(Mn,2),Nt=Tn[0],Zt=Tn[1],Wt=g(In,2),hn=Wt[0],lr=Wt[1];return Ct.projectFlat([hn+Nt,Zt+lr])}else if(Dt===e.COORDINATE_SYSTEM.LNGLAT_OFFSETS){var It=g(ct,2),Xt=It[0],$t=It[1],cn=g(In,2),Jt=cn[0],Ln=cn[1];return Ct.projectFlat([Jt+Xt,$t+Ln])}return Ct.projectFlat(ct)}},{key:"updateState",value:function(ct){var Ct=this,Dt=ct.props,In=ct.oldProps,Mn=ct.changeFlags;if(Mn.dataChanged||Mn.updateTriggersChanged){var Tn=this.props,Nt=Tn.data,Zt=Tn.getPath,Wt=Tn.getDirection,hn=Tn.getMarkerColor,lr=Tn.getMarkerPercentages,It=Tn.coordinateSystem,Xt=Tn.coordinateOrigin,$t=this.context.viewport,cn=function(Ln){return Ct.projectFlat(Ln,$t,It,Xt)};this.state.markers=(0,a.default)({data:Nt,getPath:Zt,getDirection:Wt,getColor:hn,getMarkerPercentages:lr,projectFlat:cn}),this._recalculateClosestPoint()}Mn.propsChanged&&Dt.point!==In.point&&this._recalculateClosestPoint()}},{key:"_recalculateClosestPoint",value:function(){var ct=this.props,Ct=ct.highlightPoint,Dt=ct.highlightIndex;if(Ct&&Dt>=0){var In=this.props.data[Dt],Mn=this.props.getPath(In),Tn=(0,s.getClosestPointOnPolyline)({points:Mn,p:Ct}),Nt=Tn.point;this.state.closestPoints=[{position:Nt}]}else this.state.closestPoints=[]}},{key:"getPickingInfo",value:function(ct){var Ct=ct.info;return Object.assign(Ct,{object:Ct.object&&Ct.object.path||Ct.object})}},{key:"renderLayers",value:function(){return[new i.default(this.props,this.getSubLayerProps({id:"paths",data:this.props.data})),new this.props.MarkerLayer(this.getSubLayerProps(Object.assign({},this.props.markerLayerProps,{id:"markers",data:this.state.markers,getOrientation:function(Ct){return[0,-Ct.angle,0]},getColor:function(Ct){return Ct.color},sizeScale:this.props.sizeScale,fp64:this.props.fp64,pickable:!1,parameters:{blend:!1,depthTest:!1}}))),this.state.closestPoints&&new n.ScatterplotLayer({id:"".concat(this.props.id,"-highlight"),data:this.state.closestPoints,fp64:this.props.fp64})]}}]),Re}(e.CompositeLayer);t.default=yt,ce(yt,"layerName","PathMarkerLayer"),ce(yt,"defaultProps",at)})(Pae);var Lae={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=f2,n=b_;function r(F){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?r=function(X){return typeof X}:r=function(X){return X&&typeof Symbol=="function"&&X.constructor===Symbol&&X!==Symbol.prototype?"symbol":typeof X},r(F)}function i(F,z){var X=Object.keys(F);if(Object.getOwnPropertySymbols){var Y=Object.getOwnPropertySymbols(F);z&&(Y=Y.filter(function(J){return Object.getOwnPropertyDescriptor(F,J).enumerable})),X.push.apply(X,Y)}return X}function o(F){for(var z=1;z<arguments.length;z++){var X=arguments[z]!=null?arguments[z]:{};z%2?i(Object(X),!0).forEach(function(Y){V(F,Y,X[Y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(F,Object.getOwnPropertyDescriptors(X)):i(Object(X)).forEach(function(Y){Object.defineProperty(F,Y,Object.getOwnPropertyDescriptor(X,Y))})}return F}function a(F,z){if(!(F instanceof z))throw new TypeError("Cannot call a class as a function")}function s(F,z){for(var X=0;X<z.length;X++){var Y=z[X];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(F,Y.key,Y)}}function u(F,z,X){return z&&s(F.prototype,z),X&&s(F,X),F}function d(F){return function(){var z=P(F),X;if(E()){var Y=P(this).constructor;X=Reflect.construct(z,arguments,Y)}else X=z.apply(this,arguments);return g(this,X)}}function g(F,z){return z&&(r(z)==="object"||typeof z=="function")?z:_(F)}function _(F){if(F===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F}function E(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function P(F){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(X){return X.__proto__||Object.getPrototypeOf(X)},P(F)}function O(F,z){if(typeof z!="function"&&z!==null)throw new TypeError("Super expression must either be null or a function");F.prototype=Object.create(z&&z.prototype,{constructor:{value:F,writable:!0,configurable:!0}}),z&&D(F,z)}function D(F,z){return D=Object.setPrototypeOf||function(Y,J){return Y.__proto__=J,Y},D(F,z)}function V(F,z,X){return z in F?Object.defineProperty(F,z,{value:X,enumerable:!0,configurable:!0,writable:!0}):F[z]=X,F}var k=function(F){O(X,F);var z=d(X);function X(){return a(this,X),z.apply(this,arguments)}return u(X,[{key:"renderLayers",value:function(){var J=this.props,re=J.id,ue=J.getFillColor,ie=J.getStrokeColor,ce=J.getInnerRadius,se=J.updateTriggers;return[new n.ScatterplotLayer(o({},this.props,{id:"".concat(re,"-full"),data:this.props.data,getLineColor:ie,updateTriggers:o({},se,{getStrokeColor:se.getStrokeColor})})),new n.ScatterplotLayer(o({},this.props,{id:"".concat(re,"-inner"),data:this.props.data,getFillColor:ue,getRadius:ce,pickable:!1,updateTriggers:o({},se,{getFillColor:se.getFillColor,getRadius:se.getInnerRadius})}))]}}]),X}(e.CompositeLayer);t.default=k,V(k,"layerName","JunctionScatterplotLayer"),V(k,"defaultProps",o({},n.ScatterplotLayer.defaultProps,{getFillColor:function(z){return[0,0,0,255]},getStrokeColor:function(z){return[255,255,255,255]},getInnerRadius:function(z){return 1}}))})(Lae);(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ArrowStyles",{enumerable:!0,get:function(){return e.ArrowStyles}}),Object.defineProperty(t,"DEFAULT_ARROWS",{enumerable:!0,get:function(){return e.DEFAULT_ARROWS}}),Object.defineProperty(t,"MAX_ARROWS",{enumerable:!0,get:function(){return e.MAX_ARROWS}}),Object.defineProperty(t,"EditableGeoJsonLayer",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"EditableH3ClusterLayer",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"SelectionLayer",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"ElevatedEditHandleLayer",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"PathOutlineLayer",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"PathMarkerLayer",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"JunctionScatterplotLayer",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"toDeckColor",{enumerable:!0,get:function(){return d.toDeckColor}});var e=qm,n=g(XR),r=g(koe),i=g(Eae),o=g(Sae),a=g(jU),s=g(Pae),u=g(Lae),d=rp;function g(_){return _&&_.__esModule?_:{default:_}}})(uoe);const aXe="modulepreload",lXe=function(t){return"/"+t},rZ={},uXe=function(e,n,r){if(!n||n.length===0)return e();const i=document.getElementsByTagName("link");return Promise.all(n.map(o=>{if(o=lXe(o),o in rZ)return;rZ[o]=!0;const a=o.endsWith(".css"),s=a?'[rel="stylesheet"]':"";if(!!r)for(let g=i.length-1;g>=0;g--){const _=i[g];if(_.href===o&&(!a||_.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${s}`))return;const d=document.createElement("link");if(d.rel=a?"stylesheet":aXe,a||(d.as="script",d.crossOrigin=""),d.href=o,document.head.appendChild(d),a)return new Promise((g,_)=>{d.addEventListener("load",g),d.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>e()).catch(o=>{const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=o,window.dispatchEvent(a),!a.defaultPrevented)throw o})},cXe=Ee.createContext(null);function fXe(t,e){const n=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,o=Array.isArray(e)?e[1]:e?e.y:0;return n===i&&r===o}function Wp(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Wp(t[n],e[n]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n)if(!e.hasOwnProperty(i)||!Wp(t[i],e[i]))return!1;return!0}return!1}function hXe(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function iZ(t,e){if(!t.getProjection)return;const n=t.getProjection(),r=e.getProjection();Wp(n,r)||e.setProjection(n)}function oZ(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function sZ(t,e){const n=e.viewState||e;let r=!1;if("longitude"in n&&"latitude"in n){const i=t.center;t.center=new i.constructor(n.longitude,n.latitude),r=r||i!==t.center}if("zoom"in n){const i=t.zoom;t.zoom=n.zoom,r=r||i!==t.zoom}if("bearing"in n){const i=t.bearing;t.bearing=n.bearing,r=r||i!==t.bearing}if("pitch"in n){const i=t.pitch;t.pitch=n.pitch,r=r||i!==t.pitch}return n.padding&&!t.isPaddingEqual(n.padding)&&(r=!0,t.padding=n.padding),r}const dXe=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function aZ(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const r of t.layers)e[r.id]=r;const n=t.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const o=e[r.ref];if(o){i=i||Object.assign({},r),delete i.ref;for(const a of dXe)a in o&&(i[a]=o[a])}return i||r});return{...t,layers:n}}const lZ={version:8,sources:{},layers:[]},uZ={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},cN={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},cZ={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},pXe=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],gXe=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class E1{constructor(e,n,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const o=this.props[cZ[i.type]];o?o(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const o=this.props[uZ[i.type]];o&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),o(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const o=this.props[cN[i.type]];o&&o(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=n,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const n=this.props;this.props=e;const r=this._updateSettings(e,n);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),o=this._updateViewState(e,!0);this._updateStyle(e,n),this._updateStyleComponents(e,n),this._updateHandlers(e,n),(r||i||o&&!this._map.isMoving())&&this.redraw()}static reuse(e,n){const r=E1.savedMaps.pop();if(!r)return null;const i=r.map,o=i.getContainer();for(n.className=o.className;o.childNodes.length>0;)n.appendChild(o.childNodes[0]);i._container=n;const a=i._resizeObserver;a&&(a.disconnect(),a.observe(n)),r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:s}=e;return s&&(s.bounds?i.fitBounds(s.bounds,{...s.fitBoundsOptions,duration:0}):r._updateViewState(s,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:n}=this,{mapStyle:r=lZ}=n,i={...n,...n.initialViewState,accessToken:n.mapboxAccessToken||mXe()||null,container:e,style:aZ(r)},o=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[o.longitude||0,o.latitude||0],zoom:o.zoom||0,pitch:o.pitch||0,bearing:o.bearing||0}),n.gl){const g=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=g,n.gl)}const a=new this._MapClass(i);o.padding&&a.setPadding(o.padding),n.cursor&&(a.getCanvas().style.cursor=n.cursor),this._createShadowTransform(a);const s=a._render;a._render=g=>{this._inRender=!0,s.call(a,g),this._inRender=!1};const u=a._renderTaskQueue.run;a._renderTaskQueue.run=g=>{u.call(a._renderTaskQueue,g),this._onBeforeRepaint()},a.on("render",()=>this._onAfterRepaint());const d=a.fire;a.fire=this._fireEvent.bind(this,d),a.on("resize",()=>{this._renderTransform.resize(a.transform.width,a.transform.height)}),a.on("styledata",()=>{this._updateStyleComponents(this.props,{}),iZ(a.transform,this._renderTransform)}),a.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const g in uZ)a.on(g,this._onPointerEvent);for(const g in cN)a.on(g,this._onCameraEvent);for(const g in cZ)a.on(g,this._onEvent);this._map=a}recycle(){const n=this.map.getContainer().querySelector("[mapboxgl-children]");n==null||n.remove(),E1.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const n=hXe(e.transform);e.painter.transform=n,this._renderTransform=n}_updateSize(e){const{viewState:n}=e;if(n){const r=this._map;if(n.width!==r.transform.width||n.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,n){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:o,pitch:a,bearing:s}=i,u=r.isMoving();u&&(i.cameraElevationReference="sea");const d=sZ(i,{...oZ(r.transform),...e});if(u&&(i.cameraElevationReference="ground"),d&&n){const g=this._deferredEvents;g.move=!0,g.zoom||(g.zoom=o!==i.zoom),g.rotate||(g.rotate=s!==i.bearing),g.pitch||(g.pitch=a!==i.pitch)}return u||sZ(r.transform,e),d}_updateSettings(e,n){const r=this._map;let i=!1;for(const o of pXe)if(o in e&&!Wp(e[o],n[o])){i=!0;const a=r[`set${o[0].toUpperCase()}${o.slice(1)}`];a==null||a.call(r,e[o])}return i}_updateStyle(e,n){if(e.cursor!==n.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==n.mapStyle){const{mapStyle:r=lZ,styleDiffing:i=!0}=e,o={diff:i};return"localIdeographFontFamily"in e&&(o.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(aZ(r),o),!0}return!1}_updateStyleComponents(e,n){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!Wp(e.light,n.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!Wp(e.fog,n.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!Wp(e.terrain,n.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,n){var r,i;const o=this._map;let a=!1;for(const s of gXe){const u=(r=e[s])!==null&&r!==void 0?r:!0,d=(i=n[s])!==null&&i!==void 0?i:!0;Wp(u,d)||(a=!0,u?o[s].enable(u):o[s].disable())}return a}_queryRenderedFeatures(e){const n=this._map,r=n.transform,{interactiveLayerIds:i=[]}=this.props;try{return n.transform=this._renderTransform,n.queryRenderedFeatures(e,{layers:i.filter(n.getLayer.bind(n))})}catch{return[]}finally{n.transform=r}}_updateHover(e){var n;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const o=e.type,a=((n=this._hoveredFeatures)===null||n===void 0?void 0:n.length)>0,s=this._queryRenderedFeatures(e.point),u=s.length>0;!u&&a&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=s,u&&!a&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=o}else this._hoveredFeatures=null}_fireEvent(e,n,r){const i=this._map,o=i.transform,a=typeof n=="string"?n:n.type;return a==="move"&&this._updateViewState(this.props,!1),a in cN&&(typeof n=="object"&&(n.viewState=oZ(o)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,n,r),i.transform=o,i):(e.call(i,n,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const n=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{iZ(this._renderTransform,n),e.transform=n}}}E1.savedMaps=[];function mXe(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||{}.MapboxAccessToken}catch{}try{t=t||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const AXe=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function _Xe(t){if(!t)return null;const e=t.map,n={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:r=>{const i=e.transform;e.transform=t.transform;const o=e.project(r);return e.transform=i,o},unproject:r=>{const i=e.transform;e.transform=t.transform;const o=e.unproject(r);return e.transform=i,o},queryTerrainElevation:(r,i)=>{const o=e.transform;e.transform=t.transform;const a=e.queryTerrainElevation(r,i);return e.transform=o,a},queryRenderedFeatures:(r,i)=>{const o=e.transform;e.transform=t.transform;const a=e.queryRenderedFeatures(r,i);return e.transform=o,a}};for(const r of yXe(e))!(r in n)&&!AXe.includes(r)&&(n[r]=e[r].bind(e));return n}function yXe(t){const e=new Set;let n=t;for(;n;){for(const r of Object.getOwnPropertyNames(n))r[0]!=="_"&&typeof t[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);n=Object.getPrototypeOf(n)}return Array.from(e)}const vXe=typeof document<"u"?Ee.useLayoutEffect:Ee.useEffect,xXe=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function bXe(t,e){for(const r of xXe)r in e&&(t[r]=e[r]);const{RTLTextPlugin:n="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;n&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(n,r=>{r&&console.error(r)},!1)}const bL=Ee.createContext(null);function wXe(t,e,n){const r=Ee.useContext(cXe),[i,o]=Ee.useState(null),a=Ee.useRef(),{current:s}=Ee.useRef({mapLib:null,map:null});Ee.useEffect(()=>{const g=t.mapLib;let _=!0,E;return Promise.resolve(g||n).then(P=>{if(!_)return;if(!P)throw new Error("Invalid mapLib");const O="Map"in P?P:P.default;if(!O.Map)throw new Error("Invalid mapLib");if(bXe(O,t),!O.supported||O.supported(t))t.reuseMaps&&(E=E1.reuse(t,a.current)),E||(E=new E1(O.Map,t,a.current)),s.map=_Xe(E),s.mapLib=O,o(E),r==null||r.onMapMount(s.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(P=>{const{onError:O}=t;O?O({type:"error",target:null,originalEvent:null,error:P}):console.error(P)}),()=>{_=!1,E&&(r==null||r.onMapUnmount(t.id),t.reuseMaps?E.recycle():E.destroy())}},[]),vXe(()=>{i&&i.setProps(t)}),Ee.useImperativeHandle(e,()=>s.map,[i]);const u=Ee.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),d={height:"100%"};return Ee.createElement("div",{id:t.id,ref:a,style:u},i&&Ee.createElement(bL.Provider,{value:s},Ee.createElement("div",{"mapboxgl-children":"",style:d},t.children)))}const EXe=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function T_(t,e){if(!t||!e)return;const n=t.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!EXe.test(r)?n[r]=`${i}px`:n[r]=i}}function SXe(t,e){const{map:n,mapLib:r}=Ee.useContext(bL),i=Ee.useRef({props:t});i.current.props=t;const o=Ee.useMemo(()=>{let D=!1;Ee.Children.forEach(t.children,F=>{F&&(D=!0)});const V={...t,element:D?document.createElement("div"):null},k=new r.Marker(V);return k.setLngLat([t.longitude,t.latitude]),k.getElement().addEventListener("click",F=>{var z,X;(X=(z=i.current.props).onClick)===null||X===void 0||X.call(z,{type:"click",target:k,originalEvent:F})}),k.on("dragstart",F=>{var z,X;const Y=F;Y.lngLat=o.getLngLat(),(X=(z=i.current.props).onDragStart)===null||X===void 0||X.call(z,Y)}),k.on("drag",F=>{var z,X;const Y=F;Y.lngLat=o.getLngLat(),(X=(z=i.current.props).onDrag)===null||X===void 0||X.call(z,Y)}),k.on("dragend",F=>{var z,X;const Y=F;Y.lngLat=o.getLngLat(),(X=(z=i.current.props).onDragEnd)===null||X===void 0||X.call(z,Y)}),k},[]);Ee.useEffect(()=>(o.addTo(n.getMap()),()=>{o.remove()}),[]);const{longitude:a,latitude:s,offset:u,style:d,draggable:g=!1,popup:_=null,rotation:E=0,rotationAlignment:P="auto",pitchAlignment:O="auto"}=t;return Ee.useEffect(()=>{T_(o.getElement(),d)},[d]),Ee.useImperativeHandle(e,()=>o,[]),(o.getLngLat().lng!==a||o.getLngLat().lat!==s)&&o.setLngLat([a,s]),u&&!fXe(o.getOffset(),u)&&o.setOffset(u),o.isDraggable()!==g&&o.setDraggable(g),o.getRotation()!==E&&o.setRotation(E),o.getRotationAlignment()!==P&&o.setRotationAlignment(P),o.getPitchAlignment()!==O&&o.setPitchAlignment(O),o.getPopup()!==_&&o.setPopup(_),PE.createPortal(t.children,o.getElement())}Ee.memo(Ee.forwardRef(SXe));function fZ(t){return new Set(t?t.trim().split(/\s+/):[])}function TXe(t,e){const{map:n,mapLib:r}=Ee.useContext(bL),i=Ee.useMemo(()=>document.createElement("div"),[]),o=Ee.useRef({props:t});o.current.props=t;const a=Ee.useMemo(()=>{const s={...t},u=new r.Popup(s);return u.setLngLat([t.longitude,t.latitude]),u.once("open",d=>{var g,_;(_=(g=o.current.props).onOpen)===null||_===void 0||_.call(g,d)}),u},[]);if(Ee.useEffect(()=>{const s=u=>{var d,g;(g=(d=o.current.props).onClose)===null||g===void 0||g.call(d,u)};return a.on("close",s),a.setDOMContent(i).addTo(n.getMap()),()=>{a.off("close",s),a.isOpen()&&a.remove()}},[]),Ee.useEffect(()=>{T_(a.getElement(),t.style)},[t.style]),Ee.useImperativeHandle(e,()=>a,[]),a.isOpen()&&((a.getLngLat().lng!==t.longitude||a.getLngLat().lat!==t.latitude)&&a.setLngLat([t.longitude,t.latitude]),t.offset&&!Wp(a.options.offset,t.offset)&&a.setOffset(t.offset),(a.options.anchor!==t.anchor||a.options.maxWidth!==t.maxWidth)&&(a.options.anchor=t.anchor,a.setMaxWidth(t.maxWidth)),a.options.className!==t.className)){const s=fZ(a.options.className),u=fZ(t.className);for(const d of s)u.has(d)||a.removeClassName(d);for(const d of u)s.has(d)||a.addClassName(d);a.options.className=t.className}return PE.createPortal(t.children,i)}Ee.memo(Ee.forwardRef(TXe));function p2(t,e,n,r){const i=Ee.useContext(bL),o=Ee.useMemo(()=>t(i),[]);return Ee.useEffect(()=>{const a=r||n||e,s=typeof e=="function"&&typeof n=="function"?e:null,u=typeof n=="function"?n:typeof e=="function"?e:null,{map:d}=i;return d.hasControl(o)||(d.addControl(o,a==null?void 0:a.position),s&&s(i)),()=>{u&&u(i),d.hasControl(o)&&d.removeControl(o)}},[]),o}function CXe(t){const e=p2(({mapLib:n})=>new n.AttributionControl(t),{position:t.position});return Ee.useEffect(()=>{T_(e._container,t.style)},[t.style]),null}Ee.memo(CXe);function PXe(t){const e=p2(({mapLib:n})=>new n.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return Ee.useEffect(()=>{T_(e._controlContainer,t.style)},[t.style]),null}Ee.memo(PXe);function IXe(t,e){const n=Ee.useRef({props:t}),r=p2(({mapLib:i})=>{const o=new i.GeolocateControl(t),a=o._setupUI;return o._setupUI=s=>{o._container.hasChildNodes()||a(s)},o.on("geolocate",s=>{var u,d;(d=(u=n.current.props).onGeolocate)===null||d===void 0||d.call(u,s)}),o.on("error",s=>{var u,d;(d=(u=n.current.props).onError)===null||d===void 0||d.call(u,s)}),o.on("outofmaxbounds",s=>{var u,d;(d=(u=n.current.props).onOutOfMaxBounds)===null||d===void 0||d.call(u,s)}),o.on("trackuserlocationstart",s=>{var u,d;(d=(u=n.current.props).onTrackUserLocationStart)===null||d===void 0||d.call(u,s)}),o.on("trackuserlocationend",s=>{var u,d;(d=(u=n.current.props).onTrackUserLocationEnd)===null||d===void 0||d.call(u,s)}),o},{position:t.position});return n.current.props=t,Ee.useImperativeHandle(e,()=>r,[]),Ee.useEffect(()=>{T_(r._container,t.style)},[t.style]),null}Ee.memo(Ee.forwardRef(IXe));function MXe(t){const e=p2(({mapLib:n})=>new n.NavigationControl(t),{position:t.position});return Ee.useEffect(()=>{T_(e._container,t.style)},[t.style]),null}Ee.memo(MXe);function OXe(t){const e=p2(({mapLib:o})=>new o.ScaleControl(t),{position:t.position}),n=Ee.useRef(t),r=n.current;n.current=t;const{style:i}=t;return t.maxWidth!==void 0&&t.maxWidth!==r.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==r.unit&&e.setUnit(t.unit),Ee.useEffect(()=>{T_(e._container,i)},[i]),null}Ee.memo(OXe);const RXe=uXe(()=>Promise.resolve().then(()=>eat),void 0),LXe=(()=>Ee.forwardRef(function(e,n){return wXe(e,n,RXe)}))();var Od=function(){return Od=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Od.apply(this,arguments)};function Dae(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function DXe(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,o;r<i;r++)(o||!(r in e))&&(o||(o=Array.prototype.slice.call(e,0,r)),o[r]=e[r]);return t.concat(o||Array.prototype.slice.call(e))}var _P="right-scroll-bar-position",yP="width-before-scroll-bar",BXe="with-scroll-bars-hidden",NXe="--removed-body-scroll-bar-size";function FXe(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function kXe(t,e){var n=Ee.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}function zXe(t,e){return kXe(e||null,function(n){return t.forEach(function(r){return FXe(r,n)})})}function UXe(t){return t}function GXe(t,e){e===void 0&&(e=UXe);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(o){var a=e(o,r);return n.push(a),function(){n=n.filter(function(s){return s!==a})}},assignSyncMedium:function(o){for(r=!0;n.length;){var a=n;n=[],a.forEach(o)}n={push:function(s){return o(s)},filter:function(){return n}}},assignMedium:function(o){r=!0;var a=[];if(n.length){var s=n;n=[],s.forEach(o),a=n}var u=function(){var g=a;a=[],g.forEach(o)},d=function(){return Promise.resolve().then(u)};d(),n={push:function(g){a.push(g),d()},filter:function(g){return a=a.filter(g),n}}}};return i}function jXe(t){t===void 0&&(t={});var e=GXe(null);return e.options=Od({async:!0,ssr:!1},t),e}var Bae=function(t){var e=t.sideCar,n=Dae(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return Ee.createElement(r,Od({},n))};Bae.isSideCarExport=!0;function VXe(t,e){return t.useMedium(e),Bae}var Nae=jXe(),fN=function(){},wL=Ee.forwardRef(function(t,e){var n=Ee.useRef(null),r=Ee.useState({onScrollCapture:fN,onWheelCapture:fN,onTouchMoveCapture:fN}),i=r[0],o=r[1],a=t.forwardProps,s=t.children,u=t.className,d=t.removeScrollBar,g=t.enabled,_=t.shards,E=t.sideCar,P=t.noIsolation,O=t.inert,D=t.allowPinchZoom,V=t.as,k=V===void 0?"div":V,F=t.gapMode,z=Dae(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),X=E,Y=zXe([n,e]),J=Od(Od({},z),i);return Ee.createElement(Ee.Fragment,null,g&&Ee.createElement(X,{sideCar:Nae,removeScrollBar:d,shards:_,noIsolation:P,inert:O,setCallbacks:o,allowPinchZoom:!!D,lockRef:n,gapMode:F}),a?Ee.cloneElement(Ee.Children.only(s),Od(Od({},J),{ref:Y})):Ee.createElement(k,Od({},J,{className:u,ref:Y}),s))});wL.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};wL.classNames={fullWidth:yP,zeroRight:_P};var hZ,$Xe=function(){if(hZ)return hZ;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function HXe(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=$Xe();return e&&t.setAttribute("nonce",e),t}function WXe(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function qXe(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var XXe=function(){var t=0,e=null;return{add:function(n){t==0&&(e=HXe())&&(WXe(e,n),qXe(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},ZXe=function(){var t=XXe();return function(e,n){Ee.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},Fae=function(){var t=ZXe(),e=function(n){var r=n.styles,i=n.dynamic;return t(r,i),null};return e},YXe={left:0,top:0,right:0,gap:0},hN=function(t){return parseInt(t||"",10)||0},QXe=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[hN(n),hN(r),hN(i)]},KXe=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return YXe;var e=QXe(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},JXe=Fae(),eZe=function(t,e,n,r){var i=t.left,o=t.top,a=t.right,s=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(BXe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(s,"px ").concat(r,`;
  }
  body {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(o,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(s,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(s,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(_P,` {
    right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(yP,` {
    margin-right: `).concat(s,"px ").concat(r,`;
  }
  
  .`).concat(_P," .").concat(_P,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(yP," .").concat(yP,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body {
    `).concat(NXe,": ").concat(s,`px;
  }
`)},tZe=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,i=r===void 0?"margin":r,o=Ee.useMemo(function(){return KXe(i)},[i]);return Ee.createElement(JXe,{styles:eZe(o,!e,i,n?"":"!important")})},H4=!1;if(typeof window<"u")try{var ET=Object.defineProperty({},"passive",{get:function(){return H4=!0,!0}});window.addEventListener("test",ET,ET),window.removeEventListener("test",ET,ET)}catch{H4=!1}var Dy=H4?{passive:!1}:!1,nZe=function(t){return t.tagName==="TEXTAREA"},kae=function(t,e){var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!nZe(t)&&n[e]==="visible")},rZe=function(t){return kae(t,"overflowY")},iZe=function(t){return kae(t,"overflowX")},dZ=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=zae(t,r);if(i){var o=Uae(t,r),a=o[1],s=o[2];if(a>s)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},oZe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},sZe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},zae=function(t,e){return t==="v"?rZe(e):iZe(e)},Uae=function(t,e){return t==="v"?oZe(e):sZe(e)},aZe=function(t,e){return t==="h"&&e==="rtl"?-1:1},lZe=function(t,e,n,r,i){var o=aZe(t,window.getComputedStyle(e).direction),a=o*r,s=n.target,u=e.contains(s),d=!1,g=a>0,_=0,E=0;do{var P=Uae(t,s),O=P[0],D=P[1],V=P[2],k=D-V-o*O;(O||k)&&zae(t,s)&&(_+=k,E+=O),s instanceof ShadowRoot?s=s.host:s=s.parentNode}while(!u&&s!==document.body||u&&(e.contains(s)||e===s));return(g&&(i&&Math.abs(_)<1||!i&&a>_)||!g&&(i&&Math.abs(E)<1||!i&&-a>E))&&(d=!0),d},ST=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},pZ=function(t){return[t.deltaX,t.deltaY]},gZ=function(t){return t&&"current"in t?t.current:t},uZe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},cZe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},fZe=0,By=[];function hZe(t){var e=Ee.useRef([]),n=Ee.useRef([0,0]),r=Ee.useRef(),i=Ee.useState(fZe++)[0],o=Ee.useState(Fae)[0],a=Ee.useRef(t);Ee.useEffect(function(){a.current=t},[t]),Ee.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var D=DXe([t.lockRef.current],(t.shards||[]).map(gZ),!0).filter(Boolean);return D.forEach(function(V){return V.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),D.forEach(function(V){return V.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var s=Ee.useCallback(function(D,V){if("touches"in D&&D.touches.length===2)return!a.current.allowPinchZoom;var k=ST(D),F=n.current,z="deltaX"in D?D.deltaX:F[0]-k[0],X="deltaY"in D?D.deltaY:F[1]-k[1],Y,J=D.target,re=Math.abs(z)>Math.abs(X)?"h":"v";if("touches"in D&&re==="h"&&J.type==="range")return!1;var ue=dZ(re,J);if(!ue)return!0;if(ue?Y=re:(Y=re==="v"?"h":"v",ue=dZ(re,J)),!ue)return!1;if(!r.current&&"changedTouches"in D&&(z||X)&&(r.current=Y),!Y)return!0;var ie=r.current||Y;return lZe(ie,V,D,ie==="h"?z:X,!0)},[]),u=Ee.useCallback(function(D){var V=D;if(!(!By.length||By[By.length-1]!==o)){var k="deltaY"in V?pZ(V):ST(V),F=e.current.filter(function(Y){return Y.name===V.type&&(Y.target===V.target||V.target===Y.shadowParent)&&uZe(Y.delta,k)})[0];if(F&&F.should){V.cancelable&&V.preventDefault();return}if(!F){var z=(a.current.shards||[]).map(gZ).filter(Boolean).filter(function(Y){return Y.contains(V.target)}),X=z.length>0?s(V,z[0]):!a.current.noIsolation;X&&V.cancelable&&V.preventDefault()}}},[]),d=Ee.useCallback(function(D,V,k,F){var z={name:D,delta:V,target:k,should:F,shadowParent:dZe(k)};e.current.push(z),setTimeout(function(){e.current=e.current.filter(function(X){return X!==z})},1)},[]),g=Ee.useCallback(function(D){n.current=ST(D),r.current=void 0},[]),_=Ee.useCallback(function(D){d(D.type,pZ(D),D.target,s(D,t.lockRef.current))},[]),E=Ee.useCallback(function(D){d(D.type,ST(D),D.target,s(D,t.lockRef.current))},[]);Ee.useEffect(function(){return By.push(o),t.setCallbacks({onScrollCapture:_,onWheelCapture:_,onTouchMoveCapture:E}),document.addEventListener("wheel",u,Dy),document.addEventListener("touchmove",u,Dy),document.addEventListener("touchstart",g,Dy),function(){By=By.filter(function(D){return D!==o}),document.removeEventListener("wheel",u,Dy),document.removeEventListener("touchmove",u,Dy),document.removeEventListener("touchstart",g,Dy)}},[]);var P=t.removeScrollBar,O=t.inert;return Ee.createElement(Ee.Fragment,null,O?Ee.createElement(o,{styles:cZe(i)}):null,P?Ee.createElement(tZe,{gapMode:t.gapMode}):null)}function dZe(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const pZe=VXe(Nae,hZe);var Gae=Ee.forwardRef(function(t,e){return Ee.createElement(wL,Od({},t,{ref:e,sideCar:pZe}))});Gae.classNames=wL.classNames;const gZe=Gae;function EL(t){const e=Ee.createContext(null);return[({children:i,value:o})=>ut.createElement(e.Provider,{value:o},i),()=>{const i=Ee.useContext(e);if(i===null)throw new Error(t);return i}]}function mZe(t){return Array.isArray(t)?t:[t]}const AZe=()=>{};function _Ze(t,e={active:!0}){return typeof t!="function"||!e.active?e.onKeyDown||AZe:n=>{var r;n.key==="Escape"&&(t(n),(r=e.onTrigger)==null||r.call(e))}}function gM(t,e){return n=>{t==null||t(n),e==null||e(n)}}function g2(t){return Array.isArray(t)||t===null?!1:typeof t=="object"?t.type!==ut.Fragment:!1}function jae(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=jae(t[e]))&&(r&&(r+=" "),r+=n);else for(e in t)t[e]&&(r&&(r+=" "),r+=e);return r}function Vae(){for(var t=0,e,n,r="";t<arguments.length;)(e=arguments[t++])&&(n=jae(e))&&(r&&(r+=" "),r+=n);return r}const yZe={dark:["#C1C2C5","#A6A7AB","#909296","#5c5f66","#373A40","#2C2E33","#25262b","#1A1B1E","#141517","#101113"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]};function vZe(t){return()=>({fontFamily:t.fontFamily||"sans-serif"})}var xZe=Object.defineProperty,mZ=Object.getOwnPropertySymbols,bZe=Object.prototype.hasOwnProperty,wZe=Object.prototype.propertyIsEnumerable,AZ=(t,e,n)=>e in t?xZe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_Z=(t,e)=>{for(var n in e||(e={}))bZe.call(e,n)&&AZ(t,n,e[n]);if(mZ)for(var n of mZ(e))wZe.call(e,n)&&AZ(t,n,e[n]);return t};function EZe(t){return e=>({WebkitTapHighlightColor:"transparent",[e||"&:focus"]:_Z({},t.focusRing==="always"||t.focusRing==="auto"?t.focusRingStyles.styles(t):t.focusRingStyles.resetStyles(t)),[e?e.replace(":focus",":focus:not(:focus-visible)"):"&:focus:not(:focus-visible)"]:_Z({},t.focusRing==="auto"||t.focusRing==="never"?t.focusRingStyles.resetStyles(t):null)})}function m2(t){return e=>typeof t.primaryShade=="number"?t.primaryShade:t.primaryShade[e||t.colorScheme]}function VU(t){const e=m2(t);return(n,r,i=!0,o=!0)=>{if(typeof n=="string"&&n.includes(".")){const[s,u]=n.split("."),d=parseInt(u,10);if(s in t.colors&&d>=0&&d<10)return t.colors[s][typeof r=="number"&&!o?r:d]}const a=typeof r=="number"?r:e();return n in t.colors?t.colors[n][a]:i?t.colors[t.primaryColor][a]:n}}function $ae(t){let e="";for(let n=1;n<t.length-1;n+=1)e+=`${t[n]} ${n/(t.length-1)*100}%, `;return`${t[0]} 0%, ${e}${t[t.length-1]} 100%`}function SZe(t,...e){return`linear-gradient(${t}deg, ${$ae(e)})`}function TZe(...t){return`radial-gradient(circle, ${$ae(t)})`}function Hae(t){const e=VU(t),n=m2(t);return r=>{const i={from:(r==null?void 0:r.from)||t.defaultGradient.from,to:(r==null?void 0:r.to)||t.defaultGradient.to,deg:(r==null?void 0:r.deg)||t.defaultGradient.deg};return`linear-gradient(${i.deg}deg, ${e(i.from,n(),!1)} 0%, ${e(i.to,n(),!1)} 100%)`}}function Wae(t){return e=>{if(typeof e=="number")return`${e/16}${t}`;if(typeof e=="string"){const n=e.replace("px","");if(!Number.isNaN(Number(n)))return`${Number(n)/16}${t}`}return e}}const pn=Wae("rem"),SL=Wae("em");function Zr({size:t,sizes:e,units:n}){return t in e?e[t]:typeof t=="number"?n==="em"?SL(t):pn(t):t||e.md}function S1(t){return typeof t=="number"?t:typeof t=="string"&&t.includes("rem")?Number(t.replace("rem",""))*16:typeof t=="string"&&t.includes("em")?Number(t.replace("em",""))*16:Number(t)}function CZe(t){return e=>`@media (min-width: ${SL(S1(Zr({size:e,sizes:t.breakpoints})))})`}function PZe(t){return e=>`@media (max-width: ${SL(S1(Zr({size:e,sizes:t.breakpoints}))-1)})`}function IZe(t){return/^#?([0-9A-F]{3}){1,2}$/i.test(t)}function MZe(t){let e=t.replace("#","");if(e.length===3){const a=e.split("");e=[a[0],a[0],a[1],a[1],a[2],a[2]].join("")}const n=parseInt(e,16),r=n>>16&255,i=n>>8&255,o=n&255;return{r,g:i,b:o,a:1}}function OZe(t){const[e,n,r,i]=t.replace(/[^0-9,.]/g,"").split(",").map(Number);return{r:e,g:n,b:r,a:i||1}}function $U(t){return IZe(t)?MZe(t):t.startsWith("rgb")?OZe(t):{r:0,g:0,b:0,a:1}}function jy(t,e){if(typeof t!="string"||e>1||e<0)return"rgba(0, 0, 0, 1)";if(t.startsWith("var(--"))return t;const{r:n,g:r,b:i}=$U(t);return`rgba(${n}, ${r}, ${i}, ${e})`}function RZe(t=0){return{position:"absolute",top:pn(t),right:pn(t),left:pn(t),bottom:pn(t)}}function LZe(t,e){if(typeof t=="string"&&t.startsWith("var(--"))return t;const{r:n,g:r,b:i,a:o}=$U(t),a=1-e,s=u=>Math.round(u*a);return`rgba(${s(n)}, ${s(r)}, ${s(i)}, ${o})`}function DZe(t,e){if(typeof t=="string"&&t.startsWith("var(--"))return t;const{r:n,g:r,b:i,a:o}=$U(t),a=s=>Math.round(s+(255-s)*e);return`rgba(${a(n)}, ${a(r)}, ${a(i)}, ${o})`}function BZe(t){return e=>{if(typeof e=="number")return pn(e);const n=typeof t.defaultRadius=="number"?t.defaultRadius:t.radius[t.defaultRadius]||t.defaultRadius;return t.radius[e]||e||n}}function NZe(t,e){if(typeof t=="string"&&t.includes(".")){const[n,r]=t.split("."),i=parseInt(r,10);if(n in e.colors&&i>=0&&i<10)return{isSplittedColor:!0,key:n,shade:i}}return{isSplittedColor:!1}}function FZe(t){const e=VU(t),n=m2(t),r=Hae(t);return({variant:i,color:o,gradient:a,primaryFallback:s})=>{const u=NZe(o,t);switch(i){case"light":return{border:"transparent",background:jy(e(o,t.colorScheme==="dark"?8:0,s,!1),t.colorScheme==="dark"?.2:1),color:o==="dark"?t.colorScheme==="dark"?t.colors.dark[0]:t.colors.dark[9]:e(o,t.colorScheme==="dark"?2:n("light")),hover:jy(e(o,t.colorScheme==="dark"?7:1,s,!1),t.colorScheme==="dark"?.25:.65)};case"subtle":return{border:"transparent",background:"transparent",color:o==="dark"?t.colorScheme==="dark"?t.colors.dark[0]:t.colors.dark[9]:e(o,t.colorScheme==="dark"?2:n("light")),hover:jy(e(o,t.colorScheme==="dark"?8:0,s,!1),t.colorScheme==="dark"?.2:1)};case"outline":return{border:e(o,t.colorScheme==="dark"?5:n("light")),background:"transparent",color:e(o,t.colorScheme==="dark"?5:n("light")),hover:t.colorScheme==="dark"?jy(e(o,5,s,!1),.05):jy(e(o,0,s,!1),.35)};case"default":return{border:t.colorScheme==="dark"?t.colors.dark[4]:t.colors.gray[4],background:t.colorScheme==="dark"?t.colors.dark[6]:t.white,color:t.colorScheme==="dark"?t.white:t.black,hover:t.colorScheme==="dark"?t.colors.dark[5]:t.colors.gray[0]};case"white":return{border:"transparent",background:t.white,color:e(o,n()),hover:null};case"transparent":return{border:"transparent",color:o==="dark"?t.colorScheme==="dark"?t.colors.dark[0]:t.colors.dark[9]:e(o,t.colorScheme==="dark"?2:n("light")),background:"transparent",hover:null};case"gradient":return{background:r(a),color:t.white,border:"transparent",hover:null};default:{const d=n(),g=u.isSplittedColor?u.shade:d,_=u.isSplittedColor?u.key:o;return{border:"transparent",background:e(_,g,s),color:t.white,hover:e(_,g===9?8:g+1)}}}}}function kZe(t){return e=>{const n=m2(t)(e);return t.colors[t.primaryColor][n]}}function zZe(t){return{"@media (hover: hover)":{"&:hover":t},"@media (hover: none)":{"&:active":t}}}function UZe(t){return()=>({userSelect:"none",color:t.colorScheme==="dark"?t.colors.dark[3]:t.colors.gray[5]})}function GZe(t){return()=>t.colorScheme==="dark"?t.colors.dark[2]:t.colors.gray[6]}const Js={fontStyles:vZe,themeColor:VU,focusStyles:EZe,linearGradient:SZe,radialGradient:TZe,smallerThan:PZe,largerThan:CZe,rgba:jy,cover:RZe,darken:LZe,lighten:DZe,radius:BZe,variant:FZe,primaryShade:m2,hover:zZe,gradient:Hae,primaryColor:kZe,placeholderStyles:UZe,dimmed:GZe};var jZe=Object.defineProperty,VZe=Object.defineProperties,$Ze=Object.getOwnPropertyDescriptors,yZ=Object.getOwnPropertySymbols,HZe=Object.prototype.hasOwnProperty,WZe=Object.prototype.propertyIsEnumerable,vZ=(t,e,n)=>e in t?jZe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qZe=(t,e)=>{for(var n in e||(e={}))HZe.call(e,n)&&vZ(t,n,e[n]);if(yZ)for(var n of yZ(e))WZe.call(e,n)&&vZ(t,n,e[n]);return t},XZe=(t,e)=>VZe(t,$Ze(e));function qae(t){return XZe(qZe({},t),{fn:{fontStyles:Js.fontStyles(t),themeColor:Js.themeColor(t),focusStyles:Js.focusStyles(t),largerThan:Js.largerThan(t),smallerThan:Js.smallerThan(t),radialGradient:Js.radialGradient,linearGradient:Js.linearGradient,gradient:Js.gradient(t),rgba:Js.rgba,cover:Js.cover,lighten:Js.lighten,darken:Js.darken,primaryShade:Js.primaryShade(t),radius:Js.radius(t),variant:Js.variant(t),hover:Js.hover,primaryColor:Js.primaryColor(t),placeholderStyles:Js.placeholderStyles(t),dimmed:Js.dimmed(t)}})}const ZZe={dir:"ltr",primaryShade:{light:6,dark:8},focusRing:"auto",loader:"oval",colorScheme:"light",white:"#fff",black:"#000",defaultRadius:"sm",transitionTimingFunction:"ease",colors:yZe,lineHeight:1.55,fontFamily:"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",primaryColor:"blue",respectReducedMotion:!0,cursorType:"default",defaultGradient:{from:"indigo",to:"cyan",deg:45},shadows:{xs:"0 0.0625rem 0.1875rem rgba(0, 0, 0, 0.05), 0 0.0625rem 0.125rem rgba(0, 0, 0, 0.1)",sm:"0 0.0625rem 0.1875rem rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 0.625rem 0.9375rem -0.3125rem, rgba(0, 0, 0, 0.04) 0 0.4375rem 0.4375rem -0.3125rem",md:"0 0.0625rem 0.1875rem rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 1.25rem 1.5625rem -0.3125rem, rgba(0, 0, 0, 0.04) 0 0.625rem 0.625rem -0.3125rem",lg:"0 0.0625rem 0.1875rem rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 1.75rem 1.4375rem -0.4375rem, rgba(0, 0, 0, 0.04) 0 0.75rem 0.75rem -0.4375rem",xl:"0 0.0625rem 0.1875rem rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 2.25rem 1.75rem -0.4375rem, rgba(0, 0, 0, 0.04) 0 1.0625rem 1.0625rem -0.4375rem"},fontSizes:{xs:"0.75rem",sm:"0.875rem",md:"1rem",lg:"1.125rem",xl:"1.25rem"},radius:{xs:"0.125rem",sm:"0.25rem",md:"0.5rem",lg:"1rem",xl:"2rem"},spacing:{xs:"0.625rem",sm:"0.75rem",md:"1rem",lg:"1.25rem",xl:"1.5rem"},breakpoints:{xs:"36em",sm:"48em",md:"62em",lg:"75em",xl:"88em"},headings:{fontFamily:"-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",fontWeight:700,sizes:{h1:{fontSize:"2.125rem",lineHeight:1.3,fontWeight:void 0},h2:{fontSize:"1.625rem",lineHeight:1.35,fontWeight:void 0},h3:{fontSize:"1.375rem",lineHeight:1.4,fontWeight:void 0},h4:{fontSize:"1.125rem",lineHeight:1.45,fontWeight:void 0},h5:{fontSize:"1rem",lineHeight:1.5,fontWeight:void 0},h6:{fontSize:"0.875rem",lineHeight:1.5,fontWeight:void 0}}},other:{},components:{},activeStyles:{transform:"translateY(0.0625rem)"},datesLocale:"en",globalStyles:void 0,focusRingStyles:{styles:t=>({outlineOffset:"0.125rem",outline:`0.125rem solid ${t.colors[t.primaryColor][t.colorScheme==="dark"?7:5]}`}),resetStyles:()=>({outline:"none"}),inputStyles:t=>({outline:"none",borderColor:t.colors[t.primaryColor][typeof t.primaryShade=="object"?t.primaryShade[t.colorScheme]:t.primaryShade]})}},HU=qae(ZZe);function YZe(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function QZe(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var KZe=function(){function t(n){var r=this;this._insertTag=function(i){var o;r.tags.length===0?r.insertionPoint?o=r.insertionPoint.nextSibling:r.prepend?o=r.container.firstChild:o=r.before:o=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(i,o),r.tags.push(i)},this.isSpeedy=n.speedy===void 0?!0:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(QZe(this));var i=this.tags[this.tags.length-1];if(this.isSpeedy){var o=YZe(i);try{o.insertRule(r,o.cssRules.length)}catch{}}else i.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){return r.parentNode&&r.parentNode.removeChild(r)}),this.tags=[],this.ctr=0},t}(),Al="-ms-",mM="-moz-",ki="-webkit-",Xae="comm",WU="rule",qU="decl",JZe="@import",Zae="@keyframes",eYe="@layer",tYe=Math.abs,TL=String.fromCharCode,nYe=Object.assign;function rYe(t,e){return Wa(t,0)^45?(((e<<2^Wa(t,0))<<2^Wa(t,1))<<2^Wa(t,2))<<2^Wa(t,3):0}function Yae(t){return t.trim()}function iYe(t,e){return(t=e.exec(t))?t[0]:t}function Ui(t,e,n){return t.replace(e,n)}function W4(t,e){return t.indexOf(e)}function Wa(t,e){return t.charCodeAt(e)|0}function yE(t,e,n){return t.slice(e,n)}function Td(t){return t.length}function XU(t){return t.length}function TT(t,e){return e.push(t),t}function oYe(t,e){return t.map(e).join("")}var CL=1,T1=1,Qae=0,zu=0,js=0,K1="";function PL(t,e,n,r,i,o,a){return{value:t,root:e,parent:n,type:r,props:i,children:o,line:CL,column:T1,length:a,return:""}}function Db(t,e){return nYe(PL("",null,null,"",null,null,0),t,{length:-t.length},e)}function sYe(){return js}function aYe(){return js=zu>0?Wa(K1,--zu):0,T1--,js===10&&(T1=1,CL--),js}function _c(){return js=zu<Qae?Wa(K1,zu++):0,T1++,js===10&&(T1=1,CL++),js}function Ud(){return Wa(K1,zu)}function vP(){return zu}function A2(t,e){return yE(K1,t,e)}function vE(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Kae(t){return CL=T1=1,Qae=Td(K1=t),zu=0,[]}function Jae(t){return K1="",t}function xP(t){return Yae(A2(zu-1,q4(t===91?t+2:t===40?t+1:t)))}function lYe(t){for(;(js=Ud())&&js<33;)_c();return vE(t)>2||vE(js)>3?"":" "}function uYe(t,e){for(;--e&&_c()&&!(js<48||js>102||js>57&&js<65||js>70&&js<97););return A2(t,vP()+(e<6&&Ud()==32&&_c()==32))}function q4(t){for(;_c();)switch(js){case t:return zu;case 34:case 39:t!==34&&t!==39&&q4(js);break;case 40:t===41&&q4(t);break;case 92:_c();break}return zu}function cYe(t,e){for(;_c()&&t+js!==47+10;)if(t+js===42+42&&Ud()===47)break;return"/*"+A2(e,zu-1)+"*"+TL(t===47?t:_c())}function fYe(t){for(;!vE(Ud());)_c();return A2(t,zu)}function hYe(t){return Jae(bP("",null,null,null,[""],t=Kae(t),0,[0],t))}function bP(t,e,n,r,i,o,a,s,u){for(var d=0,g=0,_=a,E=0,P=0,O=0,D=1,V=1,k=1,F=0,z="",X=i,Y=o,J=r,re=z;V;)switch(O=F,F=_c()){case 40:if(O!=108&&Wa(re,_-1)==58){W4(re+=Ui(xP(F),"&","&\f"),"&\f")!=-1&&(k=-1);break}case 34:case 39:case 91:re+=xP(F);break;case 9:case 10:case 13:case 32:re+=lYe(O);break;case 92:re+=uYe(vP()-1,7);continue;case 47:switch(Ud()){case 42:case 47:TT(dYe(cYe(_c(),vP()),e,n),u);break;default:re+="/"}break;case 123*D:s[d++]=Td(re)*k;case 125*D:case 59:case 0:switch(F){case 0:case 125:V=0;case 59+g:k==-1&&(re=Ui(re,/\f/g,"")),P>0&&Td(re)-_&&TT(P>32?bZ(re+";",r,n,_-1):bZ(Ui(re," ","")+";",r,n,_-2),u);break;case 59:re+=";";default:if(TT(J=xZ(re,e,n,d,g,i,s,z,X=[],Y=[],_),o),F===123)if(g===0)bP(re,e,J,J,X,o,_,s,Y);else switch(E===99&&Wa(re,3)===110?100:E){case 100:case 108:case 109:case 115:bP(t,J,J,r&&TT(xZ(t,J,J,0,0,i,s,z,i,X=[],_),Y),i,Y,_,s,r?X:Y);break;default:bP(re,J,J,J,[""],Y,0,s,Y)}}d=g=P=0,D=k=1,z=re="",_=a;break;case 58:_=1+Td(re),P=O;default:if(D<1){if(F==123)--D;else if(F==125&&D++==0&&aYe()==125)continue}switch(re+=TL(F),F*D){case 38:k=g>0?1:(re+="\f",-1);break;case 44:s[d++]=(Td(re)-1)*k,k=1;break;case 64:Ud()===45&&(re+=xP(_c())),E=Ud(),g=_=Td(z=re+=fYe(vP())),F++;break;case 45:O===45&&Td(re)==2&&(D=0)}}return o}function xZ(t,e,n,r,i,o,a,s,u,d,g){for(var _=i-1,E=i===0?o:[""],P=XU(E),O=0,D=0,V=0;O<r;++O)for(var k=0,F=yE(t,_+1,_=tYe(D=a[O])),z=t;k<P;++k)(z=Yae(D>0?E[k]+" "+F:Ui(F,/&\f/g,E[k])))&&(u[V++]=z);return PL(t,e,n,i===0?WU:s,u,d,g)}function dYe(t,e,n){return PL(t,e,n,Xae,TL(sYe()),yE(t,2,-2),0)}function bZ(t,e,n,r){return PL(t,e,n,qU,yE(t,0,r),yE(t,r+1,-1),r)}function Tv(t,e){for(var n="",r=XU(t),i=0;i<r;i++)n+=e(t[i],i,t,e)||"";return n}function pYe(t,e,n,r){switch(t.type){case eYe:if(t.children.length)break;case JZe:case qU:return t.return=t.return||t.value;case Xae:return"";case Zae:return t.return=t.value+"{"+Tv(t.children,r)+"}";case WU:t.value=t.props.join(",")}return Td(n=Tv(t.children,r))?t.return=t.value+"{"+n+"}":""}function gYe(t){var e=XU(t);return function(n,r,i,o){for(var a="",s=0;s<e;s++)a+=t[s](n,r,i,o)||"";return a}}function mYe(t){return function(e){e.root||(e=e.return)&&t(e)}}var wZ=function(e){var n=new WeakMap;return function(r){if(n.has(r))return n.get(r);var i=e(r);return n.set(r,i),i}};function AYe(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var _Ye=function(e,n,r){for(var i=0,o=0;i=o,o=Ud(),i===38&&o===12&&(n[r]=1),!vE(o);)_c();return A2(e,zu)},yYe=function(e,n){var r=-1,i=44;do switch(vE(i)){case 0:i===38&&Ud()===12&&(n[r]=1),e[r]+=_Ye(zu-1,n,r);break;case 2:e[r]+=xP(i);break;case 4:if(i===44){e[++r]=Ud()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=TL(i)}while(i=_c());return e},vYe=function(e,n){return Jae(yYe(Kae(e),n))},EZ=new WeakMap,xYe=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,i=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!EZ.get(r))&&!i){EZ.set(e,!0);for(var o=[],a=vYe(n,o),s=r.props,u=0,d=0;u<a.length;u++)for(var g=0;g<s.length;g++,d++)e.props[d]=o[u]?a[u].replace(/&\f/g,s[g]):s[g]+" "+a[u]}}},bYe=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function ele(t,e){switch(rYe(t,e)){case 5103:return ki+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ki+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return ki+t+mM+t+Al+t+t;case 6828:case 4268:return ki+t+Al+t+t;case 6165:return ki+t+Al+"flex-"+t+t;case 5187:return ki+t+Ui(t,/(\w+).+(:[^]+)/,ki+"box-$1$2"+Al+"flex-$1$2")+t;case 5443:return ki+t+Al+"flex-item-"+Ui(t,/flex-|-self/,"")+t;case 4675:return ki+t+Al+"flex-line-pack"+Ui(t,/align-content|flex-|-self/,"")+t;case 5548:return ki+t+Al+Ui(t,"shrink","negative")+t;case 5292:return ki+t+Al+Ui(t,"basis","preferred-size")+t;case 6060:return ki+"box-"+Ui(t,"-grow","")+ki+t+Al+Ui(t,"grow","positive")+t;case 4554:return ki+Ui(t,/([^-])(transform)/g,"$1"+ki+"$2")+t;case 6187:return Ui(Ui(Ui(t,/(zoom-|grab)/,ki+"$1"),/(image-set)/,ki+"$1"),t,"")+t;case 5495:case 3959:return Ui(t,/(image-set\([^]*)/,ki+"$1$`$1");case 4968:return Ui(Ui(t,/(.+:)(flex-)?(.*)/,ki+"box-pack:$3"+Al+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ki+t+t;case 4095:case 3583:case 4068:case 2532:return Ui(t,/(.+)-inline(.+)/,ki+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Td(t)-1-e>6)switch(Wa(t,e+1)){case 109:if(Wa(t,e+4)!==45)break;case 102:return Ui(t,/(.+:)(.+)-([^]+)/,"$1"+ki+"$2-$3$1"+mM+(Wa(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~W4(t,"stretch")?ele(Ui(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Wa(t,e+1)!==115)break;case 6444:switch(Wa(t,Td(t)-3-(~W4(t,"!important")&&10))){case 107:return Ui(t,":",":"+ki)+t;case 101:return Ui(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+ki+(Wa(t,14)===45?"inline-":"")+"box$3$1"+ki+"$2$3$1"+Al+"$2box$3")+t}break;case 5936:switch(Wa(t,e+11)){case 114:return ki+t+Al+Ui(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return ki+t+Al+Ui(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return ki+t+Al+Ui(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return ki+t+Al+t+t}return t}var wYe=function(e,n,r,i){if(e.length>-1&&!e.return)switch(e.type){case qU:e.return=ele(e.value,e.length);break;case Zae:return Tv([Db(e,{value:Ui(e.value,"@","@"+ki)})],i);case WU:if(e.length)return oYe(e.props,function(o){switch(iYe(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Tv([Db(e,{props:[Ui(o,/:(read-\w+)/,":"+mM+"$1")]})],i);case"::placeholder":return Tv([Db(e,{props:[Ui(o,/:(plac\w+)/,":"+ki+"input-$1")]}),Db(e,{props:[Ui(o,/:(plac\w+)/,":"+mM+"$1")]}),Db(e,{props:[Ui(o,/:(plac\w+)/,Al+"input-$1")]})],i)}return""})}},EYe=[wYe],tle=function(e){var n=e.key;if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(D){var V=D.getAttribute("data-emotion");V.indexOf(" ")!==-1&&(document.head.appendChild(D),D.setAttribute("data-s",""))})}var i=e.stylisPlugins||EYe,o={},a,s=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(D){for(var V=D.getAttribute("data-emotion").split(" "),k=1;k<V.length;k++)o[V[k]]=!0;s.push(D)});var u,d=[xYe,bYe];{var g,_=[pYe,mYe(function(D){g.insert(D)})],E=gYe(d.concat(i,_)),P=function(V){return Tv(hYe(V),E)};u=function(V,k,F,z){g=F,P(V?V+"{"+k.styles+"}":k.styles),z&&(O.inserted[k.name]=!0)}}var O={key:n,sheet:new KZe({key:n,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:u};return O.sheet.hydrate(s),O};function X4(){return X4=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},X4.apply(this,arguments)}var nle={exports:{}},to={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Na=typeof Symbol=="function"&&Symbol.for,ZU=Na?Symbol.for("react.element"):60103,YU=Na?Symbol.for("react.portal"):60106,IL=Na?Symbol.for("react.fragment"):60107,ML=Na?Symbol.for("react.strict_mode"):60108,OL=Na?Symbol.for("react.profiler"):60114,RL=Na?Symbol.for("react.provider"):60109,LL=Na?Symbol.for("react.context"):60110,QU=Na?Symbol.for("react.async_mode"):60111,DL=Na?Symbol.for("react.concurrent_mode"):60111,BL=Na?Symbol.for("react.forward_ref"):60112,NL=Na?Symbol.for("react.suspense"):60113,SYe=Na?Symbol.for("react.suspense_list"):60120,FL=Na?Symbol.for("react.memo"):60115,kL=Na?Symbol.for("react.lazy"):60116,TYe=Na?Symbol.for("react.block"):60121,CYe=Na?Symbol.for("react.fundamental"):60117,PYe=Na?Symbol.for("react.responder"):60118,IYe=Na?Symbol.for("react.scope"):60119;function Nc(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case ZU:switch(t=t.type,t){case QU:case DL:case IL:case OL:case ML:case NL:return t;default:switch(t=t&&t.$$typeof,t){case LL:case BL:case kL:case FL:case RL:return t;default:return e}}case YU:return e}}}function rle(t){return Nc(t)===DL}to.AsyncMode=QU;to.ConcurrentMode=DL;to.ContextConsumer=LL;to.ContextProvider=RL;to.Element=ZU;to.ForwardRef=BL;to.Fragment=IL;to.Lazy=kL;to.Memo=FL;to.Portal=YU;to.Profiler=OL;to.StrictMode=ML;to.Suspense=NL;to.isAsyncMode=function(t){return rle(t)||Nc(t)===QU};to.isConcurrentMode=rle;to.isContextConsumer=function(t){return Nc(t)===LL};to.isContextProvider=function(t){return Nc(t)===RL};to.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===ZU};to.isForwardRef=function(t){return Nc(t)===BL};to.isFragment=function(t){return Nc(t)===IL};to.isLazy=function(t){return Nc(t)===kL};to.isMemo=function(t){return Nc(t)===FL};to.isPortal=function(t){return Nc(t)===YU};to.isProfiler=function(t){return Nc(t)===OL};to.isStrictMode=function(t){return Nc(t)===ML};to.isSuspense=function(t){return Nc(t)===NL};to.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===IL||t===DL||t===OL||t===ML||t===NL||t===SYe||typeof t=="object"&&t!==null&&(t.$$typeof===kL||t.$$typeof===FL||t.$$typeof===RL||t.$$typeof===LL||t.$$typeof===BL||t.$$typeof===CYe||t.$$typeof===PYe||t.$$typeof===IYe||t.$$typeof===TYe)};to.typeOf=Nc;nle.exports=to;var MYe=nle.exports,ile=MYe,OYe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},RYe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},ole={};ole[ile.ForwardRef]=OYe;ole[ile.Memo]=RYe;var LYe=!0;function DYe(t,e,n){var r="";return n.split(" ").forEach(function(i){t[i]!==void 0?e.push(t[i]+";"):r+=i+" "}),r}var BYe=function(e,n,r){var i=e.key+"-"+n.name;(r===!1||LYe===!1)&&e.registered[i]===void 0&&(e.registered[i]=n.styles)},sle=function(e,n,r){BYe(e,n,r);var i=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var o=n;do e.insert(n===o?"."+i:"",o,e.sheet,!0),o=o.next;while(o!==void 0)}};function NYe(t){for(var e=0,n,r=0,i=t.length;i>=4;++r,i-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(i){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var FYe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},kYe=/[A-Z]|^ms/g,zYe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,ale=function(e){return e.charCodeAt(1)===45},SZ=function(e){return e!=null&&typeof e!="boolean"},dN=AYe(function(t){return ale(t)?t:t.replace(kYe,"-$&").toLowerCase()}),TZ=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(zYe,function(r,i,o){return Cd={name:i,styles:o,next:Cd},i})}return FYe[e]!==1&&!ale(e)&&typeof n=="number"&&n!==0?n+"px":n};function xE(t,e,n){if(n==null)return"";if(n.__emotion_styles!==void 0)return n;switch(typeof n){case"boolean":return"";case"object":{if(n.anim===1)return Cd={name:n.name,styles:n.styles,next:Cd},n.name;if(n.styles!==void 0){var r=n.next;if(r!==void 0)for(;r!==void 0;)Cd={name:r.name,styles:r.styles,next:Cd},r=r.next;var i=n.styles+";";return i}return UYe(t,e,n)}case"function":{if(t!==void 0){var o=Cd,a=n(t);return Cd=o,xE(t,e,a)}break}}if(e==null)return n;var s=e[n];return s!==void 0?s:n}function UYe(t,e,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=xE(t,e,n[i])+";";else for(var o in n){var a=n[o];if(typeof a!="object")e!=null&&e[a]!==void 0?r+=o+"{"+e[a]+"}":SZ(a)&&(r+=dN(o)+":"+TZ(o,a)+";");else if(Array.isArray(a)&&typeof a[0]=="string"&&(e==null||e[a[0]]===void 0))for(var s=0;s<a.length;s++)SZ(a[s])&&(r+=dN(o)+":"+TZ(o,a[s])+";");else{var u=xE(t,e,a);switch(o){case"animation":case"animationName":{r+=dN(o)+":"+u+";";break}default:r+=o+"{"+u+"}"}}}return r}var CZ=/label:\s*([^\s;\n{]+)\s*(;|$)/g,Cd,KU=function(e,n,r){if(e.length===1&&typeof e[0]=="object"&&e[0]!==null&&e[0].styles!==void 0)return e[0];var i=!0,o="";Cd=void 0;var a=e[0];a==null||a.raw===void 0?(i=!1,o+=xE(r,n,a)):o+=a[0];for(var s=1;s<e.length;s++)o+=xE(r,n,e[s]),i&&(o+=a[s]);CZ.lastIndex=0;for(var u="",d;(d=CZ.exec(o))!==null;)u+="-"+d[1];var g=NYe(o)+u;return{name:g,styles:o,next:Cd}},GYe=MP["useInsertionEffect"]?MP["useInsertionEffect"]:!1,PZ=GYe||Ee.useLayoutEffect,lle=Ee.createContext(typeof HTMLElement<"u"?tle({key:"css"}):null);lle.Provider;var jYe=function(e){return Ee.forwardRef(function(n,r){var i=Ee.useContext(lle);return e(n,i,r)})},Z4=Ee.createContext({}),VYe=function(e,n){if(typeof n=="function"){var r=n(e);return r}return X4({},e,n)},$Ye=wZ(function(t){return wZ(function(e){return VYe(t,e)})}),HYe=function(e){var n=Ee.useContext(Z4);return e.theme!==n&&(n=$Ye(n)(e.theme)),Ee.createElement(Z4.Provider,{value:n},e.children)},zL=jYe(function(t,e){var n=t.styles,r=KU([n],void 0,Ee.useContext(Z4)),i=Ee.useRef();return PZ(function(){var o=e.key+"-global",a=new e.sheet.constructor({key:o,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),s=!1,u=document.querySelector('style[data-emotion="'+o+" "+r.name+'"]');return e.sheet.tags.length&&(a.before=e.sheet.tags[0]),u!==null&&(s=!0,u.setAttribute("data-emotion",o),a.hydrate([u])),i.current=[a,s],function(){a.flush()}},[e]),PZ(function(){var o=i.current,a=o[0],s=o[1];if(s){o[1]=!1;return}if(r.next!==void 0&&sle(e,r.next,!0),a.tags.length){var u=a.tags[a.tags.length-1].nextElementSibling;a.before=u,a.flush()}e.insert("",r,a,!1)},[e,r.name]),null});function WYe(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return KU(e)}var qYe=function(){var e=WYe.apply(void 0,arguments),n="animation-"+e.name;return{name:n,styles:"@keyframes "+n+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}},XYe=Object.defineProperty,ZYe=Object.defineProperties,YYe=Object.getOwnPropertyDescriptors,IZ=Object.getOwnPropertySymbols,QYe=Object.prototype.hasOwnProperty,KYe=Object.prototype.propertyIsEnumerable,MZ=(t,e,n)=>e in t?XYe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,JYe=(t,e)=>{for(var n in e||(e={}))QYe.call(e,n)&&MZ(t,n,e[n]);if(IZ)for(var n of IZ(e))KYe.call(e,n)&&MZ(t,n,e[n]);return t},eQe=(t,e)=>ZYe(t,YYe(e));function tQe({theme:t}){return ut.createElement(zL,{styles:{"*, *::before, *::after":{boxSizing:"border-box"},html:{colorScheme:t.colorScheme==="dark"?"dark":"light"},body:eQe(JYe({},t.fn.fontStyles()),{backgroundColor:t.colorScheme==="dark"?t.colors.dark[7]:t.white,color:t.colorScheme==="dark"?t.colors.dark[0]:t.black,lineHeight:t.lineHeight,fontSize:t.fontSizes.md,WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"})}})}function Bb(t,e,n,r=pn){Object.keys(e).forEach(i=>{t[`--mantine-${n}-${i}`]=r(e[i])})}function nQe({theme:t}){const e={"--mantine-color-white":t.white,"--mantine-color-black":t.black,"--mantine-transition-timing-function":t.transitionTimingFunction,"--mantine-line-height":`${t.lineHeight}`,"--mantine-font-family":t.fontFamily,"--mantine-font-family-monospace":t.fontFamilyMonospace,"--mantine-font-family-headings":t.headings.fontFamily,"--mantine-heading-font-weight":`${t.headings.fontWeight}`};Bb(e,t.shadows,"shadow"),Bb(e,t.fontSizes,"font-size"),Bb(e,t.radius,"radius"),Bb(e,t.spacing,"spacing"),Bb(e,t.breakpoints,"breakpoints",SL),Object.keys(t.colors).forEach(r=>{t.colors[r].forEach((i,o)=>{e[`--mantine-color-${r}-${o}`]=i})});const n=t.headings.sizes;return Object.keys(n).forEach(r=>{e[`--mantine-${r}-font-size`]=n[r].fontSize,e[`--mantine-${r}-line-height`]=`${n[r].lineHeight}`}),ut.createElement(zL,{styles:{":root":e}})}var rQe=Object.defineProperty,iQe=Object.defineProperties,oQe=Object.getOwnPropertyDescriptors,OZ=Object.getOwnPropertySymbols,sQe=Object.prototype.hasOwnProperty,aQe=Object.prototype.propertyIsEnumerable,RZ=(t,e,n)=>e in t?rQe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_d=(t,e)=>{for(var n in e||(e={}))sQe.call(e,n)&&RZ(t,n,e[n]);if(OZ)for(var n of OZ(e))aQe.call(e,n)&&RZ(t,n,e[n]);return t},pN=(t,e)=>iQe(t,oQe(e));function lQe(t,e){var n;if(!e)return t;const r=Object.keys(t).reduce((i,o)=>{if(o==="headings"&&e.headings){const a=e.headings.sizes?Object.keys(t.headings.sizes).reduce((s,u)=>(s[u]=_d(_d({},t.headings.sizes[u]),e.headings.sizes[u]),s),{}):t.headings.sizes;return pN(_d({},i),{headings:pN(_d(_d({},t.headings),e.headings),{sizes:a})})}if(o==="breakpoints"&&e.breakpoints){const a=_d(_d({},t.breakpoints),e.breakpoints);return pN(_d({},i),{breakpoints:Object.fromEntries(Object.entries(a).sort((s,u)=>S1(s[1])-S1(u[1])))})}return i[o]=typeof e[o]=="object"?_d(_d({},t[o]),e[o]):typeof e[o]=="number"||typeof e[o]=="boolean"||typeof e[o]=="function"?e[o]:e[o]||t[o],i},{});if(e!=null&&e.fontFamily&&!((n=e==null?void 0:e.headings)!=null&&n.fontFamily)&&(r.headings.fontFamily=e.fontFamily),!(r.primaryColor in r.colors))throw new Error("MantineProvider: Invalid theme.primaryColor, it accepts only key of theme.colors, learn more  https://mantine.dev/theming/colors/#primary-color");return r}function uQe(t,e){return qae(lQe(t,e))}function ule(t){return Object.keys(t).reduce((e,n)=>(t[n]!==void 0&&(e[n]=t[n]),e),{})}const cQe={html:{fontFamily:"sans-serif",lineHeight:"1.15",textSizeAdjust:"100%"},body:{margin:0},"article, aside, footer, header, nav, section, figcaption, figure, main":{display:"block"},h1:{fontSize:"2em"},hr:{boxSizing:"content-box",height:0,overflow:"visible"},pre:{fontFamily:"monospace, monospace",fontSize:"1em"},a:{background:"transparent",textDecorationSkip:"objects"},"a:active, a:hover":{outlineWidth:0},"abbr[title]":{borderBottom:"none",textDecoration:"underline"},"b, strong":{fontWeight:"bolder"},"code, kbp, samp":{fontFamily:"monospace, monospace",fontSize:"1em"},dfn:{fontStyle:"italic"},mark:{backgroundColor:"#ff0",color:"#000"},small:{fontSize:"80%"},"sub, sup":{fontSize:"75%",lineHeight:0,position:"relative",verticalAlign:"baseline"},sup:{top:"-0.5em"},sub:{bottom:"-0.25em"},"audio, video":{display:"inline-block"},"audio:not([controls])":{display:"none",height:0},img:{borderStyle:"none",verticalAlign:"middle"},"svg:not(:root)":{overflow:"hidden"},"button, input, optgroup, select, textarea":{fontFamily:"sans-serif",fontSize:"100%",lineHeight:"1.15",margin:0},"button, input":{overflow:"visible"},"button, select":{textTransform:"none"},"button, [type=reset], [type=submit]":{WebkitAppearance:"button"},"button::-moz-focus-inner, [type=button]::-moz-focus-inner, [type=reset]::-moz-focus-inner, [type=submit]::-moz-focus-inner":{borderStyle:"none",padding:0},"button:-moz-focusring, [type=button]:-moz-focusring, [type=reset]:-moz-focusring, [type=submit]:-moz-focusring":{outline:`${pn(1)} dotted ButtonText`},legend:{boxSizing:"border-box",color:"inherit",display:"table",maxWidth:"100%",padding:0,whiteSpace:"normal"},progress:{display:"inline-block",verticalAlign:"baseline"},textarea:{overflow:"auto"},"[type=checkbox], [type=radio]":{boxSizing:"border-box",padding:0},"[type=number]::-webkit-inner-spin-button, [type=number]::-webkit-outer-spin-button":{height:"auto"},"[type=search]":{appearance:"none"},"[type=search]::-webkit-search-cancel-button, [type=search]::-webkit-search-decoration":{appearance:"none"},"::-webkit-file-upload-button":{appearance:"button",font:"inherit"},"details, menu":{display:"block"},summary:{display:"list-item"},canvas:{display:"inline-block"},template:{display:"none"}};function fQe(){return ut.createElement(zL,{styles:cQe})}var hQe=Object.defineProperty,LZ=Object.getOwnPropertySymbols,dQe=Object.prototype.hasOwnProperty,pQe=Object.prototype.propertyIsEnumerable,DZ=(t,e,n)=>e in t?hQe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xw=(t,e)=>{for(var n in e||(e={}))dQe.call(e,n)&&DZ(t,n,e[n]);if(LZ)for(var n of LZ(e))pQe.call(e,n)&&DZ(t,n,e[n]);return t};const AM=Ee.createContext({theme:HU});function ip(){var t;return((t=Ee.useContext(AM))==null?void 0:t.theme)||HU}function gQe(t){const e=ip(),n=r=>{var i,o,a,s;return{styles:((i=e.components[r])==null?void 0:i.styles)||{},classNames:((o=e.components[r])==null?void 0:o.classNames)||{},variants:(a=e.components[r])==null?void 0:a.variants,sizes:(s=e.components[r])==null?void 0:s.sizes}};return Array.isArray(t)?t.map(n):[n(t)]}function cle(){var t;return(t=Ee.useContext(AM))==null?void 0:t.emotionCache}function Gr(t,e,n){var r;const i=ip(),o=(r=i.components[t])==null?void 0:r.defaultProps,a=typeof o=="function"?o(i):o;return xw(xw(xw({},e),a),ule(n))}function Y4({theme:t,emotionCache:e,withNormalizeCSS:n=!1,withGlobalStyles:r=!1,withCSSVariables:i=!1,inherit:o=!1,children:a}){const s=Ee.useContext(AM),u=uQe(HU,o?xw(xw({},s.theme),t):t);return ut.createElement(HYe,{theme:u},ut.createElement(AM.Provider,{value:{theme:u,emotionCache:e}},n&&ut.createElement(fQe,null),r&&ut.createElement(tQe,{theme:u}),i&&ut.createElement(nQe,{theme:u}),typeof u.globalStyles=="function"&&ut.createElement(zL,{styles:u.globalStyles(u)}),a))}Y4.displayName="@mantine/core/MantineProvider";const mQe={app:100,modal:200,popover:300,overlay:400,max:9999};function _2(t){return mQe[t]}function AQe(t,e){const n=Ee.useRef();return(!n.current||e.length!==n.current.prevDeps.length||n.current.prevDeps.map((r,i)=>r===e[i]).indexOf(!1)>=0)&&(n.current={v:t(),prevDeps:[...e]}),n.current.v}const _Qe=tle({key:"mantine",prepend:!0});function yQe(){return cle()||_Qe}var vQe=Object.defineProperty,BZ=Object.getOwnPropertySymbols,xQe=Object.prototype.hasOwnProperty,bQe=Object.prototype.propertyIsEnumerable,NZ=(t,e,n)=>e in t?vQe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,wQe=(t,e)=>{for(var n in e||(e={}))xQe.call(e,n)&&NZ(t,n,e[n]);if(BZ)for(var n of BZ(e))bQe.call(e,n)&&NZ(t,n,e[n]);return t};const gN="ref";function EQe(t){let e;if(t.length!==1)return{args:t,ref:e};const[n]=t;if(!(n instanceof Object))return{args:t,ref:e};if(!(gN in n))return{args:t,ref:e};e=n[gN];const r=wQe({},n);return delete r[gN],{args:[r],ref:e}}const{cssFactory:SQe}=(()=>{function t(n,r,i){const o=[],a=DYe(n,o,i);return o.length<2?i:a+r(o)}function e(n){const{cache:r}=n,i=(...a)=>{const{ref:s,args:u}=EQe(a),d=KU(u,r.registered);return sle(r,d,!1),`${r.key}-${d.name}${s===void 0?"":` ${s}`}`};return{css:i,cx:(...a)=>t(r.registered,i,Vae(a))}}return{cssFactory:e}})();function fle(){const t=yQe();return AQe(()=>SQe({cache:t}),[t])}function TQe({cx:t,classes:e,context:n,classNames:r,name:i,cache:o}){const a=n.reduce((s,u)=>(Object.keys(u.classNames).forEach(d=>{typeof s[d]!="string"?s[d]=`${u.classNames[d]}`:s[d]=`${s[d]} ${u.classNames[d]}`}),s),{});return Object.keys(e).reduce((s,u)=>(s[u]=t(e[u],a[u],r!=null&&r[u],Array.isArray(i)?i.filter(Boolean).map(d=>`${(o==null?void 0:o.key)||"mantine"}-${d}-${u}`).join(" "):i?`${(o==null?void 0:o.key)||"mantine"}-${i}-${u}`:null),s),{})}var CQe=Object.defineProperty,FZ=Object.getOwnPropertySymbols,PQe=Object.prototype.hasOwnProperty,IQe=Object.prototype.propertyIsEnumerable,kZ=(t,e,n)=>e in t?CQe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,mN=(t,e)=>{for(var n in e||(e={}))PQe.call(e,n)&&kZ(t,n,e[n]);if(FZ)for(var n of FZ(e))IQe.call(e,n)&&kZ(t,n,e[n]);return t};function Q4(t,e){return e&&Object.keys(e).forEach(n=>{t[n]?t[n]=mN(mN({},t[n]),e[n]):t[n]=mN({},e[n])}),t}function zZ(t,e,n,r){const i=o=>typeof o=="function"?o(e,n||{},r):o||{};return Array.isArray(t)?t.map(o=>i(o.styles)).reduce((o,a)=>Q4(o,a),{}):i(t)}function MQe({ctx:t,theme:e,params:n,variant:r,size:i}){return t.reduce((o,a)=>(a.variants&&r in a.variants&&Q4(o,a.variants[r](e,n,{variant:r,size:i})),a.sizes&&i in a.sizes&&Q4(o,a.sizes[i](e,n,{variant:r,size:i})),o),{})}function no(t){const e=typeof t=="function"?t:()=>t;function n(r,i){const o=ip(),a=gQe(i==null?void 0:i.name),s=cle(),u={variant:i==null?void 0:i.variant,size:i==null?void 0:i.size},{css:d,cx:g}=fle(),_=e(o,r,u),E=zZ(i==null?void 0:i.styles,o,r,u),P=zZ(a,o,r,u),O=MQe({ctx:a,theme:o,params:r,variant:i==null?void 0:i.variant,size:i==null?void 0:i.size}),D=Object.fromEntries(Object.keys(_).map(V=>{const k=g({[d(_[V])]:!(i!=null&&i.unstyled)},d(O[V]),d(P[V]),d(E[V]));return[V,k]}));return{classes:TQe({cx:g,classes:D,context:a,classNames:i==null?void 0:i.classNames,name:i==null?void 0:i.name,cache:s}),cx:g,theme:o}}return n}function Nb(t){return`___ref-${t||""}`}var OQe=Object.defineProperty,RQe=Object.defineProperties,LQe=Object.getOwnPropertyDescriptors,UZ=Object.getOwnPropertySymbols,DQe=Object.prototype.hasOwnProperty,BQe=Object.prototype.propertyIsEnumerable,GZ=(t,e,n)=>e in t?OQe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Fb=(t,e)=>{for(var n in e||(e={}))DQe.call(e,n)&&GZ(t,n,e[n]);if(UZ)for(var n of UZ(e))BQe.call(e,n)&&GZ(t,n,e[n]);return t},kb=(t,e)=>RQe(t,LQe(e));const zb={in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:`scale(.9) translateY(${pn(10)})`},transitionProperty:"transform, opacity"},CT={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:`translateY(-${pn(20)}) skew(-10deg, -5deg)`},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:`translateY(${pn(20)}) skew(-10deg, -5deg)`},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:`translateY(${pn(20)}) rotate(-5deg)`},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:`translateY(${pn(20)}) rotate(5deg)`},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:kb(Fb({},zb),{common:{transformOrigin:"center center"}}),"pop-bottom-left":kb(Fb({},zb),{common:{transformOrigin:"bottom left"}}),"pop-bottom-right":kb(Fb({},zb),{common:{transformOrigin:"bottom right"}}),"pop-top-left":kb(Fb({},zb),{common:{transformOrigin:"top left"}}),"pop-top-right":kb(Fb({},zb),{common:{transformOrigin:"top right"}})},jZ=["mousedown","touchstart"];function NQe(t,e,n){const r=Ee.useRef();return Ee.useEffect(()=>{const i=o=>{const{target:a}=o??{};if(Array.isArray(n)){const s=(a==null?void 0:a.hasAttribute("data-ignore-outside-clicks"))||!document.body.contains(a)&&a.tagName!=="HTML";n.every(d=>!!d&&!o.composedPath().includes(d))&&!s&&t()}else r.current&&!r.current.contains(a)&&t()};return(e||jZ).forEach(o=>document.addEventListener(o,i)),()=>{(e||jZ).forEach(o=>document.removeEventListener(o,i))}},[r,t,n]),r}function FQe(t,e){try{return t.addEventListener("change",e),()=>t.removeEventListener("change",e)}catch{return t.addListener(e),()=>t.removeListener(e)}}function kQe(t,e){return typeof e=="boolean"?e:typeof window<"u"&&"matchMedia"in window?window.matchMedia(t).matches:!1}function zQe(t,e,{getInitialValueInEffect:n}={getInitialValueInEffect:!0}){const[r,i]=Ee.useState(n?e:kQe(t,e)),o=Ee.useRef();return Ee.useEffect(()=>{if("matchMedia"in window)return o.current=window.matchMedia(t),i(o.current.matches),FQe(o.current,a=>i(a.matches))},[t]),r}const UL=typeof document<"u"?Ee.useLayoutEffect:Ee.useEffect;function dA(t,e){const n=Ee.useRef(!1);Ee.useEffect(()=>()=>{n.current=!1},[]),Ee.useEffect(()=>{if(n.current)return t();n.current=!0},e)}function hle({opened:t,shouldReturnFocus:e=!0}){const n=Ee.useRef(),r=()=>{var i;n.current&&"focus"in n.current&&typeof n.current.focus=="function"&&((i=n.current)==null||i.focus({preventScroll:!0}))};return dA(()=>{let i=-1;const o=a=>{a.key==="Tab"&&window.clearTimeout(i)};return document.addEventListener("keydown",o),t?n.current=document.activeElement:e&&(i=window.setTimeout(r,10)),()=>{window.clearTimeout(i),document.removeEventListener("keydown",o)}},[t,e]),r}const UQe=/input|select|textarea|button|object/,dle="a, input, select, textarea, button, object, [tabindex]";function GQe(t){return t.style.display==="none"}function jQe(t){if(t.getAttribute("aria-hidden")||t.getAttribute("hidden")||t.getAttribute("type")==="hidden")return!1;let n=t;for(;n&&!(n===document.body||n.nodeType===11);){if(GQe(n))return!1;n=n.parentNode}return!0}function ple(t){let e=t.getAttribute("tabindex");return e===null&&(e=void 0),parseInt(e,10)}function K4(t){const e=t.nodeName.toLowerCase(),n=!Number.isNaN(ple(t));return(UQe.test(e)&&!t.disabled||t instanceof HTMLAnchorElement&&t.href||n)&&jQe(t)}function gle(t){const e=ple(t);return(Number.isNaN(e)||e>=0)&&K4(t)}function VQe(t){return Array.from(t.querySelectorAll(dle)).filter(gle)}function $Qe(t,e){const n=VQe(t);if(!n.length){e.preventDefault();return}const r=n[e.shiftKey?0:n.length-1],i=t.getRootNode();if(!(r===i.activeElement||t===i.activeElement))return;e.preventDefault();const a=n[e.shiftKey?n.length-1:0];a&&a.focus()}function mle(){return`mantine-${Math.random().toString(36).slice(2,11)}`}function HQe(t,e="body > :not(script)"){const n=mle(),r=Array.from(document.querySelectorAll(e)).map(i=>{var o;if((o=i==null?void 0:i.shadowRoot)!=null&&o.contains(t)||i.contains(t))return;const a=i.getAttribute("aria-hidden"),s=i.getAttribute("data-hidden"),u=i.getAttribute("data-focus-id");return i.setAttribute("data-focus-id",n),a===null||a==="false"?i.setAttribute("aria-hidden","true"):!s&&!u&&i.setAttribute("data-hidden",a),{node:i,ariaHidden:s||null}});return()=>{r.forEach(i=>{!i||n!==i.node.getAttribute("data-focus-id")||(i.ariaHidden===null?i.node.removeAttribute("aria-hidden"):i.node.setAttribute("aria-hidden",i.ariaHidden),i.node.removeAttribute("data-focus-id"),i.node.removeAttribute("data-hidden"))})}}function WQe(t=!0){const e=Ee.useRef(),n=Ee.useRef(null),r=o=>{let a=o.querySelector("[data-autofocus]");if(!a){const s=Array.from(o.querySelectorAll(dle));a=s.find(gle)||s.find(K4)||null,!a&&K4(o)&&(a=o)}a&&a.focus({preventScroll:!0})},i=Ee.useCallback(o=>{if(t){if(o===null){n.current&&(n.current(),n.current=null);return}n.current=HQe(o),e.current!==o&&(o?(setTimeout(()=>{o.getRootNode()&&r(o)}),e.current=o):e.current=null)}},[t]);return Ee.useEffect(()=>{if(!t)return;e.current&&setTimeout(()=>r(e.current));const o=a=>{a.key==="Tab"&&e.current&&$Qe(e.current,a)};return document.addEventListener("keydown",o),()=>{document.removeEventListener("keydown",o),n.current&&n.current()}},[t]),i}const qQe=ut["useId".toString()]||(()=>{});function XQe(){const t=qQe();return t?`mantine-${t.replace(/:/g,"")}`:""}function y2(t){const e=XQe(),[n,r]=Ee.useState(e);return UL(()=>{r(mle())},[]),typeof t=="string"?t:typeof window>"u"?e:n}function ZQe(t,e,n){Ee.useEffect(()=>(window.addEventListener(t,e,n),()=>window.removeEventListener(t,e,n)),[t,e])}function Ale(t,e){typeof t=="function"?t(e):typeof t=="object"&&t!==null&&"current"in t&&(t.current=e)}function YQe(...t){return e=>{t.forEach(n=>Ale(n,e))}}function J1(...t){return Ee.useCallback(YQe(...t),t)}function JU({value:t,defaultValue:e,finalValue:n,onChange:r=()=>{}}){const[i,o]=Ee.useState(e!==void 0?e:n),a=s=>{o(s),r==null||r(s)};return t!==void 0?[t,r,!0]:[i,a,!1]}function e8(t,e){return zQe("(prefers-reduced-motion: reduce)",t,e)}const QQe={x:0,y:0,width:0,height:0,top:0,left:0,bottom:0,right:0};function KQe(){const t=Ee.useRef(0),e=Ee.useRef(null),[n,r]=Ee.useState(QQe),i=Ee.useMemo(()=>typeof window<"u"?new ResizeObserver(o=>{const a=o[0];a&&(cancelAnimationFrame(t.current),t.current=requestAnimationFrame(()=>{e.current&&r(a.contentRect)}))}):null,[]);return UL(()=>(e.current&&(i.observe(e.current),r(e.current.getBoundingClientRect())),()=>{i.disconnect(),t.current&&cancelAnimationFrame(t.current)}),[e.current]),[e,n]}function J4(t=!1,e){const{onOpen:n,onClose:r}=e||{},[i,o]=Ee.useState(t),a=Ee.useCallback(()=>{o(d=>d||(n==null||n(),!0))},[n]),s=Ee.useCallback(()=>{o(d=>d&&(r==null||r(),!1))},[r]),u=Ee.useCallback(()=>{i?s():a()},[s,a,i]);return[i,{open:a,close:s,toggle:u}]}var VZ=Object.getOwnPropertySymbols,JQe=Object.prototype.hasOwnProperty,eKe=Object.prototype.propertyIsEnumerable,tKe=(t,e)=>{var n={};for(var r in t)JQe.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&VZ)for(var r of VZ(t))e.indexOf(r)<0&&eKe.call(t,r)&&(n[r]=t[r]);return n};function t8(t){const e=t,{m:n,mx:r,my:i,mt:o,mb:a,ml:s,mr:u,p:d,px:g,py:_,pt:E,pb:P,pl:O,pr:D,bg:V,c:k,opacity:F,ff:z,fz:X,fw:Y,lts:J,ta:re,lh:ue,fs:ie,tt:ce,td:se,w:me,miw:Ce,maw:we,h:Ye,mih:at,mah:yt,bgsz:be,bgp:De,bgr:Re,bga:qe,pos:ct,top:Ct,left:Dt,bottom:In,right:Mn,inset:Tn,display:Nt}=e,Zt=tKe(e,["m","mx","my","mt","mb","ml","mr","p","px","py","pt","pb","pl","pr","bg","c","opacity","ff","fz","fw","lts","ta","lh","fs","tt","td","w","miw","maw","h","mih","mah","bgsz","bgp","bgr","bga","pos","top","left","bottom","right","inset","display"]);return{systemStyles:ule({m:n,mx:r,my:i,mt:o,mb:a,ml:s,mr:u,p:d,px:g,py:_,pt:E,pb:P,pl:O,pr:D,bg:V,c:k,opacity:F,ff:z,fz:X,fw:Y,lts:J,ta:re,lh:ue,fs:ie,tt:ce,td:se,w:me,miw:Ce,maw:we,h:Ye,mih:at,mah:yt,bgsz:be,bgp:De,bgr:Re,bga:qe,pos:ct,top:Ct,left:Dt,bottom:In,right:Mn,inset:Tn,display:Nt}),rest:Zt}}function nKe(t,e){const n=Object.keys(t).filter(r=>r!=="base").sort((r,i)=>S1(Zr({size:r,sizes:e.breakpoints}))-S1(Zr({size:i,sizes:e.breakpoints})));return"base"in t?["base",...n]:n}function rKe({value:t,theme:e,getValue:n,property:r}){if(t==null)return;if(typeof t=="object")return nKe(t,e).reduce((a,s)=>{if(s==="base"&&t.base!==void 0){const d=n(t.base,e);return Array.isArray(r)?(r.forEach(g=>{a[g]=d}),a):(a[r]=d,a)}const u=n(t[s],e);return Array.isArray(r)?(a[e.fn.largerThan(s)]={},r.forEach(d=>{a[e.fn.largerThan(s)][d]=u}),a):(a[e.fn.largerThan(s)]={[r]:u},a)},{});const i=n(t,e);return Array.isArray(r)?r.reduce((o,a)=>(o[a]=i,o),{}):{[r]:i}}function iKe(t,e){return t==="dimmed"?e.colorScheme==="dark"?e.colors.dark[2]:e.colors.gray[6]:e.fn.variant({variant:"filled",color:t,primaryFallback:!1}).background}function oKe(t){return pn(t)}function sKe(t){return t}function aKe(t,e){return Zr({size:t,sizes:e.fontSizes})}const lKe=["-xs","-sm","-md","-lg","-xl"];function uKe(t,e){return lKe.includes(t)?`calc(${Zr({size:t.replace("-",""),sizes:e.spacing})} * -1)`:Zr({size:t,sizes:e.spacing})}const cKe={identity:sKe,color:iKe,size:oKe,fontSize:aKe,spacing:uKe},fKe={m:{type:"spacing",property:"margin"},mt:{type:"spacing",property:"marginTop"},mb:{type:"spacing",property:"marginBottom"},ml:{type:"spacing",property:"marginLeft"},mr:{type:"spacing",property:"marginRight"},mx:{type:"spacing",property:["marginRight","marginLeft"]},my:{type:"spacing",property:["marginTop","marginBottom"]},p:{type:"spacing",property:"padding"},pt:{type:"spacing",property:"paddingTop"},pb:{type:"spacing",property:"paddingBottom"},pl:{type:"spacing",property:"paddingLeft"},pr:{type:"spacing",property:"paddingRight"},px:{type:"spacing",property:["paddingRight","paddingLeft"]},py:{type:"spacing",property:["paddingTop","paddingBottom"]},bg:{type:"color",property:"background"},c:{type:"color",property:"color"},opacity:{type:"identity",property:"opacity"},ff:{type:"identity",property:"fontFamily"},fz:{type:"fontSize",property:"fontSize"},fw:{type:"identity",property:"fontWeight"},lts:{type:"size",property:"letterSpacing"},ta:{type:"identity",property:"textAlign"},lh:{type:"identity",property:"lineHeight"},fs:{type:"identity",property:"fontStyle"},tt:{type:"identity",property:"textTransform"},td:{type:"identity",property:"textDecoration"},w:{type:"spacing",property:"width"},miw:{type:"spacing",property:"minWidth"},maw:{type:"spacing",property:"maxWidth"},h:{type:"spacing",property:"height"},mih:{type:"spacing",property:"minHeight"},mah:{type:"spacing",property:"maxHeight"},bgsz:{type:"size",property:"backgroundSize"},bgp:{type:"identity",property:"backgroundPosition"},bgr:{type:"identity",property:"backgroundRepeat"},bga:{type:"identity",property:"backgroundAttachment"},pos:{type:"identity",property:"position"},top:{type:"identity",property:"top"},left:{type:"size",property:"left"},bottom:{type:"size",property:"bottom"},right:{type:"size",property:"right"},inset:{type:"size",property:"inset"},display:{type:"identity",property:"display"}};var hKe=Object.defineProperty,$Z=Object.getOwnPropertySymbols,dKe=Object.prototype.hasOwnProperty,pKe=Object.prototype.propertyIsEnumerable,HZ=(t,e,n)=>e in t?hKe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,WZ=(t,e)=>{for(var n in e||(e={}))dKe.call(e,n)&&HZ(t,n,e[n]);if($Z)for(var n of $Z(e))pKe.call(e,n)&&HZ(t,n,e[n]);return t};function qZ(t,e,n=fKe){return Object.keys(n).reduce((i,o)=>(o in t&&t[o]!==void 0&&i.push(rKe({value:t[o],getValue:cKe[n[o].type],property:n[o].property,theme:e})),i),[]).reduce((i,o)=>(Object.keys(o).forEach(a=>{typeof o[a]=="object"&&o[a]!==null&&a in i?i[a]=WZ(WZ({},i[a]),o[a]):i[a]=o[a]}),i),{})}function XZ(t,e){return typeof t=="function"?t(e):t}function gKe(t,e,n){const r=ip(),{css:i,cx:o}=fle();return Array.isArray(t)?o(n,i(qZ(e,r)),t.map(a=>i(XZ(a,r)))):o(n,i(XZ(t,r)),i(qZ(e,r)))}var mKe=Object.defineProperty,_M=Object.getOwnPropertySymbols,_le=Object.prototype.hasOwnProperty,yle=Object.prototype.propertyIsEnumerable,ZZ=(t,e,n)=>e in t?mKe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,AKe=(t,e)=>{for(var n in e||(e={}))_le.call(e,n)&&ZZ(t,n,e[n]);if(_M)for(var n of _M(e))yle.call(e,n)&&ZZ(t,n,e[n]);return t},_Ke=(t,e)=>{var n={};for(var r in t)_le.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&_M)for(var r of _M(t))e.indexOf(r)<0&&yle.call(t,r)&&(n[r]=t[r]);return n};const vle=Ee.forwardRef((t,e)=>{var n=t,{className:r,component:i,style:o,sx:a}=n,s=_Ke(n,["className","component","style","sx"]);const{systemStyles:u,rest:d}=t8(s),g=i||"div";return ut.createElement(g,AKe({ref:e,className:gKe(a,u,r),style:o},d))});vle.displayName="@mantine/core/Box";const go=vle;var yKe=Object.defineProperty,vKe=Object.defineProperties,xKe=Object.getOwnPropertyDescriptors,YZ=Object.getOwnPropertySymbols,bKe=Object.prototype.hasOwnProperty,wKe=Object.prototype.propertyIsEnumerable,QZ=(t,e,n)=>e in t?yKe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,KZ=(t,e)=>{for(var n in e||(e={}))bKe.call(e,n)&&QZ(t,n,e[n]);if(YZ)for(var n of YZ(e))wKe.call(e,n)&&QZ(t,n,e[n]);return t},EKe=(t,e)=>vKe(t,xKe(e)),SKe=no(t=>({root:EKe(KZ(KZ({},t.fn.focusStyles()),t.fn.fontStyles()),{cursor:"pointer",border:0,padding:0,appearance:"none",fontSize:t.fontSizes.md,backgroundColor:"transparent",textAlign:"left",color:t.colorScheme==="dark"?t.colors.dark[0]:t.black,textDecoration:"none",boxSizing:"border-box"})}));const TKe=SKe;var CKe=Object.defineProperty,yM=Object.getOwnPropertySymbols,xle=Object.prototype.hasOwnProperty,ble=Object.prototype.propertyIsEnumerable,JZ=(t,e,n)=>e in t?CKe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,PKe=(t,e)=>{for(var n in e||(e={}))xle.call(e,n)&&JZ(t,n,e[n]);if(yM)for(var n of yM(e))ble.call(e,n)&&JZ(t,n,e[n]);return t},IKe=(t,e)=>{var n={};for(var r in t)xle.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&yM)for(var r of yM(t))e.indexOf(r)<0&&ble.call(t,r)&&(n[r]=t[r]);return n};const wle=Ee.forwardRef((t,e)=>{const n=Gr("UnstyledButton",{},t),{className:r,component:i="button",unstyled:o,variant:a}=n,s=IKe(n,["className","component","unstyled","variant"]),{classes:u,cx:d}=TKe(null,{name:"UnstyledButton",unstyled:o,variant:a});return ut.createElement(go,PKe({component:i,ref:e,className:d(u.root,r),type:i==="button"?"button":void 0},s))});wle.displayName="@mantine/core/UnstyledButton";const MKe=wle;var OKe=Object.defineProperty,RKe=Object.defineProperties,LKe=Object.getOwnPropertyDescriptors,eY=Object.getOwnPropertySymbols,DKe=Object.prototype.hasOwnProperty,BKe=Object.prototype.propertyIsEnumerable,tY=(t,e,n)=>e in t?OKe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ez=(t,e)=>{for(var n in e||(e={}))DKe.call(e,n)&&tY(t,n,e[n]);if(eY)for(var n of eY(e))BKe.call(e,n)&&tY(t,n,e[n]);return t},nY=(t,e)=>RKe(t,LKe(e));const NKe=["subtle","filled","outline","light","default","transparent","gradient"],PT={xs:pn(18),sm:pn(22),md:pn(28),lg:pn(34),xl:pn(44)};function FKe({variant:t,theme:e,color:n,gradient:r}){const i=e.fn.variant({color:n,variant:t,gradient:r});return t==="gradient"?{border:0,backgroundImage:i.background,color:i.color,"&:hover":e.fn.hover({backgroundSize:"200%"})}:NKe.includes(t)?ez({border:`${pn(1)} solid ${i.border}`,backgroundColor:i.background,color:i.color},e.fn.hover({backgroundColor:i.hover})):null}var kKe=no((t,{radius:e,color:n,gradient:r},{variant:i,size:o})=>({root:nY(ez({position:"relative",borderRadius:t.fn.radius(e),padding:0,lineHeight:1,display:"flex",alignItems:"center",justifyContent:"center",height:Zr({size:o,sizes:PT}),minHeight:Zr({size:o,sizes:PT}),width:Zr({size:o,sizes:PT}),minWidth:Zr({size:o,sizes:PT})},FKe({variant:i,theme:t,color:n,gradient:r})),{"&:active":t.activeStyles,"& [data-action-icon-loader]":{maxWidth:"70%"},"&:disabled, &[data-disabled]":{color:t.colors.gray[t.colorScheme==="dark"?6:4],cursor:"not-allowed",backgroundColor:i==="transparent"?void 0:t.fn.themeColor("gray",t.colorScheme==="dark"?8:1),borderColor:i==="transparent"?void 0:t.fn.themeColor("gray",t.colorScheme==="dark"?8:1),backgroundImage:"none",pointerEvents:"none","&:active":{transform:"none"}},"&[data-loading]":{pointerEvents:"none","&::before":nY(ez({content:'""'},t.fn.cover(pn(-1))),{backgroundColor:t.colorScheme==="dark"?t.fn.rgba(t.colors.dark[7],.5):"rgba(255, 255, 255, .5)",borderRadius:t.fn.radius(e),cursor:"not-allowed"})}})}));const zKe=kKe;var UKe=Object.defineProperty,vM=Object.getOwnPropertySymbols,Ele=Object.prototype.hasOwnProperty,Sle=Object.prototype.propertyIsEnumerable,rY=(t,e,n)=>e in t?UKe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,iY=(t,e)=>{for(var n in e||(e={}))Ele.call(e,n)&&rY(t,n,e[n]);if(vM)for(var n of vM(e))Sle.call(e,n)&&rY(t,n,e[n]);return t},oY=(t,e)=>{var n={};for(var r in t)Ele.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&vM)for(var r of vM(t))e.indexOf(r)<0&&Sle.call(t,r)&&(n[r]=t[r]);return n};function GKe(t){var e=t,{size:n,color:r}=e,i=oY(e,["size","color"]);const o=i,{style:a}=o,s=oY(o,["style"]);return ut.createElement("svg",iY({viewBox:"0 0 135 140",xmlns:"http://www.w3.org/2000/svg",fill:r,style:iY({width:n},a)},s),ut.createElement("rect",{y:"10",width:"15",height:"120",rx:"6"},ut.createElement("animate",{attributeName:"height",begin:"0.5s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),ut.createElement("animate",{attributeName:"y",begin:"0.5s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})),ut.createElement("rect",{x:"30",y:"10",width:"15",height:"120",rx:"6"},ut.createElement("animate",{attributeName:"height",begin:"0.25s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),ut.createElement("animate",{attributeName:"y",begin:"0.25s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})),ut.createElement("rect",{x:"60",width:"15",height:"140",rx:"6"},ut.createElement("animate",{attributeName:"height",begin:"0s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),ut.createElement("animate",{attributeName:"y",begin:"0s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})),ut.createElement("rect",{x:"90",y:"10",width:"15",height:"120",rx:"6"},ut.createElement("animate",{attributeName:"height",begin:"0.25s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),ut.createElement("animate",{attributeName:"y",begin:"0.25s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})),ut.createElement("rect",{x:"120",y:"10",width:"15",height:"120",rx:"6"},ut.createElement("animate",{attributeName:"height",begin:"0.5s",dur:"1s",values:"120;110;100;90;80;70;60;50;40;140;120",calcMode:"linear",repeatCount:"indefinite"}),ut.createElement("animate",{attributeName:"y",begin:"0.5s",dur:"1s",values:"10;15;20;25;30;35;40;45;50;0;10",calcMode:"linear",repeatCount:"indefinite"})))}var jKe=Object.defineProperty,xM=Object.getOwnPropertySymbols,Tle=Object.prototype.hasOwnProperty,Cle=Object.prototype.propertyIsEnumerable,sY=(t,e,n)=>e in t?jKe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,aY=(t,e)=>{for(var n in e||(e={}))Tle.call(e,n)&&sY(t,n,e[n]);if(xM)for(var n of xM(e))Cle.call(e,n)&&sY(t,n,e[n]);return t},lY=(t,e)=>{var n={};for(var r in t)Tle.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&xM)for(var r of xM(t))e.indexOf(r)<0&&Cle.call(t,r)&&(n[r]=t[r]);return n};function VKe(t){var e=t,{size:n,color:r}=e,i=lY(e,["size","color"]);const o=i,{style:a}=o,s=lY(o,["style"]);return ut.createElement("svg",aY({viewBox:"0 0 38 38",xmlns:"http://www.w3.org/2000/svg",stroke:r,style:aY({width:n,height:n},a)},s),ut.createElement("g",{fill:"none",fillRule:"evenodd"},ut.createElement("g",{transform:"translate(2.5 2.5)",strokeWidth:"5"},ut.createElement("circle",{strokeOpacity:".5",cx:"16",cy:"16",r:"16"}),ut.createElement("path",{d:"M32 16c0-9.94-8.06-16-16-16"},ut.createElement("animateTransform",{attributeName:"transform",type:"rotate",from:"0 16 16",to:"360 16 16",dur:"1s",repeatCount:"indefinite"})))))}var $Ke=Object.defineProperty,bM=Object.getOwnPropertySymbols,Ple=Object.prototype.hasOwnProperty,Ile=Object.prototype.propertyIsEnumerable,uY=(t,e,n)=>e in t?$Ke(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,cY=(t,e)=>{for(var n in e||(e={}))Ple.call(e,n)&&uY(t,n,e[n]);if(bM)for(var n of bM(e))Ile.call(e,n)&&uY(t,n,e[n]);return t},fY=(t,e)=>{var n={};for(var r in t)Ple.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&bM)for(var r of bM(t))e.indexOf(r)<0&&Ile.call(t,r)&&(n[r]=t[r]);return n};function HKe(t){var e=t,{size:n,color:r}=e,i=fY(e,["size","color"]);const o=i,{style:a}=o,s=fY(o,["style"]);return ut.createElement("svg",cY({viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",fill:r,style:cY({width:n},a)},s),ut.createElement("circle",{cx:"15",cy:"15",r:"15"},ut.createElement("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),ut.createElement("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})),ut.createElement("circle",{cx:"60",cy:"15",r:"9",fillOpacity:"0.3"},ut.createElement("animate",{attributeName:"r",from:"9",to:"9",begin:"0s",dur:"0.8s",values:"9;15;9",calcMode:"linear",repeatCount:"indefinite"}),ut.createElement("animate",{attributeName:"fill-opacity",from:"0.5",to:"0.5",begin:"0s",dur:"0.8s",values:".5;1;.5",calcMode:"linear",repeatCount:"indefinite"})),ut.createElement("circle",{cx:"105",cy:"15",r:"15"},ut.createElement("animate",{attributeName:"r",from:"15",to:"15",begin:"0s",dur:"0.8s",values:"15;9;15",calcMode:"linear",repeatCount:"indefinite"}),ut.createElement("animate",{attributeName:"fill-opacity",from:"1",to:"1",begin:"0s",dur:"0.8s",values:"1;.5;1",calcMode:"linear",repeatCount:"indefinite"})))}var WKe=Object.defineProperty,wM=Object.getOwnPropertySymbols,Mle=Object.prototype.hasOwnProperty,Ole=Object.prototype.propertyIsEnumerable,hY=(t,e,n)=>e in t?WKe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qKe=(t,e)=>{for(var n in e||(e={}))Mle.call(e,n)&&hY(t,n,e[n]);if(wM)for(var n of wM(e))Ole.call(e,n)&&hY(t,n,e[n]);return t},XKe=(t,e)=>{var n={};for(var r in t)Mle.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&wM)for(var r of wM(t))e.indexOf(r)<0&&Ole.call(t,r)&&(n[r]=t[r]);return n};const AN={bars:GKe,oval:VKe,dots:HKe},ZKe={xs:pn(18),sm:pn(22),md:pn(36),lg:pn(44),xl:pn(58)},YKe={size:"md"};function Rle(t){const e=Gr("Loader",YKe,t),{size:n,color:r,variant:i}=e,o=XKe(e,["size","color","variant"]),a=ip(),s=i in AN?i:a.loader;return ut.createElement(go,qKe({role:"presentation",component:AN[s]||AN.bars,size:Zr({size:n,sizes:ZKe}),color:a.fn.variant({variant:"filled",primaryFallback:!1,color:r||a.primaryColor}).background},o))}Rle.displayName="@mantine/core/Loader";var QKe=Object.defineProperty,EM=Object.getOwnPropertySymbols,Lle=Object.prototype.hasOwnProperty,Dle=Object.prototype.propertyIsEnumerable,dY=(t,e,n)=>e in t?QKe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,pY=(t,e)=>{for(var n in e||(e={}))Lle.call(e,n)&&dY(t,n,e[n]);if(EM)for(var n of EM(e))Dle.call(e,n)&&dY(t,n,e[n]);return t},KKe=(t,e)=>{var n={};for(var r in t)Lle.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&EM)for(var r of EM(t))e.indexOf(r)<0&&Dle.call(t,r)&&(n[r]=t[r]);return n};const JKe={color:"gray",size:"md",variant:"subtle"},Ble=Ee.forwardRef((t,e)=>{const n=Gr("ActionIcon",JKe,t),{className:r,color:i,children:o,radius:a,size:s,variant:u,gradient:d,disabled:g,loaderProps:_,loading:E,unstyled:P,__staticSelector:O}=n,D=KKe(n,["className","color","children","radius","size","variant","gradient","disabled","loaderProps","loading","unstyled","__staticSelector"]),{classes:V,cx:k,theme:F}=zKe({radius:a,color:i,gradient:d},{name:["ActionIcon",O],unstyled:P,size:s,variant:u}),z=ut.createElement(Rle,pY({color:F.fn.variant({color:i,variant:u}).color,size:"100%","data-action-icon-loader":!0},_));return ut.createElement(MKe,pY({className:k(V.root,r),ref:e,disabled:g,"data-disabled":g||void 0,"data-loading":E||void 0,unstyled:P},D),E?z:o)});Ble.displayName="@mantine/core/ActionIcon";const eJe=Ble;var tJe=Object.defineProperty,nJe=Object.defineProperties,rJe=Object.getOwnPropertyDescriptors,SM=Object.getOwnPropertySymbols,Nle=Object.prototype.hasOwnProperty,Fle=Object.prototype.propertyIsEnumerable,gY=(t,e,n)=>e in t?tJe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,iJe=(t,e)=>{for(var n in e||(e={}))Nle.call(e,n)&&gY(t,n,e[n]);if(SM)for(var n of SM(e))Fle.call(e,n)&&gY(t,n,e[n]);return t},oJe=(t,e)=>nJe(t,rJe(e)),sJe=(t,e)=>{var n={};for(var r in t)Nle.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&SM)for(var r of SM(t))e.indexOf(r)<0&&Fle.call(t,r)&&(n[r]=t[r]);return n};function kle(t){const e=Gr("Portal",{},t),{children:n,target:r,className:i,innerRef:o}=e,a=sJe(e,["children","target","className","innerRef"]),s=ip(),[u,d]=Ee.useState(!1),g=Ee.useRef();return UL(()=>(d(!0),g.current=r?typeof r=="string"?document.querySelector(r):r:document.createElement("div"),r||document.body.appendChild(g.current),()=>{!r&&document.body.removeChild(g.current)}),[r]),u?PE.createPortal(ut.createElement("div",oJe(iJe({className:i,dir:s.dir},a),{ref:o}),n),g.current):null}kle.displayName="@mantine/core/Portal";var aJe=Object.defineProperty,TM=Object.getOwnPropertySymbols,zle=Object.prototype.hasOwnProperty,Ule=Object.prototype.propertyIsEnumerable,mY=(t,e,n)=>e in t?aJe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lJe=(t,e)=>{for(var n in e||(e={}))zle.call(e,n)&&mY(t,n,e[n]);if(TM)for(var n of TM(e))Ule.call(e,n)&&mY(t,n,e[n]);return t},uJe=(t,e)=>{var n={};for(var r in t)zle.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&TM)for(var r of TM(t))e.indexOf(r)<0&&Ule.call(t,r)&&(n[r]=t[r]);return n};function v2(t){var e=t,{withinPortal:n=!0,children:r}=e,i=uJe(e,["withinPortal","children"]);return n?ut.createElement(kle,lJe({},i),r):ut.createElement(ut.Fragment,null,r)}v2.displayName="@mantine/core/OptionalPortal";var cJe=Object.defineProperty,CM=Object.getOwnPropertySymbols,Gle=Object.prototype.hasOwnProperty,jle=Object.prototype.propertyIsEnumerable,AY=(t,e,n)=>e in t?cJe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_Y=(t,e)=>{for(var n in e||(e={}))Gle.call(e,n)&&AY(t,n,e[n]);if(CM)for(var n of CM(e))jle.call(e,n)&&AY(t,n,e[n]);return t},fJe=(t,e)=>{var n={};for(var r in t)Gle.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&CM)for(var r of CM(t))e.indexOf(r)<0&&jle.call(t,r)&&(n[r]=t[r]);return n};function Vle(t){const e=t,{width:n,height:r,style:i}=e,o=fJe(e,["width","height","style"]);return ut.createElement("svg",_Y({viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:_Y({width:n,height:r},i)},o),ut.createElement("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))}Vle.displayName="@mantine/core/CloseIcon";var hJe=Object.defineProperty,PM=Object.getOwnPropertySymbols,$le=Object.prototype.hasOwnProperty,Hle=Object.prototype.propertyIsEnumerable,yY=(t,e,n)=>e in t?hJe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,dJe=(t,e)=>{for(var n in e||(e={}))$le.call(e,n)&&yY(t,n,e[n]);if(PM)for(var n of PM(e))Hle.call(e,n)&&yY(t,n,e[n]);return t},pJe=(t,e)=>{var n={};for(var r in t)$le.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&PM)for(var r of PM(t))e.indexOf(r)<0&&Hle.call(t,r)&&(n[r]=t[r]);return n};const gJe={xs:pn(12),sm:pn(16),md:pn(20),lg:pn(28),xl:pn(34)},mJe={size:"sm"},Wle=Ee.forwardRef((t,e)=>{const n=Gr("CloseButton",mJe,t),{iconSize:r,size:i,children:o}=n,a=pJe(n,["iconSize","size","children"]),s=pn(r||gJe[i]);return ut.createElement(eJe,dJe({ref:e,__staticSelector:"CloseButton",size:i},a),o||ut.createElement(Vle,{width:s,height:s}))});Wle.displayName="@mantine/core/CloseButton";const qle=Wle;var AJe=Object.defineProperty,_Je=Object.defineProperties,yJe=Object.getOwnPropertyDescriptors,vY=Object.getOwnPropertySymbols,vJe=Object.prototype.hasOwnProperty,xJe=Object.prototype.propertyIsEnumerable,xY=(t,e,n)=>e in t?AJe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,IT=(t,e)=>{for(var n in e||(e={}))vJe.call(e,n)&&xY(t,n,e[n]);if(vY)for(var n of vY(e))xJe.call(e,n)&&xY(t,n,e[n]);return t},bJe=(t,e)=>_Je(t,yJe(e));function wJe({underline:t,strikethrough:e}){const n=[];return t&&n.push("underline"),e&&n.push("line-through"),n.length>0?n.join(" "):"none"}function EJe({theme:t,color:e}){return e==="dimmed"?t.fn.dimmed():typeof e=="string"&&(e in t.colors||e.split(".")[0]in t.colors)?t.fn.variant({variant:"filled",color:e}).background:e||"inherit"}function SJe(t){return typeof t=="number"?{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:t,WebkitBoxOrient:"vertical"}:null}function TJe({theme:t,truncate:e}){return e==="start"?{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",direction:t.dir==="ltr"?"rtl":"ltr",textAlign:t.dir==="ltr"?"right":"left"}:e?{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}:null}var CJe=no((t,{color:e,lineClamp:n,truncate:r,inline:i,inherit:o,underline:a,gradient:s,weight:u,transform:d,align:g,strikethrough:_,italic:E},{size:P})=>{const O=t.fn.variant({variant:"gradient",gradient:s});return{root:bJe(IT(IT(IT(IT({},t.fn.fontStyles()),t.fn.focusStyles()),SJe(n)),TJe({theme:t,truncate:r})),{color:EJe({color:e,theme:t}),fontFamily:o?"inherit":t.fontFamily,fontSize:o||P===void 0?"inherit":Zr({size:P,sizes:t.fontSizes}),lineHeight:o?"inherit":i?1:t.lineHeight,textDecoration:wJe({underline:a,strikethrough:_}),WebkitTapHighlightColor:"transparent",fontWeight:o?"inherit":u,textTransform:d,textAlign:g,fontStyle:E?"italic":void 0}),gradient:{backgroundImage:O.background,WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"}}});const PJe=CJe;var IJe=Object.defineProperty,IM=Object.getOwnPropertySymbols,Xle=Object.prototype.hasOwnProperty,Zle=Object.prototype.propertyIsEnumerable,bY=(t,e,n)=>e in t?IJe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,MJe=(t,e)=>{for(var n in e||(e={}))Xle.call(e,n)&&bY(t,n,e[n]);if(IM)for(var n of IM(e))Zle.call(e,n)&&bY(t,n,e[n]);return t},OJe=(t,e)=>{var n={};for(var r in t)Xle.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&IM)for(var r of IM(t))e.indexOf(r)<0&&Zle.call(t,r)&&(n[r]=t[r]);return n};const RJe={variant:"text"},Yle=Ee.forwardRef((t,e)=>{const n=Gr("Text",RJe,t),{className:r,size:i,weight:o,transform:a,color:s,align:u,variant:d,lineClamp:g,truncate:_,gradient:E,inline:P,inherit:O,underline:D,strikethrough:V,italic:k,classNames:F,styles:z,unstyled:X,span:Y,__staticSelector:J}=n,re=OJe(n,["className","size","weight","transform","color","align","variant","lineClamp","truncate","gradient","inline","inherit","underline","strikethrough","italic","classNames","styles","unstyled","span","__staticSelector"]),{classes:ue,cx:ie}=PJe({color:s,lineClamp:g,truncate:_,inline:P,inherit:O,underline:D,strikethrough:V,italic:k,weight:o,transform:a,align:u,gradient:E},{unstyled:X,name:J||"Text",variant:d,size:i});return ut.createElement(go,MJe({ref:e,className:ie(ue.root,{[ue.gradient]:d==="gradient"},r),component:Y?"span":"div"},re))});Yle.displayName="@mantine/core/Text";const Nh=Yle,MT={xs:pn(1),sm:pn(2),md:pn(3),lg:pn(4),xl:pn(5)};function OT(t,e){const n=t.fn.variant({variant:"outline",color:e}).border;return typeof e=="string"&&(e in t.colors||e.split(".")[0]in t.colors)?n:e===void 0?t.colorScheme==="dark"?t.colors.dark[4]:t.colors.gray[4]:e}var LJe=no((t,{color:e},{size:n,variant:r})=>({root:{},withLabel:{borderTop:"0 !important"},left:{"&::before":{display:"none"}},right:{"&::after":{display:"none"}},label:{display:"flex",alignItems:"center","&::before":{content:'""',flex:1,height:pn(1),borderTop:`${Zr({size:n,sizes:MT})} ${r} ${OT(t,e)}`,marginRight:t.spacing.xs},"&::after":{content:'""',flex:1,borderTop:`${Zr({size:n,sizes:MT})} ${r} ${OT(t,e)}`,marginLeft:t.spacing.xs}},labelDefaultStyles:{color:e==="dark"?t.colors.dark[1]:t.fn.themeColor(e,t.colorScheme==="dark"?5:t.fn.primaryShade(),!1)},horizontal:{border:0,borderTopWidth:pn(Zr({size:n,sizes:MT})),borderTopColor:OT(t,e),borderTopStyle:r,margin:0},vertical:{border:0,alignSelf:"stretch",height:"auto",borderLeftWidth:pn(Zr({size:n,sizes:MT})),borderLeftColor:OT(t,e),borderLeftStyle:r}}));const DJe=LJe;var BJe=Object.defineProperty,NJe=Object.defineProperties,FJe=Object.getOwnPropertyDescriptors,MM=Object.getOwnPropertySymbols,Qle=Object.prototype.hasOwnProperty,Kle=Object.prototype.propertyIsEnumerable,wY=(t,e,n)=>e in t?BJe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,EY=(t,e)=>{for(var n in e||(e={}))Qle.call(e,n)&&wY(t,n,e[n]);if(MM)for(var n of MM(e))Kle.call(e,n)&&wY(t,n,e[n]);return t},kJe=(t,e)=>NJe(t,FJe(e)),zJe=(t,e)=>{var n={};for(var r in t)Qle.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&MM)for(var r of MM(t))e.indexOf(r)<0&&Kle.call(t,r)&&(n[r]=t[r]);return n};const UJe={orientation:"horizontal",size:"xs",labelPosition:"left",variant:"solid"},Jle=Ee.forwardRef((t,e)=>{const n=Gr("Divider",UJe,t),{className:r,color:i,orientation:o,size:a,label:s,labelPosition:u,labelProps:d,variant:g,styles:_,classNames:E,unstyled:P}=n,O=zJe(n,["className","color","orientation","size","label","labelPosition","labelProps","variant","styles","classNames","unstyled"]),{classes:D,cx:V}=DJe({color:i},{classNames:E,styles:_,unstyled:P,name:"Divider",variant:g,size:a}),k=o==="vertical",F=o==="horizontal",z=!!s&&F,X=!(d!=null&&d.color);return ut.createElement(go,EY({ref:e,className:V(D.root,{[D.vertical]:k,[D.horizontal]:F,[D.withLabel]:z},r),role:"separator"},O),z&&ut.createElement(Nh,kJe(EY({},d),{size:(d==null?void 0:d.size)||"xs",mt:pn(2),className:V(D.label,D[u],{[D.labelDefaultStyles]:X})}),s))});Jle.displayName="@mantine/core/Divider";const Fh=Math.min,wl=Math.max,OM=Math.round,RT=Math.floor,pA=t=>({x:t,y:t}),GJe={left:"right",right:"left",bottom:"top",top:"bottom"},jJe={start:"end",end:"start"};function tz(t,e,n){return wl(t,Fh(e,n))}function vg(t,e){return typeof t=="function"?t(e):t}function kh(t){return t.split("-")[0]}function ex(t){return t.split("-")[1]}function n8(t){return t==="x"?"y":"x"}function r8(t){return t==="y"?"height":"width"}function C_(t){return["top","bottom"].includes(kh(t))?"y":"x"}function i8(t){return n8(C_(t))}function VJe(t,e,n){n===void 0&&(n=!1);const r=ex(t),i=i8(t),o=r8(i);let a=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(a=RM(a)),[a,RM(a)]}function $Je(t){const e=RM(t);return[nz(t),e,nz(e)]}function nz(t){return t.replace(/start|end/g,e=>jJe[e])}function HJe(t,e,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?o:a;default:return[]}}function WJe(t,e,n,r){const i=ex(t);let o=HJe(kh(t),n==="start",r);return i&&(o=o.map(a=>a+"-"+i),e&&(o=o.concat(o.map(nz)))),o}function RM(t){return t.replace(/left|right|bottom|top/g,e=>GJe[e])}function qJe(t){return{top:0,right:0,bottom:0,left:0,...t}}function o8(t){return typeof t!="number"?qJe(t):{top:t,right:t,bottom:t,left:t}}function C1(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function SY(t,e,n){let{reference:r,floating:i}=t;const o=C_(e),a=i8(e),s=r8(a),u=kh(e),d=o==="y",g=r.x+r.width/2-i.width/2,_=r.y+r.height/2-i.height/2,E=r[s]/2-i[s]/2;let P;switch(u){case"top":P={x:g,y:r.y-i.height};break;case"bottom":P={x:g,y:r.y+r.height};break;case"right":P={x:r.x+r.width,y:_};break;case"left":P={x:r.x-i.width,y:_};break;default:P={x:r.x,y:r.y}}switch(ex(e)){case"start":P[a]-=E*(n&&d?-1:1);break;case"end":P[a]+=E*(n&&d?-1:1);break}return P}const XJe=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:a}=n,s=o.filter(Boolean),u=await(a.isRTL==null?void 0:a.isRTL(e));let d=await a.getElementRects({reference:t,floating:e,strategy:i}),{x:g,y:_}=SY(d,r,u),E=r,P={},O=0;for(let D=0;D<s.length;D++){const{name:V,fn:k}=s[D],{x:F,y:z,data:X,reset:Y}=await k({x:g,y:_,initialPlacement:r,placement:E,strategy:i,middlewareData:P,rects:d,platform:a,elements:{reference:t,floating:e}});if(g=F??g,_=z??_,P={...P,[V]:{...P[V],...X}},Y&&O<=50){O++,typeof Y=="object"&&(Y.placement&&(E=Y.placement),Y.rects&&(d=Y.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:i}):Y.rects),{x:g,y:_}=SY(d,E,u)),D=-1;continue}}return{x:g,y:_,placement:E,strategy:i,middlewareData:P}};async function s8(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:a,elements:s,strategy:u}=t,{boundary:d="clippingAncestors",rootBoundary:g="viewport",elementContext:_="floating",altBoundary:E=!1,padding:P=0}=vg(e,t),O=o8(P),V=s[E?_==="floating"?"reference":"floating":_],k=C1(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(V)))==null||n?V:V.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(s.floating)),boundary:d,rootBoundary:g,strategy:u})),F=_==="floating"?{...a.floating,x:r,y:i}:a.reference,z=await(o.getOffsetParent==null?void 0:o.getOffsetParent(s.floating)),X=await(o.isElement==null?void 0:o.isElement(z))?await(o.getScale==null?void 0:o.getScale(z))||{x:1,y:1}:{x:1,y:1},Y=C1(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({rect:F,offsetParent:z,strategy:u}):F);return{top:(k.top-Y.top+O.top)/X.y,bottom:(Y.bottom-k.bottom+O.bottom)/X.y,left:(k.left-Y.left+O.left)/X.x,right:(Y.right-k.right+O.right)/X.x}}const TY=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:i,rects:o,platform:a,elements:s,middlewareData:u}=e,{element:d,padding:g=0}=vg(t,e)||{};if(d==null)return{};const _=o8(g),E={x:n,y:r},P=i8(i),O=r8(P),D=await a.getDimensions(d),V=P==="y",k=V?"top":"left",F=V?"bottom":"right",z=V?"clientHeight":"clientWidth",X=o.reference[O]+o.reference[P]-E[P]-o.floating[O],Y=E[P]-o.reference[P],J=await(a.getOffsetParent==null?void 0:a.getOffsetParent(d));let re=J?J[z]:0;(!re||!await(a.isElement==null?void 0:a.isElement(J)))&&(re=s.floating[z]||o.floating[O]);const ue=X/2-Y/2,ie=re/2-D[O]/2-1,ce=Fh(_[k],ie),se=Fh(_[F],ie),me=ce,Ce=re-D[O]-se,we=re/2-D[O]/2+ue,Ye=tz(me,we,Ce),at=!u.arrow&&ex(i)!=null&&we!=Ye&&o.reference[O]/2-(we<me?ce:se)-D[O]/2<0,yt=at?we<me?we-me:we-Ce:0;return{[P]:E[P]+yt,data:{[P]:Ye,centerOffset:we-Ye-yt,...at&&{alignmentOffset:yt}},reset:at}}}),eue=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:o,rects:a,initialPlacement:s,platform:u,elements:d}=e,{mainAxis:g=!0,crossAxis:_=!0,fallbackPlacements:E,fallbackStrategy:P="bestFit",fallbackAxisSideDirection:O="none",flipAlignment:D=!0,...V}=vg(t,e);if((n=o.arrow)!=null&&n.alignmentOffset)return{};const k=kh(i),F=kh(s)===s,z=await(u.isRTL==null?void 0:u.isRTL(d.floating)),X=E||(F||!D?[RM(s)]:$Je(s));!E&&O!=="none"&&X.push(...WJe(s,D,O,z));const Y=[s,...X],J=await s8(e,V),re=[];let ue=((r=o.flip)==null?void 0:r.overflows)||[];if(g&&re.push(J[k]),_){const me=VJe(i,a,z);re.push(J[me[0]],J[me[1]])}if(ue=[...ue,{placement:i,overflows:re}],!re.every(me=>me<=0)){var ie,ce;const me=(((ie=o.flip)==null?void 0:ie.index)||0)+1,Ce=Y[me];if(Ce)return{data:{index:me,overflows:ue},reset:{placement:Ce}};let we=(ce=ue.filter(Ye=>Ye.overflows[0]<=0).sort((Ye,at)=>Ye.overflows[1]-at.overflows[1])[0])==null?void 0:ce.placement;if(!we)switch(P){case"bestFit":{var se;const Ye=(se=ue.map(at=>[at.placement,at.overflows.filter(yt=>yt>0).reduce((yt,be)=>yt+be,0)]).sort((at,yt)=>at[1]-yt[1])[0])==null?void 0:se[0];Ye&&(we=Ye);break}case"initialPlacement":we=s;break}if(i!==we)return{reset:{placement:we}}}return{}}}};function tue(t){const e=Fh(...t.map(o=>o.left)),n=Fh(...t.map(o=>o.top)),r=wl(...t.map(o=>o.right)),i=wl(...t.map(o=>o.bottom));return{x:e,y:n,width:r-e,height:i-n}}function ZJe(t){const e=t.slice().sort((i,o)=>i.y-o.y),n=[];let r=null;for(let i=0;i<e.length;i++){const o=e[i];!r||o.y-r.y>r.height/2?n.push([o]):n[n.length-1].push(o),r=o}return n.map(i=>C1(tue(i)))}const nue=function(t){return t===void 0&&(t={}),{name:"inline",options:t,async fn(e){const{placement:n,elements:r,rects:i,platform:o,strategy:a}=e,{padding:s=2,x:u,y:d}=vg(t,e),g=Array.from(await(o.getClientRects==null?void 0:o.getClientRects(r.reference))||[]),_=ZJe(g),E=C1(tue(g)),P=o8(s);function O(){if(_.length===2&&_[0].left>_[1].right&&u!=null&&d!=null)return _.find(V=>u>V.left-P.left&&u<V.right+P.right&&d>V.top-P.top&&d<V.bottom+P.bottom)||E;if(_.length>=2){if(C_(n)==="y"){const ce=_[0],se=_[_.length-1],me=kh(n)==="top",Ce=ce.top,we=se.bottom,Ye=me?ce.left:se.left,at=me?ce.right:se.right,yt=at-Ye,be=we-Ce;return{top:Ce,bottom:we,left:Ye,right:at,width:yt,height:be,x:Ye,y:Ce}}const V=kh(n)==="left",k=wl(..._.map(ce=>ce.right)),F=Fh(..._.map(ce=>ce.left)),z=_.filter(ce=>V?ce.left===F:ce.right===k),X=z[0].top,Y=z[z.length-1].bottom,J=F,re=k,ue=re-J,ie=Y-X;return{top:X,bottom:Y,left:J,right:re,width:ue,height:ie,x:J,y:X}}return E}const D=await o.getElementRects({reference:{getBoundingClientRect:O},floating:r.floating,strategy:a});return i.reference.x!==D.reference.x||i.reference.y!==D.reference.y||i.reference.width!==D.reference.width||i.reference.height!==D.reference.height?{reset:{rects:D}}:{}}}};async function YJe(t,e){const{placement:n,platform:r,elements:i}=t,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),a=kh(n),s=ex(n),u=C_(n)==="y",d=["left","top"].includes(a)?-1:1,g=o&&u?-1:1,_=vg(e,t);let{mainAxis:E,crossAxis:P,alignmentAxis:O}=typeof _=="number"?{mainAxis:_,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,..._};return s&&typeof O=="number"&&(P=s==="end"?O*-1:O),u?{x:P*g,y:E*d}:{x:E*d,y:P*g}}const rue=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:n,y:r}=e,i=await YJe(e,t);return{x:n+i.x,y:r+i.y,data:i}}}},a8=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:a=!1,limiter:s={fn:V=>{let{x:k,y:F}=V;return{x:k,y:F}}},...u}=vg(t,e),d={x:n,y:r},g=await s8(e,u),_=C_(kh(i)),E=n8(_);let P=d[E],O=d[_];if(o){const V=E==="y"?"top":"left",k=E==="y"?"bottom":"right",F=P+g[V],z=P-g[k];P=tz(F,P,z)}if(a){const V=_==="y"?"top":"left",k=_==="y"?"bottom":"right",F=O+g[V],z=O-g[k];O=tz(F,O,z)}const D=s.fn({...e,[E]:P,[_]:O});return{...D,data:{x:D.x-n,y:D.y-r}}}}},QJe=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:i,rects:o,middlewareData:a}=e,{offset:s=0,mainAxis:u=!0,crossAxis:d=!0}=vg(t,e),g={x:n,y:r},_=C_(i),E=n8(_);let P=g[E],O=g[_];const D=vg(s,e),V=typeof D=="number"?{mainAxis:D,crossAxis:0}:{mainAxis:0,crossAxis:0,...D};if(u){const z=E==="y"?"height":"width",X=o.reference[E]-o.floating[z]+V.mainAxis,Y=o.reference[E]+o.reference[z]-V.mainAxis;P<X?P=X:P>Y&&(P=Y)}if(d){var k,F;const z=E==="y"?"width":"height",X=["top","left"].includes(kh(i)),Y=o.reference[_]-o.floating[z]+(X&&((k=a.offset)==null?void 0:k[_])||0)+(X?0:V.crossAxis),J=o.reference[_]+o.reference[z]+(X?0:((F=a.offset)==null?void 0:F[_])||0)-(X?V.crossAxis:0);O<Y?O=Y:O>J&&(O=J)}return{[E]:P,[_]:O}}}},KJe=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){const{placement:n,rects:r,platform:i,elements:o}=e,{apply:a=()=>{},...s}=vg(t,e),u=await s8(e,s),d=kh(n),g=ex(n),_=C_(n)==="y",{width:E,height:P}=r.floating;let O,D;d==="top"||d==="bottom"?(O=d,D=g===(await(i.isRTL==null?void 0:i.isRTL(o.floating))?"start":"end")?"left":"right"):(D=d,O=g==="end"?"top":"bottom");const V=P-u[O],k=E-u[D],F=!e.middlewareData.shift;let z=V,X=k;if(_){const J=E-u.left-u.right;X=g||F?Fh(k,J):J}else{const J=P-u.top-u.bottom;z=g||F?Fh(V,J):J}if(F&&!g){const J=wl(u.left,0),re=wl(u.right,0),ue=wl(u.top,0),ie=wl(u.bottom,0);_?X=E-2*(J!==0||re!==0?J+re:wl(u.left,u.right)):z=P-2*(ue!==0||ie!==0?ue+ie:wl(u.top,u.bottom))}await a({...e,availableWidth:X,availableHeight:z});const Y=await i.getDimensions(o.floating);return E!==Y.width||P!==Y.height?{reset:{rects:!0}}:{}}}};function gA(t){return iue(t)?(t.nodeName||"").toLowerCase():"#document"}function yc(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Pg(t){var e;return(e=(iue(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function iue(t){return t instanceof Node||t instanceof yc(t).Node}function xg(t){return t instanceof Element||t instanceof yc(t).Element}function Yd(t){return t instanceof HTMLElement||t instanceof yc(t).HTMLElement}function CY(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof yc(t).ShadowRoot}function x2(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Rf(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function JJe(t){return["table","td","th"].includes(gA(t))}function l8(t){const e=u8(),n=Rf(t);return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function eet(t){let e=P1(t);for(;Yd(e)&&!jL(e);){if(l8(e))return e;e=P1(e)}return null}function u8(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function jL(t){return["html","body","#document"].includes(gA(t))}function Rf(t){return yc(t).getComputedStyle(t)}function VL(t){return xg(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function P1(t){if(gA(t)==="html")return t;const e=t.assignedSlot||t.parentNode||CY(t)&&t.host||Pg(t);return CY(e)?e.host:e}function oue(t){const e=P1(t);return jL(e)?t.ownerDocument?t.ownerDocument.body:t.body:Yd(e)&&x2(e)?e:oue(e)}function ng(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=oue(t),o=i===((r=t.ownerDocument)==null?void 0:r.body),a=yc(i);return o?e.concat(a,a.visualViewport||[],x2(i)?i:[],a.frameElement&&n?ng(a.frameElement):[]):e.concat(i,ng(i,[],n))}function sue(t){const e=Rf(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Yd(t),o=i?t.offsetWidth:n,a=i?t.offsetHeight:r,s=OM(n)!==o||OM(r)!==a;return s&&(n=o,r=a),{width:n,height:r,$:s}}function c8(t){return xg(t)?t:t.contextElement}function Cv(t){const e=c8(t);if(!Yd(e))return pA(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:o}=sue(e);let a=(o?OM(n.width):n.width)/r,s=(o?OM(n.height):n.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!s||!Number.isFinite(s))&&(s=1),{x:a,y:s}}const tet=pA(0);function aue(t){const e=yc(t);return!u8()||!e.visualViewport?tet:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function net(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==yc(t)?!1:e}function s_(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),o=c8(t);let a=pA(1);e&&(r?xg(r)&&(a=Cv(r)):a=Cv(t));const s=net(o,n,r)?aue(o):pA(0);let u=(i.left+s.x)/a.x,d=(i.top+s.y)/a.y,g=i.width/a.x,_=i.height/a.y;if(o){const E=yc(o),P=r&&xg(r)?yc(r):r;let O=E.frameElement;for(;O&&r&&P!==E;){const D=Cv(O),V=O.getBoundingClientRect(),k=Rf(O),F=V.left+(O.clientLeft+parseFloat(k.paddingLeft))*D.x,z=V.top+(O.clientTop+parseFloat(k.paddingTop))*D.y;u*=D.x,d*=D.y,g*=D.x,_*=D.y,u+=F,d+=z,O=yc(O).frameElement}}return C1({width:g,height:_,x:u,y:d})}function ret(t){let{rect:e,offsetParent:n,strategy:r}=t;const i=Yd(n),o=Pg(n);if(n===o)return e;let a={scrollLeft:0,scrollTop:0},s=pA(1);const u=pA(0);if((i||!i&&r!=="fixed")&&((gA(n)!=="body"||x2(o))&&(a=VL(n)),Yd(n))){const d=s_(n);s=Cv(n),u.x=d.x+n.clientLeft,u.y=d.y+n.clientTop}return{width:e.width*s.x,height:e.height*s.y,x:e.x*s.x-a.scrollLeft*s.x+u.x,y:e.y*s.y-a.scrollTop*s.y+u.y}}function iet(t){return Array.from(t.getClientRects())}function lue(t){return s_(Pg(t)).left+VL(t).scrollLeft}function oet(t){const e=Pg(t),n=VL(t),r=t.ownerDocument.body,i=wl(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=wl(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+lue(t);const s=-n.scrollTop;return Rf(r).direction==="rtl"&&(a+=wl(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:a,y:s}}function set(t,e){const n=yc(t),r=Pg(t),i=n.visualViewport;let o=r.clientWidth,a=r.clientHeight,s=0,u=0;if(i){o=i.width,a=i.height;const d=u8();(!d||d&&e==="fixed")&&(s=i.offsetLeft,u=i.offsetTop)}return{width:o,height:a,x:s,y:u}}function aet(t,e){const n=s_(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=Yd(t)?Cv(t):pA(1),a=t.clientWidth*o.x,s=t.clientHeight*o.y,u=i*o.x,d=r*o.y;return{width:a,height:s,x:u,y:d}}function PY(t,e,n){let r;if(e==="viewport")r=set(t,n);else if(e==="document")r=oet(Pg(t));else if(xg(e))r=aet(e,n);else{const i=aue(t);r={...e,x:e.x-i.x,y:e.y-i.y}}return C1(r)}function uue(t,e){const n=P1(t);return n===e||!xg(n)||jL(n)?!1:Rf(n).position==="fixed"||uue(n,e)}function uet(t,e){const n=e.get(t);if(n)return n;let r=ng(t,[],!1).filter(s=>xg(s)&&gA(s)!=="body"),i=null;const o=Rf(t).position==="fixed";let a=o?P1(t):t;for(;xg(a)&&!jL(a);){const s=Rf(a),u=l8(a);!u&&s.position==="fixed"&&(i=null),(o?!u&&!i:!u&&s.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||x2(a)&&!u&&uue(t,a))?r=r.filter(g=>g!==a):i=s,a=P1(a)}return e.set(t,r),r}function cet(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const a=[...n==="clippingAncestors"?uet(e,this._c):[].concat(n),r],s=a[0],u=a.reduce((d,g)=>{const _=PY(e,g,i);return d.top=wl(_.top,d.top),d.right=Fh(_.right,d.right),d.bottom=Fh(_.bottom,d.bottom),d.left=wl(_.left,d.left),d},PY(e,s,i));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function fet(t){return sue(t)}function het(t,e,n){const r=Yd(e),i=Pg(e),o=n==="fixed",a=s_(t,!0,o,e);let s={scrollLeft:0,scrollTop:0};const u=pA(0);if(r||!r&&!o)if((gA(e)!=="body"||x2(i))&&(s=VL(e)),r){const d=s_(e,!0,o,e);u.x=d.x+e.clientLeft,u.y=d.y+e.clientTop}else i&&(u.x=lue(i));return{x:a.left+s.scrollLeft-u.x,y:a.top+s.scrollTop-u.y,width:a.width,height:a.height}}function IY(t,e){return!Yd(t)||Rf(t).position==="fixed"?null:e?e(t):t.offsetParent}function cue(t,e){const n=yc(t);if(!Yd(t))return n;let r=IY(t,e);for(;r&&JJe(r)&&Rf(r).position==="static";)r=IY(r,e);return r&&(gA(r)==="html"||gA(r)==="body"&&Rf(r).position==="static"&&!l8(r))?n:r||eet(t)||n}const det=async function(t){let{reference:e,floating:n,strategy:r}=t;const i=this.getOffsetParent||cue,o=this.getDimensions;return{reference:het(e,await i(n),r),floating:{x:0,y:0,...await o(n)}}};function pet(t){return Rf(t).direction==="rtl"}const get={convertOffsetParentRelativeRectToViewportRelativeRect:ret,getDocumentElement:Pg,getClippingRect:cet,getOffsetParent:cue,getElementRects:det,getClientRects:iet,getDimensions:fet,getScale:Cv,isElement:xg,isRTL:pet};function met(t,e){let n=null,r;const i=Pg(t);function o(){clearTimeout(r),n&&n.disconnect(),n=null}function a(s,u){s===void 0&&(s=!1),u===void 0&&(u=1),o();const{left:d,top:g,width:_,height:E}=t.getBoundingClientRect();if(s||e(),!_||!E)return;const P=RT(g),O=RT(i.clientWidth-(d+_)),D=RT(i.clientHeight-(g+E)),V=RT(d),F={rootMargin:-P+"px "+-O+"px "+-D+"px "+-V+"px",threshold:wl(0,Fh(1,u))||1};let z=!0;function X(Y){const J=Y[0].intersectionRatio;if(J!==u){if(!z)return a();J?a(!1,J):r=setTimeout(()=>{a(!1,1e-7)},100)}z=!1}try{n=new IntersectionObserver(X,{...F,root:i.ownerDocument})}catch{n=new IntersectionObserver(X,F)}n.observe(t)}return a(!0),o}function Aet(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:o=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,d=c8(t),g=i||o?[...d?ng(d):[],...ng(e)]:[];g.forEach(k=>{i&&k.addEventListener("scroll",n,{passive:!0}),o&&k.addEventListener("resize",n)});const _=d&&s?met(d,n):null;let E=-1,P=null;a&&(P=new ResizeObserver(k=>{let[F]=k;F&&F.target===d&&P&&(P.unobserve(e),cancelAnimationFrame(E),E=requestAnimationFrame(()=>{P&&P.observe(e)})),n()}),d&&!u&&P.observe(d),P.observe(e));let O,D=u?s_(t):null;u&&V();function V(){const k=s_(t);D&&(k.x!==D.x||k.y!==D.y||k.width!==D.width||k.height!==D.height)&&n(),D=k,O=requestAnimationFrame(V)}return n(),()=>{g.forEach(k=>{i&&k.removeEventListener("scroll",n),o&&k.removeEventListener("resize",n)}),_&&_(),P&&P.disconnect(),P=null,u&&cancelAnimationFrame(O)}}const _et=(t,e,n)=>{const r=new Map,i={platform:get,...n},o={...i.platform,_c:r};return XJe(t,e,{...i,platform:o})},fue=t=>{const{element:e,padding:n}=t;function r(i){return Object.prototype.hasOwnProperty.call(i,"current")}return{name:"arrow",options:t,fn(i){return r(e)?e.current!=null?TY({element:e.current,padding:n}).fn(i):{}:e?TY({element:e,padding:n}).fn(i):{}}}};var wP=typeof document<"u"?Ee.useLayoutEffect:Ee.useEffect;function LM(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(r=n;r--!==0;)if(!LM(t[r],e[r]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!Object.prototype.hasOwnProperty.call(e,i[r]))return!1;for(r=n;r--!==0;){const o=i[r];if(!(o==="_owner"&&t.$$typeof)&&!LM(t[o],e[o]))return!1}return!0}return t!==t&&e!==e}function MY(t){const e=Ee.useRef(t);return wP(()=>{e.current=t}),e}function yet(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:i,whileElementsMounted:o,open:a}=t,[s,u]=Ee.useState({x:null,y:null,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[d,g]=Ee.useState(r);LM(d,r)||g(r);const _=Ee.useRef(null),E=Ee.useRef(null),P=Ee.useRef(s),O=MY(o),D=MY(i),[V,k]=Ee.useState(null),[F,z]=Ee.useState(null),X=Ee.useCallback(ce=>{_.current!==ce&&(_.current=ce,k(ce))},[]),Y=Ee.useCallback(ce=>{E.current!==ce&&(E.current=ce,z(ce))},[]),J=Ee.useCallback(()=>{if(!_.current||!E.current)return;const ce={placement:e,strategy:n,middleware:d};D.current&&(ce.platform=D.current),_et(_.current,E.current,ce).then(se=>{const me={...se,isPositioned:!0};re.current&&!LM(P.current,me)&&(P.current=me,PE.flushSync(()=>{u(me)}))})},[d,e,n,D]);wP(()=>{a===!1&&P.current.isPositioned&&(P.current.isPositioned=!1,u(ce=>({...ce,isPositioned:!1})))},[a]);const re=Ee.useRef(!1);wP(()=>(re.current=!0,()=>{re.current=!1}),[]),wP(()=>{if(V&&F){if(O.current)return O.current(V,F,J);J()}},[V,F,J,O]);const ue=Ee.useMemo(()=>({reference:_,floating:E,setReference:X,setFloating:Y}),[X,Y]),ie=Ee.useMemo(()=>({reference:V,floating:F}),[V,F]);return Ee.useMemo(()=>({...s,update:J,refs:ue,elements:ie,reference:X,floating:Y}),[s,J,ue,ie,X,Y])}var I1=typeof document<"u"?Ee.useLayoutEffect:Ee.useEffect;let _N=!1,vet=0;const OY=()=>"floating-ui-"+vet++;function xet(){const[t,e]=Ee.useState(()=>_N?OY():void 0);return I1(()=>{t==null&&e(OY())},[]),Ee.useEffect(()=>{_N||(_N=!0)},[]),t}const bet=MP["useId".toString()],RY=bet||xet;function wet(){const t=new Map;return{emit(e,n){var r;(r=t.get(e))==null||r.forEach(i=>i(n))},on(e,n){t.set(e,[...t.get(e)||[],n])},off(e,n){t.set(e,(t.get(e)||[]).filter(r=>r!==n))}}}const Eet=Ee.createContext(null),Tet=Ee.createContext(null),hue=()=>{var t;return((t=Ee.useContext(Eet))==null?void 0:t.id)||null},f8=()=>Ee.useContext(Tet);function Lm(t){return(t==null?void 0:t.ownerDocument)||document}function Cet(){const t=navigator.userAgentData;return t!=null&&t.platform?t.platform:navigator.platform}function Pet(){const t=navigator.userAgentData;return t&&Array.isArray(t.brands)?t.brands.map(e=>{let{brand:n,version:r}=e;return n+"/"+r}).join(" "):navigator.userAgent}function h8(t){return Lm(t).defaultView||window}function Bd(t){return t?t instanceof h8(t).Element:!1}function due(t){return t?t instanceof h8(t).HTMLElement:!1}function Iet(t){if(typeof ShadowRoot>"u")return!1;const e=h8(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function Met(t){if(t.mozInputSource===0&&t.isTrusted)return!0;const e=/Android/i;return(e.test(Cet())||e.test(Pet()))&&t.pointerType?t.type==="click"&&t.buttons===1:t.detail===0&&!t.pointerType}function Oet(t){return t.width===0&&t.height===0||t.width===1&&t.height===1&&t.pressure===0&&t.detail===0&&t.pointerType!=="mouse"||t.width<1&&t.height<1&&t.pressure===0&&t.detail===0}function pue(t,e){const n=["mouse","pen"];return e||n.push("",void 0),n.includes(t)}function LY(t){const e=Ee.useRef(t);return I1(()=>{e.current=t}),e}const DY="data-floating-ui-safe-polygon";function EP(t,e,n){return n&&!pue(n)?0:typeof t=="number"?t:t==null?void 0:t[e]}const Ret=function(t,e){let{enabled:n=!0,delay:r=0,handleClose:i=null,mouseOnly:o=!1,restMs:a=0,move:s=!0}=e===void 0?{}:e;const{open:u,onOpenChange:d,dataRef:g,events:_,elements:{domReference:E,floating:P},refs:O}=t,D=f8(),V=hue(),k=LY(i),F=LY(r),z=Ee.useRef(),X=Ee.useRef(),Y=Ee.useRef(),J=Ee.useRef(),re=Ee.useRef(!0),ue=Ee.useRef(!1),ie=Ee.useRef(()=>{}),ce=Ee.useCallback(()=>{var we;const Ye=(we=g.current.openEvent)==null?void 0:we.type;return(Ye==null?void 0:Ye.includes("mouse"))&&Ye!=="mousedown"},[g]);Ee.useEffect(()=>{if(!n)return;function we(){clearTimeout(X.current),clearTimeout(J.current),re.current=!0}return _.on("dismiss",we),()=>{_.off("dismiss",we)}},[n,_]),Ee.useEffect(()=>{if(!n||!k.current||!u)return;function we(){ce()&&d(!1)}const Ye=Lm(P).documentElement;return Ye.addEventListener("mouseleave",we),()=>{Ye.removeEventListener("mouseleave",we)}},[P,u,d,n,k,g,ce]);const se=Ee.useCallback(function(we){we===void 0&&(we=!0);const Ye=EP(F.current,"close",z.current);Ye&&!Y.current?(clearTimeout(X.current),X.current=setTimeout(()=>d(!1),Ye)):we&&(clearTimeout(X.current),d(!1))},[F,d]),me=Ee.useCallback(()=>{ie.current(),Y.current=void 0},[]),Ce=Ee.useCallback(()=>{if(ue.current){const we=Lm(O.floating.current).body;we.style.pointerEvents="",we.removeAttribute(DY),ue.current=!1}},[O]);return Ee.useEffect(()=>{if(!n)return;function we(){return g.current.openEvent?["click","mousedown"].includes(g.current.openEvent.type):!1}function Ye(be){if(clearTimeout(X.current),re.current=!1,o&&!pue(z.current)||a>0&&EP(F.current,"open")===0)return;g.current.openEvent=be;const De=EP(F.current,"open",z.current);De?X.current=setTimeout(()=>{d(!0)},De):d(!0)}function at(be){if(we())return;ie.current();const De=Lm(P);if(clearTimeout(J.current),k.current){u||clearTimeout(X.current),Y.current=k.current({...t,tree:D,x:be.clientX,y:be.clientY,onClose(){Ce(),me(),se()}});const Re=Y.current;De.addEventListener("mousemove",Re),ie.current=()=>{De.removeEventListener("mousemove",Re)};return}se()}function yt(be){we()||k.current==null||k.current({...t,tree:D,x:be.clientX,y:be.clientY,onClose(){Ce(),me(),se()}})(be)}if(Bd(E)){const be=E;return u&&be.addEventListener("mouseleave",yt),P==null||P.addEventListener("mouseleave",yt),s&&be.addEventListener("mousemove",Ye,{once:!0}),be.addEventListener("mouseenter",Ye),be.addEventListener("mouseleave",at),()=>{u&&be.removeEventListener("mouseleave",yt),P==null||P.removeEventListener("mouseleave",yt),s&&be.removeEventListener("mousemove",Ye),be.removeEventListener("mouseenter",Ye),be.removeEventListener("mouseleave",at)}}},[E,P,n,t,o,a,s,se,me,Ce,d,u,D,F,k,g]),I1(()=>{var we;if(n&&u&&(we=k.current)!=null&&we.__options.blockPointerEvents&&ce()){const yt=Lm(P).body;if(yt.setAttribute(DY,""),yt.style.pointerEvents="none",ue.current=!0,Bd(E)&&P){var Ye,at;const be=E,De=D==null||(Ye=D.nodesRef.current.find(Re=>Re.id===V))==null||(at=Ye.context)==null?void 0:at.elements.floating;return De&&(De.style.pointerEvents=""),be.style.pointerEvents="auto",P.style.pointerEvents="auto",()=>{be.style.pointerEvents="",P.style.pointerEvents=""}}}},[n,u,V,P,E,D,k,g,ce]),I1(()=>{u||(z.current=void 0,me(),Ce())},[u,me,Ce]),Ee.useEffect(()=>()=>{me(),clearTimeout(X.current),clearTimeout(J.current),Ce()},[n,me,Ce]),Ee.useMemo(()=>{if(!n)return{};function we(Ye){z.current=Ye.pointerType}return{reference:{onPointerDown:we,onPointerEnter:we,onMouseMove(){u||a===0||(clearTimeout(J.current),J.current=setTimeout(()=>{re.current||d(!0)},a))}},floating:{onMouseEnter(){clearTimeout(X.current)},onMouseLeave(){_.emit("dismiss",{type:"mouseLeave",data:{returnFocus:!1}}),se(!1)}}}},[_,n,a,u,d,se])},gue=Ee.createContext({delay:0,initialDelay:0,timeoutMs:0,currentId:null,setCurrentId:()=>{},setState:()=>{},isInstantPhase:!1}),mue=()=>Ee.useContext(gue),Let=t=>{let{children:e,delay:n,timeoutMs:r=0}=t;const[i,o]=Ee.useReducer((u,d)=>({...u,...d}),{delay:n,timeoutMs:r,initialDelay:n,currentId:null,isInstantPhase:!1}),a=Ee.useRef(null),s=Ee.useCallback(u=>{o({currentId:u})},[]);return I1(()=>{i.currentId?a.current===null?a.current=i.currentId:o({isInstantPhase:!0}):(o({isInstantPhase:!1}),a.current=null)},[i.currentId]),Ee.createElement(gue.Provider,{value:Ee.useMemo(()=>({...i,setState:o,setCurrentId:s}),[i,o,s])},e)},Det=(t,e)=>{let{open:n,onOpenChange:r}=t,{id:i}=e;const{currentId:o,setCurrentId:a,initialDelay:s,setState:u,timeoutMs:d}=mue();Ee.useEffect(()=>{o&&(u({delay:{open:1,close:EP(s,"close")}}),o!==i&&r(!1))},[i,r,u,o,s]),Ee.useEffect(()=>{function g(){r(!1),u({delay:s,currentId:null})}if(!n&&o===i)if(d){const _=window.setTimeout(g,d);return()=>{clearTimeout(_)}}else g()},[n,u,o,i,r,s,d]),Ee.useEffect(()=>{n&&a(i)},[n,a,i])};function Bet(t){let e=t.activeElement;for(;((n=e)==null||(r=n.shadowRoot)==null?void 0:r.activeElement)!=null;){var n,r;e=e.shadowRoot.activeElement}return e}function BY(t,e){if(!t||!e)return!1;const n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&Iet(n)){let r=e;do{if(r&&t===r)return!0;r=r.parentNode||r.host}while(r)}return!1}function yN(t,e){let n=t.filter(i=>{var o;return i.parentId===e&&((o=i.context)==null?void 0:o.open)})||[],r=n;for(;r.length;)r=t.filter(i=>{var o;return(o=r)==null?void 0:o.some(a=>{var s;return i.parentId===a.id&&((s=i.context)==null?void 0:s.open)})})||[],n=n.concat(r);return n}function Net(t){return"composedPath"in t?t.composedPath()[0]:t.target}const Fet=MP["useInsertionEffect".toString()],ket=Fet||(t=>t());function Aue(t){const e=Ee.useRef(()=>{});return ket(()=>{e.current=t}),Ee.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return e.current==null?void 0:e.current(...r)},[])}function SP(t,e){if(e==null)return!1;if("composedPath"in t)return t.composedPath().includes(e);const n=t;return n.target!=null&&e.contains(n.target)}const zet={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},Uet={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},Get=function(t){var e,n;return t===void 0&&(t=!0),{escapeKeyBubbles:typeof t=="boolean"?t:(e=t.escapeKey)!=null?e:!0,outsidePressBubbles:typeof t=="boolean"?t:(n=t.outsidePress)!=null?n:!0}},jet=function(t,e){let{open:n,onOpenChange:r,events:i,nodeId:o,elements:{reference:a,domReference:s,floating:u},dataRef:d}=t,{enabled:g=!0,escapeKey:_=!0,outsidePress:E=!0,outsidePressEvent:P="pointerdown",referencePress:O=!1,referencePressEvent:D="pointerdown",ancestorScroll:V=!1,bubbles:k=!0}=e===void 0?{}:e;const F=f8(),z=hue()!=null,X=Aue(typeof E=="function"?E:()=>!1),Y=typeof E=="function"?X:E,J=Ee.useRef(!1),{escapeKeyBubbles:re,outsidePressBubbles:ue}=Get(k);return Ee.useEffect(()=>{if(!n||!g)return;d.current.__escapeKeyBubbles=re,d.current.__outsidePressBubbles=ue;function ie(we){if(we.key==="Escape"){const Ye=F?yN(F.nodesRef.current,o):[];if(Ye.length>0){let at=!0;if(Ye.forEach(yt=>{var be;if((be=yt.context)!=null&&be.open&&!yt.context.dataRef.current.__escapeKeyBubbles){at=!1;return}}),!at)return}i.emit("dismiss",{type:"escapeKey",data:{returnFocus:{preventScroll:!1}}}),r(!1)}}function ce(we){const Ye=J.current;if(J.current=!1,Ye||typeof Y=="function"&&!Y(we))return;const at=Net(we);if(due(at)&&u){const De=u.ownerDocument.defaultView||window,Re=at.scrollWidth>at.clientWidth,qe=at.scrollHeight>at.clientHeight;let ct=qe&&we.offsetX>at.clientWidth;if(qe&&De.getComputedStyle(at).direction==="rtl"&&(ct=we.offsetX<=at.offsetWidth-at.clientWidth),ct||Re&&we.offsetY>at.clientHeight)return}const yt=F&&yN(F.nodesRef.current,o).some(De=>{var Re;return SP(we,(Re=De.context)==null?void 0:Re.elements.floating)});if(SP(we,u)||SP(we,s)||yt)return;const be=F?yN(F.nodesRef.current,o):[];if(be.length>0){let De=!0;if(be.forEach(Re=>{var qe;if((qe=Re.context)!=null&&qe.open&&!Re.context.dataRef.current.__outsidePressBubbles){De=!1;return}}),!De)return}i.emit("dismiss",{type:"outsidePress",data:{returnFocus:z?{preventScroll:!0}:Met(we)||Oet(we)}}),r(!1)}function se(){r(!1)}const me=Lm(u);_&&me.addEventListener("keydown",ie),Y&&me.addEventListener(P,ce);let Ce=[];return V&&(Bd(s)&&(Ce=ng(s)),Bd(u)&&(Ce=Ce.concat(ng(u))),!Bd(a)&&a&&a.contextElement&&(Ce=Ce.concat(ng(a.contextElement)))),Ce=Ce.filter(we=>{var Ye;return we!==((Ye=me.defaultView)==null?void 0:Ye.visualViewport)}),Ce.forEach(we=>{we.addEventListener("scroll",se,{passive:!0})}),()=>{_&&me.removeEventListener("keydown",ie),Y&&me.removeEventListener(P,ce),Ce.forEach(we=>{we.removeEventListener("scroll",se)})}},[d,u,s,a,_,Y,P,i,F,o,n,r,V,g,re,ue,z]),Ee.useEffect(()=>{J.current=!1},[Y,P]),Ee.useMemo(()=>g?{reference:{[zet[D]]:()=>{O&&(i.emit("dismiss",{type:"referencePress",data:{returnFocus:!1}}),r(!1))}},floating:{[Uet[P]]:()=>{J.current=!0}}}:{},[g,i,O,P,D,r])},Vet=function(t,e){let{open:n,onOpenChange:r,dataRef:i,events:o,refs:a,elements:{floating:s,domReference:u}}=t,{enabled:d=!0,keyboardOnly:g=!0}=e===void 0?{}:e;const _=Ee.useRef(""),E=Ee.useRef(!1),P=Ee.useRef();return Ee.useEffect(()=>{if(!d)return;const D=Lm(s).defaultView||window;function V(){!n&&due(u)&&u===Bet(Lm(u))&&(E.current=!0)}return D.addEventListener("blur",V),()=>{D.removeEventListener("blur",V)}},[s,u,n,d]),Ee.useEffect(()=>{if(!d)return;function O(D){(D.type==="referencePress"||D.type==="escapeKey")&&(E.current=!0)}return o.on("dismiss",O),()=>{o.off("dismiss",O)}},[o,d]),Ee.useEffect(()=>()=>{clearTimeout(P.current)},[]),Ee.useMemo(()=>d?{reference:{onPointerDown(O){let{pointerType:D}=O;_.current=D,E.current=!!(D&&g)},onMouseLeave(){E.current=!1},onFocus(O){var D;E.current||O.type==="focus"&&((D=i.current.openEvent)==null?void 0:D.type)==="mousedown"&&i.current.openEvent&&SP(i.current.openEvent,u)||(i.current.openEvent=O.nativeEvent,r(!0))},onBlur(O){E.current=!1;const D=O.relatedTarget,V=Bd(D)&&D.hasAttribute("data-floating-ui-focus-guard")&&D.getAttribute("data-type")==="outside";P.current=setTimeout(()=>{BY(a.floating.current,D)||BY(u,D)||V||r(!1)})}}}:{},[d,g,u,a,i,r])},$et=function(t,e){let{open:n}=t,{enabled:r=!0,role:i="dialog"}=e===void 0?{}:e;const o=RY(),a=RY();return Ee.useMemo(()=>{const s={id:o,role:i};return r?i==="tooltip"?{reference:{"aria-describedby":n?o:void 0},floating:s}:{reference:{"aria-expanded":n?"true":"false","aria-haspopup":i==="alertdialog"?"dialog":i,"aria-controls":n?o:void 0,...i==="listbox"&&{role:"combobox"},...i==="menu"&&{id:a}},floating:{...s,...i==="menu"&&{"aria-labelledby":a}}}:{}},[r,i,n,o,a])};function d8(t){t===void 0&&(t={});const{open:e=!1,onOpenChange:n,nodeId:r}=t,i=yet(t),o=f8(),a=Ee.useRef(null),s=Ee.useRef({}),u=Ee.useState(()=>wet())[0],[d,g]=Ee.useState(null),_=Ee.useCallback(k=>{const F=Bd(k)?{getBoundingClientRect:()=>k.getBoundingClientRect(),contextElement:k}:k;i.refs.setReference(F)},[i.refs]),E=Ee.useCallback(k=>{(Bd(k)||k===null)&&(a.current=k,g(k)),(Bd(i.refs.reference.current)||i.refs.reference.current===null||k!==null&&!Bd(k))&&i.refs.setReference(k)},[i.refs]),P=Ee.useMemo(()=>({...i.refs,setReference:E,setPositionReference:_,domReference:a}),[i.refs,E,_]),O=Ee.useMemo(()=>({...i.elements,domReference:d}),[i.elements,d]),D=Aue(n),V=Ee.useMemo(()=>({...i,refs:P,elements:O,dataRef:s,nodeId:r,events:u,open:e,onOpenChange:D}),[i,r,u,e,D,P,O]);return I1(()=>{const k=o==null?void 0:o.nodesRef.current.find(F=>F.id===r);k&&(k.context=V)}),Ee.useMemo(()=>({...i,context:V,refs:P,reference:E,positionReference:_}),[i,P,V,E,_])}function vN(t,e,n){const r=new Map;return{...n==="floating"&&{tabIndex:-1},...t,...e.map(i=>i?i[n]:null).concat(t).reduce((i,o)=>(o&&Object.entries(o).forEach(a=>{let[s,u]=a;if(s.indexOf("on")===0){if(r.has(s)||r.set(s,[]),typeof u=="function"){var d;(d=r.get(s))==null||d.push(u),i[s]=function(){for(var g,_=arguments.length,E=new Array(_),P=0;P<_;P++)E[P]=arguments[P];(g=r.get(s))==null||g.forEach(O=>O(...E))}}}else i[s]=u}),i),{})}}const Het=function(t){t===void 0&&(t=[]);const e=t,n=Ee.useCallback(o=>vN(o,t,"reference"),e),r=Ee.useCallback(o=>vN(o,t,"floating"),e),i=Ee.useCallback(o=>vN(o,t,"item"),t.map(o=>o==null?void 0:o.item));return Ee.useMemo(()=>({getReferenceProps:n,getFloatingProps:r,getItemProps:i}),[n,r,i])};function _ue({opened:t,floating:e,position:n,positionDependencies:r}){const[i,o]=Ee.useState(0);Ee.useEffect(()=>{if(e.refs.reference.current&&e.refs.floating.current)return Aet(e.refs.reference.current,e.refs.floating.current,e.update)},[e.refs.reference.current,e.refs.floating.current,t,i,n]),dA(()=>{e.update()},r),dA(()=>{o(a=>a+1)},[t])}function Wet(t){const e=[rue(t.offset)];return t.middlewares.shift&&e.push(a8({limiter:QJe()})),t.middlewares.flip&&e.push(eue()),t.middlewares.inline&&e.push(nue()),e.push(fue({element:t.arrowRef,padding:t.arrowOffset})),e}function qet(t){const[e,n]=JU({value:t.opened,defaultValue:t.defaultOpened,finalValue:!1,onChange:t.onChange}),r=()=>{var a;(a=t.onClose)==null||a.call(t),n(!1)},i=()=>{var a,s;e?((a=t.onClose)==null||a.call(t),n(!1)):((s=t.onOpen)==null||s.call(t),n(!0))},o=d8({placement:t.position,middleware:[...Wet(t),...t.width==="target"?[KJe({apply({rects:a}){var s,u;Object.assign((u=(s=o.refs.floating.current)==null?void 0:s.style)!=null?u:{},{width:`${a.reference.width}px`})}})]:[]]});return _ue({opened:t.opened,position:t.position,positionDependencies:t.positionDependencies,floating:o}),dA(()=>{var a;(a=t.onPositionChange)==null||a.call(t,o.placement)},[o.placement]),dA(()=>{var a,s;t.opened?(s=t.onOpen)==null||s.call(t):(a=t.onClose)==null||a.call(t)},[t.opened]),{floating:o,controlled:typeof t.opened=="boolean",opened:e,onClose:r,onToggle:i}}const yue={context:"Popover component was not found in the tree",children:"Popover.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported"},[Xet,vue]=EL(yue.context);var Zet=Object.defineProperty,Yet=Object.defineProperties,Qet=Object.getOwnPropertyDescriptors,DM=Object.getOwnPropertySymbols,xue=Object.prototype.hasOwnProperty,bue=Object.prototype.propertyIsEnumerable,NY=(t,e,n)=>e in t?Zet(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,LT=(t,e)=>{for(var n in e||(e={}))xue.call(e,n)&&NY(t,n,e[n]);if(DM)for(var n of DM(e))bue.call(e,n)&&NY(t,n,e[n]);return t},Ket=(t,e)=>Yet(t,Qet(e)),Jet=(t,e)=>{var n={};for(var r in t)xue.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&DM)for(var r of DM(t))e.indexOf(r)<0&&bue.call(t,r)&&(n[r]=t[r]);return n};const ett={refProp:"ref",popupType:"dialog",shouldOverrideDefaultTargetId:!0},wue=Ee.forwardRef((t,e)=>{const n=Gr("PopoverTarget",ett,t),{children:r,refProp:i,popupType:o,shouldOverrideDefaultTargetId:a}=n,s=Jet(n,["children","refProp","popupType","shouldOverrideDefaultTargetId"]);if(!g2(r))throw new Error(yue.children);const u=s,d=vue(),g=J1(d.reference,r.ref,e),_=d.withRoles?{"aria-haspopup":o,"aria-expanded":d.opened,"aria-controls":d.getDropdownId(),id:a?d.getTargetId():r.props.id}:{};return Ee.cloneElement(r,LT(Ket(LT(LT(LT({},u),_),d.targetProps),{className:Vae(d.targetProps.className,u.className,r.props.className),[i]:g}),d.controlled?null:{onClick:d.onToggle}))});wue.displayName="@mantine/core/PopoverTarget";var ttt=no((t,{radius:e,shadow:n})=>({dropdown:{position:"absolute",backgroundColor:t.white,background:t.colorScheme==="dark"?t.colors.dark[6]:t.white,border:`${pn(1)} solid ${t.colorScheme==="dark"?t.colors.dark[4]:t.colors.gray[2]}`,padding:`${t.spacing.sm} ${t.spacing.md}`,boxShadow:t.shadows[n]||n||"none",borderRadius:t.fn.radius(e),"&:focus":{outline:0}},arrow:{backgroundColor:"inherit",border:`${pn(1)} solid ${t.colorScheme==="dark"?t.colors.dark[4]:t.colors.gray[2]}`,zIndex:1}}));const ntt=ttt;var rtt=Object.defineProperty,FY=Object.getOwnPropertySymbols,itt=Object.prototype.hasOwnProperty,ott=Object.prototype.propertyIsEnumerable,kY=(t,e,n)=>e in t?rtt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ny=(t,e)=>{for(var n in e||(e={}))itt.call(e,n)&&kY(t,n,e[n]);if(FY)for(var n of FY(e))ott.call(e,n)&&kY(t,n,e[n]);return t};const zY={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function stt({transition:t,state:e,duration:n,timingFunction:r}){const i={transitionDuration:`${n}ms`,transitionTimingFunction:r};return typeof t=="string"?t in CT?Ny(Ny(Ny({transitionProperty:CT[t].transitionProperty},i),CT[t].common),CT[t][zY[e]]):null:Ny(Ny(Ny({transitionProperty:t.transitionProperty},i),t.common),t[zY[e]])}function att({duration:t,exitDuration:e,timingFunction:n,mounted:r,onEnter:i,onExit:o,onEntered:a,onExited:s}){const u=ip(),d=e8(),g=u.respectReducedMotion?d:!1,[_,E]=Ee.useState(g?0:t),[P,O]=Ee.useState(r?"entered":"exited"),D=Ee.useRef(-1),V=k=>{const F=k?i:o,z=k?a:s;O(k?"pre-entering":"pre-exiting"),window.clearTimeout(D.current);const X=g?0:k?t:e;if(E(X),X===0)typeof F=="function"&&F(),typeof z=="function"&&z(),O(k?"entered":"exited");else{const Y=window.setTimeout(()=>{typeof F=="function"&&F(),O(k?"entering":"exiting")},10);D.current=window.setTimeout(()=>{window.clearTimeout(Y),typeof z=="function"&&z(),O(k?"entered":"exited")},X)}};return dA(()=>{V(r)},[r]),Ee.useEffect(()=>()=>window.clearTimeout(D.current),[]),{transitionDuration:_,transitionStatus:P,transitionTimingFunction:n||u.transitionTimingFunction}}function b2({keepMounted:t,transition:e,duration:n=250,exitDuration:r=n,mounted:i,children:o,timingFunction:a,onExit:s,onEntered:u,onEnter:d,onExited:g}){const{transitionDuration:_,transitionStatus:E,transitionTimingFunction:P}=att({mounted:i,exitDuration:r,duration:n,timingFunction:a,onExit:s,onEntered:u,onEnter:d,onExited:g});return _===0?i?ut.createElement(ut.Fragment,null,o({})):t?o({display:"none"}):null:E==="exited"?t?o({display:"none"}):null:ut.createElement(ut.Fragment,null,o(stt({transition:e,duration:_,state:E,timingFunction:P})))}b2.displayName="@mantine/core/Transition";function p8({children:t,active:e=!0,refProp:n="ref"}){const r=WQe(e),i=J1(r,t==null?void 0:t.ref);return g2(t)?Ee.cloneElement(t,{[n]:i}):t}p8.displayName="@mantine/core/FocusTrap";var ltt=Object.defineProperty,utt=Object.defineProperties,ctt=Object.getOwnPropertyDescriptors,UY=Object.getOwnPropertySymbols,ftt=Object.prototype.hasOwnProperty,htt=Object.prototype.propertyIsEnumerable,GY=(t,e,n)=>e in t?ltt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Am=(t,e)=>{for(var n in e||(e={}))ftt.call(e,n)&&GY(t,n,e[n]);if(UY)for(var n of UY(e))htt.call(e,n)&&GY(t,n,e[n]);return t},DT=(t,e)=>utt(t,ctt(e));function jY(t,e,n,r){return t==="center"||r==="center"?{top:e}:t==="end"?{bottom:n}:t==="start"?{top:n}:{}}function VY(t,e,n,r,i){return t==="center"||r==="center"?{left:e}:t==="end"?{[i==="ltr"?"right":"left"]:n}:t==="start"?{[i==="ltr"?"left":"right"]:n}:{}}const dtt={bottom:"borderTopLeftRadius",left:"borderTopRightRadius",right:"borderBottomLeftRadius",top:"borderBottomRightRadius"};function ptt({position:t,arrowSize:e,arrowOffset:n,arrowRadius:r,arrowPosition:i,arrowX:o,arrowY:a,dir:s}){const[u,d="center"]=t.split("-"),g={width:pn(e),height:pn(e),transform:"rotate(45deg)",position:"absolute",[dtt[u]]:pn(r)},_=pn(-e/2);return u==="left"?DT(Am(Am({},g),jY(d,a,n,i)),{right:_,borderLeftColor:"transparent",borderBottomColor:"transparent"}):u==="right"?DT(Am(Am({},g),jY(d,a,n,i)),{left:_,borderRightColor:"transparent",borderTopColor:"transparent"}):u==="top"?DT(Am(Am({},g),VY(d,o,n,i,s)),{bottom:_,borderTopColor:"transparent",borderLeftColor:"transparent"}):u==="bottom"?DT(Am(Am({},g),VY(d,o,n,i,s)),{top:_,borderBottomColor:"transparent",borderRightColor:"transparent"}):{}}var gtt=Object.defineProperty,mtt=Object.defineProperties,Att=Object.getOwnPropertyDescriptors,BM=Object.getOwnPropertySymbols,Eue=Object.prototype.hasOwnProperty,Sue=Object.prototype.propertyIsEnumerable,$Y=(t,e,n)=>e in t?gtt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_tt=(t,e)=>{for(var n in e||(e={}))Eue.call(e,n)&&$Y(t,n,e[n]);if(BM)for(var n of BM(e))Sue.call(e,n)&&$Y(t,n,e[n]);return t},ytt=(t,e)=>mtt(t,Att(e)),vtt=(t,e)=>{var n={};for(var r in t)Eue.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&BM)for(var r of BM(t))e.indexOf(r)<0&&Sue.call(t,r)&&(n[r]=t[r]);return n};const g8=Ee.forwardRef((t,e)=>{var n=t,{position:r,arrowSize:i,arrowOffset:o,arrowRadius:a,arrowPosition:s,visible:u,arrowX:d,arrowY:g}=n,_=vtt(n,["position","arrowSize","arrowOffset","arrowRadius","arrowPosition","visible","arrowX","arrowY"]);const E=ip();return u?ut.createElement("div",ytt(_tt({},_),{ref:e,style:ptt({position:r,arrowSize:i,arrowOffset:o,arrowRadius:a,arrowPosition:s,dir:E.dir,arrowX:d,arrowY:g})})):null});g8.displayName="@mantine/core/FloatingArrow";var xtt=Object.defineProperty,btt=Object.defineProperties,wtt=Object.getOwnPropertyDescriptors,NM=Object.getOwnPropertySymbols,Tue=Object.prototype.hasOwnProperty,Cue=Object.prototype.propertyIsEnumerable,HY=(t,e,n)=>e in t?xtt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Fy=(t,e)=>{for(var n in e||(e={}))Tue.call(e,n)&&HY(t,n,e[n]);if(NM)for(var n of NM(e))Cue.call(e,n)&&HY(t,n,e[n]);return t},BT=(t,e)=>btt(t,wtt(e)),Ett=(t,e)=>{var n={};for(var r in t)Tue.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&NM)for(var r of NM(t))e.indexOf(r)<0&&Cue.call(t,r)&&(n[r]=t[r]);return n};const Stt={};function Pue(t){var e;const n=Gr("PopoverDropdown",Stt,t),{style:r,className:i,children:o,onKeyDownCapture:a}=n,s=Ett(n,["style","className","children","onKeyDownCapture"]),u=vue(),{classes:d,cx:g}=ntt({radius:u.radius,shadow:u.shadow},{name:u.__staticSelector,classNames:u.classNames,styles:u.styles,unstyled:u.unstyled,variant:u.variant}),_=hle({opened:u.opened,shouldReturnFocus:u.returnFocus}),E=u.withRoles?{"aria-labelledby":u.getTargetId(),id:u.getDropdownId(),role:"dialog"}:{};return u.disabled?null:ut.createElement(v2,BT(Fy({},u.portalProps),{withinPortal:u.withinPortal}),ut.createElement(b2,BT(Fy({mounted:u.opened},u.transitionProps),{transition:u.transitionProps.transition||"fade",duration:(e=u.transitionProps.duration)!=null?e:150,keepMounted:u.keepMounted,exitDuration:typeof u.transitionProps.exitDuration=="number"?u.transitionProps.exitDuration:u.transitionProps.duration}),P=>{var O,D;return ut.createElement(p8,{active:u.trapFocus},ut.createElement(go,Fy(BT(Fy({},E),{tabIndex:-1,ref:u.floating,style:BT(Fy(Fy({},r),P),{zIndex:u.zIndex,top:(O=u.y)!=null?O:0,left:(D=u.x)!=null?D:0,width:u.width==="target"?void 0:pn(u.width)}),className:g(d.dropdown,i),onKeyDownCapture:_Ze(u.onClose,{active:u.closeOnEscape,onTrigger:_,onKeyDown:a}),"data-position":u.placement}),s),o,ut.createElement(g8,{ref:u.arrowRef,arrowX:u.arrowX,arrowY:u.arrowY,visible:u.withArrow,position:u.placement,arrowSize:u.arrowSize,arrowRadius:u.arrowRadius,arrowOffset:u.arrowOffset,arrowPosition:u.arrowPosition,className:d.arrow})))}))}Pue.displayName="@mantine/core/PopoverDropdown";function Iue(t,e){if(t==="rtl"&&(e.includes("right")||e.includes("left"))){const[n,r]=e.split("-"),i=n==="right"?"left":"right";return r===void 0?i:`${i}-${r}`}return e}var WY=Object.getOwnPropertySymbols,Ttt=Object.prototype.hasOwnProperty,Ctt=Object.prototype.propertyIsEnumerable,Ptt=(t,e)=>{var n={};for(var r in t)Ttt.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&WY)for(var r of WY(t))e.indexOf(r)<0&&Ctt.call(t,r)&&(n[r]=t[r]);return n};const Itt={position:"bottom",offset:8,positionDependencies:[],transitionProps:{transition:"fade",duration:150},middlewares:{flip:!0,shift:!0,inline:!1},arrowSize:7,arrowOffset:5,arrowRadius:0,arrowPosition:"side",closeOnClickOutside:!0,withinPortal:!1,closeOnEscape:!0,trapFocus:!1,withRoles:!0,returnFocus:!1,clickOutsideEvents:["mousedown","touchstart"],zIndex:_2("popover"),__staticSelector:"Popover",width:"max-content"};function tx(t){var e,n,r,i,o,a;const s=Ee.useRef(null),u=Gr("Popover",Itt,t),{children:d,position:g,offset:_,onPositionChange:E,positionDependencies:P,opened:O,transitionProps:D,width:V,middlewares:k,withArrow:F,arrowSize:z,arrowOffset:X,arrowRadius:Y,arrowPosition:J,unstyled:re,classNames:ue,styles:ie,closeOnClickOutside:ce,withinPortal:se,portalProps:me,closeOnEscape:Ce,clickOutsideEvents:we,trapFocus:Ye,onClose:at,onOpen:yt,onChange:be,zIndex:De,radius:Re,shadow:qe,id:ct,defaultOpened:Ct,__staticSelector:Dt,withRoles:In,disabled:Mn,returnFocus:Tn,variant:Nt,keepMounted:Zt}=u,Wt=Ptt(u,["children","position","offset","onPositionChange","positionDependencies","opened","transitionProps","width","middlewares","withArrow","arrowSize","arrowOffset","arrowRadius","arrowPosition","unstyled","classNames","styles","closeOnClickOutside","withinPortal","portalProps","closeOnEscape","clickOutsideEvents","trapFocus","onClose","onOpen","onChange","zIndex","radius","shadow","id","defaultOpened","__staticSelector","withRoles","disabled","returnFocus","variant","keepMounted"]),[hn,lr]=Ee.useState(null),[It,Xt]=Ee.useState(null),$t=y2(ct),cn=ip(),Jt=qet({middlewares:k,width:V,position:Iue(cn.dir,g),offset:typeof _=="number"?_+(F?z/2:0):_,arrowRef:s,arrowOffset:X,onPositionChange:E,positionDependencies:P,opened:O,defaultOpened:Ct,onChange:be,onOpen:yt,onClose:at});NQe(()=>Jt.opened&&ce&&Jt.onClose(),we,[hn,It]);const Ln=Ee.useCallback(or=>{lr(or),Jt.floating.reference(or)},[Jt.floating.reference]),qn=Ee.useCallback(or=>{Xt(or),Jt.floating.floating(or)},[Jt.floating.floating]);return ut.createElement(Xet,{value:{returnFocus:Tn,disabled:Mn,controlled:Jt.controlled,reference:Ln,floating:qn,x:Jt.floating.x,y:Jt.floating.y,arrowX:(r=(n=(e=Jt.floating)==null?void 0:e.middlewareData)==null?void 0:n.arrow)==null?void 0:r.x,arrowY:(a=(o=(i=Jt.floating)==null?void 0:i.middlewareData)==null?void 0:o.arrow)==null?void 0:a.y,opened:Jt.opened,arrowRef:s,transitionProps:D,width:V,withArrow:F,arrowSize:z,arrowOffset:X,arrowRadius:Y,arrowPosition:J,placement:Jt.floating.placement,trapFocus:Ye,withinPortal:se,portalProps:me,zIndex:De,radius:Re,shadow:qe,closeOnEscape:Ce,onClose:Jt.onClose,onToggle:Jt.onToggle,getTargetId:()=>`${$t}-target`,getDropdownId:()=>`${$t}-dropdown`,withRoles:In,targetProps:Wt,__staticSelector:Dt,classNames:ue,styles:ie,unstyled:re,variant:Nt,keepMounted:Zt}},d)}tx.Target=wue;tx.Dropdown=Pue;tx.displayName="@mantine/core/Popover";var Mtt=Object.defineProperty,Ott=Object.defineProperties,Rtt=Object.getOwnPropertyDescriptors,FM=Object.getOwnPropertySymbols,Mue=Object.prototype.hasOwnProperty,Oue=Object.prototype.propertyIsEnumerable,qY=(t,e,n)=>e in t?Mtt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,NT=(t,e)=>{for(var n in e||(e={}))Mue.call(e,n)&&qY(t,n,e[n]);if(FM)for(var n of FM(e))Oue.call(e,n)&&qY(t,n,e[n]);return t},Ltt=(t,e)=>Ott(t,Rtt(e)),Dtt=(t,e)=>{var n={};for(var r in t)Mue.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&FM)for(var r of FM(t))e.indexOf(r)<0&&Oue.call(t,r)&&(n[r]=t[r]);return n};function Btt(t,e,n){const r=Gr(t,e,n),{label:i,description:o,error:a,required:s,classNames:u,styles:d,className:g,unstyled:_,__staticSelector:E,sx:P,errorProps:O,labelProps:D,descriptionProps:V,wrapperProps:k,id:F,size:z,style:X,inputContainer:Y,inputWrapperOrder:J,withAsterisk:re,variant:ue}=r,ie=Dtt(r,["label","description","error","required","classNames","styles","className","unstyled","__staticSelector","sx","errorProps","labelProps","descriptionProps","wrapperProps","id","size","style","inputContainer","inputWrapperOrder","withAsterisk","variant"]),ce=y2(F),{systemStyles:se,rest:me}=t8(ie),Ce=NT({label:i,description:o,error:a,required:s,classNames:u,className:g,__staticSelector:E,sx:P,errorProps:O,labelProps:D,descriptionProps:V,unstyled:_,styles:d,id:ce,size:z,style:X,inputContainer:Y,inputWrapperOrder:J,withAsterisk:re,variant:ue},k);return Ltt(NT({},me),{classNames:u,styles:d,unstyled:_,wrapperProps:NT(NT({},Ce),se),inputProps:{required:s,classNames:u,styles:d,unstyled:_,id:ce,size:z,__staticSelector:E,error:a,variant:ue}})}var Ntt=no((t,e,{size:n})=>({label:{display:"inline-block",fontSize:Zr({size:n,sizes:t.fontSizes}),fontWeight:500,color:t.colorScheme==="dark"?t.colors.dark[0]:t.colors.gray[9],wordBreak:"break-word",cursor:"default",WebkitTapHighlightColor:"transparent"},required:{color:t.fn.variant({variant:"filled",color:"red"}).background}}));const Ftt=Ntt;var ktt=Object.defineProperty,kM=Object.getOwnPropertySymbols,Rue=Object.prototype.hasOwnProperty,Lue=Object.prototype.propertyIsEnumerable,XY=(t,e,n)=>e in t?ktt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ztt=(t,e)=>{for(var n in e||(e={}))Rue.call(e,n)&&XY(t,n,e[n]);if(kM)for(var n of kM(e))Lue.call(e,n)&&XY(t,n,e[n]);return t},Utt=(t,e)=>{var n={};for(var r in t)Rue.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&kM)for(var r of kM(t))e.indexOf(r)<0&&Lue.call(t,r)&&(n[r]=t[r]);return n};const Gtt={labelElement:"label",size:"sm"},m8=Ee.forwardRef((t,e)=>{const n=Gr("InputLabel",Gtt,t),{labelElement:r,children:i,required:o,size:a,classNames:s,styles:u,unstyled:d,className:g,htmlFor:_,__staticSelector:E,variant:P,onMouseDown:O}=n,D=Utt(n,["labelElement","children","required","size","classNames","styles","unstyled","className","htmlFor","__staticSelector","variant","onMouseDown"]),{classes:V,cx:k}=Ftt(null,{name:["InputWrapper",E],classNames:s,styles:u,unstyled:d,variant:P,size:a});return ut.createElement(go,ztt({component:r,ref:e,className:k(V.label,g),htmlFor:r==="label"?_:void 0,onMouseDown:F=>{O==null||O(F),!F.defaultPrevented&&F.detail>1&&F.preventDefault()}},D),i,o&&ut.createElement("span",{className:V.required,"aria-hidden":!0}," *"))});m8.displayName="@mantine/core/InputLabel";var jtt=no((t,e,{size:n})=>({error:{wordBreak:"break-word",color:t.fn.variant({variant:"filled",color:"red"}).background,fontSize:`calc(${Zr({size:n,sizes:t.fontSizes})} - ${pn(2)})`,lineHeight:1.2,display:"block"}}));const Vtt=jtt;var $tt=Object.defineProperty,zM=Object.getOwnPropertySymbols,Due=Object.prototype.hasOwnProperty,Bue=Object.prototype.propertyIsEnumerable,ZY=(t,e,n)=>e in t?$tt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Htt=(t,e)=>{for(var n in e||(e={}))Due.call(e,n)&&ZY(t,n,e[n]);if(zM)for(var n of zM(e))Bue.call(e,n)&&ZY(t,n,e[n]);return t},Wtt=(t,e)=>{var n={};for(var r in t)Due.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&zM)for(var r of zM(t))e.indexOf(r)<0&&Bue.call(t,r)&&(n[r]=t[r]);return n};const qtt={size:"sm"},A8=Ee.forwardRef((t,e)=>{const n=Gr("InputError",qtt,t),{children:r,className:i,classNames:o,styles:a,unstyled:s,size:u,__staticSelector:d,variant:g}=n,_=Wtt(n,["children","className","classNames","styles","unstyled","size","__staticSelector","variant"]),{classes:E,cx:P}=Vtt(null,{name:["InputWrapper",d],classNames:o,styles:a,unstyled:s,variant:g,size:u});return ut.createElement(Nh,Htt({className:P(E.error,i),ref:e},_),r)});A8.displayName="@mantine/core/InputError";var Xtt=no((t,e,{size:n})=>({description:{wordBreak:"break-word",color:t.colorScheme==="dark"?t.colors.dark[2]:t.colors.gray[6],fontSize:`calc(${Zr({size:n,sizes:t.fontSizes})} - ${pn(2)})`,lineHeight:1.2,display:"block"}}));const Ztt=Xtt;var Ytt=Object.defineProperty,UM=Object.getOwnPropertySymbols,Nue=Object.prototype.hasOwnProperty,Fue=Object.prototype.propertyIsEnumerable,YY=(t,e,n)=>e in t?Ytt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Qtt=(t,e)=>{for(var n in e||(e={}))Nue.call(e,n)&&YY(t,n,e[n]);if(UM)for(var n of UM(e))Fue.call(e,n)&&YY(t,n,e[n]);return t},Ktt=(t,e)=>{var n={};for(var r in t)Nue.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&UM)for(var r of UM(t))e.indexOf(r)<0&&Fue.call(t,r)&&(n[r]=t[r]);return n};const Jtt={size:"sm"},_8=Ee.forwardRef((t,e)=>{const n=Gr("InputDescription",Jtt,t),{children:r,className:i,classNames:o,styles:a,unstyled:s,size:u,__staticSelector:d,variant:g}=n,_=Ktt(n,["children","className","classNames","styles","unstyled","size","__staticSelector","variant"]),{classes:E,cx:P}=Ztt(null,{name:["InputWrapper",d],classNames:o,styles:a,unstyled:s,variant:g,size:u});return ut.createElement(Nh,Qtt({color:"dimmed",className:P(E.description,i),ref:e,unstyled:s},_),r)});_8.displayName="@mantine/core/InputDescription";const kue=Ee.createContext({offsetBottom:!1,offsetTop:!1,describedBy:void 0}),ent=kue.Provider,tnt=()=>Ee.useContext(kue);function nnt(t,{hasDescription:e,hasError:n}){const r=t.findIndex(u=>u==="input"),i=t[r-1],o=t[r+1];return{offsetBottom:e&&o==="description"||n&&o==="error",offsetTop:e&&i==="description"||n&&i==="error"}}var rnt=Object.defineProperty,int=Object.defineProperties,ont=Object.getOwnPropertyDescriptors,QY=Object.getOwnPropertySymbols,snt=Object.prototype.hasOwnProperty,ant=Object.prototype.propertyIsEnumerable,KY=(t,e,n)=>e in t?rnt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lnt=(t,e)=>{for(var n in e||(e={}))snt.call(e,n)&&KY(t,n,e[n]);if(QY)for(var n of QY(e))ant.call(e,n)&&KY(t,n,e[n]);return t},unt=(t,e)=>int(t,ont(e)),cnt=no(t=>({root:unt(lnt({},t.fn.fontStyles()),{lineHeight:t.lineHeight})}));const fnt=cnt;var hnt=Object.defineProperty,dnt=Object.defineProperties,pnt=Object.getOwnPropertyDescriptors,GM=Object.getOwnPropertySymbols,zue=Object.prototype.hasOwnProperty,Uue=Object.prototype.propertyIsEnumerable,JY=(t,e,n)=>e in t?hnt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_m=(t,e)=>{for(var n in e||(e={}))zue.call(e,n)&&JY(t,n,e[n]);if(GM)for(var n of GM(e))Uue.call(e,n)&&JY(t,n,e[n]);return t},eQ=(t,e)=>dnt(t,pnt(e)),gnt=(t,e)=>{var n={};for(var r in t)zue.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&GM)for(var r of GM(t))e.indexOf(r)<0&&Uue.call(t,r)&&(n[r]=t[r]);return n};const mnt={labelElement:"label",size:"sm",inputContainer:t=>t,inputWrapperOrder:["label","description","input","error"]},Gue=Ee.forwardRef((t,e)=>{const n=Gr("InputWrapper",mnt,t),{className:r,label:i,children:o,required:a,id:s,error:u,description:d,labelElement:g,labelProps:_,descriptionProps:E,errorProps:P,classNames:O,styles:D,size:V,inputContainer:k,__staticSelector:F,unstyled:z,inputWrapperOrder:X,withAsterisk:Y,variant:J}=n,re=gnt(n,["className","label","children","required","id","error","description","labelElement","labelProps","descriptionProps","errorProps","classNames","styles","size","inputContainer","__staticSelector","unstyled","inputWrapperOrder","withAsterisk","variant"]),{classes:ue,cx:ie}=fnt(null,{classNames:O,styles:D,name:["InputWrapper",F],unstyled:z,variant:J,size:V}),ce={classNames:O,styles:D,unstyled:z,size:V,variant:J,__staticSelector:F},se=typeof Y=="boolean"?Y:a,me=s?`${s}-error`:P==null?void 0:P.id,Ce=s?`${s}-description`:E==null?void 0:E.id,Ye=`${!!u&&typeof u!="boolean"?me:""} ${d?Ce:""}`,at=Ye.trim().length>0?Ye.trim():void 0,yt=i&&ut.createElement(m8,_m(_m({key:"label",labelElement:g,id:s?`${s}-label`:void 0,htmlFor:s,required:se},ce),_),i),be=d&&ut.createElement(_8,eQ(_m(_m({key:"description"},E),ce),{size:(E==null?void 0:E.size)||ce.size,id:(E==null?void 0:E.id)||Ce}),d),De=ut.createElement(Ee.Fragment,{key:"input"},k(o)),Re=typeof u!="boolean"&&u&&ut.createElement(A8,eQ(_m(_m({},P),ce),{size:(P==null?void 0:P.size)||ce.size,key:"error",id:(P==null?void 0:P.id)||me}),u),qe=X.map(ct=>{switch(ct){case"label":return yt;case"input":return De;case"description":return be;case"error":return Re;default:return null}});return ut.createElement(ent,{value:_m({describedBy:at},nnt(X,{hasDescription:!!be,hasError:!!Re}))},ut.createElement(go,_m({className:ie(ue.root,r),ref:e},re),qe))});Gue.displayName="@mantine/core/InputWrapper";var Ant=Object.defineProperty,jM=Object.getOwnPropertySymbols,jue=Object.prototype.hasOwnProperty,Vue=Object.prototype.propertyIsEnumerable,tQ=(t,e,n)=>e in t?Ant(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_nt=(t,e)=>{for(var n in e||(e={}))jue.call(e,n)&&tQ(t,n,e[n]);if(jM)for(var n of jM(e))Vue.call(e,n)&&tQ(t,n,e[n]);return t},ynt=(t,e)=>{var n={};for(var r in t)jue.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&jM)for(var r of jM(t))e.indexOf(r)<0&&Vue.call(t,r)&&(n[r]=t[r]);return n};const vnt={},$ue=Ee.forwardRef((t,e)=>{const n=Gr("InputPlaceholder",vnt,t),{sx:r}=n,i=ynt(n,["sx"]);return ut.createElement(go,_nt({component:"span",sx:[o=>o.fn.placeholderStyles(),...mZe(r)],ref:e},i))});$ue.displayName="@mantine/core/InputPlaceholder";var xnt=Object.defineProperty,bnt=Object.defineProperties,wnt=Object.getOwnPropertyDescriptors,nQ=Object.getOwnPropertySymbols,Ent=Object.prototype.hasOwnProperty,Snt=Object.prototype.propertyIsEnumerable,rQ=(t,e,n)=>e in t?xnt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,FT=(t,e)=>{for(var n in e||(e={}))Ent.call(e,n)&&rQ(t,n,e[n]);if(nQ)for(var n of nQ(e))Snt.call(e,n)&&rQ(t,n,e[n]);return t},xN=(t,e)=>bnt(t,wnt(e));const yd={xs:pn(30),sm:pn(36),md:pn(42),lg:pn(50),xl:pn(60)},Tnt=["default","filled","unstyled"];function Cnt({theme:t,variant:e}){return Tnt.includes(e)?e==="default"?{border:`${pn(1)} solid ${t.colorScheme==="dark"?t.colors.dark[4]:t.colors.gray[4]}`,backgroundColor:t.colorScheme==="dark"?t.colors.dark[6]:t.white,transition:"border-color 100ms ease","&:focus, &:focus-within":t.focusRingStyles.inputStyles(t)}:e==="filled"?{border:`${pn(1)} solid transparent`,backgroundColor:t.colorScheme==="dark"?t.colors.dark[5]:t.colors.gray[1],"&:focus, &:focus-within":t.focusRingStyles.inputStyles(t)}:{borderWidth:0,color:t.colorScheme==="dark"?t.colors.dark[0]:t.black,backgroundColor:"transparent",minHeight:pn(28),outline:0,"&:focus, &:focus-within":{outline:"none",borderColor:"transparent"},"&:disabled":{backgroundColor:"transparent","&:focus, &:focus-within":{outline:"none",borderColor:"transparent"}}}:null}var Pnt=no((t,{multiline:e,radius:n,invalid:r,rightSectionWidth:i,withRightSection:o,iconWidth:a,offsetBottom:s,offsetTop:u,pointer:d},{variant:g,size:_})=>{const E=t.fn.variant({variant:"filled",color:"red"}).background,P=g==="default"||g==="filled"?{minHeight:Zr({size:_,sizes:yd}),paddingLeft:`calc(${Zr({size:_,sizes:yd})}  / 3)`,paddingRight:o?i||Zr({size:_,sizes:yd}):`calc(${Zr({size:_,sizes:yd})}  / 3)`,borderRadius:t.fn.radius(n)}:g==="unstyled"&&o?{paddingRight:i||Zr({size:_,sizes:yd})}:null;return{wrapper:{position:"relative",marginTop:u?`calc(${t.spacing.xs} / 2)`:void 0,marginBottom:s?`calc(${t.spacing.xs} / 2)`:void 0,"&:has(input:disabled)":{"& .mantine-Input-rightSection":{display:"none"}}},input:xN(FT(FT(xN(FT({},t.fn.fontStyles()),{height:e?g==="unstyled"?void 0:"auto":Zr({size:_,sizes:yd}),WebkitTapHighlightColor:"transparent",lineHeight:e?t.lineHeight:`calc(${Zr({size:_,sizes:yd})} - ${pn(2)})`,appearance:"none",resize:"none",boxSizing:"border-box",fontSize:Zr({size:_,sizes:t.fontSizes}),width:"100%",color:t.colorScheme==="dark"?t.colors.dark[0]:t.black,display:"block",textAlign:"left",cursor:d?"pointer":void 0}),Cnt({theme:t,variant:g})),P),{"&:disabled, &[data-disabled]":{backgroundColor:t.colorScheme==="dark"?t.colors.dark[6]:t.colors.gray[1],color:t.colors.dark[2],opacity:.6,cursor:"not-allowed",pointerEvents:"none","&::placeholder":{color:t.colors.dark[2]}},"&[data-invalid]":{color:E,borderColor:E,"&::placeholder":{opacity:1,color:E}},"&[data-with-icon]":{paddingLeft:typeof a=="number"?pn(a):Zr({size:_,sizes:yd})},"&::placeholder":xN(FT({},t.fn.placeholderStyles()),{opacity:1}),"&::-webkit-inner-spin-button, &::-webkit-outer-spin-button, &::-webkit-search-decoration, &::-webkit-search-cancel-button, &::-webkit-search-results-button, &::-webkit-search-results-decoration":{appearance:"none"},"&[type=number]":{MozAppearance:"textfield"}}),icon:{pointerEvents:"none",position:"absolute",zIndex:1,left:0,top:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",width:a?pn(a):Zr({size:_,sizes:yd}),color:r?t.colors.red[t.colorScheme==="dark"?6:7]:t.colorScheme==="dark"?t.colors.dark[2]:t.colors.gray[5]},rightSection:{position:"absolute",top:0,bottom:0,right:0,display:"flex",alignItems:"center",justifyContent:"center",width:i||Zr({size:_,sizes:yd})}}});const Int=Pnt;var Mnt=Object.defineProperty,Ont=Object.defineProperties,Rnt=Object.getOwnPropertyDescriptors,VM=Object.getOwnPropertySymbols,Hue=Object.prototype.hasOwnProperty,Wue=Object.prototype.propertyIsEnumerable,iQ=(t,e,n)=>e in t?Mnt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,kT=(t,e)=>{for(var n in e||(e={}))Hue.call(e,n)&&iQ(t,n,e[n]);if(VM)for(var n of VM(e))Wue.call(e,n)&&iQ(t,n,e[n]);return t},oQ=(t,e)=>Ont(t,Rnt(e)),Lnt=(t,e)=>{var n={};for(var r in t)Hue.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&VM)for(var r of VM(t))e.indexOf(r)<0&&Wue.call(t,r)&&(n[r]=t[r]);return n};const Dnt={size:"sm",variant:"default"},P_=Ee.forwardRef((t,e)=>{const n=Gr("Input",Dnt,t),{className:r,error:i,required:o,disabled:a,variant:s,icon:u,style:d,rightSectionWidth:g,iconWidth:_,rightSection:E,rightSectionProps:P,radius:O,size:D,wrapperProps:V,classNames:k,styles:F,__staticSelector:z,multiline:X,sx:Y,unstyled:J,pointer:re}=n,ue=Lnt(n,["className","error","required","disabled","variant","icon","style","rightSectionWidth","iconWidth","rightSection","rightSectionProps","radius","size","wrapperProps","classNames","styles","__staticSelector","multiline","sx","unstyled","pointer"]),{offsetBottom:ie,offsetTop:ce,describedBy:se}=tnt(),{classes:me,cx:Ce}=Int({radius:O,multiline:X,invalid:!!i,rightSectionWidth:g?pn(g):void 0,iconWidth:_,withRightSection:!!E,offsetBottom:ie,offsetTop:ce,pointer:re},{classNames:k,styles:F,name:["Input",z],unstyled:J,variant:s,size:D}),{systemStyles:we,rest:Ye}=t8(ue);return ut.createElement(go,kT(kT({className:Ce(me.wrapper,r),sx:Y,style:d},we),V),u&&ut.createElement("div",{className:me.icon},u),ut.createElement(go,oQ(kT({component:"input"},Ye),{ref:e,required:o,"aria-invalid":!!i,"aria-describedby":se,disabled:a,"data-disabled":a||void 0,"data-with-icon":!!u||void 0,"data-invalid":!!i||void 0,className:me.input})),E&&ut.createElement("div",oQ(kT({},P),{className:me.rightSection}),E))});P_.displayName="@mantine/core/Input";P_.Wrapper=Gue;P_.Label=m8;P_.Description=_8;P_.Error=A8;P_.Placeholder=$ue;const bN=P_;var Bnt=no((t,{radius:e,shadow:n})=>({root:{outline:0,WebkitTapHighlightColor:"transparent",display:"block",textDecoration:"none",color:t.colorScheme==="dark"?t.colors.dark[0]:t.black,backgroundColor:t.colorScheme==="dark"?t.colors.dark[7]:t.white,boxSizing:"border-box",borderRadius:t.fn.radius(e),boxShadow:t.shadows[n]||n||"none","&[data-with-border]":{border:`${pn(1)} solid ${t.colorScheme==="dark"?t.colors.dark[4]:t.colors.gray[3]}`}}}));const Nnt=Bnt;var Fnt=Object.defineProperty,$M=Object.getOwnPropertySymbols,que=Object.prototype.hasOwnProperty,Xue=Object.prototype.propertyIsEnumerable,sQ=(t,e,n)=>e in t?Fnt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,knt=(t,e)=>{for(var n in e||(e={}))que.call(e,n)&&sQ(t,n,e[n]);if($M)for(var n of $M(e))Xue.call(e,n)&&sQ(t,n,e[n]);return t},znt=(t,e)=>{var n={};for(var r in t)que.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&$M)for(var r of $M(t))e.indexOf(r)<0&&Xue.call(t,r)&&(n[r]=t[r]);return n};const Unt={},Zue=Ee.forwardRef((t,e)=>{const n=Gr("Paper",Unt,t),{className:r,children:i,radius:o,withBorder:a,shadow:s,unstyled:u,variant:d}=n,g=znt(n,["className","children","radius","withBorder","shadow","unstyled","variant"]),{classes:_,cx:E}=Nnt({radius:o,shadow:s},{name:"Paper",unstyled:u,variant:d});return ut.createElement(go,knt({className:E(_.root,r),"data-with-border":a||void 0,ref:e},g),i)});Zue.displayName="@mantine/core/Paper";const Gnt=Zue;var jnt=no((t,{inline:e})=>({root:{display:e?"inline-flex":"flex",alignItems:"center",justifyContent:"center"}}));const Vnt=jnt;var $nt=Object.defineProperty,HM=Object.getOwnPropertySymbols,Yue=Object.prototype.hasOwnProperty,Que=Object.prototype.propertyIsEnumerable,aQ=(t,e,n)=>e in t?$nt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Hnt=(t,e)=>{for(var n in e||(e={}))Yue.call(e,n)&&aQ(t,n,e[n]);if(HM)for(var n of HM(e))Que.call(e,n)&&aQ(t,n,e[n]);return t},Wnt=(t,e)=>{var n={};for(var r in t)Yue.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&HM)for(var r of HM(t))e.indexOf(r)<0&&Que.call(t,r)&&(n[r]=t[r]);return n};const Kue=Ee.forwardRef((t,e)=>{const n=Gr("Center",{},t),{inline:r,className:i,unstyled:o,variant:a}=n,s=Wnt(n,["inline","className","unstyled","variant"]),{classes:u,cx:d}=Vnt({inline:r},{name:"Center",unstyled:o,variant:a});return ut.createElement(go,Hnt({ref:e,className:d(u.root,i)},s))});Kue.displayName="@mantine/core/Center";const y8=Kue,[qnt,nx]=EL("ModalBase component was not found in tree");var Xnt=no(()=>({close:{marginLeft:"auto",marginRight:0}}));const Znt=Xnt;var Ynt=Object.defineProperty,WM=Object.getOwnPropertySymbols,Jue=Object.prototype.hasOwnProperty,ece=Object.prototype.propertyIsEnumerable,lQ=(t,e,n)=>e in t?Ynt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Qnt=(t,e)=>{for(var n in e||(e={}))Jue.call(e,n)&&lQ(t,n,e[n]);if(WM)for(var n of WM(e))ece.call(e,n)&&lQ(t,n,e[n]);return t},Knt=(t,e)=>{var n={};for(var r in t)Jue.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&WM)for(var r of WM(t))e.indexOf(r)<0&&ece.call(t,r)&&(n[r]=t[r]);return n};const Jnt={size:"sm"},ert=Ee.forwardRef((t,e)=>{const n=nx(),r=Gr(`${n.__staticSelector}CloseButton`,Jnt,t),{className:i}=r,o=Knt(r,["className"]),{classes:a,cx:s}=Znt(null,n.stylesApi);return ut.createElement(qle,Qnt({className:s(a.close,i),ref:e,onClick:n.onClose},o))});var trt=no(()=>({overlay:{}}));const nrt=trt;var rrt=Object.defineProperty,irt=Object.defineProperties,ort=Object.getOwnPropertyDescriptors,uQ=Object.getOwnPropertySymbols,srt=Object.prototype.hasOwnProperty,art=Object.prototype.propertyIsEnumerable,cQ=(t,e,n)=>e in t?rrt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lrt=(t,e)=>{for(var n in e||(e={}))srt.call(e,n)&&cQ(t,n,e[n]);if(uQ)for(var n of uQ(e))art.call(e,n)&&cQ(t,n,e[n]);return t},urt=(t,e)=>irt(t,ort(e)),crt=no((t,{color:e,opacity:n,blur:r,radius:i,gradient:o,fixed:a,zIndex:s})=>({root:urt(lrt({},t.fn.cover(0)),{position:a?"fixed":"absolute",backgroundColor:o?void 0:t.fn.rgba(e,n),backgroundImage:o,backdropFilter:r?`blur(${pn(r)})`:void 0,borderRadius:t.fn.radius(i),zIndex:s,"&[data-center]":{display:"flex",alignItems:"center",justifyContent:"center"}})}));const frt=crt;var hrt=Object.defineProperty,qM=Object.getOwnPropertySymbols,tce=Object.prototype.hasOwnProperty,nce=Object.prototype.propertyIsEnumerable,fQ=(t,e,n)=>e in t?hrt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,drt=(t,e)=>{for(var n in e||(e={}))tce.call(e,n)&&fQ(t,n,e[n]);if(qM)for(var n of qM(e))nce.call(e,n)&&fQ(t,n,e[n]);return t},prt=(t,e)=>{var n={};for(var r in t)tce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&qM)for(var r of qM(t))e.indexOf(r)<0&&nce.call(t,r)&&(n[r]=t[r]);return n};const grt={opacity:.6,color:"#000",zIndex:_2("modal"),radius:0},rce=Ee.forwardRef((t,e)=>{const n=Gr("Overlay",grt,t),{variant:r,opacity:i,color:o,blur:a,gradient:s,zIndex:u,radius:d,children:g,className:_,classNames:E,styles:P,unstyled:O,center:D,fixed:V}=n,k=prt(n,["variant","opacity","color","blur","gradient","zIndex","radius","children","className","classNames","styles","unstyled","center","fixed"]),{classes:F,cx:z}=frt({color:o,opacity:i,blur:a,radius:d,gradient:s,fixed:V,zIndex:u},{name:"Overlay",classNames:E,styles:P,unstyled:O,variant:r});return ut.createElement(go,drt({ref:e,className:z(F.root,_),"data-center":D||void 0},k),g)});rce.displayName="@mantine/core/Overlay";const mrt=rce;var Art=Object.defineProperty,_rt=Object.defineProperties,yrt=Object.getOwnPropertyDescriptors,XM=Object.getOwnPropertySymbols,ice=Object.prototype.hasOwnProperty,oce=Object.prototype.propertyIsEnumerable,hQ=(t,e,n)=>e in t?Art(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Ub=(t,e)=>{for(var n in e||(e={}))ice.call(e,n)&&hQ(t,n,e[n]);if(XM)for(var n of XM(e))oce.call(e,n)&&hQ(t,n,e[n]);return t},vrt=(t,e)=>_rt(t,yrt(e)),xrt=(t,e)=>{var n={};for(var r in t)ice.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&XM)for(var r of XM(t))e.indexOf(r)<0&&oce.call(t,r)&&(n[r]=t[r]);return n};const brt={},wrt=Ee.forwardRef((t,e)=>{const n=nx(),r=Gr(`${n.__staticSelector}Overlay`,brt,t),{onClick:i,transitionProps:o,style:a,className:s}=r,u=xrt(r,["onClick","transitionProps","style","className"]),{classes:d,cx:g}=nrt(null,n.stylesApi),_=E=>{i==null||i(E),n.closeOnClickOutside&&n.onClose()};return ut.createElement(b2,vrt(Ub(Ub({mounted:n.opened},n.transitionProps),o),{transition:"fade"}),E=>ut.createElement(mrt,Ub({ref:e,onClick:_,fixed:!0,style:Ub(Ub({},a),E),className:g(d.overlay,s),zIndex:n.zIndex},u)))});var Ert=no((t,{zIndex:e})=>({inner:{position:"fixed",width:"100%",top:0,bottom:0,maxHeight:"100%",zIndex:e,pointerEvents:"none"},content:{pointerEvents:"all"}}));const Srt=Ert;var Trt=Object.defineProperty,ZM=Object.getOwnPropertySymbols,sce=Object.prototype.hasOwnProperty,ace=Object.prototype.propertyIsEnumerable,dQ=(t,e,n)=>e in t?Trt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Gb=(t,e)=>{for(var n in e||(e={}))sce.call(e,n)&&dQ(t,n,e[n]);if(ZM)for(var n of ZM(e))ace.call(e,n)&&dQ(t,n,e[n]);return t},Crt=(t,e)=>{var n={};for(var r in t)sce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&ZM)for(var r of ZM(t))e.indexOf(r)<0&&ace.call(t,r)&&(n[r]=t[r]);return n};const Prt={},Irt=Ee.forwardRef((t,e)=>{const n=nx(),r=Gr(`${n.__staticSelector}Content`,Prt,t),{className:i,transitionProps:o,style:a,onKeyDown:s}=r,u=Crt(r,["className","transitionProps","style","onKeyDown"]),{classes:d,cx:g}=Srt({zIndex:n.zIndex},n.stylesApi),_=E=>{var P;((P=E.target)==null?void 0:P.getAttribute("data-mantine-stop-propagation"))!=="true"&&E.key==="Escape"&&n.closeOnEscape&&n.onClose(),s==null||s(E)};return ut.createElement(b2,Gb(Gb({mounted:n.opened,transition:"pop"},n.transitionProps),o),E=>ut.createElement("div",{className:g(d.inner)},ut.createElement(p8,{active:n.opened&&n.trapFocus},ut.createElement(Gnt,Gb({component:"section",role:"dialog",tabIndex:-1,"aria-modal":!0,"aria-describedby":n.bodyMounted?n.getBodyId():void 0,"aria-labelledby":n.titleMounted?n.getTitleId():void 0,onKeyDown:_,ref:e,className:g(d.content,i),style:Gb(Gb({},a),E),shadow:n.shadow},u),u.children))))});var Mrt=no((t,{padding:e})=>{const n=Zr({size:e,sizes:t.spacing});return{header:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:n,paddingRight:`calc(${n} - ${pn(5)})`,position:"sticky",top:0,backgroundColor:t.colorScheme==="dark"?t.colors.dark[7]:t.white,zIndex:1e3}}});const Ort=Mrt;var Rrt=Object.defineProperty,YM=Object.getOwnPropertySymbols,lce=Object.prototype.hasOwnProperty,uce=Object.prototype.propertyIsEnumerable,pQ=(t,e,n)=>e in t?Rrt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Lrt=(t,e)=>{for(var n in e||(e={}))lce.call(e,n)&&pQ(t,n,e[n]);if(YM)for(var n of YM(e))uce.call(e,n)&&pQ(t,n,e[n]);return t},Drt=(t,e)=>{var n={};for(var r in t)lce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&YM)for(var r of YM(t))e.indexOf(r)<0&&uce.call(t,r)&&(n[r]=t[r]);return n};const Brt={},Nrt=Ee.forwardRef((t,e)=>{const n=nx(),r=Gr(`${n.__staticSelector}Header`,Brt,t),{className:i}=r,o=Drt(r,["className"]),{classes:a,cx:s}=Ort({padding:n.padding},n.stylesApi);return ut.createElement(go,Lrt({ref:e,className:s(a.header,i)},o))});var Frt=no(t=>({title:{lineHeight:1,padding:0,margin:0,fontWeight:400,fontSize:t.fontSizes.md}}));const krt=Frt;var zrt=Object.defineProperty,QM=Object.getOwnPropertySymbols,cce=Object.prototype.hasOwnProperty,fce=Object.prototype.propertyIsEnumerable,gQ=(t,e,n)=>e in t?zrt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Urt=(t,e)=>{for(var n in e||(e={}))cce.call(e,n)&&gQ(t,n,e[n]);if(QM)for(var n of QM(e))fce.call(e,n)&&gQ(t,n,e[n]);return t},Grt=(t,e)=>{var n={};for(var r in t)cce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&QM)for(var r of QM(t))e.indexOf(r)<0&&fce.call(t,r)&&(n[r]=t[r]);return n};const jrt={},Vrt=Ee.forwardRef((t,e)=>{const n=nx(),r=Gr(`${n.__staticSelector}Title`,jrt,t),{className:i}=r,o=Grt(r,["className"]),{classes:a,cx:s}=krt(null,n.stylesApi);return Ee.useEffect(()=>(n.setTitleMounted(!0),()=>n.setTitleMounted(!1)),[]),ut.createElement(go,Urt({component:"h2",id:n.getTitleId(),className:s(a.title,i),ref:e},o))});var $rt=no((t,{padding:e})=>({body:{padding:Zr({size:e,sizes:t.spacing}),"&:not(:only-child)":{paddingTop:0}}}));const Hrt=$rt;var Wrt=Object.defineProperty,KM=Object.getOwnPropertySymbols,hce=Object.prototype.hasOwnProperty,dce=Object.prototype.propertyIsEnumerable,mQ=(t,e,n)=>e in t?Wrt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qrt=(t,e)=>{for(var n in e||(e={}))hce.call(e,n)&&mQ(t,n,e[n]);if(KM)for(var n of KM(e))dce.call(e,n)&&mQ(t,n,e[n]);return t},Xrt=(t,e)=>{var n={};for(var r in t)hce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&KM)for(var r of KM(t))e.indexOf(r)<0&&dce.call(t,r)&&(n[r]=t[r]);return n};const Zrt={},Yrt=Ee.forwardRef((t,e)=>{const n=nx(),r=Gr(`${n.__staticSelector}Body`,Zrt,t),{className:i}=r,o=Xrt(r,["className"]),{classes:a,cx:s}=Hrt({padding:n.padding},n.stylesApi);return Ee.useEffect(()=>(n.setBodyMounted(!0),()=>n.setBodyMounted(!1)),[]),ut.createElement(go,qrt({id:n.getBodyId(),className:s(a.body,i),ref:e},o))});function Qrt({children:t}){return ut.createElement(ut.Fragment,null,t)}function Krt({opened:t,transitionDuration:e}){const[n,r]=Ee.useState(t),i=Ee.useRef(),a=e8()?0:e;return Ee.useEffect(()=>(t?(r(!0),window.clearTimeout(i.current)):a===0?r(!1):i.current=window.setTimeout(()=>r(!1),a),()=>window.clearTimeout(i.current)),[t,a]),n}var Jrt=no(()=>({root:{}}));const eit=Jrt;var tit=Object.defineProperty,nit=Object.defineProperties,rit=Object.getOwnPropertyDescriptors,JM=Object.getOwnPropertySymbols,pce=Object.prototype.hasOwnProperty,gce=Object.prototype.propertyIsEnumerable,AQ=(t,e,n)=>e in t?tit(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,wN=(t,e)=>{for(var n in e||(e={}))pce.call(e,n)&&AQ(t,n,e[n]);if(JM)for(var n of JM(e))gce.call(e,n)&&AQ(t,n,e[n]);return t},_Q=(t,e)=>nit(t,rit(e)),iit=(t,e)=>{var n={};for(var r in t)pce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&JM)for(var r of JM(t))e.indexOf(r)<0&&gce.call(t,r)&&(n[r]=t[r]);return n};const v8={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:_2("modal"),padding:"md",size:"md",shadow:"xl"};function Ts(t){const e=Gr("ModalBase",v8,t),{opened:n,onClose:r,children:i,closeOnClickOutside:o,__staticSelector:a,transitionProps:s,withinPortal:u,portalProps:d,keepMounted:g,target:_,zIndex:E,lockScroll:P,trapFocus:O,closeOnEscape:D,returnFocus:V,padding:k,shadow:F,id:z,size:X,variant:Y,classNames:J,unstyled:re,styles:ue,className:ie}=e,ce=iit(e,["opened","onClose","children","closeOnClickOutside","__staticSelector","transitionProps","withinPortal","portalProps","keepMounted","target","zIndex","lockScroll","trapFocus","closeOnEscape","returnFocus","padding","shadow","id","size","variant","classNames","unstyled","styles","className"]),{classes:se,cx:me}=eit(null,{name:a,classNames:J,styles:ue,unstyled:re,variant:Y,size:X}),Ce=y2(z),[we,Ye]=Ee.useState(!1),[at,yt]=Ee.useState(!1),be=typeof(s==null?void 0:s.duration)=="number"?s==null?void 0:s.duration:200,De=Krt({opened:n,transitionDuration:be});return ZQe("keydown",Re=>{!O&&Re.key==="Escape"&&D&&r()}),hle({opened:n,shouldReturnFocus:O&&V}),ut.createElement(v2,_Q(wN({},d),{withinPortal:u,target:_}),ut.createElement(qnt,{value:{__staticSelector:a,opened:n,onClose:r,closeOnClickOutside:o,transitionProps:_Q(wN({},s),{duration:be,keepMounted:g}),zIndex:E,padding:k,id:Ce,getTitleId:()=>`${Ce}-title`,getBodyId:()=>`${Ce}-body`,titleMounted:we,bodyMounted:at,setTitleMounted:Ye,setBodyMounted:yt,trapFocus:O,closeOnEscape:D,shadow:F,stylesApi:{name:a,size:X,variant:Y,classNames:J,styles:ue,unstyled:re}}},ut.createElement(gZe,{enabled:De&&P},ut.createElement(go,wN({className:me(se.root,ie)},ce),i))))}Ts.CloseButton=ert;Ts.Overlay=wrt;Ts.Content=Irt;Ts.Header=Nrt;Ts.Title=Vrt;Ts.Body=Yrt;Ts.NativeScrollArea=Qrt;var oit=Object.defineProperty,eO=Object.getOwnPropertySymbols,mce=Object.prototype.hasOwnProperty,Ace=Object.prototype.propertyIsEnumerable,yQ=(t,e,n)=>e in t?oit(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,vQ=(t,e)=>{for(var n in e||(e={}))mce.call(e,n)&&yQ(t,n,e[n]);if(eO)for(var n of eO(e))Ace.call(e,n)&&yQ(t,n,e[n]);return t},sit=(t,e)=>{var n={};for(var r in t)mce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&eO)for(var r of eO(t))e.indexOf(r)<0&&Ace.call(t,r)&&(n[r]=t[r]);return n};const ait={multiple:!1},_ce=Ee.forwardRef((t,e)=>{const n=Gr("FileButton",ait,t),{onChange:r,children:i,multiple:o,accept:a,name:s,form:u,resetRef:d,disabled:g,capture:_,inputProps:E}=n,P=sit(n,["onChange","children","multiple","accept","name","form","resetRef","disabled","capture","inputProps"]),O=Ee.useRef(),D=()=>{!g&&O.current.click()},V=F=>{r(o?Array.from(F.currentTarget.files):F.currentTarget.files[0]||null)};return Ale(d,()=>{O.current.value=""}),ut.createElement(ut.Fragment,null,i(vQ({onClick:D},P)),ut.createElement("input",vQ({style:{display:"none"},type:"file",accept:a,multiple:o,onChange:V,ref:J1(e,O),name:s,form:u,capture:_},E)))});_ce.displayName="@mantine/core/FileButton";var lit=no(()=>({placeholder:{},input:{cursor:"pointer"}}));const uit=lit;var cit=Object.defineProperty,fit=Object.defineProperties,hit=Object.getOwnPropertyDescriptors,tO=Object.getOwnPropertySymbols,yce=Object.prototype.hasOwnProperty,vce=Object.prototype.propertyIsEnumerable,xQ=(t,e,n)=>e in t?cit(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ky=(t,e)=>{for(var n in e||(e={}))yce.call(e,n)&&xQ(t,n,e[n]);if(tO)for(var n of tO(e))vce.call(e,n)&&xQ(t,n,e[n]);return t},zT=(t,e)=>fit(t,hit(e)),dit=(t,e)=>{var n={};for(var r in t)yce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&tO)for(var r of tO(t))e.indexOf(r)<0&&vce.call(t,r)&&(n[r]=t[r]);return n};const pit=({value:t})=>ut.createElement(Nh,{sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},Array.isArray(t)?t.map(e=>e.name).join(", "):t==null?void 0:t.name),git={size:"sm",valueComponent:pit},xce=Ee.forwardRef((t,e)=>{const n=Btt("FileInput",git,t),{inputProps:r,wrapperProps:i,placeholder:o,value:a,defaultValue:s,onChange:u,multiple:d,accept:g,name:_,form:E,classNames:P,styles:O,unstyled:D,valueComponent:V,rightSection:k,clearable:F,clearButtonProps:z,readOnly:X,capture:Y,fileInputProps:J}=n,re=dit(n,["inputProps","wrapperProps","placeholder","value","defaultValue","onChange","multiple","accept","name","form","classNames","styles","unstyled","valueComponent","rightSection","clearable","clearButtonProps","readOnly","capture","fileInputProps"]),ue=Ee.useRef(),{classes:ie,cx:ce}=uit(null,{name:"FileInput",classNames:P,styles:O,unstyled:D}),[se,me]=JU({value:a,defaultValue:s,onChange:u,finalValue:d?[]:null}),Ce=Array.isArray(se)?se.length!==0:se!==null,we=k||(F&&Ce&&!X?ut.createElement(qle,zT(ky({},z),{variant:"transparent",onClick:()=>me(d?[]:null),size:r.size,unstyled:D})):null);return Ee.useEffect(()=>{(Array.isArray(se)&&se.length===0||se===null)&&ue.current()},[se]),ut.createElement(bN.Wrapper,zT(ky({},i),{__staticSelector:"FileInput"}),ut.createElement(_ce,{onChange:me,multiple:d,accept:g,name:_,form:E,resetRef:ue,disabled:X,capture:Y,inputProps:J},Ye=>ut.createElement(bN,zT(ky(ky(ky({multiline:!0},Ye),r),re),{component:"button",type:"button",ref:e,__staticSelector:"FileInput",rightSection:we,classNames:zT(ky({},P),{input:ce(ie.input,P==null?void 0:P.input)})}),Ce?ut.createElement(V,{value:se}):ut.createElement(bN.Placeholder,{className:ie.placeholder},o))))});xce.displayName="@mantine/core/FileInput";const mit=xce;function Ait(t){return Ee.Children.toArray(t).filter(Boolean)}const _it={left:"flex-start",center:"center",right:"flex-end",apart:"space-between"};var yit=no((t,{spacing:e,position:n,noWrap:r,grow:i,align:o,count:a})=>({root:{boxSizing:"border-box",display:"flex",flexDirection:"row",alignItems:o||"center",flexWrap:r?"nowrap":"wrap",justifyContent:_it[n],gap:Zr({size:e,sizes:t.spacing}),"& > *":{boxSizing:"border-box",maxWidth:i?`calc(${100/a}% - (${pn(Zr({size:e,sizes:t.spacing}))} - ${Zr({size:e,sizes:t.spacing})} / ${a}))`:void 0,flexGrow:i?1:0}}}));const vit=yit;var xit=Object.defineProperty,nO=Object.getOwnPropertySymbols,bce=Object.prototype.hasOwnProperty,wce=Object.prototype.propertyIsEnumerable,bQ=(t,e,n)=>e in t?xit(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bit=(t,e)=>{for(var n in e||(e={}))bce.call(e,n)&&bQ(t,n,e[n]);if(nO)for(var n of nO(e))wce.call(e,n)&&bQ(t,n,e[n]);return t},wit=(t,e)=>{var n={};for(var r in t)bce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&nO)for(var r of nO(t))e.indexOf(r)<0&&wce.call(t,r)&&(n[r]=t[r]);return n};const Eit={position:"left",spacing:"md"},Vy=Ee.forwardRef((t,e)=>{const n=Gr("Group",Eit,t),{className:r,position:i,align:o,children:a,noWrap:s,grow:u,spacing:d,unstyled:g,variant:_}=n,E=wit(n,["className","position","align","children","noWrap","grow","spacing","unstyled","variant"]),P=Ait(a),{classes:O,cx:D}=vit({align:o,grow:u,noWrap:s,spacing:d,position:i,count:P.length},{unstyled:g,name:"Group",variant:_});return ut.createElement(go,bit({className:D(O.root,r),ref:e},E),P)});Vy.displayName="@mantine/core/Group";const Ece={context:"HoverCard component was not found in the tree",children:"HoverCard.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported"},[Sit,Sce]=EL(Ece.context);var Tit=Object.defineProperty,rO=Object.getOwnPropertySymbols,Tce=Object.prototype.hasOwnProperty,Cce=Object.prototype.propertyIsEnumerable,wQ=(t,e,n)=>e in t?Tit(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Cit=(t,e)=>{for(var n in e||(e={}))Tce.call(e,n)&&wQ(t,n,e[n]);if(rO)for(var n of rO(e))Cce.call(e,n)&&wQ(t,n,e[n]);return t},Pit=(t,e)=>{var n={};for(var r in t)Tce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&rO)for(var r of rO(t))e.indexOf(r)<0&&Cce.call(t,r)&&(n[r]=t[r]);return n};const Iit={};function Pce(t){const e=Gr("HoverCardDropdown",Iit,t),{children:n,onMouseEnter:r,onMouseLeave:i}=e,o=Pit(e,["children","onMouseEnter","onMouseLeave"]),a=Sce(),s=gM(r,a.openDropdown),u=gM(i,a.closeDropdown);return ut.createElement(tx.Dropdown,Cit({onMouseEnter:s,onMouseLeave:u},o),n)}Pce.displayName="@mantine/core/HoverCardDropdown";var Mit=Object.defineProperty,iO=Object.getOwnPropertySymbols,Ice=Object.prototype.hasOwnProperty,Mce=Object.prototype.propertyIsEnumerable,EQ=(t,e,n)=>e in t?Mit(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Oit=(t,e)=>{for(var n in e||(e={}))Ice.call(e,n)&&EQ(t,n,e[n]);if(iO)for(var n of iO(e))Mce.call(e,n)&&EQ(t,n,e[n]);return t},Rit=(t,e)=>{var n={};for(var r in t)Ice.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&iO)for(var r of iO(t))e.indexOf(r)<0&&Mce.call(t,r)&&(n[r]=t[r]);return n};const Lit={refProp:"ref"},Oce=Ee.forwardRef((t,e)=>{const n=Gr("HoverCardTarget",Lit,t),{children:r,refProp:i}=n,o=Rit(n,["children","refProp"]);if(!g2(r))throw new Error(Ece.children);const a=Sce(),s=gM(r.props.onMouseEnter,a.openDropdown),u=gM(r.props.onMouseLeave,a.closeDropdown);return ut.createElement(tx.Target,Oit({refProp:i,ref:e},o),Ee.cloneElement(r,{onMouseEnter:s,onMouseLeave:u}))});Oce.displayName="@mantine/core/HoverCardTarget";function Dit({open:t,close:e,openDelay:n,closeDelay:r}){const i=Ee.useRef(-1),o=Ee.useRef(-1),a=()=>{window.clearTimeout(i.current),window.clearTimeout(o.current)},s=()=>{a(),n===0?t():i.current=window.setTimeout(t,n)},u=()=>{a(),r===0?e():o.current=window.setTimeout(e,r)};return Ee.useEffect(()=>a,[]),{openDropdown:s,closeDropdown:u}}var Bit=Object.defineProperty,oO=Object.getOwnPropertySymbols,Rce=Object.prototype.hasOwnProperty,Lce=Object.prototype.propertyIsEnumerable,SQ=(t,e,n)=>e in t?Bit(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Nit=(t,e)=>{for(var n in e||(e={}))Rce.call(e,n)&&SQ(t,n,e[n]);if(oO)for(var n of oO(e))Lce.call(e,n)&&SQ(t,n,e[n]);return t},Fit=(t,e)=>{var n={};for(var r in t)Rce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&oO)for(var r of oO(t))e.indexOf(r)<0&&Lce.call(t,r)&&(n[r]=t[r]);return n};const kit={openDelay:0,closeDelay:150,initiallyOpened:!1};function Vp(t){const e=Gr("HoverCard",kit,t),{children:n,onOpen:r,onClose:i,openDelay:o,closeDelay:a,initiallyOpened:s}=e,u=Fit(e,["children","onOpen","onClose","openDelay","closeDelay","initiallyOpened"]),[d,{open:g,close:_}]=J4(s,{onClose:i,onOpen:r}),{openDropdown:E,closeDropdown:P}=Dit({open:g,close:_,openDelay:o,closeDelay:a});return ut.createElement(Sit,{value:{openDropdown:E,closeDropdown:P}},ut.createElement(tx,Nit({opened:d,__staticSelector:"HoverCard"},u),n))}Vp.displayName="@mantine/core/HoverCard";Vp.Target=Oce;Vp.Dropdown=Pce;var zit=Object.defineProperty,sO=Object.getOwnPropertySymbols,Dce=Object.prototype.hasOwnProperty,Bce=Object.prototype.propertyIsEnumerable,TQ=(t,e,n)=>e in t?zit(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,CQ=(t,e)=>{for(var n in e||(e={}))Dce.call(e,n)&&TQ(t,n,e[n]);if(sO)for(var n of sO(e))Bce.call(e,n)&&TQ(t,n,e[n]);return t},Uit=(t,e)=>{var n={};for(var r in t)Dce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&sO)for(var r of sO(t))e.indexOf(r)<0&&Bce.call(t,r)&&(n[r]=t[r]);return n};function Git(t){const e=t,{width:n,height:r,style:i}=e,o=Uit(e,["width","height","style"]);return ut.createElement("svg",CQ({viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:CQ({width:n,height:r},i)},o),ut.createElement("path",{d:"M2.5 1H12.5C13.3284 1 14 1.67157 14 2.5V12.5C14 13.3284 13.3284 14 12.5 14H2.5C1.67157 14 1 13.3284 1 12.5V2.5C1 1.67157 1.67157 1 2.5 1ZM2.5 2C2.22386 2 2 2.22386 2 2.5V8.3636L3.6818 6.6818C3.76809 6.59551 3.88572 6.54797 4.00774 6.55007C4.12975 6.55216 4.24568 6.60372 4.32895 6.69293L7.87355 10.4901L10.6818 7.6818C10.8575 7.50607 11.1425 7.50607 11.3182 7.6818L13 9.3636V2.5C13 2.22386 12.7761 2 12.5 2H2.5ZM2 12.5V9.6364L3.98887 7.64753L7.5311 11.4421L8.94113 13H2.5C2.22386 13 2 12.7761 2 12.5ZM12.5 13H10.155L8.48336 11.153L11 8.6364L13 10.6364V12.5C13 12.7761 12.7761 13 12.5 13ZM6.64922 5.5C6.64922 5.03013 7.03013 4.64922 7.5 4.64922C7.96987 4.64922 8.35078 5.03013 8.35078 5.5C8.35078 5.96987 7.96987 6.35078 7.5 6.35078C7.03013 6.35078 6.64922 5.96987 6.64922 5.5ZM7.5 3.74922C6.53307 3.74922 5.74922 4.53307 5.74922 5.5C5.74922 6.46693 6.53307 7.25078 7.5 7.25078C8.46693 7.25078 9.25078 6.46693 9.25078 5.5C9.25078 4.53307 8.46693 3.74922 7.5 3.74922Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))}var jit=Object.defineProperty,Vit=Object.defineProperties,$it=Object.getOwnPropertyDescriptors,PQ=Object.getOwnPropertySymbols,Hit=Object.prototype.hasOwnProperty,Wit=Object.prototype.propertyIsEnumerable,IQ=(t,e,n)=>e in t?jit(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,MQ=(t,e)=>{for(var n in e||(e={}))Hit.call(e,n)&&IQ(t,n,e[n]);if(PQ)for(var n of PQ(e))Wit.call(e,n)&&IQ(t,n,e[n]);return t},OQ=(t,e)=>Vit(t,$it(e)),qit=no((t,{radius:e})=>({root:{},imageWrapper:{position:"relative"},figure:{margin:0},image:OQ(MQ({},t.fn.fontStyles()),{display:"block",width:"100%",height:"100%",border:0,borderRadius:t.fn.radius(e)}),caption:{color:t.colorScheme==="dark"?t.colors.dark[2]:t.colors.gray[7],marginTop:t.spacing.xs},placeholder:OQ(MQ({},t.fn.cover()),{display:"flex",alignItems:"center",justifyContent:"center",color:t.colorScheme==="dark"?t.colors.dark[2]:t.colors.gray[6],backgroundColor:t.colorScheme==="dark"?t.colors.dark[8]:t.colors.gray[0],borderRadius:t.fn.radius(e)})}));const Xit=qit;var Zit=Object.defineProperty,Yit=Object.defineProperties,Qit=Object.getOwnPropertyDescriptors,aO=Object.getOwnPropertySymbols,Nce=Object.prototype.hasOwnProperty,Fce=Object.prototype.propertyIsEnumerable,RQ=(t,e,n)=>e in t?Zit(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jb=(t,e)=>{for(var n in e||(e={}))Nce.call(e,n)&&RQ(t,n,e[n]);if(aO)for(var n of aO(e))Fce.call(e,n)&&RQ(t,n,e[n]);return t},Kit=(t,e)=>Yit(t,Qit(e)),Jit=(t,e)=>{var n={};for(var r in t)Nce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&aO)for(var r of aO(t))e.indexOf(r)<0&&Fce.call(t,r)&&(n[r]=t[r]);return n};const eot={fit:"cover",width:"100%",height:"auto",radius:0},kce=Ee.forwardRef((t,e)=>{const n=Gr("Image",eot,t),{className:r,alt:i,src:o,fit:a,width:s,height:u,radius:d,imageProps:g,withPlaceholder:_,placeholder:E,imageRef:P,classNames:O,styles:D,caption:V,unstyled:k,style:F,variant:z}=n,X=Jit(n,["className","alt","src","fit","width","height","radius","imageProps","withPlaceholder","placeholder","imageRef","classNames","styles","caption","unstyled","style","variant"]),{classes:Y,cx:J}=Xit({radius:d},{classNames:O,styles:D,unstyled:k,name:"Image",variant:z}),[re,ue]=Ee.useState(!o),ie=_&&re;return dA(()=>{ue(!o)},[o]),ut.createElement(go,jb({className:J(Y.root,r),style:jb({width:pn(s)},F),ref:e},X),ut.createElement("figure",{className:Y.figure},ut.createElement("div",{className:Y.imageWrapper},ut.createElement("img",Kit(jb({src:o,alt:i,ref:P},g),{className:J(Y.image,g==null?void 0:g.className),onError:ce=>{ue(!0),typeof(g==null?void 0:g.onError)=="function"&&g.onError(ce)},style:jb(jb({objectFit:a,width:pn(s),height:pn(u)},ie&&{overflow:"hidden"}),g==null?void 0:g.style)})),ie&&ut.createElement("div",{className:Y.placeholder,title:i},E||ut.createElement("div",null,ut.createElement(Git,{width:pn(40),height:pn(40)})))),!!V&&ut.createElement(Nh,{component:"figcaption",size:"sm",align:"center",className:Y.caption},V)))});kce.displayName="@mantine/core/Image";const[tot,not]=EL("Modal component was not found in tree"),rot={xs:pn(320),sm:pn(380),md:pn(440),lg:pn(620),xl:pn(780)};var iot=no((t,{yOffset:e,xOffset:n,centered:r,fullScreen:i},{size:o})=>({content:{flex:i?"0 0 100%":`0 0 ${Zr({size:o,sizes:rot})}`,maxWidth:"100%",maxHeight:i?void 0:`calc(100dvh - (${pn(e)} * 2))`,height:i?"100vh":void 0,borderRadius:i?0:void 0,overflowY:"auto"},inner:{paddingTop:i?0:e,paddingBottom:i?0:e,paddingLeft:i?0:n,paddingRight:i?0:n,display:"flex",justifyContent:"center",alignItems:r?"center":"flex-start"}}));const oot=iot;var sot=Object.defineProperty,aot=Object.defineProperties,lot=Object.getOwnPropertyDescriptors,lO=Object.getOwnPropertySymbols,zce=Object.prototype.hasOwnProperty,Uce=Object.prototype.propertyIsEnumerable,LQ=(t,e,n)=>e in t?sot(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,rz=(t,e)=>{for(var n in e||(e={}))zce.call(e,n)&&LQ(t,n,e[n]);if(lO)for(var n of lO(e))Uce.call(e,n)&&LQ(t,n,e[n]);return t},Gce=(t,e)=>aot(t,lot(e)),uot=(t,e)=>{var n={};for(var r in t)zce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&lO)for(var r of lO(t))e.indexOf(r)<0&&Uce.call(t,r)&&(n[r]=t[r]);return n};const cot=Gce(rz({},v8),{yOffset:"5dvh",xOffset:"5vw"});function jce(t){const e=Gr("ModalRoot",cot,t),{classNames:n,variant:r,size:i,yOffset:o,xOffset:a,scrollAreaComponent:s,radius:u,centered:d,fullScreen:g}=e,_=uot(e,["classNames","variant","size","yOffset","xOffset","scrollAreaComponent","radius","centered","fullScreen"]),{classes:E,cx:P}=oot({yOffset:o,xOffset:a,centered:d,fullScreen:g},{name:"Modal",variant:r,size:i});return ut.createElement(tot,{value:{yOffset:o,scrollAreaComponent:s,radius:u}},ut.createElement(Ts,rz({__staticSelector:"Modal",size:i,variant:r,classNames:Gce(rz({},n),{content:P(E.content,n==null?void 0:n.content),inner:P(E.inner,n==null?void 0:n.inner)})},_)))}var fot=Object.defineProperty,uO=Object.getOwnPropertySymbols,Vce=Object.prototype.hasOwnProperty,$ce=Object.prototype.propertyIsEnumerable,DQ=(t,e,n)=>e in t?fot(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,hot=(t,e)=>{for(var n in e||(e={}))Vce.call(e,n)&&DQ(t,n,e[n]);if(uO)for(var n of uO(e))$ce.call(e,n)&&DQ(t,n,e[n]);return t},dot=(t,e)=>{var n={};for(var r in t)Vce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&uO)for(var r of uO(t))e.indexOf(r)<0&&$ce.call(t,r)&&(n[r]=t[r]);return n};const pot={shadow:"xl"},Hce=Ee.forwardRef((t,e)=>{const n=Gr("ModalContent",pot,t),{children:r,scrollAreaComponent:i}=n,o=dot(n,["children","scrollAreaComponent"]),a=not(),s=i||a.scrollAreaComponent||Ts.NativeScrollArea;return ut.createElement(Ts.Content,hot({ref:e,radius:a.radius},o),ut.createElement(s,{style:{maxHeight:`calc(100dvh - (${pn(a.yOffset)} * 2))`}},r))});var got=Object.defineProperty,mot=Object.defineProperties,Aot=Object.getOwnPropertyDescriptors,cO=Object.getOwnPropertySymbols,Wce=Object.prototype.hasOwnProperty,qce=Object.prototype.propertyIsEnumerable,BQ=(t,e,n)=>e in t?got(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,TP=(t,e)=>{for(var n in e||(e={}))Wce.call(e,n)&&BQ(t,n,e[n]);if(cO)for(var n of cO(e))qce.call(e,n)&&BQ(t,n,e[n]);return t},_ot=(t,e)=>mot(t,Aot(e)),yot=(t,e)=>{var n={};for(var r in t)Wce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&cO)for(var r of cO(t))e.indexOf(r)<0&&qce.call(t,r)&&(n[r]=t[r]);return n};const vot=_ot(TP({},v8),{transitionProps:{duration:200,transition:"pop"},withOverlay:!0,withCloseButton:!0});function Qd(t){const e=Gr("Modal",vot,t),{title:n,withOverlay:r,overlayProps:i,withCloseButton:o,closeButtonProps:a,children:s}=e,u=yot(e,["title","withOverlay","overlayProps","withCloseButton","closeButtonProps","children"]),d=!!n||o;return ut.createElement(jce,TP({},u),r&&ut.createElement(Ts.Overlay,TP({},i)),ut.createElement(Hce,null,d&&ut.createElement(Ts.Header,null,n&&ut.createElement(Ts.Title,null,n),o&&ut.createElement(Ts.CloseButton,TP({},a))),ut.createElement(Ts.Body,null,s)))}Qd.Root=jce;Qd.CloseButton=Ts.CloseButton;Qd.Overlay=Ts.Overlay;Qd.Content=Hce;Qd.Header=Ts.Header;Qd.Title=Ts.Title;Qd.Body=Ts.Body;Qd.NativeScrollArea=Ts.NativeScrollArea;const NQ={xs:pn(3),sm:pn(5),md:pn(8),lg:pn(12),xl:pn(16)},xot=qYe({from:{backgroundPosition:"0 0"},to:{backgroundPosition:`${pn(40)} 0`}});var bot=no((t,{color:e,radius:n},{size:r})=>({root:{position:"relative",height:Zr({size:r,sizes:NQ}),backgroundColor:t.colorScheme==="dark"?t.colors.dark[4]:t.colors.gray[2],borderRadius:t.fn.radius(n),overflow:"hidden"},bar:{position:"absolute",top:0,bottom:0,left:0,height:"100%",display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:t.fn.variant({variant:"filled",primaryFallback:!1,color:e||t.primaryColor}).background,transition:"width 100ms linear","&[data-animate]":{animation:`${xot} 1000ms linear infinite`},"&[data-striped]":{backgroundSize:`${pn(20)} ${pn(20)}`,backgroundImage:"linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent)"},"&:last-of-type":{borderTopRightRadius:t.fn.radius(n),borderBottomRightRadius:t.fn.radius(n)},"&:first-of-type":{borderTopLeftRadius:t.fn.radius(n),borderBottomLeftRadius:t.fn.radius(n)},"@media (prefers-reduced-motion)":{transitionDuration:t.respectReducedMotion?"0ms":void 0}},label:{color:t.white,fontSize:`calc(${Zr({size:r,sizes:NQ})} * 0.65)`,fontWeight:700,userSelect:"none",overflow:"hidden",whiteSpace:"nowrap"}}));const wot=bot,Xce=Ee.createContext(!1),Eot=Xce.Provider,Sot=()=>Ee.useContext(Xce);function Zce({children:t,openDelay:e=0,closeDelay:n=0}){return ut.createElement(Eot,{value:!0},ut.createElement(Let,{delay:{open:e,close:n}},t))}Zce.displayName="@mantine/core/TooltipGroup";var Tot=Object.defineProperty,Cot=Object.defineProperties,Pot=Object.getOwnPropertyDescriptors,FQ=Object.getOwnPropertySymbols,Iot=Object.prototype.hasOwnProperty,Mot=Object.prototype.propertyIsEnumerable,kQ=(t,e,n)=>e in t?Tot(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,zQ=(t,e)=>{for(var n in e||(e={}))Iot.call(e,n)&&kQ(t,n,e[n]);if(FQ)for(var n of FQ(e))Mot.call(e,n)&&kQ(t,n,e[n]);return t},Oot=(t,e)=>Cot(t,Pot(e));function Rot(t,e){if(!e)return{backgroundColor:t.colorScheme==="dark"?t.colors.gray[2]:t.colors.gray[9],color:t.colorScheme==="dark"?t.black:t.white};const n=t.fn.variant({variant:"filled",color:e,primaryFallback:!1});return{backgroundColor:n.background,color:n.color}}var Lot=no((t,{color:e,radius:n,width:r,multiline:i})=>({tooltip:Oot(zQ(zQ({},t.fn.fontStyles()),Rot(t,e)),{lineHeight:t.lineHeight,fontSize:t.fontSizes.sm,borderRadius:t.fn.radius(n),padding:`calc(${t.spacing.xs} / 2) ${t.spacing.xs}`,position:"absolute",whiteSpace:i?"unset":"nowrap",pointerEvents:"none",width:r}),arrow:{backgroundColor:"inherit",border:0,zIndex:1}}));const Yce=Lot,Qce={children:"Tooltip component children should be an element or a component that accepts ref, fragments, strings, numbers and other primitive values are not supported"};function Dot({offset:t,position:e}){const[n,r]=Ee.useState(!1),i=Ee.useRef(),{x:o,y:a,reference:s,floating:u,refs:d,update:g,placement:_}=d8({placement:e,middleware:[a8({crossAxis:!0,padding:5,rootBoundary:"document"})]}),E=_.includes("right")?t:e.includes("left")?t*-1:0,P=_.includes("bottom")?t:e.includes("top")?t*-1:0,O=Ee.useCallback(({clientX:D,clientY:V})=>{s({getBoundingClientRect(){return{width:0,height:0,x:D,y:V,left:D+E,top:V+P,right:D,bottom:V}}})},[s]);return Ee.useEffect(()=>{if(d.floating.current){const D=i.current;D.addEventListener("mousemove",O);const V=ng(d.floating.current);return V.forEach(k=>{k.addEventListener("scroll",g)}),()=>{D.removeEventListener("mousemove",O),V.forEach(k=>{k.removeEventListener("scroll",g)})}}},[s,d.floating.current,g,O,n]),{handleMouseMove:O,x:o,y:a,opened:n,setOpened:r,boundaryRef:i,floating:u}}var Bot=Object.defineProperty,Not=Object.defineProperties,Fot=Object.getOwnPropertyDescriptors,fO=Object.getOwnPropertySymbols,Kce=Object.prototype.hasOwnProperty,Jce=Object.prototype.propertyIsEnumerable,UQ=(t,e,n)=>e in t?Bot(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,UT=(t,e)=>{for(var n in e||(e={}))Kce.call(e,n)&&UQ(t,n,e[n]);if(fO)for(var n of fO(e))Jce.call(e,n)&&UQ(t,n,e[n]);return t},GT=(t,e)=>Not(t,Fot(e)),kot=(t,e)=>{var n={};for(var r in t)Kce.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&fO)for(var r of fO(t))e.indexOf(r)<0&&Jce.call(t,r)&&(n[r]=t[r]);return n};const zot={refProp:"ref",withinPortal:!0,offset:10,position:"right",zIndex:_2("popover")};function efe(t){var e;const n=Gr("TooltipFloating",zot,t),{children:r,refProp:i,withinPortal:o,portalProps:a,style:s,className:u,classNames:d,styles:g,unstyled:_,radius:E,color:P,label:O,offset:D,position:V,multiline:k,width:F,zIndex:z,disabled:X,variant:Y}=n,J=kot(n,["children","refProp","withinPortal","portalProps","style","className","classNames","styles","unstyled","radius","color","label","offset","position","multiline","width","zIndex","disabled","variant"]),{handleMouseMove:re,x:ue,y:ie,opened:ce,boundaryRef:se,floating:me,setOpened:Ce}=Dot({offset:D,position:V}),{classes:we,cx:Ye}=Yce({radius:E,color:P,multiline:k,width:F},{name:"TooltipFloating",classNames:d,styles:g,unstyled:_,variant:Y});if(!g2(r))throw new Error(Qce.children);const at=J1(se,r.ref),yt=De=>{var Re,qe;(qe=(Re=r.props).onMouseEnter)==null||qe.call(Re,De),re(De),Ce(!0)},be=De=>{var Re,qe;(qe=(Re=r.props).onMouseLeave)==null||qe.call(Re,De),Ce(!1)};return ut.createElement(ut.Fragment,null,ut.createElement(v2,GT(UT({},a),{withinPortal:o}),ut.createElement(go,GT(UT({},J),{ref:me,className:Ye(we.tooltip,u),style:GT(UT({},s),{zIndex:z,display:!X&&ce?"block":"none",top:ie??"",left:(e=Math.round(ue))!=null?e:""})}),O)),Ee.cloneElement(r,GT(UT({},r.props),{[i]:at,onMouseEnter:yt,onMouseLeave:be})))}efe.displayName="@mantine/core/TooltipFloating";function Uot(t){const[e,n]=Ee.useState(!1),i=typeof t.opened=="boolean"?t.opened:e,o=Sot(),a=y2(),{delay:s,currentId:u,setCurrentId:d}=mue(),g=Ee.useCallback(ue=>{n(ue),ue&&d(a)},[d,a]),{x:_,y:E,reference:P,floating:O,context:D,refs:V,update:k,placement:F,middlewareData:{arrow:{x:z,y:X}={}}}=d8({placement:t.position,open:i,onOpenChange:g,middleware:[rue(t.offset),a8({padding:8}),eue(),fue({element:t.arrowRef,padding:t.arrowOffset}),...t.inline?[nue()]:[]]}),{getReferenceProps:Y,getFloatingProps:J}=Het([Ret(D,{enabled:t.events.hover,delay:o?s:{open:t.openDelay,close:t.closeDelay},mouseOnly:!t.events.touch}),Vet(D,{enabled:t.events.focus,keyboardOnly:!0}),$et(D,{role:"tooltip"}),jet(D,{enabled:typeof t.opened===void 0}),Det(D,{id:a})]);return _ue({opened:i,position:t.position,positionDependencies:t.positionDependencies,floating:{refs:V,update:k}}),dA(()=>{var ue;(ue=t.onPositionChange)==null||ue.call(t,F)},[F]),{x:_,y:E,arrowX:z,arrowY:X,reference:P,floating:O,getFloatingProps:J,getReferenceProps:Y,isGroupPhase:i&&u&&u!==a,opened:i,placement:F}}var Got=Object.defineProperty,jot=Object.defineProperties,Vot=Object.getOwnPropertyDescriptors,hO=Object.getOwnPropertySymbols,tfe=Object.prototype.hasOwnProperty,nfe=Object.prototype.propertyIsEnumerable,GQ=(t,e,n)=>e in t?Got(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,p0=(t,e)=>{for(var n in e||(e={}))tfe.call(e,n)&&GQ(t,n,e[n]);if(hO)for(var n of hO(e))nfe.call(e,n)&&GQ(t,n,e[n]);return t},EN=(t,e)=>jot(t,Vot(e)),$ot=(t,e)=>{var n={};for(var r in t)tfe.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&hO)for(var r of hO(t))e.indexOf(r)<0&&nfe.call(t,r)&&(n[r]=t[r]);return n};const Hot={position:"top",refProp:"ref",withinPortal:!1,inline:!1,arrowSize:4,arrowOffset:5,arrowRadius:0,arrowPosition:"side",offset:5,transitionProps:{duration:100,transition:"fade"},width:"auto",events:{hover:!0,focus:!1,touch:!1},zIndex:_2("popover"),positionDependencies:[]},$L=Ee.forwardRef((t,e)=>{var n;const r=Ee.useRef(null),i=Gr("Tooltip",Hot,t),{children:o,position:a,refProp:s,label:u,openDelay:d,closeDelay:g,onPositionChange:_,opened:E,withinPortal:P,portalProps:O,radius:D,color:V,classNames:k,styles:F,unstyled:z,style:X,className:Y,withArrow:J,arrowSize:re,arrowOffset:ue,arrowRadius:ie,arrowPosition:ce,offset:se,transitionProps:me,multiline:Ce,width:we,events:Ye,zIndex:at,disabled:yt,positionDependencies:be,onClick:De,onMouseEnter:Re,onMouseLeave:qe,inline:ct,variant:Ct,keepMounted:Dt}=i,In=$ot(i,["children","position","refProp","label","openDelay","closeDelay","onPositionChange","opened","withinPortal","portalProps","radius","color","classNames","styles","unstyled","style","className","withArrow","arrowSize","arrowOffset","arrowRadius","arrowPosition","offset","transitionProps","multiline","width","events","zIndex","disabled","positionDependencies","onClick","onMouseEnter","onMouseLeave","inline","variant","keepMounted"]),{classes:Mn,cx:Tn,theme:Nt}=Yce({radius:D,color:V,width:we,multiline:Ce},{name:"Tooltip",classNames:k,styles:F,unstyled:z,variant:Ct}),Zt=Uot({position:Iue(Nt.dir,a),closeDelay:g,openDelay:d,onPositionChange:_,opened:E,events:Ye,arrowRef:r,arrowOffset:ue,offset:se+(J?re/2:0),positionDependencies:[...be,o],inline:ct});if(!g2(o))throw new Error(Qce.children);const Wt=J1(Zt.reference,o.ref,e);return ut.createElement(ut.Fragment,null,ut.createElement(v2,EN(p0({},O),{withinPortal:P}),ut.createElement(b2,EN(p0({keepMounted:Dt,mounted:!yt&&Zt.opened},me),{transition:me.transition||"fade",duration:Zt.isGroupPhase?10:(n=me.duration)!=null?n:100}),hn=>{var lr,It;return ut.createElement(go,p0(p0({},In),Zt.getFloatingProps({ref:Zt.floating,className:Mn.tooltip,style:EN(p0(p0({},X),hn),{zIndex:at,top:(lr=Zt.y)!=null?lr:0,left:(It=Zt.x)!=null?It:0})})),u,ut.createElement(g8,{ref:r,arrowX:Zt.arrowX,arrowY:Zt.arrowY,visible:J,position:Zt.placement,arrowSize:re,arrowOffset:ue,arrowRadius:ie,arrowPosition:ce,className:Mn.arrow}))})),Ee.cloneElement(o,Zt.getReferenceProps(p0({onClick:De,onMouseEnter:Re,onMouseLeave:qe,onMouseMove:t.onMouseMove,onPointerDown:t.onPointerDown,onPointerEnter:t.onPointerEnter,[s]:Wt,className:Tn(Y,o.props.className)},o.props))))});$L.Group=Zce;$L.Floating=efe;$L.displayName="@mantine/core/Tooltip";const Wot=$L;var qot=Object.defineProperty,Xot=Object.defineProperties,Zot=Object.getOwnPropertyDescriptors,dO=Object.getOwnPropertySymbols,rfe=Object.prototype.hasOwnProperty,ife=Object.prototype.propertyIsEnumerable,jQ=(t,e,n)=>e in t?qot(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,iz=(t,e)=>{for(var n in e||(e={}))rfe.call(e,n)&&jQ(t,n,e[n]);if(dO)for(var n of dO(e))ife.call(e,n)&&jQ(t,n,e[n]);return t},ofe=(t,e)=>Xot(t,Zot(e)),VQ=(t,e)=>{var n={};for(var r in t)rfe.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&dO)for(var r of dO(t))e.indexOf(r)<0&&ife.call(t,r)&&(n[r]=t[r]);return n};function Yot(t){return t.reduce((e,n)=>(e.sections.push(ofe(iz({},n),{accumulated:e.accumulated})),e.accumulated+=n.value,e),{accumulated:0,sections:[]}).sections}const Qot={size:"md",radius:"sm",striped:!1,animate:!1,label:""},sfe=Ee.forwardRef((t,e)=>{const n=Gr("Progress",Qot,t),{className:r,value:i,color:o,size:a,radius:s,striped:u,animate:d,label:g,"aria-label":_,classNames:E,styles:P,sections:O,unstyled:D,variant:V}=n,k=VQ(n,["className","value","color","size","radius","striped","animate","label","aria-label","classNames","styles","sections","unstyled","variant"]),{classes:F,cx:z,theme:X}=wot({color:o,radius:s},{name:"Progress",classNames:E,styles:P,unstyled:D,variant:V,size:a}),Y=Array.isArray(O)?Yot(O).map((J,re)=>{var ue=J,{tooltip:ie,accumulated:ce,value:se,label:me,color:Ce}=ue,we=VQ(ue,["tooltip","accumulated","value","label","color"]);return ut.createElement(Wot.Floating,{label:ie,disabled:!ie,key:re},ut.createElement(go,ofe(iz({},we),{className:z(F.bar,we.className),"data-striped":u||d||void 0,"data-animate":d||void 0,sx:{width:`${se}%`,left:`${ce}%`,backgroundColor:X.fn.variant({variant:"filled",primaryFallback:!1,color:Ce||X.primaryColor}).background}}),me&&ut.createElement(Nh,{className:F.label},me)))}):null;return ut.createElement(go,iz({className:z(F.root,r),ref:e},k),Y||ut.createElement("div",{role:"progressbar","aria-valuemax":100,"aria-valuemin":0,"aria-valuenow":i,"aria-label":_,className:F.bar,style:{width:`${i}%`},"data-striped":u||d||void 0,"data-animate":d||void 0},g?ut.createElement(Nh,{className:F.label},g):""))});sfe.displayName="@mantine/core/Progress";var Kot=Object.defineProperty,Jot=Object.defineProperties,est=Object.getOwnPropertyDescriptors,$Q=Object.getOwnPropertySymbols,tst=Object.prototype.hasOwnProperty,nst=Object.prototype.propertyIsEnumerable,HQ=(t,e,n)=>e in t?Kot(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,jT=(t,e)=>{for(var n in e||(e={}))tst.call(e,n)&&HQ(t,n,e[n]);if($Q)for(var n of $Q(e))nst.call(e,n)&&HQ(t,n,e[n]);return t},rst=(t,e)=>Jot(t,est(e));const CP=4,WQ={xs:`${pn(3)} ${pn(6)}`,sm:`${pn(5)} ${pn(10)}`,md:`${pn(7)} ${pn(14)}`,lg:`${pn(9)} ${pn(16)}`,xl:`${pn(12)} ${pn(20)}`};var ist=no((t,{fullWidth:e,color:n,radius:r,shouldAnimate:i,transitionDuration:o,transitionTimingFunction:a,orientation:s},{size:u})=>{const d=s==="vertical",g=t.fn.variant({variant:"filled",color:n});return{label:rst(jT(jT({ref:Nb("label")},t.fn.focusStyles()),t.fn.fontStyles()),{WebkitTapHighlightColor:"transparent",borderRadius:t.fn.radius(r),fontWeight:500,fontSize:u in t.fontSizes?t.fontSizes[u]:t.fontSizes.sm,cursor:"pointer",display:"block",textAlign:"center",padding:WQ[u in WQ?u:"sm"],whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",userSelect:"none",color:t.colorScheme==="dark"?t.colors.dark[1]:t.colors.gray[7],transition:`color ${i?0:o}ms ${a||t.transitionTimingFunction}`,"&:hover":{color:t.colorScheme==="dark"?t.colors.dark[0]:t.black},"&[data-disabled]":{"&, &:hover":{color:t.colorScheme==="dark"?t.colors.dark[3]:t.colors.gray[5],cursor:"not-allowed",pointerEvents:"none"}},"&[data-active]":{"&, &:hover":{color:n||t.colorScheme==="dark"?t.white:t.black}}}),control:{ref:Nb("control"),position:"relative",boxSizing:"border-box",flex:1,zIndex:2,transition:`border-left-color ${i?0:o}ms ${a||t.transitionTimingFunction}`,"&:not(:first-of-type)":{borderStyle:"solid",borderWidth:d?`${pn(1)} 0 0 0`:`0 0 0 ${pn(1)}`,borderColor:t.colorScheme==="dark"?t.colors.dark[4]:t.colors.gray[3]}},input:{height:0,width:0,position:"absolute",overflow:"hidden",whiteSpace:"nowrap",opacity:0,"&:focus":{outline:"none",[`& + .${Nb("label")}`]:jT({},t.focusRing==="always"||t.focusRing==="auto"?t.focusRingStyles.styles(t):t.focusRingStyles.resetStyles(t)),"&:focus:not(:focus-visible)":{[`& + .${Nb("label")}`]:jT({},t.focusRing==="auto"||t.focusRing==="never"?t.focusRingStyles.resetStyles(t):null)}},"&:disabled + label":{"&, &:hover":{color:t.colorScheme==="dark"?t.colors.dark[3]:t.colors.gray[5],cursor:"not-allowed",pointerEvents:"none"}}},root:{position:"relative",display:e||d?"flex":"inline-flex",width:d&&!e?"max-content":"auto",flexDirection:d?"column":"row",backgroundColor:t.colorScheme==="dark"?t.colors.dark[8]:t.colors.gray[1],borderRadius:t.fn.radius(r),overflow:"hidden",padding:CP},controlActive:{borderLeftColor:"transparent !important",borderTopColor:"transparent !important",[`& + .${Nb("control")}`]:{[d?"borderTopColor":"borderLeftColor"]:"transparent !important"},borderRadius:t.fn.radius(r),boxShadow:i?n||t.colorScheme==="dark"?"none":t.shadows.xs:void 0,backgroundColor:i?n?g.background:t.colorScheme==="dark"?t.colors.dark[5]:t.white:void 0},indicator:{boxSizing:"border-box",borderRadius:t.fn.radius(r),position:"absolute",zIndex:1,boxShadow:n||t.colorScheme==="dark"?"none":t.shadows.xs,transition:`transform ${i?0:o}ms ${t.transitionTimingFunction}, width ${i?0:o/2}ms ${a||t.transitionTimingFunction}`,backgroundColor:n?g.background:t.colorScheme==="dark"?t.colors.dark[5]:t.white}}});const ost=ist;var sst=Object.defineProperty,pO=Object.getOwnPropertySymbols,afe=Object.prototype.hasOwnProperty,lfe=Object.prototype.propertyIsEnumerable,qQ=(t,e,n)=>e in t?sst(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ast=(t,e)=>{for(var n in e||(e={}))afe.call(e,n)&&qQ(t,n,e[n]);if(pO)for(var n of pO(e))lfe.call(e,n)&&qQ(t,n,e[n]);return t},lst=(t,e)=>{var n={};for(var r in t)afe.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&pO)for(var r of pO(t))e.indexOf(r)<0&&lfe.call(t,r)&&(n[r]=t[r]);return n};const ust={disabled:!1,size:"sm",transitionDuration:200},ufe=Ee.forwardRef((t,e)=>{var n,r,i,o;const a=Gr("SegmentedControl",ust,t),{className:s,disabled:u,data:d,name:g,value:_,onChange:E,color:P,fullWidth:O,radius:D,size:V,transitionDuration:k,transitionTimingFunction:F,classNames:z,styles:X,defaultValue:Y,orientation:J,unstyled:re,variant:ue,readOnly:ie}=a,ce=lst(a,["className","disabled","data","name","value","onChange","color","fullWidth","radius","size","transitionDuration","transitionTimingFunction","classNames","styles","defaultValue","orientation","unstyled","variant","readOnly"]),se=ip(),me=e8(),Ce=se.respectReducedMotion?me:!1,we=d.map(Wt=>typeof Wt=="string"?{label:Wt,value:Wt}:Wt),Ye=Ee.useRef(),[at,yt]=Ee.useState(!1),[be,De]=JU({value:_,defaultValue:Y,finalValue:Array.isArray(we)&&(o=(i=(n=we.find(Wt=>!Wt.disabled))==null?void 0:n.value)!=null?i:(r=we[0])==null?void 0:r.value)!=null?o:null,onChange:E}),{classes:Re,cx:qe}=ost({fullWidth:O,color:P,radius:D,shouldAnimate:Ce||!at,transitionDuration:k,transitionTimingFunction:F,orientation:J},{name:"SegmentedControl",classNames:z,styles:X,unstyled:re,variant:ue,size:V}),[ct,Ct]=Ee.useState({width:0,height:0,translate:[0,0]}),Dt=y2(g),In=Ee.useRef({}),[Mn,Tn]=KQe();UL(()=>{Ye.current?yt(!0):(Ye.current=!0,yt(!1))}),Ee.useEffect(()=>{if(be in In.current&&Mn.current){const Wt=In.current[be],hn=Wt.getBoundingClientRect(),lr=Wt.offsetWidth/hn.width,It=hn.width*lr||0,Xt=hn.height*lr||0,$t=Tn.width-Wt.parentElement.offsetLeft+CP-It,cn=Wt.parentElement.offsetLeft-CP;Ct({width:It,height:Xt,translate:[se.dir==="rtl"?$t:cn,Wt.parentElement.offsetTop-CP]})}},[be,Tn]);const Nt=we.map(Wt=>ut.createElement("div",{className:qe(Re.control,{[Re.controlActive]:be===Wt.value}),key:Wt.value},ut.createElement("input",{className:Re.input,disabled:u||Wt.disabled,type:"radio",name:Dt,value:Wt.value,id:`${Dt}-${Wt.value}`,checked:be===Wt.value,onChange:()=>!ie&&De(Wt.value)}),ut.createElement("label",{className:Re.label,"data-active":be===Wt.value&&!(u||Wt.disabled)||void 0,"data-disabled":u||Wt.disabled||void 0,htmlFor:`${Dt}-${Wt.value}`,ref:hn=>{In.current[Wt.value]=hn}},Wt.label))),Zt=J1(Mn,e);return we.length===0?null:ut.createElement(go,ast({className:qe(Re.root,s),ref:Zt},ce),typeof be=="string"&&at&&ut.createElement(go,{component:"span",className:Re.indicator,sx:{width:ct.width,height:ct.height,transform:`translate(${ct.translate[0]}px, ${ct.translate[1]}px)`}}),Nt)});ufe.displayName="@mantine/core/SegmentedControl";var cst=no((t,{spacing:e,align:n,justify:r})=>({root:{display:"flex",flexDirection:"column",alignItems:n,justifyContent:r,gap:Zr({size:e,sizes:t.spacing})}}));const fst=cst;var hst=Object.defineProperty,gO=Object.getOwnPropertySymbols,cfe=Object.prototype.hasOwnProperty,ffe=Object.prototype.propertyIsEnumerable,XQ=(t,e,n)=>e in t?hst(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,dst=(t,e)=>{for(var n in e||(e={}))cfe.call(e,n)&&XQ(t,n,e[n]);if(gO)for(var n of gO(e))ffe.call(e,n)&&XQ(t,n,e[n]);return t},pst=(t,e)=>{var n={};for(var r in t)cfe.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&gO)for(var r of gO(t))e.indexOf(r)<0&&ffe.call(t,r)&&(n[r]=t[r]);return n};const gst={spacing:"md",align:"stretch",justify:"flex-start"},x8=Ee.forwardRef((t,e)=>{const n=Gr("Stack",gst,t),{spacing:r,className:i,align:o,justify:a,unstyled:s,variant:u}=n,d=pst(n,["spacing","className","align","justify","unstyled","variant"]),{classes:g,cx:_}=fst({spacing:r,align:o,justify:a},{name:"Stack",unstyled:s,variant:u});return ut.createElement(go,dst({className:_(g.root,i),ref:e},d))});x8.displayName="@mantine/core/Stack";var mst=Object.defineProperty,Ast=Object.defineProperties,_st=Object.getOwnPropertyDescriptors,ZQ=Object.getOwnPropertySymbols,yst=Object.prototype.hasOwnProperty,vst=Object.prototype.propertyIsEnumerable,YQ=(t,e,n)=>e in t?mst(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xst=(t,e)=>{for(var n in e||(e={}))yst.call(e,n)&&YQ(t,n,e[n]);if(ZQ)for(var n of ZQ(e))vst.call(e,n)&&YQ(t,n,e[n]);return t},bst=(t,e)=>Ast(t,_st(e));function wst(t,e,n){return typeof t<"u"?t in n.headings.sizes?n.headings.sizes[t].fontSize:pn(t):n.headings.sizes[e].fontSize}function Est(t,e,n){return typeof t<"u"&&t in n.headings.sizes?n.headings.sizes[t].lineHeight:n.headings.sizes[e].lineHeight}var Sst=no((t,{element:e,weight:n,inline:r},{size:i})=>({root:bst(xst({},t.fn.fontStyles()),{fontFamily:t.headings.fontFamily,fontWeight:n||t.headings.sizes[e].fontWeight||t.headings.fontWeight,fontSize:wst(i,e,t),lineHeight:r?1:Est(i,e,t),margin:0})}));const Tst=Sst;var Cst=Object.defineProperty,mO=Object.getOwnPropertySymbols,hfe=Object.prototype.hasOwnProperty,dfe=Object.prototype.propertyIsEnumerable,QQ=(t,e,n)=>e in t?Cst(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Pst=(t,e)=>{for(var n in e||(e={}))hfe.call(e,n)&&QQ(t,n,e[n]);if(mO)for(var n of mO(e))dfe.call(e,n)&&QQ(t,n,e[n]);return t},Ist=(t,e)=>{var n={};for(var r in t)hfe.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&mO)for(var r of mO(t))e.indexOf(r)<0&&dfe.call(t,r)&&(n[r]=t[r]);return n};const Mst={order:1},PP=Ee.forwardRef((t,e)=>{const n=Gr("Title",Mst,t),{className:r,order:i,children:o,unstyled:a,size:s,weight:u,inline:d,variant:g}=n,_=Ist(n,["className","order","children","unstyled","size","weight","inline","variant"]),{classes:E,cx:P}=Tst({element:`h${i}`,weight:u,inline:d},{name:"Title",unstyled:a,variant:g,size:s});return[1,2,3,4,5,6].includes(i)?ut.createElement(Nh,Pst({variant:g,component:`h${i}`,ref:e,className:P(E.root,r)},_),o):null});PP.displayName="@mantine/core/Title";function Ost(t,e){var n=!0;return Vd(t,function(r){Vd(e,function(i){if(n===!1)return!1;n=Rst(r.geometry,i.geometry)})}),n}function Rst(t,e){switch(t.type){case"Point":switch(e.type){case"Point":return!Nst(t.coordinates,e.coordinates);case"LineString":return!KQ(e,t);case"Polygon":return!Wv(t,e)}break;case"LineString":switch(e.type){case"Point":return!KQ(t,e);case"LineString":return!Lst(t,e);case"Polygon":return!JQ(e,t)}break;case"Polygon":switch(e.type){case"Point":return!Wv(e,t);case"LineString":return!JQ(t,e);case"Polygon":return!Dst(e,t)}}return!1}function KQ(t,e){for(var n=0;n<t.coordinates.length-1;n++)if(Bst(t.coordinates[n],t.coordinates[n+1],e.coordinates))return!0;return!1}function Lst(t,e){var n=YE(t,e);return n.features.length>0}function JQ(t,e){for(var n=0,r=e.coordinates;n<r.length;n++){var i=r[n];if(Wv(i,t))return!0}var o=YE(e,EI(t));return o.features.length>0}function Dst(t,e){for(var n=0,r=t.coordinates[0];n<r.length;n++){var i=r[n];if(Wv(i,e))return!0}for(var o=0,a=e.coordinates[0];o<a.length;o++){var s=a[o];if(Wv(s,t))return!0}var u=YE(EI(t),EI(e));return u.features.length>0}function Bst(t,e,n){var r=n[0]-t[0],i=n[1]-t[1],o=e[0]-t[0],a=e[1]-t[1],s=r*a-i*o;return s!==0?!1:Math.abs(o)>=Math.abs(a)?o>0?t[0]<=n[0]&&n[0]<=e[0]:e[0]<=n[0]&&n[0]<=t[0]:a>0?t[1]<=n[1]&&n[1]<=e[1]:e[1]<=n[1]&&n[1]<=t[1]}function Nst(t,e){return t[0]===e[0]&&t[1]===e[1]}function Fst(t,e){var n=!1;return Vd(t,function(r){Vd(e,function(i){if(n===!0)return!0;n=!Ost(r.geometry,i.geometry)})}),n}function kst(t,e,n,r){r===void 0&&(r={});for(var i=[],o=t[0],a=t[1],s=t[2],u=t[3],d=e/ch([o,a],[s,a],r),g=d*(s-o),_=n/ch([o,a],[o,u],r),E=_*(u-a),P=s-o,O=u-a,D=Math.floor(P/g),V=Math.floor(O/E),k=(P-D*g)/2,F=(O-V*E)/2,z=o+k,X=0;X<D;X++){for(var Y=a+F,J=0;J<V;J++){var re=Th([[[z,Y],[z,Y+E],[z+g,Y+E],[z+g,Y],[z,Y]]],r.properties);r.mask?Fst(r.mask,re)&&i.push(re):i.push(re),Y+=E}z+=g}return vf(i)}function pfe(t,e,n){return n===void 0&&(n={}),kst(t,e,e,n)}const rx=Ee.createContext(),zst=({children:t})=>{const[e,n]=Ee.useState({id:"place.77809900",type:"Feature",relevance:1,place_name:"Cupertino, California, United States",bbox:[-122.15257,37.26471,-121.995462,37.340627],center:[-122.03229,37.322893],geometry:{type:"Point",coordinates:[-122.03229,37.322893]}});return Un.jsx(rx.Provider,{value:[e,n],children:t})},HL=Ee.createContext(),Ust=({children:t})=>{const[e,n]=Ee.useState({type:"FeatureCollection",features:[]});return Un.jsx(HL.Provider,{value:[e,n],children:t})};function bE(){return bE=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},bE.apply(this,arguments)}function Gst(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,o;for(o=0;o<r.length;o++)i=r[o],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function b8(t,e){if(t==null)return{};var n=Gst(t,e),r,i;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)r=o[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}var jst=["size","color"];function Vst(t){var e=t.size,n=e===void 0?24:e,r=t.color,i=r===void 0?"currentColor":r,o=b8(t,jst);return ut.createElement("svg",bE({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-trash",width:n,height:n,viewBox:"0 0 24 24",stroke:i,strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},o),ut.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),ut.createElement("line",{x1:"4",y1:"7",x2:"20",y2:"7"}),ut.createElement("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),ut.createElement("line",{x1:"14",y1:"11",x2:"14",y2:"17"}),ut.createElement("path",{d:"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12"}),ut.createElement("path",{d:"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3"}))}var $st=["size","color"];function Hst(t){var e=t.size,n=e===void 0?24:e,r=t.color,i=r===void 0?"currentColor":r,o=b8(t,$st);return ut.createElement("svg",bE({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-world-download",width:n,height:n,viewBox:"0 0 24 24",stroke:i,strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},o),ut.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),ut.createElement("path",{d:"M21 12a9 9 0 1 0 -9 9"}),ut.createElement("path",{d:"M3.6 9h16.8"}),ut.createElement("path",{d:"M3.6 15h8.4"}),ut.createElement("path",{d:"M11.578 3a17 17 0 0 0 0 18"}),ut.createElement("path",{d:"M12.5 3c1.719 2.755 2.5 5.876 2.5 9"}),ut.createElement("path",{d:"M18 14v7m-3 -3l3 3l3 -3"}))}var Wst=["size","color"];function qst(t){var e=t.size,n=e===void 0?24:e,r=t.color,i=r===void 0?"currentColor":r,o=b8(t,Wst);return ut.createElement("svg",bE({xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-world-upload",width:n,height:n,viewBox:"0 0 24 24",stroke:i,strokeWidth:"2",fill:"none",strokeLinecap:"round",strokeLinejoin:"round"},o),ut.createElement("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),ut.createElement("path",{d:"M21 12a9 9 0 1 0 -9 9"}),ut.createElement("path",{d:"M3.6 9h16.8"}),ut.createElement("path",{d:"M3.6 15h8.4"}),ut.createElement("path",{d:"M11.578 3a17 17 0 0 0 0 18"}),ut.createElement("path",{d:"M12.5 3c1.719 2.755 2.5 5.876 2.5 9"}),ut.createElement("path",{d:"M18 21v-7m3 3l-3 -3l-3 3"}))}const eK=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],SN=1,Vb=8;class w8{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[n,r]=new Uint8Array(e,0,2);if(n!==219)throw new Error("Data does not appear to be in a KDBush format.");const i=r>>4;if(i!==SN)throw new Error(`Got v${i} data when expected v${SN}.`);const o=eK[r&15];if(!o)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(e,2,1),[s]=new Uint32Array(e,4,1);return new w8(s,a,o,e)}constructor(e,n=64,r=Float64Array,i){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+n,2),65535),this.ArrayType=r,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const o=eK.indexOf(this.ArrayType),a=e*2*this.ArrayType.BYTES_PER_ELEMENT,s=e*this.IndexArrayType.BYTES_PER_ELEMENT,u=(8-s%8)%8;if(o<0)throw new Error(`Unexpected typed array class: ${r}.`);i&&i instanceof ArrayBuffer?(this.data=i,this.ids=new this.IndexArrayType(this.data,Vb,e),this.coords=new this.ArrayType(this.data,Vb+s+u,e*2),this._pos=e*2,this._finished=!0):(this.data=new ArrayBuffer(Vb+a+s+u),this.ids=new this.IndexArrayType(this.data,Vb,e),this.coords=new this.ArrayType(this.data,Vb+s+u,e*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(SN<<4)+o]),new Uint16Array(this.data,2,1)[0]=n,new Uint32Array(this.data,4,1)[0]=e)}add(e,n){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=e,this.coords[this._pos++]=n,r}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return oz(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,n,r,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:a,nodeSize:s}=this,u=[0,o.length-1,0],d=[];for(;u.length;){const g=u.pop()||0,_=u.pop()||0,E=u.pop()||0;if(_-E<=s){for(let V=E;V<=_;V++){const k=a[2*V],F=a[2*V+1];k>=e&&k<=r&&F>=n&&F<=i&&d.push(o[V])}continue}const P=E+_>>1,O=a[2*P],D=a[2*P+1];O>=e&&O<=r&&D>=n&&D<=i&&d.push(o[P]),(g===0?e<=O:n<=D)&&(u.push(E),u.push(P-1),u.push(1-g)),(g===0?r>=O:i>=D)&&(u.push(P+1),u.push(_),u.push(1-g))}return d}within(e,n,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:o,nodeSize:a}=this,s=[0,i.length-1,0],u=[],d=r*r;for(;s.length;){const g=s.pop()||0,_=s.pop()||0,E=s.pop()||0;if(_-E<=a){for(let V=E;V<=_;V++)tK(o[2*V],o[2*V+1],e,n)<=d&&u.push(i[V]);continue}const P=E+_>>1,O=o[2*P],D=o[2*P+1];tK(O,D,e,n)<=d&&u.push(i[P]),(g===0?e-r<=O:n-r<=D)&&(s.push(E),s.push(P-1),s.push(1-g)),(g===0?e+r>=O:n+r>=D)&&(s.push(P+1),s.push(_),s.push(1-g))}return u}}function oz(t,e,n,r,i,o){if(i-r<=n)return;const a=r+i>>1;gfe(t,e,a,r,i,o),oz(t,e,n,r,a-1,1-o),oz(t,e,n,a+1,i,1-o)}function gfe(t,e,n,r,i,o){for(;i>r;){if(i-r>600){const d=i-r+1,g=n-r+1,_=Math.log(d),E=.5*Math.exp(2*_/3),P=.5*Math.sqrt(_*E*(d-E)/d)*(g-d/2<0?-1:1),O=Math.max(r,Math.floor(n-g*E/d+P)),D=Math.min(i,Math.floor(n+(d-g)*E/d+P));gfe(t,e,n,O,D,o)}const a=e[2*n+o];let s=r,u=i;for($b(t,e,r,n),e[2*i+o]>a&&$b(t,e,r,i);s<u;){for($b(t,e,s,u),s++,u--;e[2*s+o]<a;)s++;for(;e[2*u+o]>a;)u--}e[2*r+o]===a?$b(t,e,r,u):(u++,$b(t,e,u,i)),u<=n&&(r=u+1),n<=u&&(i=u-1)}}function $b(t,e,n,r){TN(t,n,r),TN(e,2*n,2*r),TN(e,2*n+1,2*r+1)}function TN(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function tK(t,e,n,r){const i=t-n,o=e-r;return i*i+o*o}const Xst={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:t=>t},nK=Math.fround||(t=>e=>(t[0]=+e,t[0]))(new Float32Array(1)),g0=2,wm=3,CN=4,vm=5,mfe=6;class Zst{constructor(e){this.options=Object.assign(Object.create(Xst),e),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(e){const{log:n,minZoom:r,maxZoom:i}=this.options;n&&console.time("total time");const o=`prepare ${e.length} points`;n&&console.time(o),this.points=e;const a=[];for(let u=0;u<e.length;u++){const d=e[u];if(!d.geometry)continue;const[g,_]=d.geometry.coordinates,E=nK(VT(g)),P=nK($T(_));a.push(E,P,1/0,u,-1,1),this.options.reduce&&a.push(0)}let s=this.trees[i+1]=this._createTree(a);n&&console.timeEnd(o);for(let u=i;u>=r;u--){const d=+Date.now();s=this.trees[u]=this._createTree(this._cluster(s,u)),n&&console.log("z%d: %d clusters in %dms",u,s.numItems,+Date.now()-d)}return n&&console.timeEnd("total time"),this}getClusters(e,n){let r=((e[0]+180)%360+360)%360-180;const i=Math.max(-90,Math.min(90,e[1]));let o=e[2]===180?180:((e[2]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,o=180;else if(r>o){const _=this.getClusters([r,i,180,a],n),E=this.getClusters([-180,i,o,a],n);return _.concat(E)}const s=this.trees[this._limitZoom(n)],u=s.range(VT(r),$T(a),VT(o),$T(i)),d=s.data,g=[];for(const _ of u){const E=this.stride*_;g.push(d[E+vm]>1?rK(d,E,this.clusterProps):this.points[d[E+wm]])}return g}getChildren(e){const n=this._getOriginId(e),r=this._getOriginZoom(e),i="No cluster with the specified id.",o=this.trees[r];if(!o)throw new Error(i);const a=o.data;if(n*this.stride>=a.length)throw new Error(i);const s=this.options.radius/(this.options.extent*Math.pow(2,r-1)),u=a[n*this.stride],d=a[n*this.stride+1],g=o.within(u,d,s),_=[];for(const E of g){const P=E*this.stride;a[P+CN]===e&&_.push(a[P+vm]>1?rK(a,P,this.clusterProps):this.points[a[P+wm]])}if(_.length===0)throw new Error(i);return _}getLeaves(e,n,r){n=n||10,r=r||0;const i=[];return this._appendLeaves(i,e,n,r,0),i}getTile(e,n,r){const i=this.trees[this._limitZoom(e)],o=Math.pow(2,e),{extent:a,radius:s}=this.options,u=s/a,d=(r-u)/o,g=(r+1+u)/o,_={features:[]};return this._addTileFeatures(i.range((n-u)/o,d,(n+1+u)/o,g),i.data,n,r,o,_),n===0&&this._addTileFeatures(i.range(1-u/o,d,1,g),i.data,o,r,o,_),n===o-1&&this._addTileFeatures(i.range(0,d,u/o,g),i.data,-1,r,o,_),_.features.length?_:null}getClusterExpansionZoom(e){let n=this._getOriginZoom(e)-1;for(;n<=this.options.maxZoom;){const r=this.getChildren(e);if(n++,r.length!==1)break;e=r[0].properties.cluster_id}return n}_appendLeaves(e,n,r,i,o){const a=this.getChildren(n);for(const s of a){const u=s.properties;if(u&&u.cluster?o+u.point_count<=i?o+=u.point_count:o=this._appendLeaves(e,u.cluster_id,r,i,o):o<i?o++:e.push(s),e.length===r)break}return o}_createTree(e){const n=new w8(e.length/this.stride|0,this.options.nodeSize,Float32Array);for(let r=0;r<e.length;r+=this.stride)n.add(e[r],e[r+1]);return n.finish(),n.data=e,n}_addTileFeatures(e,n,r,i,o,a){for(const s of e){const u=s*this.stride,d=n[u+vm]>1;let g,_,E;if(d)g=Afe(n,u,this.clusterProps),_=n[u],E=n[u+1];else{const D=this.points[n[u+wm]];g=D.properties;const[V,k]=D.geometry.coordinates;_=VT(V),E=$T(k)}const P={type:1,geometry:[[Math.round(this.options.extent*(_*o-r)),Math.round(this.options.extent*(E*o-i))]],tags:g};let O;d||this.options.generateId?O=n[u+wm]:O=this.points[n[u+wm]].id,O!==void 0&&(P.id=O),a.features.push(P)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,n){const{radius:r,extent:i,reduce:o,minPoints:a}=this.options,s=r/(i*Math.pow(2,n)),u=e.data,d=[],g=this.stride;for(let _=0;_<u.length;_+=g){if(u[_+g0]<=n)continue;u[_+g0]=n;const E=u[_],P=u[_+1],O=e.within(u[_],u[_+1],s),D=u[_+vm];let V=D;for(const k of O){const F=k*g;u[F+g0]>n&&(V+=u[F+vm])}if(V>D&&V>=a){let k=E*D,F=P*D,z,X=-1;const Y=((_/g|0)<<5)+(n+1)+this.points.length;for(const J of O){const re=J*g;if(u[re+g0]<=n)continue;u[re+g0]=n;const ue=u[re+vm];k+=u[re]*ue,F+=u[re+1]*ue,u[re+CN]=Y,o&&(z||(z=this._map(u,_,!0),X=this.clusterProps.length,this.clusterProps.push(z)),o(z,this._map(u,re)))}u[_+CN]=Y,d.push(k/V,F/V,1/0,Y,-1,V),o&&d.push(X)}else{for(let k=0;k<g;k++)d.push(u[_+k]);if(V>1)for(const k of O){const F=k*g;if(!(u[F+g0]<=n)){u[F+g0]=n;for(let z=0;z<g;z++)d.push(u[F+z])}}}}return d}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,n,r){if(e[n+vm]>1){const a=this.clusterProps[e[n+mfe]];return r?Object.assign({},a):a}const i=this.points[e[n+wm]].properties,o=this.options.map(i);return r&&o===i?Object.assign({},o):o}}function rK(t,e,n){return{type:"Feature",id:t[e+wm],properties:Afe(t,e,n),geometry:{type:"Point",coordinates:[Yst(t[e]),Qst(t[e+1])]}}}function Afe(t,e,n){const r=t[e+vm],i=r>=1e4?`${Math.round(r/1e3)}k`:r>=1e3?`${Math.round(r/100)/10}k`:r,o=t[e+mfe],a=o===-1?{}:Object.assign({},n[o]);return Object.assign(a,{cluster:!0,cluster_id:t[e+wm],point_count:r,point_count_abbreviated:i})}function VT(t){return t/360+.5}function $T(t){const e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function Yst(t){return(t-.5)*360}function Qst(t){const e=(180-t*360)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}const Kst="pk.eyJ1IjoicHY1NjY3IiwiYSI6ImNsZGFtOHVoejBiZ2Mzb3A2djgyaDl1OGEifQ.FSssERk7wLiG1fDpen0iXA";function Jst(){const[t,e]=Ee.useContext(HL),[n,r]=Ee.useState("analysis"),[i,o]=Ee.useState(()=>Hp.DrawPolygonMode),[a,s]=Ee.useState([]),[u,d]=J4(!1),[g,_]=J4(!1),[E,P]=Ee.useState(!1),[O,D]=Ee.useState([]),[V,k]=Ee.useState(0),[F,z]=Ee.useState(0),X=Ee.useContext(rx)[0],Y={latitude:X.center[1],longitude:X.center[0],zoom:14,pitch:0,bearing:0,transitionDuration:5e3,transitionInterpolator:new pre},J=Ee.useRef(null),re=()=>{var be;(be=J.current)==null||be.scrollIntoView({behavior:"smooth"})};Ee.useEffect(()=>{re()},[E]);function ue(){P(!0),fetch("https://api.pvirupaksha.com/detect",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(be){if(be.ok)P(!1),be.json().then(function(De){console.log(typeof JSON.parse(De));const Re=JSON.parse(De).features;D(Re),k(Re.length),e({type:"FeatureCollection",features:[]}),console.log(Re),o(()=>Hp.ViewMode),r("view")});else throw P(!1),console.log(be),d.open(),Error("Something went wrong")}).catch(be=>{throw P(!1),console.log(be),d.open(),Error("Something went wrong")})}function ie(be){return{type:"FeatureCollection",features:be}}function ce(){const be=ie(O),De="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(be)),Re=document.createElement("a");Re.href=De,Re.download="panels.json",document.body.appendChild(Re),Re.click()}function se(be){return(h4(be)/Math.pow(1e3,2)).toFixed(2)}function me(){n=="view"?(o(()=>Hp.DrawPolygonMode),r("analysis")):(r("view"),o(()=>Hp.ViewMode))}function Ce({zoom:be}){if(O.length==0)return O;if(be<16){const De=new Zst({radius:60,maxZoom:16});De.load(O),console.log(De.trees);const Re=De.getClusters({bounds:[-180,-90,180,90],zoom:5});return console.log("clusters triggered"),console.log(Re),Re}return O}const we=be=>{var De=be.zoom;console.log("handleViewStateChange triggered");const Re=Ce({zoom:De});D(Re)},Ye=new EA({id:"poly-layers",data:O,pickable:!0,filled:!0,extruded:!0,wireframe:!0,getPolygon:be=>be.geometry.coordinates,getFillColor:[255,0,0],getLineColor:[168,85,247],getLineWidth:.3,getElevation:1,_normalize:!0}),at=new uoe.EditableGeoJsonLayer({id:"geojson-layer",data:t,mode:i,selectedFeatureIndexes:a,onEdit:({updatedData:be})=>{console.log(be);const De={units:"kilometers",mask:be},Re=pfe(j0(G6(be,.06)),.12,De);console.log("New Data:"),console.log(Re),Re.features.length>900&&_.open(),e(Re)}});let yt;return Ee.useEffect(()=>(E?yt=setInterval(()=>{z(be=>{if(be==="Almost Done...")return"Almost Done...";const De=be+Math.round(100/t.features.length);return De>=100?"Almost Done...":De})},2005):(console.log("Clearing Interval"),z(0),clearInterval(yt)),()=>{clearInterval(yt)}),[E,t.features.length]),Ee.useEffect(()=>{F===100&&E&&(z("Almost Done..."),P(!1),clearInterval(yt))},[F,E]),Un.jsxs(Un.Fragment,{children:[Un.jsx(Qd,{size:"xl",opened:u,onClose:d.close,withCloseButton:!1,centered:!0,children:Un.jsx(Vy,{position:"center",direction:"row",spacing:"xs",children:"Oops! Something went wrong. A quick refresh should fix it."})}),Un.jsx(Qd,{size:"xl",opened:g,onClose:_.close,withCloseButton:!1,centered:!0,children:Un.jsx(Vy,{position:"center",direction:"row",spacing:"xs",children:"Please reduce the size of your selection."})}),Un.jsx("div",{children:Un.jsx(y8,{children:Un.jsxs(x8,{spacing:"lg",children:[Un.jsx(go,{sx:{width:"50em",height:"50em",m:4,borderRadius:4,position:"relative"},className:"ml-auto mr-auto",children:Un.jsx(HCe,{initialViewState:Y,controller:{doubleClickZoom:!1},id:"deck-gl",layers:[Ye,at],getCursor:at.getCursor.bind(at),getTooltip:i===Hp.ViewMode?({object:be})=>be&&`Area: ${h4(be).toFixed(3)} m
Lon: ${be.geometry.coordinates[0][0][0].toFixed(4)}
Lat: ${be.geometry.coordinates[0][0][1].toFixed(4)}`:null,onViewStateChange:be=>we(be.viewState),children:Un.jsx(QO,{id:"map",controller:!1,width:"100%",height:"100%",children:Un.jsx(LXe,{mapStyle:"mapbox://styles/mapbox/satellite-v9",mapboxAccessToken:Kst})})})}),t.features.length>0&&Un.jsxs(Vy,{position:"center",direction:"row",spacing:"xs",children:[Un.jsxs(PP,{order:4,c:"white",children:["Area: ",se(t)," km"]}),Un.jsxs("button",{type:"button",class:`inline-flex items-center py-2 text-white 
        text-md font-medium rounded-md gap-1 hover:text-red-500 p-1 outline focus:outline-none focus:ring focus:ring-red`,onClick:()=>e({type:"FeatureCollection",features:[]}),children:["Clear Selection",Un.jsx(Vst,{size:20})]})]}),Un.jsx(Vy,{position:"center",direction:"row",spacing:"xs",children:Un.jsx(ufe,{value:n,onChange:me,data:[{label:"Select Mode",value:"analysis"},{label:"View Mode",value:"view"}]})}),n==="analysis"&&Un.jsx(Un.Fragment,{children:Un.jsx("button",{class:"bg-purple-400 hover:bg-purple-500 text-white font-bold py-2 px-4 rounded disabled:opacity-75 disabled:hover:bg-blue-500",disabled:t.features.length>900,onClick:ue,children:"Submit Selection"})}),E&&Un.jsxs("div",{class:"p-6 space-y-4",ref:J,children:[Un.jsx(sfe,{value:F,label:F+"%",size:"xl",radius:"xl"}),Un.jsx(Vy,{position:"center",direction:"row",spacing:"xs",children:Un.jsx(PP,{order:4,c:"white",children:"Detecting Solar Panels..."})})]}),V>0&&Un.jsxs(Un.Fragment,{children:[Un.jsxs(PP,{style:{color:"#e8caf1"},children:[V," Panels Found"]}),Un.jsx("div",{class:"max-w-6xl mx-auto pb-16",children:Un.jsxs("button",{type:"button",class:"inline-flex items-center px-4 py-2 text-white text-md font-medium rounded-md gap-2.5 outline outline-1 hover:outline-blue-400 focus:outline-none focus:ring focus:ring-violet-300",onClick:ce,children:[Un.jsx(Hst,{size:20}),"Download Panel GeoJSON"]})})]})]})})})]})}var _fe={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(Ya,function(){var n,r,i;function o(s,u){if(!n)n=u;else if(!r)r=u;else{var d="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk); self.onerror = null;",g={};n(g),i=u(g),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(i.workerUrl=window.URL.createObjectURL(new Blob([d],{type:"text/javascript"})))}}o(["exports"],function(s){var u=typeof self<"u"?self:{},d="2.15.0";let g;const _={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(g==null){const c=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{g={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):c}catch{g=c}}return g},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!_.API_URL)return null;try{const c=new URL(_.API_URL);return c.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":c.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},E={supported:!1,testSupport:function(c){!D&&O&&(V?k(c):P=c)}};let P,O,D=!1,V=!1;function k(c){const l=c.createTexture();c.bindTexture(c.TEXTURE_2D,l);try{if(c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,O),c.isContextLost())return;E.supported=!0}catch{}c.deleteTexture(l),D=!0}u.document&&(O=u.document.createElement("img"),O.onload=function(){P&&k(P),P=null,V=!0},O.onerror=function(){D=!0,P=null},O.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const F="01";function z(c){return c&&c.__esModule&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c}var X=Y;function Y(c,l,f,p){this.cx=3*c,this.bx=3*(f-c)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(p-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=c,this.p1y=l,this.p2x=f,this.p2y=p}Y.prototype={sampleCurveX:function(c){return((this.ax*c+this.bx)*c+this.cx)*c},sampleCurveY:function(c){return((this.ay*c+this.by)*c+this.cy)*c},sampleCurveDerivativeX:function(c){return(3*this.ax*c+2*this.bx)*c+this.cx},solveCurveX:function(c,l){if(l===void 0&&(l=1e-6),c<0)return 0;if(c>1)return 1;for(var f=c,p=0;p<8;p++){var A=this.sampleCurveX(f)-c;if(Math.abs(A)<l)return f;var b=this.sampleCurveDerivativeX(f);if(Math.abs(b)<1e-6)break;f-=A/b}var C=0,M=1;for(f=c,p=0;p<20&&(A=this.sampleCurveX(f),!(Math.abs(A-c)<l));p++)c>A?C=f:M=f,f=.5*(M-C)+C;return f},solve:function(c,l){return this.sampleCurveY(this.solveCurveX(c,l))}};var J=z(X),re=ue;function ue(c,l){this.x=c,this.y=l}ue.prototype={clone:function(){return new ue(this.x,this.y)},add:function(c){return this.clone()._add(c)},sub:function(c){return this.clone()._sub(c)},multByPoint:function(c){return this.clone()._multByPoint(c)},divByPoint:function(c){return this.clone()._divByPoint(c)},mult:function(c){return this.clone()._mult(c)},div:function(c){return this.clone()._div(c)},rotate:function(c){return this.clone()._rotate(c)},rotateAround:function(c,l){return this.clone()._rotateAround(c,l)},matMult:function(c){return this.clone()._matMult(c)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(c){return this.x===c.x&&this.y===c.y},dist:function(c){return Math.sqrt(this.distSqr(c))},distSqr:function(c){var l=c.x-this.x,f=c.y-this.y;return l*l+f*f},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(c){return Math.atan2(this.y-c.y,this.x-c.x)},angleWith:function(c){return this.angleWithSep(c.x,c.y)},angleWithSep:function(c,l){return Math.atan2(this.x*l-this.y*c,this.x*c+this.y*l)},_matMult:function(c){var l=c[2]*this.x+c[3]*this.y;return this.x=c[0]*this.x+c[1]*this.y,this.y=l,this},_add:function(c){return this.x+=c.x,this.y+=c.y,this},_sub:function(c){return this.x-=c.x,this.y-=c.y,this},_mult:function(c){return this.x*=c,this.y*=c,this},_div:function(c){return this.x/=c,this.y/=c,this},_multByPoint:function(c){return this.x*=c.x,this.y*=c.y,this},_divByPoint:function(c){return this.x/=c.x,this.y/=c.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var c=this.y;return this.y=this.x,this.x=-c,this},_rotate:function(c){var l=Math.cos(c),f=Math.sin(c),p=f*this.x+l*this.y;return this.x=l*this.x-f*this.y,this.y=p,this},_rotateAround:function(c,l){var f=Math.cos(c),p=Math.sin(c),A=l.y+p*(this.x-l.x)+f*(this.y-l.y);return this.x=l.x+f*(this.x-l.x)-p*(this.y-l.y),this.y=A,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},ue.convert=function(c){return c instanceof ue?c:Array.isArray(c)?new ue(c[0],c[1]):c};var ie=z(re);const ce=Math.PI/180,se=180/Math.PI;function me(c){return c*ce}function Ce(c){return c*se}const we=[[0,0],[1,0],[1,1],[0,1]];function Ye(c){if(c<=0)return 0;if(c>=1)return 1;const l=c*c,f=l*c;return 4*(c<.5?f:3*(c-l)+f-.75)}function at(c,l,f,p){const A=new J(c,l,f,p);return function(b){return A.solve(b)}}const yt=at(.25,.1,.25,1);function be(c,l,f){return Math.min(f,Math.max(l,c))}function De(c,l,f){return(f=be((f-c)/(l-c),0,1))*f*(3-2*f)}function Re(c,l,f){const p=f-l,A=((c-l)%p+p)%p+l;return A===l?f:A}function qe(c,l,f){if(!c.length)return f(null,[]);let p=c.length;const A=new Array(c.length);let b=null;c.forEach((C,M)=>{l(C,(N,U)=>{N&&(b=N),A[M]=U,--p==0&&f(b,A)})})}function ct(c){const l=[];for(const f in c)l.push(c[f]);return l}function Ct(c,...l){for(const f of l)for(const p in f)c[p]=f[p];return c}let Dt=1;function In(){return Dt++}function Mn(){return function c(l){return l?(l^Math.random()*(16>>l/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,c)}()}function Tn(c){return c<=1?1:Math.pow(2,Math.ceil(Math.log(c)/Math.LN2))}function Nt(c){return!!c&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(c)}function Zt(c,l){c.forEach(f=>{l[f]&&(l[f]=l[f].bind(l))})}function Wt(c,l){return c.indexOf(l,c.length-l.length)!==-1}function hn(c,l,f){const p={};for(const A in c)p[A]=l.call(f||this,c[A],A,c);return p}function lr(c,l,f){const p={};for(const A in c)l.call(f||this,c[A],A,c)&&(p[A]=c[A]);return p}function It(c){return Array.isArray(c)?c.map(It):typeof c=="object"&&c?hn(c,It):c}const Xt={};function $t(c){Xt[c]||(typeof console<"u"&&console.warn(c),Xt[c]=!0)}function cn(c,l,f){return(f.y-c.y)*(l.x-c.x)>(l.y-c.y)*(f.x-c.x)}function Jt(c){let l=0;for(let f,p,A=0,b=c.length,C=b-1;A<b;C=A++)f=c[A],p=c[C],l+=(p.x-f.x)*(f.y+p.y);return l}function Ln(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function qn(c){const l={};if(c.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(f,p,A,b)=>{const C=A||b;return l[p]=!C||C.toLowerCase(),""}),l["max-age"]){const f=parseInt(l["max-age"],10);isNaN(f)?delete l["max-age"]:l["max-age"]=f}return l}let or=null;function cr(c){if(or==null){const l=c.navigator?c.navigator.userAgent:null;or=!!c.safari||!(!l||!(/\b(iPad|iPhone|iPod)\b/.test(l)||l.match("Safari")&&!l.match("Chrome")))}return or}function cs(c){try{const l=u[c];return l.setItem("_mapbox_test_",1),l.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ri(c,l){return[c[4*l],c[4*l+1],c[4*l+2],c[4*l+3]]}const Do="mapbox-tiles";let Fa=500,Nl=50,_s,mo;function Fl(){try{return u.caches}catch{}}function su(){Fl()&&!_s&&(_s=u.caches.open(Do))}function kl(c){const l=c.indexOf("?");if(l<0)return c;const f=function(A){const b=A.indexOf("?");return b>0?A.slice(b+1).split("&"):[]}(c),p=f.filter(A=>{const b=A.split("=");return b[0]==="language"||b[0]==="worldview"});return p.length?`${c.slice(0,l)}?${p.join("&")}`:c.slice(0,l)}let au=1/0;const $u={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze($u);class lu extends Error{constructor(l,f,p){f===401&&ht(p)&&(l+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(l),this.status=f,this.url=p}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Hu=Ln()?()=>self.worker&&self.worker.referrer:()=>(u.location.protocol==="blob:"?u.parent:u).location.href,uu=function(c,l){if(!(/^file:/.test(f=c.url)||/^file:/.test(Hu())&&!/^\w+:/.test(f))){if(u.fetch&&u.Request&&u.AbortController&&u.Request.prototype.hasOwnProperty("signal"))return function(p,A){const b=new u.AbortController,C=new u.Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:Hu(),referrerPolicy:p.referrerPolicy,signal:b.signal});let M=!1,N=!1;const U=(W=C.url).indexOf("sku=")>0&&ht(W);var W;p.type==="json"&&C.headers.set("Accept","application/json");const K=(oe,le,de)=>{if(N)return;if(oe&&oe.message!=="SecurityError"&&$t(oe.toString()),le&&de)return ee(le);const xe=Date.now();u.fetch(C).then(Be=>{if(Be.ok){const $e=U?Be.clone():null;return ee(Be,$e,xe)}return A(new lu(Be.statusText,Be.status,p.url))}).catch(Be=>{Be.name!=="AbortError"&&A(new Error(`${Be.message} ${p.url}`))})},ee=(oe,le,de)=>{(p.type==="arrayBuffer"?oe.arrayBuffer():p.type==="json"?oe.json():oe.text()).then(xe=>{N||(le&&de&&function(Be,$e,Ne){if(su(),!_s)return;const je={status:$e.status,statusText:$e.statusText,headers:new u.Headers};$e.headers.forEach((bt,At)=>je.headers.set(At,bt));const Ze=qn($e.headers.get("Cache-Control")||"");if(Ze["no-store"])return;Ze["max-age"]&&je.headers.set("Expires",new Date(Ne+1e3*Ze["max-age"]).toUTCString());const We=je.headers.get("Expires");We&&(new Date(We).getTime()-Ne<42e4||function(bt,At){if(mo===void 0)try{new Response(new ReadableStream),mo=!0}catch{mo=!1}mo?At(bt.body):bt.blob().then(At)}($e,bt=>{const At=new u.Response(bt,je);su(),_s&&_s.then(Ft=>Ft.put(kl(Be.url),At)).catch(Ft=>$t(Ft.message))}))}(C,le,de),M=!0,A(null,xe,oe.headers.get("Cache-Control"),oe.headers.get("Expires")))}).catch(xe=>{N||A(new Error(xe.message))})};return U?function(oe,le){if(su(),!_s)return le(null);const de=kl(oe.url);_s.then(xe=>{xe.match(de).then(Be=>{const $e=function(Ne){if(!Ne)return!1;const je=new Date(Ne.headers.get("Expires")||0),Ze=qn(Ne.headers.get("Cache-Control")||"");return je>Date.now()&&!Ze["no-cache"]}(Be);xe.delete(de),$e&&xe.put(de,Be.clone()),le(null,Be,$e)}).catch(le)}).catch(le)}(C,K):K(null,null),{cancel:()=>{N=!0,M||b.abort()}}}(c,l);if(Ln()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",c,l,void 0,!0)}var f;return function(p,A){const b=new u.XMLHttpRequest;b.open(p.method||"GET",p.url,!0),p.type==="arrayBuffer"&&(b.responseType="arraybuffer");for(const C in p.headers)b.setRequestHeader(C,p.headers[C]);return p.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=p.credentials==="include",b.onerror=()=>{A(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let C=b.response;if(p.type==="json")try{C=JSON.parse(b.response)}catch(M){return A(M)}A(null,C,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else A(new lu(b.statusText,b.status,p.url))},b.send(p.body),{cancel:()=>b.abort()}}(c,l)},Fc=function(c,l){return uu(Ct(c,{type:"arrayBuffer"}),l)};function Wu(c){const l=u.document.createElement("a");return l.href=c,l.protocol===u.document.location.protocol&&l.host===u.document.location.host}const Ge="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ge,Ae;ge=[],Ae=0;const ze=function(c,l){if(E.supported&&(c.headers||(c.headers={}),c.headers.accept="image/webp,*/*"),Ae>=_.MAX_PARALLEL_IMAGE_REQUESTS){const b={requestParameters:c,callback:l,cancelled:!1,cancel(){this.cancelled=!0}};return ge.push(b),b}Ae++;let f=!1;const p=()=>{if(!f)for(f=!0,Ae--;ge.length&&Ae<_.MAX_PARALLEL_IMAGE_REQUESTS;){const b=ge.shift(),{requestParameters:C,callback:M,cancelled:N}=b;N||(b.cancel=ze(C,M).cancel)}},A=Fc(c,(b,C,M,N)=>{p(),b?l(b):C&&(u.createImageBitmap?function(U,W){const K=new u.Blob([new Uint8Array(U)],{type:"image/png"});u.createImageBitmap(K).then(ee=>{W(null,ee)}).catch(ee=>{W(new Error(`Could not load image because of ${ee.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(C,(U,W)=>l(U,W,M,N)):function(U,W){const K=new u.Image,ee=u.URL;K.onload=()=>{W(null,K),ee.revokeObjectURL(K.src),K.onload=null,u.requestAnimationFrame(()=>{K.src=Ge})},K.onerror=()=>W(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const oe=new u.Blob([new Uint8Array(U)],{type:"image/png"});K.src=U.byteLength?ee.createObjectURL(oe):Ge}(C,(U,W)=>l(U,W,M,N)))});return{cancel:()=>{A.cancel(),p()}}},Me="NO_ACCESS_TOKEN";function rt(c){return c.indexOf("mapbox:")===0}function ht(c){return _.API_URL_REGEX.test(c)}function ft(c){return _.API_CDN_URL_REGEX.test(c)}function nt(c){return _.API_STYLE_REGEX.test(c)&&!wt(c)}function wt(c){return _.API_SPRITE_REGEX.test(c)}const sn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function dn(c){const l=c.match(sn);if(!l)throw new Error("Unable to parse URL object");return{protocol:l[1],authority:l[2],path:l[3]||"/",params:l[4]?l[4].split("&"):[]}}function Qt(c){const l=c.params.length?`?${c.params.join("&")}`:"";return`${c.protocol}://${c.authority}${c.path}${l}`}const sr="mapbox.eventData";function pr(c){if(!c)return null;const l=c.split(".");if(!l||l.length!==3)return null;try{return JSON.parse(decodeURIComponent(u.atob(l[1]).split("").map(f=>"%"+("00"+f.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class tr{constructor(l){this.type=l,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(l){const f=pr(_.ACCESS_TOKEN);let p="";return p=f&&f.u?u.btoa(encodeURIComponent(f.u).replace(/%([0-9A-F]{2})/g,(A,b)=>String.fromCharCode(+("0x"+b)))):_.ACCESS_TOKEN||"",l?`${sr}.${l}:${p}`:`${sr}:${p}`}fetchEventData(){const l=cs("localStorage"),f=this.getStorageKey(),p=this.getStorageKey("uuid");if(l)try{const A=u.localStorage.getItem(f);A&&(this.eventData=JSON.parse(A));const b=u.localStorage.getItem(p);b&&(this.anonId=b)}catch{$t("Unable to read from LocalStorage")}}saveEventData(){const l=cs("localStorage"),f=this.getStorageKey(),p=this.getStorageKey("uuid");if(l)try{u.localStorage.setItem(p,this.anonId),Object.keys(this.eventData).length>=1&&u.localStorage.setItem(f,JSON.stringify(this.eventData))}catch{$t("Unable to write to LocalStorage")}}processRequests(l){}postEvent(l,f,p,A){if(!_.EVENTS_URL)return;const b=dn(_.EVENTS_URL);b.params.push(`access_token=${A||_.ACCESS_TOKEN||""}`);const C={event:this.type,created:new Date(l).toISOString()},M=f?Ct(C,f):C,N={url:Qt(b),headers:{"Content-Type":"text/plain"},body:JSON.stringify([M])};this.pendingRequest=function(U,W){return uu(Ct(U,{method:"POST"}),W)}(N,U=>{this.pendingRequest=null,p(U),this.saveEventData(),this.processRequests(A)})}queueRequest(l,f){this.queue.push(l),this.processRequests(f)}}const ot=new class extends tr{constructor(c){super("appUserTurnstile"),this._customAccessToken=c}postTurnstileEvent(c,l){_.EVENTS_URL&&_.ACCESS_TOKEN&&Array.isArray(c)&&c.some(f=>rt(f)||ht(f))&&this.queueRequest(Date.now(),l)}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const l=pr(_.ACCESS_TOKEN),f=l?l.u:_.ACCESS_TOKEN;let p=f!==this.eventData.tokenU;Nt(this.anonId)||(this.anonId=Mn(),p=!0);const A=this.queue.shift();if(this.eventData.lastSuccess){const b=new Date(this.eventData.lastSuccess),C=new Date(A),M=(A-this.eventData.lastSuccess)/864e5;p=p||M>=1||M<-1||b.getDate()!==C.getDate()}else p=!0;p?this.postEvent(A,{sdkIdentifier:"mapbox-gl-js",sdkVersion:d,skuId:F,"enabled.telemetry":!1,userId:this.anonId},b=>{b||(this.eventData.lastSuccess=A,this.eventData.tokenU=f)},c):this.processRequests()}},Pt=ot.postTurnstileEvent.bind(ot),rn=new class extends tr{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(c,l,f,p){this.skuToken=l,this.errorCb=p,_.EVENTS_URL&&(f||_.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},f):this.errorCb(new Error(Me)))}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{id:l,timestamp:f}=this.queue.shift();l&&this.success[l]||(this.anonId||this.fetchEventData(),Nt(this.anonId)||(this.anonId=Mn()),this.postEvent(f,{sdkIdentifier:"mapbox-gl-js",sdkVersion:d,skuId:F,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):l&&(this.success[l]=!0)},c))}},Gn=rn.postMapLoadEvent.bind(rn),w=new class extends tr{constructor(){super("gljs.performance")}postPerformanceEvent(c,l){_.EVENTS_URL&&(c||_.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:l},c)}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:l,performanceData:f}=this.queue.shift(),p=function(A){const b=u.performance.getEntriesByType("resource"),C=u.performance.getEntriesByType("mark"),M=function(ee){const oe={};if(ee){for(const le in ee)if(le!=="other")for(const de of ee[le]){const xe=`${le}ResolveRangeMin`,Be=`${le}ResolveRangeMax`,$e=`${le}RequestCount`,Ne=`${le}RequestCachedCount`;oe[xe]=Math.min(oe[xe]||1/0,de.startTime),oe[Be]=Math.max(oe[Be]||-1/0,de.responseEnd);const je=Ze=>{oe[Ze]===void 0&&(oe[Ze]=0),++oe[Ze]};de.transferSize!==void 0&&de.transferSize===0&&je(Ne),je($e)}}return oe}(function(ee,oe){const le={};if(ee)for(const de of ee){const xe=oe(de);le[xe]===void 0&&(le[xe]=[]),le[xe].push(de)}return le}(b,qr)),N=u.devicePixelRatio,U=u.navigator.connection||u.navigator.mozConnection||u.navigator.webkitConnection,W={counters:[],metadata:[],attributes:[]},K=(ee,oe,le)=>{le!=null&&ee.push({name:oe,value:le.toString()})};for(const ee in M)K(W.counters,ee,M[ee]);if(A.interactionRange[0]!==1/0&&A.interactionRange[1]!==-1/0&&(K(W.counters,"interactionRangeMin",A.interactionRange[0]),K(W.counters,"interactionRangeMax",A.interactionRange[1])),C)for(const ee of Object.keys(Tr)){const oe=Tr[ee],le=C.find(de=>de.name===oe);le&&K(W.counters,oe,le.startTime)}return K(W.counters,"visibilityHidden",A.visibilityHidden),K(W.attributes,"style",function(ee){if(ee)for(const oe of ee){const le=oe.name.split("?")[0];if(nt(le)){const de=le.split("/").slice(-2);if(de.length===2)return`mapbox://styles/${de[0]}/${de[1]}`}}}(b)),K(W.attributes,"terrainEnabled",A.terrainEnabled?"true":"false"),K(W.attributes,"fogEnabled",A.fogEnabled?"true":"false"),K(W.attributes,"projection",A.projection),K(W.attributes,"zoom",A.zoom),K(W.metadata,"devicePixelRatio",N),K(W.metadata,"connectionEffectiveType",U?U.effectiveType:void 0),K(W.metadata,"navigatorUserAgent",u.navigator.userAgent),K(W.metadata,"screenWidth",u.screen.width),K(W.metadata,"screenHeight",u.screen.height),K(W.metadata,"windowWidth",u.innerWidth),K(W.metadata,"windowHeight",u.innerHeight),K(W.metadata,"mapWidth",A.width/N),K(W.metadata,"mapHeight",A.height/N),K(W.metadata,"webglRenderer",A.renderer),K(W.metadata,"webglVendor",A.vendor),K(W.metadata,"sdkVersion",d),K(W.metadata,"sdkIdentifier","mapbox-gl-js"),W}(f);for(const A of p.metadata);for(const A of p.counters);for(const A of p.attributes);this.postEvent(l,p,()=>{},c)}},Ue=w.postPerformanceEvent.bind(w),Ir=new class extends tr{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(c,l,f,p){if(!_.API_URL||!_.SESSION_PATH)return;const A=dn(_.API_URL+_.SESSION_PATH);A.params.push(`sku=${l||""}`),A.params.push(`access_token=${p||_.ACCESS_TOKEN||""}`);const b={url:Qt(A),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(C,M){return uu(Ct(C,{method:"GET"}),M)}(b,C=>{this.pendingRequest=null,f(C),this.saveEventData(),this.processRequests(p)})}getSessionAPI(c,l,f,p){this.skuToken=l,this.errorCb=p,_.SESSION_PATH&&_.API_URL&&(f||_.ACCESS_TOKEN?this.queueRequest({id:c,timestamp:Date.now()},f):this.errorCb(new Error(Me)))}processRequests(c){if(this.pendingRequest||this.queue.length===0)return;const{id:l,timestamp:f}=this.queue.shift();l&&this.success[l]||this.getSession(f,this.skuToken,p=>{p?this.errorCb(p):l&&(this.success[l]=!0)},c)}},fr=Ir.getSessionAPI.bind(Ir),rr=new Set,Tr={create:"create",load:"load",fullLoad:"fullLoad"},qi={mark(c){u.performance.mark(c)},measure(c,l,f){u.performance.measure(c,l,f)}};function qr(c){const l=c.name.split("?")[0];return ft(l)&&l.includes("mapbox-gl.js")?"javascript":ft(l)&&l.includes("mapbox-gl.css")?"css":function(f){return _.API_FONTS_REGEX.test(f)}(l)?"fontRange":wt(l)?"sprite":nt(l)?"style":function(f){return _.API_TILEJSON_REGEX.test(f)}(l)?"tilejson":"other"}const jn=u.performance;function ro(c){const l=c?c.url.toString():void 0;return jn.getEntriesByName(l)}let ca,kc,zl,Qr;const Vo={now:()=>zl!==void 0?zl:u.performance.now(),setNow(c){zl=c},restoreNow(){zl=void 0},frame(c){const l=u.requestAnimationFrame(c);return{cancel:()=>u.cancelAnimationFrame(l)}},getImageData(c,l=0){const{width:f,height:p}=c;Qr||(Qr=u.document.createElement("canvas"));const A=Qr.getContext("2d",{willReadFrequently:!0});if(!A)throw new Error("failed to create canvas 2d context");return(f>Qr.width||p>Qr.height)&&(Qr.width=f,Qr.height=p),A.clearRect(-l,-l,f+2*l,p+2*l),A.drawImage(c,0,0,f,p),A.getImageData(-l,-l,f+2*l,p+2*l)},resolveURL:c=>(ca||(ca=u.document.createElement("a")),ca.href=c,ca.href),get devicePixelRatio(){return u.devicePixelRatio},get prefersReducedMotion(){return!!u.matchMedia&&(kc==null&&(kc=u.matchMedia("(prefers-reduced-motion: reduce)")),kc.matches)}};function Bo(c,l,f){f[c]&&f[c].indexOf(l)!==-1||(f[c]=f[c]||[],f[c].push(l))}function ka(c,l,f){if(f&&f[c]){const p=f[c].indexOf(l);p!==-1&&f[c].splice(p,1)}}class $o{constructor(l,f={}){Ct(this,f),this.type=l}}class Hn extends $o{constructor(l,f={}){super("error",Ct({error:l},f))}}class Ke{on(l,f){return this._listeners=this._listeners||{},Bo(l,f,this._listeners),this}off(l,f){return ka(l,f,this._listeners),ka(l,f,this._oneTimeListeners),this}once(l,f){return f?(this._oneTimeListeners=this._oneTimeListeners||{},Bo(l,f,this._oneTimeListeners),this):new Promise(p=>this.once(l,p))}fire(l,f){typeof l=="string"&&(l=new $o(l,f||{}));const p=l.type;if(this.listens(p)){l.target=this;const A=this._listeners&&this._listeners[p]?this._listeners[p].slice():[];for(const M of A)M.call(this,l);const b=this._oneTimeListeners&&this._oneTimeListeners[p]?this._oneTimeListeners[p].slice():[];for(const M of b)ka(p,M,this._oneTimeListeners),M.call(this,l);const C=this._eventedParent;C&&(Ct(l,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),C.fire(l))}else l instanceof Hn&&console.error(l.error);return this}listens(l){return!!(this._listeners&&this._listeners[l]&&this._listeners[l].length>0||this._oneTimeListeners&&this._oneTimeListeners[l]&&this._oneTimeListeners[l].length>0||this._eventedParent&&this._eventedParent.listens(l))}setEventedParent(l,f){return this._eventedParent=l,this._eventedParentData=f,this}}var pt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function za(c,...l){for(const f of l)for(const p in f)c[p]=f[p];return c}function Vi(c){return c instanceof Number||c instanceof String||c instanceof Boolean?c.valueOf():c}function gi(c){if(Array.isArray(c))return c.map(gi);if(c instanceof Object&&!(c instanceof Number||c instanceof String||c instanceof Boolean)){const l={};for(const f in c)l[f]=gi(c[f]);return l}return Vi(c)}class Nf extends Error{constructor(l,f){super(f),this.message=f,this.key=l}}var fa=Nf;class Ve{constructor(l,f=[]){this.parent=l,this.bindings={};for(const[p,A]of f)this.bindings[p]=A}concat(l){return new Ve(this,l)}get(l){if(this.bindings[l])return this.bindings[l];if(this.parent)return this.parent.get(l);throw new Error(`${l} not found in scope.`)}has(l){return!!this.bindings[l]||!!this.parent&&this.parent.has(l)}}var $h=Ve;const cu={kind:"null"},_n={kind:"number"},ur={kind:"string"},Cr={kind:"boolean"},Os={kind:"color"},Rs={kind:"object"},xr={kind:"value"},ys={kind:"collator"},Ls={kind:"formatted"},ye={kind:"resolvedImage"};function Oe(c,l){return{kind:"array",itemType:c,N:l}}function He(c){if(c.kind==="array"){const l=He(c.itemType);return typeof c.N=="number"?`array<${l}, ${c.N}>`:c.itemType.kind==="value"?"array":`array<${l}>`}return c.kind}const Ot=[cu,_n,ur,Cr,Os,Ls,Rs,Oe(xr),ye];function on(c,l){if(l.kind==="error")return null;if(c.kind==="array"){if(l.kind==="array"&&(l.N===0&&l.itemType.kind==="value"||!on(c.itemType,l.itemType))&&(typeof c.N!="number"||c.N===l.N))return null}else{if(c.kind===l.kind)return null;if(c.kind==="value"){for(const f of Ot)if(!on(f,l))return null}}return`Expected ${He(c)} but found ${He(l)} instead.`}function Fn(c,l){return l.some(f=>f.kind===c.kind)}function Rr(c,l){return l.some(f=>f==="null"?c===null:f==="array"?Array.isArray(c):f==="object"?c&&!Array.isArray(c)&&typeof c=="object":f===typeof c)}var Ao,Lr={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function ao(c){return(c=Math.round(c))<0?0:c>255?255:c}function vs(c){return ao(c[c.length-1]==="%"?parseFloat(c)/100*255:parseInt(c))}function Ig(c){return(l=c[c.length-1]==="%"?parseFloat(c)/100:parseFloat(c))<0?0:l>1?1:l;var l}function Hh(c,l,f){return f<0?f+=1:f>1&&(f-=1),6*f<1?c+(l-c)*f*6:2*f<1?l:3*f<2?c+(l-c)*(2/3-f)*6:c}try{Ao={}.parseCSSColor=function(c){var l,f=c.replace(/ /g,"").toLowerCase();if(f in Lr)return Lr[f].slice();if(f[0]==="#")return f.length===4?(l=parseInt(f.substr(1),16))>=0&&l<=4095?[(3840&l)>>4|(3840&l)>>8,240&l|(240&l)>>4,15&l|(15&l)<<4,1]:null:f.length===7&&(l=parseInt(f.substr(1),16))>=0&&l<=16777215?[(16711680&l)>>16,(65280&l)>>8,255&l,1]:null;var p=f.indexOf("("),A=f.indexOf(")");if(p!==-1&&A+1===f.length){var b=f.substr(0,p),C=f.substr(p+1,A-(p+1)).split(","),M=1;switch(b){case"rgba":if(C.length!==4)return null;M=Ig(C.pop());case"rgb":return C.length!==3?null:[vs(C[0]),vs(C[1]),vs(C[2]),M];case"hsla":if(C.length!==4)return null;M=Ig(C.pop());case"hsl":if(C.length!==3)return null;var N=(parseFloat(C[0])%360+360)%360/360,U=Ig(C[1]),W=Ig(C[2]),K=W<=.5?W*(U+1):W+U-W*U,ee=2*W-K;return[ao(255*Hh(ee,K,N+1/3)),ao(255*Hh(ee,K,N)),ao(255*Hh(ee,K,N-1/3)),M];default:return null}}return null}}catch{}class ha{constructor(l,f,p,A=1){this.r=l,this.g=f,this.b=p,this.a=A}static parse(l){if(!l)return;if(l instanceof ha)return l;if(typeof l!="string")return;const f=Ao(l);return f?new ha(f[0]/255*f[3],f[1]/255*f[3],f[2]/255*f[3],f[3]):void 0}toString(){const[l,f,p,A]=this.toArray();return`rgba(${Math.round(l)},${Math.round(f)},${Math.round(p)},${A})`}toArray(){const{r:l,g:f,b:p,a:A}=this;return A===0?[0,0,0,0]:[255*l/A,255*f/A,255*p/A,A]}toArray01(){const{r:l,g:f,b:p,a:A}=this;return A===0?[0,0,0,0]:[l/A,f/A,p/A,A]}toArray01PremultipliedAlpha(){const{r:l,g:f,b:p,a:A}=this;return[l,f,p,A]}}ha.black=new ha(0,0,0,1),ha.white=new ha(1,1,1,1),ha.transparent=new ha(0,0,0,0),ha.red=new ha(1,0,0,1),ha.blue=new ha(0,0,1,1);var lo=ha;class op{constructor(l,f,p){this.sensitivity=l?f?"variant":"case":f?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(l,f){return this.collator.compare(l,f)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class sp{constructor(l,f,p,A,b){this.text=l.normalize?l.normalize():l,this.image=f,this.scale=p,this.fontStack=A,this.textColor=b}}class da{constructor(l){this.sections=l}static fromString(l){return new da([new sp(l,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(l=>l.text.length!==0||l.image&&l.image.name.length!==0)}static factory(l){return l instanceof da?l:da.fromString(l)}toString(){return this.sections.length===0?"":this.sections.map(l=>l.text).join("")}serialize(){const l=["format"];for(const f of this.sections){if(f.image){l.push(["image",f.image.name]);continue}l.push(f.text);const p={};f.fontStack&&(p["text-font"]=["literal",f.fontStack.split(",")]),f.scale&&(p["font-scale"]=f.scale),f.textColor&&(p["text-color"]=["rgba"].concat(f.textColor.toArray())),l.push(p)}return l}}class il{constructor(l){this.name=l.name,this.available=l.available}toString(){return this.name}static fromString(l){return l?new il({name:l,available:!1}):null}serialize(){return["image",this.name]}}function TA(c,l,f,p){return typeof c=="number"&&c>=0&&c<=255&&typeof l=="number"&&l>=0&&l<=255&&typeof f=="number"&&f>=0&&f<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[c,l,f,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[c,l,f,p]:[c,l,f]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Wh(c){if(c===null||typeof c=="string"||typeof c=="boolean"||typeof c=="number"||c instanceof lo||c instanceof op||c instanceof da||c instanceof il)return!0;if(Array.isArray(c)){for(const l of c)if(!Wh(l))return!1;return!0}if(typeof c=="object"){for(const l in c)if(!Wh(c[l]))return!1;return!0}return!1}function Xi(c){if(c===null)return cu;if(typeof c=="string")return ur;if(typeof c=="boolean")return Cr;if(typeof c=="number")return _n;if(c instanceof lo)return Os;if(c instanceof op)return ys;if(c instanceof da)return Ls;if(c instanceof il)return ye;if(Array.isArray(c)){const l=c.length;let f;for(const p of c){const A=Xi(p);if(f){if(f===A)continue;f=xr;break}f=A}return Oe(f||xr,l)}return Rs}function ap(c){const l=typeof c;return c===null?"":l==="string"||l==="number"||l==="boolean"?String(c):c instanceof lo||c instanceof da||c instanceof il?c.toString():JSON.stringify(c)}class CA{constructor(l,f){this.type=l,this.value=f}static parse(l,f){if(l.length!==2)return f.error(`'literal' expression requires exactly one argument, but found ${l.length-1} instead.`);if(!Wh(l[1]))return f.error("invalid value");const p=l[1];let A=Xi(p);const b=f.expectedType;return A.kind!=="array"||A.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(A=b),new CA(A,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof lo?["rgba"].concat(this.value.toArray()):this.value instanceof da?this.value.serialize():this.value}}var Ff=CA,li=class{constructor(c){this.name="ExpressionEvaluationError",this.message=c}toJSON(){return this.message}};const qu={string:ur,number:_n,boolean:Cr,object:Rs};class xs{constructor(l,f){this.type=l,this.args=f}static parse(l,f){if(l.length<2)return f.error("Expected at least one argument.");let p,A=1;const b=l[0];if(b==="array"){let M,N;if(l.length>2){const U=l[1];if(typeof U!="string"||!(U in qu)||U==="object")return f.error('The item type argument of "array" must be one of string, number, boolean',1);M=qu[U],A++}else M=xr;if(l.length>3){if(l[2]!==null&&(typeof l[2]!="number"||l[2]<0||l[2]!==Math.floor(l[2])))return f.error('The length argument to "array" must be a positive integer literal',2);N=l[2],A++}p=Oe(M,N)}else p=qu[b];const C=[];for(;A<l.length;A++){const M=f.parse(l[A],A,xr);if(!M)return null;C.push(M)}return new xs(p,C)}evaluate(l){for(let f=0;f<this.args.length;f++){const p=this.args[f].evaluate(l);if(!on(this.type,Xi(p)))return p;if(f===this.args.length-1)throw new li(`Expected value to be of type ${He(this.type)}, but found ${He(Xi(p))} instead.`)}return null}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}serialize(){const l=this.type,f=[l.kind];if(l.kind==="array"){const p=l.itemType;if(p.kind==="string"||p.kind==="number"||p.kind==="boolean"){f.push(p.kind);const A=l.N;(typeof A=="number"||this.args.length>1)&&f.push(A)}}return f.concat(this.args.map(p=>p.serialize()))}}var Ul=xs;class Xu{constructor(l){this.type=Ls,this.sections=l}static parse(l,f){if(l.length<2)return f.error("Expected at least one argument.");const p=l[1];if(!Array.isArray(p)&&typeof p=="object")return f.error("First argument must be an image or text section.");const A=[];let b=!1;for(let C=1;C<=l.length-1;++C){const M=l[C];if(b&&typeof M=="object"&&!Array.isArray(M)){b=!1;let N=null;if(M["font-scale"]&&(N=f.parse(M["font-scale"],1,_n),!N))return null;let U=null;if(M["text-font"]&&(U=f.parse(M["text-font"],1,Oe(ur)),!U))return null;let W=null;if(M["text-color"]&&(W=f.parse(M["text-color"],1,Os),!W))return null;const K=A[A.length-1];K.scale=N,K.font=U,K.textColor=W}else{const N=f.parse(l[C],1,xr);if(!N)return null;const U=N.type.kind;if(U!=="string"&&U!=="value"&&U!=="null"&&U!=="resolvedImage")return f.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,A.push({content:N,scale:null,font:null,textColor:null})}}return new Xu(A)}evaluate(l){return new da(this.sections.map(f=>{const p=f.content.evaluate(l);return Xi(p)===ye?new sp("",p,null,null,null):new sp(ap(p),null,f.scale?f.scale.evaluate(l):null,f.font?f.font.evaluate(l).join(","):null,f.textColor?f.textColor.evaluate(l):null)}))}eachChild(l){for(const f of this.sections)l(f.content),f.scale&&l(f.scale),f.font&&l(f.font),f.textColor&&l(f.textColor)}outputDefined(){return!1}serialize(){const l=["format"];for(const f of this.sections){l.push(f.content.serialize());const p={};f.scale&&(p["font-scale"]=f.scale.serialize()),f.font&&(p["text-font"]=f.font.serialize()),f.textColor&&(p["text-color"]=f.textColor.serialize()),l.push(p)}return l}}class kf{constructor(l){this.type=ye,this.input=l}static parse(l,f){if(l.length!==2)return f.error("Expected two arguments.");const p=f.parse(l[1],1,ur);return p?new kf(p):f.error("No image name provided.")}evaluate(l){const f=this.input.evaluate(l),p=il.fromString(f);return p&&l.availableImages&&(p.available=l.availableImages.indexOf(f)>-1),p}eachChild(l){l(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const I_={"to-boolean":Cr,"to-color":Os,"to-number":_n,"to-string":ur};class lp{constructor(l,f){this.type=l,this.args=f}static parse(l,f){if(l.length<2)return f.error("Expected at least one argument.");const p=l[0];if((p==="to-boolean"||p==="to-string")&&l.length!==2)return f.error("Expected one argument.");const A=I_[p],b=[];for(let C=1;C<l.length;C++){const M=f.parse(l[C],C,xr);if(!M)return null;b.push(M)}return new lp(A,b)}evaluate(l){if(this.type.kind==="boolean")return!!this.args[0].evaluate(l);if(this.type.kind==="color"){let f,p;for(const A of this.args){if(f=A.evaluate(l),p=null,f instanceof lo)return f;if(typeof f=="string"){const b=l.parseColor(f);if(b)return b}else if(Array.isArray(f)&&(p=f.length<3||f.length>4?`Invalid rbga value ${JSON.stringify(f)}: expected an array containing either three or four numeric values.`:TA(f[0],f[1],f[2],f[3]),!p))return new lo(f[0]/255,f[1]/255,f[2]/255,f[3])}throw new li(p||`Could not parse color from value '${typeof f=="string"?f:String(JSON.stringify(f))}'`)}if(this.type.kind==="number"){let f=null;for(const p of this.args){if(f=p.evaluate(l),f===null)return 0;const A=Number(f);if(!isNaN(A))return A}throw new li(`Could not convert ${JSON.stringify(f)} to number.`)}return this.type.kind==="formatted"?da.fromString(ap(this.args[0].evaluate(l))):this.type.kind==="resolvedImage"?il.fromString(ap(this.args[0].evaluate(l))):ap(this.args[0].evaluate(l))}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Xu([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new kf(this.args[0]).serialize();const l=[`to-${this.type.kind}`];return this.eachChild(f=>{l.push(f.serialize())}),l}}var Zu=lp;const Ds=["Unknown","Point","LineString","Polygon"];var Mg=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Ds[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const c=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:f,y:p}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(f*l-c[0])+this.featureDistanceData.bearing[1]*(p*l-c[1])}return 0}parseColor(c){let l=this._parseColorCache[c];return l||(l=this._parseColorCache[c]=lo.parse(c)),l}};class zc{constructor(l,f,p,A){this.name=l,this.type=f,this._evaluate=p,this.args=A}evaluate(l){return this._evaluate(l,this.args)}eachChild(l){this.args.forEach(l)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(l=>l.serialize()))}static parse(l,f){const p=l[0],A=zc.definitions[p];if(!A)return f.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(A)?A[0]:A.type,C=Array.isArray(A)?[[A[1],A[2]]]:A.overloads,M=C.filter(([U])=>!Array.isArray(U)||U.length===l.length-1);let N=null;for(const[U,W]of M){N=new RA(f.registry,f.path,null,f.scope);const K=[];let ee=!1;for(let oe=1;oe<l.length;oe++){const le=l[oe],de=Array.isArray(U)?U[oe-1]:U.type,xe=N.parse(le,1+K.length,de);if(!xe){ee=!0;break}K.push(xe)}if(!ee)if(Array.isArray(U)&&U.length!==K.length)N.error(`Expected ${U.length} arguments, but found ${K.length} instead.`);else{for(let oe=0;oe<K.length;oe++){const le=Array.isArray(U)?U[oe]:U.type,de=K[oe];N.concat(oe+1).checkSubtype(le,de.type)}if(N.errors.length===0)return new zc(p,b,W,K)}}if(M.length===1)f.errors.push(...N.errors);else{const U=(M.length?M:C).map(([K])=>{return ee=K,Array.isArray(ee)?`(${ee.map(He).join(", ")})`:`(${He(ee.type)}...)`;var ee}).join(" | "),W=[];for(let K=1;K<l.length;K++){const ee=f.parse(l[K],1+W.length);if(!ee)return null;W.push(He(ee.type))}f.error(`Expected arguments of type ${U}, but found (${W.join(", ")}) instead.`)}return null}static register(l,f){zc.definitions=f;for(const p in f)l[p]=zc}}var ol=zc;class Gl{constructor(l,f,p){this.type=ys,this.locale=p,this.caseSensitive=l,this.diacriticSensitive=f}static parse(l,f){if(l.length!==2)return f.error("Expected one argument.");const p=l[1];if(typeof p!="object"||Array.isArray(p))return f.error("Collator options argument must be an object.");const A=f.parse(p["case-sensitive"]!==void 0&&p["case-sensitive"],1,Cr);if(!A)return null;const b=f.parse(p["diacritic-sensitive"]!==void 0&&p["diacritic-sensitive"],1,Cr);if(!b)return null;let C=null;return p.locale&&(C=f.parse(p.locale,1,ur),!C)?null:new Gl(A,b,C)}evaluate(l){return new op(this.caseSensitive.evaluate(l),this.diacriticSensitive.evaluate(l),this.locale?this.locale.evaluate(l):null)}eachChild(l){l(this.caseSensitive),l(this.diacriticSensitive),this.locale&&l(this.locale)}outputDefined(){return!1}serialize(){const l={};return l["case-sensitive"]=this.caseSensitive.serialize(),l["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(l.locale=this.locale.serialize()),["collator",l]}}const Bs=8192;function up(c,l){c[0]=Math.min(c[0],l[0]),c[1]=Math.min(c[1],l[1]),c[2]=Math.max(c[2],l[0]),c[3]=Math.max(c[3],l[1])}function zf(c,l){return!(c[0]<=l[0]||c[2]>=l[2]||c[1]<=l[1]||c[3]>=l[3])}function Uf(c,l){const f=(180+c[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c[1]*Math.PI/360)))/360,A=Math.pow(2,l.z);return[Math.round(f*A*Bs),Math.round(p*A*Bs)]}function M_(c,l,f){const p=c[0]-l[0],A=c[1]-l[1],b=c[0]-f[0],C=c[1]-f[1];return p*C-b*A==0&&p*b<=0&&A*C<=0}function Og(c,l){let f=!1;for(let C=0,M=l.length;C<M;C++){const N=l[C];for(let U=0,W=N.length;U<W-1;U++){if(M_(c,N[U],N[U+1]))return!1;(A=N[U])[1]>(p=c)[1]!=(b=N[U+1])[1]>p[1]&&p[0]<(b[0]-A[0])*(p[1]-A[1])/(b[1]-A[1])+A[0]&&(f=!f)}}var p,A,b;return f}function Rg(c,l){for(let f=0;f<l.length;f++)if(Og(c,l[f]))return!0;return!1}function PA(c,l,f,p){const A=p[0]-f[0],b=p[1]-f[1],C=(c[0]-f[0])*b-A*(c[1]-f[1]),M=(l[0]-f[0])*b-A*(l[1]-f[1]);return C>0&&M<0||C<0&&M>0}function qh(c,l,f){for(const U of f)for(let W=0;W<U.length-1;++W)if((M=[(C=U[W+1])[0]-(b=U[W])[0],C[1]-b[1]])[0]*(N=[(A=l)[0]-(p=c)[0],A[1]-p[1]])[1]-M[1]*N[0]!=0&&PA(p,A,b,C)&&PA(b,C,p,A))return!0;var p,A,b,C,M,N;return!1}function Kr(c,l){for(let f=0;f<c.length;++f)if(!Og(c[f],l))return!1;for(let f=0;f<c.length-1;++f)if(qh(c[f],c[f+1],l))return!1;return!0}function cp(c,l){for(let f=0;f<l.length;f++)if(Kr(c,l[f]))return!0;return!1}function IA(c,l,f){const p=[];for(let A=0;A<c.length;A++){const b=[];for(let C=0;C<c[A].length;C++){const M=Uf(c[A][C],f);up(l,M),b.push(M)}p.push(b)}return p}function MA(c,l,f){const p=[];for(let A=0;A<c.length;A++){const b=IA(c[A],l,f);p.push(b)}return p}function Lg(c,l,f,p){if(c[0]<f[0]||c[0]>f[2]){const A=.5*p;let b=c[0]-f[0]>A?-p:f[0]-c[0]>A?p:0;b===0&&(b=c[0]-f[2]>A?-p:f[2]-c[0]>A?p:0),c[0]+=b}up(l,c)}function Gf(c,l,f,p){const A=Math.pow(2,p.z)*Bs,b=[p.x*Bs,p.y*Bs],C=[];if(!c)return C;for(const M of c)for(const N of M){const U=[N.x+b[0],N.y+b[1]];Lg(U,l,f,A),C.push(U)}return C}function OA(c,l,f,p){const A=Math.pow(2,p.z)*Bs,b=[p.x*Bs,p.y*Bs],C=[];if(!c)return C;for(const N of c){const U=[];for(const W of N){const K=[W.x+b[0],W.y+b[1]];up(l,K),U.push(K)}C.push(U)}if(l[2]-l[0]<=A/2){(M=l)[0]=M[1]=1/0,M[2]=M[3]=-1/0;for(const N of C)for(const U of N)Lg(U,l,f,A)}var M;return C}class jf{constructor(l,f){this.type=Cr,this.geojson=l,this.geometries=f}static parse(l,f){if(l.length!==2)return f.error(`'within' expression requires exactly one argument, but found ${l.length-1} instead.`);if(Wh(l[1])){const p=l[1];if(p.type==="FeatureCollection")for(let A=0;A<p.features.length;++A){const b=p.features[A].geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new jf(p,p.features[A].geometry)}else if(p.type==="Feature"){const A=p.geometry.type;if(A==="Polygon"||A==="MultiPolygon")return new jf(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new jf(p,p)}return f.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(l){if(l.geometry()!=null&&l.canonicalID()!=null){if(l.geometryType()==="Point")return function(f,p){const A=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],C=f.canonicalID();if(!C)return!1;if(p.type==="Polygon"){const M=IA(p.coordinates,b,C),N=Gf(f.geometry(),A,b,C);if(!zf(A,b))return!1;for(const U of N)if(!Og(U,M))return!1}if(p.type==="MultiPolygon"){const M=MA(p.coordinates,b,C),N=Gf(f.geometry(),A,b,C);if(!zf(A,b))return!1;for(const U of N)if(!Rg(U,M))return!1}return!0}(l,this.geometries);if(l.geometryType()==="LineString")return function(f,p){const A=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],C=f.canonicalID();if(!C)return!1;if(p.type==="Polygon"){const M=IA(p.coordinates,b,C),N=OA(f.geometry(),A,b,C);if(!zf(A,b))return!1;for(const U of N)if(!Kr(U,M))return!1}if(p.type==="MultiPolygon"){const M=MA(p.coordinates,b,C),N=OA(f.geometry(),A,b,C);if(!zf(A,b))return!1;for(const U of N)if(!cp(U,M))return!1}return!0}(l,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var fp=jf;function fu(c){if(c instanceof ol&&(c.name==="get"&&c.args.length===1||c.name==="feature-state"||c.name==="has"&&c.args.length===1||c.name==="properties"||c.name==="geometry-type"||c.name==="id"||/^filter-/.test(c.name))||c instanceof fp)return!1;let l=!0;return c.eachChild(f=>{l&&!fu(f)&&(l=!1)}),l}function pa(c){if(c instanceof ol&&c.name==="feature-state")return!1;let l=!0;return c.eachChild(f=>{l&&!pa(f)&&(l=!1)}),l}function Vf(c,l){if(c instanceof ol&&l.indexOf(c.name)>=0)return!1;let f=!0;return c.eachChild(p=>{f&&!Vf(p,l)&&(f=!1)}),f}class Uc{constructor(l,f){this.type=f.type,this.name=l,this.boundExpression=f}static parse(l,f){if(l.length!==2||typeof l[1]!="string")return f.error("'var' expression requires exactly one string literal argument.");const p=l[1];return f.scope.has(p)?new Uc(p,f.scope.get(p)):f.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(l){return this.boundExpression.evaluate(l)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var O_=Uc;class hp{constructor(l,f=[],p,A=new $h,b=[]){this.registry=l,this.path=f,this.key=f.map(C=>`[${C}]`).join(""),this.scope=A,this.errors=b,this.expectedType=p}parse(l,f,p,A,b={}){return f?this.concat(f,p,A)._parse(l,b):this._parse(l,b)}_parse(l,f){function p(A,b,C){return C==="assert"?new Ul(b,[A]):C==="coerce"?new Zu(b,[A]):A}if(l!==null&&typeof l!="string"&&typeof l!="boolean"&&typeof l!="number"||(l=["literal",l]),Array.isArray(l)){if(l.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const A=l[0];if(typeof A!="string")return this.error(`Expression name must be a string, but found ${typeof A} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const b=this.registry[A];if(b){let C=b.parse(l,this);if(!C)return null;if(this.expectedType){const M=this.expectedType,N=C.type;if(M.kind!=="string"&&M.kind!=="number"&&M.kind!=="boolean"&&M.kind!=="object"&&M.kind!=="array"||N.kind!=="value")if(M.kind!=="color"&&M.kind!=="formatted"&&M.kind!=="resolvedImage"||N.kind!=="value"&&N.kind!=="string"){if(this.checkSubtype(M,N))return null}else C=p(C,M,f.typeAnnotation||"coerce");else C=p(C,M,f.typeAnnotation||"assert")}if(!(C instanceof Ff)&&C.type.kind!=="resolvedImage"&&LA(C)){const M=new Mg;try{C=new Ff(C.type,C.evaluate(M))}catch(N){return this.error(N.message),null}}return C}return this.error(`Unknown expression "${A}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(l===void 0?"'undefined' value invalid. Use null instead.":typeof l=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof l} instead.`)}concat(l,f,p){const A=typeof l=="number"?this.path.concat(l):this.path,b=p?this.scope.concat(p):this.scope;return new hp(this.registry,A,f||null,b,this.errors)}error(l,...f){const p=`${this.key}${f.map(A=>`[${A}]`).join("")}`;this.errors.push(new fa(p,l))}checkSubtype(l,f){const p=on(l,f);return p&&this.error(p),p}}var RA=hp;function LA(c){if(c instanceof O_)return LA(c.boundExpression);if(c instanceof ol&&c.name==="error"||c instanceof Gl||c instanceof fp)return!1;const l=c instanceof Zu||c instanceof Ul;let f=!0;return c.eachChild(p=>{f=l?f&&LA(p):f&&p instanceof Ff}),!!f&&fu(c)&&Vf(c,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Dg(c,l){const f=c.length-1;let p,A,b=0,C=f,M=0;for(;b<=C;)if(M=Math.floor((b+C)/2),p=c[M],A=c[M+1],p<=l){if(M===f||l<A)return M;b=M+1}else{if(!(p>l))throw new li("Input is not a number.");C=M-1}return 0}class Bg{constructor(l,f,p){this.type=l,this.input=f,this.labels=[],this.outputs=[];for(const[A,b]of p)this.labels.push(A),this.outputs.push(b)}static parse(l,f){if(l.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return f.error("Expected an even number of arguments.");const p=f.parse(l[1],1,_n);if(!p)return null;const A=[];let b=null;f.expectedType&&f.expectedType.kind!=="value"&&(b=f.expectedType);for(let C=1;C<l.length;C+=2){const M=C===1?-1/0:l[C],N=l[C+1],U=C,W=C+1;if(typeof M!="number")return f.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(A.length&&A[A.length-1][0]>=M)return f.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',U);const K=f.parse(N,W,b);if(!K)return null;b=b||K.type,A.push([M,K])}return new Bg(b,p,A)}evaluate(l){const f=this.labels,p=this.outputs;if(f.length===1)return p[0].evaluate(l);const A=this.input.evaluate(l);if(A<=f[0])return p[0].evaluate(l);const b=f.length;return A>=f[b-1]?p[b-1].evaluate(l):p[Dg(f,A)].evaluate(l)}eachChild(l){l(this.input);for(const f of this.outputs)l(f)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}serialize(){const l=["step",this.input.serialize()];for(let f=0;f<this.labels.length;f++)f>0&&l.push(this.labels[f]),l.push(this.outputs[f].serialize());return l}}var DA=Bg;function jr(c,l,f){return c*(1-f)+l*f}var hu=Object.freeze({__proto__:null,array:function(c,l,f){return c.map((p,A)=>jr(p,l[A],f))},color:function(c,l,f){return new lo(jr(c.r,l.r,f),jr(c.g,l.g,f),jr(c.b,l.b,f),jr(c.a,l.a,f))},number:jr});const R_=.95047,BA=1.08883,L_=4/29,$f=6/29,NA=3*$f*$f,ox=$f*$f*$f,sx=Math.PI/180,D_=180/Math.PI;function Ng(c){return c>ox?Math.pow(c,1/3):c/NA+L_}function dp(c){return c>$f?c*c*c:NA*(c-L_)}function FA(c){return 255*(c<=.0031308?12.92*c:1.055*Math.pow(c,1/2.4)-.055)}function bs(c){return(c/=255)<=.04045?c/12.92:Math.pow((c+.055)/1.055,2.4)}function No(c){const l=bs(c.r),f=bs(c.g),p=bs(c.b),A=Ng((.4124564*l+.3575761*f+.1804375*p)/R_),b=Ng((.2126729*l+.7151522*f+.072175*p)/1);return{l:116*b-16,a:500*(A-b),b:200*(b-Ng((.0193339*l+.119192*f+.9503041*p)/BA)),alpha:c.a}}function B_(c){let l=(c.l+16)/116,f=isNaN(c.a)?l:l+c.a/500,p=isNaN(c.b)?l:l-c.b/200;return l=1*dp(l),f=R_*dp(f),p=BA*dp(p),new lo(FA(3.2404542*f-1.5371385*l-.4985314*p),FA(-.969266*f+1.8760108*l+.041556*p),FA(.0556434*f-.2040259*l+1.0572252*p),c.alpha)}function ax(c,l,f){const p=l-c;return c+f*(p>180||p<-180?p-360*Math.round(p/360):p)}const pp={forward:No,reverse:B_,interpolate:function(c,l,f){return{l:jr(c.l,l.l,f),a:jr(c.a,l.a,f),b:jr(c.b,l.b,f),alpha:jr(c.alpha,l.alpha,f)}}},Xh={forward:function(c){const{l,a:f,b:p}=No(c),A=Math.atan2(p,f)*D_;return{h:A<0?A+360:A,c:Math.sqrt(f*f+p*p),l,alpha:c.a}},reverse:function(c){const l=c.h*sx,f=c.c;return B_({l:c.l,a:Math.cos(l)*f,b:Math.sin(l)*f,alpha:c.alpha})},interpolate:function(c,l,f){return{h:ax(c.h,l.h,f),c:jr(c.c,l.c,f),l:jr(c.l,l.l,f),alpha:jr(c.alpha,l.alpha,f)}}};var kA=Object.freeze({__proto__:null,hcl:Xh,lab:pp});class fs{constructor(l,f,p,A,b){this.type=l,this.operator=f,this.interpolation=p,this.input=A,this.labels=[],this.outputs=[];for(const[C,M]of b)this.labels.push(C),this.outputs.push(M)}static interpolationFactor(l,f,p,A){let b=0;if(l.name==="exponential")b=gp(f,l.base,p,A);else if(l.name==="linear")b=gp(f,1,p,A);else if(l.name==="cubic-bezier"){const C=l.controlPoints;b=new J(C[0],C[1],C[2],C[3]).solve(gp(f,1,p,A))}return b}static parse(l,f){let[p,A,b,...C]=l;if(!Array.isArray(A)||A.length===0)return f.error("Expected an interpolation type expression.",1);if(A[0]==="linear")A={name:"linear"};else if(A[0]==="exponential"){const U=A[1];if(typeof U!="number")return f.error("Exponential interpolation requires a numeric base.",1,1);A={name:"exponential",base:U}}else{if(A[0]!=="cubic-bezier")return f.error(`Unknown interpolation type ${String(A[0])}`,1,0);{const U=A.slice(1);if(U.length!==4||U.some(W=>typeof W!="number"||W<0||W>1))return f.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);A={name:"cubic-bezier",controlPoints:U}}}if(l.length-1<4)return f.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if((l.length-1)%2!=0)return f.error("Expected an even number of arguments.");if(b=f.parse(b,2,_n),!b)return null;const M=[];let N=null;p==="interpolate-hcl"||p==="interpolate-lab"?N=Os:f.expectedType&&f.expectedType.kind!=="value"&&(N=f.expectedType);for(let U=0;U<C.length;U+=2){const W=C[U],K=C[U+1],ee=U+3,oe=U+4;if(typeof W!="number")return f.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',ee);if(M.length&&M[M.length-1][0]>=W)return f.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',ee);const le=f.parse(K,oe,N);if(!le)return null;N=N||le.type,M.push([W,le])}return N.kind==="number"||N.kind==="color"||N.kind==="array"&&N.itemType.kind==="number"&&typeof N.N=="number"?new fs(N,p,A,b,M):f.error(`Type ${He(N)} is not interpolatable.`)}evaluate(l){const f=this.labels,p=this.outputs;if(f.length===1)return p[0].evaluate(l);const A=this.input.evaluate(l);if(A<=f[0])return p[0].evaluate(l);const b=f.length;if(A>=f[b-1])return p[b-1].evaluate(l);const C=Dg(f,A),M=fs.interpolationFactor(this.interpolation,A,f[C],f[C+1]),N=p[C].evaluate(l),U=p[C+1].evaluate(l);return this.operator==="interpolate"?hu[this.type.kind.toLowerCase()](N,U,M):this.operator==="interpolate-hcl"?Xh.reverse(Xh.interpolate(Xh.forward(N),Xh.forward(U),M)):pp.reverse(pp.interpolate(pp.forward(N),pp.forward(U),M))}eachChild(l){l(this.input);for(const f of this.outputs)l(f)}outputDefined(){return this.outputs.every(l=>l.outputDefined())}serialize(){let l;l=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const f=[this.operator,l,this.input.serialize()];for(let p=0;p<this.labels.length;p++)f.push(this.labels[p],this.outputs[p].serialize());return f}}function gp(c,l,f,p){const A=p-f,b=c-f;return A===0?0:l===1?b/A:(Math.pow(l,b)-1)/(Math.pow(l,A)-1)}var ws=fs;class Fg{constructor(l,f){this.type=l,this.args=f}static parse(l,f){if(l.length<2)return f.error("Expectected at least one argument.");let p=null;const A=f.expectedType;A&&A.kind!=="value"&&(p=A);const b=[];for(const M of l.slice(1)){const N=f.parse(M,1+b.length,p,void 0,{typeAnnotation:"omit"});if(!N)return null;p=p||N.type,b.push(N)}const C=A&&b.some(M=>on(A,M.type));return new Fg(C?xr:p,b)}evaluate(l){let f,p=null,A=0;for(const b of this.args){if(A++,p=b.evaluate(l),p&&p instanceof il&&!p.available&&(f||(f=p),p=null,A===this.args.length))return f;if(p!==null)break}return p}eachChild(l){this.args.forEach(l)}outputDefined(){return this.args.every(l=>l.outputDefined())}serialize(){const l=["coalesce"];return this.eachChild(f=>{l.push(f.serialize())}),l}}var mp=Fg;class kg{constructor(l,f){this.type=f.type,this.bindings=[].concat(l),this.result=f}evaluate(l){return this.result.evaluate(l)}eachChild(l){for(const f of this.bindings)l(f[1]);l(this.result)}static parse(l,f){if(l.length<4)return f.error(`Expected at least 3 arguments, but found ${l.length-1} instead.`);const p=[];for(let b=1;b<l.length-1;b+=2){const C=l[b];if(typeof C!="string")return f.error(`Expected string, but found ${typeof C} instead.`,b);if(/[^a-zA-Z0-9_]/.test(C))return f.error("Variable names must contain only alphanumeric characters or '_'.",b);const M=f.parse(l[b+1],b+1);if(!M)return null;p.push([C,M])}const A=f.parse(l[l.length-1],l.length-1,f.expectedType,p);return A?new kg(p,A):null}outputDefined(){return this.result.outputDefined()}serialize(){const l=["let"];for(const[f,p]of this.bindings)l.push(f,p.serialize());return l.push(this.result.serialize()),l}}var Ua=kg;class zg{constructor(l,f,p){this.type=l,this.index=f,this.input=p}static parse(l,f){if(l.length!==3)return f.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const p=f.parse(l[1],1,_n),A=f.parse(l[2],2,Oe(f.expectedType||xr));return p&&A?new zg(A.type.itemType,p,A):null}evaluate(l){const f=this.index.evaluate(l),p=this.input.evaluate(l);if(f<0)throw new li(`Array index out of bounds: ${f} < 0.`);if(f>=p.length)throw new li(`Array index out of bounds: ${f} > ${p.length-1}.`);if(f!==Math.floor(f))throw new li(`Array index must be an integer, but found ${f} instead.`);return p[f]}eachChild(l){l(this.index),l(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var zA=zg;class Hf{constructor(l,f){this.type=Cr,this.needle=l,this.haystack=f}static parse(l,f){if(l.length!==3)return f.error(`Expected 2 arguments, but found ${l.length-1} instead.`);const p=f.parse(l[1],1,xr),A=f.parse(l[2],2,xr);return p&&A?Fn(p.type,[Cr,ur,_n,cu,xr])?new Hf(p,A):f.error(`Expected first argument to be of type boolean, string, number or null, but found ${He(p.type)} instead`):null}evaluate(l){const f=this.needle.evaluate(l),p=this.haystack.evaluate(l);if(p==null)return!1;if(!Rr(f,["boolean","string","number","null"]))throw new li(`Expected first argument to be of type boolean, string, number or null, but found ${He(Xi(f))} instead.`);if(!Rr(p,["string","array"]))throw new li(`Expected second argument to be of type array or string, but found ${He(Xi(p))} instead.`);return p.indexOf(f)>=0}eachChild(l){l(this.needle),l(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var du=Hf;class jl{constructor(l,f,p){this.type=_n,this.needle=l,this.haystack=f,this.fromIndex=p}static parse(l,f){if(l.length<=2||l.length>=5)return f.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const p=f.parse(l[1],1,xr),A=f.parse(l[2],2,xr);if(!p||!A)return null;if(!Fn(p.type,[Cr,ur,_n,cu,xr]))return f.error(`Expected first argument to be of type boolean, string, number or null, but found ${He(p.type)} instead`);if(l.length===4){const b=f.parse(l[3],3,_n);return b?new jl(p,A,b):null}return new jl(p,A)}evaluate(l){const f=this.needle.evaluate(l),p=this.haystack.evaluate(l);if(!Rr(f,["boolean","string","number","null"]))throw new li(`Expected first argument to be of type boolean, string, number or null, but found ${He(Xi(f))} instead.`);if(!Rr(p,["string","array"]))throw new li(`Expected second argument to be of type array or string, but found ${He(Xi(p))} instead.`);if(this.fromIndex){const A=this.fromIndex.evaluate(l);return p.indexOf(f,A)}return p.indexOf(f)}eachChild(l){l(this.needle),l(this.haystack),this.fromIndex&&l(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const l=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),l]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var N_=jl;class Ug{constructor(l,f,p,A,b,C){this.inputType=l,this.type=f,this.input=p,this.cases=A,this.outputs=b,this.otherwise=C}static parse(l,f){if(l.length<5)return f.error(`Expected at least 4 arguments, but found only ${l.length-1}.`);if(l.length%2!=1)return f.error("Expected an even number of arguments.");let p,A;f.expectedType&&f.expectedType.kind!=="value"&&(A=f.expectedType);const b={},C=[];for(let U=2;U<l.length-1;U+=2){let W=l[U];const K=l[U+1];Array.isArray(W)||(W=[W]);const ee=f.concat(U);if(W.length===0)return ee.error("Expected at least one branch label.");for(const le of W){if(typeof le!="number"&&typeof le!="string")return ee.error("Branch labels must be numbers or strings.");if(typeof le=="number"&&Math.abs(le)>Number.MAX_SAFE_INTEGER)return ee.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof le=="number"&&Math.floor(le)!==le)return ee.error("Numeric branch labels must be integer values.");if(p){if(ee.checkSubtype(p,Xi(le)))return null}else p=Xi(le);if(b[String(le)]!==void 0)return ee.error("Branch labels must be unique.");b[String(le)]=C.length}const oe=f.parse(K,U,A);if(!oe)return null;A=A||oe.type,C.push(oe)}const M=f.parse(l[1],1,xr);if(!M)return null;const N=f.parse(l[l.length-1],l.length-1,A);return N?M.type.kind!=="value"&&f.concat(1).checkSubtype(p,M.type)?null:new Ug(p,A,M,b,C,N):null}evaluate(l){const f=this.input.evaluate(l);return(Xi(f)===this.inputType&&this.outputs[this.cases[f]]||this.otherwise).evaluate(l)}eachChild(l){l(this.input),this.outputs.forEach(l),l(this.otherwise)}outputDefined(){return this.outputs.every(l=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const l=["match",this.input.serialize()],f=Object.keys(this.cases).sort(),p=[],A={};for(const C of f){const M=A[this.cases[C]];M===void 0?(A[this.cases[C]]=p.length,p.push([this.cases[C],[C]])):p[M][1].push(C)}const b=C=>this.inputType.kind==="number"?Number(C):C;for(const[C,M]of p)l.push(M.length===1?b(M[0]):M.map(b)),l.push(this.outputs[C].serialize());return l.push(this.otherwise.serialize()),l}}var lx=Ug;class Ap{constructor(l,f,p){this.type=l,this.branches=f,this.otherwise=p}static parse(l,f){if(l.length<4)return f.error(`Expected at least 3 arguments, but found only ${l.length-1}.`);if(l.length%2!=0)return f.error("Expected an odd number of arguments.");let p;f.expectedType&&f.expectedType.kind!=="value"&&(p=f.expectedType);const A=[];for(let C=1;C<l.length-1;C+=2){const M=f.parse(l[C],C,Cr);if(!M)return null;const N=f.parse(l[C+1],C+1,p);if(!N)return null;A.push([M,N]),p=p||N.type}const b=f.parse(l[l.length-1],l.length-1,p);return b?new Ap(p,A,b):null}evaluate(l){for(const[f,p]of this.branches)if(f.evaluate(l))return p.evaluate(l);return this.otherwise.evaluate(l)}eachChild(l){for(const[f,p]of this.branches)l(f),l(p);l(this.otherwise)}outputDefined(){return this.branches.every(([l,f])=>f.outputDefined())&&this.otherwise.outputDefined()}serialize(){const l=["case"];return this.eachChild(f=>{l.push(f.serialize())}),l}}var UA=Ap;class _p{constructor(l,f,p,A){this.type=l,this.input=f,this.beginIndex=p,this.endIndex=A}static parse(l,f){if(l.length<=2||l.length>=5)return f.error(`Expected 3 or 4 arguments, but found ${l.length-1} instead.`);const p=f.parse(l[1],1,xr),A=f.parse(l[2],2,_n);if(!p||!A)return null;if(!Fn(p.type,[Oe(xr),ur,xr]))return f.error(`Expected first argument to be of type array or string, but found ${He(p.type)} instead`);if(l.length===4){const b=f.parse(l[3],3,_n);return b?new _p(p.type,p,A,b):null}return new _p(p.type,p,A)}evaluate(l){const f=this.input.evaluate(l),p=this.beginIndex.evaluate(l);if(!Rr(f,["string","array"]))throw new li(`Expected first argument to be of type array or string, but found ${He(Xi(f))} instead.`);if(this.endIndex){const A=this.endIndex.evaluate(l);return f.slice(p,A)}return f.slice(p)}eachChild(l){l(this.input),l(this.beginIndex),this.endIndex&&l(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const l=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),l]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var F_=_p;function Gg(c,l){return c==="=="||c==="!="?l.kind==="boolean"||l.kind==="string"||l.kind==="number"||l.kind==="null"||l.kind==="value":l.kind==="string"||l.kind==="number"||l.kind==="value"}function k_(c,l,f,p){return p.compare(l,f)===0}function Zh(c,l,f){const p=c!=="=="&&c!=="!=";return class yfe{constructor(b,C,M){this.type=Cr,this.lhs=b,this.rhs=C,this.collator=M,this.hasUntypedArgument=b.type.kind==="value"||C.type.kind==="value"}static parse(b,C){if(b.length!==3&&b.length!==4)return C.error("Expected two or three arguments.");const M=b[0];let N=C.parse(b[1],1,xr);if(!N)return null;if(!Gg(M,N.type))return C.concat(1).error(`"${M}" comparisons are not supported for type '${He(N.type)}'.`);let U=C.parse(b[2],2,xr);if(!U)return null;if(!Gg(M,U.type))return C.concat(2).error(`"${M}" comparisons are not supported for type '${He(U.type)}'.`);if(N.type.kind!==U.type.kind&&N.type.kind!=="value"&&U.type.kind!=="value")return C.error(`Cannot compare types '${He(N.type)}' and '${He(U.type)}'.`);p&&(N.type.kind==="value"&&U.type.kind!=="value"?N=new Ul(U.type,[N]):N.type.kind!=="value"&&U.type.kind==="value"&&(U=new Ul(N.type,[U])));let W=null;if(b.length===4){if(N.type.kind!=="string"&&U.type.kind!=="string"&&N.type.kind!=="value"&&U.type.kind!=="value")return C.error("Cannot use collator to compare non-string types.");if(W=C.parse(b[3],3,ys),!W)return null}return new yfe(N,U,W)}evaluate(b){const C=this.lhs.evaluate(b),M=this.rhs.evaluate(b);if(p&&this.hasUntypedArgument){const N=Xi(C),U=Xi(M);if(N.kind!==U.kind||N.kind!=="string"&&N.kind!=="number")throw new li(`Expected arguments for "${c}" to be (string, string) or (number, number), but found (${N.kind}, ${U.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const N=Xi(C),U=Xi(M);if(N.kind!=="string"||U.kind!=="string")return l(b,C,M)}return this.collator?f(b,C,M,this.collator.evaluate(b)):l(b,C,M)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}serialize(){const b=[c];return this.eachChild(C=>{b.push(C.serialize())}),b}}}const ux=Zh("==",function(c,l,f){return l===f},k_),jg=Zh("!=",function(c,l,f){return l!==f},function(c,l,f,p){return!k_(0,l,f,p)}),cx=Zh("<",function(c,l,f){return l<f},function(c,l,f,p){return p.compare(l,f)<0}),fx=Zh(">",function(c,l,f){return l>f},function(c,l,f,p){return p.compare(l,f)>0}),hx=Zh("<=",function(c,l,f){return l<=f},function(c,l,f,p){return p.compare(l,f)<=0}),GA=Zh(">=",function(c,l,f){return l>=f},function(c,l,f,p){return p.compare(l,f)>=0});class yp{constructor(l,f,p,A,b,C){this.type=ur,this.number=l,this.locale=f,this.currency=p,this.unit=A,this.minFractionDigits=b,this.maxFractionDigits=C}static parse(l,f){if(l.length!==3)return f.error("Expected two arguments.");const p=f.parse(l[1],1,_n);if(!p)return null;const A=l[2];if(typeof A!="object"||Array.isArray(A))return f.error("NumberFormat options argument must be an object.");let b=null;if(A.locale&&(b=f.parse(A.locale,1,ur),!b))return null;let C=null;if(A.currency&&(C=f.parse(A.currency,1,ur),!C))return null;let M=null;if(A.unit&&(M=f.parse(A.unit,1,ur),!M))return null;let N=null;if(A["min-fraction-digits"]&&(N=f.parse(A["min-fraction-digits"],1,_n),!N))return null;let U=null;return A["max-fraction-digits"]&&(U=f.parse(A["max-fraction-digits"],1,_n),!U)?null:new yp(p,b,C,M,N,U)}evaluate(l){return new Intl.NumberFormat(this.locale?this.locale.evaluate(l):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(l):void 0,unit:this.unit?this.unit.evaluate(l):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(l):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(l):void 0}).format(this.number.evaluate(l))}eachChild(l){l(this.number),this.locale&&l(this.locale),this.currency&&l(this.currency),this.unit&&l(this.unit),this.minFractionDigits&&l(this.minFractionDigits),this.maxFractionDigits&&l(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const l={};return this.locale&&(l.locale=this.locale.serialize()),this.currency&&(l.currency=this.currency.serialize()),this.unit&&(l.unit=this.unit.serialize()),this.minFractionDigits&&(l["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(l["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),l]}}class ga{constructor(l){this.type=_n,this.input=l}static parse(l,f){if(l.length!==2)return f.error(`Expected 1 argument, but found ${l.length-1} instead.`);const p=f.parse(l[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?f.error(`Expected argument of type string or array, but found ${He(p.type)} instead.`):new ga(p):null}evaluate(l){const f=this.input.evaluate(l);if(typeof f=="string"||Array.isArray(f))return f.length;throw new li(`Expected value to be of type string or array, but found ${He(Xi(f))} instead.`)}eachChild(l){l(this.input)}outputDefined(){return!1}serialize(){const l=["length"];return this.eachChild(f=>{l.push(f.serialize())}),l}}const jA={"==":ux,"!=":jg,">":fx,"<":cx,">=":GA,"<=":hx,array:Ul,at:zA,boolean:Ul,case:UA,coalesce:mp,collator:Gl,format:Xu,image:kf,in:du,"index-of":N_,interpolate:ws,"interpolate-hcl":ws,"interpolate-lab":ws,length:ga,let:Ua,literal:Ff,match:lx,number:Ul,"number-format":yp,object:Ul,slice:F_,step:DA,string:Ul,"to-boolean":Zu,"to-color":Zu,"to-number":Zu,"to-string":Zu,var:O_,within:fp};function z_(c,[l,f,p,A]){l=l.evaluate(c),f=f.evaluate(c),p=p.evaluate(c);const b=A?A.evaluate(c):1,C=TA(l,f,p,b);if(C)throw new li(C);return new lo(l/255*b,f/255*b,p/255*b,b)}function Yu(c,l){return c in l}function Vg(c,l){const f=l[c];return f===void 0?null:f}function sl(c){return{type:c}}ol.register(jA,{error:[{kind:"error"},[ur],(c,[l])=>{throw new li(l.evaluate(c))}],typeof:[ur,[xr],(c,[l])=>He(Xi(l.evaluate(c)))],"to-rgba":[Oe(_n,4),[Os],(c,[l])=>l.evaluate(c).toArray()],rgb:[Os,[_n,_n,_n],z_],rgba:[Os,[_n,_n,_n,_n],z_],has:{type:Cr,overloads:[[[ur],(c,[l])=>Yu(l.evaluate(c),c.properties())],[[ur,Rs],(c,[l,f])=>Yu(l.evaluate(c),f.evaluate(c))]]},get:{type:xr,overloads:[[[ur],(c,[l])=>Vg(l.evaluate(c),c.properties())],[[ur,Rs],(c,[l,f])=>Vg(l.evaluate(c),f.evaluate(c))]]},"feature-state":[xr,[ur],(c,[l])=>Vg(l.evaluate(c),c.featureState||{})],properties:[Rs,[],c=>c.properties()],"geometry-type":[ur,[],c=>c.geometryType()],id:[xr,[],c=>c.id()],zoom:[_n,[],c=>c.globals.zoom],pitch:[_n,[],c=>c.globals.pitch||0],"distance-from-center":[_n,[],c=>c.distanceFromCenter()],"heatmap-density":[_n,[],c=>c.globals.heatmapDensity||0],"line-progress":[_n,[],c=>c.globals.lineProgress||0],"sky-radial-progress":[_n,[],c=>c.globals.skyRadialProgress||0],accumulated:[xr,[],c=>c.globals.accumulated===void 0?null:c.globals.accumulated],"+":[_n,sl(_n),(c,l)=>{let f=0;for(const p of l)f+=p.evaluate(c);return f}],"*":[_n,sl(_n),(c,l)=>{let f=1;for(const p of l)f*=p.evaluate(c);return f}],"-":{type:_n,overloads:[[[_n,_n],(c,[l,f])=>l.evaluate(c)-f.evaluate(c)],[[_n],(c,[l])=>-l.evaluate(c)]]},"/":[_n,[_n,_n],(c,[l,f])=>l.evaluate(c)/f.evaluate(c)],"%":[_n,[_n,_n],(c,[l,f])=>l.evaluate(c)%f.evaluate(c)],ln2:[_n,[],()=>Math.LN2],pi:[_n,[],()=>Math.PI],e:[_n,[],()=>Math.E],"^":[_n,[_n,_n],(c,[l,f])=>Math.pow(l.evaluate(c),f.evaluate(c))],sqrt:[_n,[_n],(c,[l])=>Math.sqrt(l.evaluate(c))],log10:[_n,[_n],(c,[l])=>Math.log(l.evaluate(c))/Math.LN10],ln:[_n,[_n],(c,[l])=>Math.log(l.evaluate(c))],log2:[_n,[_n],(c,[l])=>Math.log(l.evaluate(c))/Math.LN2],sin:[_n,[_n],(c,[l])=>Math.sin(l.evaluate(c))],cos:[_n,[_n],(c,[l])=>Math.cos(l.evaluate(c))],tan:[_n,[_n],(c,[l])=>Math.tan(l.evaluate(c))],asin:[_n,[_n],(c,[l])=>Math.asin(l.evaluate(c))],acos:[_n,[_n],(c,[l])=>Math.acos(l.evaluate(c))],atan:[_n,[_n],(c,[l])=>Math.atan(l.evaluate(c))],min:[_n,sl(_n),(c,l)=>Math.min(...l.map(f=>f.evaluate(c)))],max:[_n,sl(_n),(c,l)=>Math.max(...l.map(f=>f.evaluate(c)))],abs:[_n,[_n],(c,[l])=>Math.abs(l.evaluate(c))],round:[_n,[_n],(c,[l])=>{const f=l.evaluate(c);return f<0?-Math.round(-f):Math.round(f)}],floor:[_n,[_n],(c,[l])=>Math.floor(l.evaluate(c))],ceil:[_n,[_n],(c,[l])=>Math.ceil(l.evaluate(c))],"filter-==":[Cr,[ur,xr],(c,[l,f])=>c.properties()[l.value]===f.value],"filter-id-==":[Cr,[xr],(c,[l])=>c.id()===l.value],"filter-type-==":[Cr,[ur],(c,[l])=>c.geometryType()===l.value],"filter-<":[Cr,[ur,xr],(c,[l,f])=>{const p=c.properties()[l.value],A=f.value;return typeof p==typeof A&&p<A}],"filter-id-<":[Cr,[xr],(c,[l])=>{const f=c.id(),p=l.value;return typeof f==typeof p&&f<p}],"filter->":[Cr,[ur,xr],(c,[l,f])=>{const p=c.properties()[l.value],A=f.value;return typeof p==typeof A&&p>A}],"filter-id->":[Cr,[xr],(c,[l])=>{const f=c.id(),p=l.value;return typeof f==typeof p&&f>p}],"filter-<=":[Cr,[ur,xr],(c,[l,f])=>{const p=c.properties()[l.value],A=f.value;return typeof p==typeof A&&p<=A}],"filter-id-<=":[Cr,[xr],(c,[l])=>{const f=c.id(),p=l.value;return typeof f==typeof p&&f<=p}],"filter->=":[Cr,[ur,xr],(c,[l,f])=>{const p=c.properties()[l.value],A=f.value;return typeof p==typeof A&&p>=A}],"filter-id->=":[Cr,[xr],(c,[l])=>{const f=c.id(),p=l.value;return typeof f==typeof p&&f>=p}],"filter-has":[Cr,[xr],(c,[l])=>l.value in c.properties()],"filter-has-id":[Cr,[],c=>c.id()!==null&&c.id()!==void 0],"filter-type-in":[Cr,[Oe(ur)],(c,[l])=>l.value.indexOf(c.geometryType())>=0],"filter-id-in":[Cr,[Oe(xr)],(c,[l])=>l.value.indexOf(c.id())>=0],"filter-in-small":[Cr,[ur,Oe(xr)],(c,[l,f])=>f.value.indexOf(c.properties()[l.value])>=0],"filter-in-large":[Cr,[ur,Oe(xr)],(c,[l,f])=>function(p,A,b,C){for(;b<=C;){const M=b+C>>1;if(A[M]===p)return!0;A[M]>p?C=M-1:b=M+1}return!1}(c.properties()[l.value],f.value,0,f.value.length-1)],all:{type:Cr,overloads:[[[Cr,Cr],(c,[l,f])=>l.evaluate(c)&&f.evaluate(c)],[sl(Cr),(c,l)=>{for(const f of l)if(!f.evaluate(c))return!1;return!0}]]},any:{type:Cr,overloads:[[[Cr,Cr],(c,[l,f])=>l.evaluate(c)||f.evaluate(c)],[sl(Cr),(c,l)=>{for(const f of l)if(f.evaluate(c))return!0;return!1}]]},"!":[Cr,[Cr],(c,[l])=>!l.evaluate(c)],"is-supported-script":[Cr,[ur],(c,[l])=>{const f=c.globals&&c.globals.isSupportedScript;return!f||f(l.evaluate(c))}],upcase:[ur,[ur],(c,[l])=>l.evaluate(c).toUpperCase()],downcase:[ur,[ur],(c,[l])=>l.evaluate(c).toLowerCase()],concat:[ur,sl(xr),(c,l)=>l.map(f=>ap(f.evaluate(c))).join("")],"resolved-locale":[ur,[ys],(c,[l])=>l.evaluate(c).resolvedLocale()]});var vp=jA;function xp(c){return{result:"success",value:c}}function Gc(c){return{result:"error",value:c}}function jc(c){return c["property-type"]==="data-driven"}function $g(c){return!!c.expression&&c.expression.parameters.indexOf("zoom")>-1}function Hg(c){return!!c.expression&&c.expression.interpolated}function Xr(c){return c instanceof Number?"number":c instanceof String?"string":c instanceof Boolean?"boolean":Array.isArray(c)?"array":c===null?"null":typeof c}function bp(c){return typeof c=="object"&&c!==null&&!Array.isArray(c)}function U_(c){return c}function Wg(c,l){const f=l.type==="color",p=c.stops&&typeof c.stops[0][0]=="object",A=p||!(p||c.property!==void 0),b=c.type||(Hg(l)?"exponential":"interval");if(f&&((c=za({},c)).stops&&(c.stops=c.stops.map(U=>[U[0],lo.parse(U[1])])),c.default=lo.parse(c.default?c.default:l.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!kA[c.colorSpace])throw new Error(`Unknown color space: ${c.colorSpace}`);let C,M,N;if(b==="exponential")C=Qu;else if(b==="interval")C=qg;else if(b==="categorical"){C=G_,M=Object.create(null);for(const U of c.stops)M[U[0]]=U[1];N=typeof c.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);C=VA}if(p){const U={},W=[];for(let oe=0;oe<c.stops.length;oe++){const le=c.stops[oe],de=le[0].zoom;U[de]===void 0&&(U[de]={zoom:de,type:c.type,property:c.property,default:c.default,stops:[]},W.push(de)),U[de].stops.push([le[0].value,le[1]])}const K=[];for(const oe of W)K.push([U[oe].zoom,Wg(U[oe],l)]);const ee={name:"linear"};return{kind:"composite",interpolationType:ee,interpolationFactor:ws.interpolationFactor.bind(void 0,ee),zoomStops:K.map(oe=>oe[0]),evaluate:({zoom:oe},le)=>Qu({stops:K,base:c.base},l,oe).evaluate(oe,le)}}if(A){const U=b==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:U,interpolationFactor:ws.interpolationFactor.bind(void 0,U),zoomStops:c.stops.map(W=>W[0]),evaluate:({zoom:W})=>C(c,l,W,M,N)}}return{kind:"source",evaluate(U,W){const K=W&&W.properties?W.properties[c.property]:void 0;return K===void 0?Yh(c.default,l.default):C(c,l,K,M,N)}}}function Yh(c,l,f){return c!==void 0?c:l!==void 0?l:f!==void 0?f:void 0}function G_(c,l,f,p,A){return Yh(typeof f===A?p[f]:void 0,c.default,l.default)}function qg(c,l,f){if(Xr(f)!=="number")return Yh(c.default,l.default);const p=c.stops.length;if(p===1||f<=c.stops[0][0])return c.stops[0][1];if(f>=c.stops[p-1][0])return c.stops[p-1][1];const A=Dg(c.stops.map(b=>b[0]),f);return c.stops[A][1]}function Qu(c,l,f){const p=c.base!==void 0?c.base:1;if(Xr(f)!=="number")return Yh(c.default,l.default);const A=c.stops.length;if(A===1||f<=c.stops[0][0])return c.stops[0][1];if(f>=c.stops[A-1][0])return c.stops[A-1][1];const b=Dg(c.stops.map(W=>W[0]),f),C=function(W,K,ee,oe){const le=oe-ee,de=W-ee;return le===0?0:K===1?de/le:(Math.pow(K,de)-1)/(Math.pow(K,le)-1)}(f,p,c.stops[b][0],c.stops[b+1][0]),M=c.stops[b][1],N=c.stops[b+1][1];let U=hu[l.type]||U_;if(c.colorSpace&&c.colorSpace!=="rgb"){const W=kA[c.colorSpace];U=(K,ee)=>W.reverse(W.interpolate(W.forward(K),W.forward(ee),C))}return typeof M.evaluate=="function"?{evaluate(...W){const K=M.evaluate.apply(void 0,W),ee=N.evaluate.apply(void 0,W);if(K!==void 0&&ee!==void 0)return U(K,ee,C)}}:U(M,N,C)}function VA(c,l,f){return l.type==="color"?f=lo.parse(f):l.type==="formatted"?f=da.fromString(f.toString()):l.type==="resolvedImage"?f=il.fromString(f.toString()):Xr(f)===l.type||l.type==="enum"&&l.values[f]||(f=void 0),Yh(f,c.default,l.default)}class wp{constructor(l,f){this.expression=l,this._warningHistory={},this._evaluator=new Mg,this._defaultValue=f?function(p){return p.type==="color"&&(bp(p.default)||Array.isArray(p.default))?new lo(0,0,0,0):p.type==="color"?lo.parse(p.default)||null:p.default===void 0?null:p.default}(f):null,this._enumValues=f&&f.type==="enum"?f.values:null}evaluateWithoutErrorHandling(l,f,p,A,b,C,M,N){return this._evaluator.globals=l,this._evaluator.feature=f,this._evaluator.featureState=p,this._evaluator.canonical=A||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=C,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=N||null,this.expression.evaluate(this._evaluator)}evaluate(l,f,p,A,b,C,M,N){this._evaluator.globals=l,this._evaluator.feature=f||null,this._evaluator.featureState=p||null,this._evaluator.canonical=A||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=C||null,this._evaluator.featureTileCoord=M||null,this._evaluator.featureDistanceData=N||null;try{const U=this.expression.evaluate(this._evaluator);if(U==null||typeof U=="number"&&U!=U)return this._defaultValue;if(this._enumValues&&!(U in this._enumValues))throw new li(`Expected value to be one of ${Object.keys(this._enumValues).map(W=>JSON.stringify(W)).join(", ")}, but found ${JSON.stringify(U)} instead.`);return U}catch(U){return this._warningHistory[U.message]||(this._warningHistory[U.message]=!0,typeof console<"u"&&console.warn(U.message)),this._defaultValue}}}function Zi(c){return Array.isArray(c)&&c.length>0&&typeof c[0]=="string"&&c[0]in vp}function Qh(c,l){const f=new RA(vp,[],l?function(A){const b={color:Os,string:ur,number:_n,enum:ur,boolean:Cr,formatted:Ls,resolvedImage:ye};return A.type==="array"?Oe(b[A.value]||xr,A.length):b[A.type]}(l):void 0),p=f.parse(c,void 0,void 0,void 0,l&&l.type==="string"?{typeAnnotation:"coerce"}:void 0);return p?xp(new wp(p,l)):Gc(f.errors)}class $A{constructor(l,f){this.kind=l,this._styleExpression=f,this.isStateDependent=l!=="constant"&&!pa(f.expression)}evaluateWithoutErrorHandling(l,f,p,A,b,C){return this._styleExpression.evaluateWithoutErrorHandling(l,f,p,A,b,C)}evaluate(l,f,p,A,b,C){return this._styleExpression.evaluate(l,f,p,A,b,C)}}class Ep{constructor(l,f,p,A){this.kind=l,this.zoomStops=p,this._styleExpression=f,this.isStateDependent=l!=="camera"&&!pa(f.expression),this.interpolationType=A}evaluateWithoutErrorHandling(l,f,p,A,b,C){return this._styleExpression.evaluateWithoutErrorHandling(l,f,p,A,b,C)}evaluate(l,f,p,A,b,C){return this._styleExpression.evaluate(l,f,p,A,b,C)}interpolationFactor(l,f,p){return this.interpolationType?ws.interpolationFactor(this.interpolationType,l,f,p):0}}function Kh(c,l){if((c=Qh(c,l)).result==="error")return c;const f=c.value.expression,p=fu(f);if(!p&&!jc(l))return Gc([new fa("","data expressions not supported")]);const A=Vf(f,["zoom","pitch","distance-from-center"]);if(!A&&!$g(l))return Gc([new fa("","zoom expressions not supported")]);const b=Tp(f);return b||A?b instanceof fa?Gc([b]):b instanceof ws&&!Hg(l)?Gc([new fa("",'"interpolate" expressions cannot be used with this property')]):xp(b?new Ep(p?"camera":"composite",c.value,b.labels,b instanceof ws?b.interpolation:void 0):new $A(p?"constant":"source",c.value)):Gc([new fa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Sp{constructor(l,f){this._parameters=l,this._specification=f,za(this,Wg(this._parameters,this._specification))}static deserialize(l){return new Sp(l._parameters,l._specification)}static serialize(l){return{_parameters:l._parameters,_specification:l._specification}}}function Tp(c){let l=null;if(c instanceof Ua)l=Tp(c.result);else if(c instanceof mp){for(const f of c.args)if(l=Tp(f),l)break}else(c instanceof DA||c instanceof ws)&&c.input instanceof ol&&c.input.name==="zoom"&&(l=c);return l instanceof fa||c.eachChild(f=>{const p=Tp(f);p instanceof fa?l=p:!l&&p?l=new fa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):l&&p&&l!==p&&(l=new fa("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),l}class Sn{constructor(l,f,p,A){this.message=(l?`${l}: `:"")+p,A&&(this.identifier=A),f!=null&&f.__line__&&(this.line=f.__line__)}}function Vl(c){const l=c.key,f=c.value,p=c.valueSpec||{},A=c.objectElementValidators||{},b=c.style,C=c.styleSpec;let M=[];const N=Xr(f);if(N!=="object")return[new Sn(l,f,`object expected, ${N} found`)];for(const U in f){const W=U.split(".")[0];let K;A[W]?K=A[W]:p[W]?K=tt:A["*"]?K=A["*"]:p["*"]&&(K=tt),K?M=M.concat(K({key:(l&&`${l}.`)+U,value:f[U],valueSpec:p[W]||p["*"],style:b,styleSpec:C,object:f,objectKey:U},f)):M.push(new Sn(l,f[U],`unknown property "${U}"`))}for(const U in p)A[U]||p[U].required&&p[U].default===void 0&&f[U]===void 0&&M.push(new Sn(l,f,`missing required property "${U}"`));return M}function j_(c){const l=c.value,f=c.valueSpec,p=c.style,A=c.styleSpec,b=c.key,C=c.arrayElementValidator||tt;if(Xr(l)!=="array")return[new Sn(b,l,`array expected, ${Xr(l)} found`)];if(f.length&&l.length!==f.length)return[new Sn(b,l,`array length ${f.length} expected, length ${l.length} found`)];if(f["min-length"]&&l.length<f["min-length"])return[new Sn(b,l,`array length at least ${f["min-length"]} expected, length ${l.length} found`)];let M={type:f.value,values:f.values,minimum:f.minimum,maximum:f.maximum,function:void 0};A.$version<7&&(M.function=f.function),Xr(f.value)==="object"&&(M=f.value);let N=[];for(let U=0;U<l.length;U++)N=N.concat(C({array:l,arrayIndex:U,value:l[U],valueSpec:M,style:p,styleSpec:A,key:`${b}[${U}]`}));return N}function Cp(c){const l=c.key,f=c.value,p=c.valueSpec;let A=Xr(f);if(A==="number"&&f!=f&&(A="NaN"),A!=="number")return[new Sn(l,f,`number expected, ${A} found`)];if("minimum"in p){let b=p.minimum;if(Xr(p.minimum)==="array"&&(b=p.minimum[c.arrayIndex]),f<b)return[new Sn(l,f,`${f} is less than the minimum value ${b}`)]}if("maximum"in p){let b=p.maximum;if(Xr(p.maximum)==="array"&&(b=p.maximum[c.arrayIndex]),f>b)return[new Sn(l,f,`${f} is greater than the maximum value ${b}`)]}return[]}function Pp(c){const l=c.valueSpec,f=Vi(c.value.type);let p,A,b,C={};const M=f!=="categorical"&&c.value.property===void 0,N=!M,U=Xr(c.value.stops)==="array"&&Xr(c.value.stops[0])==="array"&&Xr(c.value.stops[0][0])==="object",W=Vl({key:c.key,value:c.value,valueSpec:c.styleSpec.function,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{stops:function(oe){if(f==="identity")return[new Sn(oe.key,oe.value,'identity function may not have a "stops" property')];let le=[];const de=oe.value;return le=le.concat(j_({key:oe.key,value:de,valueSpec:oe.valueSpec,style:oe.style,styleSpec:oe.styleSpec,arrayElementValidator:K})),Xr(de)==="array"&&de.length===0&&le.push(new Sn(oe.key,de,"array must have at least one stop")),le},default:function(oe){return tt({key:oe.key,value:oe.value,valueSpec:l,style:oe.style,styleSpec:oe.styleSpec})}}});return f==="identity"&&M&&W.push(new Sn(c.key,c.value,'missing required property "property"')),f==="identity"||c.value.stops||W.push(new Sn(c.key,c.value,'missing required property "stops"')),f==="exponential"&&c.valueSpec.expression&&!Hg(c.valueSpec)&&W.push(new Sn(c.key,c.value,"exponential functions not supported")),c.styleSpec.$version>=8&&(N&&!jc(c.valueSpec)?W.push(new Sn(c.key,c.value,"property functions not supported")):M&&!$g(c.valueSpec)&&W.push(new Sn(c.key,c.value,"zoom functions not supported"))),f!=="categorical"&&!U||c.value.property!==void 0||W.push(new Sn(c.key,c.value,'"property" property is required')),W;function K(oe){let le=[];const de=oe.value,xe=oe.key;if(Xr(de)!=="array")return[new Sn(xe,de,`array expected, ${Xr(de)} found`)];if(de.length!==2)return[new Sn(xe,de,`array length 2 expected, length ${de.length} found`)];if(U){if(Xr(de[0])!=="object")return[new Sn(xe,de,`object expected, ${Xr(de[0])} found`)];if(de[0].zoom===void 0)return[new Sn(xe,de,"object stop key must have zoom")];if(de[0].value===void 0)return[new Sn(xe,de,"object stop key must have value")];const Be=Vi(de[0].zoom);if(typeof Be!="number")return[new Sn(xe,de[0].zoom,"stop zoom values must be numbers")];if(b&&b>Be)return[new Sn(xe,de[0].zoom,"stop zoom values must appear in ascending order")];Be!==b&&(b=Be,A=void 0,C={}),le=le.concat(Vl({key:`${xe}[0]`,value:de[0],valueSpec:{zoom:{}},style:oe.style,styleSpec:oe.styleSpec,objectElementValidators:{zoom:Cp,value:ee}}))}else le=le.concat(ee({key:`${xe}[0]`,value:de[0],valueSpec:{},style:oe.style,styleSpec:oe.styleSpec},de));return Zi(gi(de[1]))?le.concat([new Sn(`${xe}[1]`,de[1],"expressions are not allowed in function stops.")]):le.concat(tt({key:`${xe}[1]`,value:de[1],valueSpec:l,style:oe.style,styleSpec:oe.styleSpec}))}function ee(oe,le){const de=Xr(oe.value),xe=Vi(oe.value),Be=oe.value!==null?oe.value:le;if(p){if(de!==p)return[new Sn(oe.key,Be,`${de} stop domain type must match previous stop domain type ${p}`)]}else p=de;if(de!=="number"&&de!=="string"&&de!=="boolean"&&typeof xe!="number"&&typeof xe!="string"&&typeof xe!="boolean")return[new Sn(oe.key,Be,"stop domain value must be a number, string, or boolean")];if(de!=="number"&&f!=="categorical"){let $e=`number expected, ${de} found`;return jc(l)&&f===void 0&&($e+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Sn(oe.key,Be,$e)]}return f!=="categorical"||de!=="number"||typeof xe=="number"&&isFinite(xe)&&Math.floor(xe)===xe?f!=="categorical"&&de==="number"&&typeof xe=="number"&&typeof A=="number"&&A!==void 0&&xe<A?[new Sn(oe.key,Be,"stop domain values must appear in ascending order")]:(A=xe,f==="categorical"&&xe in C?[new Sn(oe.key,Be,"stop domain values must be unique")]:(C[xe]=!0,[])):[new Sn(oe.key,Be,`integer expected, found ${String(xe)}`)]}}function hs(c){const l=(c.expressionContext==="property"?Kh:Qh)(gi(c.value),c.valueSpec);if(l.result==="error")return l.value.map(p=>new Sn(`${c.key}${p.key}`,c.value,p.message));const f=l.value.expression||l.value._styleExpression.expression;if(c.expressionContext==="property"&&c.propertyKey==="text-font"&&!f.outputDefined())return[new Sn(c.key,c.value,`Invalid data expression for "${c.propertyKey}". Output values must be contained as literals within the expression.`)];if(c.expressionContext==="property"&&c.propertyType==="layout"&&!pa(f))return[new Sn(c.key,c.value,'"feature-state" data expressions are not supported with layout properties.')];if(c.expressionContext==="filter")return Vc(f,c);if(c.expressionContext&&c.expressionContext.indexOf("cluster")===0){if(!Vf(f,["zoom","feature-state"]))return[new Sn(c.key,c.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(c.expressionContext==="cluster-initial"&&!fu(f))return[new Sn(c.key,c.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Vc(c,l){const f=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(l.valueSpec&&l.valueSpec.expression)for(const A of l.valueSpec.expression.parameters)f.delete(A);if(f.size===0)return[];const p=[];return c instanceof ol&&f.has(c.name)?[new Sn(l.key,l.value,`["${c.name}"] expression is not supported in a filter for a ${l.object.type} layer with id: ${l.object.id}`)]:(c.eachChild(A=>{p.push(...Vc(A,l))}),p)}function Ga(c){const l=c.key,f=c.value,p=c.valueSpec,A=[];return Array.isArray(p.values)?p.values.indexOf(Vi(f))===-1&&A.push(new Sn(l,f,`expected one of [${p.values.join(", ")}], ${JSON.stringify(f)} found`)):Object.keys(p.values).indexOf(Vi(f))===-1&&A.push(new Sn(l,f,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(f)} found`)),A}function Mr(c){if(c===!0||c===!1)return!0;if(!Array.isArray(c)||c.length===0)return!1;switch(c[0]){case"has":return c.length>=2&&c[1]!=="$id"&&c[1]!=="$type";case"in":return c.length>=3&&(typeof c[1]!="string"||Array.isArray(c[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return c.length!==3||Array.isArray(c[1])||Array.isArray(c[2]);case"any":case"all":for(const l of c.slice(1))if(!Mr(l)&&typeof l!="boolean")return!1;return!0;default:return!0}}function ma(c,l="fill"){if(c==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Mr(c)||(c=Dn(c));const f=c;let p=!0;try{p=function(U){if(!Wf(U))return U;let W=gi(U);return $c(W),W=V_(W),W}(f)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(f,null,2)}
        `)}const A=pt[`filter_${l}`],b=Qh(p,A);let C=null;if(b.result==="error")throw new Error(b.value.map(U=>`${U.key}: ${U.message}`).join(", "));C=(U,W,K)=>b.value.evaluate(U,W,{},K);let M=null,N=null;if(p!==f){const U=Qh(f,A);if(U.result==="error")throw new Error(U.value.map(W=>`${W.key}: ${W.message}`).join(", "));M=(W,K,ee,oe,le)=>U.value.evaluate(W,K,{},ee,void 0,void 0,oe,le),N=!fu(U.value.expression)}return{filter:C,dynamicFilter:M||void 0,needGeometry:An(p),needFeature:!!N}}function V_(c){if(!Array.isArray(c))return c;const l=function(f){if(HA.has(f[0])){for(let p=1;p<f.length;p++)if(Wf(f[p]))return!0}return f}(c);return l===!0?l:l.map(f=>V_(f))}function $c(c){let l=!1;const f=[];if(c[0]==="case"){for(let p=1;p<c.length-1;p+=2)l=l||Wf(c[p]),f.push(c[p+1]);f.push(c[c.length-1])}else if(c[0]==="match"){l=l||Wf(c[1]);for(let p=2;p<c.length-1;p+=2)f.push(c[p+1]);f.push(c[c.length-1])}else if(c[0]==="step"){l=l||Wf(c[1]);for(let p=1;p<c.length-1;p+=2)f.push(c[p+1])}l&&(c.length=0,c.push("any",...f));for(let p=1;p<c.length;p++)$c(c[p])}function Wf(c){if(!Array.isArray(c))return!1;if((l=c[0])==="pitch"||l==="distance-from-center")return!0;var l;for(let f=1;f<c.length;f++)if(Wf(c[f]))return!0;return!1}const HA=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Hc(c,l){return c<l?-1:c>l?1:0}function An(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(let l=1;l<c.length;l++)if(An(c[l]))return!0;return!1}function Dn(c){if(!c)return!0;const l=c[0];return c.length<=1?l!=="any":l==="=="?Xg(c[1],c[2],"=="):l==="!="?Aa(Xg(c[1],c[2],"==")):l==="<"||l===">"||l==="<="||l===">="?Xg(c[1],c[2],l):l==="any"?(f=c.slice(1),["any"].concat(f.map(Dn))):l==="all"?["all"].concat(c.slice(1).map(Dn)):l==="none"?["all"].concat(c.slice(1).map(Dn).map(Aa)):l==="in"?Jh(c[1],c.slice(2)):l==="!in"?Aa(Jh(c[1],c.slice(2))):l==="has"?ed(c[1]):l==="!has"?Aa(ed(c[1])):l!=="within"||c;var f}function Xg(c,l,f){switch(c){case"$type":return[`filter-type-${f}`,l];case"$id":return[`filter-id-${f}`,l];default:return[`filter-${f}`,c,l]}}function Jh(c,l){if(l.length===0)return!1;switch(c){case"$type":return["filter-type-in",["literal",l]];case"$id":return["filter-id-in",["literal",l]];default:return l.length>200&&!l.some(f=>typeof f!=typeof l[0])?["filter-in-large",c,["literal",l.sort(Hc)]]:["filter-in-small",c,["literal",l]]}}function ed(c){switch(c){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",c]}}function Aa(c){return["!",c]}function td(c){return Mr(gi(c.value))?hs(za({},c,{expressionContext:"filter",valueSpec:c.styleSpec[`filter_${c.layerType||"fill"}`]})):al(c)}function al(c){const l=c.value,f=c.key;if(Xr(l)!=="array")return[new Sn(f,l,`array expected, ${Xr(l)} found`)];const p=c.styleSpec;let A,b=[];if(l.length<1)return[new Sn(f,l,"filter array must have at least 1 element")];switch(b=b.concat(Ga({key:`${f}[0]`,value:l[0],valueSpec:p.filter_operator,style:c.style,styleSpec:c.styleSpec})),Vi(l[0])){case"<":case"<=":case">":case">=":l.length>=2&&Vi(l[1])==="$type"&&b.push(new Sn(f,l,`"$type" cannot be use with operator "${l[0]}"`));case"==":case"!=":l.length!==3&&b.push(new Sn(f,l,`filter array for operator "${l[0]}" must have 3 elements`));case"in":case"!in":l.length>=2&&(A=Xr(l[1]),A!=="string"&&b.push(new Sn(`${f}[1]`,l[1],`string expected, ${A} found`)));for(let C=2;C<l.length;C++)A=Xr(l[C]),Vi(l[1])==="$type"?b=b.concat(Ga({key:`${f}[${C}]`,value:l[C],valueSpec:p.geometry_type,style:c.style,styleSpec:c.styleSpec})):A!=="string"&&A!=="number"&&A!=="boolean"&&b.push(new Sn(`${f}[${C}]`,l[C],`string, number, or boolean expected, ${A} found`));break;case"any":case"all":case"none":for(let C=1;C<l.length;C++)b=b.concat(al({key:`${f}[${C}]`,value:l[C],style:c.style,styleSpec:c.styleSpec}));break;case"has":case"!has":A=Xr(l[1]),l.length!==2?b.push(new Sn(f,l,`filter array for "${l[0]}" operator must have 2 elements`)):A!=="string"&&b.push(new Sn(`${f}[1]`,l[1],`string expected, ${A} found`));break;case"within":A=Xr(l[1]),l.length!==2?b.push(new Sn(f,l,`filter array for "${l[0]}" operator must have 2 elements`)):A!=="object"&&b.push(new Sn(`${f}[1]`,l[1],`object expected, ${A} found`))}return b}function y(c,l){const f=c.key,p=c.style,A=c.styleSpec,b=c.value,C=c.objectKey,M=A[`${l}_${c.layerType}`];if(!M)return[];const N=C.match(/^(.*)-transition$/);if(l==="paint"&&N&&M[N[1]]&&M[N[1]].transition)return tt({key:f,value:b,valueSpec:A.transition,style:p,styleSpec:A});const U=c.valueSpec||M[C];if(!U)return[new Sn(f,b,`unknown property "${C}"`)];let W;if(Xr(b)==="string"&&jc(U)&&!U.tokens&&(W=/^{([^}]+)}$/.exec(b))){const ee=`\`{ "type": "identity", "property": ${W?JSON.stringify(W[1]):'"_"'} }\``;return[new Sn(f,b,`"${C}" does not support interpolation syntax
Use an identity property function instead: ${ee}.`)]}const K=[];return c.layerType==="symbol"&&(C==="text-field"&&p&&!p.glyphs&&K.push(new Sn(f,b,'use of "text-field" requires a style "glyphs" property')),C==="text-font"&&bp(gi(b))&&Vi(b.type)==="identity"&&K.push(new Sn(f,b,'"text-font" does not support identity functions'))),K.concat(tt({key:c.key,value:b,valueSpec:U,style:p,styleSpec:A,expressionContext:"property",propertyType:l,propertyKey:C}))}function x(c){return y(c,"paint")}function T(c){return y(c,"layout")}function R(c){let l=[];const f=c.value,p=c.key,A=c.style,b=c.styleSpec;f.type||f.ref||l.push(new Sn(p,f,'either "type" or "ref" is required'));let C=Vi(f.type);const M=Vi(f.ref);if(f.id){const N=Vi(f.id);for(let U=0;U<c.arrayIndex;U++){const W=A.layers[U];Vi(W.id)===N&&l.push(new Sn(p,f.id,`duplicate layer id "${f.id}", previously used at line ${W.id.__line__}`))}}if("ref"in f){let N;["type","source","source-layer","filter","layout"].forEach(U=>{U in f&&l.push(new Sn(p,f[U],`"${U}" is prohibited for ref layers`))}),A.layers.forEach(U=>{Vi(U.id)===M&&(N=U)}),N?N.ref?l.push(new Sn(p,f.ref,"ref cannot reference another ref layer")):C=Vi(N.type):typeof M=="string"&&l.push(new Sn(p,f.ref,`ref layer "${M}" not found`))}else if(C!=="background"&&C!=="sky")if(f.source){const N=A.sources&&A.sources[f.source],U=N&&Vi(N.type);N?U==="vector"&&C==="raster"?l.push(new Sn(p,f.source,`layer "${f.id}" requires a raster source`)):U==="raster"&&C!=="raster"?l.push(new Sn(p,f.source,`layer "${f.id}" requires a vector source`)):U!=="vector"||f["source-layer"]?U==="raster-dem"&&C!=="hillshade"?l.push(new Sn(p,f.source,"raster-dem source can only be used with layer type 'hillshade'.")):C!=="line"||!f.paint||!f.paint["line-gradient"]&&!f.paint["line-trim-offset"]||U==="geojson"&&N.lineMetrics||l.push(new Sn(p,f,`layer "${f.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):l.push(new Sn(p,f,`layer "${f.id}" must specify a "source-layer"`)):l.push(new Sn(p,f.source,`source "${f.source}" not found`))}else l.push(new Sn(p,f,'missing required property "source"'));return l=l.concat(Vl({key:p,value:f,valueSpec:b.layer,style:c.style,styleSpec:c.styleSpec,objectElementValidators:{"*":()=>[],type:()=>tt({key:`${p}.type`,value:f.type,valueSpec:b.layer.type,style:c.style,styleSpec:c.styleSpec,object:f,objectKey:"type"}),filter:N=>td(za({layerType:C},N)),layout:N=>Vl({layer:f,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":U=>T(za({layerType:C},U))}}),paint:N=>Vl({layer:f,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":U=>x(za({layerType:C},U))}})}})),l}function B(c){const l=c.value,f=c.key,p=Xr(l);return p!=="string"?[new Sn(f,l,`string expected, ${p} found`)]:[]}const j={promoteId:function({key:c,value:l}){if(Xr(l)==="string")return B({key:c,value:l});{const f=[];for(const p in l)f.push(...B({key:`${c}.${p}`,value:l[p]}));return f}}};function G(c){const l=c.value,f=c.key,p=c.styleSpec,A=c.style;if(!l.type)return[new Sn(f,l,'"type" is required')];const b=Vi(l.type);let C;switch(b){case"vector":case"raster":case"raster-dem":return C=Vl({key:f,value:l,valueSpec:p[`source_${b.replace("-","_")}`],style:c.style,styleSpec:p,objectElementValidators:j}),C;case"geojson":if(C=Vl({key:f,value:l,valueSpec:p.source_geojson,style:A,styleSpec:p,objectElementValidators:j}),l.cluster)for(const M in l.clusterProperties){const[N,U]=l.clusterProperties[M],W=typeof N=="string"?[N,["accumulated"],["get",M]]:N;C.push(...hs({key:`${f}.${M}.map`,value:U,expressionContext:"cluster-map"})),C.push(...hs({key:`${f}.${M}.reduce`,value:W,expressionContext:"cluster-reduce"}))}return C;case"video":return Vl({key:f,value:l,valueSpec:p.source_video,style:A,styleSpec:p});case"image":return Vl({key:f,value:l,valueSpec:p.source_image,style:A,styleSpec:p});case"canvas":return[new Sn(f,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ga({key:`${f}.type`,value:l.type,valueSpec:{values:Z(p)},style:A,styleSpec:p})}}function Z(c){return c.source.reduce((l,f)=>{const p=c[f];return p.type.type==="enum"&&(l=l.concat(Object.keys(p.type.values))),l},[])}function ae(c){const l=c.value,f=c.styleSpec,p=f.light,A=c.style;let b=[];const C=Xr(l);if(l===void 0)return b;if(C!=="object")return b=b.concat([new Sn("light",l,`object expected, ${C} found`)]),b;for(const M in l){const N=M.match(/^(.*)-transition$/);b=b.concat(N&&p[N[1]]&&p[N[1]].transition?tt({key:M,value:l[M],valueSpec:f.transition,style:A,styleSpec:f}):p[M]?tt({key:M,value:l[M],valueSpec:p[M],style:A,styleSpec:f}):[new Sn(M,l[M],`unknown property "${M}"`)])}return b}function pe(c){const l=c.value,f=c.key,p=c.style,A=c.styleSpec,b=A.terrain;let C=[];const M=Xr(l);if(l===void 0)return C;if(M!=="object")return C=C.concat([new Sn("terrain",l,`object expected, ${M} found`)]),C;for(const N in l){const U=N.match(/^(.*)-transition$/);C=C.concat(U&&b[U[1]]&&b[U[1]].transition?tt({key:N,value:l[N],valueSpec:A.transition,style:p,styleSpec:A}):b[N]?tt({key:N,value:l[N],valueSpec:b[N],style:p,styleSpec:A}):[new Sn(N,l[N],`unknown property "${N}"`)])}if(l.source){const N=p.sources&&p.sources[l.source],U=N&&Vi(N.type);N?U!=="raster-dem"&&C.push(new Sn(f,l.source,`terrain cannot be used with a source of type ${String(U)}, it only be used with a "raster-dem" source type`)):C.push(new Sn(f,l.source,`source "${l.source}" not found`))}else C.push(new Sn(f,l,'terrain is missing required property "source"'));return C}function _e(c){const l=c.value,f=c.style,p=c.styleSpec,A=p.fog;let b=[];const C=Xr(l);if(l===void 0)return b;if(C!=="object")return b=b.concat([new Sn("fog",l,`object expected, ${C} found`)]),b;for(const M in l){const N=M.match(/^(.*)-transition$/);b=b.concat(N&&A[N[1]]&&A[N[1]].transition?tt({key:M,value:l[M],valueSpec:p.transition,style:f,styleSpec:p}):A[M]?tt({key:M,value:l[M],valueSpec:A[M],style:f,styleSpec:p}):[new Sn(M,l[M],`unknown property "${M}"`)])}return b}const Xe={"*":()=>[],array:j_,boolean:function(c){const l=c.value,f=c.key,p=Xr(l);return p!=="boolean"?[new Sn(f,l,`boolean expected, ${p} found`)]:[]},number:Cp,color:function(c){const l=c.key,f=c.value,p=Xr(f);return p!=="string"?[new Sn(l,f,`color expected, ${p} found`)]:Ao(f)===null?[new Sn(l,f,`color expected, "${f}" found`)]:[]},enum:Ga,filter:td,function:Pp,layer:R,object:Vl,source:G,light:ae,terrain:pe,fog:_e,string:B,formatted:function(c){return B(c).length===0?[]:hs(c)},resolvedImage:function(c){return B(c).length===0?[]:hs(c)},projection:function(c){const l=c.value,f=c.styleSpec,p=f.projection,A=c.style;let b=[];const C=Xr(l);if(C==="object")for(const M in l)b=b.concat(tt({key:M,value:l[M],valueSpec:p[M],style:A,styleSpec:f}));else C!=="string"&&(b=b.concat([new Sn("projection",l,`object or string expected, ${C} found`)]));return b}};function tt(c){const l=c.value,f=c.valueSpec,p=c.styleSpec;return f.expression&&bp(Vi(l))?Pp(c):f.expression&&Zi(gi(l))?hs(c):f.type&&Xe[f.type]?Xe[f.type](c):Vl(za({},c,{valueSpec:f.type?p[f.type]:f}))}function gt(c){const l=c.value,f=c.key,p=B(c);return p.length||(l.indexOf("{fontstack}")===-1&&p.push(new Sn(f,l,'"glyphs" url must include a "{fontstack}" token')),l.indexOf("{range}")===-1&&p.push(new Sn(f,l,'"glyphs" url must include a "{range}" token'))),p}function kt(c,l=pt){return Cn(tt({key:"",value:c,valueSpec:l.$root,styleSpec:l,style:c,objectElementValidators:{glyphs:gt,"*":()=>[]}}))}const Vt=c=>Cn(x(c)),yn=c=>Cn(T(c));function Cn(c){return c.slice().sort((l,f)=>l.line&&f.line?l.line-f.line:0)}function Rt(c,l){let f=!1;if(l&&l.length)for(const p of l)c.fire(new Hn(new Error(p.message))),f=!0;return f}var fn=On,it=3;function On(c,l,f){var p=this.cells=[];if(c instanceof ArrayBuffer){this.arrayBuffer=c;var A=new Int32Array(this.arrayBuffer);c=A[0],this.d=(l=A[1])+2*(f=A[2]);for(var b=0;b<this.d*this.d;b++){var C=A[it+b],M=A[it+b+1];p.push(C===M?null:A.subarray(C,M))}var N=A[it+p.length+1];this.keys=A.subarray(A[it+p.length],N),this.bboxes=A.subarray(N),this.insert=this._insertReadonly}else{this.d=l+2*f;for(var U=0;U<this.d*this.d;U++)p.push([]);this.keys=[],this.bboxes=[]}this.n=l,this.extent=c,this.padding=f,this.scale=l/c,this.uid=0;var W=f/l*c;this.min=-W,this.max=c+W}On.prototype.insert=function(c,l,f,p,A){this._forEachCell(l,f,p,A,this._insertCell,this.uid++),this.keys.push(c),this.bboxes.push(l),this.bboxes.push(f),this.bboxes.push(p),this.bboxes.push(A)},On.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},On.prototype._insertCell=function(c,l,f,p,A,b){this.cells[A].push(b)},On.prototype.query=function(c,l,f,p,A){var b=this.min,C=this.max;if(c<=b&&l<=b&&C<=f&&C<=p&&!A)return Array.prototype.slice.call(this.keys);var M=[];return this._forEachCell(c,l,f,p,this._queryCell,M,{},A),M},On.prototype._queryCell=function(c,l,f,p,A,b,C,M){var N=this.cells[A];if(N!==null)for(var U=this.keys,W=this.bboxes,K=0;K<N.length;K++){var ee=N[K];if(C[ee]===void 0){var oe=4*ee;(M?M(W[oe+0],W[oe+1],W[oe+2],W[oe+3]):c<=W[oe+2]&&l<=W[oe+3]&&f>=W[oe+0]&&p>=W[oe+1])?(C[ee]=!0,b.push(U[ee])):C[ee]=!1}}},On.prototype._forEachCell=function(c,l,f,p,A,b,C,M){for(var N=this._convertToCellCoord(c),U=this._convertToCellCoord(l),W=this._convertToCellCoord(f),K=this._convertToCellCoord(p),ee=N;ee<=W;ee++)for(var oe=U;oe<=K;oe++){var le=this.d*oe+ee;if((!M||M(this._convertFromCellCoord(ee),this._convertFromCellCoord(oe),this._convertFromCellCoord(ee+1),this._convertFromCellCoord(oe+1)))&&A.call(this,c,l,f,p,le,b,C,M))return}},On.prototype._convertFromCellCoord=function(c){return(c-this.padding)/this.scale},On.prototype._convertToCellCoord=function(c){return Math.max(0,Math.min(this.d-1,Math.floor(c*this.scale)+this.padding))},On.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var c=this.cells,l=it+this.cells.length+1+1,f=0,p=0;p<this.cells.length;p++)f+=this.cells[p].length;var A=new Int32Array(l+f+this.keys.length+this.bboxes.length);A[0]=this.extent,A[1]=this.n,A[2]=this.padding;for(var b=l,C=0;C<c.length;C++){var M=c[C];A[it+C]=b,A.set(M,b),b+=M.length}return A[it+c.length]=b,A.set(this.keys,b),A[it+c.length+1]=b+=this.keys.length,A.set(this.bboxes,b),b+=this.bboxes.length,A.buffer};var Bn=z(fn);const Pn={};function Mt(c,l,f={}){Object.defineProperty(c,"_classRegistryKey",{value:l,writeable:!1}),Pn[l]={klass:c,omit:f.omit||[]}}Mt(Object,"Object"),Bn.serialize=function(c,l){const f=c.toArrayBuffer();return l&&l.push(f),{buffer:f}},Bn.deserialize=function(c){return new Bn(c.buffer)},Object.defineProperty(Bn,"name",{value:"Grid"}),Mt(Bn,"Grid"),Mt(lo,"Color"),Mt(Error,"Error"),Mt(lu,"AJAXError"),Mt(il,"ResolvedImage"),Mt(Sp,"StylePropertyFunction"),Mt(wp,"StyleExpression",{omit:["_evaluator"]}),Mt(Ep,"ZoomDependentExpression"),Mt($A,"ZoomConstantExpression"),Mt(ol,"CompoundExpression",{omit:["_evaluate"]});for(const c in vp)Pn[vp[c]._classRegistryKey]||Mt(vp[c],`Expression${c}`);function br(c){return c&&typeof ArrayBuffer<"u"&&(c instanceof ArrayBuffer||c.constructor&&c.constructor.name==="ArrayBuffer")}function ui(c){return u.ImageBitmap&&c instanceof u.ImageBitmap}function Vr(c,l){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp)return c;if(br(c)||ui(c))return l&&l.push(c),c;if(ArrayBuffer.isView(c)){const f=c;return l&&l.push(f.buffer),f}if(c instanceof u.ImageData)return l&&l.push(c.data.buffer),c;if(Array.isArray(c)){const f=[];for(const p of c)f.push(Vr(p,l));return f}if(typeof c=="object"){const f=c.constructor,p=f._classRegistryKey;if(!p)throw new Error(`can't serialize object of unregistered class ${p}`);const A=f.serialize?f.serialize(c,l):{};if(!f.serialize){for(const b in c)c.hasOwnProperty(b)&&(Pn[p].omit.indexOf(b)>=0||(A[b]=Vr(c[b],l)));c instanceof Error&&(A.message=c.message)}if(A.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(A.$name=p),A}throw new Error("can't serialize object of type "+typeof c)}function Jr(c){if(c==null||typeof c=="boolean"||typeof c=="number"||typeof c=="string"||c instanceof Boolean||c instanceof Number||c instanceof String||c instanceof Date||c instanceof RegExp||br(c)||ui(c)||ArrayBuffer.isView(c)||c instanceof u.ImageData)return c;if(Array.isArray(c))return c.map(Jr);if(typeof c=="object"){const l=c.$name||"Object",{klass:f}=Pn[l];if(!f)throw new Error(`can't deserialize unregistered class ${l}`);if(f.deserialize)return f.deserialize(c);const p=Object.create(f.prototype);for(const A of Object.keys(c))A!=="$name"&&(p[A]=Jr(c[A]));return p}throw new Error("can't deserialize object of type "+typeof c)}const qt={"Latin-1 Supplement":c=>c>=128&&c<=255,Arabic:c=>c>=1536&&c<=1791,"Arabic Supplement":c=>c>=1872&&c<=1919,"Arabic Extended-A":c=>c>=2208&&c<=2303,"Hangul Jamo":c=>c>=4352&&c<=4607,"Unified Canadian Aboriginal Syllabics":c=>c>=5120&&c<=5759,Khmer:c=>c>=6016&&c<=6143,"Unified Canadian Aboriginal Syllabics Extended":c=>c>=6320&&c<=6399,"General Punctuation":c=>c>=8192&&c<=8303,"Letterlike Symbols":c=>c>=8448&&c<=8527,"Number Forms":c=>c>=8528&&c<=8591,"Miscellaneous Technical":c=>c>=8960&&c<=9215,"Control Pictures":c=>c>=9216&&c<=9279,"Optical Character Recognition":c=>c>=9280&&c<=9311,"Enclosed Alphanumerics":c=>c>=9312&&c<=9471,"Geometric Shapes":c=>c>=9632&&c<=9727,"Miscellaneous Symbols":c=>c>=9728&&c<=9983,"Miscellaneous Symbols and Arrows":c=>c>=11008&&c<=11263,"CJK Radicals Supplement":c=>c>=11904&&c<=12031,"Kangxi Radicals":c=>c>=12032&&c<=12255,"Ideographic Description Characters":c=>c>=12272&&c<=12287,"CJK Symbols and Punctuation":c=>c>=12288&&c<=12351,Hiragana:c=>c>=12352&&c<=12447,Katakana:c=>c>=12448&&c<=12543,Bopomofo:c=>c>=12544&&c<=12591,"Hangul Compatibility Jamo":c=>c>=12592&&c<=12687,Kanbun:c=>c>=12688&&c<=12703,"Bopomofo Extended":c=>c>=12704&&c<=12735,"CJK Strokes":c=>c>=12736&&c<=12783,"Katakana Phonetic Extensions":c=>c>=12784&&c<=12799,"Enclosed CJK Letters and Months":c=>c>=12800&&c<=13055,"CJK Compatibility":c=>c>=13056&&c<=13311,"CJK Unified Ideographs Extension A":c=>c>=13312&&c<=19903,"Yijing Hexagram Symbols":c=>c>=19904&&c<=19967,"CJK Unified Ideographs":c=>c>=19968&&c<=40959,"Yi Syllables":c=>c>=40960&&c<=42127,"Yi Radicals":c=>c>=42128&&c<=42191,"Hangul Jamo Extended-A":c=>c>=43360&&c<=43391,"Hangul Syllables":c=>c>=44032&&c<=55215,"Hangul Jamo Extended-B":c=>c>=55216&&c<=55295,"Private Use Area":c=>c>=57344&&c<=63743,"CJK Compatibility Ideographs":c=>c>=63744&&c<=64255,"Arabic Presentation Forms-A":c=>c>=64336&&c<=65023,"Vertical Forms":c=>c>=65040&&c<=65055,"CJK Compatibility Forms":c=>c>=65072&&c<=65103,"Small Form Variants":c=>c>=65104&&c<=65135,"Arabic Presentation Forms-B":c=>c>=65136&&c<=65279,"Halfwidth and Fullwidth Forms":c=>c>=65280&&c<=65519};function xi(c){for(const l of c)if(dx(l.charCodeAt(0)))return!0;return!1}function $i(c){for(const l of c)if(!gr(l.charCodeAt(0)))return!1;return!0}function gr(c){return!(qt.Arabic(c)||qt["Arabic Supplement"](c)||qt["Arabic Extended-A"](c)||qt["Arabic Presentation Forms-A"](c)||qt["Arabic Presentation Forms-B"](c))}function dx(c){return!(c!==746&&c!==747&&(c<4352||!(qt["Bopomofo Extended"](c)||qt.Bopomofo(c)||qt["CJK Compatibility Forms"](c)&&!(c>=65097&&c<=65103)||qt["CJK Compatibility Ideographs"](c)||qt["CJK Compatibility"](c)||qt["CJK Radicals Supplement"](c)||qt["CJK Strokes"](c)||!(!qt["CJK Symbols and Punctuation"](c)||c>=12296&&c<=12305||c>=12308&&c<=12319||c===12336)||qt["CJK Unified Ideographs Extension A"](c)||qt["CJK Unified Ideographs"](c)||qt["Enclosed CJK Letters and Months"](c)||qt["Hangul Compatibility Jamo"](c)||qt["Hangul Jamo Extended-A"](c)||qt["Hangul Jamo Extended-B"](c)||qt["Hangul Jamo"](c)||qt["Hangul Syllables"](c)||qt.Hiragana(c)||qt["Ideographic Description Characters"](c)||qt.Kanbun(c)||qt["Kangxi Radicals"](c)||qt["Katakana Phonetic Extensions"](c)||qt.Katakana(c)&&c!==12540||!(!qt["Halfwidth and Fullwidth Forms"](c)||c===65288||c===65289||c===65293||c>=65306&&c<=65310||c===65339||c===65341||c===65343||c>=65371&&c<=65503||c===65507||c>=65512&&c<=65519)||!(!qt["Small Form Variants"](c)||c>=65112&&c<=65118||c>=65123&&c<=65126)||qt["Unified Canadian Aboriginal Syllabics"](c)||qt["Unified Canadian Aboriginal Syllabics Extended"](c)||qt["Vertical Forms"](c)||qt["Yijing Hexagram Symbols"](c)||qt["Yi Syllables"](c)||qt["Yi Radicals"](c))))}function w2(c){return!(dx(c)||function(l){return!!(qt["Latin-1 Supplement"](l)&&(l===167||l===169||l===174||l===177||l===188||l===189||l===190||l===215||l===247)||qt["General Punctuation"](l)&&(l===8214||l===8224||l===8225||l===8240||l===8241||l===8251||l===8252||l===8258||l===8263||l===8264||l===8265||l===8273)||qt["Letterlike Symbols"](l)||qt["Number Forms"](l)||qt["Miscellaneous Technical"](l)&&(l>=8960&&l<=8967||l>=8972&&l<=8991||l>=8996&&l<=9e3||l===9003||l>=9085&&l<=9114||l>=9150&&l<=9165||l===9167||l>=9169&&l<=9179||l>=9186&&l<=9215)||qt["Control Pictures"](l)&&l!==9251||qt["Optical Character Recognition"](l)||qt["Enclosed Alphanumerics"](l)||qt["Geometric Shapes"](l)||qt["Miscellaneous Symbols"](l)&&!(l>=9754&&l<=9759)||qt["Miscellaneous Symbols and Arrows"](l)&&(l>=11026&&l<=11055||l>=11088&&l<=11097||l>=11192&&l<=11243)||qt["CJK Symbols and Punctuation"](l)||qt.Katakana(l)||qt["Private Use Area"](l)||qt["CJK Compatibility Forms"](l)||qt["Small Form Variants"](l)||qt["Halfwidth and Fullwidth Forms"](l)||l===8734||l===8756||l===8757||l>=9984&&l<=10087||l>=10102&&l<=10131||l===65532||l===65533)}(c))}function E2(c){return c>=1424&&c<=2303||qt["Arabic Presentation Forms-A"](c)||qt["Arabic Presentation Forms-B"](c)}function ZL(c,l){return!(!l&&E2(c)||c>=2304&&c<=3583||c>=3840&&c<=4255||qt.Khmer(c))}function YL(c){for(const l of c)if(E2(l.charCodeAt(0)))return!0;return!1}const px="deferred",gx="loading",mx="loaded";let Zg=null,v="unavailable",h=null;const m=function(c){c&&typeof c=="string"&&c.indexOf("NetworkError")>-1&&(v="error"),Zg&&Zg(c)};function S(){I.fire(new $o("pluginStateChange",{pluginStatus:v,pluginURL:h}))}const I=new Ke,L=function(){return v},$=function(){if(v!==px||!h)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");v=gx,S(),h&&Fc({url:h},c=>{c?m(c):(v=mx,S())})},H={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>v===mx||H.applyArabicShaping!=null,isLoading:()=>v===gx,setState(c){v=c.pluginStatus,h=c.pluginURL},isParsed:()=>H.applyArabicShaping!=null&&H.processBidirectionalText!=null&&H.processStyledBidirectionalText!=null,getPluginURL:()=>h};class Q{constructor(l,f){this.zoom=l,f?(this.now=f.now,this.fadeDuration=f.fadeDuration,this.transition=f.transition,this.pitch=f.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(l){return function(f,p){for(const A of f)if(!ZL(A.charCodeAt(0),p))return!1;return!0}(l,H.isLoaded())}}class ne{constructor(l,f){this.property=l,this.value=f,this.expression=function(p,A){if(bp(p))return new Sp(p,A);if(Zi(p)){const b=Kh(p,A);if(b.result==="error")throw new Error(b.value.map(C=>`${C.key}: ${C.message}`).join(", "));return b.value}{let b=p;return typeof p=="string"&&A.type==="color"&&(b=lo.parse(p)),{kind:"constant",evaluate:()=>b}}}(f===void 0?l.specification.default:f,l.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(l,f,p){return this.property.possiblyEvaluate(this,l,f,p)}}class te{constructor(l){this.property=l,this.value=new ne(l,void 0)}transitioned(l,f){return new ve(this.property,this.value,f,Ct({},l.transition,this.transition),l.now)}untransitioned(){return new ve(this.property,this.value,null,{},0)}}class fe{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitionablePropertyValues)}getValue(l){return It(this._values[l].value.value)}setValue(l,f){this._values.hasOwnProperty(l)||(this._values[l]=new te(this._values[l].property)),this._values[l].value=new ne(this._values[l].property,f===null?void 0:It(f))}getTransition(l){return It(this._values[l].transition)}setTransition(l,f){this._values.hasOwnProperty(l)||(this._values[l]=new te(this._values[l].property)),this._values[l].transition=It(f)||void 0}serialize(){const l={};for(const f of Object.keys(this._values)){const p=this.getValue(f);p!==void 0&&(l[f]=p);const A=this.getTransition(f);A!==void 0&&(l[`${f}-transition`]=A)}return l}transitioned(l,f){const p=new Te(this._properties);for(const A of Object.keys(this._values))p._values[A]=this._values[A].transitioned(l,f._values[A]);return p}untransitioned(){const l=new Te(this._properties);for(const f of Object.keys(this._values))l._values[f]=this._values[f].untransitioned();return l}}class ve{constructor(l,f,p,A,b){const C=A.delay||0,M=A.duration||0;b=b||0,this.property=l,this.value=f,this.begin=b+C,this.end=this.begin+M,l.specification.transition&&(A.delay||A.duration)&&(this.prior=p)}possiblyEvaluate(l,f,p){const A=l.now||0,b=this.value.possiblyEvaluate(l,f,p),C=this.prior;if(C){if(A>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(A<this.begin)return C.possiblyEvaluate(l,f,p);{const M=(A-this.begin)/(this.end-this.begin);return this.property.interpolate(C.possiblyEvaluate(l,f,p),b,Ye(M))}}return b}}class Te{constructor(l){this._properties=l,this._values=Object.create(l.defaultTransitioningPropertyValues)}possiblyEvaluate(l,f,p){const A=new Le(this._properties);for(const b of Object.keys(this._values))A._values[b]=this._values[b].possiblyEvaluate(l,f,p);return A}hasTransition(){for(const l of Object.keys(this._values))if(this._values[l].prior)return!0;return!1}}class Ie{constructor(l){this._properties=l,this._values=Object.create(l.defaultPropertyValues)}getValue(l){return It(this._values[l].value)}setValue(l,f){this._values[l]=new ne(this._values[l].property,f===null?void 0:It(f))}serialize(){const l={};for(const f of Object.keys(this._values)){const p=this.getValue(f);p!==void 0&&(l[f]=p)}return l}possiblyEvaluate(l,f,p){const A=new Le(this._properties);for(const b of Object.keys(this._values))A._values[b]=this._values[b].possiblyEvaluate(l,f,p);return A}}class Pe{constructor(l,f,p){this.property=l,this.value=f,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(l){return this.value.kind==="constant"?this.value.value:l}evaluate(l,f,p,A){return this.property.evaluate(this.value,this.parameters,l,f,p,A)}}class Le{constructor(l){this._properties=l,this._values=Object.create(l.defaultPossiblyEvaluatedValues)}get(l){return this._values[l]}}class he{constructor(l){this.specification=l}possiblyEvaluate(l,f){return l.expression.evaluate(f)}interpolate(l,f,p){const A=hu[this.specification.type];return A?A(l,f,p):l}}class Se{constructor(l,f){this.specification=l,this.overrides=f}possiblyEvaluate(l,f,p,A){return new Pe(this,l.expression.kind==="constant"||l.expression.kind==="camera"?{kind:"constant",value:l.expression.evaluate(f,null,{},p,A)}:l.expression,f)}interpolate(l,f,p){if(l.value.kind!=="constant"||f.value.kind!=="constant")return l;if(l.value.value===void 0||f.value.value===void 0)return new Pe(this,{kind:"constant",value:void 0},l.parameters);const A=hu[this.specification.type];return A?new Pe(this,{kind:"constant",value:A(l.value.value,f.value.value,p)},l.parameters):l}evaluate(l,f,p,A,b,C){return l.kind==="constant"?l.value:l.evaluate(f,p,A,b,C)}}class Fe{constructor(l){this.specification=l}possiblyEvaluate(l,f,p,A){return!!l.expression.evaluate(f,null,{},p,A)}interpolate(){return!1}}class ke{constructor(l){this.properties=l,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const f=new Q(0,{});for(const p in l){const A=l[p];A.specification.overridable&&this.overridableProperties.push(p);const b=this.defaultPropertyValues[p]=new ne(A,void 0),C=this.defaultTransitionablePropertyValues[p]=new te(A);this.defaultTransitioningPropertyValues[p]=C.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=b.possiblyEvaluate(f)}}}function Qe(c,l){return 256*(c=be(Math.floor(c),0,255))+be(Math.floor(l),0,255)}Mt(Se,"DataDrivenProperty"),Mt(he,"DataConstantProperty"),Mt(Fe,"ColorRampProperty");const et={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Je{constructor(l,f){this._structArray=l,this._pos1=f*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class lt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(l,f){return l._trim(),f&&(l.isTransferred=!0,f.push(l.arrayBuffer)),{length:l.length,arrayBuffer:l.arrayBuffer}}static deserialize(l){const f=Object.create(this.prototype);return f.arrayBuffer=l.arrayBuffer,f.length=l.length,f.capacity=l.arrayBuffer.byteLength/f.bytesPerElement,f._refreshViews(),f}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(l){this.reserve(l),this.length=l}reserve(l){if(l>this.capacity){this.capacity=Math.max(l,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const f=this.uint8;this._refreshViews(),f&&this.uint8.set(f)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function st(c,l=1){let f=0,p=0;return{members:c.map(A=>{const b=et[A.type].BYTES_PER_ELEMENT,C=f=xt(f,Math.max(l,b)),M=A.components||1;return p=Math.max(p,b),f+=b*M,{name:A.name,type:A.type,components:M,offset:C}}),size:xt(f,Math.max(p,l)),alignment:l}}function xt(c,l){return Math.ceil(c/l)*l}class en extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f){const p=this.length;return this.resize(p+1),this.emplace(p,l,f)}emplace(l,f,p){const A=2*l;return this.int16[A+0]=f,this.int16[A+1]=p,l}}en.prototype.bytesPerElement=4,Mt(en,"StructArrayLayout2i4");class mt extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,p){const A=this.length;return this.resize(A+1),this.emplace(A,l,f,p)}emplace(l,f,p,A){const b=3*l;return this.int16[b+0]=f,this.int16[b+1]=p,this.int16[b+2]=A,l}}mt.prototype.bytesPerElement=6,Mt(mt,"StructArrayLayout3i6");class Ut extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,p,A){const b=this.length;return this.resize(b+1),this.emplace(b,l,f,p,A)}emplace(l,f,p,A,b){const C=4*l;return this.int16[C+0]=f,this.int16[C+1]=p,this.int16[C+2]=A,this.int16[C+3]=b,l}}Ut.prototype.bytesPerElement=8,Mt(Ut,"StructArrayLayout4i8");class St extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,p,A,b,C,M){const N=this.length;return this.resize(N+1),this.emplace(N,l,f,p,A,b,C,M)}emplace(l,f,p,A,b,C,M,N){const U=6*l,W=12*l,K=3*l;return this.int16[U+0]=f,this.int16[U+1]=p,this.uint8[W+4]=A,this.uint8[W+5]=b,this.uint8[W+6]=C,this.uint8[W+7]=M,this.float32[K+2]=N,l}}St.prototype.bytesPerElement=12,Mt(St,"StructArrayLayout2i4ub1f12");class Kt extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,p,A){const b=this.length;return this.resize(b+1),this.emplace(b,l,f,p,A)}emplace(l,f,p,A,b){const C=4*l;return this.float32[C+0]=f,this.float32[C+1]=p,this.float32[C+2]=A,this.float32[C+3]=b,l}}Kt.prototype.bytesPerElement=16,Mt(Kt,"StructArrayLayout4f16");class vt extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,p,A,b){const C=this.length;return this.resize(C+1),this.emplace(C,l,f,p,A,b)}emplace(l,f,p,A,b,C){const M=6*l,N=3*l;return this.uint16[M+0]=f,this.uint16[M+1]=p,this.uint16[M+2]=A,this.uint16[M+3]=b,this.float32[N+2]=C,l}}vt.prototype.bytesPerElement=12,Mt(vt,"StructArrayLayout4ui1f12");class zt extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,p,A){const b=this.length;return this.resize(b+1),this.emplace(b,l,f,p,A)}emplace(l,f,p,A,b){const C=4*l;return this.uint16[C+0]=f,this.uint16[C+1]=p,this.uint16[C+2]=A,this.uint16[C+3]=b,l}}zt.prototype.bytesPerElement=8,Mt(zt,"StructArrayLayout4ui8");class nn extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,p,A,b,C){const M=this.length;return this.resize(M+1),this.emplace(M,l,f,p,A,b,C)}emplace(l,f,p,A,b,C,M){const N=6*l;return this.int16[N+0]=f,this.int16[N+1]=p,this.int16[N+2]=A,this.int16[N+3]=b,this.int16[N+4]=C,this.int16[N+5]=M,l}}nn.prototype.bytesPerElement=12,Mt(nn,"StructArrayLayout6i12");class Ht extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,p,A,b,C,M,N,U,W,K,ee){const oe=this.length;return this.resize(oe+1),this.emplace(oe,l,f,p,A,b,C,M,N,U,W,K,ee)}emplace(l,f,p,A,b,C,M,N,U,W,K,ee,oe){const le=12*l;return this.int16[le+0]=f,this.int16[le+1]=p,this.int16[le+2]=A,this.int16[le+3]=b,this.uint16[le+4]=C,this.uint16[le+5]=M,this.uint16[le+6]=N,this.uint16[le+7]=U,this.int16[le+8]=W,this.int16[le+9]=K,this.int16[le+10]=ee,this.int16[le+11]=oe,l}}Ht.prototype.bytesPerElement=24,Mt(Ht,"StructArrayLayout4i4ui4i24");class an extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,p,A,b,C){const M=this.length;return this.resize(M+1),this.emplace(M,l,f,p,A,b,C)}emplace(l,f,p,A,b,C,M){const N=10*l,U=5*l;return this.int16[N+0]=f,this.int16[N+1]=p,this.int16[N+2]=A,this.float32[U+2]=b,this.float32[U+3]=C,this.float32[U+4]=M,l}}an.prototype.bytesPerElement=20,Mt(an,"StructArrayLayout3i3f20");class Wn extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l){const f=this.length;return this.resize(f+1),this.emplace(f,l)}emplace(l,f){return this.uint32[1*l+0]=f,l}}Wn.prototype.bytesPerElement=4,Mt(Wn,"StructArrayLayout1ul4");class hr extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,p,A,b,C,M,N,U,W,K,ee,oe){const le=this.length;return this.resize(le+1),this.emplace(le,l,f,p,A,b,C,M,N,U,W,K,ee,oe)}emplace(l,f,p,A,b,C,M,N,U,W,K,ee,oe,le){const de=20*l,xe=10*l;return this.int16[de+0]=f,this.int16[de+1]=p,this.int16[de+2]=A,this.int16[de+3]=b,this.int16[de+4]=C,this.float32[xe+3]=M,this.float32[xe+4]=N,this.float32[xe+5]=U,this.float32[xe+6]=W,this.int16[de+14]=K,this.uint32[xe+8]=ee,this.uint16[de+18]=oe,this.uint16[de+19]=le,l}}hr.prototype.bytesPerElement=40,Mt(hr,"StructArrayLayout5i4f1i1ul2ui40");class kn extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,p,A,b,C,M){const N=this.length;return this.resize(N+1),this.emplace(N,l,f,p,A,b,C,M)}emplace(l,f,p,A,b,C,M,N){const U=8*l;return this.int16[U+0]=f,this.int16[U+1]=p,this.int16[U+2]=A,this.int16[U+4]=b,this.int16[U+5]=C,this.int16[U+6]=M,this.int16[U+7]=N,l}}kn.prototype.bytesPerElement=16,Mt(kn,"StructArrayLayout3i2i2i16");class er extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(l,f,p,A,b){const C=this.length;return this.resize(C+1),this.emplace(C,l,f,p,A,b)}emplace(l,f,p,A,b,C){const M=4*l,N=8*l;return this.float32[M+0]=f,this.float32[M+1]=p,this.float32[M+2]=A,this.int16[N+6]=b,this.int16[N+7]=C,l}}er.prototype.bytesPerElement=16,Mt(er,"StructArrayLayout2f1f2i16");class Fr extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,p,A){const b=this.length;return this.resize(b+1),this.emplace(b,l,f,p,A)}emplace(l,f,p,A,b){const C=12*l,M=3*l;return this.uint8[C+0]=f,this.uint8[C+1]=p,this.float32[M+1]=A,this.float32[M+2]=b,l}}Fr.prototype.bytesPerElement=12,Mt(Fr,"StructArrayLayout2ub2f12");class Nr extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,p){const A=this.length;return this.resize(A+1),this.emplace(A,l,f,p)}emplace(l,f,p,A){const b=3*l;return this.float32[b+0]=f,this.float32[b+1]=p,this.float32[b+2]=A,l}}Nr.prototype.bytesPerElement=12,Mt(Nr,"StructArrayLayout3f12");class Vn extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,p){const A=this.length;return this.resize(A+1),this.emplace(A,l,f,p)}emplace(l,f,p,A){const b=3*l;return this.uint16[b+0]=f,this.uint16[b+1]=p,this.uint16[b+2]=A,l}}Vn.prototype.bytesPerElement=6,Mt(Vn,"StructArrayLayout3ui6");class fi extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l,f,p,A,b,C,M,N,U,W,K,ee,oe,le,de,xe,Be,$e,Ne,je,Ze){const We=this.length;return this.resize(We+1),this.emplace(We,l,f,p,A,b,C,M,N,U,W,K,ee,oe,le,de,xe,Be,$e,Ne,je,Ze)}emplace(l,f,p,A,b,C,M,N,U,W,K,ee,oe,le,de,xe,Be,$e,Ne,je,Ze,We){const bt=30*l,At=15*l,Ft=60*l;return this.int16[bt+0]=f,this.int16[bt+1]=p,this.int16[bt+2]=A,this.float32[At+2]=b,this.float32[At+3]=C,this.uint16[bt+8]=M,this.uint16[bt+9]=N,this.uint32[At+5]=U,this.uint32[At+6]=W,this.uint32[At+7]=K,this.uint16[bt+16]=ee,this.uint16[bt+17]=oe,this.uint16[bt+18]=le,this.float32[At+10]=de,this.float32[At+11]=xe,this.uint8[Ft+48]=Be,this.uint8[Ft+49]=$e,this.uint8[Ft+50]=Ne,this.uint32[At+13]=je,this.int16[bt+28]=Ze,this.uint8[Ft+58]=We,l}}fi.prototype.bytesPerElement=60,Mt(fi,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class bi extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(l,f,p,A,b,C,M,N,U,W,K,ee,oe,le,de,xe,Be,$e,Ne,je,Ze,We,bt,At,Ft,tn,Tt,Gt,jt,Yt){const ln=this.length;return this.resize(ln+1),this.emplace(ln,l,f,p,A,b,C,M,N,U,W,K,ee,oe,le,de,xe,Be,$e,Ne,je,Ze,We,bt,At,Ft,tn,Tt,Gt,jt,Yt)}emplace(l,f,p,A,b,C,M,N,U,W,K,ee,oe,le,de,xe,Be,$e,Ne,je,Ze,We,bt,At,Ft,tn,Tt,Gt,jt,Yt,ln){const Bt=38*l,xn=19*l;return this.int16[Bt+0]=f,this.int16[Bt+1]=p,this.int16[Bt+2]=A,this.float32[xn+2]=b,this.float32[xn+3]=C,this.int16[Bt+8]=M,this.int16[Bt+9]=N,this.int16[Bt+10]=U,this.int16[Bt+11]=W,this.int16[Bt+12]=K,this.int16[Bt+13]=ee,this.uint16[Bt+14]=oe,this.uint16[Bt+15]=le,this.uint16[Bt+16]=de,this.uint16[Bt+17]=xe,this.uint16[Bt+18]=Be,this.uint16[Bt+19]=$e,this.uint16[Bt+20]=Ne,this.uint16[Bt+21]=je,this.uint16[Bt+22]=Ze,this.uint16[Bt+23]=We,this.uint16[Bt+24]=bt,this.uint16[Bt+25]=At,this.uint16[Bt+26]=Ft,this.uint16[Bt+27]=tn,this.uint16[Bt+28]=Tt,this.uint32[xn+15]=Gt,this.float32[xn+16]=jt,this.float32[xn+17]=Yt,this.float32[xn+18]=ln,l}}bi.prototype.bytesPerElement=76,Mt(bi,"StructArrayLayout3i2f6i15ui1ul3f76");class wi extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l){const f=this.length;return this.resize(f+1),this.emplace(f,l)}emplace(l,f){return this.float32[1*l+0]=f,l}}wi.prototype.bytesPerElement=4,Mt(wi,"StructArrayLayout1f4");class Ei extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f,p,A,b){const C=this.length;return this.resize(C+1),this.emplace(C,l,f,p,A,b)}emplace(l,f,p,A,b,C){const M=5*l;return this.float32[M+0]=f,this.float32[M+1]=p,this.float32[M+2]=A,this.float32[M+3]=b,this.float32[M+4]=C,l}}Ei.prototype.bytesPerElement=20,Mt(Ei,"StructArrayLayout5f20");class _a extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f,p,A){const b=this.length;return this.resize(b+1),this.emplace(b,l,f,p,A)}emplace(l,f,p,A,b){const C=6*l;return this.uint32[3*l+0]=f,this.uint16[C+2]=p,this.uint16[C+3]=A,this.uint16[C+4]=b,l}}_a.prototype.bytesPerElement=12,Mt(_a,"StructArrayLayout1ul3ui12");class Ns extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l,f){const p=this.length;return this.resize(p+1),this.emplace(p,l,f)}emplace(l,f,p){const A=2*l;return this.uint16[A+0]=f,this.uint16[A+1]=p,l}}Ns.prototype.bytesPerElement=4,Mt(Ns,"StructArrayLayout2ui4");class pu extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(l){const f=this.length;return this.resize(f+1),this.emplace(f,l)}emplace(l,f){return this.uint16[1*l+0]=f,l}}pu.prototype.bytesPerElement=2,Mt(pu,"StructArrayLayout1ui2");class Wc extends lt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(l,f){const p=this.length;return this.resize(p+1),this.emplace(p,l,f)}emplace(l,f,p){const A=2*l;return this.float32[A+0]=f,this.float32[A+1]=p,l}}Wc.prototype.bytesPerElement=8,Mt(Wc,"StructArrayLayout2f8");class io extends Je{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}io.prototype.size=40;class Si extends hr{get(l){return new io(this,l)}}Mt(Si,"CollisionBoxArray");class ni extends Je{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(l){this._structArray.uint8[this._pos1+49]=l}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(l){this._structArray.uint8[this._pos1+50]=l}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(l){this._structArray.uint32[this._pos4+13]=l}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(l){this._structArray.uint8[this._pos1+58]=l}}ni.prototype.size=60;class Ho extends fi{get(l){return new ni(this,l)}}Mt(Ho,"PlacedSymbolArray");class ja extends Je{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(l){this._structArray.uint32[this._pos4+15]=l}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}ja.prototype.size=76;class Yi extends bi{get(l){return new ja(this,l)}}Mt(Yi,"SymbolInstanceArray");class ll extends wi{getoffsetX(l){return this.float32[1*l+0]}}Mt(ll,"GlyphOffsetArray");class $_ extends en{getx(l){return this.int16[2*l+0]}gety(l){return this.int16[2*l+1]}}Mt($_,"SymbolLineVertexArray");class Ip extends Je{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Ip.prototype.size=12;class WA extends _a{get(l){return new Ip(this,l)}}Mt(WA,"FeatureIndexArray");class qf extends Ns{geta_centroid_pos0(l){return this.uint16[2*l+0]}geta_centroid_pos1(l){return this.uint16[2*l+1]}}Mt(qf,"FillExtrusionCentroidArray");const nd=st([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Mp=st([{name:"a_dash",components:4,type:"Uint16"}]);var H_={exports:{}},qA={exports:{}};qA.exports=function(c,l){var f,p,A,b,C,M,N,U;for(p=c.length-(f=3&c.length),A=l,C=3432918353,M=461845907,U=0;U<p;)N=255&c.charCodeAt(U)|(255&c.charCodeAt(++U))<<8|(255&c.charCodeAt(++U))<<16|(255&c.charCodeAt(++U))<<24,++U,A=27492+(65535&(b=5*(65535&(A=(A^=N=(65535&(N=(N=(65535&N)*C+(((N>>>16)*C&65535)<<16)&4294967295)<<15|N>>>17))*M+(((N>>>16)*M&65535)<<16)&4294967295)<<13|A>>>19))+((5*(A>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(N=0,f){case 3:N^=(255&c.charCodeAt(U+2))<<16;case 2:N^=(255&c.charCodeAt(U+1))<<8;case 1:A^=N=(65535&(N=(N=(65535&(N^=255&c.charCodeAt(U)))*C+(((N>>>16)*C&65535)<<16)&4294967295)<<15|N>>>17))*M+(((N>>>16)*M&65535)<<16)&4294967295}return A^=c.length,A=2246822507*(65535&(A^=A>>>16))+((2246822507*(A>>>16)&65535)<<16)&4294967295,A=3266489909*(65535&(A^=A>>>13))+((3266489909*(A>>>16)&65535)<<16)&4294967295,(A^=A>>>16)>>>0};var Ax=qA.exports,M8={exports:{}};M8.exports=function(c,l){for(var f,p=c.length,A=l^p,b=0;p>=4;)f=1540483477*(65535&(f=255&c.charCodeAt(b)|(255&c.charCodeAt(++b))<<8|(255&c.charCodeAt(++b))<<16|(255&c.charCodeAt(++b))<<24))+((1540483477*(f>>>16)&65535)<<16),A=1540483477*(65535&A)+((1540483477*(A>>>16)&65535)<<16)^(f=1540483477*(65535&(f^=f>>>24))+((1540483477*(f>>>16)&65535)<<16)),p-=4,++b;switch(p){case 3:A^=(255&c.charCodeAt(b+2))<<16;case 2:A^=(255&c.charCodeAt(b+1))<<8;case 1:A=1540483477*(65535&(A^=255&c.charCodeAt(b)))+((1540483477*(A>>>16)&65535)<<16)}return A=1540483477*(65535&(A^=A>>>13))+((1540483477*(A>>>16)&65535)<<16),(A^=A>>>15)>>>0};var O8=Ax,ohe=M8.exports;H_.exports=O8,H_.exports.murmur3=O8,H_.exports.murmur2=ohe;var QL=z(H_.exports);class S2{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(l,f,p,A){this.ids.push(R8(l)),this.positions.push(f,p,A)}getPositions(l){const f=R8(l);let p=0,A=this.ids.length-1;for(;p<A;){const C=p+A>>1;this.ids[C]>=f?A=C:p=C+1}const b=[];for(;this.ids[p]===f;)b.push({index:this.positions[3*p],start:this.positions[3*p+1],end:this.positions[3*p+2]}),p++;return b}static serialize(l,f){const p=new Float64Array(l.ids),A=new Uint32Array(l.positions);return KL(p,A,0,p.length-1),f&&f.push(p.buffer,A.buffer),{ids:p,positions:A}}static deserialize(l){const f=new S2;return f.ids=l.ids,f.positions=l.positions,f.indexed=!0,f}}function R8(c){const l=+c;return!isNaN(l)&&Number.MIN_SAFE_INTEGER<=l&&l<=Number.MAX_SAFE_INTEGER?l:QL(String(c))}function KL(c,l,f,p){for(;f<p;){const A=c[f+p>>1];let b=f-1,C=p+1;for(;;){do b++;while(c[b]<A);do C--;while(c[C]>A);if(b>=C)break;T2(c,b,C),T2(l,3*b,3*C),T2(l,3*b+1,3*C+1),T2(l,3*b+2,3*C+2)}C-f<p-C?(KL(c,l,f,C),f=C+1):(KL(c,l,C+1,p),p=C)}}function T2(c,l,f){const p=c[l];c[l]=c[f],c[f]=p}Mt(S2,"FeaturePositionMap");class Op{constructor(l){this.gl=l.gl,this.initialized=!1}fetchUniformLocation(l,f){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(l,f),this.initialized=!0),!!this.location}}class C2 extends Op{constructor(l){super(l),this.current=0}set(l,f,p){this.fetchUniformLocation(l,f)&&this.current!==p&&(this.current=p,this.gl.uniform1f(this.location,p))}}class L8 extends Op{constructor(l){super(l),this.current=[0,0,0,0]}set(l,f,p){this.fetchUniformLocation(l,f)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]&&p[3]===this.current[3]||(this.current=p,this.gl.uniform4f(this.location,p[0],p[1],p[2],p[3])))}}class D8 extends Op{constructor(l){super(l),this.current=lo.transparent}set(l,f,p){this.fetchUniformLocation(l,f)&&(p.r===this.current.r&&p.g===this.current.g&&p.b===this.current.b&&p.a===this.current.a||(this.current=p,this.gl.uniform4f(this.location,p.r,p.g,p.b,p.a)))}}const she=new Float32Array(16),ahe=new Float32Array(9),lhe=new Float32Array(4);function JL(c){return[Qe(255*c.r,255*c.g),Qe(255*c.b,255*c.a)]}class _x{constructor(l,f,p){this.value=l,this.uniformNames=f.map(A=>`u_${A}`),this.type=p}setUniform(l,f,p,A,b){f.set(l,b,A.constantOr(this.value))}getBinding(l,f){return this.type==="color"?new D8(l):new C2(l)}}class W_{constructor(l,f){this.uniformNames=f.map(p=>`u_${p}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(l){this.pixelRatio=l.pixelRatio||1,this.pattern=l.tl.concat(l.br)}setUniform(l,f,p,A,b){const C=b==="u_pattern"||b==="u_dash"?this.pattern:b==="u_pixel_ratio"?this.pixelRatio:null;C&&f.set(l,b,C)}getBinding(l,f){return f==="u_pattern"||f==="u_dash"?new L8(l):new C2(l)}}class Rp{constructor(l,f,p,A){this.expression=l,this.type=p,this.maxValue=0,this.paintVertexAttributes=f.map(b=>({name:`a_${b}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new A}populatePaintArray(l,f,p,A,b,C){const M=this.paintVertexArray.length,N=this.expression.evaluate(new Q(0),f,{},b,A,C);this.paintVertexArray.resize(l),this._setPaintValue(M,l,N)}updatePaintArray(l,f,p,A,b){const C=this.expression.evaluate({zoom:0},p,A,void 0,b);this._setPaintValue(l,f,C)}_setPaintValue(l,f,p){if(this.type==="color"){const A=JL(p);for(let b=l;b<f;b++)this.paintVertexArray.emplace(b,A[0],A[1])}else{for(let A=l;A<f;A++)this.paintVertexArray.emplace(A,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Xf{constructor(l,f,p,A,b,C){this.expression=l,this.uniformNames=f.map(M=>`u_${M}_t`),this.type=p,this.useIntegerZoom=A,this.zoom=b,this.maxValue=0,this.paintVertexAttributes=f.map(M=>({name:`a_${M}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new C}populatePaintArray(l,f,p,A,b,C){const M=this.expression.evaluate(new Q(this.zoom),f,{},b,A,C),N=this.expression.evaluate(new Q(this.zoom+1),f,{},b,A,C),U=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValue(U,l,M,N)}updatePaintArray(l,f,p,A,b){const C=this.expression.evaluate({zoom:this.zoom},p,A,void 0,b),M=this.expression.evaluate({zoom:this.zoom+1},p,A,void 0,b);this._setPaintValue(l,f,C,M)}_setPaintValue(l,f,p,A){if(this.type==="color"){const b=JL(p),C=JL(A);for(let M=l;M<f;M++)this.paintVertexArray.emplace(M,b[0],b[1],C[0],C[1])}else{for(let b=l;b<f;b++)this.paintVertexArray.emplace(b,p,A);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(A))}}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(l,f,p,A,b){const C=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,M=be(this.expression.interpolationFactor(C,this.zoom,this.zoom+1),0,1);f.set(l,b,M)}getBinding(l,f){return new C2(l)}}class Yg{constructor(l,f,p,A,b){this.expression=l,this.layerId=b,this.paintVertexAttributes=(p==="array"?Mp:nd).members;for(let C=0;C<f.length;++C);this.paintVertexArray=new A}populatePaintArray(l,f,p){const A=this.paintVertexArray.length;this.paintVertexArray.resize(l),this._setPaintValues(A,l,f.patterns&&f.patterns[this.layerId],p)}updatePaintArray(l,f,p,A,b,C){this._setPaintValues(l,f,p.patterns&&p.patterns[this.layerId],C)}_setPaintValues(l,f,p,A){if(!A||!p)return;const b=A[p];if(!b)return;const{tl:C,br:M,pixelRatio:N}=b;for(let U=l;U<f;U++)this.paintVertexArray.emplace(U,C[0],C[1],M[0],M[1],N)}upload(l){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=l.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Qg{constructor(l,f,p=()=>!0){this.binders={},this._buffers=[];const A=[];for(const b in l.paint._values){if(!p(b))continue;const C=l.paint.get(b);if(!(C instanceof Pe&&jc(C.property.specification)))continue;const M=che(b,l.type),N=C.value,U=C.property.specification.type,W=!!C.property.useIntegerZoom,K=b==="line-dasharray"||b.endsWith("pattern"),ee=b==="line-dasharray"&&l.layout.get("line-cap").value.kind!=="constant";if(N.kind!=="constant"||ee)if(N.kind==="source"||ee||K){const oe=B8(b,U,"source");this.binders[b]=K?new Yg(N,M,U,oe,l.id):new Rp(N,M,U,oe),A.push(`/a_${b}`)}else{const oe=B8(b,U,"composite");this.binders[b]=new Xf(N,M,U,W,f,oe),A.push(`/z_${b}`)}else this.binders[b]=K?new W_(N.value,M):new _x(N.value,M,U),A.push(`/u_${b}`)}this.cacheKey=A.sort().join("")}getMaxValue(l){const f=this.binders[l];return f instanceof Rp||f instanceof Xf?f.maxValue:0}populatePaintArrays(l,f,p,A,b,C){for(const M in this.binders){const N=this.binders[M];(N instanceof Rp||N instanceof Xf||N instanceof Yg)&&N.populatePaintArray(l,f,p,A,b,C)}}setConstantPatternPositions(l){for(const f in this.binders){const p=this.binders[f];p instanceof W_&&p.setConstantPatternPositions(l)}}updatePaintArrays(l,f,p,A,b,C){let M=!1;for(const N in l){const U=f.getPositions(N);for(const W of U){const K=p.feature(W.index);for(const ee in this.binders){const oe=this.binders[ee];if((oe instanceof Rp||oe instanceof Xf||oe instanceof Yg)&&oe.expression.isStateDependent===!0){const le=A.paint.get(ee);oe.expression=le.value,oe.updatePaintArray(W.start,W.end,K,l[N],b,C),M=!0}}}}return M}defines(){const l=[];for(const f in this.binders){const p=this.binders[f];(p instanceof _x||p instanceof W_)&&l.push(...p.uniformNames.map(A=>`#define HAS_UNIFORM_${A}`))}return l}getBinderAttributes(){const l=[];for(const f in this.binders){const p=this.binders[f];if(p instanceof Rp||p instanceof Xf||p instanceof Yg)for(let A=0;A<p.paintVertexAttributes.length;A++)l.push(p.paintVertexAttributes[A].name)}return l}getBinderUniforms(){const l=[];for(const f in this.binders){const p=this.binders[f];if(p instanceof _x||p instanceof W_||p instanceof Xf)for(const A of p.uniformNames)l.push(A)}return l}getPaintVertexBuffers(){return this._buffers}getUniforms(l){const f=[];for(const p in this.binders){const A=this.binders[p];if(A instanceof _x||A instanceof W_||A instanceof Xf)for(const b of A.uniformNames)f.push({name:b,property:p,binding:A.getBinding(l,b)})}return f}setUniforms(l,f,p,A,b){for(const{name:C,property:M,binding:N}of p)this.binders[M].setUniform(l,N,b,A.get(M),C)}updatePaintBuffers(){this._buffers=[];for(const l in this.binders){const f=this.binders[l];(f instanceof Rp||f instanceof Xf||f instanceof Yg)&&f.paintVertexBuffer&&this._buffers.push(f.paintVertexBuffer)}}upload(l){for(const f in this.binders){const p=this.binders[f];(p instanceof Rp||p instanceof Xf||p instanceof Yg)&&p.upload(l)}this.updatePaintBuffers()}destroy(){for(const l in this.binders){const f=this.binders[l];(f instanceof Rp||f instanceof Xf||f instanceof Yg)&&f.destroy()}}}class XA{constructor(l,f,p=()=>!0){this.programConfigurations={};for(const A of l)this.programConfigurations[A.id]=new Qg(A,f,p);this.needsUpload=!1,this._featureMap=new S2,this._bufferOffset=0}populatePaintArrays(l,f,p,A,b,C,M){for(const N in this.programConfigurations)this.programConfigurations[N].populatePaintArrays(l,f,A,b,C,M);f.id!==void 0&&this._featureMap.add(f.id,p,this._bufferOffset,l),this._bufferOffset=l,this.needsUpload=!0}updatePaintArrays(l,f,p,A,b){for(const C of p)this.needsUpload=this.programConfigurations[C.id].updatePaintArrays(l,this._featureMap,f,C,A,b)||this.needsUpload}get(l){return this.programConfigurations[l]}upload(l){if(this.needsUpload){for(const f in this.programConfigurations)this.programConfigurations[f].upload(l);this.needsUpload=!1}}destroy(){for(const l in this.programConfigurations)this.programConfigurations[l].destroy()}}const uhe={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function che(c,l){return uhe[c]||[c.replace(`${l}-`,"").replace(/-/g,"_")]}const fhe={"line-pattern":{source:vt,composite:vt},"fill-pattern":{source:vt,composite:vt},"fill-extrusion-pattern":{source:vt,composite:vt},"line-dasharray":{source:zt,composite:zt}},hhe={color:{source:Wc,composite:Kt},number:{source:wi,composite:Wc}};function B8(c,l,f){const p=fhe[c];return p&&p[f]||hhe[l][f]}Mt(_x,"ConstantBinder"),Mt(W_,"PatternConstantBinder"),Mt(Rp,"SourceExpressionBinder"),Mt(Yg,"PatternCompositeBinder"),Mt(Xf,"CompositeExpressionBinder"),Mt(Qg,"ProgramConfiguration",{omit:["_buffers"]}),Mt(XA,"ProgramConfigurationSet");const N8="-transition";class Zf extends Ke{constructor(l,f){if(super(),this.id=l.id,this.type=l.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,l.type!=="custom"&&(this.metadata=l.metadata,this.minzoom=l.minzoom,this.maxzoom=l.maxzoom,l.type!=="background"&&l.type!=="sky"&&(this.source=l.source,this.sourceLayer=l["source-layer"],this.filter=l.filter),f.layout&&(this._unevaluatedLayout=new Ie(f.layout)),f.paint)){this._transitionablePaint=new fe(f.paint);for(const p in l.paint)this.setPaintProperty(p,l.paint[p],{validate:!1});for(const p in l.layout)this.setLayoutProperty(p,l.layout[p],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Le(f.paint)}}getLayoutProperty(l){return l==="visibility"?this.visibility:this._unevaluatedLayout.getValue(l)}setLayoutProperty(l,f,p={}){f!=null&&this._validate(yn,`layers.${this.id}.layout.${l}`,l,f,p)||(l!=="visibility"?this._unevaluatedLayout.setValue(l,f):this.visibility=f)}getPaintProperty(l){return Wt(l,N8)?this._transitionablePaint.getTransition(l.slice(0,-11)):this._transitionablePaint.getValue(l)}setPaintProperty(l,f,p={}){if(f!=null&&this._validate(Vt,`layers.${this.id}.paint.${l}`,l,f,p))return!1;if(Wt(l,N8))return this._transitionablePaint.setTransition(l.slice(0,-11),f||void 0),!1;{const A=this._transitionablePaint._values[l],b=A.value.isDataDriven(),C=A.value;this._transitionablePaint.setValue(l,f),this._handleSpecialPaintPropertyUpdate(l);const M=this._transitionablePaint._values[l].value,N=M.isDataDriven(),U=Wt(l,"pattern")||l==="line-dasharray";return N||b||U||this._handleOverridablePaintPropertyUpdate(l,C,M)}}_handleSpecialPaintPropertyUpdate(l){}getProgramIds(){return null}getProgramConfiguration(l){return null}_handleOverridablePaintPropertyUpdate(l,f,p){return!1}isHidden(l){return!!(this.minzoom&&l<this.minzoom)||!!(this.maxzoom&&l>=this.maxzoom)||this.visibility==="none"}updateTransitions(l){this._transitioningPaint=this._transitionablePaint.transitioned(l,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(l,f){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(l,void 0,f)),this.paint=this._transitioningPaint.possiblyEvaluate(l,void 0,f)}serialize(){const l={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(l.layout=l.layout||{},l.layout.visibility=this.visibility),lr(l,(f,p)=>!(f===void 0||p==="layout"&&!Object.keys(f).length||p==="paint"&&!Object.keys(f).length))}_validate(l,f,p,A,b={}){return(!b||b.validate!==!1)&&Rt(this,l.call(kt,{key:f,layerType:this.type,objectKey:p,value:A,styleSpec:pt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const l in this.paint._values){const f=this.paint.get(l);if(f instanceof Pe&&jc(f.property.specification)&&(f.value.kind==="source"||f.value.kind==="composite")&&f.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ma(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const dhe=st([{name:"a_pos",components:2,type:"Int16"}],4),phe=st([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Wo{constructor(l=[]){this.segments=l}prepareSegment(l,f,p,A){let b=this.segments[this.segments.length-1];return l>Wo.MAX_VERTEX_ARRAY_LENGTH&&$t(`Max vertices per segment is ${Wo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${l}`),(!b||b.vertexLength+l>Wo.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==A)&&(b={vertexOffset:f.length,primitiveOffset:p.length,vertexLength:0,primitiveLength:0},A!==void 0&&(b.sortKey=A),this.segments.push(b)),b}get(){return this.segments}destroy(){for(const l of this.segments)for(const f in l.vaos)l.vaos[f].destroy()}static simpleSegment(l,f,p,A){return new Wo([{vertexOffset:l,primitiveOffset:f,vertexLength:p,primitiveLength:A,vaos:{},sortKey:0}])}}Wo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Mt(Wo,"SegmentVector");var Kn=8192;class Kg{constructor(l,f){l&&(f?this.setSouthWest(l).setNorthEast(f):l.length===4?this.setSouthWest([l[0],l[1]]).setNorthEast([l[2],l[3]]):this.setSouthWest(l[0]).setNorthEast(l[1]))}setNorthEast(l){return this._ne=l instanceof Ti?new Ti(l.lng,l.lat):Ti.convert(l),this}setSouthWest(l){return this._sw=l instanceof Ti?new Ti(l.lng,l.lat):Ti.convert(l),this}extend(l){const f=this._sw,p=this._ne;let A,b;if(l instanceof Ti)A=l,b=l;else{if(!(l instanceof Kg))return Array.isArray(l)?l.length===4||l.every(Array.isArray)?this.extend(Kg.convert(l)):this.extend(Ti.convert(l)):typeof l=="object"&&l!==null&&l.hasOwnProperty("lat")&&(l.hasOwnProperty("lon")||l.hasOwnProperty("lng"))?this.extend(Ti.convert(l)):this;if(A=l._sw,b=l._ne,!A||!b)return this}return f||p?(f.lng=Math.min(A.lng,f.lng),f.lat=Math.min(A.lat,f.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new Ti(A.lng,A.lat),this._ne=new Ti(b.lng,b.lat)),this}getCenter(){return new Ti((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Ti(this.getWest(),this.getNorth())}getSouthEast(){return new Ti(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(l){const{lng:f,lat:p}=Ti.convert(l);let A=this._sw.lng<=f&&f<=this._ne.lng;return this._sw.lng>this._ne.lng&&(A=this._sw.lng>=f&&f>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&A}static convert(l){return!l||l instanceof Kg?l:new Kg(l)}}var P2=1e-6,gu=typeof Float32Array<"u"?Float32Array:Array;function F8(){var c=new gu(9);return gu!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c}function k8(c,l,f){var p=l[0],A=l[1],b=l[2],C=l[3],M=l[4],N=l[5],U=l[6],W=l[7],K=l[8],ee=f[0],oe=f[1],le=f[2],de=f[3],xe=f[4],Be=f[5],$e=f[6],Ne=f[7],je=f[8];return c[0]=ee*p+oe*C+le*U,c[1]=ee*A+oe*M+le*W,c[2]=ee*b+oe*N+le*K,c[3]=de*p+xe*C+Be*U,c[4]=de*A+xe*M+Be*W,c[5]=de*b+xe*N+Be*K,c[6]=$e*p+Ne*C+je*U,c[7]=$e*A+Ne*M+je*W,c[8]=$e*b+Ne*N+je*K,c}function Yf(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=1,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=1,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function e3(c,l){var f=l[0],p=l[1],A=l[2],b=l[3],C=l[4],M=l[5],N=l[6],U=l[7],W=l[8],K=l[9],ee=l[10],oe=l[11],le=l[12],de=l[13],xe=l[14],Be=l[15],$e=f*M-p*C,Ne=f*N-A*C,je=f*U-b*C,Ze=p*N-A*M,We=p*U-b*M,bt=A*U-b*N,At=W*de-K*le,Ft=W*xe-ee*le,tn=W*Be-oe*le,Tt=K*xe-ee*de,Gt=K*Be-oe*de,jt=ee*Be-oe*xe,Yt=$e*jt-Ne*Gt+je*Tt+Ze*tn-We*Ft+bt*At;return Yt?(c[0]=(M*jt-N*Gt+U*Tt)*(Yt=1/Yt),c[1]=(A*Gt-p*jt-b*Tt)*Yt,c[2]=(de*bt-xe*We+Be*Ze)*Yt,c[3]=(ee*We-K*bt-oe*Ze)*Yt,c[4]=(N*tn-C*jt-U*Ft)*Yt,c[5]=(f*jt-A*tn+b*Ft)*Yt,c[6]=(xe*je-le*bt-Be*Ne)*Yt,c[7]=(W*bt-ee*je+oe*Ne)*Yt,c[8]=(C*Gt-M*tn+U*At)*Yt,c[9]=(p*tn-f*Gt-b*At)*Yt,c[10]=(le*We-de*je+Be*$e)*Yt,c[11]=(K*je-W*We-oe*$e)*Yt,c[12]=(M*Ft-C*Tt-N*At)*Yt,c[13]=(f*Tt-p*Ft+A*At)*Yt,c[14]=(de*Ne-le*Ze-xe*$e)*Yt,c[15]=(W*Ze-K*Ne+ee*$e)*Yt,c):null}function ZA(c,l,f){var p=l[0],A=l[1],b=l[2],C=l[3],M=l[4],N=l[5],U=l[6],W=l[7],K=l[8],ee=l[9],oe=l[10],le=l[11],de=l[12],xe=l[13],Be=l[14],$e=l[15],Ne=f[0],je=f[1],Ze=f[2],We=f[3];return c[0]=Ne*p+je*M+Ze*K+We*de,c[1]=Ne*A+je*N+Ze*ee+We*xe,c[2]=Ne*b+je*U+Ze*oe+We*Be,c[3]=Ne*C+je*W+Ze*le+We*$e,c[4]=(Ne=f[4])*p+(je=f[5])*M+(Ze=f[6])*K+(We=f[7])*de,c[5]=Ne*A+je*N+Ze*ee+We*xe,c[6]=Ne*b+je*U+Ze*oe+We*Be,c[7]=Ne*C+je*W+Ze*le+We*$e,c[8]=(Ne=f[8])*p+(je=f[9])*M+(Ze=f[10])*K+(We=f[11])*de,c[9]=Ne*A+je*N+Ze*ee+We*xe,c[10]=Ne*b+je*U+Ze*oe+We*Be,c[11]=Ne*C+je*W+Ze*le+We*$e,c[12]=(Ne=f[12])*p+(je=f[13])*M+(Ze=f[14])*K+(We=f[15])*de,c[13]=Ne*A+je*N+Ze*ee+We*xe,c[14]=Ne*b+je*U+Ze*oe+We*Be,c[15]=Ne*C+je*W+Ze*le+We*$e,c}function yx(c,l,f){var p,A,b,C,M,N,U,W,K,ee,oe,le,de=f[0],xe=f[1],Be=f[2];return l===c?(c[12]=l[0]*de+l[4]*xe+l[8]*Be+l[12],c[13]=l[1]*de+l[5]*xe+l[9]*Be+l[13],c[14]=l[2]*de+l[6]*xe+l[10]*Be+l[14],c[15]=l[3]*de+l[7]*xe+l[11]*Be+l[15]):(A=l[1],b=l[2],C=l[3],M=l[4],N=l[5],U=l[6],W=l[7],K=l[8],ee=l[9],oe=l[10],le=l[11],c[0]=p=l[0],c[1]=A,c[2]=b,c[3]=C,c[4]=M,c[5]=N,c[6]=U,c[7]=W,c[8]=K,c[9]=ee,c[10]=oe,c[11]=le,c[12]=p*de+M*xe+K*Be+l[12],c[13]=A*de+N*xe+ee*Be+l[13],c[14]=b*de+U*xe+oe*Be+l[14],c[15]=C*de+W*xe+le*Be+l[15]),c}function YA(c,l,f){var p=f[0],A=f[1],b=f[2];return c[0]=l[0]*p,c[1]=l[1]*p,c[2]=l[2]*p,c[3]=l[3]*p,c[4]=l[4]*A,c[5]=l[5]*A,c[6]=l[6]*A,c[7]=l[7]*A,c[8]=l[8]*b,c[9]=l[9]*b,c[10]=l[10]*b,c[11]=l[11]*b,c[12]=l[12],c[13]=l[13],c[14]=l[14],c[15]=l[15],c}function t3(c,l,f){var p=Math.sin(f),A=Math.cos(f),b=l[4],C=l[5],M=l[6],N=l[7],U=l[8],W=l[9],K=l[10],ee=l[11];return l!==c&&(c[0]=l[0],c[1]=l[1],c[2]=l[2],c[3]=l[3],c[12]=l[12],c[13]=l[13],c[14]=l[14],c[15]=l[15]),c[4]=b*A+U*p,c[5]=C*A+W*p,c[6]=M*A+K*p,c[7]=N*A+ee*p,c[8]=U*A-b*p,c[9]=W*A-C*p,c[10]=K*A-M*p,c[11]=ee*A-N*p,c}function I2(c,l,f){var p=Math.sin(f),A=Math.cos(f),b=l[0],C=l[1],M=l[2],N=l[3],U=l[8],W=l[9],K=l[10],ee=l[11];return l!==c&&(c[4]=l[4],c[5]=l[5],c[6]=l[6],c[7]=l[7],c[12]=l[12],c[13]=l[13],c[14]=l[14],c[15]=l[15]),c[0]=b*A-U*p,c[1]=C*A-W*p,c[2]=M*A-K*p,c[3]=N*A-ee*p,c[8]=b*p+U*A,c[9]=C*p+W*A,c[10]=M*p+K*A,c[11]=N*p+ee*A,c}function z8(c,l){return c[0]=l[0],c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=l[1],c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=l[2],c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c}function U8(c,l,f){var p,A,b,C=f[0],M=f[1],N=f[2],U=Math.hypot(C,M,N);return U<P2?null:(C*=U=1/U,M*=U,N*=U,p=Math.sin(l),A=Math.cos(l),c[0]=C*C*(b=1-A)+A,c[1]=M*C*b+N*p,c[2]=N*C*b-M*p,c[3]=0,c[4]=C*M*b-N*p,c[5]=M*M*b+A,c[6]=N*M*b+C*p,c[7]=0,c[8]=C*N*b+M*p,c[9]=M*N*b-C*p,c[10]=N*N*b+A,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c)}Math.hypot||(Math.hypot=function(){for(var c=0,l=arguments.length;l--;)c+=arguments[l]*arguments[l];return Math.sqrt(c)});var ghe=ZA;function n3(){var c=new gu(3);return gu!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c}function G8(c){var l=new gu(3);return l[0]=c[0],l[1]=c[1],l[2]=c[2],l}function vx(c){return Math.hypot(c[0],c[1],c[2])}function q_(c,l,f){var p=new gu(3);return p[0]=c,p[1]=l,p[2]=f,p}function Lp(c,l,f){return c[0]=l[0]+f[0],c[1]=l[1]+f[1],c[2]=l[2]+f[2],c}function r3(c,l,f){return c[0]=l[0]-f[0],c[1]=l[1]-f[1],c[2]=l[2]-f[2],c}function j8(c,l,f){return c[0]=l[0]*f[0],c[1]=l[1]*f[1],c[2]=l[2]*f[2],c}function xx(c,l,f){return c[0]=Math.min(l[0],f[0]),c[1]=Math.min(l[1],f[1]),c[2]=Math.min(l[2],f[2]),c}function bx(c,l,f){return c[0]=Math.max(l[0],f[0]),c[1]=Math.max(l[1],f[1]),c[2]=Math.max(l[2],f[2]),c}function Ku(c,l,f){return c[0]=l[0]*f,c[1]=l[1]*f,c[2]=l[2]*f,c}function wx(c,l,f,p){return c[0]=l[0]+f[0]*p,c[1]=l[1]+f[1]*p,c[2]=l[2]+f[2]*p,c}function ul(c,l){var f=l[0],p=l[1],A=l[2],b=f*f+p*p+A*A;return b>0&&(b=1/Math.sqrt(b)),c[0]=l[0]*b,c[1]=l[1]*b,c[2]=l[2]*b,c}function qc(c,l){return c[0]*l[0]+c[1]*l[1]+c[2]*l[2]}function i3(c,l,f){var p=l[0],A=l[1],b=l[2],C=f[0],M=f[1],N=f[2];return c[0]=A*N-b*M,c[1]=b*C-p*N,c[2]=p*M-A*C,c}function Fo(c,l,f){var p=l[0],A=l[1],b=l[2],C=f[3]*p+f[7]*A+f[11]*b+f[15];return c[0]=(f[0]*p+f[4]*A+f[8]*b+f[12])/(C=C||1),c[1]=(f[1]*p+f[5]*A+f[9]*b+f[13])/C,c[2]=(f[2]*p+f[6]*A+f[10]*b+f[14])/C,c}function V8(c,l,f){var p=f[0],A=f[1],b=f[2],C=l[0],M=l[1],N=l[2],U=A*N-b*M,W=b*C-p*N,K=p*M-A*C,ee=A*K-b*W,oe=b*U-p*K,le=p*W-A*U,de=2*f[3];return W*=de,K*=de,oe*=2,le*=2,c[0]=C+(U*=de)+(ee*=2),c[1]=M+W+oe,c[2]=N+K+le,c}var Ex,Qf=r3,mhe=j8,Ahe=vx;function $8(c,l,f){return c[0]=l[0]*f,c[1]=l[1]*f,c[2]=l[2]*f,c[3]=l[3]*f,c}function H8(c,l){var f=l[0],p=l[1],A=l[2],b=l[3],C=f*f+p*p+A*A+b*b;return C>0&&(C=1/Math.sqrt(C)),c[0]=f*C,c[1]=p*C,c[2]=A*C,c[3]=b*C,c}function QA(c,l,f){var p=l[0],A=l[1],b=l[2],C=l[3];return c[0]=f[0]*p+f[4]*A+f[8]*b+f[12]*C,c[1]=f[1]*p+f[5]*A+f[9]*b+f[13]*C,c[2]=f[2]*p+f[6]*A+f[10]*b+f[14]*C,c[3]=f[3]*p+f[7]*A+f[11]*b+f[15]*C,c}function W8(){var c=new gu(4);return gu!=Float32Array&&(c[0]=0,c[1]=0,c[2]=0),c[3]=1,c}function q8(c){return c[0]=0,c[1]=0,c[2]=0,c[3]=1,c}function X8(c,l,f){f*=.5;var p=l[0],A=l[1],b=l[2],C=l[3],M=Math.sin(f),N=Math.cos(f);return c[0]=p*N+C*M,c[1]=A*N+b*M,c[2]=b*N-A*M,c[3]=C*N-p*M,c}function Z8(c,l,f){f*=.5;var p=l[0],A=l[1],b=l[2],C=l[3],M=Math.sin(f),N=Math.cos(f);return c[0]=p*N-b*M,c[1]=A*N+C*M,c[2]=b*N+p*M,c[3]=C*N-A*M,c}n3(),Ex=new gu(4),gu!=Float32Array&&(Ex[0]=0,Ex[1]=0,Ex[2]=0,Ex[3]=0);var _he=H8;n3(),q_(1,0,0),q_(0,1,0),W8(),W8(),F8();const yhe=st([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Y8}=yhe,Q8=st([{name:"a_pos_3",components:3,type:"Int16"}]);var Sx=st([{name:"a_pos",type:"Int16",components:2}]);class o3{constructor(l,f){this.pos=l,this.dir=f}intersectsPlane(l,f,p){const A=qc(f,this.dir);if(Math.abs(A)<1e-6)return!1;const b=((l[0]-this.pos[0])*f[0]+(l[1]-this.pos[1])*f[1]+(l[2]-this.pos[2])*f[2])/A;return p[0]=this.pos[0]+this.dir[0]*b,p[1]=this.pos[1]+this.dir[1]*b,p[2]=this.pos[2]+this.dir[2]*b,!0}closestPointOnSphere(l,f,p){if(function(oe,le){var de=oe[0],xe=oe[1],Be=oe[2],$e=le[0],Ne=le[1],je=le[2];return Math.abs(de-$e)<=P2*Math.max(1,Math.abs(de),Math.abs($e))&&Math.abs(xe-Ne)<=P2*Math.max(1,Math.abs(xe),Math.abs(Ne))&&Math.abs(Be-je)<=P2*Math.max(1,Math.abs(Be),Math.abs(je))}(this.pos,l)||f===0)return p[0]=p[1]=p[2]=0,!1;const[A,b,C]=this.dir,M=this.pos[0]-l[0],N=this.pos[1]-l[1],U=this.pos[2]-l[2],W=A*A+b*b+C*C,K=2*(M*A+N*b+U*C),ee=K*K-4*W*(M*M+N*N+U*U-f*f);if(ee<0){const oe=Math.max(-K/2,0),le=M+A*oe,de=N+b*oe,xe=U+C*oe,Be=Math.hypot(le,de,xe);return p[0]=le*f/Be,p[1]=de*f/Be,p[2]=xe*f/Be,!1}{const oe=(-K-Math.sqrt(ee))/(2*W);if(oe<0){const le=Math.hypot(M,N,U);return p[0]=M*f/le,p[1]=N*f/le,p[2]=U*f/le,!1}return p[0]=M+A*oe,p[1]=N+b*oe,p[2]=U+C*oe,!0}}}class s3{constructor(l,f,p,A,b){this.TL=l,this.TR=f,this.BR=p,this.BL=A,this.horizon=b}static fromInvProjectionMatrix(l,f,p){const A=[-1,1,1],b=[1,1,1],C=[1,-1,1],M=[-1,-1,1],N=Fo(A,A,l),U=Fo(b,b,l),W=Fo(C,C,l),K=Fo(M,M,l);return new s3(N,U,W,K,f/p)}}class a3{constructor(l,f){this.points=l,this.planes=f}static fromInvProjectionMatrix(l,f,p,A){const b=Math.pow(2,p),C=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(N=>{const U=QA([],N,l),W=1/U[3]/f*b;return function(K,ee,oe){return K[0]=ee[0]*oe[0],K[1]=ee[1]*oe[1],K[2]=ee[2]*oe[2],K[3]=ee[3]*oe[3],K}(U,U,[W,W,A?1/U[3]:W,W])}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(N=>{const U=ul([],i3([],Qf([],C[N[0]],C[N[1]]),Qf([],C[N[2]],C[N[1]]))),W=-qc(U,C[N[1]]);return U.concat(W)});return new a3(C,M)}}class cl{static fromPoints(l){const f=[1/0,1/0,1/0],p=[-1/0,-1/0,-1/0];for(const A of l)xx(f,f,A),bx(p,p,A);return new cl(f,p)}static applyTransform(l,f){const p=l.getCorners();for(let A=0;A<p.length;++A)Fo(p[A],p[A],f);return cl.fromPoints(p)}constructor(l,f){this.min=l,this.max=f,this.center=Ku([],Lp([],this.min,this.max),.5)}quadrant(l){const f=[l%2==0,l<2],p=G8(this.min),A=G8(this.max);for(let b=0;b<f.length;b++)p[b]=f[b]?this.min[b]:this.center[b],A[b]=f[b]?this.center[b]:this.max[b];return A[2]=this.max[2],new cl(p,A)}distanceX(l){return Math.max(Math.min(this.max[0],l[0]),this.min[0])-l[0]}distanceY(l){return Math.max(Math.min(this.max[1],l[1]),this.min[1])-l[1]}distanceZ(l){return Math.max(Math.min(this.max[2],l[2]),this.min[2])-l[2]}getCorners(){const l=this.min,f=this.max;return[[l[0],l[1],l[2]],[f[0],l[1],l[2]],[f[0],f[1],l[2]],[l[0],f[1],l[2]],[l[0],l[1],f[2]],[f[0],l[1],f[2]],[f[0],f[1],f[2]],[l[0],f[1],f[2]]]}intersects(l){const f=this.getCorners();let p=!0;for(let A=0;A<l.planes.length;A++){const b=l.planes[A];let C=0;for(let M=0;M<f.length;M++)C+=qc(b,f[M])+b[3]>=0;if(C===0)return 0;C!==f.length&&(p=!1)}if(p)return 2;for(let A=0;A<3;A++){let b=Number.MAX_VALUE,C=-Number.MAX_VALUE;for(let M=0;M<l.points.length;M++){const N=l.points[M][A]-this.min[A];b=Math.min(b,N),C=Math.max(C,N)}if(C<0||b>this.max[A]-this.min[A])return 0}return 1}}const l3=5,K8=6,rd=Kn/Math.PI/2,vhe=16383,KA=64,Tx=[KA,32,16],Xc=-rd,Zc=rd,xhe=[new cl([Xc,Xc,Xc],[Zc,Zc,Zc]),new cl([Xc,Xc,Xc],[0,0,Zc]),new cl([0,Xc,Xc],[Zc,0,Zc]),new cl([Xc,0,Xc],[0,Zc,Zc]),new cl([0,0,Xc],[Zc,Zc,Zc])];function M2(c){return c*rd/Ix}function J8(c,l,f,p=!0){const A=Ku([],c._camera.position,c.worldSize),b=[l,f,1,1];QA(b,b,c.pixelMatrixInverse),$8(b,b,1/b[3]);const C=ul([],Qf([],b,A)),M=c.globeMatrix,N=[M[12],M[13],M[14]],U=Qf([],N,A),W=vx(U),K=ul([],U),ee=c.worldSize/(2*Math.PI),oe=qc(K,C),le=Math.asin(ee/W);if(le<Math.acos(oe)){if(!p)return null;const tn=[],Tt=[];Ku(tn,C,W/oe),ul(Tt,Qf(Tt,tn,U)),ul(C,Lp(C,U,Ku(C,Tt,Math.tan(le)*W)))}const de=[];new o3(A,C).closestPointOnSphere(N,ee,de);const xe=ul([],Ri(M,0)),Be=ul([],Ri(M,1)),$e=ul([],Ri(M,2)),Ne=qc(xe,de),je=qc(Be,de),Ze=qc($e,de),We=Ce(Math.asin(-je/ee));let bt=Ce(Math.atan2(Ne,Ze));bt=c.center.lng+function(tn,Tt){const Gt=(Tt-tn+180)%360-180;return Gt<-180?Gt+360:Gt}(c.center.lng,bt);const At=od(bt),Ft=be(sd(We),0,1);return new Q_(At,Ft)}class bhe{constructor(l,f,p){this.a=Qf([],l,p),this.b=Qf([],f,p),this.center=p;const A=ul([],this.a),b=ul([],this.b);this.angle=Math.acos(qc(A,b))}}function u3(c,l){if(c.angle===0)return null;let f;return f=c.a[l]===0?1/c.angle*.5*Math.PI:1/c.angle*Math.atan(c.b[l]/c.a[l]/Math.sin(c.angle)-1/Math.tan(c.angle)),f<0||f>1?null:function(p,A,b,C){const M=Math.sin(b);return p*(Math.sin((1-C)*b)/M)+A*(Math.sin(C*b)/M)}(c.a[l],c.b[l],c.angle,be(f,0,1))+c.center[l]}function id(c){if(c.z<=1)return xhe[c.z+2*c.y+c.x];const l=c3(O2(c));return cl.fromPoints(l)}function JA(c,l,f){return Ku(c,c,1-f),wx(c,c,l,f)}function eG(c,l){const f=Y_(l.zoom);if(f===0)return id(c);const p=O2(c),A=c3(p),b=od(p.getWest())*l.worldSize,C=od(p.getEast())*l.worldSize,M=sd(p.getNorth())*l.worldSize,N=sd(p.getSouth())*l.worldSize,U=[b,M,0],W=[C,M,0],K=[b,N,0],ee=[C,N,0],oe=e3([],l.globeMatrix);return Fo(U,U,oe),Fo(W,W,oe),Fo(K,K,oe),Fo(ee,ee,oe),A[0]=JA(A[0],K,f),A[1]=JA(A[1],ee,f),A[2]=JA(A[2],W,f),A[3]=JA(A[3],U,f),cl.fromPoints(A)}function tG(c,l,f){for(const p of c)Fo(p,p,l),Ku(p,p,f)}function whe(c,l,f){const p=l/c.worldSize,A=c.globeMatrix;if(f.z<=1){const At=id(f).getCorners();return tG(At,A,p),cl.fromPoints(At)}const b=O2(f),C=c3(b);tG(C,A,p);const M=Number.MAX_VALUE,N=[-M,-M,-M],U=[M,M,M];if(b.contains(c.center)){for(const tn of C)xx(U,U,tn),bx(N,N,tn);N[2]=0;const At=c.point,Ft=[At.x*p,At.y*p,0];return xx(U,U,Ft),bx(N,N,Ft),new cl(U,N)}const W=[A[12]*p,A[13]*p,A[14]*p],K=b.getCenter(),ee=be(c.center.lat,-va,va),oe=be(K.lat,-va,va),le=od(c.center.lng),de=sd(ee);let xe=le-od(K.lng);const Be=de-sd(oe);xe>.5?xe-=1:xe<-.5&&(xe+=1);let $e=0;Math.abs(xe)>Math.abs(Be)?$e=xe>=0?1:3:($e=Be>=0?0:2,wx(W,W,[A[4]*p,A[5]*p,A[6]*p],-Math.sin(me(Be>=0?b.getSouth():b.getNorth()))*rd));const Ne=C[$e],je=C[($e+1)%4],Ze=new bhe(Ne,je,W),We=[u3(Ze,0)||Ne[0],u3(Ze,1)||Ne[1],u3(Ze,2)||Ne[2]],bt=Y_(c.zoom);if(bt>0){const At=function({x:tn,y:Tt,z:Gt},jt,Yt,ln,Bt){const xn=1/(1<<Gt);let zn=tn*xn,En=zn+xn,Ar=Tt*xn,un=Ar+xn,Xn=0;const _r=(zn+En)/2-ln;return _r>.5?Xn=-1:_r<-.5&&(Xn=1),zn=((zn+Xn)*jt-(ln*=jt))*Yt+ln,En=((En+Xn)*jt-ln)*Yt+ln,Ar=(Ar*jt-(Bt*=jt))*Yt+Bt,un=(un*jt-Bt)*Yt+Bt,[[zn,un,0],[En,un,0],[En,Ar,0],[zn,Ar,0]]}(f,l,c._pixelsPerMercatorPixel,le,de);for(let tn=0;tn<C.length;tn++)JA(C[tn],At[tn],bt);const Ft=Lp([],At[$e],At[($e+1)%4]);Ku(Ft,Ft,.5),JA(We,Ft,bt)}for(const At of C)xx(U,U,At),bx(N,N,At);return U[2]=Math.min(Ne[2],je[2]),xx(U,U,We),bx(N,N,We),new cl(U,N)}function O2({x:c,y:l,z:f}){const p=1/(1<<f),A=new Ti(Ju(c*p),ya((l+1)*p)),b=new Ti(Ju((c+1)*p),ya(l*p));return new Kg(A,b)}function c3(c){const l=me(c.getNorth()),f=me(c.getSouth()),p=Math.cos(l),A=Math.cos(f),b=Math.sin(l),C=Math.sin(f),M=c.getWest(),N=c.getEast();return[X_(A,C,M),X_(A,C,N),X_(p,b,N),X_(p,b,M)]}function X_(c,l,f,p=rd){return f=me(f),[c*Math.sin(f)*p,-l*p,c*Math.cos(f)*p]}function Z_(c,l,f){return X_(Math.cos(me(c)),Math.sin(me(c)),l,f)}function Cx(c,l,f,p){const A=1<<f.z,b=(c/Kn+f.x)/A;return Z_(ya((l/Kn+f.y)/A),Ju(b),p)}function R2({min:c,max:l}){return vhe/Math.max(l[0]-c[0],l[1]-c[1],l[2]-c[2])}const nG=new Float64Array(16);function Px(c){const l=R2(c),f=z8(nG,[l,l,l]);return yx(f,f,((p=[])[0]=-(A=c.min)[0],p[1]=-A[1],p[2]=-A[2],p));var p,A}function f3(c){const l=(p=c.min,(f=nG)[0]=1,f[1]=0,f[2]=0,f[3]=0,f[4]=0,f[5]=1,f[6]=0,f[7]=0,f[8]=0,f[9]=0,f[10]=1,f[11]=0,f[12]=p[0],f[13]=p[1],f[14]=p[2],f[15]=1,f);var f,p;const A=1/R2(c);return YA(l,l,[A,A,A])}function rG(c,l,f,p,A){const b=function(N){const U=Kn/(2*Math.PI);return N/(2*Math.PI)/U}(f),C=[c,l,-f/(2*Math.PI)],M=Yf(new Float64Array(16));return yx(M,M,C),YA(M,M,[b,b,b]),t3(M,M,me(-A)),I2(M,M,me(-p)),M}function Y_(c){return De(l3,K8,c)}function iG(c,l){const f=Z_(l.lat,l.lng),p=function(le){const de=Z_(le._center.lat,le._center.lng);let xe=i3([],q_(0,1,0),de);const Be=U8([],-le.angle,de);xe=Fo(xe,xe,Be),U8(Be,-le._pitch,xe);const $e=ul([],de);return Ku($e,$e,M2(le.cameraToCenterDistance/le.pixelsPerMeter)),Fo($e,$e,Be),Lp([],de,$e)}(c);return C=(A=r3([],p,f))[0],M=A[1],N=A[2],U=(b=f)[0],W=b[1],K=b[2],oe=(ee=Math.sqrt(C*C+M*M+N*N)*Math.sqrt(U*U+W*W+K*K))&&qc(A,b)/ee,Math.acos(Math.min(Math.max(oe,-1),1));var A,b,C,M,N,U,W,K,ee,oe}function h3(c,l){return iG(c,l)>Math.PI/2*1.01}const oG=me(85),Ehe=Math.cos(oG),She=Math.sin(oG),Ix=63710088e-1,sG=2*Math.PI*Ix;class Jg{constructor(l,f){if(isNaN(l)||isNaN(f))throw new Error(`Invalid LngLat object: (${l}, ${f})`);if(this.lng=+l,this.lat=+f,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Jg(Re(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(l){const f=Math.PI/180,p=this.lat*f,A=l.lat*f,b=Math.sin(p)*Math.sin(A)+Math.cos(p)*Math.cos(A)*Math.cos((l.lng-this.lng)*f);return Ix*Math.acos(Math.min(b,1))}toBounds(l=0){const f=360*l/40075017,p=f/Math.cos(Math.PI/180*this.lat);return new Kg(new Jg(this.lng-p,this.lat-f),new Jg(this.lng+p,this.lat+f))}toEcef(l){const f=M2(l);return Z_(this.lat,this.lng,rd+f)}static convert(l){if(l instanceof Jg)return l;if(Array.isArray(l)&&(l.length===2||l.length===3))return new Jg(Number(l[0]),Number(l[1]));if(!Array.isArray(l)&&typeof l=="object"&&l!==null)return new Jg(Number("lng"in l?l.lng:l.lon),Number(l.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Ti=Jg;function d3(c){return sG*Math.cos(c*Math.PI/180)}function od(c){return(180+c)/360}function sd(c){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+c*Math.PI/360)))/360}function Kf(c,l){return c/d3(l)}function Ju(c){return 360*c-180}function ya(c){return 360/Math.PI*Math.atan(Math.exp((180-360*c)*Math.PI/180))-90}function aG(c,l){return c*d3(ya(l))}const va=85.051129;function lG(c){return 1/Math.cos(c*Math.PI/180)}class Q_{constructor(l,f,p=0){this.x=+l,this.y=+f,this.z=+p}static fromLngLat(l,f=0){const p=Ti.convert(l);return new Q_(od(p.lng),sd(p.lat),Kf(f,p.lat))}toLngLat(){return new Ti(Ju(this.x),ya(this.y))}toAltitude(){return aG(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/sG*lG(ya(this.y))}}function p3(c,l,f,p,A,b,C,M,N){const U=(l+p)/2,W=(f+A)/2,K=new ie(U,W);M(K),function(ee,oe,le,de,xe,Be){const $e=le-xe,Ne=de-Be;return Math.abs((de-oe)*$e-(le-ee)*Ne)/Math.hypot($e,Ne)}(K.x,K.y,b.x,b.y,C.x,C.y)>=N?(p3(c,l,f,U,W,b,K,M,N),p3(c,U,W,p,A,K,C,M,N)):c.push(C)}function uG(c,l,f){let p=c[0],A=p.x,b=p.y;l(p);const C=[p];for(let M=1;M<c.length;M++){const N=c[M],{x:U,y:W}=N;l(N),p3(C,A,b,U,W,p,N,l,f),A=U,b=W,p=N}return C}function g3(c,l,f,p){if(p(l,f)){const A=l.add(f)._mult(.5);g3(c,l,A,p),g3(c,A,f,p)}else c.push(f)}function The(c,l){let f=c[0];const p=[f];for(let A=1;A<c.length;A++){const b=c[A];g3(p,f,b,l),f=b}return p}const m3=Math.pow(2,14)-1,cG=-m3-1;function Che(c,l){const f=Math.round(c.x*l),p=Math.round(c.y*l);return c.x=be(f,cG,m3),c.y=be(p,cG,m3),(f<c.x||f>c.x+1||p<c.y||p>c.y+1)&&$t("Geometry exceeds allowed extent, reduce your vector tile buffer size"),c}function Dp(c,l,f){const p=c.loadGeometry(),A=c.extent,b=Kn/A;if(l&&f&&f.projection.isReprojectedInTileSpace){const C=1<<l.z,{scale:M,x:N,y:U,projection:W}=f,K=ee=>{const oe=Ju((l.x+ee.x/A)/C),le=ya((l.y+ee.y/A)/C),de=W.project(oe,le);ee.x=(de.x*M-N)*A,ee.y=(de.y*M-U)*A};for(let ee=0;ee<p.length;ee++)if(c.type!==1)p[ee]=uG(p[ee],K,1);else{const oe=[];for(const le of p[ee])le.x<0||le.x>=A||le.y<0||le.y>=A||(K(le),oe.push(le));p[ee]=oe}}for(const C of p)for(const M of C)Che(M,b);return p}function e0(c,l){return{type:c.type,id:c.id,properties:c.properties,geometry:l?Dp(c):[]}}function L2(c,l,f,p,A){c.emplaceBack(2*l+(p+1)/2,2*f+(A+1)/2)}function D2(c,l,f){c.emplaceBack(l.x,l.y,l.z,f[0]*16384,f[1]*16384,f[2]*16384)}class A3{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(f=>f.id),this.index=l.index,this.hasPattern=!1,this.projection=l.projection,this.layoutVertexArray=new en,this.indexArray=new Vn,this.segments=new Wo,this.programConfigurations=new XA(l.layers,l.zoom),this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(l,f,p,A){const b=this.layers[0],C=[];let M=null;b.type==="circle"&&(M=b.layout.get("circle-sort-key"));for(const{feature:U,id:W,index:K,sourceLayerIndex:ee}of l){const oe=this.layers[0]._featureFilter.needGeometry,le=e0(U,oe);if(!this.layers[0]._featureFilter.filter(new Q(this.zoom),le,p))continue;const de=M?M.evaluate(le,{},p):void 0,xe={id:W,properties:U.properties,type:U.type,sourceLayerIndex:ee,index:K,geometry:oe?le.geometry:Dp(U,p,A),patterns:{},sortKey:de};C.push(xe)}M&&C.sort((U,W)=>U.sortKey-W.sortKey);let N=null;A.projection.name==="globe"&&(this.globeExtVertexArray=new nn,N=A.projection);for(const U of C){const{geometry:W,index:K,sourceLayerIndex:ee}=U,oe=l[K].feature;this.addFeature(U,W,K,f.availableImages,p,N),f.featureIndex.insert(oe,W,K,ee,this.index)}}update(l,f,p,A){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,f,this.stateDependentLayers,p,A)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,dhe.members),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=l.createVertexBuffer(this.globeExtVertexArray,phe.members))),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(l,f,p,A,b,C){for(const M of f)for(const N of M){const U=N.x,W=N.y;if(U<0||U>=Kn||W<0||W>=Kn)continue;if(C){const oe=C.projectTilePoint(U,W,b),le=C.upVector(b,U,W),de=this.globeExtVertexArray;D2(de,oe,le),D2(de,oe,le),D2(de,oe,le),D2(de,oe,le)}const K=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,l.sortKey),ee=K.vertexLength;L2(this.layoutVertexArray,U,W,-1,-1),L2(this.layoutVertexArray,U,W,1,-1),L2(this.layoutVertexArray,U,W,1,1),L2(this.layoutVertexArray,U,W,-1,1),this.indexArray.emplaceBack(ee,ee+1,ee+2),this.indexArray.emplaceBack(ee,ee+2,ee+3),K.vertexLength+=4,K.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,{},A,b)}}function fG(c,l){for(let f=0;f<c.length;f++)if(t0(l,c[f]))return!0;for(let f=0;f<l.length;f++)if(t0(c,l[f]))return!0;return!!_3(c,l)}function Phe(c,l,f){return!!t0(c,l)||!!y3(l,c,f)}function hG(c,l){if(c.length===1)return pG(l,c[0]);for(let f=0;f<l.length;f++){const p=l[f];for(let A=0;A<p.length;A++)if(t0(c,p[A]))return!0}for(let f=0;f<c.length;f++)if(pG(l,c[f]))return!0;for(let f=0;f<l.length;f++)if(_3(c,l[f]))return!0;return!1}function Ihe(c,l,f){if(c.length>1){if(_3(c,l))return!0;for(let p=0;p<l.length;p++)if(y3(l[p],c,f))return!0}for(let p=0;p<c.length;p++)if(y3(c[p],l,f))return!0;return!1}function _3(c,l){if(c.length===0||l.length===0)return!1;for(let f=0;f<c.length-1;f++){const p=c[f],A=c[f+1];for(let b=0;b<l.length-1;b++)if(Mhe(p,A,l[b],l[b+1]))return!0}return!1}function Mhe(c,l,f,p){return cn(c,f,p)!==cn(l,f,p)&&cn(c,l,f)!==cn(c,l,p)}function y3(c,l,f){const p=f*f;if(l.length===1)return c.distSqr(l[0])<p;for(let A=1;A<l.length;A++)if(dG(c,l[A-1],l[A])<p)return!0;return!1}function dG(c,l,f){const p=l.distSqr(f);if(p===0)return c.distSqr(l);const A=((c.x-l.x)*(f.x-l.x)+(c.y-l.y)*(f.y-l.y))/p;return c.distSqr(A<0?l:A>1?f:f.sub(l)._mult(A)._add(l))}function pG(c,l){let f,p,A,b=!1;for(let C=0;C<c.length;C++){f=c[C];for(let M=0,N=f.length-1;M<f.length;N=M++)p=f[M],A=f[N],p.y>l.y!=A.y>l.y&&l.x<(A.x-p.x)*(l.y-p.y)/(A.y-p.y)+p.x&&(b=!b)}return b}function t0(c,l){let f=!1;for(let p=0,A=c.length-1;p<c.length;A=p++){const b=c[p],C=c[A];b.y>l.y!=C.y>l.y&&l.x<(C.x-b.x)*(l.y-b.y)/(C.y-b.y)+b.x&&(f=!f)}return f}function gG(c,l,f,p,A){for(const C of c)if(l<=C.x&&f<=C.y&&p>=C.x&&A>=C.y)return!0;const b=[new ie(l,f),new ie(l,A),new ie(p,A),new ie(p,f)];if(c.length>2){for(const C of b)if(t0(c,C))return!0}for(let C=0;C<c.length-1;C++)if(Ohe(c[C],c[C+1],b))return!0;return!1}function Ohe(c,l,f){const p=f[0],A=f[2];if(c.x<p.x&&l.x<p.x||c.x>A.x&&l.x>A.x||c.y<p.y&&l.y<p.y||c.y>A.y&&l.y>A.y)return!1;const b=cn(c,l,f[0]);return b!==cn(c,l,f[1])||b!==cn(c,l,f[2])||b!==cn(c,l,f[3])}function K_(c,l,f){const p=l.paint.get(c).value;return p.kind==="constant"?p.value:f.programConfigurations.get(l.id).getMaxValue(c)}function B2(c){return Math.sqrt(c[0]*c[0]+c[1]*c[1])}function mG(c,l,f,p,A){if(!l[0]&&!l[1])return c;const b=ie.convert(l)._mult(A);f==="viewport"&&b._rotate(-p);const C=[];for(let M=0;M<c.length;M++)C.push(c[M].sub(b));return C}function AG(c,l,f,p){const A=ie.convert(c)._mult(p);return l==="viewport"&&A._rotate(-f),A}Mt(A3,"CircleBucket",{omit:["layers"]});const Rhe=new ke({"circle-sort-key":new Se(pt.layout_circle["circle-sort-key"])});var Lhe={paint:new ke({"circle-radius":new Se(pt.paint_circle["circle-radius"]),"circle-color":new Se(pt.paint_circle["circle-color"]),"circle-blur":new Se(pt.paint_circle["circle-blur"]),"circle-opacity":new Se(pt.paint_circle["circle-opacity"]),"circle-translate":new he(pt.paint_circle["circle-translate"]),"circle-translate-anchor":new he(pt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new he(pt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new he(pt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Se(pt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Se(pt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Se(pt.paint_circle["circle-stroke-opacity"])}),layout:Rhe};function _G(c,l,f,p,A,b,C,M,N){if(b&&c.queryGeometry.isAboveHorizon)return!1;b&&(N*=c.pixelToTileUnitsFactor);const U=c.tileID.canonical,W=f.projection.upVectorScale(U,f.center.lat,f.worldSize).metersToTile;for(const K of l)for(const ee of K){const oe=ee.add(M),le=A&&f.elevation?f.elevation.exaggeration()*A.getElevationAt(oe.x,oe.y,!0):0,de=f.projection.projectTilePoint(oe.x,oe.y,U);if(le>0){const Ne=f.projection.upVector(U,oe.x,oe.y);de.x+=Ne[0]*W*le,de.y+=Ne[1]*W*le,de.z+=Ne[2]*W*le}const xe=b?oe:Dhe(de.x,de.y,de.z,p),Be=b?c.tilespaceRays.map(Ne=>Nhe(Ne,le)):c.queryGeometry.screenGeometry,$e=QA([],[de.x,de.y,de.z,1],p);if(!C&&b?N*=$e[3]/f.cameraToCenterDistance:C&&!b&&(N*=f.cameraToCenterDistance/$e[3]),b){const Ne=ya((ee.y/Kn+U.y)/(1<<U.z));N/=f.projection.pixelsPerMeter(Ne,1)/Kf(1,Ne)}if(Phe(Be,xe,N))return!0}return!1}function Dhe(c,l,f,p){const A=QA([],[c,l,f,1],p);return new ie(A[0]/A[3],A[1]/A[3])}const yG=q_(0,0,0),Bhe=q_(0,0,1);function Nhe(c,l){const f=n3();return yG[2]=l,c.intersectsPlane(yG,Bhe,f),new ie(f[0],f[1])}class vG extends A3{}function xG(c,{width:l,height:f},p,A){if(A){if(A instanceof Uint8ClampedArray)A=new Uint8Array(A.buffer);else if(A.length!==l*f*p)throw new RangeError("mismatched image size")}else A=new Uint8Array(l*f*p);return c.width=l,c.height=f,c.data=A,c}function bG(c,l,f){const{width:p,height:A}=l;p===c.width&&A===c.height||(v3(c,l,{x:0,y:0},{x:0,y:0},{width:Math.min(c.width,p),height:Math.min(c.height,A)},f),c.width=p,c.height=A,c.data=l.data)}function v3(c,l,f,p,A,b){if(A.width===0||A.height===0)return l;if(A.width>c.width||A.height>c.height||f.x>c.width-A.width||f.y>c.height-A.height)throw new RangeError("out of range source coordinates for image copy");if(A.width>l.width||A.height>l.height||p.x>l.width-A.width||p.y>l.height-A.height)throw new RangeError("out of range destination coordinates for image copy");const C=c.data,M=l.data;for(let N=0;N<A.height;N++){const U=((f.y+N)*c.width+f.x)*b,W=((p.y+N)*l.width+p.x)*b;for(let K=0;K<A.width*b;K++)M[W+K]=C[U+K]}return l}Mt(vG,"HeatmapBucket",{omit:["layers"]});class Bp{constructor(l,f){xG(this,l,1,f)}resize(l){bG(this,new Bp(l),1)}clone(){return new Bp({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,f,p,A,b){v3(l,f,p,A,b,1)}}class mu{constructor(l,f){xG(this,l,4,f)}resize(l){bG(this,new mu(l),4)}replace(l,f){f?this.data.set(l):this.data=l instanceof Uint8ClampedArray?new Uint8Array(l.buffer):l}clone(){return new mu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(l,f,p,A,b){v3(l,f,p,A,b,4)}}Mt(Bp,"AlphaImage"),Mt(mu,"RGBAImage");var Fhe={paint:new ke({"heatmap-radius":new Se(pt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Se(pt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new he(pt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Fe(pt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new he(pt.paint_heatmap["heatmap-opacity"])})};function x3(c){const l={},f=c.resolution||256,p=c.clips?c.clips.length:1,A=c.image||new mu({width:f,height:p}),b=(C,M,N)=>{l[c.evaluationKey]=N;const U=c.expression.evaluate(l);A.data[C+M+0]=Math.floor(255*U.r/U.a),A.data[C+M+1]=Math.floor(255*U.g/U.a),A.data[C+M+2]=Math.floor(255*U.b/U.a),A.data[C+M+3]=Math.floor(255*U.a)};if(c.clips)for(let C=0,M=0;C<p;++C,M+=4*f)for(let N=0,U=0;N<f;N++,U+=4){const W=N/(f-1),{start:K,end:ee}=c.clips[C];b(M,U,K*(1-W)+ee*W)}else for(let C=0,M=0;C<f;C++,M+=4)b(0,M,C/(f-1));return A}var khe={paint:new ke({"hillshade-illumination-direction":new he(pt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new he(pt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new he(pt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new he(pt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new he(pt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new he(pt.paint_hillshade["hillshade-accent-color"])})};const zhe=st([{name:"a_pos",components:2,type:"Int16"}],4),{members:Uhe}=zhe;var b3={exports:{}};function N2(c,l,f){f=f||2;var p,A,b,C,M,N,U,W=l&&l.length,K=W?l[0]*f:c.length,ee=wG(c,0,K,f,!0),oe=[];if(!ee||ee.next===ee.prev)return oe;if(W&&(ee=function(de,xe,Be,$e){var Ne,je,Ze,We=[];for(Ne=0,je=xe.length;Ne<je;Ne++)(Ze=wG(de,xe[Ne]*$e,Ne<je-1?xe[Ne+1]*$e:de.length,$e,!1))===Ze.next&&(Ze.steiner=!0),We.push(Xhe(Ze));for(We.sort(Hhe),Ne=0;Ne<We.length;Ne++)Be=Whe(We[Ne],Be);return Be}(c,l,ee,f)),c.length>80*f){p=b=c[0],A=C=c[1];for(var le=f;le<K;le+=f)(M=c[le])<p&&(p=M),(N=c[le+1])<A&&(A=N),M>b&&(b=M),N>C&&(C=N);U=(U=Math.max(b-p,C-A))!==0?32767/U:0}return Mx(ee,oe,f,p,A,U,0),oe}function wG(c,l,f,p,A){var b,C;if(A===S3(c,l,f,p)>0)for(b=l;b<f;b+=p)C=TG(b,c[b],c[b+1],C);else for(b=f-p;b>=l;b-=p)C=TG(b,c[b],c[b+1],C);return C&&F2(C,C.next)&&(Rx(C),C=C.next),C}function n0(c,l){if(!c)return c;l||(l=c);var f,p=c;do if(f=!1,p.steiner||!F2(p,p.next)&&qo(p.prev,p,p.next)!==0)p=p.next;else{if(Rx(p),(p=l=p.prev)===p.next)break;f=!0}while(f||p!==l);return l}function Mx(c,l,f,p,A,b,C){if(c){!C&&b&&function(W,K,ee,oe){var le=W;do le.z===0&&(le.z=w3(le.x,le.y,K,ee,oe)),le.prevZ=le.prev,le.nextZ=le.next,le=le.next;while(le!==W);le.prevZ.nextZ=null,le.prevZ=null,function(de){var xe,Be,$e,Ne,je,Ze,We,bt,At=1;do{for(Be=de,de=null,je=null,Ze=0;Be;){for(Ze++,$e=Be,We=0,xe=0;xe<At&&(We++,$e=$e.nextZ);xe++);for(bt=At;We>0||bt>0&&$e;)We!==0&&(bt===0||!$e||Be.z<=$e.z)?(Ne=Be,Be=Be.nextZ,We--):(Ne=$e,$e=$e.nextZ,bt--),je?je.nextZ=Ne:de=Ne,Ne.prevZ=je,je=Ne;Be=$e}je.nextZ=null,At*=2}while(Ze>1)}(le)}(c,p,A,b);for(var M,N,U=c;c.prev!==c.next;)if(M=c.prev,N=c.next,b?jhe(c,p,A,b):Ghe(c))l.push(M.i/f|0),l.push(c.i/f|0),l.push(N.i/f|0),Rx(c),c=N.next,U=N.next;else if((c=N)===U){C?C===1?Mx(c=Vhe(n0(c),l,f),l,f,p,A,b,2):C===2&&$he(c,l,f,p,A,b):Mx(n0(c),l,f,p,A,b,1);break}}}function Ghe(c){var l=c.prev,f=c,p=c.next;if(qo(l,f,p)>=0)return!1;for(var A=l.x,b=f.x,C=p.x,M=l.y,N=f.y,U=p.y,W=A<b?A<C?A:C:b<C?b:C,K=M<N?M<U?M:U:N<U?N:U,ee=A>b?A>C?A:C:b>C?b:C,oe=M>N?M>U?M:U:N>U?N:U,le=p.next;le!==l;){if(le.x>=W&&le.x<=ee&&le.y>=K&&le.y<=oe&&J_(A,M,b,N,C,U,le.x,le.y)&&qo(le.prev,le,le.next)>=0)return!1;le=le.next}return!0}function jhe(c,l,f,p){var A=c.prev,b=c,C=c.next;if(qo(A,b,C)>=0)return!1;for(var M=A.x,N=b.x,U=C.x,W=A.y,K=b.y,ee=C.y,oe=M<N?M<U?M:U:N<U?N:U,le=W<K?W<ee?W:ee:K<ee?K:ee,de=M>N?M>U?M:U:N>U?N:U,xe=W>K?W>ee?W:ee:K>ee?K:ee,Be=w3(oe,le,l,f,p),$e=w3(de,xe,l,f,p),Ne=c.prevZ,je=c.nextZ;Ne&&Ne.z>=Be&&je&&je.z<=$e;){if(Ne.x>=oe&&Ne.x<=de&&Ne.y>=le&&Ne.y<=xe&&Ne!==A&&Ne!==C&&J_(M,W,N,K,U,ee,Ne.x,Ne.y)&&qo(Ne.prev,Ne,Ne.next)>=0||(Ne=Ne.prevZ,je.x>=oe&&je.x<=de&&je.y>=le&&je.y<=xe&&je!==A&&je!==C&&J_(M,W,N,K,U,ee,je.x,je.y)&&qo(je.prev,je,je.next)>=0))return!1;je=je.nextZ}for(;Ne&&Ne.z>=Be;){if(Ne.x>=oe&&Ne.x<=de&&Ne.y>=le&&Ne.y<=xe&&Ne!==A&&Ne!==C&&J_(M,W,N,K,U,ee,Ne.x,Ne.y)&&qo(Ne.prev,Ne,Ne.next)>=0)return!1;Ne=Ne.prevZ}for(;je&&je.z<=$e;){if(je.x>=oe&&je.x<=de&&je.y>=le&&je.y<=xe&&je!==A&&je!==C&&J_(M,W,N,K,U,ee,je.x,je.y)&&qo(je.prev,je,je.next)>=0)return!1;je=je.nextZ}return!0}function Vhe(c,l,f){var p=c;do{var A=p.prev,b=p.next.next;!F2(A,b)&&EG(A,p,p.next,b)&&Ox(A,b)&&Ox(b,A)&&(l.push(A.i/f|0),l.push(p.i/f|0),l.push(b.i/f|0),Rx(p),Rx(p.next),p=c=b),p=p.next}while(p!==c);return n0(p)}function $he(c,l,f,p,A,b){var C=c;do{for(var M=C.next.next;M!==C.prev;){if(C.i!==M.i&&Zhe(C,M)){var N=SG(C,M);return C=n0(C,C.next),N=n0(N,N.next),Mx(C,l,f,p,A,b,0),void Mx(N,l,f,p,A,b,0)}M=M.next}C=C.next}while(C!==c)}function Hhe(c,l){return c.x-l.x}function Whe(c,l){var f=function(A,b){var C,M=b,N=A.x,U=A.y,W=-1/0;do{if(U<=M.y&&U>=M.next.y&&M.next.y!==M.y){var K=M.x+(U-M.y)*(M.next.x-M.x)/(M.next.y-M.y);if(K<=N&&K>W&&(W=K,C=M.x<M.next.x?M:M.next,K===N))return C}M=M.next}while(M!==b);if(!C)return null;var ee,oe=C,le=C.x,de=C.y,xe=1/0;M=C;do N>=M.x&&M.x>=le&&N!==M.x&&J_(U<de?N:W,U,le,de,U<de?W:N,U,M.x,M.y)&&(ee=Math.abs(U-M.y)/(N-M.x),Ox(M,A)&&(ee<xe||ee===xe&&(M.x>C.x||M.x===C.x&&qhe(C,M)))&&(C=M,xe=ee)),M=M.next;while(M!==oe);return C}(c,l);if(!f)return l;var p=SG(f,c);return n0(p,p.next),n0(f,f.next)}function qhe(c,l){return qo(c.prev,c,l.prev)<0&&qo(l.next,c,c.next)<0}function w3(c,l,f,p,A){return(c=1431655765&((c=858993459&((c=252645135&((c=16711935&((c=(c-f)*A|0)|c<<8))|c<<4))|c<<2))|c<<1))|(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-p)*A|0)|l<<8))|l<<4))|l<<2))|l<<1))<<1}function Xhe(c){var l=c,f=c;do(l.x<f.x||l.x===f.x&&l.y<f.y)&&(f=l),l=l.next;while(l!==c);return f}function J_(c,l,f,p,A,b,C,M){return(A-C)*(l-M)>=(c-C)*(b-M)&&(c-C)*(p-M)>=(f-C)*(l-M)&&(f-C)*(b-M)>=(A-C)*(p-M)}function Zhe(c,l){return c.next.i!==l.i&&c.prev.i!==l.i&&!function(f,p){var A=f;do{if(A.i!==f.i&&A.next.i!==f.i&&A.i!==p.i&&A.next.i!==p.i&&EG(A,A.next,f,p))return!0;A=A.next}while(A!==f);return!1}(c,l)&&(Ox(c,l)&&Ox(l,c)&&function(f,p){var A=f,b=!1,C=(f.x+p.x)/2,M=(f.y+p.y)/2;do A.y>M!=A.next.y>M&&A.next.y!==A.y&&C<(A.next.x-A.x)*(M-A.y)/(A.next.y-A.y)+A.x&&(b=!b),A=A.next;while(A!==f);return b}(c,l)&&(qo(c.prev,c,l.prev)||qo(c,l.prev,l))||F2(c,l)&&qo(c.prev,c,c.next)>0&&qo(l.prev,l,l.next)>0)}function qo(c,l,f){return(l.y-c.y)*(f.x-l.x)-(l.x-c.x)*(f.y-l.y)}function F2(c,l){return c.x===l.x&&c.y===l.y}function EG(c,l,f,p){var A=z2(qo(c,l,f)),b=z2(qo(c,l,p)),C=z2(qo(f,p,c)),M=z2(qo(f,p,l));return A!==b&&C!==M||!(A!==0||!k2(c,f,l))||!(b!==0||!k2(c,p,l))||!(C!==0||!k2(f,c,p))||!(M!==0||!k2(f,l,p))}function k2(c,l,f){return l.x<=Math.max(c.x,f.x)&&l.x>=Math.min(c.x,f.x)&&l.y<=Math.max(c.y,f.y)&&l.y>=Math.min(c.y,f.y)}function z2(c){return c>0?1:c<0?-1:0}function Ox(c,l){return qo(c.prev,c,c.next)<0?qo(c,l,c.next)>=0&&qo(c,c.prev,l)>=0:qo(c,l,c.prev)<0||qo(c,c.next,l)<0}function SG(c,l){var f=new E3(c.i,c.x,c.y),p=new E3(l.i,l.x,l.y),A=c.next,b=l.prev;return c.next=l,l.prev=c,f.next=A,A.prev=f,p.next=f,f.prev=p,b.next=p,p.prev=b,p}function TG(c,l,f,p){var A=new E3(c,l,f);return p?(A.next=p.next,A.prev=p,p.next.prev=A,p.next=A):(A.prev=A,A.next=A),A}function Rx(c){c.next.prev=c.prev,c.prev.next=c.next,c.prevZ&&(c.prevZ.nextZ=c.nextZ),c.nextZ&&(c.nextZ.prevZ=c.prevZ)}function E3(c,l,f){this.i=c,this.x=l,this.y=f,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function S3(c,l,f,p){for(var A=0,b=l,C=f-p;b<f;b+=p)A+=(c[C]-c[b])*(c[b+1]+c[C+1]),C=b;return A}b3.exports=N2,b3.exports.default=N2,N2.deviation=function(c,l,f,p){var A=l&&l.length,b=Math.abs(S3(c,0,A?l[0]*f:c.length,f));if(A)for(var C=0,M=l.length;C<M;C++)b-=Math.abs(S3(c,l[C]*f,C<M-1?l[C+1]*f:c.length,f));var N=0;for(C=0;C<p.length;C+=3){var U=p[C]*f,W=p[C+1]*f,K=p[C+2]*f;N+=Math.abs((c[U]-c[K])*(c[W+1]-c[U+1])-(c[U]-c[W])*(c[K+1]-c[U+1]))}return b===0&&N===0?0:Math.abs((N-b)/b)},N2.flatten=function(c){for(var l=c[0][0].length,f={vertices:[],holes:[],dimensions:l},p=0,A=0;A<c.length;A++){for(var b=0;b<c[A].length;b++)for(var C=0;C<l;C++)f.vertices.push(c[A][b][C]);A>0&&f.holes.push(p+=c[A-1].length)}return f};var T3=z(b3.exports);function Yhe(c,l,f,p,A){CG(c,l,f||0,p||c.length-1,A||Qhe)}function CG(c,l,f,p,A){for(;p>f;){if(p-f>600){var b=p-f+1,C=l-f+1,M=Math.log(b),N=.5*Math.exp(2*M/3),U=.5*Math.sqrt(M*N*(b-N)/b)*(C-b/2<0?-1:1);CG(c,l,Math.max(f,Math.floor(l-C*N/b+U)),Math.min(p,Math.floor(l+(b-C)*N/b+U)),A)}var W=c[l],K=f,ee=p;for(Lx(c,f,l),A(c[p],W)>0&&Lx(c,f,p);K<ee;){for(Lx(c,K,ee),K++,ee--;A(c[K],W)<0;)K++;for(;A(c[ee],W)>0;)ee--}A(c[f],W)===0?Lx(c,f,ee):Lx(c,++ee,p),ee<=l&&(f=ee+1),l<=ee&&(p=ee-1)}}function Lx(c,l,f){var p=c[l];c[l]=c[f],c[f]=p}function Qhe(c,l){return c<l?-1:c>l?1:0}function C3(c,l){const f=c.length;if(f<=1)return[c];const p=[];let A,b;for(let C=0;C<f;C++){const M=Jt(c[C]);M!==0&&(c[C].area=Math.abs(M),b===void 0&&(b=M<0),b===M<0?(A&&p.push(A),A=[c[C]]):A.push(c[C]))}if(A&&p.push(A),l>1)for(let C=0;C<p.length;C++)p[C].length<=l||(Yhe(p[C],l,1,p[C].length-1,Khe),p[C]=p[C].slice(0,l));return p}function Khe(c,l){return l.area-c.area}function P3(c,l,f){const p=f.patternDependencies;let A=!1;for(const b of l){const C=b.paint.get(`${c}-pattern`);C.isConstant()||(A=!0);const M=C.constantOr(null);M&&(A=!0,p[M]=!0)}return A}function I3(c,l,f,p,A){const b=A.patternDependencies;for(const C of l){const M=C.paint.get(`${c}-pattern`).value;if(M.kind!=="constant"){let N=M.evaluate({zoom:p},f,{},A.availableImages);N=N&&N.name?N.name:N,b[N]=!0,f.patterns[C.id]=N}}return f}class U2{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(f=>f.id),this.index=l.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new en,this.indexArray=new Vn,this.indexArray2=new Ns,this.programConfigurations=new XA(l.layers,l.zoom),this.segments=new Wo,this.segments2=new Wo,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id),this.projection=l.projection}populate(l,f,p,A){this.hasPattern=P3("fill",this.layers,f);const b=this.layers[0].layout.get("fill-sort-key"),C=[];for(const{feature:M,id:N,index:U,sourceLayerIndex:W}of l){const K=this.layers[0]._featureFilter.needGeometry,ee=e0(M,K);if(!this.layers[0]._featureFilter.filter(new Q(this.zoom),ee,p))continue;const oe=b?b.evaluate(ee,{},p,f.availableImages):void 0,le={id:N,properties:M.properties,type:M.type,sourceLayerIndex:W,index:U,geometry:K?ee.geometry:Dp(M,p,A),patterns:{},sortKey:oe};C.push(le)}b&&C.sort((M,N)=>M.sortKey-N.sortKey);for(const M of C){const{geometry:N,index:U,sourceLayerIndex:W}=M;if(this.hasPattern){const K=I3("fill",this.layers,M,this.zoom,f);this.patternFeatures.push(K)}else this.addFeature(M,N,U,p,{},f.availableImages);f.featureIndex.insert(l[U].feature,N,U,W,this.index)}}update(l,f,p,A){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,f,this.stateDependentLayers,p,A)}addFeatures(l,f,p,A,b){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,f,p,A)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Uhe),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.indexBuffer2=l.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(l,f,p,A,b,C=[]){for(const M of C3(f,500)){let N=0;for(const le of M)N+=le.length;const U=this.segments.prepareSegment(N,this.layoutVertexArray,this.indexArray),W=U.vertexLength,K=[],ee=[];for(const le of M){if(le.length===0)continue;le!==M[0]&&ee.push(K.length/2);const de=this.segments2.prepareSegment(le.length,this.layoutVertexArray,this.indexArray2),xe=de.vertexLength;this.layoutVertexArray.emplaceBack(le[0].x,le[0].y),this.indexArray2.emplaceBack(xe+le.length-1,xe),K.push(le[0].x),K.push(le[0].y);for(let Be=1;Be<le.length;Be++)this.layoutVertexArray.emplaceBack(le[Be].x,le[Be].y),this.indexArray2.emplaceBack(xe+Be-1,xe+Be),K.push(le[Be].x),K.push(le[Be].y);de.vertexLength+=le.length,de.primitiveLength+=le.length}const oe=T3(K,ee);for(let le=0;le<oe.length;le+=3)this.indexArray.emplaceBack(W+oe[le],W+oe[le+1],W+oe[le+2]);U.vertexLength+=N,U.primitiveLength+=oe.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,b,C,A)}}Mt(U2,"FillBucket",{omit:["layers","patternFeatures"]});const Jhe=new ke({"fill-sort-key":new Se(pt.layout_fill["fill-sort-key"])});var ede={paint:new ke({"fill-antialias":new he(pt.paint_fill["fill-antialias"]),"fill-opacity":new Se(pt.paint_fill["fill-opacity"]),"fill-color":new Se(pt.paint_fill["fill-color"]),"fill-outline-color":new Se(pt.paint_fill["fill-outline-color"]),"fill-translate":new he(pt.paint_fill["fill-translate"]),"fill-translate-anchor":new he(pt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Se(pt.paint_fill["fill-pattern"])}),layout:Jhe};const tde=st([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),nde=st([{name:"a_centroid_pos",components:2,type:"Uint16"}]),rde=st([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:ide}=tde;var G2={},ode=re,PG=ey;function ey(c,l,f,p,A){this.properties={},this.extent=f,this.type=0,this._pbf=c,this._geometry=-1,this._keys=p,this._values=A,c.readFields(sde,this,l)}function sde(c,l,f){c==1?l.id=f.readVarint():c==2?function(p,A){for(var b=p.readVarint()+p.pos;p.pos<b;){var C=A._keys[p.readVarint()],M=A._values[p.readVarint()];A.properties[C]=M}}(f,l):c==3?l.type=f.readVarint():c==4&&(l._geometry=f.pos)}function ade(c){for(var l,f,p=0,A=0,b=c.length,C=b-1;A<b;C=A++)p+=((f=c[C]).x-(l=c[A]).x)*(l.y+f.y);return p}ey.types=["Unknown","Point","LineString","Polygon"],ey.prototype.loadGeometry=function(){var c=this._pbf;c.pos=this._geometry;for(var l,f=c.readVarint()+c.pos,p=1,A=0,b=0,C=0,M=[];c.pos<f;){if(A<=0){var N=c.readVarint();p=7&N,A=N>>3}if(A--,p===1||p===2)b+=c.readSVarint(),C+=c.readSVarint(),p===1&&(l&&M.push(l),l=[]),l.push(new ode(b,C));else{if(p!==7)throw new Error("unknown command "+p);l&&l.push(l[0].clone())}}return l&&M.push(l),M},ey.prototype.bbox=function(){var c=this._pbf;c.pos=this._geometry;for(var l=c.readVarint()+c.pos,f=1,p=0,A=0,b=0,C=1/0,M=-1/0,N=1/0,U=-1/0;c.pos<l;){if(p<=0){var W=c.readVarint();f=7&W,p=W>>3}if(p--,f===1||f===2)(A+=c.readSVarint())<C&&(C=A),A>M&&(M=A),(b+=c.readSVarint())<N&&(N=b),b>U&&(U=b);else if(f!==7)throw new Error("unknown command "+f)}return[C,N,M,U]},ey.prototype.toGeoJSON=function(c,l,f){var p,A,b=this.extent*Math.pow(2,f),C=this.extent*c,M=this.extent*l,N=this.loadGeometry(),U=ey.types[this.type];function W(oe){for(var le=0;le<oe.length;le++){var de=oe[le];oe[le]=[360*(de.x+C)/b-180,360/Math.PI*Math.atan(Math.exp((180-360*(de.y+M)/b)*Math.PI/180))-90]}}switch(this.type){case 1:var K=[];for(p=0;p<N.length;p++)K[p]=N[p][0];W(N=K);break;case 2:for(p=0;p<N.length;p++)W(N[p]);break;case 3:for(N=function(oe){var le=oe.length;if(le<=1)return[oe];for(var de,xe,Be=[],$e=0;$e<le;$e++){var Ne=ade(oe[$e]);Ne!==0&&(xe===void 0&&(xe=Ne<0),xe===Ne<0?(de&&Be.push(de),de=[oe[$e]]):de.push(oe[$e]))}return de&&Be.push(de),Be}(N),p=0;p<N.length;p++)for(A=0;A<N[p].length;A++)W(N[p][A])}N.length===1?N=N[0]:U="Multi"+U;var ee={type:"Feature",geometry:{type:U,coordinates:N},properties:this.properties};return"id"in this&&(ee.id=this.id),ee};var lde=PG,IG=MG;function MG(c,l){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=c,this._keys=[],this._values=[],this._features=[],c.readFields(ude,this,l),this.length=this._features.length}function ude(c,l,f){c===15?l.version=f.readVarint():c===1?l.name=f.readString():c===5?l.extent=f.readVarint():c===2?l._features.push(f.pos):c===3?l._keys.push(f.readString()):c===4&&l._values.push(function(p){for(var A=null,b=p.readVarint()+p.pos;p.pos<b;){var C=p.readVarint()>>3;A=C===1?p.readString():C===2?p.readFloat():C===3?p.readDouble():C===4?p.readVarint64():C===5?p.readVarint():C===6?p.readSVarint():C===7?p.readBoolean():null}return A}(f))}MG.prototype.feature=function(c){if(c<0||c>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[c];var l=this._pbf.readVarint()+this._pbf.pos;return new lde(this._pbf,l,this.extent,this._keys,this._values)};var cde=IG;function fde(c,l,f){if(c===3){var p=new cde(f,f.readVarint()+f.pos);p.length&&(l[p.name]=p)}}var M3=G2.VectorTile=function(c,l){this.layers=c.readFields(fde,{},l)},j2=G2.VectorTileFeature=PG;function V2(c,l,f,p){const A=[],b=p===0?(C,M,N,U,W,K)=>{C.push(new ie(K,N+(K-M)/(U-M)*(W-N)))}:(C,M,N,U,W,K)=>{C.push(new ie(M+(K-N)/(W-N)*(U-M),K))};for(const C of c){const M=[];for(const N of C){if(N.length<=2)continue;const U=[];for(let ee=0;ee<N.length-1;ee++){const oe=N[ee].x,le=N[ee].y,de=N[ee+1].x,xe=N[ee+1].y,Be=p===0?oe:le,$e=p===0?de:xe;Be<l?$e>l&&b(U,oe,le,de,xe,l):Be>f?$e<f&&b(U,oe,le,de,xe,f):U.push(N[ee]),$e<l&&Be>=l&&b(U,oe,le,de,xe,l),$e>f&&Be<=f&&b(U,oe,le,de,xe,f)}let W=N[N.length-1];const K=p===0?W.x:W.y;K>=l&&K<=f&&U.push(W),U.length&&(W=U[U.length-1],U[0].x===W.x&&U[0].y===W.y||U.push(U[0]),M.push(U))}M.length&&A.push(M)}return A}G2.VectorTileLayer=IG;const hde=j2.types,dde=Math.pow(2,13);function Dx(c,l,f,p,A,b,C,M){c.emplaceBack((l<<1)+C,(f<<1)+b,(Math.floor(p*dde)<<1)+A,Math.round(M))}function Bx(c,l,f){c.emplaceBack(l.x,l.y,l.z,f[0]*16384,f[1]*16384,f[2]*16384)}class OG{constructor(){this.acc=new ie(0,0),this.polyCount=[]}startRing(l){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new ie(l.x,l.y),this.max=new ie(l.x,l.y))}append(l,f){this.currentPolyCount.edges++,this.acc._add(l);const p=this.min,A=this.max;l.x<p.x?p.x=l.x:l.x>A.x&&(A.x=l.x),l.y<p.y?p.y=l.y:l.y>A.y&&(A.y=l.y),((l.x===0||l.x===Kn)&&l.x===f.x)!=((l.y===0||l.y===Kn)&&l.y===f.y)&&this.processBorderOverlap(l,f),f.x<0!=l.x<0&&this.addBorderIntersection(0,jr(f.y,l.y,(0-f.x)/(l.x-f.x))),f.x>Kn!=l.x>Kn&&this.addBorderIntersection(1,jr(f.y,l.y,(Kn-f.x)/(l.x-f.x))),f.y<0!=l.y<0&&this.addBorderIntersection(2,jr(f.x,l.x,(0-f.y)/(l.y-f.y))),f.y>Kn!=l.y>Kn&&this.addBorderIntersection(3,jr(f.x,l.x,(Kn-f.y)/(l.y-f.y)))}addBorderIntersection(l,f){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const p=this.borders[l];f<p[0]&&(p[0]=f),f>p[1]&&(p[1]=f)}processBorderOverlap(l,f){if(l.x===f.x){if(l.y===f.y)return;const p=l.x===0?0:1;this.addBorderIntersection(p,f.y),this.addBorderIntersection(p,l.y)}else{const p=l.y===0?2:3;this.addBorderIntersection(p,f.x),this.addBorderIntersection(p,l.x)}}centroid(){const l=this.polyCount.reduce((f,p)=>f+p.edges,0);return l!==0?this.acc.div(l)._round():new ie(0,0)}span(){return new ie(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((l,f)=>l+ +(f[0]!==Number.MAX_VALUE),0)}}class Nx{constructor(l){this.zoom=l.zoom,this.canonical=l.canonical,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(f=>f.id),this.index=l.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=l.projection,this.layoutVertexArray=new Ut,this.centroidVertexArray=new qf,this.indexArray=new Vn,this.programConfigurations=new XA(l.layers,l.zoom),this.segments=new Wo,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id),this.enableTerrain=l.enableTerrain}populate(l,f,p,A){this.features=[],this.hasPattern=P3("fill-extrusion",this.layers,f),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(b){const C=Math.exp(Math.PI*(1-b.y/(1<<b.z)*2));return 80150034*C/(C*C+1)/Kn/(1<<b.z)}(p),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:b,id:C,index:M,sourceLayerIndex:N}of l){const U=this.layers[0]._featureFilter.needGeometry,W=e0(b,U);if(!this.layers[0]._featureFilter.filter(new Q(this.zoom),W,p))continue;const K={id:C,sourceLayerIndex:N,index:M,geometry:U?W.geometry:Dp(b,p,A),properties:b.properties,type:b.type,patterns:{}},ee=this.layoutVertexArray.length;this.hasPattern?this.features.push(I3("fill-extrusion",this.layers,K,this.zoom,f)):this.addFeature(K,K.geometry,M,p,{},f.availableImages,A),f.featureIndex.insert(b,K.geometry,M,N,this.index,ee)}this.sortBorders()}addFeatures(l,f,p,A,b){for(const C of this.features){const{geometry:M}=C;this.addFeature(C,M,C.index,f,p,A,b)}this.sortBorders()}update(l,f,p,A){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,f,this.stateDependentLayers,p,A)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,ide),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=l.createVertexBuffer(this.layoutVertexExtArray,rde.members,!0))),this.programConfigurations.upload(l),this.uploaded=!0}uploadCentroid(l){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=l.createVertexBuffer(this.centroidVertexArray,nde.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(l,f,p,A,b,C,M){const N=[new ie(0,0),new ie(Kn,Kn)],U=M.projection,W=U.name==="globe",K=this.enableTerrain&&!W?new OG:null,ee=hde[l.type]==="Polygon";W&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new nn);const oe=C3(f,500);for(let Be=oe.length-1;Be>=0;Be--){const $e=oe[Be];($e.length===0||(le=$e[0]).every(Ne=>Ne.x<=0)||le.every(Ne=>Ne.x>=Kn)||le.every(Ne=>Ne.y<=0)||le.every(Ne=>Ne.y>=Kn))&&oe.splice(Be,1)}var le;let de;if(W)de=kG(oe,N,A);else{de=[];for(const Be of oe)de.push({polygon:Be,bounds:N})}const xe=ee?this.edgeRadius:0;for(const{polygon:Be,bounds:$e}of de){let Ne=0,je=0;for(const We of Be)ee&&!We[0].equals(We[We.length-1])&&We.push(We[0]),je+=ee?We.length-1:We.length;const Ze=this.segments.prepareSegment((ee?5:4)*je,this.layoutVertexArray,this.indexArray);if(ee){const We=[],bt=[];Ne=Ze.vertexLength;for(const Ft of Be){let tn,Tt;Ft.length&&Ft!==Be[0]&&bt.push(We.length/2),tn=Ft[1].sub(Ft[0])._perp()._unit();for(let Gt=1;Gt<Ft.length;Gt++){const jt=Ft[Gt],Yt=Ft[Gt===Ft.length-1?1:Gt+1];let{x:ln,y:Bt}=jt;if(xe){Tt=Yt.sub(jt)._perp()._unit();const xn=tn.add(Tt)._unit(),zn=xe*Math.min(4,1/(tn.x*xn.x+tn.y*xn.y));ln+=zn*xn.x,Bt+=zn*xn.y,tn=Tt}Dx(this.layoutVertexArray,ln,Bt,0,0,1,1,0),Ze.vertexLength++,We.push(jt.x,jt.y),W&&Bx(this.layoutVertexExtArray,U.projectTilePoint(ln,Bt,A),U.upVector(A,ln,Bt))}}const At=T3(We,bt);for(let Ft=0;Ft<At.length;Ft+=3)this.indexArray.emplaceBack(Ne+At[Ft],Ne+At[Ft+2],Ne+At[Ft+1]),Ze.primitiveLength++}for(const We of Be){K&&We.length&&K.startRing(We[0]);let bt,At,Ft,tn=We.length>4&&BG(We[We.length-2],We[0],We[1]),Tt=xe?pde(We[We.length-2],We[0],We[1],xe):0;At=We[1].sub(We[0])._perp()._unit();let Gt=!0;for(let jt=1,Yt=0;jt<We.length;jt++){let ln=We[jt-1],Bt=We[jt];const xn=We[jt===We.length-1?1:jt+1];if(K&&ee&&K.currentPolyCount.top++,DG(Bt,ln,$e)){xe&&(At=xn.sub(Bt)._perp()._unit(),Gt=!Gt);continue}K&&K.append(Bt,ln);const zn=Bt.sub(ln)._perp(),En=zn.x/(Math.abs(zn.x)+Math.abs(zn.y)),Ar=zn.y>0?1:0,un=ln.dist(Bt);if(Yt+un>32768&&(Yt=0),xe){Ft=xn.sub(Bt)._perp()._unit();let yr=LG(ln,Bt,xn,RG(At,Ft),xe);isNaN(yr)&&(yr=0);const nr=Bt.sub(ln)._unit();ln=ln.add(nr.mult(Tt))._round(),Bt=Bt.add(nr.mult(-yr))._round(),Tt=yr,At=Ft}const Xn=Ze.vertexLength,_r=We.length>4&&BG(ln,Bt,xn);let ei=NG(Yt,tn,Gt);if(Dx(this.layoutVertexArray,ln.x,ln.y,En,Ar,0,0,ei),Dx(this.layoutVertexArray,ln.x,ln.y,En,Ar,0,1,ei),Yt+=un,ei=NG(Yt,_r,!Gt),tn=_r,Dx(this.layoutVertexArray,Bt.x,Bt.y,En,Ar,0,0,ei),Dx(this.layoutVertexArray,Bt.x,Bt.y,En,Ar,0,1,ei),Ze.vertexLength+=4,this.indexArray.emplaceBack(Xn+0,Xn+1,Xn+2),this.indexArray.emplaceBack(Xn+1,Xn+3,Xn+2),Ze.primitiveLength+=2,xe){const yr=Ne+(jt===1?We.length-2:jt-2),nr=jt===1?Ne:yr+1;if(this.indexArray.emplaceBack(Xn+1,yr,Xn+3),this.indexArray.emplaceBack(yr,nr,Xn+3),Ze.primitiveLength+=2,bt===void 0&&(bt=Xn),!DG(xn,We[jt],$e)){const Hi=jt===We.length-1?bt:Ze.vertexLength;this.indexArray.emplaceBack(Xn+2,Xn+3,Hi),this.indexArray.emplaceBack(Xn+3,Hi+1,Hi),this.indexArray.emplaceBack(Xn+3,nr,Hi+1),Ze.primitiveLength+=3}Gt=!Gt}if(W){const yr=this.layoutVertexExtArray,nr=U.projectTilePoint(ln.x,ln.y,A),Hi=U.projectTilePoint(Bt.x,Bt.y,A),wr=U.upVector(A,ln.x,ln.y),Er=U.upVector(A,Bt.x,Bt.y);Bx(yr,nr,wr),Bx(yr,nr,wr),Bx(yr,Hi,Er),Bx(yr,Hi,Er)}}ee&&(Ne+=We.length-1)}}if(K&&K.polyCount.length>0){if(K.borders){K.vertexArrayOffset=this.centroidVertexArray.length;const Be=K.borders,$e=this.featuresOnBorder.push(K)-1;for(let Ne=0;Ne<4;Ne++)Be[Ne][0]!==Number.MAX_VALUE&&this.borders[Ne].push($e)}this.encodeCentroid(K.borders?void 0:K.centroid(),K)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,b,C,A)}sortBorders(){for(let l=0;l<4;l++)this.borders[l].sort((f,p)=>this.featuresOnBorder[f].borders[l][0]-this.featuresOnBorder[p].borders[l][0])}encodeCentroid(l,f,p=!0){let A,b;if(l)if(l.y!==0){const M=f.span()._mult(this.tileToMeter);A=(Math.max(l.x,1)<<3)+Math.min(7,Math.round(M.x/10)),b=(Math.max(l.y,1)<<3)+Math.min(7,Math.round(M.y/10))}else A=Math.ceil(7*(l.x+450)),b=0;else A=0,b=+p;let C=p?this.centroidVertexArray.length:f.vertexArrayOffset;for(const M of f.polyCount){p&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*M.edges+M.top);for(let N=0;N<M.top;N++)this.centroidVertexArray.emplace(C++,A,b);for(let N=0;N<2*M.edges;N++)this.centroidVertexArray.emplace(C++,0,b),this.centroidVertexArray.emplace(C++,A,b)}}}function RG(c,l){const f=c.add(l)._unit();return c.x*f.x+c.y*f.y}function pde(c,l,f,p){const A=l.sub(c)._perp()._unit(),b=f.sub(l)._perp()._unit();return LG(c,l,f,RG(A,b),p)}function LG(c,l,f,p,A){const b=Math.sqrt(1-p*p);return Math.min(c.dist(l)/3,l.dist(f)/3,A*b/p)}function DG(c,l,f){return c.x<f[0].x&&l.x<f[0].x||c.x>f[1].x&&l.x>f[1].x||c.y<f[0].y&&l.y<f[0].y||c.y>f[1].y&&l.y>f[1].y}function BG(c,l,f){if(c.x<0||c.x>=Kn||l.x<0||l.x>=Kn||f.x<0||f.x>=Kn)return!1;const p=f.sub(l),A=p.perp(),b=c.sub(l);return(p.x*b.x+p.y*b.y)/Math.sqrt((p.x*p.x+p.y*p.y)*(b.x*b.x+b.y*b.y))>-.866&&A.x*b.x+A.y*b.y<0}function NG(c,l,f){const p=l?2|c:-3&c;return f?1|p:-2&p}function FG(){const c=Math.PI/32,l=Math.tan(c),f=Ix;return f*Math.sqrt(1+2*l*l)-f}function kG(c,l,f){const p=1<<f.z,A=Ju(f.x/p),b=Ju((f.x+1)/p),C=ya(f.y/p),M=ya((f.y+1)/p);return function(N,U,W,K,ee=0,oe){const le=[];if(!N.length||!W||!K)return le;const de=(We,bt)=>{for(const At of We)le.push({polygon:At,bounds:bt})},xe=Math.ceil(Math.log2(W)),Be=Math.ceil(Math.log2(K)),$e=xe-Be,Ne=[];for(let We=0;We<Math.abs($e);We++)Ne.push($e>0?0:1);for(let We=0;We<Math.min(xe,Be);We++)Ne.push(0),Ne.push(1);let je=N;if(je=V2(je,U[0].y-ee,U[1].y+ee,1),je=V2(je,U[0].x-ee,U[1].x+ee,0),!je.length)return le;const Ze=[];for(Ne.length?Ze.push({polygons:je,bounds:U,depth:0}):de(je,U);Ze.length;){const We=Ze.pop(),bt=We.depth,At=Ne[bt],Ft=We.bounds[0],tn=We.bounds[1],Tt=At===0?Ft.x:Ft.y,Gt=At===0?tn.x:tn.y,jt=oe?oe(At,Tt,Gt):.5*(Tt+Gt),Yt=V2(We.polygons,Tt-ee,jt+ee,At),ln=V2(We.polygons,jt-ee,Gt+ee,At);if(Yt.length){const Bt=[Ft,new ie(At===0?jt:tn.x,At===1?jt:tn.y)];Ne.length>bt+1?Ze.push({polygons:Yt,bounds:Bt,depth:bt+1}):de(Yt,Bt)}if(ln.length){const Bt=[new ie(At===0?jt:Ft.x,At===1?jt:Ft.y),tn];Ne.length>bt+1?Ze.push({polygons:ln,bounds:Bt,depth:bt+1}):de(ln,Bt)}}return le}(c,l,Math.ceil((b-A)/11.25),Math.ceil((C-M)/11.25),1,(N,U,W)=>{if(N===0)return .5*(U+W);{const K=ya((f.y+U/Kn)/p);return(sd(.5*(ya((f.y+W/Kn)/p)+K))*p-f.y)*Kn}})}Mt(Nx,"FillExtrusionBucket",{omit:["layers","features"]}),Mt(OG,"PartMetadata");const gde=new ke({"fill-extrusion-edge-radius":new he(pt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var mde={paint:new ke({"fill-extrusion-opacity":new he(pt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Se(pt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new he(pt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new he(pt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Se(pt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Se(pt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Se(pt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new he(pt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new he(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new he(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new he(pt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:gde};function zG(c,l,f){var p=2*Math.PI*6378137/256/Math.pow(2,f);return[c*p-2*Math.PI*6378137/2,l*p-2*Math.PI*6378137/2]}class $2{constructor(l,f,p){this.z=l,this.x=f,this.y=p,this.key=Fx(0,l,l,f,p)}equals(l){return this.z===l.z&&this.x===l.x&&this.y===l.y}url(l,f){const p=function(b,C,M){var N=zG(256*b,256*(C=Math.pow(2,M)-C-1),M),U=zG(256*(b+1),256*(C+1),M);return N[0]+","+N[1]+","+U[0]+","+U[1]}(this.x,this.y,this.z),A=function(b,C,M){let N,U="";for(let W=b;W>0;W--)N=1<<W-1,U+=(C&N?1:0)+(M&N?2:0);return U}(this.z,this.x,this.y);return l[(this.x+this.y)%l.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(f==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",A).replace("{bbox-epsg-3857}",p)}toString(){return`${this.z}/${this.x}/${this.y}`}}class UG{constructor(l,f){this.wrap=l,this.canonical=f,this.key=Fx(l,f.z,f.z,f.x,f.y)}}class fl{constructor(l,f,p,A,b){this.overscaledZ=l,this.wrap=f,this.canonical=new $2(p,+A,+b),this.key=f===0&&l===p?this.canonical.key:Fx(f,l,p,A,b)}equals(l){return this.overscaledZ===l.overscaledZ&&this.wrap===l.wrap&&this.canonical.equals(l.canonical)}scaledTo(l){const f=this.canonical.z-l;return l>this.canonical.z?new fl(l,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new fl(l,this.wrap,l,this.canonical.x>>f,this.canonical.y>>f)}calculateScaledKey(l,f=!0){if(this.overscaledZ===l&&f)return this.key;if(l>this.canonical.z)return Fx(this.wrap*+f,l,this.canonical.z,this.canonical.x,this.canonical.y);{const p=this.canonical.z-l;return Fx(this.wrap*+f,l,l,this.canonical.x>>p,this.canonical.y>>p)}}isChildOf(l){if(l.wrap!==this.wrap)return!1;const f=this.canonical.z-l.canonical.z;return l.overscaledZ===0||l.overscaledZ<this.overscaledZ&&l.canonical.x===this.canonical.x>>f&&l.canonical.y===this.canonical.y>>f}children(l){if(this.overscaledZ>=l)return[new fl(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const f=this.canonical.z+1,p=2*this.canonical.x,A=2*this.canonical.y;return[new fl(f,this.wrap,f,p,A),new fl(f,this.wrap,f,p+1,A),new fl(f,this.wrap,f,p,A+1),new fl(f,this.wrap,f,p+1,A+1)]}isLessThan(l){return this.wrap<l.wrap||!(this.wrap>l.wrap)&&(this.overscaledZ<l.overscaledZ||!(this.overscaledZ>l.overscaledZ)&&(this.canonical.x<l.canonical.x||!(this.canonical.x>l.canonical.x)&&this.canonical.y<l.canonical.y))}wrapped(){return new fl(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(l){return new fl(this.overscaledZ,l,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new UG(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Fx(c,l,f,p,A){const b=1<<Math.min(f,22);let C=b*(A%b)+p%b;return c&&f<22&&(C+=b*b*((c<0?-2*c-1:2*c)%(1<<2*(22-f)))),16*(32*C+f)+(l-f)}Mt($2,"CanonicalTileID"),Mt(fl,"OverscaledTileID",{omit:["projMatrix"]});class ty extends ie{constructor(l,f,p){super(l,f),this.z=p}}function kx(c,l){return c.x*l.x+c.y*l.y}function GG(c,l){if(c.length===1){let f=0;const p=l[f++];let A;for(;!A||p.equals(A);)if(A=l[f++],!A)return 1/0;for(;f<l.length;f++){const b=l[f],C=c[0],M=A.sub(p),N=b.sub(p),U=C.sub(p),W=kx(M,M),K=kx(M,N),ee=kx(N,N),oe=kx(U,M),le=kx(U,N),de=W*ee-K*K,xe=(ee*oe-K*le)/de,Be=(W*le-K*oe)/de,$e=p.z*(1-xe-Be)+A.z*xe+b.z*Be;if(isFinite($e))return $e}return 1/0}{let f=1/0;for(const p of l)f=Math.min(f,p.z);return f}}function jG(c,l,f,p,A,b,C,M){const N=C*A.getElevationAt(c,l,!0,!0),U=b[0]!==0,W=U?b[1]===0?C*(b[0]/7-450):C*function(K,ee,oe){const le=Math.floor(ee[0]/8),de=Math.floor(ee[1]/8),xe=10*(ee[0]-8*le),Be=10*(ee[1]-8*de),$e=K.getElevationAt(le,de,!0,!0),Ne=K.getMeterToDEM(oe),je=Math.floor(.5*(xe*Ne-1)),Ze=Math.floor(.5*(Be*Ne-1)),We=K.tileCoordToPixel(le,de),bt=2*je+1,At=2*Ze+1,Ft=function(ln,Bt,xn,zn,En){return[ln.getElevationAtPixel(Bt,xn,!0),ln.getElevationAtPixel(Bt+En,xn,!0),ln.getElevationAtPixel(Bt,xn+En,!0),ln.getElevationAtPixel(Bt+zn,xn+En,!0)]}(K,We.x-je,We.y-Ze,bt,At),tn=Math.abs(Ft[0]-Ft[1]),Tt=Math.abs(Ft[2]-Ft[3]),Gt=Math.abs(Ft[0]-Ft[2])+Math.abs(Ft[1]-Ft[3]),jt=Math.min(.25,.5*Ne*(tn+Tt)/bt),Yt=Math.min(.25,.5*Ne*Gt/At);return $e+Math.max(jt*xe,Yt*Be)}(A,b,M):N;return{base:N+(f===0)?-1:f,top:U?Math.max(W+p,N+f+2):N+p}}const Ade=st([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:_de}=Ade,yde=st([{name:"a_packed",components:4,type:"Float32"}]),{members:vde}=yde,xde=j2.types,bde=Math.cos(Math.PI/180*37.5);class H2{constructor(l){this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(f=>f.id),this.index=l.index,this.projection=l.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(f=>{this.gradients[f.id]={}}),this.layoutVertexArray=new St,this.layoutVertexArray2=new Kt,this.indexArray=new Vn,this.programConfigurations=new XA(l.layers,l.zoom),this.segments=new Wo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(f=>f.isStateDependent()).map(f=>f.id)}populate(l,f,p,A){this.hasPattern=P3("line",this.layers,f);const b=this.layers[0].layout.get("line-sort-key"),C=[];for(const{feature:W,id:K,index:ee,sourceLayerIndex:oe}of l){const le=this.layers[0]._featureFilter.needGeometry,de=e0(W,le);if(!this.layers[0]._featureFilter.filter(new Q(this.zoom),de,p))continue;const xe=b?b.evaluate(de,{},p):void 0,Be={id:K,properties:W.properties,type:W.type,sourceLayerIndex:oe,index:ee,geometry:le?de.geometry:Dp(W,p,A),patterns:{},sortKey:xe};C.push(Be)}b&&C.sort((W,K)=>W.sortKey-K.sortKey);const{lineAtlas:M,featureIndex:N}=f,U=this.addConstantDashes(M);for(const W of C){const{geometry:K,index:ee,sourceLayerIndex:oe}=W;if(U&&this.addFeatureDashes(W,M),this.hasPattern){const le=I3("line",this.layers,W,this.zoom,f);this.patternFeatures.push(le)}else this.addFeature(W,K,ee,p,M.positions,f.availableImages);N.insert(l[ee].feature,K,ee,oe,this.index)}}addConstantDashes(l){let f=!1;for(const p of this.layers){const A=p.paint.get("line-dasharray").value,b=p.layout.get("line-cap").value;if(A.kind!=="constant"||b.kind!=="constant")f=!0;else{const C=b.value,M=A.value;if(!M)continue;l.addDash(M,C)}}return f}addFeatureDashes(l,f){const p=this.zoom;for(const A of this.layers){const b=A.paint.get("line-dasharray").value,C=A.layout.get("line-cap").value;if(b.kind==="constant"&&C.kind==="constant")continue;let M,N;if(b.kind==="constant"){if(M=b.value,!M)continue}else M=b.evaluate({zoom:p},l);N=C.kind==="constant"?C.value:C.evaluate({zoom:p},l),f.addDash(M,N),l.patterns[A.id]=f.getKey(M,N)}}update(l,f,p,A){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(l,f,this.stateDependentLayers,p,A)}addFeatures(l,f,p,A,b){for(const C of this.patternFeatures)this.addFeature(C,C.geometry,C.index,f,p,A)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(l){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=l.createVertexBuffer(this.layoutVertexArray2,vde)),this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,_de),this.indexBuffer=l.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(l),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(l){if(l.properties&&l.properties.hasOwnProperty("mapbox_clip_start")&&l.properties.hasOwnProperty("mapbox_clip_end"))return{start:+l.properties.mapbox_clip_start,end:+l.properties.mapbox_clip_end}}addFeature(l,f,p,A,b,C){const M=this.layers[0].layout,N=M.get("line-join").evaluate(l,{}),U=M.get("line-cap").evaluate(l,{}),W=M.get("line-miter-limit"),K=M.get("line-round-limit");this.lineClips=this.lineFeatureClips(l);for(const ee of f)this.addLine(ee,l,N,U,W,K);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,l,p,b,C,A)}addLine(l,f,p,A,b,C){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Be=0;Be<l.length-1;Be++)this.totalDistance+=l[Be].dist(l[Be+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const M=xde[f.type]==="Polygon";let N=l.length;for(;N>=2&&l[N-1].equals(l[N-2]);)N--;let U=0;for(;U<N-1&&l[U].equals(l[U+1]);)U++;if(N<(M?3:2))return;p==="bevel"&&(b=1.05);const W=this.overscaling<=16?15*Kn/(512*this.overscaling):0,K=this.segments.prepareSegment(10*N,this.layoutVertexArray,this.indexArray);let ee,oe,le,de,xe;this.e1=this.e2=-1,M&&(ee=l[N-2],xe=l[U].sub(ee)._unit()._perp());for(let Be=U;Be<N;Be++){if(le=Be===N-1?M?l[U+1]:void 0:l[Be+1],le&&l[Be].equals(le))continue;xe&&(de=xe),ee&&(oe=ee),ee=l[Be],xe=le?le.sub(ee)._unit()._perp():de,de=de||xe;let $e=de.add(xe);$e.x===0&&$e.y===0||$e._unit();const Ne=de.x*xe.x+de.y*xe.y,je=$e.x*xe.x+$e.y*xe.y,Ze=je!==0?1/je:1/0,We=2*Math.sqrt(2-2*je),bt=je<bde&&oe&&le,At=de.x*xe.y-de.y*xe.x>0;if(bt&&Be>U){const Tt=ee.dist(oe);if(Tt>2*W){const Gt=ee.sub(ee.sub(oe)._mult(W/Tt)._round());this.updateDistance(oe,Gt),this.addCurrentVertex(Gt,de,0,0,K),oe=Gt}}const Ft=oe&&le;let tn=Ft?p:M?"butt":A;if(Ft&&tn==="round"&&(Ze<C?tn="miter":Ze<=2&&(tn="fakeround")),tn==="miter"&&Ze>b&&(tn="bevel"),tn==="bevel"&&(Ze>2&&(tn="flipbevel"),Ze<b&&(tn="miter")),oe&&this.updateDistance(oe,ee),tn==="miter")$e._mult(Ze),this.addCurrentVertex(ee,$e,0,0,K);else if(tn==="flipbevel"){if(Ze>100)$e=xe.mult(-1);else{const Tt=Ze*de.add(xe).mag()/de.sub(xe).mag();$e._perp()._mult(Tt*(At?-1:1))}this.addCurrentVertex(ee,$e,0,0,K),this.addCurrentVertex(ee,$e.mult(-1),0,0,K)}else if(tn==="bevel"||tn==="fakeround"){const Tt=-Math.sqrt(Ze*Ze-1),Gt=At?Tt:0,jt=At?0:Tt;if(oe&&this.addCurrentVertex(ee,de,Gt,jt,K),tn==="fakeround"){const Yt=Math.round(180*We/Math.PI/20);for(let ln=1;ln<Yt;ln++){let Bt=ln/Yt;if(Bt!==.5){const zn=Bt-.5;Bt+=Bt*zn*(Bt-1)*((1.0904+Ne*(Ne*(3.55645-1.43519*Ne)-3.2452))*zn*zn+(.848013+Ne*(.215638*Ne-1.06021)))}const xn=xe.sub(de)._mult(Bt)._add(de)._unit()._mult(At?-1:1);this.addHalfVertex(ee,xn.x,xn.y,!1,At,0,K)}}le&&this.addCurrentVertex(ee,xe,-Gt,-jt,K)}else if(tn==="butt")this.addCurrentVertex(ee,$e,0,0,K);else if(tn==="square"){const Tt=oe?1:-1;oe||this.addCurrentVertex(ee,$e,Tt,Tt,K),this.addCurrentVertex(ee,$e,0,0,K),oe&&this.addCurrentVertex(ee,$e,Tt,Tt,K)}else tn==="round"&&(oe&&(this.addCurrentVertex(ee,de,0,0,K),this.addCurrentVertex(ee,de,1,1,K,!0)),le&&(this.addCurrentVertex(ee,xe,-1,-1,K,!0),this.addCurrentVertex(ee,xe,0,0,K)));if(bt&&Be<N-1){const Tt=ee.dist(le);if(Tt>2*W){const Gt=ee.add(le.sub(ee)._mult(W/Tt)._round());this.updateDistance(ee,Gt),this.addCurrentVertex(Gt,xe,0,0,K),ee=Gt}}}}addCurrentVertex(l,f,p,A,b,C=!1){const M=f.y*A-f.x,N=-f.y-f.x*A;this.addHalfVertex(l,f.x+f.y*p,f.y-f.x*p,C,!1,p,b),this.addHalfVertex(l,M,N,C,!0,-A,b)}addHalfVertex({x:l,y:f},p,A,b,C,M,N){this.layoutVertexArray.emplaceBack((l<<1)+(b?1:0),(f<<1)+(C?1:0),Math.round(63*p)+128,Math.round(63*A)+128,1+(M===0?0:M<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const U=N.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,U),N.primitiveLength++),C?this.e2=U:this.e1=U}updateScaledDistance(){if(this.lineClips){const l=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=l*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(l,f){this.distance+=l.dist(f),this.updateScaledDistance()}}Mt(H2,"LineBucket",{omit:["layers","patternFeatures"]});const wde=new ke({"line-cap":new Se(pt.layout_line["line-cap"]),"line-join":new Se(pt.layout_line["line-join"]),"line-miter-limit":new he(pt.layout_line["line-miter-limit"]),"line-round-limit":new he(pt.layout_line["line-round-limit"]),"line-sort-key":new Se(pt.layout_line["line-sort-key"])});var VG={paint:new ke({"line-opacity":new Se(pt.paint_line["line-opacity"]),"line-color":new Se(pt.paint_line["line-color"]),"line-translate":new he(pt.paint_line["line-translate"]),"line-translate-anchor":new he(pt.paint_line["line-translate-anchor"]),"line-width":new Se(pt.paint_line["line-width"]),"line-gap-width":new Se(pt.paint_line["line-gap-width"]),"line-offset":new Se(pt.paint_line["line-offset"]),"line-blur":new Se(pt.paint_line["line-blur"]),"line-dasharray":new Se(pt.paint_line["line-dasharray"]),"line-pattern":new Se(pt.paint_line["line-pattern"]),"line-gradient":new Fe(pt.paint_line["line-gradient"]),"line-trim-offset":new he(pt.paint_line["line-trim-offset"])}),layout:wde};const $G=new class extends Se{possiblyEvaluate(c,l){return l=new Q(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,transition:l.transition}),super.possiblyEvaluate(c,l)}evaluate(c,l,f,p){return l=Ct({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(c,l,f,p)}}(VG.paint.properties["line-width"].specification);function HG(c,l){return l>0?l+2*c:c}$G.useIntegerZoom=!0;const Ede=st([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Sde=st([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Tde=st([{name:"a_projected_pos",components:4,type:"Float32"}],4);st([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Cde=st([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Pde=st([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);st([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const WG=st([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Ide=st([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);st([{name:"triangle",components:3,type:"Uint16"}]),st([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),st([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),st([{type:"Float32",name:"offsetX"}]),st([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Qs=24;const Jf=128;function O3(c,l){const{expression:f}=l;if(f.kind==="constant")return{kind:"constant",layoutSize:f.evaluate(new Q(c+1))};if(f.kind==="source")return{kind:"source"};{const{zoomStops:p,interpolationType:A}=f;let b=0;for(;b<p.length&&p[b]<=c;)b++;b=Math.max(0,b-1);let C=b;for(;C<p.length&&p[C]<c+1;)C++;C=Math.min(p.length-1,C);const M=p[b],N=p[C];return f.kind==="composite"?{kind:"composite",minZoom:M,maxZoom:N,interpolationType:A}:{kind:"camera",minZoom:M,maxZoom:N,minSize:f.evaluate(new Q(M)),maxSize:f.evaluate(new Q(N)),interpolationType:A}}}function W2(c,{uSize:l,uSizeT:f},{lowerSize:p,upperSize:A}){return c.kind==="source"?p/Jf:c.kind==="composite"?jr(p/Jf,A/Jf,f):l}function ny(c,l){let f=0,p=0;if(c.kind==="constant")p=c.layoutSize;else if(c.kind!=="source"){const{interpolationType:A,minZoom:b,maxZoom:C}=c,M=A?be(ws.interpolationFactor(A,l,b,C),0,1):0;c.kind==="camera"?p=jr(c.minSize,c.maxSize,M):f=M}return{uSizeT:f,uSize:p}}var Mde=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Jf,evaluateSizeForFeature:W2,evaluateSizeForZoom:ny,getSizeData:O3});function Ode(c,l,f){return c.sections.forEach(p=>{p.text=function(A,b,C){const M=b.layout.get("text-transform").evaluate(C,{});return M==="uppercase"?A=A.toLocaleUpperCase():M==="lowercase"&&(A=A.toLocaleLowerCase()),H.applyArabicShaping&&(A=H.applyArabicShaping(A)),A}(p.text,l,f)}),c}const zx={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function Rde(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}function Lde(c){return c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""||c===""}var qG=Li,XG=function(c,l,f,p,A){var b,C,M=8*A-p-1,N=(1<<M)-1,U=N>>1,W=-7,K=f?A-1:0,ee=f?-1:1,oe=c[l+K];for(K+=ee,b=oe&(1<<-W)-1,oe>>=-W,W+=M;W>0;b=256*b+c[l+K],K+=ee,W-=8);for(C=b&(1<<-W)-1,b>>=-W,W+=p;W>0;C=256*C+c[l+K],K+=ee,W-=8);if(b===0)b=1-U;else{if(b===N)return C?NaN:1/0*(oe?-1:1);C+=Math.pow(2,p),b-=U}return(oe?-1:1)*C*Math.pow(2,b-p)},ZG=function(c,l,f,p,A,b){var C,M,N,U=8*b-A-1,W=(1<<U)-1,K=W>>1,ee=A===23?Math.pow(2,-24)-Math.pow(2,-77):0,oe=p?0:b-1,le=p?1:-1,de=l<0||l===0&&1/l<0?1:0;for(l=Math.abs(l),isNaN(l)||l===1/0?(M=isNaN(l)?1:0,C=W):(C=Math.floor(Math.log(l)/Math.LN2),l*(N=Math.pow(2,-C))<1&&(C--,N*=2),(l+=C+K>=1?ee/N:ee*Math.pow(2,1-K))*N>=2&&(C++,N/=2),C+K>=W?(M=0,C=W):C+K>=1?(M=(l*N-1)*Math.pow(2,A),C+=K):(M=l*Math.pow(2,K-1)*Math.pow(2,A),C=0));A>=8;c[f+oe]=255&M,oe+=le,M/=256,A-=8);for(C=C<<A|M,U+=A;U>0;c[f+oe]=255&C,oe+=le,C/=256,U-=8);c[f+oe-le]|=128*de};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Li(c){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(c)?c:new Uint8Array(c||0),this.pos=0,this.type=0,this.length=this.buf.length}Li.Varint=0,Li.Fixed64=1,Li.Bytes=2,Li.Fixed32=5;var R3=4294967296,YG=1/R3,QG=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Np(c){return c.type===Li.Bytes?c.readVarint()+c.pos:c.pos+1}function ry(c,l,f){return f?4294967296*l+(c>>>0):4294967296*(l>>>0)+(c>>>0)}function KG(c,l,f){var p=l<=16383?1:l<=2097151?2:l<=268435455?3:Math.floor(Math.log(l)/(7*Math.LN2));f.realloc(p);for(var A=f.pos-1;A>=c;A--)f.buf[A+p]=f.buf[A]}function Dde(c,l){for(var f=0;f<c.length;f++)l.writeVarint(c[f])}function Bde(c,l){for(var f=0;f<c.length;f++)l.writeSVarint(c[f])}function Nde(c,l){for(var f=0;f<c.length;f++)l.writeFloat(c[f])}function Fde(c,l){for(var f=0;f<c.length;f++)l.writeDouble(c[f])}function kde(c,l){for(var f=0;f<c.length;f++)l.writeBoolean(c[f])}function zde(c,l){for(var f=0;f<c.length;f++)l.writeFixed32(c[f])}function Ude(c,l){for(var f=0;f<c.length;f++)l.writeSFixed32(c[f])}function Gde(c,l){for(var f=0;f<c.length;f++)l.writeFixed64(c[f])}function jde(c,l){for(var f=0;f<c.length;f++)l.writeSFixed64(c[f])}function q2(c,l){return(c[l]|c[l+1]<<8|c[l+2]<<16)+16777216*c[l+3]}function iy(c,l,f){c[f]=l,c[f+1]=l>>>8,c[f+2]=l>>>16,c[f+3]=l>>>24}function JG(c,l){return(c[l]|c[l+1]<<8|c[l+2]<<16)+(c[l+3]<<24)}Li.prototype={destroy:function(){this.buf=null},readFields:function(c,l,f){for(f=f||this.length;this.pos<f;){var p=this.readVarint(),A=p>>3,b=this.pos;this.type=7&p,c(A,l,this),this.pos===b&&this.skip(p)}return l},readMessage:function(c,l){return this.readFields(c,l,this.readVarint()+this.pos)},readFixed32:function(){var c=q2(this.buf,this.pos);return this.pos+=4,c},readSFixed32:function(){var c=JG(this.buf,this.pos);return this.pos+=4,c},readFixed64:function(){var c=q2(this.buf,this.pos)+q2(this.buf,this.pos+4)*R3;return this.pos+=8,c},readSFixed64:function(){var c=q2(this.buf,this.pos)+JG(this.buf,this.pos+4)*R3;return this.pos+=8,c},readFloat:function(){var c=XG(this.buf,this.pos,!0,23,4);return this.pos+=4,c},readDouble:function(){var c=XG(this.buf,this.pos,!0,52,8);return this.pos+=8,c},readVarint:function(c){var l,f,p=this.buf;return l=127&(f=p[this.pos++]),f<128?l:(l|=(127&(f=p[this.pos++]))<<7,f<128?l:(l|=(127&(f=p[this.pos++]))<<14,f<128?l:(l|=(127&(f=p[this.pos++]))<<21,f<128?l:function(A,b,C){var M,N,U=C.buf;if(M=(112&(N=U[C.pos++]))>>4,N<128||(M|=(127&(N=U[C.pos++]))<<3,N<128)||(M|=(127&(N=U[C.pos++]))<<10,N<128)||(M|=(127&(N=U[C.pos++]))<<17,N<128)||(M|=(127&(N=U[C.pos++]))<<24,N<128)||(M|=(1&(N=U[C.pos++]))<<31,N<128))return ry(A,M,b);throw new Error("Expected varint not more than 10 bytes")}(l|=(15&(f=p[this.pos]))<<28,c,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var c=this.readVarint();return c%2==1?(c+1)/-2:c/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var c=this.readVarint()+this.pos,l=this.pos;return this.pos=c,c-l>=12&&QG?function(f,p,A){return QG.decode(f.subarray(p,A))}(this.buf,l,c):function(f,p,A){for(var b="",C=p;C<A;){var M,N,U,W=f[C],K=null,ee=W>239?4:W>223?3:W>191?2:1;if(C+ee>A)break;ee===1?W<128&&(K=W):ee===2?(192&(M=f[C+1]))==128&&(K=(31&W)<<6|63&M)<=127&&(K=null):ee===3?(N=f[C+2],(192&(M=f[C+1]))==128&&(192&N)==128&&((K=(15&W)<<12|(63&M)<<6|63&N)<=2047||K>=55296&&K<=57343)&&(K=null)):ee===4&&(N=f[C+2],U=f[C+3],(192&(M=f[C+1]))==128&&(192&N)==128&&(192&U)==128&&((K=(15&W)<<18|(63&M)<<12|(63&N)<<6|63&U)<=65535||K>=1114112)&&(K=null)),K===null?(K=65533,ee=1):K>65535&&(K-=65536,b+=String.fromCharCode(K>>>10&1023|55296),K=56320|1023&K),b+=String.fromCharCode(K),C+=ee}return b}(this.buf,l,c)},readBytes:function(){var c=this.readVarint()+this.pos,l=this.buf.subarray(this.pos,c);return this.pos=c,l},readPackedVarint:function(c,l){if(this.type!==Li.Bytes)return c.push(this.readVarint(l));var f=Np(this);for(c=c||[];this.pos<f;)c.push(this.readVarint(l));return c},readPackedSVarint:function(c){if(this.type!==Li.Bytes)return c.push(this.readSVarint());var l=Np(this);for(c=c||[];this.pos<l;)c.push(this.readSVarint());return c},readPackedBoolean:function(c){if(this.type!==Li.Bytes)return c.push(this.readBoolean());var l=Np(this);for(c=c||[];this.pos<l;)c.push(this.readBoolean());return c},readPackedFloat:function(c){if(this.type!==Li.Bytes)return c.push(this.readFloat());var l=Np(this);for(c=c||[];this.pos<l;)c.push(this.readFloat());return c},readPackedDouble:function(c){if(this.type!==Li.Bytes)return c.push(this.readDouble());var l=Np(this);for(c=c||[];this.pos<l;)c.push(this.readDouble());return c},readPackedFixed32:function(c){if(this.type!==Li.Bytes)return c.push(this.readFixed32());var l=Np(this);for(c=c||[];this.pos<l;)c.push(this.readFixed32());return c},readPackedSFixed32:function(c){if(this.type!==Li.Bytes)return c.push(this.readSFixed32());var l=Np(this);for(c=c||[];this.pos<l;)c.push(this.readSFixed32());return c},readPackedFixed64:function(c){if(this.type!==Li.Bytes)return c.push(this.readFixed64());var l=Np(this);for(c=c||[];this.pos<l;)c.push(this.readFixed64());return c},readPackedSFixed64:function(c){if(this.type!==Li.Bytes)return c.push(this.readSFixed64());var l=Np(this);for(c=c||[];this.pos<l;)c.push(this.readSFixed64());return c},skip:function(c){var l=7&c;if(l===Li.Varint)for(;this.buf[this.pos++]>127;);else if(l===Li.Bytes)this.pos=this.readVarint()+this.pos;else if(l===Li.Fixed32)this.pos+=4;else{if(l!==Li.Fixed64)throw new Error("Unimplemented type: "+l);this.pos+=8}},writeTag:function(c,l){this.writeVarint(c<<3|l)},realloc:function(c){for(var l=this.length||16;l<this.pos+c;)l*=2;if(l!==this.length){var f=new Uint8Array(l);f.set(this.buf),this.buf=f,this.length=l}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(c){this.realloc(4),iy(this.buf,c,this.pos),this.pos+=4},writeSFixed32:function(c){this.realloc(4),iy(this.buf,c,this.pos),this.pos+=4},writeFixed64:function(c){this.realloc(8),iy(this.buf,-1&c,this.pos),iy(this.buf,Math.floor(c*YG),this.pos+4),this.pos+=8},writeSFixed64:function(c){this.realloc(8),iy(this.buf,-1&c,this.pos),iy(this.buf,Math.floor(c*YG),this.pos+4),this.pos+=8},writeVarint:function(c){(c=+c||0)>268435455||c<0?function(l,f){var p,A;if(l>=0?(p=l%4294967296|0,A=l/4294967296|0):(A=~(-l/4294967296),4294967295^(p=~(-l%4294967296))?p=p+1|0:(p=0,A=A+1|0)),l>=18446744073709552e3||l<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");f.realloc(10),function(b,C,M){M.buf[M.pos++]=127&b|128,b>>>=7,M.buf[M.pos++]=127&b|128,b>>>=7,M.buf[M.pos++]=127&b|128,b>>>=7,M.buf[M.pos++]=127&b|128,M.buf[M.pos]=127&(b>>>=7)}(p,0,f),function(b,C){var M=(7&b)<<4;C.buf[C.pos++]|=M|((b>>>=3)?128:0),b&&(C.buf[C.pos++]=127&b|((b>>>=7)?128:0),b&&(C.buf[C.pos++]=127&b|((b>>>=7)?128:0),b&&(C.buf[C.pos++]=127&b|((b>>>=7)?128:0),b&&(C.buf[C.pos++]=127&b|((b>>>=7)?128:0),b&&(C.buf[C.pos++]=127&b)))))}(A,f)}(c,this):(this.realloc(4),this.buf[this.pos++]=127&c|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=127&(c>>>=7)|(c>127?128:0),c<=127||(this.buf[this.pos++]=c>>>7&127))))},writeSVarint:function(c){this.writeVarint(c<0?2*-c-1:2*c)},writeBoolean:function(c){this.writeVarint(!!c)},writeString:function(c){c=String(c),this.realloc(4*c.length),this.pos++;var l=this.pos;this.pos=function(p,A,b){for(var C,M,N=0;N<A.length;N++){if((C=A.charCodeAt(N))>55295&&C<57344){if(!M){C>56319||N+1===A.length?(p[b++]=239,p[b++]=191,p[b++]=189):M=C;continue}if(C<56320){p[b++]=239,p[b++]=191,p[b++]=189,M=C;continue}C=M-55296<<10|C-56320|65536,M=null}else M&&(p[b++]=239,p[b++]=191,p[b++]=189,M=null);C<128?p[b++]=C:(C<2048?p[b++]=C>>6|192:(C<65536?p[b++]=C>>12|224:(p[b++]=C>>18|240,p[b++]=C>>12&63|128),p[b++]=C>>6&63|128),p[b++]=63&C|128)}return b}(this.buf,c,this.pos);var f=this.pos-l;f>=128&&KG(l,f,this),this.pos=l-1,this.writeVarint(f),this.pos+=f},writeFloat:function(c){this.realloc(4),ZG(this.buf,c,this.pos,!0,23,4),this.pos+=4},writeDouble:function(c){this.realloc(8),ZG(this.buf,c,this.pos,!0,52,8),this.pos+=8},writeBytes:function(c){var l=c.length;this.writeVarint(l),this.realloc(l);for(var f=0;f<l;f++)this.buf[this.pos++]=c[f]},writeRawMessage:function(c,l){this.pos++;var f=this.pos;c(l,this);var p=this.pos-f;p>=128&&KG(f,p,this),this.pos=f-1,this.writeVarint(p),this.pos+=p},writeMessage:function(c,l,f){this.writeTag(c,Li.Bytes),this.writeRawMessage(l,f)},writePackedVarint:function(c,l){l.length&&this.writeMessage(c,Dde,l)},writePackedSVarint:function(c,l){l.length&&this.writeMessage(c,Bde,l)},writePackedBoolean:function(c,l){l.length&&this.writeMessage(c,kde,l)},writePackedFloat:function(c,l){l.length&&this.writeMessage(c,Nde,l)},writePackedDouble:function(c,l){l.length&&this.writeMessage(c,Fde,l)},writePackedFixed32:function(c,l){l.length&&this.writeMessage(c,zde,l)},writePackedSFixed32:function(c,l){l.length&&this.writeMessage(c,Ude,l)},writePackedFixed64:function(c,l){l.length&&this.writeMessage(c,Gde,l)},writePackedSFixed64:function(c,l){l.length&&this.writeMessage(c,jde,l)},writeBytesField:function(c,l){this.writeTag(c,Li.Bytes),this.writeBytes(l)},writeFixed32Field:function(c,l){this.writeTag(c,Li.Fixed32),this.writeFixed32(l)},writeSFixed32Field:function(c,l){this.writeTag(c,Li.Fixed32),this.writeSFixed32(l)},writeFixed64Field:function(c,l){this.writeTag(c,Li.Fixed64),this.writeFixed64(l)},writeSFixed64Field:function(c,l){this.writeTag(c,Li.Fixed64),this.writeSFixed64(l)},writeVarintField:function(c,l){this.writeTag(c,Li.Varint),this.writeVarint(l)},writeSVarintField:function(c,l){this.writeTag(c,Li.Varint),this.writeSVarint(l)},writeStringField:function(c,l){this.writeTag(c,Li.Bytes),this.writeString(l)},writeFloatField:function(c,l){this.writeTag(c,Li.Fixed32),this.writeFloat(l)},writeDoubleField:function(c,l){this.writeTag(c,Li.Fixed64),this.writeDouble(l)},writeBooleanField:function(c,l){this.writeVarintField(c,!!l)}};var X2=z(qG);const L3=3;function Vde(c,l,f){l.glyphs=[],c===1&&f.readMessage($de,l)}function $de(c,l,f){if(c===3){const{id:p,bitmap:A,width:b,height:C,left:M,top:N,advance:U}=f.readMessage(Hde,{});l.glyphs.push({id:p,bitmap:new Bp({width:b+2*L3,height:C+2*L3},A),metrics:{width:b,height:C,left:M,top:N,advance:U}})}else c===4?l.ascender=f.readSVarint():c===5&&(l.descender=f.readSVarint())}function Hde(c,l,f){c===1?l.id=f.readVarint():c===2?l.bitmap=f.readBytes():c===3?l.width=f.readVarint():c===4?l.height=f.readVarint():c===5?l.left=f.readSVarint():c===6?l.top=f.readSVarint():c===7&&(l.advance=f.readVarint())}const ej=L3;function D3(c){let l=0,f=0;for(const C of c)l+=C.w*C.h,f=Math.max(f,C.w);c.sort((C,M)=>M.h-C.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(l/.95)),f),h:1/0}];let A=0,b=0;for(const C of c)for(let M=p.length-1;M>=0;M--){const N=p[M];if(!(C.w>N.w||C.h>N.h)){if(C.x=N.x,C.y=N.y,b=Math.max(b,C.y+C.h),A=Math.max(A,C.x+C.w),C.w===N.w&&C.h===N.h){const U=p.pop();M<p.length&&(p[M]=U)}else C.h===N.h?(N.x+=C.w,N.w-=C.w):C.w===N.w?(N.y+=C.h,N.h-=C.h):(p.push({x:N.x+C.w,y:N.y,w:N.w-C.w,h:C.h}),N.y+=C.h,N.h-=C.h);break}}return{w:A,h:b,fill:l/(A*b)||0}}const $l=1;class B3{constructor(l,{pixelRatio:f,version:p,stretchX:A,stretchY:b,content:C}){this.paddedRect=l,this.pixelRatio=f,this.stretchX=A,this.stretchY=b,this.content=C,this.version=p}get tl(){return[this.paddedRect.x+$l,this.paddedRect.y+$l]}get br(){return[this.paddedRect.x+this.paddedRect.w-$l,this.paddedRect.y+this.paddedRect.h-$l]}get displaySize(){return[(this.paddedRect.w-2*$l)/this.pixelRatio,(this.paddedRect.h-2*$l)/this.pixelRatio]}}class tj{constructor(l,f){const p={},A={};this.haveRenderCallbacks=[];const b=[];this.addImages(l,p,b),this.addImages(f,A,b);const{w:C,h:M}=D3(b),N=new mu({width:C||1,height:M||1});for(const U in l){const W=l[U],K=p[U].paddedRect;mu.copy(W.data,N,{x:0,y:0},{x:K.x+$l,y:K.y+$l},W.data)}for(const U in f){const W=f[U],K=A[U].paddedRect,ee=K.x+$l,oe=K.y+$l,le=W.data.width,de=W.data.height;mu.copy(W.data,N,{x:0,y:0},{x:ee,y:oe},W.data),mu.copy(W.data,N,{x:0,y:de-1},{x:ee,y:oe-1},{width:le,height:1}),mu.copy(W.data,N,{x:0,y:0},{x:ee,y:oe+de},{width:le,height:1}),mu.copy(W.data,N,{x:le-1,y:0},{x:ee-1,y:oe},{width:1,height:de}),mu.copy(W.data,N,{x:0,y:0},{x:ee+le,y:oe},{width:1,height:de})}this.image=N,this.iconPositions=p,this.patternPositions=A}addImages(l,f,p){for(const A in l){const b=l[A],C={x:0,y:0,w:b.data.width+2*$l,h:b.data.height+2*$l};p.push(C),f[A]=new B3(C,b),b.hasRenderCallback&&this.haveRenderCallbacks.push(A)}}patchUpdatedImages(l,f){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(p=>l.hasImage(p)),l.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const p in l.updatedImages)this.patchUpdatedImage(this.iconPositions[p],l.getImage(p),f),this.patchUpdatedImage(this.patternPositions[p],l.getImage(p),f)}patchUpdatedImage(l,f,p){if(!l||!f||l.version===f.version)return;l.version=f.version;const[A,b]=l.tl;p.update(f.data,void 0,{x:A,y:b})}}Mt(B3,"ImagePosition"),Mt(tj,"ImageAtlas");const ec={horizontal:1,vertical:2,horizontalOnly:3},nj=-17;class Ux{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(l,f){const p=new Ux;return p.scale=l||1,p.fontStack=f,p}static forImage(l){const f=new Ux;return f.imageName=l,f}}class oy{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(l,f){const p=new oy;for(let A=0;A<l.sections.length;A++){const b=l.sections[A];b.image?p.addImageSection(b):p.addTextSection(b,f)}return p}length(){return this.text.length}getSection(l){return this.sections[this.sectionIndex[l]]}getSections(){return this.sections}getSectionIndex(l){return this.sectionIndex[l]}getCharCode(l){return this.text.charCodeAt(l)}verticalizePunctuation(l){this.text=function(f,p){let A="";for(let b=0;b<f.length;b++){const C=f.charCodeAt(b+1)||null,M=f.charCodeAt(b-1)||null;A+=!p&&(C&&w2(C)&&!zx[f[b+1]]||M&&w2(M)&&!zx[f[b-1]])||!zx[f[b]]?f[b]:zx[f[b]]}return A}(this.text,l)}trim(){let l=0;for(let p=0;p<this.text.length&&Z2[this.text.charCodeAt(p)];p++)l++;let f=this.text.length;for(let p=this.text.length-1;p>=0&&p>=l&&Z2[this.text.charCodeAt(p)];p--)f--;this.text=this.text.substring(l,f),this.sectionIndex=this.sectionIndex.slice(l,f)}substring(l,f){const p=new oy;return p.text=this.text.substring(l,f),p.sectionIndex=this.sectionIndex.slice(l,f),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((l,f)=>Math.max(l,this.sections[f].scale),0)}addTextSection(l,f){this.text+=l.text,this.sections.push(Ux.forText(l.scale,l.fontStack||f));const p=this.sections.length-1;for(let A=0;A<l.text.length;++A)this.sectionIndex.push(p)}addImageSection(l){const f=l.image?l.image.name:"";if(f.length===0)return void $t("Can't add FormattedSection with an empty image.");const p=this.getNextImageSectionCharCode();p?(this.text+=String.fromCharCode(p),this.sections.push(Ux.forImage(f)),this.sectionIndex.push(this.sections.length-1)):$t("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function N3(c,l,f,p,A,b,C,M,N,U,W,K,ee,oe,le){const de=oy.fromFeature(c,A);K===ec.vertical&&de.verticalizePunctuation(ee);let xe=[];const Be=function(We,bt,At,Ft,tn,Tt){if(!We)return[];const Gt=[],jt=function(xn,zn,En,Ar,un,Xn){let _r=0;for(let ei=0;ei<xn.length();ei++){const yr=xn.getSection(ei);_r+=rj(xn.getCharCode(ei),yr,Ar,un,zn,Xn)}return _r/Math.max(1,Math.ceil(_r/En))}(We,bt,At,Ft,tn,Tt),Yt=We.text.indexOf("")>=0;let ln=0;for(let xn=0;xn<We.length();xn++){const zn=We.getSection(xn),En=We.getCharCode(xn);if(Z2[En]||(ln+=rj(En,zn,Ft,tn,bt,Tt)),xn<We.length()-1){const Ar=!((Bt=En)<11904||!(qt["Bopomofo Extended"](Bt)||qt.Bopomofo(Bt)||qt["CJK Compatibility Forms"](Bt)||qt["CJK Compatibility Ideographs"](Bt)||qt["CJK Compatibility"](Bt)||qt["CJK Radicals Supplement"](Bt)||qt["CJK Strokes"](Bt)||qt["CJK Symbols and Punctuation"](Bt)||qt["CJK Unified Ideographs Extension A"](Bt)||qt["CJK Unified Ideographs"](Bt)||qt["Enclosed CJK Letters and Months"](Bt)||qt["Halfwidth and Fullwidth Forms"](Bt)||qt.Hiragana(Bt)||qt["Ideographic Description Characters"](Bt)||qt["Kangxi Radicals"](Bt)||qt["Katakana Phonetic Extensions"](Bt)||qt.Katakana(Bt)||qt["Vertical Forms"](Bt)||qt["Yi Radicals"](Bt)||qt["Yi Syllables"](Bt)));(Wde[En]||Ar||zn.imageName)&&Gt.push(oj(xn+1,ln,jt,Gt,qde(En,We.getCharCode(xn+1),Ar&&Yt),!1))}}var Bt;return sj(oj(We.length(),ln,jt,Gt,0,!0))}(de,U,b,l,p,oe),{processBidirectionalText:$e,processStyledBidirectionalText:Ne}=H;if($e&&de.sections.length===1){const We=$e(de.toString(),Be);for(const bt of We){const At=new oy;At.text=bt,At.sections=de.sections;for(let Ft=0;Ft<bt.length;Ft++)At.sectionIndex.push(0);xe.push(At)}}else if(Ne){const We=Ne(de.text,de.sectionIndex,Be);for(const bt of We){const At=new oy;At.text=bt[0],At.sectionIndex=bt[1],At.sections=de.sections,xe.push(At)}}else xe=function(We,bt){const At=[],Ft=We.text;let tn=0;for(const Tt of bt)At.push(We.substring(tn,Tt)),tn=Tt;return tn<Ft.length&&At.push(We.substring(tn,Ft.length)),At}(de,Be);const je=[],Ze={positionedLines:je,text:de.toString(),top:W[1],bottom:W[1],left:W[0],right:W[0],writingMode:K,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(We,bt,At,Ft,tn,Tt,Gt,jt,Yt,ln,Bt,xn){let zn=0,En=0,Ar=0;const un=jt==="right"?1:jt==="left"?0:.5;let Xn=!1;for(const wr of tn){const Er=wr.getSections();for(const Ci of Er){if(Ci.imageName)continue;const Di=bt[Ci.fontStack];if(Di&&(Xn=Di.ascender!==void 0&&Di.descender!==void 0,!Xn))break}if(!Xn)break}let _r=0;for(const wr of tn){wr.trim();const Er=wr.getMaxScale(),Ci=(Er-1)*Qs,Di={positionedGlyphs:[],lineOffset:0};We.positionedLines[_r]=Di;const Bi=Di.positionedGlyphs;let Pi=0;if(!wr.length()){En+=Tt,++_r;continue}let uo=0,To=0;for(let Ii=0;Ii<wr.length();Ii++){const ds=wr.getSection(Ii),Zo=wr.getSectionIndex(Ii),_o=wr.getCharCode(Ii);let ri=ds.scale,Yo=null,Ni=null,hl=null,Qo=Qs,Ks=0;const Fs=!(Yt===ec.horizontal||!Bt&&!dx(_o)||Bt&&(Z2[_o]||(ei=_o,qt.Arabic(ei)||qt["Arabic Supplement"](ei)||qt["Arabic Extended-A"](ei)||qt["Arabic Presentation Forms-A"](ei)||qt["Arabic Presentation Forms-B"](ei))));if(ds.imageName){const dl=Ft[ds.imageName];if(!dl)continue;hl=ds.imageName,We.iconsInText=We.iconsInText||!0,Ni=dl.paddedRect;const ks=dl.displaySize;ri=ri*Qs/xn,Yo={width:ks[0],height:ks[1],left:$l,top:-ej,advance:Fs?ks[1]:ks[0],localGlyph:!1},Ks=Xn?-Yo.height*ri:nj+Er*Qs-ks[1]*ri,Qo=Yo.advance;const nh=(Fs?ks[0]:ks[1])*ri-Qs*Er;nh>0&&nh>Pi&&(Pi=nh)}else{const dl=At[ds.fontStack];if(!dl)continue;dl[_o]&&(Ni=dl[_o]);const ks=bt[ds.fontStack];if(!ks)continue;const nh=ks.glyphs[_o];if(!nh)continue;if(Yo=nh.metrics,Qo=_o!==8203?Qs:0,Xn){const hy=ks.ascender!==void 0?Math.abs(ks.ascender):0,Yx=ks.descender!==void 0?Math.abs(ks.descender):0,Qx=(hy+Yx)*ri;uo<Qx&&(uo=Qx,To=(hy-Yx)/2*ri),Ks=-hy*ri}else Ks=nj+(Er-ri)*Qs}Fs?(We.verticalizable=!0,Bi.push({glyph:_o,imageName:hl,x:zn,y:En+Ks,vertical:Fs,scale:ri,localGlyph:Yo.localGlyph,fontStack:ds.fontStack,sectionIndex:Zo,metrics:Yo,rect:Ni}),zn+=Qo*ri+ln):(Bi.push({glyph:_o,imageName:hl,x:zn,y:En+Ks,vertical:Fs,scale:ri,localGlyph:Yo.localGlyph,fontStack:ds.fontStack,sectionIndex:Zo,metrics:Yo,rect:Ni}),zn+=Yo.advance*ri+ln)}Bi.length!==0&&(Ar=Math.max(zn-ln,Ar),Xn?aj(Bi,un,Pi,To,Tt*Er/2):aj(Bi,un,Pi,0,Tt/2)),zn=0;const Xo=Tt*Er+Pi;Di.lineOffset=Math.max(Pi,Ci),En+=Xo,++_r}var ei;const yr=En,{horizontalAlign:nr,verticalAlign:Hi}=F3(Gt);(function(wr,Er,Ci,Di,Bi,Pi){const uo=(Er-Ci)*Bi,To=-Pi*Di;for(const Xo of wr)for(const Ii of Xo.positionedGlyphs)Ii.x+=uo,Ii.y+=To})(We.positionedLines,un,nr,Hi,Ar,yr),We.top+=-Hi*yr,We.bottom=We.top+yr,We.left+=-nr*Ar,We.right=We.left+Ar,We.hasBaseline=Xn}(Ze,l,f,p,xe,C,M,N,K,U,ee,le),!function(We){for(const bt of We)if(bt.positionedGlyphs.length!==0)return!1;return!0}(je)&&Ze}const Z2={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Wde={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function rj(c,l,f,p,A,b){if(l.imageName){const C=p[l.imageName];return C?C.displaySize[0]*l.scale*Qs/b+A:0}{const C=f[l.fontStack],M=C&&C.glyphs[c];return M?M.metrics.advance*l.scale+A:0}}function ij(c,l,f,p){const A=Math.pow(c-l,2);return p?c<l?A/2:2*A:A+Math.abs(f)*f}function qde(c,l,f){let p=0;return c===10&&(p-=1e4),f&&(p+=150),c!==40&&c!==65288||(p+=50),l!==41&&l!==65289||(p+=50),p}function oj(c,l,f,p,A,b){let C=null,M=ij(l,f,A,b);for(const N of p){const U=ij(l-N.x,f,A,b)+N.badness;U<=M&&(C=N,M=U)}return{index:c,x:l,priorBreak:C,badness:M}}function sj(c){return c?sj(c.priorBreak).concat(c.index):[]}function F3(c){let l=.5,f=.5;switch(c){case"right":case"top-right":case"bottom-right":l=1;break;case"left":case"top-left":case"bottom-left":l=0}switch(c){case"bottom":case"bottom-right":case"bottom-left":f=1;break;case"top":case"top-right":case"top-left":f=0}return{horizontalAlign:l,verticalAlign:f}}function aj(c,l,f,p,A){if(!(l||f||p||A))return;const b=c.length-1,C=c[b],M=(C.x+C.metrics.advance*C.scale)*l;for(let N=0;N<=b;N++)c[N].x-=M,c[N].y+=f+p+A}function Xde(c,l,f){const{horizontalAlign:p,verticalAlign:A}=F3(f),b=l[0]-c.displaySize[0]*p,C=l[1]-c.displaySize[1]*A;return{image:c,top:C,bottom:C+c.displaySize[1],left:b,right:b+c.displaySize[0]}}function lj(c,l,f,p,A,b){const C=c.image;let M;if(C.content){const xe=C.content,Be=C.pixelRatio||1;M=[xe[0]/Be,xe[1]/Be,C.displaySize[0]-xe[2]/Be,C.displaySize[1]-xe[3]/Be]}const N=l.left*b,U=l.right*b;let W,K,ee,oe;f==="width"||f==="both"?(oe=A[0]+N-p[3],K=A[0]+U+p[1]):(oe=A[0]+(N+U-C.displaySize[0])/2,K=oe+C.displaySize[0]);const le=l.top*b,de=l.bottom*b;return f==="height"||f==="both"?(W=A[1]+le-p[0],ee=A[1]+de+p[2]):(W=A[1]+(le+de-C.displaySize[1])/2,ee=W+C.displaySize[1]),{image:C,top:W,right:K,bottom:ee,left:oe,collisionPadding:M}}class Fp extends ie{constructor(l,f,p,A,b){super(l,f),this.angle=A,this.z=p,b!==void 0&&(this.segment=b)}clone(){return new Fp(this.x,this.y,this.z,this.angle,this.segment)}}function uj(c,l,f,p,A){if(l.segment===void 0)return!0;let b=l,C=l.segment+1,M=0;for(;M>-f/2;){if(C--,C<0)return!1;M-=c[C].dist(b),b=c[C]}M+=c[C].dist(c[C+1]),C++;const N=[];let U=0;for(;M<f/2;){const W=c[C],K=c[C+1];if(!K)return!1;let ee=c[C-1].angleTo(W)-W.angleTo(K);for(ee=Math.abs((ee+3*Math.PI)%(2*Math.PI)-Math.PI),N.push({distance:M,angleDelta:ee}),U+=ee;M-N[0].distance>p;)U-=N.shift().angleDelta;if(U>A)return!1;C++,M+=W.dist(K)}return!0}function cj(c){let l=0;for(let f=0;f<c.length-1;f++)l+=c[f].dist(c[f+1]);return l}function fj(c,l,f){return c?.6*l*f:0}function hj(c,l){return Math.max(c?c.right-c.left:0,l?l.right-l.left:0)}function Zde(c,l,f,p,A,b){const C=fj(f,A,b),M=hj(f,p)*b;let N=0;const U=cj(c)/2;for(let W=0;W<c.length-1;W++){const K=c[W],ee=c[W+1],oe=K.dist(ee);if(N+oe>U){const le=(U-N)/oe,de=jr(K.x,ee.x,le),xe=jr(K.y,ee.y,le),Be=new Fp(de,xe,0,ee.angleTo(K),W);return!C||uj(c,Be,M,C,l)?Be:void 0}N+=oe}}function Yde(c,l,f,p,A,b,C,M,N){const U=fj(p,b,C),W=hj(p,A),K=W*C,ee=c[0].x===0||c[0].x===N||c[0].y===0||c[0].y===N;return l-K<l/4&&(l=K+l/4),dj(c,ee?l/2*M%l:(W/2+2*b)*C*M%l,l,U,f,K,ee,!1,N)}function dj(c,l,f,p,A,b,C,M,N){const U=b/2,W=cj(c);let K=0,ee=l-f,oe=[];for(let le=0;le<c.length-1;le++){const de=c[le],xe=c[le+1],Be=de.dist(xe),$e=xe.angleTo(de);for(;ee+f<K+Be;){ee+=f;const Ne=(ee-K)/Be,je=jr(de.x,xe.x,Ne),Ze=jr(de.y,xe.y,Ne);if(je>=0&&je<N&&Ze>=0&&Ze<N&&ee-U>=0&&ee+U<=W){const We=new Fp(je,Ze,0,$e,le);We._round(),p&&!uj(c,We,b,p,A)||oe.push(We)}}K+=Be}return M||oe.length||C||(oe=dj(c,K/2,f,p,A,b,C,!0,N)),oe}function pj(c,l,f,p,A){const b=[];for(let C=0;C<c.length;C++){const M=c[C];let N;for(let U=0;U<M.length-1;U++){let W=M[U],K=M[U+1];W.x<l&&K.x<l||(W.x<l?W=new ie(l,W.y+(l-W.x)/(K.x-W.x)*(K.y-W.y))._round():K.x<l&&(K=new ie(l,W.y+(l-W.x)/(K.x-W.x)*(K.y-W.y))._round()),W.y<f&&K.y<f||(W.y<f?W=new ie(W.x+(f-W.y)/(K.y-W.y)*(K.x-W.x),f)._round():K.y<f&&(K=new ie(W.x+(f-W.y)/(K.y-W.y)*(K.x-W.x),f)._round()),W.x>=p&&K.x>=p||(W.x>=p?W=new ie(p,W.y+(p-W.x)/(K.x-W.x)*(K.y-W.y))._round():K.x>=p&&(K=new ie(p,W.y+(p-W.x)/(K.x-W.x)*(K.y-W.y))._round()),W.y>=A&&K.y>=A||(W.y>=A?W=new ie(W.x+(A-W.y)/(K.y-W.y)*(K.x-W.x),A)._round():K.y>=A&&(K=new ie(W.x+(A-W.y)/(K.y-W.y)*(K.x-W.x),A)._round()),N&&W.equals(N[N.length-1])||(N=[W],b.push(N)),N.push(K)))))}}return b}Mt(Fp,"Anchor");const Gx=1e20;function gj(c,l,f,p,A,b,C,M,N){for(let U=l;U<l+p;U++)mj(c,f*b+U,b,A,C,M,N);for(let U=f;U<f+A;U++)mj(c,U*b+l,1,p,C,M,N)}function mj(c,l,f,p,A,b,C){b[0]=0,C[0]=-Gx,C[1]=Gx,A[0]=c[l];for(let M=1,N=0,U=0;M<p;M++){A[M]=c[l+M*f];const W=M*M;do{const K=b[N];U=(A[M]-A[K]+W-K*K)/(M-K)/2}while(U<=C[N]&&--N>-1);N++,b[N]=M,C[N]=U,C[N+1]=Gx}for(let M=0,N=0;M<p;M++){for(;C[N+1]<M;)N++;const U=b[N],W=M-U;c[l+M*f]=A[U]+W*W}}const eh=2,k3={none:0,ideographs:1,all:2};class sy{constructor(l,f,p){this.requestManager=l,this.localGlyphMode=f,this.localFontFamily=p,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(l){this.url=l}getGlyphs(l,f){const p=[];for(const A in l)for(const b of l[A])p.push({stack:A,id:b});qe(p,({stack:A,id:b},C)=>{let M=this.entries[A];M||(M=this.entries[A]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let N=M.glyphs[b];if(N!==void 0)return void C(null,{stack:A,id:b,glyph:N});if(N=this._tinySDF(M,A,b),N)return M.glyphs[b]=N,void C(null,{stack:A,id:b,glyph:N});const U=Math.floor(b/256);if(256*U>65535)return void C(new Error("glyphs > 65535 not supported"));if(M.ranges[U])return void C(null,{stack:A,id:b,glyph:N});let W=M.requests[U];W||(W=M.requests[U]=[],sy.loadGlyphRange(A,U,this.url,this.requestManager,(K,ee)=>{if(ee){M.ascender=ee.ascender,M.descender=ee.descender;for(const oe in ee.glyphs)this._doesCharSupportLocalGlyph(+oe)||(M.glyphs[+oe]=ee.glyphs[+oe]);M.ranges[U]=!0}for(const oe of W)oe(K,ee);delete M.requests[U]})),W.push((K,ee)=>{K?C(K):ee&&C(null,{stack:A,id:b,glyph:ee.glyphs[b]||null})})},(A,b)=>{if(A)f(A);else if(b){const C={};for(const{stack:M,id:N,glyph:U}of b)C[M]===void 0&&(C[M]={}),C[M].glyphs===void 0&&(C[M].glyphs={}),C[M].glyphs[N]=U&&{id:U.id,bitmap:U.bitmap.clone(),metrics:U.metrics},C[M].ascender=this.entries[M].ascender,C[M].descender=this.entries[M].descender;f(null,C)}})}_doesCharSupportLocalGlyph(l){return this.localGlyphMode!==k3.none&&(this.localGlyphMode===k3.all?!!this.localFontFamily:!!this.localFontFamily&&(qt["CJK Unified Ideographs"](l)||qt["Hangul Syllables"](l)||qt.Hiragana(l)||qt.Katakana(l)||qt["CJK Symbols and Punctuation"](l)))}_tinySDF(l,f,p){const A=this.localFontFamily;if(!A||!this._doesCharSupportLocalGlyph(p))return;let b=l.tinySDF;if(!b){let de="400";/bold/i.test(f)?de="900":/medium/i.test(f)?de="500":/light/i.test(f)&&(de="200"),b=l.tinySDF=new sy.TinySDF({fontFamily:A,fontWeight:de,fontSize:24*eh,buffer:3*eh,radius:8*eh}),b.fontWeight=de}if(this.localGlyphs[b.fontWeight][p])return this.localGlyphs[b.fontWeight][p];const C=String.fromCharCode(p),{data:M,width:N,height:U,glyphWidth:W,glyphHeight:K,glyphLeft:ee,glyphTop:oe,glyphAdvance:le}=b.draw(C);return this.localGlyphs[b.fontWeight][p]={id:p,bitmap:new Bp({width:N,height:U},M),metrics:{width:W/eh,height:K/eh,left:ee/eh,top:oe/eh-27,advance:le/eh,localGlyph:!0}}}}sy.loadGlyphRange=function(c,l,f,p,A){const b=256*l,C=b+255,M=p.transformRequest(p.normalizeGlyphsURL(f).replace("{fontstack}",c).replace("{range}",`${b}-${C}`),$u.Glyphs);Fc(M,(N,U)=>{if(N)A(N);else if(U){const W={},K=function(ee){return new X2(ee).readFields(Vde,{})}(U);for(const ee of K.glyphs)W[ee.id]=ee;A(null,{glyphs:W,ascender:K.ascender,descender:K.descender})}})},sy.TinySDF=class{constructor({fontSize:c=24,buffer:l=3,radius:f=8,cutoff:p=.25,fontFamily:A="sans-serif",fontWeight:b="normal",fontStyle:C="normal"}={}){this.buffer=l,this.cutoff=p,this.radius=f;const M=this.size=c+4*l,N=this._createCanvas(M),U=this.ctx=N.getContext("2d",{willReadFrequently:!0});U.font=`${C} ${b} ${c}px ${A}`,U.textBaseline="alphabetic",U.textAlign="left",U.fillStyle="black",this.gridOuter=new Float64Array(M*M),this.gridInner=new Float64Array(M*M),this.f=new Float64Array(M),this.z=new Float64Array(M+1),this.v=new Uint16Array(M)}_createCanvas(c){const l=document.createElement("canvas");return l.width=l.height=c,l}draw(c){const{width:l,actualBoundingBoxAscent:f,actualBoundingBoxDescent:p,actualBoundingBoxLeft:A,actualBoundingBoxRight:b}=this.ctx.measureText(c),C=Math.ceil(f),M=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-A))),N=Math.min(this.size-this.buffer,C+Math.ceil(p)),U=M+2*this.buffer,W=N+2*this.buffer,K=Math.max(U*W,0),ee=new Uint8ClampedArray(K),oe={data:ee,width:U,height:W,glyphWidth:M,glyphHeight:N,glyphTop:C,glyphLeft:0,glyphAdvance:l};if(M===0||N===0)return oe;const{ctx:le,buffer:de,gridInner:xe,gridOuter:Be}=this;le.clearRect(de,de,M,N),le.fillText(c,de,de+C);const $e=le.getImageData(de,de,M,N);Be.fill(Gx,0,K),xe.fill(0,0,K);for(let Ne=0;Ne<N;Ne++)for(let je=0;je<M;je++){const Ze=$e.data[4*(Ne*M+je)+3]/255;if(Ze===0)continue;const We=(Ne+de)*U+je+de;if(Ze===1)Be[We]=0,xe[We]=Gx;else{const bt=.5-Ze;Be[We]=bt>0?bt*bt:0,xe[We]=bt<0?bt*bt:0}}gj(Be,0,0,U,W,U,this.f,this.v,this.z),gj(xe,de,de,M,N,U,this.f,this.v,this.z);for(let Ne=0;Ne<K;Ne++){const je=Math.sqrt(Be[Ne])-Math.sqrt(xe[Ne]);ee[Ne]=Math.round(255-255*(je/this.radius+this.cutoff))}return oe}};const ay=$l;function Aj(c,l,f,p){const A=[],b=c.image,C=b.pixelRatio,M=b.paddedRect.w-2*ay,N=b.paddedRect.h-2*ay,U=c.right-c.left,W=c.bottom-c.top,K=b.stretchX||[[0,M]],ee=b.stretchY||[[0,N]],oe=(Tt,Gt)=>Tt+Gt[1]-Gt[0],le=K.reduce(oe,0),de=ee.reduce(oe,0),xe=M-le,Be=N-de;let $e=0,Ne=le,je=0,Ze=de,We=0,bt=xe,At=0,Ft=Be;if(b.content&&p){const Tt=b.content;$e=Y2(K,0,Tt[0]),je=Y2(ee,0,Tt[1]),Ne=Y2(K,Tt[0],Tt[2]),Ze=Y2(ee,Tt[1],Tt[3]),We=Tt[0]-$e,At=Tt[1]-je,bt=Tt[2]-Tt[0]-Ne,Ft=Tt[3]-Tt[1]-Ze}const tn=(Tt,Gt,jt,Yt)=>{const ln=Q2(Tt.stretch-$e,Ne,U,c.left),Bt=K2(Tt.fixed-We,bt,Tt.stretch,le),xn=Q2(Gt.stretch-je,Ze,W,c.top),zn=K2(Gt.fixed-At,Ft,Gt.stretch,de),En=Q2(jt.stretch-$e,Ne,U,c.left),Ar=K2(jt.fixed-We,bt,jt.stretch,le),un=Q2(Yt.stretch-je,Ze,W,c.top),Xn=K2(Yt.fixed-At,Ft,Yt.stretch,de),_r=new ie(ln,xn),ei=new ie(En,xn),yr=new ie(En,un),nr=new ie(ln,un),Hi=new ie(Bt/C,zn/C),wr=new ie(Ar/C,Xn/C),Er=l*Math.PI/180;if(Er){const Bi=Math.sin(Er),Pi=Math.cos(Er),uo=[Pi,-Bi,Bi,Pi];_r._matMult(uo),ei._matMult(uo),nr._matMult(uo),yr._matMult(uo)}const Ci=Tt.stretch+Tt.fixed,Di=Gt.stretch+Gt.fixed;return{tl:_r,tr:ei,bl:nr,br:yr,tex:{x:b.paddedRect.x+ay+Ci,y:b.paddedRect.y+ay+Di,w:jt.stretch+jt.fixed-Ci,h:Yt.stretch+Yt.fixed-Di},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Hi,pixelOffsetBR:wr,minFontScaleX:bt/C/U,minFontScaleY:Ft/C/W,isSDF:f}};if(p&&(b.stretchX||b.stretchY)){const Tt=_j(K,xe,le),Gt=_j(ee,Be,de);for(let jt=0;jt<Tt.length-1;jt++){const Yt=Tt[jt],ln=Tt[jt+1];for(let Bt=0;Bt<Gt.length-1;Bt++)A.push(tn(Yt,Gt[Bt],ln,Gt[Bt+1]))}}else A.push(tn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:M+1},{fixed:0,stretch:N+1}));return A}function Y2(c,l,f){let p=0;for(const A of c)p+=Math.max(l,Math.min(f,A[1]))-Math.max(l,Math.min(f,A[0]));return p}function _j(c,l,f){const p=[{fixed:-ay,stretch:0}];for(const[A,b]of c){const C=p[p.length-1];p.push({fixed:A-C.stretch,stretch:C.stretch}),p.push({fixed:A-C.stretch,stretch:C.stretch+(b-A)})}return p.push({fixed:l+ay,stretch:f}),p}function Q2(c,l,f,p){return c/l*f+p}function K2(c,l,f,p){return c-l*f/p}function Qde(c,l,f,p){const A=l+c.positionedLines[p].lineOffset;return p===0?f+A/2:f+(A+(l+c.positionedLines[p-1].lineOffset))/2}class Kde{constructor(l=[],f=Jde){if(this.data=l,this.length=this.data.length,this.compare=f,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(l){this.data.push(l),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const l=this.data[0],f=this.data.pop();return this.length--,this.length>0&&(this.data[0]=f,this._down(0)),l}peek(){return this.data[0]}_up(l){const{data:f,compare:p}=this,A=f[l];for(;l>0;){const b=l-1>>1,C=f[b];if(p(A,C)>=0)break;f[l]=C,l=b}f[l]=A}_down(l){const{data:f,compare:p}=this,A=this.length>>1,b=f[l];for(;l<A;){let C=1+(l<<1),M=f[C];const N=C+1;if(N<this.length&&p(f[N],M)<0&&(C=N,M=f[N]),p(M,b)>=0)break;f[l]=M,l=C}f[l]=b}}function Jde(c,l){return c<l?-1:c>l?1:0}function epe(c,l=1,f=!1){let p=1/0,A=1/0,b=-1/0,C=-1/0;const M=c[0];for(let oe=0;oe<M.length;oe++){const le=M[oe];(!oe||le.x<p)&&(p=le.x),(!oe||le.y<A)&&(A=le.y),(!oe||le.x>b)&&(b=le.x),(!oe||le.y>C)&&(C=le.y)}const N=Math.min(b-p,C-A);let U=N/2;const W=new Kde([],tpe);if(N===0)return new ie(p,A);for(let oe=p;oe<b;oe+=N)for(let le=A;le<C;le+=N)W.push(new ly(oe+U,le+U,U,c));let K=function(oe){let le=0,de=0,xe=0;const Be=oe[0];for(let $e=0,Ne=Be.length,je=Ne-1;$e<Ne;je=$e++){const Ze=Be[$e],We=Be[je],bt=Ze.x*We.y-We.x*Ze.y;de+=(Ze.x+We.x)*bt,xe+=(Ze.y+We.y)*bt,le+=3*bt}return new ly(de/le,xe/le,0,oe)}(c),ee=W.length;for(;W.length;){const oe=W.pop();(oe.d>K.d||!K.d)&&(K=oe,f&&console.log("found best %d after %d probes",Math.round(1e4*oe.d)/1e4,ee)),oe.max-K.d<=l||(U=oe.h/2,W.push(new ly(oe.p.x-U,oe.p.y-U,U,c)),W.push(new ly(oe.p.x+U,oe.p.y-U,U,c)),W.push(new ly(oe.p.x-U,oe.p.y+U,U,c)),W.push(new ly(oe.p.x+U,oe.p.y+U,U,c)),ee+=4)}return f&&(console.log(`num probes: ${ee}`),console.log(`best distance: ${K.d}`)),K.p}function tpe(c,l){return l.max-c.max}class ly{constructor(l,f,p,A){this.p=new ie(l,f),this.h=p,this.d=function(b,C){let M=!1,N=1/0;for(let U=0;U<C.length;U++){const W=C[U];for(let K=0,ee=W.length,oe=ee-1;K<ee;oe=K++){const le=W[K],de=W[oe];le.y>b.y!=de.y>b.y&&b.x<(de.x-le.x)*(b.y-le.y)/(de.y-le.y)+le.x&&(M=!M),N=Math.min(N,dG(b,le,de))}}return(M?1:-1)*Math.sqrt(N)}(this.p,A),this.max=this.d+this.h*Math.SQRT2}}const uy=7,z3=Number.POSITIVE_INFINITY,npe=Math.sqrt(2);function yj(c,[l,f]){let p=0,A=0;if(f===z3){l<0&&(l=0);const b=l/npe;switch(c){case"top-right":case"top-left":A=b-uy;break;case"bottom-right":case"bottom-left":A=-b+uy;break;case"bottom":A=-l+uy;break;case"top":A=l-uy}switch(c){case"top-right":case"bottom-right":p=-b;break;case"top-left":case"bottom-left":p=b;break;case"left":p=l;break;case"right":p=-l}}else{switch(l=Math.abs(l),f=Math.abs(f),c){case"top-right":case"top-left":case"top":A=f-uy;break;case"bottom-right":case"bottom-left":case"bottom":A=-f+uy}switch(c){case"top-right":case"bottom-right":case"right":p=-l;break;case"top-left":case"bottom-left":case"left":p=l}}return[p,A]}function rpe(c,l,f,p,A,b,C,M,N,U){c.createArrays(),c.tilePixelRatio=Kn/(512*c.overscaling),c.compareText={},c.iconsNeedLinear=!1;const W=c.layers[0].layout,K=c.layers[0]._unevaluatedLayout._values,ee={};if(c.textSizeData.kind==="composite"){const{minZoom:de,maxZoom:xe}=c.textSizeData;ee.compositeTextSizes=[K["text-size"].possiblyEvaluate(new Q(de),M),K["text-size"].possiblyEvaluate(new Q(xe),M)]}if(c.iconSizeData.kind==="composite"){const{minZoom:de,maxZoom:xe}=c.iconSizeData;ee.compositeIconSizes=[K["icon-size"].possiblyEvaluate(new Q(de),M),K["icon-size"].possiblyEvaluate(new Q(xe),M)]}ee.layoutTextSize=K["text-size"].possiblyEvaluate(new Q(N+1),M),ee.layoutIconSize=K["icon-size"].possiblyEvaluate(new Q(N+1),M),ee.textMaxSize=K["text-size"].possiblyEvaluate(new Q(18),M);const oe=W.get("text-rotation-alignment")==="map"&&W.get("symbol-placement")!=="point",le=W.get("text-size");for(const de of c.features){const xe=W.get("text-font").evaluate(de,{},M).join(","),Be=le.evaluate(de,{},M),$e=ee.layoutTextSize.evaluate(de,{},M),Ne=(ee.layoutIconSize.evaluate(de,{},M),{horizontal:{},vertical:void 0}),je=de.text;let Ze,We=[0,0];if(je){const Ft=je.toString(),tn=W.get("text-letter-spacing").evaluate(de,{},M)*Qs,Tt=W.get("text-line-height").evaluate(de,{},M)*Qs,Gt=$i(Ft)?tn:0,jt=W.get("text-anchor").evaluate(de,{},M),Yt=W.get("text-variable-anchor");if(!Yt){const En=W.get("text-radial-offset").evaluate(de,{},M);We=En?yj(jt,[En*Qs,z3]):W.get("text-offset").evaluate(de,{},M).map(Ar=>Ar*Qs)}let ln=oe?"center":W.get("text-justify").evaluate(de,{},M);const Bt=W.get("symbol-placement")==="point",xn=Bt?W.get("text-max-width").evaluate(de,{},M)*Qs:1/0,zn=En=>{c.allowVerticalPlacement&&xi(Ft)&&(Ne.vertical=N3(je,l,f,A,xe,xn,Tt,jt,En,Gt,We,ec.vertical,!0,$e,Be))};if(!oe&&Yt){const En=ln==="auto"?Yt.map(un=>U3(un)):[ln];let Ar=!1;for(let un=0;un<En.length;un++){const Xn=En[un];if(!Ne.horizontal[Xn])if(Ar)Ne.horizontal[Xn]=Ne.horizontal[0];else{const _r=N3(je,l,f,A,xe,xn,Tt,"center",Xn,Gt,We,ec.horizontal,!1,$e,Be);_r&&(Ne.horizontal[Xn]=_r,Ar=_r.positionedLines.length===1)}}zn("left")}else{if(ln==="auto"&&(ln=U3(jt)),Bt||W.get("text-writing-mode").indexOf("horizontal")>=0||!xi(Ft)){const En=N3(je,l,f,A,xe,xn,Tt,jt,ln,Gt,We,ec.horizontal,!1,$e,Be);En&&(Ne.horizontal[ln]=En)}zn(Bt?"left":ln)}}let bt=!1;if(de.icon&&de.icon.name){const Ft=p[de.icon.name];Ft&&(Ze=Xde(A[de.icon.name],W.get("icon-offset").evaluate(de,{},M),W.get("icon-anchor").evaluate(de,{},M)),bt=Ft.sdf,c.sdfIcons===void 0?c.sdfIcons=Ft.sdf:c.sdfIcons!==Ft.sdf&&$t("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Ft.pixelRatio!==c.pixelRatio||W.get("icon-rotate").constantOr(1)!==0)&&(c.iconsNeedLinear=!0))}const At=xj(Ne.horizontal)||Ne.vertical;c.iconsInText||(c.iconsInText=!!At&&At.iconsInText),(At||Ze)&&ipe(c,de,Ne,Ze,p,ee,$e,0,We,bt,C,M,U)}b&&c.generateCollisionDebugBuffers(N,c.collisionBoxArray)}function U3(c){switch(c){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ipe(c,l,f,p,A,b,C,M,N,U,W,K,ee){let oe=b.textMaxSize.evaluate(l,{},K);oe===void 0&&(oe=C);const le=c.layers[0].layout,de=le.get("icon-offset").evaluate(l,{},K),xe=xj(f.horizontal)||f.vertical,Be=ee.name==="globe",$e=Qs,Ne=C/$e,je=c.tilePixelRatio*oe/$e,Ze=(jt=c.overscaling,c.zoom>18&&jt>2&&(jt>>=1),Math.max(Kn/(512*jt),1)*le.get("symbol-spacing")),We=le.get("text-padding")*c.tilePixelRatio,bt=le.get("icon-padding")*c.tilePixelRatio,At=me(le.get("text-max-angle")),Ft=le.get("text-rotation-alignment")==="map"&&le.get("symbol-placement")!=="point",tn=le.get("icon-rotation-alignment")==="map"&&le.get("symbol-placement")!=="point",Tt=le.get("symbol-placement"),Gt=Ze/2;var jt;const Yt=le.get("icon-text-fit");let ln;p&&Yt!=="none"&&(c.allowVerticalPlacement&&f.vertical&&(ln=lj(p,f.vertical,Yt,le.get("icon-text-fit-padding"),de,Ne)),xe&&(p=lj(p,xe,Yt,le.get("icon-text-fit-padding"),de,Ne)));const Bt=(xn,zn,En)=>{if(zn.x<0||zn.x>=Kn||zn.y<0||zn.y>=Kn)return;let Ar=null;if(Be){const{x:un,y:Xn,z:_r}=ee.projectTilePoint(zn.x,zn.y,En);Ar={anchor:new Fp(un,Xn,_r,0,void 0),up:ee.upVector(En,zn.x,zn.y)}}(function(un,Xn,_r,ei,yr,nr,Hi,wr,Er,Ci,Di,Bi,Pi,uo,To,Xo,Ii,ds,Zo,_o,ri,Yo,Ni,hl,Qo){const Ks=un.addToLineVertexArray(Xn,ei);let Fs,dl,ks,nh,hy,Yx,Qx,eV=0,tV=0,nV=0,rV=0,tD=-1,nD=-1;const cd={};let iV=QL("");const o0=_r?_r.anchor:Xn;let rD=0,iD=0;if(Er._unevaluatedLayout.getValue("text-radial-offset")===void 0?[rD,iD]=Er.layout.get("text-offset").evaluate(ri,{},Qo).map(Au=>Au*Qs):(rD=Er.layout.get("text-radial-offset").evaluate(ri,{},Qo)*Qs,iD=z3),un.allowVerticalPlacement&&yr.vertical){const Au=yr.vertical;if(To)Yx=G3(Au),wr&&(Qx=G3(wr));else{const _u=Er.layout.get("text-rotate").evaluate(ri,{},Qo)+90;ks=J2(Ci,o0,Xn,Di,Bi,Pi,Au,uo,_u,Xo),wr&&(nh=J2(Ci,o0,Xn,Di,Bi,Pi,wr,ds,_u))}}if(nr){const Au=Er.layout.get("icon-rotate").evaluate(ri,{},Qo),_u=Er.layout.get("icon-text-fit")!=="none",Kx=Aj(nr,Au,Ni,_u),sD=wr?Aj(wr,Au,Ni,_u):void 0;dl=J2(Ci,o0,Xn,Di,Bi,Pi,nr,ds,Au),eV=4*Kx.length;const oV=un.iconSizeData;let s0=null;oV.kind==="source"?(s0=[Jf*Er.layout.get("icon-size").evaluate(ri,{},Qo)],s0[0]>em&&$t(`${un.layerIds[0]}: Value for "icon-size" is >= ${jx}. Reduce your "icon-size".`)):oV.kind==="composite"&&(s0=[Jf*Yo.compositeIconSizes[0].evaluate(ri,{},Qo),Jf*Yo.compositeIconSizes[1].evaluate(ri,{},Qo)],(s0[0]>em||s0[1]>em)&&$t(`${un.layerIds[0]}: Value for "icon-size" is >= ${jx}. Reduce your "icon-size".`)),un.addSymbols(un.icon,Kx,s0,_o,Zo,ri,!1,_r,Xn,Ks.lineStartIndex,Ks.lineLength,-1,hl,Qo),tD=un.icon.placedSymbolArray.length-1,sD&&(tV=4*sD.length,un.addSymbols(un.icon,sD,s0,_o,Zo,ri,ec.vertical,_r,Xn,Ks.lineStartIndex,Ks.lineLength,-1,hl,Qo),nD=un.icon.placedSymbolArray.length-1)}for(const Au in yr.horizontal){const _u=yr.horizontal[Au];Fs||(iV=QL(_u.text),To?hy=G3(_u):Fs=J2(Ci,o0,Xn,Di,Bi,Pi,_u,uo,Er.layout.get("text-rotate").evaluate(ri,{},Qo),Xo));const Kx=_u.positionedLines.length===1;if(nV+=vj(un,_r,Xn,_u,Hi,Er,To,ri,Xo,Ks,yr.vertical?ec.horizontal:ec.horizontalOnly,Kx?Object.keys(yr.horizontal):[Au],cd,tD,Yo,hl,Qo),Kx)break}yr.vertical&&(rV+=vj(un,_r,Xn,yr.vertical,Hi,Er,To,ri,Xo,Ks,ec.vertical,["vertical"],cd,nD,Yo,hl,Qo));let sm=-1;const oD=(Au,_u)=>Au?Math.max(Au,_u):_u;sm=oD(hy,sm),sm=oD(Yx,sm),sm=oD(Qx,sm);const Rpe=sm>-1?1:0;un.glyphOffsetArray.length>=nm.MAX_GLYPHS&&$t("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ri.sortKey!==void 0&&un.addToSortKeyRanges(un.symbolInstances.length,ri.sortKey),un.symbolInstances.emplaceBack(o0.x,o0.y,o0.z,Xn.x,Xn.y,cd.right>=0?cd.right:-1,cd.center>=0?cd.center:-1,cd.left>=0?cd.left:-1,cd.vertical>=0?cd.vertical:-1,tD,nD,iV,Fs!==void 0?Fs:un.collisionBoxArray.length,Fs!==void 0?Fs+1:un.collisionBoxArray.length,ks!==void 0?ks:un.collisionBoxArray.length,ks!==void 0?ks+1:un.collisionBoxArray.length,dl!==void 0?dl:un.collisionBoxArray.length,dl!==void 0?dl+1:un.collisionBoxArray.length,nh||un.collisionBoxArray.length,nh?nh+1:un.collisionBoxArray.length,Di,nV,rV,eV,tV,Rpe,0,rD,iD,sm)})(c,zn,Ar,xn,f,p,A,ln,c.layers[0],c.collisionBoxArray,l.index,l.sourceLayerIndex,c.index,We,Ft,N,0,bt,tn,de,l,b,U,W,K)};if(Tt==="line")for(const xn of pj(l.geometry,0,0,Kn,Kn)){const zn=Yde(xn,Ze,At,f.vertical||xe,p,$e,je,c.overscaling,Kn);for(const En of zn)xe&&ope(c,xe.text,Gt,En)||Bt(xn,En,K)}else if(Tt==="line-center"){for(const xn of l.geometry)if(xn.length>1){const zn=Zde(xn,At,f.vertical||xe,p,$e,je);zn&&Bt(xn,zn,K)}}else if(l.type==="Polygon")for(const xn of C3(l.geometry,0)){const zn=epe(xn,16);Bt(xn[0],new Fp(zn.x,zn.y,0,0,void 0),K)}else if(l.type==="LineString")for(const xn of l.geometry)Bt(xn,new Fp(xn[0].x,xn[0].y,0,0,void 0),K);else if(l.type==="Point")for(const xn of l.geometry)for(const zn of xn)Bt([zn],new Fp(zn.x,zn.y,0,0,void 0),K)}const jx=255,em=jx*Jf;function vj(c,l,f,p,A,b,C,M,N,U,W,K,ee,oe,le,de,xe){const Be=function(je,Ze,We,bt,At,Ft,tn,Tt){const Gt=[];if(Ze.positionedLines.length===0)return Gt;const jt=bt.layout.get("text-rotate").evaluate(Ft,{})*Math.PI/180,Yt=function(En){const Ar=En[0],un=En[1],Xn=Ar*un;return Xn>0?[Ar,-un]:Xn<0?[-Ar,un]:Ar===0?[un,Ar]:[un,-Ar]}(We);let ln=Math.abs(Ze.top-Ze.bottom);for(const En of Ze.positionedLines)ln-=En.lineOffset;const Bt=Ze.positionedLines.length,xn=ln/Bt;let zn=Ze.top-We[1];for(let En=0;En<Bt;++En){const Ar=Ze.positionedLines[En];zn=Qde(Ze,xn,zn,En);for(const un of Ar.positionedGlyphs){if(!un.rect)continue;const Xn=un.rect||{};let _r=ej+1,ei=!0,yr=1,nr=0;if(un.imageName){const Ni=tn[un.imageName];if(!Ni)continue;if(Ni.sdf){$t("SDF images are not supported in formatted text and will be ignored.");continue}ei=!1,yr=Ni.pixelRatio,_r=$l/yr}const Hi=(At||Tt)&&un.vertical,wr=un.metrics.advance*un.scale/2,Er=un.metrics,Ci=un.rect;if(Ci===null)continue;Tt&&Ze.verticalizable&&(nr=un.imageName?wr-un.metrics.width*un.scale/2:0);const Di=At?[un.x+wr,un.y]:[0,0];let Bi=[0,0],Pi=[0,0],uo=!1;At||(Hi?(Pi=[un.x+wr+Yt[0],un.y+Yt[1]-nr],uo=!0):Bi=[un.x+wr+We[0],un.y+We[1]-nr]);const To=Ci.w*un.scale/(yr*(un.localGlyph?eh:1)),Xo=Ci.h*un.scale/(yr*(un.localGlyph?eh:1));let Ii,ds,Zo,_o;if(Hi){const Ni=un.y-zn,hl=new ie(-wr,wr-Ni),Qo=-Math.PI/2,Ks=new ie(...Pi);Ii=new ie(-wr+Bi[0],Bi[1]),Ii._rotateAround(Qo,hl)._add(Ks),Ii.x+=-Ni+wr,Ii.y-=(Er.left-_r)*un.scale;const Fs=un.imageName?Er.advance*un.scale:Qs*un.scale,dl=String.fromCharCode(un.glyph);Rde(dl)?Ii.x+=(1-_r)*un.scale:Lde(dl)?Ii.x+=Fs-Er.height*un.scale+(-_r-1)*un.scale:Ii.x+=un.imageName||Er.width+2*_r===Ci.w&&Er.height+2*_r===Ci.h?(Fs-Xo)/2:(Fs-(Er.height+2*_r)*un.scale)/2,ds=new ie(Ii.x,Ii.y-To),Zo=new ie(Ii.x+Xo,Ii.y),_o=new ie(Ii.x+Xo,Ii.y-To)}else{const Ni=(Er.left-_r)*un.scale-wr+Bi[0],hl=(-Er.top-_r)*un.scale+Bi[1],Qo=Ni+To,Ks=hl+Xo;Ii=new ie(Ni,hl),ds=new ie(Qo,hl),Zo=new ie(Ni,Ks),_o=new ie(Qo,Ks)}if(jt){let Ni;Ni=At?new ie(0,0):uo?new ie(Yt[0],Yt[1]):new ie(We[0],We[1]),Ii._rotateAround(jt,Ni),ds._rotateAround(jt,Ni),Zo._rotateAround(jt,Ni),_o._rotateAround(jt,Ni)}const ri=new ie(0,0),Yo=new ie(0,0);Gt.push({tl:Ii,tr:ds,bl:Zo,br:_o,tex:Xn,writingMode:Ze.writingMode,glyphOffset:Di,sectionIndex:un.sectionIndex,isSDF:ei,pixelOffsetTL:ri,pixelOffsetBR:Yo,minFontScaleX:0,minFontScaleY:0})}}return Gt}(0,p,N,b,C,M,A,c.allowVerticalPlacement),$e=c.textSizeData;let Ne=null;$e.kind==="source"?(Ne=[Jf*b.layout.get("text-size").evaluate(M,{},xe)],Ne[0]>em&&$t(`${c.layerIds[0]}: Value for "text-size" is >= ${jx}. Reduce your "text-size".`)):$e.kind==="composite"&&(Ne=[Jf*le.compositeTextSizes[0].evaluate(M,{},xe),Jf*le.compositeTextSizes[1].evaluate(M,{},xe)],(Ne[0]>em||Ne[1]>em)&&$t(`${c.layerIds[0]}: Value for "text-size" is >= ${jx}. Reduce your "text-size".`)),c.addSymbols(c.text,Be,Ne,N,C,M,W,l,f,U.lineStartIndex,U.lineLength,oe,de,xe);for(const je of K)ee[je]=c.text.placedSymbolArray.length-1;return 4*Be.length}function xj(c){for(const l in c)return c[l];return null}function J2(c,l,f,p,A,b,C,M,N,U){let W=C.top,K=C.bottom,ee=C.left,oe=C.right;const le=C.collisionPadding;if(le&&(ee-=le[0],W-=le[1],oe+=le[2],K+=le[3]),N){const de=new ie(ee,W),xe=new ie(oe,W),Be=new ie(ee,K),$e=new ie(oe,K),Ne=me(N);let je=new ie(0,0);U&&(je=new ie(U[0],U[1])),de._rotateAround(Ne,je),xe._rotateAround(Ne,je),Be._rotateAround(Ne,je),$e._rotateAround(Ne,je),ee=Math.min(de.x,xe.x,Be.x,$e.x),oe=Math.max(de.x,xe.x,Be.x,$e.x),W=Math.min(de.y,xe.y,Be.y,$e.y),K=Math.max(de.y,xe.y,Be.y,$e.y)}return c.emplaceBack(l.x,l.y,l.z,f.x,f.y,ee,W,oe,K,M,p,A,b),c.length-1}function G3(c){c.collisionPadding&&(c.top-=c.collisionPadding[1],c.bottom+=c.collisionPadding[3]);const l=c.bottom-c.top;return l>0?Math.max(10,l):null}function ope(c,l,f,p){const A=c.compareText;if(l in A){const b=A[l];for(let C=b.length-1;C>=0;C--)if(p.dist(b[C])<f)return!0}else A[l]=[];return A[l].push(p),!1}function bj(c,l){const f=c.fovAboveCenter,p=c.elevation?c.elevation.getMinElevationBelowMSL()*l:0,A=(c._camera.position[2]*c.worldSize-p)/Math.cos(c._pitch),b=Math.sin(f)*A/Math.sin(Math.max(Math.PI/2-c._pitch-f,.01)),C=Math.sin(c._pitch)*b+A;return Math.min(1.01*C,A*(1/c._horizonShift))}function r0(c,l){if(!l.isReprojectedInTileSpace)return{scale:1<<c.z,x:c.x,y:c.y,x2:c.x+1,y2:c.y+1,projection:l};const f=Math.pow(2,-c.z),p=c.x*f,A=(c.x+1)*f,b=c.y*f,C=(c.y+1)*f,M=Ju(p),N=Ju(A),U=ya(b),W=ya(C),K=l.project(M,U),ee=l.project(N,U),oe=l.project(N,W),le=l.project(M,W);let de=Math.min(K.x,ee.x,oe.x,le.x),xe=Math.min(K.y,ee.y,oe.y,le.y),Be=Math.max(K.x,ee.x,oe.x,le.x),$e=Math.max(K.y,ee.y,oe.y,le.y);const Ne=f/16;function je(We,bt,At,Ft,tn,Tt){const Gt=(At+tn)/2,jt=(Ft+Tt)/2,Yt=l.project(Ju(Gt),ya(jt)),ln=Math.max(0,de-Yt.x,xe-Yt.y,Yt.x-Be,Yt.y-$e);de=Math.min(de,Yt.x),Be=Math.max(Be,Yt.x),xe=Math.min(xe,Yt.y),$e=Math.max($e,Yt.y),ln>Ne&&(je(We,Yt,At,Ft,Gt,jt),je(Yt,bt,Gt,jt,tn,Tt))}je(K,ee,p,b,A,b),je(ee,oe,A,b,A,C),je(oe,le,A,C,p,C),je(le,K,p,C,p,b),de-=Ne,xe-=Ne,Be+=Ne,$e+=Ne;const Ze=1/Math.max(Be-de,$e-xe);return{scale:Ze,x:de*Ze,y:xe*Ze,x2:Be*Ze,y2:$e*Ze,projection:l}}const spe=Yf(new Float32Array(16));class tm{constructor(l){this.spec=l,this.name=l.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(l,f){return{x:0,y:0,z:0}}unproject(l,f){return new Ti(0,0)}projectTilePoint(l,f,p){return{x:l,y:f,z:0}}locationPoint(l,f,p=!0){return l._coordinatePoint(l.locationCoordinate(f),p)}pixelsPerMeter(l,f){return Kf(1,l)*f}pixelSpaceConversion(l,f,p){return 1}farthestPixelDistance(l){return bj(l,l.pixelsPerMeter)}pointCoordinate(l,f,p,A){const b=l.horizonLineFromTop(!1),C=new ie(f,Math.max(b,p));return l.rayIntersectionCoordinate(l.pointRayIntersection(C,A))}pointCoordinate3D(l,f,p){const A=new ie(f,p);if(l.elevation)return l.elevation.pointCoordinate(A);{const b=this.pointCoordinate(l,A.x,A.y,0);return[b.x,b.y,b.z]}}isPointAboveHorizon(l,f){if(l.elevation)return!this.pointCoordinate3D(l,f.x,f.y);const p=l.horizonLineFromTop();return f.y<p}createInversionMatrix(l,f){return spe}createTileMatrix(l,f,p){let A,b,C;const M=p.canonical,N=Yf(new Float64Array(16));if(this.isReprojectedInTileSpace){const U=r0(M,this);A=1,b=U.x+p.wrap*U.scale,C=U.y,YA(N,N,[A/U.scale,A/U.scale,l.pixelsPerMeter/f])}else A=f/l.zoomScale(M.z),b=(M.x+Math.pow(2,M.z)*p.wrap)*A,C=M.y*A;return yx(N,N,[b,C,0]),YA(N,N,[A/Kn,A/Kn,1]),N}upVector(l,f,p){return[0,0,1]}upVectorScale(l,f,p){return{metersToTile:1}}}class ape extends tm{constructor(l){super(l),this.range=[4,7],this.center=l.center||[-96,37.5];const[f,p]=this.parallels=l.parallels||[29.5,45.5],A=Math.sin(me(f));this.n=(A+Math.sin(me(p)))/2,this.c=1+A*(2*this.n-A),this.r0=Math.sqrt(this.c)/this.n}project(l,f){const{n:p,c:A,r0:b}=this,C=me(l-this.center[0]),M=me(f),N=Math.sqrt(A-2*p*Math.sin(M))/p;return{x:N*Math.sin(C*p),y:N*Math.cos(C*p)-b,z:0}}unproject(l,f){const{n:p,c:A,r0:b}=this,C=b+f;let M=Math.atan2(l,Math.abs(C))*Math.sign(C);C*p<0&&(M-=Math.PI*Math.sign(l)*Math.sign(C));const N=me(this.center[0])*p;M=Re(M,-Math.PI-N,Math.PI-N);const U=be(Ce(M/p)+this.center[0],-180,180),W=Math.asin(be((A-(l*l+C*C)*p*p)/(2*p),-1,1)),K=be(Ce(W),-va,va);return new Ti(U,K)}}const Vx=1.340264,$x=-.081106,Hx=893e-6,Wx=.003796,eS=Math.sqrt(3)/2;class lpe extends tm{project(l,f){f=f/180*Math.PI,l=l/180*Math.PI;const p=Math.asin(eS*Math.sin(f)),A=p*p,b=A*A*A;return{x:.5*(l*Math.cos(p)/(eS*(Vx+3*$x*A+b*(7*Hx+9*Wx*A)))/Math.PI+.5),y:1-.5*(p*(Vx+$x*A+b*(Hx+Wx*A))/Math.PI+1),z:0}}unproject(l,f){l=(2*l-.5)*Math.PI;let p=f=(2*(1-f)-1)*Math.PI,A=p*p,b=A*A*A;for(let W,K,ee,oe=0;oe<12&&(K=p*(Vx+$x*A+b*(Hx+Wx*A))-f,ee=Vx+3*$x*A+b*(7*Hx+9*Wx*A),W=K/ee,p=be(p-W,-Math.PI/3,Math.PI/3),A=p*p,b=A*A*A,!(Math.abs(W)<1e-12));++oe);const C=eS*l*(Vx+3*$x*A+b*(7*Hx+9*Wx*A))/Math.cos(p),M=Math.asin(Math.sin(p)/eS),N=be(180*C/Math.PI,-180,180),U=be(180*M/Math.PI,-va,va);return new Ti(N,U)}}class upe extends tm{constructor(l){super(l),this.wrap=!0,this.supportsWorldCopies=!0}project(l,f){return{x:.5+l/360,y:.5-f/360,z:0}}unproject(l,f){const p=360*(l-.5),A=be(360*(.5-f),-va,va);return new Ti(p,A)}}const cy=Math.PI/2;function tS(c){return Math.tan((cy+c)/2)}class cpe extends tm{constructor(l){super(l),this.center=l.center||[0,30];const[f,p]=this.parallels=l.parallels||[30,30];let A=me(f),b=me(p);this.southernCenter=A+b<0,this.southernCenter&&(A=-A,b=-b);const C=Math.cos(A),M=tS(A);this.n=A===b?Math.sin(A):Math.log(C/Math.cos(b))/Math.log(tS(b)/M),this.f=C*Math.pow(tS(A),this.n)/this.n}project(l,f){f=me(f),this.southernCenter&&(f=-f),l=me(l-this.center[0]);const p=1e-6,{n:A,f:b}=this;b>0?f<-cy+p&&(f=-cy+p):f>cy-p&&(f=cy-p);const C=b/Math.pow(tS(f),A);let M=C*Math.sin(A*l),N=b-C*Math.cos(A*l);return M=.5*(M/Math.PI+.5),N=.5*(N/Math.PI+.5),{x:M,y:this.southernCenter?N:1-N,z:0}}unproject(l,f){l=(2*l-.5)*Math.PI,this.southernCenter&&(f=1-f),f=(2*(1-f)-.5)*Math.PI;const{n:p,f:A}=this,b=A-f,C=Math.sign(b),M=Math.sign(p)*Math.sqrt(l*l+b*b);let N=Math.atan2(l,Math.abs(b))*C;b*p<0&&(N-=Math.PI*Math.sign(l)*C);const U=be(Ce(N/p)+this.center[0],-180,180),W=be(Ce(2*Math.atan(Math.pow(A/M,1/p))-cy),-va,va);return new Ti(U,this.southernCenter?-W:W)}}class wj extends tm{constructor(l){super(l),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(l,f){return{x:od(l),y:sd(f),z:0}}unproject(l,f){const p=Ju(l),A=ya(f);return new Ti(p,A)}}const Ej=me(va);class fpe extends tm{project(l,f){const p=(f=me(f))*f,A=p*p;return{x:.5*((l=me(l))*(.8707-.131979*p+A*(A*(.003971*p-.001529*A)-.013791))/Math.PI+.5),y:1-.5*(f*(1.007226+p*(.015085+A*(.028874*p-.044475-.005916*A)))/Math.PI+1),z:0}}unproject(l,f){l=(2*l-.5)*Math.PI;let p=f=(2*(1-f)-1)*Math.PI,A=25,b=0,C=p*p;do{C=p*p;const U=C*C;b=(p*(1.007226+C*(.015085+U*(.028874*C-.044475-.005916*U)))-f)/(1.007226+C*(.045255+U*(.259866*C-.311325-.005916*11*U))),p=be(p-b,-Ej,Ej)}while(Math.abs(b)>1e-6&&--A>0);C=p*p;const M=be(Ce(l/(.8707+C*(C*(C*C*C*(.003971-.001529*C)-.013791)-.131979))),-180,180),N=Ce(p);return new Ti(M,N)}}const Sj=me(va);class hpe extends tm{project(l,f){f=me(f),l=me(l);const p=Math.cos(f),A=2/Math.PI,b=Math.acos(p*Math.cos(l/2)),C=Math.sin(b)/b,M=.5*(l*A+2*p*Math.sin(l/2)/C)||0,N=.5*(f+Math.sin(f)/C)||0;return{x:.5*(M/Math.PI+.5),y:1-.5*(N/Math.PI+1),z:0}}unproject(l,f){let p=l=(2*l-.5)*Math.PI,A=f=(2*(1-f)-1)*Math.PI,b=25;const C=1e-6;let M=0,N=0;do{const U=Math.cos(A),W=Math.sin(A),K=2*W*U,ee=W*W,oe=U*U,le=Math.cos(p/2),de=Math.sin(p/2),xe=2*le*de,Be=de*de,$e=1-oe*le*le,Ne=$e?1/$e:0,je=$e?Math.acos(U*le)*Math.sqrt(1/$e):0,Ze=.5*(2*je*U*de+2*p/Math.PI)-l,We=.5*(je*W+A)-f,bt=.5*Ne*(oe*Be+je*U*le*ee)+1/Math.PI,At=Ne*(xe*K/4-je*W*de),Ft=.125*Ne*(K*de-je*W*oe*xe),tn=.5*Ne*(ee*le+je*Be*U)+.5,Tt=At*Ft-tn*bt;M=(We*At-Ze*tn)/Tt,N=(Ze*Ft-We*bt)/Tt,p=be(p-M,-Math.PI,Math.PI),A=be(A-N,-Sj,Sj)}while((Math.abs(M)>C||Math.abs(N)>C)&&--b>0);return new Ti(Ce(p),Ce(A))}}class Tj extends tm{constructor(l){super(l),this.center=l.center||[0,0],this.parallels=l.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(me(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(l,f){const{scale:p,cosPhi:A}=this;return{x:me(l)*A*p+.5,y:-Math.sin(me(f))/A*p+.5,z:0}}unproject(l,f){const{scale:p,cosPhi:A}=this,b=-(f-.5)/p,C=be(Ce((l-.5)/p)/A,-180,180),M=Math.asin(be(b*A,-1,1)),N=be(Ce(M),-va,va);return new Ti(C,N)}}class dpe extends wj{constructor(l){super(l),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(l,f,p){const A=Cx(l,f,p);return Fo(A,A,Px(id(p))),{x:A[0],y:A[1],z:A[2]}}locationPoint(l,f){const p=Z_(f.lat,f.lng),A=ul([],p),b=l.elevation?l.elevation.getAtPointOrZero(l.locationCoordinate(f),l._centerAltitude):l._centerAltitude;wx(p,p,A,Kf(1,0)*Kn*b);const C=Yf(new Float64Array(16));return ZA(C,l.pixelMatrix,l.globeMatrix),Fo(p,p,C),new ie(p[0],p[1])}pixelsPerMeter(l,f){return Kf(1,0)*f}pixelSpaceConversion(l,f,p){const A=Kf(1,l)*f,b=jr(Kf(1,45)*f,A,p);return this.pixelsPerMeter(l,f)/b}createTileMatrix(l,f,p){const A=f3(id(p.canonical));return ZA(new Float64Array(16),l.globeMatrix,A)}createInversionMatrix(l,f){const{center:p}=l,A=Px(id(f));return I2(A,A,me(p.lng)),t3(A,A,me(p.lat)),YA(A,A,[l._pixelsPerMercatorPixel,l._pixelsPerMercatorPixel,1]),Float32Array.from(A)}pointCoordinate(l,f,p,A){return J8(l,f,p,!0)||new Q_(0,0)}pointCoordinate3D(l,f,p){const A=this.pointCoordinate(l,f,p,0);return[A.x,A.y,A.z]}isPointAboveHorizon(l,f){return!J8(l,f.x,f.y,!1)}farthestPixelDistance(l){const f=function(A,b){const C=A.cameraToCenterDistance,M=A._centerAltitude*b,N=A._camera,U=A._camera.forward(),W=Lp([],Ku([],U,-C),[0,0,M]),K=A.worldSize/(2*Math.PI),ee=[0,0,-K],oe=A.width/A.height,le=Math.tan(A.fovAboveCenter),de=Ku([],N.up(),le),xe=Ku([],N.right(),le*oe),Be=ul([],Lp([],Lp([],U,de),xe)),$e=[];let Ne;if(new o3(W,Be).closestPointOnSphere(ee,K,$e)){const je=Lp([],$e,ee),Ze=Qf([],je,W);Ne=Math.cos(A.fovAboveCenter)*vx(Ze)}else{const je=Qf([],W,ee),Ze=Qf([],ee,W);ul(Ze,Ze);const We=vx(je)-K;Ne=Math.sqrt(We*(We+2*K));const bt=Math.acos(Ne/(K+We))-Math.acos(qc(U,Ze));Ne*=Math.cos(bt)}return 1.01*Ne}(l,this.pixelsPerMeter(l.center.lat,l.worldSize)),p=Y_(l.zoom);if(p>0){const A=bj(l,Kf(1,l.center.lat)*l.worldSize),b=l.worldSize/(2*Math.PI),C=Math.max(l.width,l.height)/l.worldSize*Math.PI;return jr(f,A+b*(1-Math.cos(C)),Math.pow(p,10))}return f}upVector(l,f,p){return Cx(f,p,l,1)}upVectorScale(l){return{metersToTile:M2(R2(id(l)))}}}function Cj(c){const l=c.parallels,f=!!l&&Math.abs(l[0]+l[1])<.01;switch(c.name){case"mercator":return new wj(c);case"equirectangular":return new upe(c);case"naturalEarth":return new fpe(c);case"equalEarth":return new lpe(c);case"winkelTripel":return new hpe(c);case"albers":return f?new Tj(c):new ape(c);case"lambertConformalConic":return f?new Tj(c):new cpe(c);case"globe":return new dpe(c)}throw new Error(`Invalid projection name: ${c.name}`)}const ppe=j2.types,gpe=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function nS(c,l,f,p,A,b,C,M,N,U,W,K,ee){const oe=M?Math.min(em,Math.round(M[0])):0,le=M?Math.min(em,Math.round(M[1])):0;c.emplaceBack(l,f,Math.round(32*p),Math.round(32*A),b,C,(oe<<1)+(N?1:0),le,16*U,16*W,256*K,256*ee)}function rS(c,l,f,p,A,b,C){c.emplaceBack(l,f,p,A,b,C)}function iS(c,l,f,p,A){c.emplaceBack(l,f,p,A),c.emplaceBack(l,f,p,A),c.emplaceBack(l,f,p,A),c.emplaceBack(l,f,p,A)}function mpe(c){for(const l of c.sections)if(YL(l.text))return!0;return!1}class j3{constructor(l){this.layoutVertexArray=new Ht,this.indexArray=new Vn,this.programConfigurations=l,this.segments=new Wo,this.dynamicLayoutVertexArray=new Kt,this.opacityVertexArray=new Wn,this.placedSymbolArray=new Ho,this.globeExtVertexArray=new an}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(l,f,p,A){this.isEmpty()||(p&&(this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,Ede.members),this.indexBuffer=l.createIndexBuffer(this.indexArray,f),this.dynamicLayoutVertexBuffer=l.createVertexBuffer(this.dynamicLayoutVertexArray,Tde.members,!0),this.opacityVertexBuffer=l.createVertexBuffer(this.opacityVertexArray,gpe,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=l.createVertexBuffer(this.globeExtVertexArray,Sde.members,!0)),this.opacityVertexBuffer.itemSize=1),(p||A)&&this.programConfigurations.upload(l))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Mt(j3,"SymbolBuffers");class V3{constructor(l,f,p){this.layoutVertexArray=new l,this.layoutAttributes=f,this.indexArray=new p,this.segments=new Wo,this.collisionVertexArray=new Fr,this.collisionVertexArrayExt=new Nr}upload(l){this.layoutVertexBuffer=l.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=l.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=l.createVertexBuffer(this.collisionVertexArray,Cde.members,!0),this.collisionVertexBufferExt=l.createVertexBuffer(this.collisionVertexArrayExt,Pde.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Mt(V3,"CollisionBuffers");class nm{constructor(l){this.collisionBoxArray=l.collisionBoxArray,this.zoom=l.zoom,this.overscaling=l.overscaling,this.layers=l.layers,this.layerIds=this.layers.map(C=>C.id),this.index=l.index,this.pixelRatio=l.pixelRatio,this.sourceLayerIndex=l.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Yf([]),this.placementViewportMatrix=Yf([]);const f=this.layers[0]._unevaluatedLayout._values;this.textSizeData=O3(this.zoom,f["text-size"]),this.iconSizeData=O3(this.zoom,f["icon-size"]);const p=this.layers[0].layout,A=p.get("symbol-sort-key"),b=p.get("symbol-z-order");this.canOverlap=p.get("text-allow-overlap")||p.get("icon-allow-overlap")||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&A.constantOr(1)!==void 0,this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=p.get("text-writing-mode").map(C=>ec[C]),this.stateDependentLayerIds=this.layers.filter(C=>C.isStateDependent()).map(C=>C.id),this.sourceID=l.sourceID,this.projection=l.projection}createArrays(){this.text=new j3(new XA(this.layers,this.zoom,l=>/^text/.test(l))),this.icon=new j3(new XA(this.layers,this.zoom,l=>/^icon/.test(l))),this.glyphOffsetArray=new ll,this.lineVertexArray=new $_,this.symbolInstances=new Yi}calculateGlyphDependencies(l,f,p,A,b){for(let C=0;C<l.length;C++)if(f[l.charCodeAt(C)]=!0,A&&b){const M=zx[l.charAt(C)];M&&(f[M.charCodeAt(0)]=!0)}}populate(l,f,p,A){const b=this.layers[0],C=b.layout,M=this.projection.name==="globe",N=C.get("text-font"),U=C.get("text-field"),W=C.get("icon-image"),K=(U.value.kind!=="constant"||U.value.value instanceof da&&!U.value.value.isEmpty()||U.value.value.toString().length>0)&&(N.value.kind!=="constant"||N.value.value.length>0),ee=W.value.kind!=="constant"||!!W.value.value||Object.keys(W.parameters).length>0,oe=C.get("symbol-sort-key");if(this.features=[],!K&&!ee)return;const le=f.iconDependencies,de=f.glyphDependencies,xe=f.availableImages,Be=new Q(this.zoom);for(const{feature:$e,id:Ne,index:je,sourceLayerIndex:Ze}of l){const We=b._featureFilter.needGeometry,bt=e0($e,We);if(!b._featureFilter.filter(Be,bt,p))continue;if(We||(bt.geometry=Dp($e,p,A)),M&&$e.type!==1&&p.z<=5){const Tt=bt.geometry,Gt=.98078528056,jt=(Yt,ln)=>qc(Cx(Yt.x,Yt.y,p,1),Cx(ln.x,ln.y,p,1))<Gt;for(let Yt=0;Yt<Tt.length;Yt++)Tt[Yt]=The(Tt[Yt],jt)}let At,Ft;if(K){const Tt=b.getValueAndResolveTokens("text-field",bt,p,xe),Gt=da.factory(Tt);mpe(Gt)&&(this.hasRTLText=!0),(!this.hasRTLText||L()==="unavailable"||this.hasRTLText&&H.isParsed())&&(At=Ode(Gt,b,bt))}if(ee){const Tt=b.getValueAndResolveTokens("icon-image",bt,p,xe);Ft=Tt instanceof il?Tt:il.fromString(Tt)}if(!At&&!Ft)continue;const tn=this.sortFeaturesByKey?oe.evaluate(bt,{},p):void 0;if(this.features.push({id:Ne,text:At,icon:Ft,index:je,sourceLayerIndex:Ze,geometry:bt.geometry,properties:$e.properties,type:ppe[$e.type],sortKey:tn}),Ft&&(le[Ft.name]=!0),At){const Tt=N.evaluate(bt,{},p).join(","),Gt=C.get("text-rotation-alignment")==="map"&&C.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ec.vertical)>=0;for(const jt of At.sections)if(jt.image)le[jt.image.name]=!0;else{const Yt=xi(At.toString()),ln=jt.fontStack||Tt,Bt=de[ln]=de[ln]||{};this.calculateGlyphDependencies(jt.text,Bt,Gt,this.allowVerticalPlacement,Yt)}}}C.get("symbol-placement")==="line"&&(this.features=function($e){const Ne={},je={},Ze=[];let We=0;function bt(Tt){Ze.push($e[Tt]),We++}function At(Tt,Gt,jt){const Yt=je[Tt];return delete je[Tt],je[Gt]=Yt,Ze[Yt].geometry[0].pop(),Ze[Yt].geometry[0]=Ze[Yt].geometry[0].concat(jt[0]),Yt}function Ft(Tt,Gt,jt){const Yt=Ne[Gt];return delete Ne[Gt],Ne[Tt]=Yt,Ze[Yt].geometry[0].shift(),Ze[Yt].geometry[0]=jt[0].concat(Ze[Yt].geometry[0]),Yt}function tn(Tt,Gt,jt){const Yt=jt?Gt[0][Gt[0].length-1]:Gt[0][0];return`${Tt}:${Yt.x}:${Yt.y}`}for(let Tt=0;Tt<$e.length;Tt++){const Gt=$e[Tt],jt=Gt.geometry,Yt=Gt.text?Gt.text.toString():null;if(!Yt){bt(Tt);continue}const ln=tn(Yt,jt),Bt=tn(Yt,jt,!0);if(ln in je&&Bt in Ne&&je[ln]!==Ne[Bt]){const xn=Ft(ln,Bt,jt),zn=At(ln,Bt,Ze[xn].geometry);delete Ne[ln],delete je[Bt],je[tn(Yt,Ze[zn].geometry,!0)]=zn,Ze[xn].geometry=null}else ln in je?At(ln,Bt,jt):Bt in Ne?Ft(ln,Bt,jt):(bt(Tt),Ne[ln]=We-1,je[Bt]=We-1)}return Ze.filter(Tt=>Tt.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort(($e,Ne)=>$e.sortKey-Ne.sortKey)}update(l,f,p,A){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(l,f,this.layers,p,A),this.icon.programConfigurations.updatePaintArrays(l,f,this.layers,p,A))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(l){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(l),this.iconCollisionBox.upload(l)),this.text.upload(l,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(l,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Cj(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(l,f){const p=this.lineVertexArray.length;if(l.segment!==void 0)for(const{x:A,y:b}of f)this.lineVertexArray.emplaceBack(A,b);return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(l,f,p,A,b,C,M,N,U,W,K,ee,oe,le){const de=l.indexArray,xe=l.layoutVertexArray,Be=l.globeExtVertexArray,$e=l.segments.prepareSegment(4*f.length,xe,de,this.canOverlap?C.sortKey:void 0),Ne=this.glyphOffsetArray.length,je=$e.vertexLength,Ze=this.allowVerticalPlacement&&M===ec.vertical?Math.PI/2:0,We=C.text&&C.text.sections;for(let At=0;At<f.length;At++){const{tl:Ft,tr:tn,bl:Tt,br:Gt,tex:jt,pixelOffsetTL:Yt,pixelOffsetBR:ln,minFontScaleX:Bt,minFontScaleY:xn,glyphOffset:zn,isSDF:En,sectionIndex:Ar}=f[At],un=$e.vertexLength,Xn=zn[1];if(nS(xe,U.x,U.y,Ft.x,Xn+Ft.y,jt.x,jt.y,p,En,Yt.x,Yt.y,Bt,xn),nS(xe,U.x,U.y,tn.x,Xn+tn.y,jt.x+jt.w,jt.y,p,En,ln.x,Yt.y,Bt,xn),nS(xe,U.x,U.y,Tt.x,Xn+Tt.y,jt.x,jt.y+jt.h,p,En,Yt.x,ln.y,Bt,xn),nS(xe,U.x,U.y,Gt.x,Xn+Gt.y,jt.x+jt.w,jt.y+jt.h,p,En,ln.x,ln.y,Bt,xn),N){const{x:_r,y:ei,z:yr}=N.anchor,[nr,Hi,wr]=N.up;rS(Be,_r,ei,yr,nr,Hi,wr),rS(Be,_r,ei,yr,nr,Hi,wr),rS(Be,_r,ei,yr,nr,Hi,wr),rS(Be,_r,ei,yr,nr,Hi,wr),iS(l.dynamicLayoutVertexArray,_r,ei,yr,Ze)}else iS(l.dynamicLayoutVertexArray,U.x,U.y,U.z,Ze);de.emplaceBack(un,un+1,un+2),de.emplaceBack(un+1,un+2,un+3),$e.vertexLength+=4,$e.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(zn[0]),At!==f.length-1&&Ar===f[At+1].sectionIndex||l.programConfigurations.populatePaintArrays(xe.length,C,C.index,{},oe,le,We&&We[Ar])}const bt=N?N.anchor:U;l.placedSymbolArray.emplaceBack(bt.x,bt.y,bt.z,U.x,U.y,Ne,this.glyphOffsetArray.length-Ne,je,W,K,U.segment,p?p[0]:0,p?p[1]:0,A[0],A[1],M,0,!1,0,ee,0)}_commitLayoutVertex(l,f,p,A,b,C,M){l.emplaceBack(f,p,A,b,C,Math.round(M.x),Math.round(M.y))}_addCollisionDebugVertices(l,f,p,A,b,C,M){const N=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),U=N.vertexLength,W=M.tileAnchorX,K=M.tileAnchorY;for(let oe=0;oe<4;oe++)p.collisionVertexArray.emplaceBack(0,0,0,0);p.collisionVertexArrayExt.emplaceBack(f,-l.padding,-l.padding),p.collisionVertexArrayExt.emplaceBack(f,l.padding,-l.padding),p.collisionVertexArrayExt.emplaceBack(f,l.padding,l.padding),p.collisionVertexArrayExt.emplaceBack(f,-l.padding,l.padding),this._commitLayoutVertex(p.layoutVertexArray,A,b,C,W,K,new ie(l.x1,l.y1)),this._commitLayoutVertex(p.layoutVertexArray,A,b,C,W,K,new ie(l.x2,l.y1)),this._commitLayoutVertex(p.layoutVertexArray,A,b,C,W,K,new ie(l.x2,l.y2)),this._commitLayoutVertex(p.layoutVertexArray,A,b,C,W,K,new ie(l.x1,l.y2)),N.vertexLength+=4;const ee=p.indexArray;ee.emplaceBack(U,U+1),ee.emplaceBack(U+1,U+2),ee.emplaceBack(U+2,U+3),ee.emplaceBack(U+3,U),N.primitiveLength+=4}_addTextDebugCollisionBoxes(l,f,p,A,b,C){for(let M=A;M<b;M++){const N=p.get(M),U=this.getSymbolInstanceTextSize(l,C,f,M);this._addCollisionDebugVertices(N,U,this.textCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,C)}}_addIconDebugCollisionBoxes(l,f,p,A,b,C){for(let M=A;M<b;M++){const N=p.get(M),U=this.getSymbolInstanceIconSize(l,f,C.placedIconSymbolIndex);this._addCollisionDebugVertices(N,U,this.iconCollisionBox,N.projectedAnchorX,N.projectedAnchorY,N.projectedAnchorZ,C)}}generateCollisionDebugBuffers(l,f){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new V3(kn,WG.members,Ns),this.iconCollisionBox=new V3(kn,WG.members,Ns);const p=ny(this.iconSizeData,l),A=ny(this.textSizeData,l);for(let b=0;b<this.symbolInstances.length;b++){const C=this.symbolInstances.get(b);this._addTextDebugCollisionBoxes(A,l,f,C.textBoxStartIndex,C.textBoxEndIndex,C),this._addTextDebugCollisionBoxes(A,l,f,C.verticalTextBoxStartIndex,C.verticalTextBoxEndIndex,C),this._addIconDebugCollisionBoxes(p,l,f,C.iconBoxStartIndex,C.iconBoxEndIndex,C),this._addIconDebugCollisionBoxes(p,l,f,C.verticalIconBoxStartIndex,C.verticalIconBoxEndIndex,C)}}getSymbolInstanceTextSize(l,f,p,A){const b=this.text.placedSymbolArray.get(f.rightJustifiedTextSymbolIndex>=0?f.rightJustifiedTextSymbolIndex:f.centerJustifiedTextSymbolIndex>=0?f.centerJustifiedTextSymbolIndex:f.leftJustifiedTextSymbolIndex>=0?f.leftJustifiedTextSymbolIndex:f.verticalPlacedTextSymbolIndex>=0?f.verticalPlacedTextSymbolIndex:A),C=W2(this.textSizeData,l,b)/Qs;return this.tilePixelRatio*C}getSymbolInstanceIconSize(l,f,p){const A=this.icon.placedSymbolArray.get(p),b=W2(this.iconSizeData,l,A);return this.tilePixelRatio*b}_commitDebugCollisionVertexUpdate(l,f,p){l.emplaceBack(f,-p,-p),l.emplaceBack(f,p,-p),l.emplaceBack(f,p,p),l.emplaceBack(f,-p,p)}_updateTextDebugCollisionBoxes(l,f,p,A,b,C){for(let M=A;M<b;M++){const N=p.get(M),U=this.getSymbolInstanceTextSize(l,C,f,M);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,U,N.padding)}}_updateIconDebugCollisionBoxes(l,f,p,A,b,C){for(let M=A;M<b;M++){const N=p.get(M),U=this.getSymbolInstanceIconSize(l,f,C);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,U,N.padding)}}updateCollisionDebugBuffers(l,f){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const p=ny(this.iconSizeData,l),A=ny(this.textSizeData,l);for(let b=0;b<this.symbolInstances.length;b++){const C=this.symbolInstances.get(b);this._updateTextDebugCollisionBoxes(A,l,f,C.textBoxStartIndex,C.textBoxEndIndex,C),this._updateTextDebugCollisionBoxes(A,l,f,C.verticalTextBoxStartIndex,C.verticalTextBoxEndIndex,C),this._updateIconDebugCollisionBoxes(p,l,f,C.iconBoxStartIndex,C.iconBoxEndIndex,C.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(p,l,f,C.verticalIconBoxStartIndex,C.verticalIconBoxEndIndex,C.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(l,f,p,A,b,C,M,N,U){const W={};if(f<p){const{x1:K,y1:ee,x2:oe,y2:le,padding:de,projectedAnchorX:xe,projectedAnchorY:Be,projectedAnchorZ:$e,tileAnchorX:Ne,tileAnchorY:je,featureIndex:Ze}=l.get(f);W.textBox={x1:K,y1:ee,x2:oe,y2:le,padding:de,projectedAnchorX:xe,projectedAnchorY:Be,projectedAnchorZ:$e,tileAnchorX:Ne,tileAnchorY:je},W.textFeatureIndex=Ze}if(A<b){const{x1:K,y1:ee,x2:oe,y2:le,padding:de,projectedAnchorX:xe,projectedAnchorY:Be,projectedAnchorZ:$e,tileAnchorX:Ne,tileAnchorY:je,featureIndex:Ze}=l.get(A);W.verticalTextBox={x1:K,y1:ee,x2:oe,y2:le,padding:de,projectedAnchorX:xe,projectedAnchorY:Be,projectedAnchorZ:$e,tileAnchorX:Ne,tileAnchorY:je},W.verticalTextFeatureIndex=Ze}if(C<M){const{x1:K,y1:ee,x2:oe,y2:le,padding:de,projectedAnchorX:xe,projectedAnchorY:Be,projectedAnchorZ:$e,tileAnchorX:Ne,tileAnchorY:je,featureIndex:Ze}=l.get(C);W.iconBox={x1:K,y1:ee,x2:oe,y2:le,padding:de,projectedAnchorX:xe,projectedAnchorY:Be,projectedAnchorZ:$e,tileAnchorX:Ne,tileAnchorY:je},W.iconFeatureIndex=Ze}if(N<U){const{x1:K,y1:ee,x2:oe,y2:le,padding:de,projectedAnchorX:xe,projectedAnchorY:Be,projectedAnchorZ:$e,tileAnchorX:Ne,tileAnchorY:je,featureIndex:Ze}=l.get(N);W.verticalIconBox={x1:K,y1:ee,x2:oe,y2:le,padding:de,projectedAnchorX:xe,projectedAnchorY:Be,projectedAnchorZ:$e,tileAnchorX:Ne,tileAnchorY:je},W.verticalIconFeatureIndex=Ze}return W}deserializeCollisionBoxes(l){this.collisionArrays=[];for(let f=0;f<this.symbolInstances.length;f++){const p=this.symbolInstances.get(f);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(l,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(l,f){const p=l.placedSymbolArray.get(f),A=p.vertexStartIndex+4*p.numGlyphs;for(let b=p.vertexStartIndex;b<A;b+=4)l.indexArray.emplaceBack(b,b+1,b+2),l.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(l){if(this.sortedAngle===l&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const f=Math.sin(l),p=Math.cos(l),A=[],b=[],C=[];for(let M=0;M<this.symbolInstances.length;++M){C.push(M);const N=this.symbolInstances.get(M);A.push(0|Math.round(f*N.tileAnchorX+p*N.tileAnchorY)),b.push(N.featureIndex)}return C.sort((M,N)=>A[M]-A[N]||b[N]-b[M]),C}addToSortKeyRanges(l,f){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===f?p.symbolInstanceEnd=l+1:this.sortKeyRanges.push({sortKey:f,symbolInstanceStart:l,symbolInstanceEnd:l+1})}sortFeatures(l){if(this.sortFeaturesByY&&this.sortedAngle!==l&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(l),this.sortedAngle=l,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const f of this.symbolInstanceIndexes){const p=this.symbolInstances.get(f);this.featureSortOrder.push(p.featureIndex);const{rightJustifiedTextSymbolIndex:A,centerJustifiedTextSymbolIndex:b,leftJustifiedTextSymbolIndex:C,verticalPlacedTextSymbolIndex:M,placedIconSymbolIndex:N,verticalPlacedIconSymbolIndex:U}=p;A>=0&&this.addIndicesForPlacedSymbol(this.text,A),b>=0&&b!==A&&this.addIndicesForPlacedSymbol(this.text,b),C>=0&&C!==b&&C!==A&&this.addIndicesForPlacedSymbol(this.text,C),M>=0&&this.addIndicesForPlacedSymbol(this.text,M),N>=0&&this.addIndicesForPlacedSymbol(this.icon,N),U>=0&&this.addIndicesForPlacedSymbol(this.icon,U)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Mt(nm,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),nm.MAX_GLYPHS=65535,nm.addDynamicAttributes=iS;const Ape=new ke({"symbol-placement":new he(pt.layout_symbol["symbol-placement"]),"symbol-spacing":new he(pt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new he(pt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Se(pt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new he(pt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new he(pt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new he(pt.layout_symbol["icon-ignore-placement"]),"icon-optional":new he(pt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new he(pt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Se(pt.layout_symbol["icon-size"]),"icon-text-fit":new he(pt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new he(pt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Se(pt.layout_symbol["icon-image"]),"icon-rotate":new Se(pt.layout_symbol["icon-rotate"]),"icon-padding":new he(pt.layout_symbol["icon-padding"]),"icon-keep-upright":new he(pt.layout_symbol["icon-keep-upright"]),"icon-offset":new Se(pt.layout_symbol["icon-offset"]),"icon-anchor":new Se(pt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new he(pt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new he(pt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new he(pt.layout_symbol["text-rotation-alignment"]),"text-field":new Se(pt.layout_symbol["text-field"]),"text-font":new Se(pt.layout_symbol["text-font"]),"text-size":new Se(pt.layout_symbol["text-size"]),"text-max-width":new Se(pt.layout_symbol["text-max-width"]),"text-line-height":new Se(pt.layout_symbol["text-line-height"]),"text-letter-spacing":new Se(pt.layout_symbol["text-letter-spacing"]),"text-justify":new Se(pt.layout_symbol["text-justify"]),"text-radial-offset":new Se(pt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new he(pt.layout_symbol["text-variable-anchor"]),"text-anchor":new Se(pt.layout_symbol["text-anchor"]),"text-max-angle":new he(pt.layout_symbol["text-max-angle"]),"text-writing-mode":new he(pt.layout_symbol["text-writing-mode"]),"text-rotate":new Se(pt.layout_symbol["text-rotate"]),"text-padding":new he(pt.layout_symbol["text-padding"]),"text-keep-upright":new he(pt.layout_symbol["text-keep-upright"]),"text-transform":new Se(pt.layout_symbol["text-transform"]),"text-offset":new Se(pt.layout_symbol["text-offset"]),"text-allow-overlap":new he(pt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new he(pt.layout_symbol["text-ignore-placement"]),"text-optional":new he(pt.layout_symbol["text-optional"])});var $3={paint:new ke({"icon-opacity":new Se(pt.paint_symbol["icon-opacity"]),"icon-color":new Se(pt.paint_symbol["icon-color"]),"icon-halo-color":new Se(pt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Se(pt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Se(pt.paint_symbol["icon-halo-blur"]),"icon-translate":new he(pt.paint_symbol["icon-translate"]),"icon-translate-anchor":new he(pt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Se(pt.paint_symbol["text-opacity"]),"text-color":new Se(pt.paint_symbol["text-color"],{runtimeType:Os,getOverride:c=>c.textColor,hasOverride:c=>!!c.textColor}),"text-halo-color":new Se(pt.paint_symbol["text-halo-color"]),"text-halo-width":new Se(pt.paint_symbol["text-halo-width"]),"text-halo-blur":new Se(pt.paint_symbol["text-halo-blur"]),"text-translate":new he(pt.paint_symbol["text-translate"]),"text-translate-anchor":new he(pt.paint_symbol["text-translate-anchor"])}),layout:Ape};class Pj{constructor(l){this.type=l.property.overrides?l.property.overrides.runtimeType:cu,this.defaultValue=l}evaluate(l){if(l.formattedSection){const f=this.defaultValue.property.overrides;if(f&&f.hasOverride(l.formattedSection))return f.getOverride(l.formattedSection)}return l.feature&&l.featureState?this.defaultValue.evaluate(l.feature,l.featureState):this.defaultValue.property.specification.default}eachChild(l){this.defaultValue.isConstant()||l(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Mt(Pj,"FormatSectionOverride",{omit:["defaultValue"]});class oS extends Zf{constructor(l){super(l,$3)}recalculate(l,f){super.recalculate(l,f),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const p=this.layout.get("text-writing-mode");if(p){const A=[];for(const b of p)A.indexOf(b)<0&&A.push(b);this.layout._values["text-writing-mode"]=A}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(l,f,p,A){const b=this.layout.get(l).evaluate(f,{},p,A),C=this._unevaluatedLayout._values[l];return C.isDataDriven()||Zi(C.value)||!b?b:function(M,N){return N.replace(/{([^{}]+)}/g,(U,W)=>W in M?String(M[W]):"")}(f.properties,b)}createBucket(l){return new nm(l)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const l of $3.paint.overridableProperties){if(!oS.hasPaintOverride(this.layout,l))continue;const f=this.paint.get(l),p=new Pj(f),A=new wp(p,f.property.specification);let b=null;b=f.value.kind==="constant"||f.value.kind==="source"?new $A("source",A):new Ep("composite",A,f.value.zoomStops,f.value._interpolationType),this.paint._values[l]=new Pe(f.property,b,f.parameters)}}_handleOverridablePaintPropertyUpdate(l,f,p){return!(!this.layout||f.isDataDriven()||p.isDataDriven())&&oS.hasPaintOverride(this.layout,l)}static hasPaintOverride(l,f){const p=l.get("text-field"),A=$3.paint.properties[f];let b=!1;const C=M=>{for(const N of M)if(A.overrides&&A.overrides.hasOverride(N))return void(b=!0)};if(p.value.kind==="constant"&&p.value.value instanceof da)C(p.value.value.sections);else if(p.value.kind==="source"){const M=U=>{b||(U instanceof Ff&&Xi(U.value)===Ls?C(U.value.sections):U instanceof Xu?C(U.sections):U.eachChild(M))},N=p.value;N._styleExpression&&M(N._styleExpression.expression)}return b}getProgramConfiguration(l){return new Qg(this,l)}}var _pe={paint:new ke({"background-color":new he(pt.paint_background["background-color"]),"background-pattern":new he(pt.paint_background["background-pattern"]),"background-opacity":new he(pt.paint_background["background-opacity"])})},ype={paint:new ke({"raster-opacity":new he(pt.paint_raster["raster-opacity"]),"raster-hue-rotate":new he(pt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new he(pt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new he(pt.paint_raster["raster-brightness-max"]),"raster-saturation":new he(pt.paint_raster["raster-saturation"]),"raster-contrast":new he(pt.paint_raster["raster-contrast"]),"raster-resampling":new he(pt.paint_raster["raster-resampling"]),"raster-fade-duration":new he(pt.paint_raster["raster-fade-duration"])})};class vpe extends Zf{constructor(l){super(l,{}),this.implementation=l}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(l){this.implementation.onAdd&&this.implementation.onAdd(l,l.painter.context.gl)}onRemove(l){this.implementation.onRemove&&this.implementation.onRemove(l,l.painter.context.gl)}}var xpe={paint:new ke({"sky-type":new he(pt.paint_sky["sky-type"]),"sky-atmosphere-sun":new he(pt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new he(pt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new he(pt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new he(pt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Fe(pt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new he(pt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new he(pt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new he(pt.paint_sky["sky-opacity"])})};function H3(c,l,f){const p=[0,0,1],A=q8([]);return Z8(A,A,f?-me(c)+Math.PI:me(c)),X8(A,A,-me(l)),V8(p,p,A),ul(p,p)}const bpe={circle:class extends Zf{constructor(c){super(c,Lhe)}createBucket(c){return new A3(c)}queryRadius(c){const l=c;return K_("circle-radius",this,l)+K_("circle-stroke-width",this,l)+B2(this.paint.get("circle-translate"))}queryIntersectsFeature(c,l,f,p,A,b,C,M){const N=AG(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),U=this.paint.get("circle-radius").evaluate(l,f)+this.paint.get("circle-stroke-width").evaluate(l,f);return _G(c,p,b,C,M,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",N,U)}getProgramIds(){return["circle"]}getProgramConfiguration(c){return new Qg(this,c)}},heatmap:class extends Zf{createBucket(c){return new vG(c)}constructor(c){super(c,Fhe),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=x3({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(c){return K_("heatmap-radius",this,c)}queryIntersectsFeature(c,l,f,p,A,b,C,M){const N=this.paint.get("heatmap-radius").evaluate(l,f);return _G(c,p,b,C,M,!0,!0,new ie(0,0),N)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(c){return new Qg(this,c)}},hillshade:class extends Zf{constructor(c){super(c,khe)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends Zf{constructor(c){super(c,ede)}getProgramIds(){const c=this.paint.get("fill-pattern"),l=c&&c.constantOr(1),f=[l?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&f.push(l&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),f}getProgramConfiguration(c){return new Qg(this,c)}recalculate(c,l){super.recalculate(c,l);const f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(c){return new U2(c)}queryRadius(){return B2(this.paint.get("fill-translate"))}queryIntersectsFeature(c,l,f,p,A,b){return!c.queryGeometry.isAboveHorizon&&hG(mG(c.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),p)}isTileClipped(){return!0}},"fill-extrusion":class extends Zf{constructor(c){super(c,mde)}createBucket(c){return new Nx(c)}queryRadius(){return B2(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(c){return new Qg(this,c)}queryIntersectsFeature(c,l,f,p,A,b,C,M,N){const U=AG(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),W=this.paint.get("fill-extrusion-height").evaluate(l,f),K=this.paint.get("fill-extrusion-base").evaluate(l,f),ee=[0,0],oe=M&&b.elevation,le=b.elevation?b.elevation.exaggeration():1,de=c.tile.getBucket(this);if(oe&&de instanceof Nx){const je=de.centroidVertexArray,Ze=N+1;Ze<je.length&&(ee[0]=je.geta_centroid_pos0(Ze),ee[1]=je.geta_centroid_pos1(Ze))}if(ee[0]===0&&ee[1]===1)return!1;b.projection.name==="globe"&&(p=kG([p],[new ie(0,0),new ie(Kn,Kn)],c.tileID.canonical).map(je=>je.polygon).flat());const xe=oe?M:null,[Be,$e]=function(je,Ze,We,bt,At,Ft,tn,Tt,Gt,jt,Yt){return je.projection.name==="globe"?function(ln,Bt,xn,zn,En,Ar,un,Xn,_r,ei,yr){const nr=[],Hi=[],wr=ln.projection.upVectorScale(yr,ln.center.lat,ln.worldSize).metersToTile,Er=[0,0,0,1],Ci=[0,0,0,1],Di=(Pi,uo,To,Xo)=>{Pi[0]=uo,Pi[1]=To,Pi[2]=Xo,Pi[3]=1},Bi=FG();xn>0&&(xn+=Bi),zn+=Bi;for(const Pi of Bt){const uo=[],To=[];for(const Xo of Pi){const Ii=Xo.x+En.x,ds=Xo.y+En.y,Zo=ln.projection.projectTilePoint(Ii,ds,yr),_o=ln.projection.upVector(yr,Xo.x,Xo.y);let ri=xn,Yo=zn;if(un){const Ni=jG(Ii,ds,xn,zn,un,Xn,_r,ei);ri+=Ni.base,Yo+=Ni.top}xn!==0?Di(Er,Zo.x+_o[0]*wr*ri,Zo.y+_o[1]*wr*ri,Zo.z+_o[2]*wr*ri):Di(Er,Zo.x,Zo.y,Zo.z),Di(Ci,Zo.x+_o[0]*wr*Yo,Zo.y+_o[1]*wr*Yo,Zo.z+_o[2]*wr*Yo),Fo(Er,Er,Ar),Fo(Ci,Ci,Ar),uo.push(new ty(Er[0],Er[1],Er[2])),To.push(new ty(Ci[0],Ci[1],Ci[2]))}nr.push(uo),Hi.push(To)}return[nr,Hi]}(je,Ze,We,bt,At,Ft,tn,Tt,Gt,jt,Yt):tn?function(ln,Bt,xn,zn,En,Ar,un,Xn,_r){const ei=[],yr=[],nr=[0,0,0,1];for(const Hi of ln){const wr=[],Er=[];for(const Ci of Hi){const Di=Ci.x+zn.x,Bi=Ci.y+zn.y,Pi=jG(Di,Bi,Bt,xn,Ar,un,Xn,_r);nr[0]=Di,nr[1]=Bi,nr[2]=Pi.base,nr[3]=1,QA(nr,nr,En),nr[3]=Math.max(nr[3],1e-5);const uo=new ty(nr[0]/nr[3],nr[1]/nr[3],nr[2]/nr[3]);nr[0]=Di,nr[1]=Bi,nr[2]=Pi.top,nr[3]=1,QA(nr,nr,En),nr[3]=Math.max(nr[3],1e-5);const To=new ty(nr[0]/nr[3],nr[1]/nr[3],nr[2]/nr[3]);wr.push(uo),Er.push(To)}ei.push(wr),yr.push(Er)}return[ei,yr]}(Ze,We,bt,At,Ft,tn,Tt,Gt,jt):function(ln,Bt,xn,zn,En){const Ar=[],un=[],Xn=En[8]*Bt,_r=En[9]*Bt,ei=En[10]*Bt,yr=En[11]*Bt,nr=En[8]*xn,Hi=En[9]*xn,wr=En[10]*xn,Er=En[11]*xn;for(const Ci of ln){const Di=[],Bi=[];for(const Pi of Ci){const uo=Pi.x+zn.x,To=Pi.y+zn.y,Xo=En[0]*uo+En[4]*To+En[12],Ii=En[1]*uo+En[5]*To+En[13],ds=En[2]*uo+En[6]*To+En[14],Zo=En[3]*uo+En[7]*To+En[15],_o=Xo+Xn,ri=Ii+_r,Yo=ds+ei,Ni=Math.max(Zo+yr,1e-5),hl=Xo+nr,Qo=Ii+Hi,Ks=ds+wr,Fs=Math.max(Zo+Er,1e-5);Di.push(new ty(_o/Ni,ri/Ni,Yo/Ni)),Bi.push(new ty(hl/Fs,Qo/Fs,Ks/Fs))}Ar.push(Di),un.push(Bi)}return[Ar,un]}(Ze,We,bt,At,Ft)}(b,p,K,W,U,C,xe,ee,le,b.center.lat,c.tileID.canonical),Ne=c.queryGeometry;return function(je,Ze,We){let bt=1/0;hG(We,Ze)&&(bt=GG(We,Ze[0]));for(let At=0;At<Ze.length;At++){const Ft=Ze[At],tn=je[At];for(let Tt=0;Tt<Ft.length-1;Tt++){const Gt=Ft[Tt],jt=[Gt,Ft[Tt+1],tn[Tt+1],tn[Tt],Gt];fG(We,jt)&&(bt=Math.min(bt,GG(We,jt)))}}return bt!==1/0&&bt}(Be,$e,Ne.isPointQuery()?Ne.screenBounds:Ne.screenGeometry)}},line:class extends Zf{constructor(c){super(c,VG),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(c){if(c==="line-gradient"){const l=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=l._styleExpression&&l._styleExpression.expression instanceof DA,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(c,l){super.recalculate(c,l),this.paint._values["line-floorwidth"]=$G.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,c)}createBucket(c){return new H2(c)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(c){return new Qg(this,c)}queryRadius(c){const l=c,f=HG(K_("line-width",this,l),K_("line-gap-width",this,l)),p=K_("line-offset",this,l);return f/2+Math.abs(p)+B2(this.paint.get("line-translate"))}queryIntersectsFeature(c,l,f,p,A,b){if(c.queryGeometry.isAboveHorizon)return!1;const C=mG(c.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,c.pixelToTileUnitsFactor),M=c.pixelToTileUnitsFactor/2*HG(this.paint.get("line-width").evaluate(l,f),this.paint.get("line-gap-width").evaluate(l,f)),N=this.paint.get("line-offset").evaluate(l,f);return N&&(p=function(U,W){const K=[],ee=new ie(0,0);for(let oe=0;oe<U.length;oe++){const le=U[oe],de=[];for(let xe=0;xe<le.length;xe++){const Be=le[xe],$e=le[xe+1],Ne=xe===0?ee:Be.sub(le[xe-1])._unit()._perp(),je=xe===le.length-1?ee:$e.sub(Be)._unit()._perp(),Ze=Ne._add(je)._unit();Ze._mult(1/(Ze.x*je.x+Ze.y*je.y)),de.push(Ze._mult(W)._add(Be))}K.push(de)}return K}(p,N*c.pixelToTileUnitsFactor)),function(U,W,K){for(let ee=0;ee<W.length;ee++){const oe=W[ee];if(U.length>=3){for(let le=0;le<oe.length;le++)if(t0(U,oe[le]))return!0}if(Ihe(U,oe,K))return!0}return!1}(C,p,M)}isTileClipped(){return!0}},symbol:oS,background:class extends Zf{constructor(c){super(c,_pe)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Zf{constructor(c){super(c,ype)}getProgramIds(){return["raster"]}},sky:class extends Zf{constructor(c){super(c,xpe),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(c){c==="sky-gradient"?this._updateColorRamp():c!=="sky-atmosphere-sun"&&c!=="sky-atmosphere-halo-color"&&c!=="sky-atmosphere-color"&&c!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=x3({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(c){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const l=c.style.light.properties.get("position");return this._lightPosition.azimuthal!==l.azimuthal||this._lightPosition.polar!==l.polar}return!1}getCenter(c,l){if(this.paint.get("sky-type")==="atmosphere"){const p=this.paint.get("sky-atmosphere-sun"),A=!p,b=c.style.light,C=b.properties.get("position");return A&&b.properties.get("anchor")==="viewport"&&$t("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),A?H3(C.azimuthal,90-C.polar,l):H3(p[0],90-p[1],l)}const f=this.paint.get("sky-gradient-center");return H3(f[0],90-f[1],l)}is3D(){return!1}isSky(){return!0}markSkyboxValid(c){this._skyboxInvalidated=!1,this._lightPosition=c.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const c=this.paint.get("sky-type");return c==="atmosphere"?["skyboxCapture","skybox"]:c==="gradient"?["skyboxGradient"]:null}}};class qx{constructor(l,f,p,A){this.context=l,this.format=p,this.texture=l.gl.createTexture(),this.update(f,A)}update(l,f,p){const{width:A,height:b}=l,{context:C}=this,{gl:M}=C,{HTMLImageElement:N,HTMLCanvasElement:U,HTMLVideoElement:W,ImageData:K,ImageBitmap:ee}=u;if(M.bindTexture(M.TEXTURE_2D,this.texture),C.pixelStoreUnpackFlipY.set(!1),C.pixelStoreUnpack.set(1),C.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!f||f.premultiply!==!1)),p||this.size&&this.size[0]===A&&this.size[1]===b){const{x:oe,y:le}=p||{x:0,y:0};l instanceof N||l instanceof U||l instanceof W||l instanceof K||ee&&l instanceof ee?M.texSubImage2D(M.TEXTURE_2D,0,oe,le,M.RGBA,M.UNSIGNED_BYTE,l):M.texSubImage2D(M.TEXTURE_2D,0,oe,le,A,b,M.RGBA,M.UNSIGNED_BYTE,l.data)}else this.size=[A,b],l instanceof N||l instanceof U||l instanceof W||l instanceof K||ee&&l instanceof ee?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,l):M.texImage2D(M.TEXTURE_2D,0,this.format,A,b,0,this.format,M.UNSIGNED_BYTE,l.data);this.useMipmap=!!(f&&f.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&M.generateMipmap(M.TEXTURE_2D)}bind(l,f){const{context:p}=this,{gl:A}=p;A.bindTexture(A.TEXTURE_2D,this.texture),l!==this.filter&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,l),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,this.useMipmap?l===A.NEAREST?A.NEAREST_MIPMAP_NEAREST:A.LINEAR_MIPMAP_NEAREST:l),this.filter=l),f!==this.wrap&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,f),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,f),this.wrap=f)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}}class wpe{constructor(l){this._callback=l,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Epe{constructor(){this.tasks={},this.taskQueue=[],Zt(["process"],this),this.invoker=new wpe(this.process),this.nextId=0}add(l,f){const p=this.nextId++,A=function({type:b,isSymbolTile:C,zoom:M}){return M=M||0,b==="message"?0:b!=="maybePrepare"||C?b!=="parseTile"||C?b==="parseTile"&&C?300-M:b==="maybePrepare"&&C?400-M:500:200-M:100-M}(f);if(A===0){Ln();try{l()}finally{}return{cancel:()=>{}}}return this.tasks[p]={fn:l,metadata:f,priority:A,id:p},this.taskQueue.push(p),this.invoker.trigger(),{cancel:()=>{delete this.tasks[p]}}}process(){Ln();try{if(this.taskQueue=this.taskQueue.filter(p=>!!this.tasks[p]),!this.taskQueue.length)return;const l=this.pick();if(l===null)return;const f=this.tasks[l];if(delete this.tasks[l],this.taskQueue.length&&this.invoker.trigger(),!f)return;f.fn()}finally{}}pick(){let l=null,f=1/0;for(let A=0;A<this.taskQueue.length;A++){const b=this.tasks[this.taskQueue[A]];b.priority<f&&(f=b.priority,l=A)}if(l===null)return null;const p=this.taskQueue[l];return this.taskQueue.splice(l,1),p}remove(){this.invoker.remove()}}class Ij{constructor(l){this._stringToNumber={},this._numberToString=[];for(let f=0;f<l.length;f++){const p=l[f];this._stringToNumber[p]=f,this._numberToString[f]=p}}encode(l){return this._stringToNumber[l]}decode(l){return this._numberToString[l]}}const Spe=["tile","layer","source","sourceLayer","state"];class Mj{constructor(l,f,p,A,b){this.type="Feature",this._vectorTileFeature=l,this._z=f,this._x=p,this._y=A,this.properties=l.properties,this.id=b}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(l){this._geometry=l}toJSON(){const l={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(l.id=this.id);for(const f of Spe)this[f]!==void 0&&(l[f]=this[f]);return l}}const Yc=32,ad=33,rm=new Uint16Array(8184);for(let c=0;c<2046;c++){let l=c+2,f=0,p=0,A=0,b=0,C=0,M=0;for(1&l?A=b=C=Yc:f=p=M=Yc;(l>>=1)>1;){const U=f+A>>1,W=p+b>>1;1&l?(A=f,b=p,f=C,p=M):(f=A,p=b,A=C,b=M),C=U,M=W}const N=4*c;rm[N+0]=f,rm[N+1]=p,rm[N+2]=A,rm[N+3]=b}const ld=new Uint16Array(2178),im=new Uint8Array(1089),sS=new Uint16Array(1089);function Oj(c){return c===0?-.03125:c===32?.03125:0}var Rj=st([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Lj={type:2,extent:Kn,loadGeometry:()=>[[new ie(0,0),new ie(Kn+1,0),new ie(Kn+1,Kn+1),new ie(0,Kn+1),new ie(0,0)]]};class W3{constructor(l,f,p,A,b){this.tileID=l,this.uid=In(),this.uses=0,this.tileSize=f,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=b,this.expiredRequestCount=0,this.state="loading",A&&A.transform&&(this.projection=A.transform.projection)}registerFadeDuration(l){const f=l+this.timeAdded;f<Vo.now()||this.fadeEndTime&&f<this.fadeEndTime||(this.fadeEndTime=f)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=r0(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(l,f,p){if(this.unloadVectorData(),this.state="loaded",l){l.featureIndex&&(this.latestFeatureIndex=l.featureIndex,l.rawTileData?(this.latestRawTileData=l.rawTileData,this.latestFeatureIndex.rawTileData=l.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=l.collisionBoxArray,this.buckets=function(A,b){const C={};if(!b)return C;for(const M of A){const N=M.layerIds.map(U=>b.getLayer(U)).filter(Boolean);if(N.length!==0){M.layers=N,M.stateDependentLayerIds&&(M.stateDependentLayers=M.stateDependentLayerIds.map(U=>N.filter(W=>W.id===U)[0]));for(const U of N)C[U.id]=M}}return C}(l.buckets,f.style),this.hasSymbolBuckets=!1;for(const A in this.buckets){const b=this.buckets[A];if(b instanceof nm){if(this.hasSymbolBuckets=!0,!p)break;b.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const A in this.buckets){const b=this.buckets[A];if(b instanceof nm&&b.hasRTLText){this.hasRTLText=!0,H.isLoading()||H.isLoaded()||L()!=="deferred"||$();break}}this.queryPadding=0;for(const A in this.buckets){const b=this.buckets[A];this.queryPadding=Math.max(this.queryPadding,f.style.getLayer(A).queryRadius(b))}l.imageAtlas&&(this.imageAtlas=l.imageAtlas),l.glyphAtlasImage&&(this.glyphAtlasImage=l.glyphAtlasImage),l.lineAtlas&&(this.lineAtlas=l.lineAtlas)}else this.collisionBoxArray=new Si}unloadVectorData(){if(this.hasData()){for(const l in this.buckets)this.buckets[l].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(l){return this.buckets[l.id]}upload(l){for(const p in this.buckets){const A=this.buckets[p];A.uploadPending()&&A.upload(l)}const f=l.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new qx(l,this.imageAtlas.image,f.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new qx(l,this.glyphAtlasImage,f.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new qx(l,this.lineAtlas.image,f.ALPHA),this.lineAtlas.uploaded=!0)}prepare(l){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(l,this.imageAtlasTexture)}queryRenderedFeatures(l,f,p,A,b,C,M,N){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:A,pixelPosMatrix:M,transform:C,params:b,tileTransform:this.tileTransform},l,f,p):{}}querySourceFeatures(l,f){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const A=p.loadVTLayers(),b=f?f.sourceLayer:"",C=A._geojsonTileLayer||A[b];if(!C)return;const M=ma(f&&f.filter),{z:N,x:U,y:W}=this.tileID.canonical,K={z:N,x:U,y:W};for(let ee=0;ee<C.length;ee++){const oe=C.feature(ee);if(M.needGeometry){const xe=e0(oe,!0);if(!M.filter(new Q(this.tileID.overscaledZ),xe,this.tileID.canonical))continue}else if(!M.filter(new Q(this.tileID.overscaledZ),oe))continue;const le=p.getId(oe,b),de=new Mj(oe,N,U,W,le);de.tile=K,l.push(de)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(l){const f=this.expirationTime;if(l.cacheControl){const p=qn(l.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else l.expires&&(this.expirationTime=new Date(l.expires).getTime());if(this.expirationTime){const p=Date.now();let A=!1;if(this.expirationTime>p)A=!1;else if(f)if(this.expirationTime<f)A=!0;else{const b=this.expirationTime-f;b?this.expirationTime=p+Math.max(b,3e4):A=!0}else A=!0;A?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(l,f){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(l).length===0||!f)return;const p=this.latestFeatureIndex.loadVTLayers(),A=f.style.listImages();for(const b in this.buckets){if(!f.style.hasLayer(b))continue;const C=this.buckets[b],M=C.layers[0].sourceLayer||"_geojsonTileLayer",N=p[M],U=l[M];if(!N||!U||Object.keys(U).length===0)continue;if(C.update(U,N,A,this.imageAtlas&&this.imageAtlas.patternPositions||{}),C instanceof H2||C instanceof U2){const K=f.style._getSourceCache(C.layers[0].source);f._terrain&&f._terrain.enabled&&K&&C.programConfigurations.needsUpload&&f._terrain._clearRenderCacheForTile(K.id,this.tileID)}const W=f&&f.style&&f.style.getLayer(b);W&&(this.queryPadding=Math.max(this.queryPadding,W.queryRadius(C)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Vo.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(l){this.symbolFadeHoldUntil=Vo.now()+l}setTexture(l,f){const p=f.context,A=p.gl;this.texture=this.texture||f.getTileTexture(l.width),this.texture?this.texture.update(l,{useMipmap:!0}):(this.texture=new qx(p,l,A.RGBA,{useMipmap:!0}),this.texture.bind(A.LINEAR,A.CLAMP_TO_EDGE))}setDependencies(l,f){const p={};for(const A of f)p[A]=!0;this.dependencies[l]=p}hasDependency(l,f){for(const p of l){const A=this.dependencies[p];if(A){for(const b of f)if(A[b])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(l,f){if(!f||f.name==="mercator"||this._tileDebugBuffer)return;const p=Dp(Lj,this.tileID.canonical,this.tileTransform)[0],A=new en,b=new pu;for(let C=0;C<p.length;C++){const{x:M,y:N}=p[C];A.emplaceBack(M,N),b.emplaceBack(C)}b.emplaceBack(0),this._tileDebugIndexBuffer=l.createIndexBuffer(b),this._tileDebugBuffer=l.createVertexBuffer(A,Sx.members),this._tileDebugSegments=Wo.simpleSegment(0,0,A.length,b.length)}_makeTileBoundsBuffers(l,f){if(this._tileBoundsBuffer||!f||f.name==="mercator")return;const p=Dp(Lj,this.tileID.canonical,this.tileTransform)[0];let A,b;if(this.isRaster){const C=function(M,N){const U=r0(M,N),W=Math.pow(2,M.z);for(let xe=0;xe<ad;xe++)for(let Be=0;Be<ad;Be++){const $e=Ju((M.x+(Be+Oj(Be))/Yc)/W),Ne=ya((M.y+(xe+Oj(xe))/Yc)/W),je=N.project($e,Ne),Ze=xe*ad+Be;ld[2*Ze+0]=Math.round((je.x*U.scale-U.x)*Kn),ld[2*Ze+1]=Math.round((je.y*U.scale-U.y)*Kn)}im.fill(0),sS.fill(0);for(let xe=2045;xe>=0;xe--){const Be=4*xe,$e=rm[Be+0],Ne=rm[Be+1],je=rm[Be+2],Ze=rm[Be+3],We=$e+je>>1,bt=Ne+Ze>>1,At=We+bt-Ne,Ft=bt+$e-We,tn=Ne*ad+$e,Tt=Ze*ad+je,Gt=bt*ad+We,jt=Math.hypot((ld[2*tn+0]+ld[2*Tt+0])/2-ld[2*Gt+0],(ld[2*tn+1]+ld[2*Tt+1])/2-ld[2*Gt+1])>=16;im[Gt]=im[Gt]||(jt?1:0),xe<1022&&(im[Gt]=im[Gt]||im[(Ne+Ft>>1)*ad+($e+At>>1)]||im[(Ze+Ft>>1)*ad+(je+At>>1)])}const K=new Ut,ee=new Vn;let oe=0;function le(xe,Be){const $e=Be*ad+xe;return sS[$e]===0&&(K.emplaceBack(ld[2*$e+0],ld[2*$e+1],xe*Kn/Yc,Be*Kn/Yc),sS[$e]=++oe),sS[$e]-1}function de(xe,Be,$e,Ne,je,Ze){const We=xe+$e>>1,bt=Be+Ne>>1;if(Math.abs(xe-je)+Math.abs(Be-Ze)>1&&im[bt*ad+We])de(je,Ze,xe,Be,We,bt),de($e,Ne,je,Ze,We,bt);else{const At=le(xe,Be),Ft=le($e,Ne),tn=le(je,Ze);ee.emplaceBack(At,Ft,tn)}}return de(0,0,Yc,Yc,Yc,0),de(Yc,Yc,0,0,0,Yc),{vertices:K,indices:ee}}(this.tileID.canonical,f);A=C.vertices,b=C.indices}else{A=new Ut,b=new Vn;for(const{x:M,y:N}of p)A.emplaceBack(M,N,0,0);const C=T3(A.int16,void 0,4);for(let M=0;M<C.length;M+=3)b.emplaceBack(C[M],C[M+1],C[M+2])}this._tileBoundsBuffer=l.createVertexBuffer(A,Rj.members),this._tileBoundsIndexBuffer=l.createIndexBuffer(b),this._tileBoundsSegments=Wo.simpleSegment(0,0,A.length,b.length)}_makeGlobeTileDebugBuffers(l,f){const p=f.projection;if(!p||p.name!=="globe"||f.freezeTileCoverage)return;const A=this.tileID.canonical,b=Px(eG(A,f)),C=Y_(f.zoom);let M;C>0&&(M=e3(new Float64Array(16),f.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(l,A,f,b,M,C),this._makeGlobeTileDebugTextBuffer(l,A,f,b,M,C)}_globePoint(l,f,p,A,b,C,M){let N=Cx(l,f,p);if(C){const U=1<<p.z,W=od(A.center.lng),K=sd(A.center.lat),ee=(p.x+.5)/U-W;let oe=0;ee>.5?oe=-1:ee<-.5&&(oe=1);let le=(l/Kn+p.x)/U+oe,de=(f/Kn+p.y)/U;le=(le-W)*A._pixelsPerMercatorPixel+W,de=(de-K)*A._pixelsPerMercatorPixel+K;const xe=[le*A.worldSize,de*A.worldSize,0];Fo(xe,xe,C),N=JA(N,xe,M)}return Fo(N,N,b)}_makeGlobeTileDebugBorderBuffer(l,f,p,A,b,C){const M=new en,N=new pu,U=new mt,W=(ee,oe,le,de,xe)=>{const Be=(le-ee)/(xe-1),$e=(de-oe)/(xe-1),Ne=M.length;for(let je=0;je<xe;je++){const Ze=ee+je*Be,We=oe+je*$e;M.emplaceBack(Ze,We);const bt=this._globePoint(Ze,We,f,p,A,b,C);U.emplaceBack(bt[0],bt[1],bt[2]),N.emplaceBack(Ne+je)}},K=Kn;W(0,0,K,0,16),W(K,0,K,K,16),W(K,K,0,K,16),W(0,K,0,0,16),this._tileDebugIndexBuffer=l.createIndexBuffer(N),this._tileDebugBuffer=l.createVertexBuffer(M,Sx.members),this._globeTileDebugBorderBuffer=l.createVertexBuffer(U,Q8.members),this._tileDebugSegments=Wo.simpleSegment(0,0,M.length,N.length)}_makeGlobeTileDebugTextBuffer(l,f,p,A,b,C){const M=Kn/4,N=new en,U=new Vn,W=new mt,K=25;U.reserve(32),N.reserve(K),W.reserve(K);const ee=(oe,le)=>K*oe+le;for(let oe=0;oe<K;oe++){const le=oe*M;for(let de=0;de<K;de++){const xe=de*M;N.emplaceBack(xe,le);const Be=this._globePoint(xe,le,f,p,A,b,C);W.emplaceBack(Be[0],Be[1],Be[2])}}for(let oe=0;oe<4;oe++)for(let le=0;le<4;le++){const de=ee(oe,le),xe=ee(oe,le+1),Be=ee(oe+1,le),$e=ee(oe+1,le+1);U.emplaceBack(de,xe,Be),U.emplaceBack(Be,xe,$e)}this._tileDebugTextIndexBuffer=l.createIndexBuffer(U),this._tileDebugTextBuffer=l.createVertexBuffer(N,Sx.members),this._globeTileDebugTextBuffer=l.createVertexBuffer(W,Q8.members),this._tileDebugTextSegments=Wo.simpleSegment(0,0,K,32)}}class Tpe{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(l,f,p){const A=String(f);if(this.stateChanges[l]=this.stateChanges[l]||{},this.stateChanges[l][A]=this.stateChanges[l][A]||{},Ct(this.stateChanges[l][A],p),this.deletedStates[l]===null){this.deletedStates[l]={};for(const b in this.state[l])b!==A&&(this.deletedStates[l][b]=null)}else if(this.deletedStates[l]&&this.deletedStates[l][A]===null){this.deletedStates[l][A]={};for(const b in this.state[l][A])p[b]||(this.deletedStates[l][A][b]=null)}else for(const b in p)this.deletedStates[l]&&this.deletedStates[l][A]&&this.deletedStates[l][A][b]===null&&delete this.deletedStates[l][A][b]}removeFeatureState(l,f,p){if(this.deletedStates[l]===null)return;const A=String(f);if(this.deletedStates[l]=this.deletedStates[l]||{},p&&f!==void 0)this.deletedStates[l][A]!==null&&(this.deletedStates[l][A]=this.deletedStates[l][A]||{},this.deletedStates[l][A][p]=null);else if(f!==void 0)if(this.stateChanges[l]&&this.stateChanges[l][A])for(p in this.deletedStates[l][A]={},this.stateChanges[l][A])this.deletedStates[l][A][p]=null;else this.deletedStates[l][A]=null;else this.deletedStates[l]=null}getState(l,f){const p=String(f),A=Ct({},(this.state[l]||{})[p],(this.stateChanges[l]||{})[p]);if(this.deletedStates[l]===null)return{};if(this.deletedStates[l]){const b=this.deletedStates[l][f];if(b===null)return{};for(const C in b)delete A[C]}return A}initializeTileState(l,f){l.setFeatureState(this.state,f)}coalesceChanges(l,f){const p={};for(const A in this.stateChanges){this.state[A]=this.state[A]||{};const b={};for(const C in this.stateChanges[A])this.state[A][C]||(this.state[A][C]={}),Ct(this.state[A][C],this.stateChanges[A][C]),b[C]=this.state[A][C];p[A]=b}for(const A in this.deletedStates){this.state[A]=this.state[A]||{};const b={};if(this.deletedStates[A]===null)for(const C in this.state[A])b[C]={},this.state[A][C]={};else for(const C in this.deletedStates[A]){if(this.deletedStates[A][C]===null)this.state[A][C]={};else if(this.state[A][C])for(const M of Object.keys(this.deletedStates[A][C]))delete this.state[A][C][M];b[C]=this.state[A][C]}p[A]=p[A]||{},Ct(p[A],b)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const A in l)l[A].setFeatureState(p,f)}}class Dj{constructor(l){this.size=l,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(l,f){const p=this.toIdx(l,f);return{min:this.minimums[p],max:this.maximums[p]}}isLeaf(l,f){return this.leaves[this.toIdx(l,f)]}toIdx(l,f){return f*this.size+l}}function Bj(c,l,f,p){let A=0,b=Number.MAX_VALUE;for(let C=0;C<3;C++)if(Math.abs(p[C])<1e-15){if(f[C]<c[C]||f[C]>l[C])return null}else{const M=1/p[C];let N=(c[C]-f[C])*M,U=(l[C]-f[C])*M;if(N>U){const W=N;N=U,U=W}if(N>A&&(A=N),U<b&&(b=U),A>b)return null}return A}function Nj(c,l,f,p,A,b,C,M,N,U,W){const K=p-c,ee=A-l,oe=b-f,le=C-c,de=M-l,xe=N-f,Be=W[1]*xe-W[2]*de,$e=W[2]*le-W[0]*xe,Ne=W[0]*de-W[1]*le,je=K*Be+ee*$e+oe*Ne;if(Math.abs(je)<1e-15)return null;const Ze=1/je,We=U[0]-c,bt=U[1]-l,At=U[2]-f,Ft=(We*Be+bt*$e+At*Ne)*Ze;if(Ft<0||Ft>1)return null;const tn=bt*oe-At*ee,Tt=At*K-We*oe,Gt=We*ee-bt*K,jt=(W[0]*tn+W[1]*Tt+W[2]*Gt)*Ze;return jt<0||Ft+jt>1?null:(le*tn+de*Tt+xe*Gt)*Ze}function Fj(c,l,f){return(c-l)/(f-l)}function kj(c,l,f,p,A,b,C,M,N){const U=1<<f,W=b-p,K=C-A,ee=(c+1)/U*W+p,oe=(l+0)/U*K+A,le=(l+1)/U*K+A;M[0]=(c+0)/U*W+p,M[1]=oe,N[0]=ee,N[1]=le}class zj{constructor(l){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=l,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const f=function(b){const C=Math.ceil(Math.log2(b.dim/8)),M=[];let N=Math.ceil(Math.pow(2,C));const U=1/N,W=(oe,le,de,xe,Be)=>{const $e=xe?1:0,Ne=(oe+1)*de-$e,je=le*de,Ze=(le+1)*de-$e;Be[0]=oe*de,Be[1]=je,Be[2]=Ne,Be[3]=Ze};let K=new Dj(N);const ee=[];for(let oe=0;oe<N*N;oe++){W(oe%N,Math.floor(oe/N),U,!1,ee);const le=om(ee[0],ee[1],b),de=om(ee[2],ee[1],b),xe=om(ee[2],ee[3],b),Be=om(ee[0],ee[3],b);K.minimums.push(Math.min(le,de,xe,Be)),K.maximums.push(Math.max(le,de,xe,Be)),K.leaves.push(1)}for(M.push(K),N/=2;N>=1;N/=2){const oe=M[M.length-1];K=new Dj(N);for(let le=0;le<N*N;le++){W(le%N,Math.floor(le/N),2,!0,ee);const de=oe.getElevation(ee[0],ee[1]),xe=oe.getElevation(ee[2],ee[1]),Be=oe.getElevation(ee[2],ee[3]),$e=oe.getElevation(ee[0],ee[3]),Ne=oe.isLeaf(ee[0],ee[1]),je=oe.isLeaf(ee[2],ee[1]),Ze=oe.isLeaf(ee[2],ee[3]),We=oe.isLeaf(ee[0],ee[3]),bt=Math.min(de.min,xe.min,Be.min,$e.min),At=Math.max(de.max,xe.max,Be.max,$e.max),Ft=Ne&&je&&Ze&&We;K.maximums.push(At),K.minimums.push(bt),K.leaves.push(At-bt<=5&&Ft?1:0)}M.push(K)}return M}(this.dem),p=f.length-1,A=f[p];this._addNode(A.minimums[0],A.maximums[0],A.leaves[0]),this._construct(f,0,0,p,0)}raycastRoot(l,f,p,A,b,C,M=1){return Bj([l,f,-100],[p,A,this.maximums[0]*M],b,C)}raycast(l,f,p,A,b,C,M=1){if(!this.nodeCount)return null;const N=this.raycastRoot(l,f,p,A,b,C,M);if(N==null)return null;const U=[],W=[],K=[],ee=[],oe=[{idx:0,t:N,nodex:0,nodey:0,depth:0}];for(;oe.length>0;){const{idx:le,t:de,nodex:xe,nodey:Be,depth:$e}=oe.pop();if(this.leaves[le]){kj(xe,Be,$e,l,f,p,A,K,ee);const je=1<<$e,Ze=(xe+0)/je,We=(xe+1)/je,bt=(Be+0)/je,At=(Be+1)/je,Ft=om(Ze,bt,this.dem)*M,tn=om(We,bt,this.dem)*M,Tt=om(We,At,this.dem)*M,Gt=om(Ze,At,this.dem)*M,jt=Nj(K[0],K[1],Ft,ee[0],K[1],tn,ee[0],ee[1],Tt,b,C),Yt=Nj(ee[0],ee[1],Tt,K[0],ee[1],Gt,K[0],K[1],Ft,b,C),ln=Math.min(jt!==null?jt:Number.MAX_VALUE,Yt!==null?Yt:Number.MAX_VALUE);if(ln!==Number.MAX_VALUE)return ln;{const Bt=wx([],b,C,de);if(Uj(Ft,tn,Gt,Tt,Fj(Bt[0],K[0],ee[0]),Fj(Bt[1],K[1],ee[1]))>=Bt[2])return de}continue}let Ne=0;for(let je=0;je<this._siblingOffset.length;je++){kj((xe<<1)+this._siblingOffset[je][0],(Be<<1)+this._siblingOffset[je][1],$e+1,l,f,p,A,K,ee),K[2]=-100,ee[2]=this.maximums[this.childOffsets[le]+je]*M;const Ze=Bj(K,ee,b,C);if(Ze!=null){const We=Ze;U[je]=We;let bt=!1;for(let At=0;At<Ne&&!bt;At++)We>=U[W[At]]&&(W.splice(At,0,je),bt=!0);bt||(W[Ne]=je),Ne++}}for(let je=0;je<Ne;je++){const Ze=W[je];oe.push({idx:this.childOffsets[le]+Ze,t:U[Ze],nodex:(xe<<1)+this._siblingOffset[Ze][0],nodey:(Be<<1)+this._siblingOffset[Ze][1],depth:$e+1})}}return null}_addNode(l,f,p){return this.minimums.push(l),this.maximums.push(f),this.leaves.push(p),this.childOffsets.push(0),this.nodeCount++}_construct(l,f,p,A,b){if(l[A].isLeaf(f,p)===1)return;this.childOffsets[b]||(this.childOffsets[b]=this.nodeCount);const C=A-1,M=l[C];let N=0,U=0;for(let W=0;W<this._siblingOffset.length;W++){const K=2*f+this._siblingOffset[W][0],ee=2*p+this._siblingOffset[W][1],oe=M.getElevation(K,ee),le=M.isLeaf(K,ee),de=this._addNode(oe.min,oe.max,le);le&&(N|=1<<W),U||(U=de)}for(let W=0;W<this._siblingOffset.length;W++)N&1<<W||this._construct(l,2*f+this._siblingOffset[W][0],2*p+this._siblingOffset[W][1],C,U+W)}}function Uj(c,l,f,p,A,b){return jr(jr(c,f,b),jr(l,p,b),A)}function om(c,l,f){const p=f.dim,A=be(c*p-.5,0,p-1),b=be(l*p-.5,0,p-1),C=Math.floor(A),M=Math.floor(b),N=Math.min(C+1,p-1),U=Math.min(M+1,p-1);return Uj(f.get(C,M),f.get(N,M),f.get(C,U),f.get(N,U),A-C,b-M)}const Gj={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Cpe(c,l,f){return(256*c*256+256*l+f)/10-1e4}function Ppe(c,l,f){return 256*c+l+f/256-32768}class aS{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(l,f,p,A=!1,b=!1){if(this.uid=l,f.height!==f.width)throw new RangeError("DEM tiles must be square");if(p&&p!=="mapbox"&&p!=="terrarium")return $t(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=f.height;const C=this.dim=f.height-2,M=new Uint32Array(f.data.buffer);if(this.pixels=new Uint8Array(f.data.buffer),this.encoding=p||"mapbox",this.borderReady=A,!A){for(let N=0;N<C;N++)M[this._idx(-1,N)]=M[this._idx(0,N)],M[this._idx(C,N)]=M[this._idx(C-1,N)],M[this._idx(N,-1)]=M[this._idx(N,0)],M[this._idx(N,C)]=M[this._idx(N,C-1)];M[this._idx(-1,-1)]=M[this._idx(0,0)],M[this._idx(C,-1)]=M[this._idx(C-1,0)],M[this._idx(-1,C)]=M[this._idx(0,C-1)],M[this._idx(C,C)]=M[this._idx(C-1,C-1)],b&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new zj(this)}get(l,f,p=!1){p&&(l=be(l,-1,this.dim),f=be(f,-1,this.dim));const A=4*this._idx(l,f);return(this.encoding==="terrarium"?Ppe:Cpe)(this.pixels[A],this.pixels[A+1],this.pixels[A+2])}static getUnpackVector(l){return Gj[l]}get unpackVector(){return Gj[this.encoding]}_idx(l,f){if(l<-1||l>=this.dim+1||f<-1||f>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(f+1)*this.stride+(l+1)}static pack(l,f){const p=[0,0,0,0],A=aS.getUnpackVector(f);let b=Math.floor((l+A[3])/A[2]);return p[2]=b%256,b=Math.floor(b/256),p[1]=b%256,b=Math.floor(b/256),p[0]=b,p}getPixels(){return new mu({width:this.stride,height:this.stride},this.pixels)}backfillBorder(l,f,p){if(this.dim!==l.dim)throw new Error("dem dimension mismatch");let A=f*this.dim,b=f*this.dim+this.dim,C=p*this.dim,M=p*this.dim+this.dim;switch(f){case-1:A=b-1;break;case 1:b=A+1}switch(p){case-1:C=M-1;break;case 1:M=C+1}const N=-f*this.dim,U=-p*this.dim;for(let W=C;W<M;W++)for(let K=A;K<b;K++){const ee=4*this._idx(K,W),oe=4*this._idx(K+N,W+U);this.pixels[ee+0]=l.pixels[oe+0],this.pixels[ee+1]=l.pixels[oe+1],this.pixels[ee+2]=l.pixels[oe+2],this.pixels[ee+3]=l.pixels[oe+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Mt(aS,"DEMData"),Mt(zj,"DemMinMaxQuadTree",{omit:["dem"]});class Ipe{constructor(l,f){this.max=l,this.onRemove=f,this.reset()}reset(){for(const l in this.data)for(const f of this.data[l])f.timeout&&clearTimeout(f.timeout),this.onRemove(f.value);return this.data={},this.order=[],this}add(l,f,p){const A=l.wrapped().key;this.data[A]===void 0&&(this.data[A]=[]);const b={value:f,timeout:void 0};if(p!==void 0&&(b.timeout=setTimeout(()=>{this.remove(l,b)},p)),this.data[A].push(b),this.order.push(A),this.order.length>this.max){const C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this}has(l){return l.wrapped().key in this.data}getAndRemove(l){return this.has(l)?this._getAndRemoveByKey(l.wrapped().key):null}_getAndRemoveByKey(l){const f=this.data[l].shift();return f.timeout&&clearTimeout(f.timeout),this.data[l].length===0&&delete this.data[l],this.order.splice(this.order.indexOf(l),1),f.value}getByKey(l){const f=this.data[l];return f?f[0].value:null}get(l){return this.has(l)?this.data[l.wrapped().key][0].value:null}remove(l,f){if(!this.has(l))return this;const p=l.wrapped().key,A=f===void 0?0:this.data[p].indexOf(f),b=this.data[p][A];return this.data[p].splice(A,1),b.timeout&&clearTimeout(b.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(b.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(l){for(this.max=l;this.order.length>this.max;){const f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this}filter(l){const f=[];for(const p in this.data)for(const A of this.data[p])l(A.value)||f.push(A);for(const p of f)this.remove(p.value.tileID,p)}}class fy{constructor(l,f,p){this.func=l,this.mask=f,this.range=p}}fy.ReadOnly=!1,fy.ReadWrite=!0,fy.disabled=new fy(519,fy.ReadOnly,[0,1]);const q3=7680;class X3{constructor(l,f,p,A,b,C){this.test=l,this.ref=f,this.mask=p,this.fail=A,this.depthFail=b,this.pass=C}}X3.disabled=new X3({func:519,mask:0},0,0,q3,q3,q3);class ud{constructor(l,f,p){this.blendFunction=l,this.blendColor=f,this.mask=p}}ud.Replace=[1,0],ud.disabled=new ud(ud.Replace,lo.transparent,[!1,!1,!1,!1]),ud.unblended=new ud(ud.Replace,lo.transparent,[!0,!0,!0,!0]),ud.alphaBlended=new ud([1,771],lo.transparent,[!0,!0,!0,!0]);const Z3=1029,Y3=2305;class th{constructor(l,f,p){this.enable=l,this.mode=f,this.frontFace=p}}th.disabled=new th(!1,Z3,Y3),th.backCCW=new th(!0,Z3,Y3),th.backCW=new th(!0,Z3,2304),th.frontCW=new th(!0,1028,2304),th.frontCCW=new th(!0,1028,Y3);class i0 extends Ke{constructor(l,f,p){super(),this.id=l,this._onlySymbols=p,f.on("data",A=>{A.dataType==="source"&&A.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&A.dataType==="source"&&A.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),f.on("error",()=>{this._sourceErrored=!0}),this._source=f,this._tiles={},this._cache=new Ipe(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Tpe,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(l){this.map=l,this._minTileCacheSize=this._minTileCacheSize===void 0&&l?l._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&l?l._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const l in this._tiles){const f=this._tiles[l];if(f.state!=="loaded"&&f.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const l=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,l&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(l,f){return l.isSymbolTile=this._onlySymbols,this._source.loadTile(l,f)}_unloadTile(l){if(this._source.unloadTile)return this._source.unloadTile(l,()=>{})}_abortTile(l){if(this._source.abortTile)return this._source.abortTile(l,()=>{})}serialize(){return this._source.serialize()}prepare(l){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const f in this._tiles){const p=this._tiles[f];p.upload(l),p.prepare(this.map.style.imageManager)}}getIds(){return ct(this._tiles).map(l=>l.tileID).sort(jj).map(l=>l.key)}getRenderableIds(l){const f=[];for(const p in this._tiles)this._isIdRenderable(+p,l)&&f.push(this._tiles[p]);return l?f.sort((p,A)=>{const b=p.tileID,C=A.tileID,M=new ie(b.canonical.x,b.canonical.y)._rotate(this.transform.angle),N=new ie(C.canonical.x,C.canonical.y)._rotate(this.transform.angle);return b.overscaledZ-C.overscaledZ||N.y-M.y||N.x-M.x}).map(p=>p.tileID.key):f.map(p=>p.tileID).sort(jj).map(p=>p.key)}hasRenderableParent(l){const f=this.findLoadedParent(l,0);return!!f&&this._isIdRenderable(f.tileID.key)}_isIdRenderable(l,f){return this._tiles[l]&&this._tiles[l].hasData()&&!this._coveredTiles[l]&&(f||!this._tiles[l].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const l in this._tiles)this._tiles[l].state!=="errored"&&this._reloadTile(+l,"reloading")}}_reloadTile(l,f){const p=this._tiles[l];p&&(p.state!=="loading"&&(p.state=f),this._loadTile(p,this._tileLoaded.bind(this,p,l,f)))}_tileLoaded(l,f,p,A){if(A)if(l.state="errored",A.status!==404)this._source.fire(new Hn(A,{tile:l}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const b=this.map.painter.terrain;this.update(this.transform,b.getScaledDemTileSize(),!0),b.resetTileLookupCache(this.id)}else this.update(this.transform);else l.timeAdded=Vo.now(),p==="expired"&&(l.refreshedUponExpiration=!0),this._setTileReloadTimer(f,l),this._source.type==="raster-dem"&&l.dem&&this._backfillDEM(l),this._state.initializeTileState(l,this.map?this.map.painter:null),this._source.fire(new $o("data",{dataType:"source",tile:l,coord:l.tileID,sourceCacheId:this.id}))}_backfillDEM(l){const f=this.getRenderableIds();for(let A=0;A<f.length;A++){const b=f[A];if(l.neighboringTiles&&l.neighboringTiles[b]){const C=this.getTileByID(b);p(l,C),p(C,l)}}function p(A,b){if(!A.dem||A.dem.borderReady)return;A.needsHillshadePrepare=!0,A.needsDEMTextureUpload=!0;let C=b.tileID.canonical.x-A.tileID.canonical.x;const M=b.tileID.canonical.y-A.tileID.canonical.y,N=Math.pow(2,A.tileID.canonical.z),U=b.tileID.key;C===0&&M===0||Math.abs(M)>1||(Math.abs(C)>1&&(Math.abs(C+N)===1?C+=N:Math.abs(C-N)===1&&(C-=N)),b.dem&&A.dem&&(A.dem.backfillBorder(b.dem,C,M),A.neighboringTiles&&A.neighboringTiles[U]&&(A.neighboringTiles[U].backfilled=!0)))}}getTile(l){return this.getTileByID(l.key)}getTileByID(l){return this._tiles[l]}_retainLoadedChildren(l,f,p,A){for(const b in this._tiles){let C=this._tiles[b];if(A[b]||!C.hasData()||C.tileID.overscaledZ<=f||C.tileID.overscaledZ>p)continue;let M=C.tileID;for(;C&&C.tileID.overscaledZ>f+1;){const U=C.tileID.scaledTo(C.tileID.overscaledZ-1);C=this._tiles[U.key],C&&C.hasData()&&(M=U)}let N=M;for(;N.overscaledZ>f;)if(N=N.scaledTo(N.overscaledZ-1),l[N.key]){A[M.key]=M;break}}}findLoadedParent(l,f){if(l.key in this._loadedParentTiles){const p=this._loadedParentTiles[l.key];return p&&p.tileID.overscaledZ>=f?p:null}for(let p=l.overscaledZ-1;p>=f;p--){const A=l.scaledTo(p),b=this._getLoadedTile(A);if(b)return b}}_getLoadedTile(l){const f=this._tiles[l.key];return f&&f.hasData()?f:this._cache.getByKey(this._source.reparseOverscaled?l.wrapped().key:l.canonical.key)}updateCacheSize(l,f){f=f||this._source.tileSize;const p=Math.ceil(l.width/f)+1,A=Math.ceil(l.height/f)+1,b=Math.floor(p*A*5),C=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,b):b,M=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(M)}handleWrapJump(l){const f=Math.round((l-(this._prevLng===void 0?l:this._prevLng))/360);if(this._prevLng=l,f){const p={};for(const A in this._tiles){const b=this._tiles[A];b.tileID=b.tileID.unwrapTo(b.tileID.wrap+f),p[b.tileID.key]=b}this._tiles=p;for(const A in this._timers)clearTimeout(this._timers[A]),delete this._timers[A];for(const A in this._tiles)this._setTileReloadTimer(+A,this._tiles[A])}}update(l,f,p){if(this.transform=l,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;let A;this.updateCacheSize(l,f),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?A=l.getVisibleUnwrappedCoordinates(this._source.tileID).map(M=>new fl(M.canonical.z,M.wrap,M.canonical.z,M.canonical.x,M.canonical.y)):(A=l.coveringTiles({tileSize:f||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(A=A.filter(M=>this._source.hasTile(M)))):A=[];const b=this._updateRetainedTiles(A);if(Vj(this._source.type)&&A.length!==0){const M={},N={},U=Object.keys(b);for(const K of U){const ee=b[K],oe=this._tiles[K];if(!oe||oe.fadeEndTime&&oe.fadeEndTime<=Vo.now())continue;const le=this.findLoadedParent(ee,Math.max(ee.overscaledZ-i0.maxOverzooming,this._source.minzoom));le&&(this._addTile(le.tileID),M[le.tileID.key]=le.tileID),N[K]=ee}const W=A[A.length-1].overscaledZ;for(const K in this._tiles){const ee=this._tiles[K];if(b[K]||!ee.hasData())continue;let oe=ee.tileID;for(;oe.overscaledZ>W;){oe=oe.scaledTo(oe.overscaledZ-1);const le=this._tiles[oe.key];if(le&&le.hasData()&&N[oe.key]){b[K]=ee.tileID;break}}}for(const K in M)b[K]||(this._coveredTiles[K]=!0,b[K]=M[K])}for(const M in b)this._tiles[M].clearFadeHold();const C=function(M,N){const U=[];for(const W in M)W in N||U.push(W);return U}(this._tiles,b);for(const M of C){const N=this._tiles[M];N.hasSymbolBuckets&&!N.holdingForFade()?N.setHoldDuration(this.map._fadeDuration):N.hasSymbolBuckets&&!N.symbolFadeFinished()||this._removeTile(+M)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const l in this._tiles)this._tiles[l].holdingForFade()&&this._removeTile(+l)}_updateRetainedTiles(l){const f={};if(l.length===0)return f;const p={},A=l.reduce((U,W)=>Math.min(U,W.overscaledZ),1/0),b=l[0].overscaledZ,C=Math.max(b-i0.maxOverzooming,this._source.minzoom),M=Math.max(b+i0.maxUnderzooming,this._source.minzoom),N={};for(const U of l){const W=this._addTile(U);f[U.key]=U,W.hasData()||A<this._source.maxzoom&&(N[U.key]=U)}this._retainLoadedChildren(N,A,M,f);for(const U of l){let W=this._tiles[U.key];if(W.hasData())continue;if(U.canonical.z>=this._source.maxzoom){const ee=U.children(this._source.maxzoom)[0],oe=this.getTile(ee);if(oe&&oe.hasData()){f[ee.key]=ee;continue}}else{const ee=U.children(this._source.maxzoom);if(f[ee[0].key]&&f[ee[1].key]&&f[ee[2].key]&&f[ee[3].key])continue}let K=W.wasRequested();for(let ee=U.overscaledZ-1;ee>=C;--ee){const oe=U.scaledTo(ee);if(p[oe.key]||(p[oe.key]=!0,W=this.getTile(oe),!W&&K&&(W=this._addTile(oe)),W&&(f[oe.key]=oe,K=W.wasRequested(),W.hasData())))break}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const l in this._tiles){const f=[];let p,A=this._tiles[l].tileID;for(;A.overscaledZ>0;){if(A.key in this._loadedParentTiles){p=this._loadedParentTiles[A.key];break}f.push(A.key);const b=A.scaledTo(A.overscaledZ-1);if(p=this._getLoadedTile(b),p)break;A=b}for(const b of f)this._loadedParentTiles[b]=p}}_addTile(l){let f=this._tiles[l.key];if(f)return f;f=this._cache.getAndRemove(l),f&&(this._setTileReloadTimer(l.key,f),f.tileID=l,this._state.initializeTileState(f,this.map?this.map.painter:null),this._cacheTimers[l.key]&&(clearTimeout(this._cacheTimers[l.key]),delete this._cacheTimers[l.key],this._setTileReloadTimer(l.key,f)));const p=!!f;if(!p){const A=this.map?this.map.painter:null;f=new W3(l,this._source.tileSize*l.overscaleFactor(),this.transform.tileZoom,A,this._isRaster),this._loadTile(f,this._tileLoaded.bind(this,f,l.key,f.state))}return f?(f.uses++,this._tiles[l.key]=f,p||this._source.fire(new $o("dataloading",{tile:f,coord:f.tileID,dataType:"source"})),f):null}_setTileReloadTimer(l,f){l in this._timers&&(clearTimeout(this._timers[l]),delete this._timers[l]);const p=f.getExpiryTimeout();p&&(this._timers[l]=setTimeout(()=>{this._reloadTile(l,"expired"),delete this._timers[l]},p))}_removeTile(l){const f=this._tiles[l];f&&(f.uses--,delete this._tiles[l],this._timers[l]&&(clearTimeout(this._timers[l]),delete this._timers[l]),f.uses>0||(f.hasData()&&f.state!=="reloading"?this._cache.add(f.tileID,f,f.getExpiryTimeout()):(f.aborted=!0,this._abortTile(f),this._unloadTile(f))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const l in this._tiles)this._removeTile(+l);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(l,f,p){const A=[],b=this.transform;if(!b)return A;const C=b.projection.name==="globe",M=od(b.center.lng);for(const N in this._tiles){const U=this._tiles[N];if(p&&U.clearQueryDebugViz(),U.holdingForFade())continue;let W;if(C){const K=U.tileID.canonical;if(K.z===0){const ee=[Math.abs(be(M,...Xx(K,-1))-M),Math.abs(be(M,...Xx(K,1))-M)];W=[0,2*ee.indexOf(Math.min(...ee))-1]}else{const ee=[Math.abs(be(M,...Xx(K,-1))-M),Math.abs(be(M,...Xx(K,0))-M),Math.abs(be(M,...Xx(K,1))-M)];W=[ee.indexOf(Math.min(...ee))-1]}}else W=[0];for(const K of W){const ee=l.containsTile(U,b,f,K);ee&&A.push(ee)}}return A}getVisibleCoordinates(l){const f=this.getRenderableIds(l).map(p=>this._tiles[p].tileID);for(const p of f)p.projMatrix=this.transform.calculateProjMatrix(p.toUnwrapped());return f}hasTransition(){if(this._source.hasTransition())return!0;if(Vj(this._source.type))for(const l in this._tiles){const f=this._tiles[l];if(f.fadeEndTime!==void 0&&f.fadeEndTime>=Vo.now())return!0}return!1}setFeatureState(l,f,p){this._state.updateState(l=l||"_geojsonTileLayer",f,p)}removeFeatureState(l,f,p){this._state.removeFeatureState(l=l||"_geojsonTileLayer",f,p)}getFeatureState(l,f){return this._state.getState(l=l||"_geojsonTileLayer",f)}setDependencies(l,f,p){const A=this._tiles[l];A&&A.setDependencies(f,p)}reloadTilesForDependencies(l,f){for(const p in this._tiles)this._tiles[p].hasDependency(l,f)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(l,f))}_preloadTiles(l,f){if(!this._sourceLoaded){const M=()=>{this._sourceLoaded&&(this._source.off("data",M),this._preloadTiles(l,f))};return void this._source.on("data",M)}const p=new Map,A=Array.isArray(l)?l:[l],b=this.map.painter.terrain,C=this.usedForTerrain&&b?b.getScaledDemTileSize():this._source.tileSize;for(const M of A){const N=M.coveringTiles({tileSize:C,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const U of N)p.set(U.key,U);this.usedForTerrain&&M.updateElevation(!1)}qe(Array.from(p.values()),(M,N)=>{const U=new W3(M,this._source.tileSize*M.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(U,W=>{this._source.type==="raster-dem"&&U.dem&&this._backfillDEM(U),N(W,U)})},f)}}function jj(c,l){const f=Math.abs(2*c.wrap)-+(c.wrap<0),p=Math.abs(2*l.wrap)-+(l.wrap<0);return c.overscaledZ-l.overscaledZ||p-f||l.canonical.y-c.canonical.y||l.canonical.x-c.canonical.x}function Vj(c){return c==="raster"||c==="image"||c==="video"||c==="custom"}function Xx(c,l){const f=1<<c.z;return[c.x/f+l,(c.x+1)/f+l]}i0.maxOverzooming=10,i0.maxUnderzooming=3;class lS{constructor(l,f,p){this._demTile=l,this._dem=this._demTile.dem,this._scale=f,this._offset=p}static create(l,f,p){const A=p||l.findDEMTileFor(f);if(!A||!A.dem)return;const b=A.dem,C=A.tileID,M=1<<f.canonical.z-C.canonical.z;return new lS(A,A.tileSize/Kn/M,[(f.canonical.x/M-C.canonical.x)*b.dim,(f.canonical.y/M-C.canonical.y)*b.dim])}tileCoordToPixel(l,f){const p=f*this._scale+this._offset[1],A=Math.floor(l*this._scale+this._offset[0]),b=Math.floor(p);return new ie(A,b)}getElevationAt(l,f,p,A){const b=l*this._scale+this._offset[0],C=f*this._scale+this._offset[1],M=Math.floor(b),N=Math.floor(C),U=this._dem;return A=!!A,p?jr(jr(U.get(M,N,A),U.get(M,N+1,A),C-N),jr(U.get(M+1,N,A),U.get(M+1,N+1,A),C-N),b-M):U.get(M,N,A)}getElevationAtPixel(l,f,p){return this._dem.get(l,f,!!p)}getMeterToDEM(l){return(1<<this._demTile.tileID.canonical.z)*Kf(1,l)*this._dem.stride}}class $j{constructor(l,f){this.tileID=l,this.x=l.canonical.x,this.y=l.canonical.y,this.z=l.canonical.z,this.grid=new Bn(Kn,16,0),this.featureIndexArray=new WA,this.promoteId=f}insert(l,f,p,A,b,C=0){const M=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,A,b,C);const N=this.grid;for(let U=0;U<f.length;U++){const W=f[U],K=[1/0,1/0,-1/0,-1/0];for(let ee=0;ee<W.length;ee++){const oe=W[ee];K[0]=Math.min(K[0],oe.x),K[1]=Math.min(K[1],oe.y),K[2]=Math.max(K[2],oe.x),K[3]=Math.max(K[3],oe.y)}K[0]<Kn&&K[1]<Kn&&K[2]>=0&&K[3]>=0&&N.insert(M,K[0],K[1],K[2],K[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new M3(new X2(this.rawTileData)).layers,this.sourceLayerCoder=new Ij(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const l in this.vtLayers)this.vtFeatures[l]=[]}return this.vtLayers}query(l,f,p,A){this.loadVTLayers();const b=l.params||{},C=ma(b.filter),M=l.tileResult,N=l.transform,U=M.bufferedTilespaceBounds,W=this.grid.query(U.min.x,U.min.y,U.max.x,U.max.y,(le,de,xe,Be)=>gG(M.bufferedTilespaceGeometry,le,de,xe,Be));W.sort(Mpe);let K=null;N.elevation&&W.length>0&&(K=lS.create(N.elevation,this.tileID));const ee={};let oe;for(let le=0;le<W.length;le++){const de=W[le];if(de===oe)continue;oe=de;const xe=this.featureIndexArray.get(de);let Be=null;this.loadMatchingFeature(ee,xe,C,b.layers,b.availableImages,f,p,A,($e,Ne,je,Ze=0)=>(Be||(Be=Dp($e,this.tileID.canonical,l.tileTransform)),Ne.queryIntersectsFeature(M,$e,je,Be,this.z,l.transform,l.pixelPosMatrix,K,Ze)))}return ee}loadMatchingFeature(l,f,p,A,b,C,M,N,U){const{featureIndex:W,bucketIndex:K,sourceLayerIndex:ee,layoutVertexArrayOffset:oe}=f,le=this.bucketLayerIDs[K];if(A&&!function($e,Ne){for(let je=0;je<$e.length;je++)if(Ne.indexOf($e[je])>=0)return!0;return!1}(A,le))return;const de=this.sourceLayerCoder.decode(ee),xe=this.vtLayers[de].feature(W);if(p.needGeometry){const $e=e0(xe,!0);if(!p.filter(new Q(this.tileID.overscaledZ),$e,this.tileID.canonical))return}else if(!p.filter(new Q(this.tileID.overscaledZ),xe))return;const Be=this.getId(xe,de);for(let $e=0;$e<le.length;$e++){const Ne=le[$e];if(A&&A.indexOf(Ne)<0)continue;const je=C[Ne];if(!je)continue;let Ze={};Be!==void 0&&N&&(Ze=N.getState(je.sourceLayer||"_geojsonTileLayer",Be));const We=Ct({},M[Ne]);We.paint=Hj(We.paint,je.paint,xe,Ze,b),We.layout=Hj(We.layout,je.layout,xe,Ze,b);const bt=!U||U(xe,je,Ze,oe);if(!bt)continue;const At=new Mj(xe,this.z,this.x,this.y,Be);At.layer=We;let Ft=l[Ne];Ft===void 0&&(Ft=l[Ne]=[]),Ft.push({featureIndex:W,feature:At,intersectionZ:bt})}}lookupSymbolFeatures(l,f,p,A,b,C,M,N){const U={};this.loadVTLayers();const W=ma(b);for(const K of l)this.loadMatchingFeature(U,{bucketIndex:p,sourceLayerIndex:A,featureIndex:K,layoutVertexArrayOffset:0},W,C,M,N,f);return U}loadFeature(l){const{featureIndex:f,sourceLayerIndex:p}=l;this.loadVTLayers();const A=this.sourceLayerCoder.decode(p),b=this.vtFeatures[A];if(b[f])return b[f];const C=this.vtLayers[A].feature(f);return b[f]=C,C}hasLayer(l){for(const f of this.bucketLayerIDs)for(const p of f)if(l===p)return!0;return!1}getId(l,f){let p=l.id;if(this.promoteId){const A=typeof this.promoteId=="string"?this.promoteId:this.promoteId[f];A!=null&&(p=l.properties[A]),typeof p=="boolean"&&(p=Number(p))}return p}}function Hj(c,l,f,p,A){return hn(c,(b,C)=>{const M=l instanceof Le?l.get(C):null;return M&&M.evaluate?M.evaluate(f,p,A):M})}function Mpe(c,l){return l-c}Mt($j,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Wj{constructor(l,f){this.width=l,this.height=f,this.nextRow=0,this.image=new Bp({width:l,height:f}),this.positions={},this.uploaded=!1}getDash(l,f){const p=this.getKey(l,f);return this.positions[p]}trim(){const l=this.width,f=this.height=Tn(this.nextRow);this.image.resize({width:l,height:f})}getKey(l,f){return l.join(",")+f}getDashRanges(l,f,p){const A=[];let b=l.length%2==1?-l[l.length-1]*p:0,C=l[0]*p,M=!0;A.push({left:b,right:C,isDash:M,zeroLength:l[0]===0});let N=l[0];for(let U=1;U<l.length;U++){M=!M;const W=l[U];b=N*p,N+=W,C=N*p,A.push({left:b,right:C,isDash:M,zeroLength:W===0})}return A}addRoundDash(l,f,p){const A=f/2;for(let b=-p;b<=p;b++){const C=this.width*(this.nextRow+p+b);let M=0,N=l[M];for(let U=0;U<this.width;U++){U/N.right>1&&(N=l[++M]);const W=Math.abs(U-N.left),K=Math.abs(U-N.right),ee=Math.min(W,K);let oe;const le=b/p*(A+1);if(N.isDash){const de=A-Math.abs(le);oe=Math.sqrt(ee*ee+de*de)}else oe=A-Math.sqrt(ee*ee+le*le);this.image.data[C+U]=Math.max(0,Math.min(255,oe+128))}}}addRegularDash(l,f){for(let N=l.length-1;N>=0;--N){const U=l[N],W=l[N+1];U.zeroLength?l.splice(N,1):W&&W.isDash===U.isDash&&(W.left=U.left,l.splice(N,1))}const p=l[0],A=l[l.length-1];p.isDash===A.isDash&&(p.left=A.left-this.width,A.right=p.right+this.width);const b=this.width*this.nextRow;let C=0,M=l[C];for(let N=0;N<this.width;N++){N/M.right>1&&(M=l[++C]);const U=Math.abs(N-M.left),W=Math.abs(N-M.right),K=Math.min(U,W);this.image.data[b+N]=Math.max(0,Math.min(255,(M.isDash?K:-K)+f+128))}}addDash(l,f){const p=this.getKey(l,f);if(this.positions[p])return this.positions[p];const A=f==="round",b=A?7:0,C=2*b+1;if(this.nextRow+C>this.height)return $t("LineAtlas out of space"),null;l.length===0&&l.push(1);let M=0;for(let W=0;W<l.length;W++)l[W]<0&&($t("Negative value is found in line dasharray, replacing values with 0"),l[W]=0),M+=l[W];if(M!==0){const W=this.width/M,K=this.getDashRanges(l,this.width,W);A?this.addRoundDash(K,W,b):this.addRegularDash(K,f==="square"?.5*W:0)}const N=this.nextRow+b;this.nextRow+=C;const U={tl:[N,b],br:[M,0]};return this.positions[p]=U,U}}Mt(Wj,"LineAtlas");const qj=1*eh;class Xj{constructor(l){const f={},p=[];for(const M in l){const N=l[M],U=f[M]={};for(const W in N.glyphs){const K=N.glyphs[+W];if(!K||K.bitmap.width===0||K.bitmap.height===0)continue;const ee=K.metrics.localGlyph?qj:1,oe={x:0,y:0,w:K.bitmap.width+2*ee,h:K.bitmap.height+2*ee};p.push(oe),U[W]=oe}}const{w:A,h:b}=D3(p),C=new Bp({width:A||1,height:b||1});for(const M in l){const N=l[M];for(const U in N.glyphs){const W=N.glyphs[+U];if(!W||W.bitmap.width===0||W.bitmap.height===0)continue;const K=f[M][U],ee=W.metrics.localGlyph?qj:1;Bp.copy(W.bitmap,C,{x:0,y:0},{x:K.x+ee,y:K.y+ee},W.bitmap)}}this.image=C,this.positions=f}}Mt(Xj,"GlyphAtlas");class Ope{constructor(l){this.tileID=new fl(l.tileID.overscaledZ,l.tileID.wrap,l.tileID.canonical.z,l.tileID.canonical.x,l.tileID.canonical.y),this.tileZoom=l.tileZoom,this.uid=l.uid,this.zoom=l.zoom,this.canonical=l.tileID.canonical,this.pixelRatio=l.pixelRatio,this.tileSize=l.tileSize,this.source=l.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=l.showCollisionBoxes,this.collectResourceTiming=!!l.collectResourceTiming,this.returnDependencies=!!l.returnDependencies,this.promoteId=l.promoteId,this.enableTerrain=!!l.enableTerrain,this.isSymbolTile=l.isSymbolTile,this.tileTransform=r0(l.tileID.canonical,l.projection),this.projection=l.projection}parse(l,f,p,A,b){this.status="parsing",this.data=l,this.collisionBoxArray=new Si;const C=new Ij(Object.keys(l.layers).sort()),M=new $j(this.tileID,this.promoteId);M.bucketLayerIDs=[];const N={},U=new Wj(256,256),W={featureIndex:M,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:U,availableImages:p},K=f.familiesBySource[this.source];for(const Ze in K){const We=l.layers[Ze];if(!We)continue;let bt=!1,At=!1;for(const Tt of K[Ze])Tt[0].type==="symbol"?bt=!0:At=!0;if(this.isSymbolTile===!0&&!bt||this.isSymbolTile===!1&&!At)continue;We.version===1&&$t(`Vector tile source "${this.source}" layer "${Ze}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Ft=C.encode(Ze),tn=[];for(let Tt=0;Tt<We.length;Tt++){const Gt=We.feature(Tt),jt=M.getId(Gt,Ze);tn.push({feature:Gt,id:jt,index:Tt,sourceLayerIndex:Ft})}for(const Tt of K[Ze]){const Gt=Tt[0];this.isSymbolTile!==void 0&&Gt.type==="symbol"!==this.isSymbolTile||Gt.minzoom&&this.zoom<Math.floor(Gt.minzoom)||Gt.maxzoom&&this.zoom>=Gt.maxzoom||Gt.visibility!=="none"&&(Q3(Tt,this.zoom,p),(N[Gt.id]=Gt.createBucket({index:M.bucketLayerIDs.length,layers:Tt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Ft,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:p})).populate(tn,W,this.tileID.canonical,this.tileTransform),M.bucketLayerIDs.push(Tt.map(jt=>jt.id)))}}let ee,oe,le,de;U.trim();const xe={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Be=()=>{if(ee)return b(ee);if(oe&&le&&de){const Ze=new Xj(oe),We=new tj(le,de);for(const bt in N){const At=N[bt];At instanceof nm?(Q3(At.layers,this.zoom,p),rpe(At,oe,Ze.positions,le,We.iconPositions,this.showCollisionBoxes,p,this.tileID.canonical,this.tileZoom,this.projection)):At.hasPattern&&(At instanceof H2||At instanceof U2||At instanceof Nx)&&(Q3(At.layers,this.zoom,p),At.addFeatures(W,this.tileID.canonical,We.patternPositions,p,this.tileTransform))}this.status="done",b(null,{buckets:ct(N).filter(bt=>!bt.isEmpty()),featureIndex:M,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ze.image,lineAtlas:U,imageAtlas:We,glyphMap:this.returnDependencies?oe:null,iconMap:this.returnDependencies?le:null,glyphPositions:this.returnDependencies?Ze.positions:null})}},$e=hn(W.glyphDependencies,Ze=>Object.keys(Ze).map(Number));Object.keys($e).length?A.send("getGlyphs",{uid:this.uid,stacks:$e},(Ze,We)=>{ee||(ee=Ze,oe=We,Be())},void 0,!1,xe):oe={};const Ne=Object.keys(W.iconDependencies);Ne.length?A.send("getImages",{icons:Ne,source:this.source,tileID:this.tileID,type:"icons"},(Ze,We)=>{ee||(ee=Ze,le=We,Be())},void 0,!1,xe):le={};const je=Object.keys(W.patternDependencies);je.length?A.send("getImages",{icons:je,source:this.source,tileID:this.tileID,type:"patterns"},(Ze,We)=>{ee||(ee=Ze,de=We,Be())},void 0,!1,xe):de={},Be()}}function Q3(c,l,f){const p=new Q(l);for(const A of c)A.recalculate(p,f)}class Zj{constructor(l){this.entries={},this.scheduler=l}request(l,f,p,A){const b=this.entries[l]=this.entries[l]||{callbacks:[]};if(b.result){const[C,M]=b.result;return this.scheduler?this.scheduler.add(()=>{A(C,M)},f):A(C,M),()=>{}}return b.callbacks.push(A),b.cancel||(b.cancel=p((C,M)=>{b.result=[C,M];for(const N of b.callbacks)this.scheduler?this.scheduler.add(()=>{N(C,M)},f):N(C,M);setTimeout(()=>delete this.entries[l],3e3)})),()=>{b.result||(b.callbacks=b.callbacks.filter(C=>C!==A),b.callbacks.length||(b.cancel(),delete this.entries[l]))}}}function Yj(c,l,f){const p=JSON.stringify(c.request);return c.data&&(this.deduped.entries[p]={result:[null,c.data]}),this.deduped.request(p,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom},A=>{const b=Fc(c.request,(C,M,N,U)=>{C?A(C):M&&A(null,{vectorTile:f?void 0:new M3(new X2(M)),rawData:M,cacheControl:N,expires:U})});return()=>{b.cancel(),A()}},l)}const Qj=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class K3{static from(l){if(!(l instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[f,p]=new Uint8Array(l,0,2);if(f!==219)throw new Error("Data does not appear to be in a KDBush format.");const A=p>>4;if(A!==1)throw new Error(`Got v${A} data when expected v1.`);const b=Qj[15&p];if(!b)throw new Error("Unrecognized array type.");const[C]=new Uint16Array(l,2,1),[M]=new Uint32Array(l,4,1);return new K3(M,C,b,l)}constructor(l,f=64,p=Float64Array,A){if(isNaN(l)||l<0)throw new Error(`Unpexpected numItems value: ${l}.`);this.numItems=+l,this.nodeSize=Math.min(Math.max(+f,2),65535),this.ArrayType=p,this.IndexArrayType=l<65536?Uint16Array:Uint32Array;const b=Qj.indexOf(this.ArrayType),C=2*l*this.ArrayType.BYTES_PER_ELEMENT,M=l*this.IndexArrayType.BYTES_PER_ELEMENT,N=(8-M%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${p}.`);A&&A instanceof ArrayBuffer?(this.data=A,this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+M+N,2*l),this._pos=2*l,this._finished=!0):(this.data=new ArrayBuffer(8+C+M+N),this.ids=new this.IndexArrayType(this.data,8,l),this.coords=new this.ArrayType(this.data,8+M+N,2*l),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=f,new Uint32Array(this.data,4,1)[0]=l)}add(l,f){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=l,this.coords[this._pos++]=f,p}finish(){const l=this._pos>>1;if(l!==this.numItems)throw new Error(`Added ${l} items when expected ${this.numItems}.`);return J3(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(l,f,p,A){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:C,nodeSize:M}=this,N=[0,b.length-1,0],U=[];for(;N.length;){const W=N.pop()||0,K=N.pop()||0,ee=N.pop()||0;if(K-ee<=M){for(let xe=ee;xe<=K;xe++){const Be=C[2*xe],$e=C[2*xe+1];Be>=l&&Be<=p&&$e>=f&&$e<=A&&U.push(b[xe])}continue}const oe=ee+K>>1,le=C[2*oe],de=C[2*oe+1];le>=l&&le<=p&&de>=f&&de<=A&&U.push(b[oe]),(W===0?l<=le:f<=de)&&(N.push(ee),N.push(oe-1),N.push(1-W)),(W===0?p>=le:A>=de)&&(N.push(oe+1),N.push(K),N.push(1-W))}return U}within(l,f,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:A,coords:b,nodeSize:C}=this,M=[0,A.length-1,0],N=[],U=p*p;for(;M.length;){const W=M.pop()||0,K=M.pop()||0,ee=M.pop()||0;if(K-ee<=C){for(let xe=ee;xe<=K;xe++)Jj(b[2*xe],b[2*xe+1],l,f)<=U&&N.push(A[xe]);continue}const oe=ee+K>>1,le=b[2*oe],de=b[2*oe+1];Jj(le,de,l,f)<=U&&N.push(A[oe]),(W===0?l-p<=le:f-p<=de)&&(M.push(ee),M.push(oe-1),M.push(1-W)),(W===0?l+p>=le:f+p>=de)&&(M.push(oe+1),M.push(K),M.push(1-W))}return N}}function J3(c,l,f,p,A,b){if(A-p<=f)return;const C=p+A>>1;Kj(c,l,C,p,A,b),J3(c,l,f,p,C-1,1-b),J3(c,l,f,C+1,A,1-b)}function Kj(c,l,f,p,A,b){for(;A>p;){if(A-p>600){const U=A-p+1,W=f-p+1,K=Math.log(U),ee=.5*Math.exp(2*K/3),oe=.5*Math.sqrt(K*ee*(U-ee)/U)*(W-U/2<0?-1:1);Kj(c,l,f,Math.max(p,Math.floor(f-W*ee/U+oe)),Math.min(A,Math.floor(f+(U-W)*ee/U+oe)),b)}const C=l[2*f+b];let M=p,N=A;for(Zx(c,l,p,f),l[2*A+b]>C&&Zx(c,l,p,A);M<N;){for(Zx(c,l,M,N),M++,N--;l[2*M+b]<C;)M++;for(;l[2*N+b]>C;)N--}l[2*p+b]===C?Zx(c,l,p,N):(N++,Zx(c,l,N,A)),N<=f&&(p=N+1),f<=N&&(A=N-1)}}function Zx(c,l,f,p){eD(c,f,p),eD(l,2*f,2*p),eD(l,2*f+1,2*p+1)}function eD(c,l,f){const p=c[l];c[l]=c[f],c[f]=p}function Jj(c,l,f,p){const A=c-f,b=l-p;return A*A+b*b}s.ARRAY_TYPE=gu,s.AUTH_ERR_MSG=Me,s.Aabb=cl,s.Actor=class{constructor(c,l,f){this.target=c,this.parent=l,this.mapId=f,this.callbacks={},this.cancelCallbacks={},Zt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ln()?c:u,this.scheduler=new Epe}send(c,l,f,p,A=!1,b){const C=Math.round(1e18*Math.random()).toString(36).substring(0,10);f&&(f.metadata=b,this.callbacks[C]=f);const M=cr(this.globalScope)?void 0:[];return this.target.postMessage({id:C,type:c,hasCallback:!!f,targetMapId:p,mustQueue:A,sourceMapId:this.mapId,data:Vr(l,M)},M),{cancel:()=>{f&&delete this.callbacks[C],this.target.postMessage({id:C,type:"<cancel>",targetMapId:p,sourceMapId:this.mapId})}}}receive(c){const l=c.data,f=l.id;if(f&&(!l.targetMapId||this.mapId===l.targetMapId))if(l.type==="<cancel>"){const p=this.cancelCallbacks[f];delete this.cancelCallbacks[f],p&&p.cancel()}else if(l.mustQueue||Ln()){const p=this.callbacks[f];this.cancelCallbacks[f]=this.scheduler.add(()=>this.processTask(f,l),p&&p.metadata||{type:"message"})}else this.processTask(f,l)}processTask(c,l){if(l.type==="<response>"){const f=this.callbacks[c];delete this.callbacks[c],f&&(l.error?f(Jr(l.error)):f(null,Jr(l.data)))}else{const f=cr(this.globalScope)?void 0:[],p=l.hasCallback?(b,C)=>{delete this.cancelCallbacks[c],this.target.postMessage({id:c,type:"<response>",sourceMapId:this.mapId,error:b?Vr(b):null,data:Vr(C,f)},f)}:b=>{},A=Jr(l.data);if(this.parent[l.type])this.parent[l.type](l.sourceMapId,A,p);else if(this.parent.getWorkerSource){const b=l.type.split(".");this.parent.getWorkerSource(l.sourceMapId,b[0],A.source)[b[1]](A,p)}else p(new Error(`Could not find function ${l.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=$2,s.Color=lo,s.ColorMode=ud,s.CullFaceMode=th,s.DEMData=aS,s.DataConstantProperty=he,s.DedupedRequest=Zj,s.DepthMode=fy,s.EXTENT=Kn,s.Elevation=class{isDataAvailableAtPoint(c){const l=this._source();if(this.isUsingMockSource()||!l||c.y<0||c.y>1)return!1;const f=l.getSource().maxzoom,p=1<<f,A=Math.floor(c.x),b=Math.floor((c.x-A)*p),C=Math.floor(c.y*p),M=this.findDEMTileFor(new fl(f,A,f,b,C));return!(!M||!M.dem)}getAtPointOrZero(c,l=0){return this.getAtPoint(c,l)||0}getAtPoint(c,l,f=!0){if(this.isUsingMockSource())return null;l==null&&(l=null);const p=this._source();if(!p||c.y<0||c.y>1)return l;const A=p.getSource().maxzoom,b=1<<A,C=Math.floor(c.x),M=c.x-C,N=new fl(A,C,A,Math.floor(M*b),Math.floor(c.y*b)),U=this.findDEMTileFor(N);if(!U||!U.dem)return l;const W=U.dem,K=1<<U.tileID.canonical.z,ee=(M*K-U.tileID.canonical.x)*W.dim,oe=(c.y*K-U.tileID.canonical.y)*W.dim,le=Math.floor(ee),de=Math.floor(oe);return(f?this.exaggeration():1)*jr(jr(W.get(le,de),W.get(le,de+1),oe-de),jr(W.get(le+1,de),W.get(le+1,de+1),oe-de),ee-le)}getAtTileOffset(c,l,f){const p=1<<c.canonical.z;return this.getAtPointOrZero(new Q_(c.wrap+(c.canonical.x+l/Kn)/p,(c.canonical.y+f/Kn)/p))}getAtTileOffsetFunc(c,l,f,p){return A=>{const b=this.getAtTileOffset(c,A.x,A.y),C=p.upVector(c.canonical,A.x,A.y);return Ku(C,C,b*p.upVectorScale(c.canonical,l,f).metersToTile),C}}getForTilePoints(c,l,f,p){if(this.isUsingMockSource())return!1;const A=lS.create(this,c,p);return!!A&&(l.forEach(b=>{b[2]=this.exaggeration()*A.getElevationAt(b[0],b[1],f)}),!0)}getMinMaxForTile(c){if(this.isUsingMockSource())return null;const l=this.findDEMTileFor(c);if(!l||!l.dem)return null;const f=l.dem.tree,p=l.tileID,A=1<<c.canonical.z-p.canonical.z;let b=c.canonical.x/A-p.canonical.x,C=c.canonical.y/A-p.canonical.y,M=0;for(let N=0;N<c.canonical.z-p.canonical.z&&!f.leaves[M];N++){b*=2,C*=2;const U=2*Math.floor(C)+Math.floor(b);M=f.childOffsets[M]+U,b%=1,C%=1}return{min:this.exaggeration()*f.minimums[M],max:this.exaggeration()*f.maximums[M]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(c,l,f){throw new Error("Pure virtual method called.")}pointCoordinate(c){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(c){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=Hn,s.EvaluationParameters=Q,s.Event=$o,s.Evented=Ke,s.FillExtrusionBucket=Nx,s.Frustum=a3,s.FrustumCorners=s3,s.GLOBE_RADIUS=rd,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=K8,s.GLOBE_ZOOM_THRESHOLD_MIN=l3,s.GlobeSharedBuffers=class{constructor(c){this._createGrid(c),this._createPoles(c)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const c of this._poleSegments)c.destroy();for(const c of this._gridSegments)c.withSkirts.destroy(),c.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const c of this._wireframeSegments)c.destroy()}}_fillGridMeshWithLods(c,l){const f=new en,p=new Vn,A=[],b=c+1+2,C=l[0]+1,M=l[0]+1+(1+l.length),N=(U,W,K)=>{let ee=U===b-1?U-2:U===0?U:U-1;return ee+=K?24575:0,[ee,W]};for(let U=0;U<b;++U)f.emplaceBack(...N(U,0,!0));for(let U=0;U<C;++U)for(let W=0;W<b;++W)f.emplaceBack(...N(W,U,(W===0||W===b-1)&&!0));for(let U=0;U<l.length;++U){const W=l[U];for(let K=0;K<b;++K)f.emplaceBack(...N(K,W,!0))}for(let U=0;U<l.length;++U){const W=p.length,K=l[U]+1+2,ee=new Vn;for(let de=0;de<K-1;de++){const xe=de===K-2,Be=xe?b*(M-l.length+U-de):b;for(let $e=0;$e<b-1;$e++){const Ne=de*b+$e;de===0||xe||$e===0||$e===b-2?(ee.emplaceBack(Ne+1,Ne,Ne+Be),ee.emplaceBack(Ne+Be,Ne+Be+1,Ne+1)):(p.emplaceBack(Ne+1,Ne,Ne+Be),p.emplaceBack(Ne+Be,Ne+Be+1,Ne+1))}}const oe=Wo.simpleSegment(0,W,f.length,p.length-W);for(let de=0;de<ee.uint16.length;de+=3)p.emplaceBack(ee.uint16[de],ee.uint16[de+1],ee.uint16[de+2]);const le=Wo.simpleSegment(0,W,f.length,p.length-W);A.push({withoutSkirts:oe,withSkirts:le})}return{vertices:f,indices:p,segments:A}}_createGrid(c){const l=this._fillGridMeshWithLods(KA,Tx);this._gridSegments=l.segments,this._gridBuffer=c.createVertexBuffer(l.vertices,Sx.members),this._gridIndexBuffer=c.createIndexBuffer(l.indices,!0)}_createPoles(c){const l=new Vn;for(let A=0;A<=KA;A++)l.emplaceBack(0,A+1,A+2);this._poleIndexBuffer=c.createIndexBuffer(l,!0);const f=new Ei,p=new Ei;this._poleSegments=[];for(let A=0,b=0;A<l3;A++){const C=360/(1<<A);f.emplaceBack(0,-rd,0,.5,0),p.emplaceBack(0,-rd,0,.5,1);for(let M=0;M<=KA;M++){const N=M/KA,U=jr(0,C,N),[W,K,ee]=X_(Ehe,She,U,rd);f.emplaceBack(W,K,ee,N,0),p.emplaceBack(W,K,ee,N,1)}this._poleSegments.push(Wo.simpleSegment(b,0,66,64)),b+=66}this._poleNorthVertexBuffer=c.createVertexBuffer(f,Y8,!1),this._poleSouthVertexBuffer=c.createVertexBuffer(p,Y8,!1)}getGridBuffers(c,l){return[this._gridBuffer,this._gridIndexBuffer,l?this._gridSegments[c].withSkirts:this._gridSegments[c].withoutSkirts]}getPoleBuffers(c){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[c]]}getWirefameBuffers(c,l){if(!this._wireframeSegments){const f=new Ns,p=KA,A=p+1+2,b=1;this._wireframeSegments=[];for(let C=0,M=0;C<Tx.length;C++){const N=Tx[C];for(let W=b;W<N+b;W++)for(let K=b;K<p+b;K++){const ee=W*A+K;f.emplaceBack(ee,ee+1),f.emplaceBack(ee,ee+A),f.emplaceBack(ee,ee+A+1)}const U=N*p*3;this._wireframeSegments.push(Wo.simpleSegment(0,M,(N+1)*A,U)),M+=U}this._wireframeIndexBuffer=c.createIndexBuffer(f)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[l]]}},s.GlyphManager=sy,s.ImagePosition=B3,s.KDBush=K3,s.LivePerformanceUtils=qi,s.LngLat=Ti,s.LngLatBounds=Kg,s.LocalGlyphMode=k3,s.MAX_MERCATOR_LATITUDE=va,s.MercatorCoordinate=Q_,s.ONE_EM=Qs,s.OverscaledTileID=fl,s.PerformanceMarkers=Tr,s.Point=ie,s.Properties=ke,s.RGBAImage=mu,s.Ray=o3,s.RequestManager=class{constructor(c,l,f){this._transformRequestFn=c,this._customAccessToken=l,this._silenceAuthErrors=!!f,this._createSkuToken()}_createSkuToken(){const c=function(){let l="";for(let f=0;f<10;f++)l+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",F,l].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=c.token,this._skuTokenExpiresAt=c.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(c,l){return this._transformRequestFn&&this._transformRequestFn(c,l)||{url:c}}normalizeStyleURL(c,l){if(!rt(c))return c;const f=dn(c);return f.path=`/styles/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||l)}normalizeGlyphsURL(c,l){if(!rt(c))return c;const f=dn(c);return f.path=`/fonts/v1${f.path}`,this._makeAPIURL(f,this._customAccessToken||l)}normalizeSourceURL(c,l,f,p){if(!rt(c))return c;const A=dn(c);return A.path=`/v4/${A.authority}.json`,A.params.push("secure"),f&&A.params.push(`language=${f}`),p&&A.params.push(`worldview=${p}`),this._makeAPIURL(A,this._customAccessToken||l)}normalizeSpriteURL(c,l,f,p){const A=dn(c);return rt(c)?(A.path=`/styles/v1${A.path}/sprite${l}${f}`,this._makeAPIURL(A,this._customAccessToken||p)):(A.path+=`${l}${f}`,Qt(A))}normalizeTileURL(c,l,f){if(this._isSkuTokenExpired()&&this._createSkuToken(),c&&!rt(c))return c;const p=dn(c);p.path=p.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${l||f&&p.authority!=="raster"&&f===512?"@2x":""}${E.supported?".webp":"$1"}`),p.authority==="raster"?p.path=`/${_.RASTER_URL_PREFIX}${p.path}`:(p.path=p.path.replace(/^.+\/v4\//,"/"),p.path=`/${_.TILE_URL_VERSION}${p.path}`);const A=this._customAccessToken||function(b){for(const C of b){const M=C.match(/^access_token=(.*)$/);if(M)return M[1]}return null}(p.params)||_.ACCESS_TOKEN;return _.REQUIRE_ACCESS_TOKEN&&A&&this._skuToken&&p.params.push(`sku=${this._skuToken}`),this._makeAPIURL(p,A)}canonicalizeTileURL(c,l){const f=dn(c);if(!f.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!f.path.match(/\.[\w]+$/))return c;let p="mapbox://";f.path.match(/^\/raster\/v1\//)?p+=`raster/${f.path.replace(`/${_.RASTER_URL_PREFIX}/`,"")}`:p+=`tiles/${f.path.replace(`/${_.TILE_URL_VERSION}/`,"")}`;let A=f.params;return l&&(A=A.filter(b=>!b.match(/^access_token=/))),A.length&&(p+=`?${A.join("&")}`),p}canonicalizeTileset(c,l){const f=!!l&&rt(l),p=[];for(const A of c.tiles||[])ht(A)?p.push(this.canonicalizeTileURL(A,f)):p.push(A);return p}_makeAPIURL(c,l){const f="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",p=dn(_.API_URL);if(c.protocol=p.protocol,c.authority=p.authority,c.protocol==="http"){const A=c.params.indexOf("secure");A>=0&&c.params.splice(A,1)}if(p.path!=="/"&&(c.path=`${p.path}${c.path}`),!_.REQUIRE_ACCESS_TOKEN)return Qt(c);if(l=l||_.ACCESS_TOKEN,!this._silenceAuthErrors){if(!l)throw new Error(`An API access token is required to use Mapbox GL. ${f}`);if(l[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${f}`)}return c.params=c.params.filter(A=>A.indexOf("access_token")===-1),c.params.push(`access_token=${l||""}`),Qt(c)}},s.ResourceType=$u,s.SegmentVector=Wo,s.SourceCache=i0,s.StencilMode=X3,s.StructArrayLayout1ui2=pu,s.StructArrayLayout2f1f2i16=er,s.StructArrayLayout2i4=en,s.StructArrayLayout2ui4=Ns,s.StructArrayLayout3f12=Nr,s.StructArrayLayout3ui6=Vn,s.StructArrayLayout4i8=Ut,s.StructArrayLayout5f20=Ei,s.Texture=qx,s.Tile=W3,s.Transitionable=fe,s.Uniform1f=C2,s.Uniform1i=class extends Op{constructor(c){super(c),this.current=0}set(c,l,f){this.fetchUniformLocation(c,l)&&this.current!==f&&(this.current=f,this.gl.uniform1i(this.location,f))}},s.Uniform2f=class extends Op{constructor(c){super(c),this.current=[0,0]}set(c,l,f){this.fetchUniformLocation(c,l)&&(f[0]===this.current[0]&&f[1]===this.current[1]||(this.current=f,this.gl.uniform2f(this.location,f[0],f[1])))}},s.Uniform3f=class extends Op{constructor(c){super(c),this.current=[0,0,0]}set(c,l,f){this.fetchUniformLocation(c,l)&&(f[0]===this.current[0]&&f[1]===this.current[1]&&f[2]===this.current[2]||(this.current=f,this.gl.uniform3f(this.location,f[0],f[1],f[2])))}},s.Uniform4f=L8,s.UniformColor=D8,s.UniformMatrix2f=class extends Op{constructor(c){super(c),this.current=lhe}set(c,l,f){if(this.fetchUniformLocation(c,l)){for(let p=0;p<4;p++)if(f[p]!==this.current[p]){this.current=f,this.gl.uniformMatrix2fv(this.location,!1,f);break}}}},s.UniformMatrix3f=class extends Op{constructor(c){super(c),this.current=ahe}set(c,l,f){if(this.fetchUniformLocation(c,l)){for(let p=0;p<9;p++)if(f[p]!==this.current[p]){this.current=f,this.gl.uniformMatrix3fv(this.location,!1,f);break}}}},s.UniformMatrix4f=class extends Op{constructor(c){super(c),this.current=she}set(c,l,f){if(this.fetchUniformLocation(c,l)){if(f[12]!==this.current[12]||f[0]!==this.current[0])return this.current=f,void this.gl.uniformMatrix4fv(this.location,!1,f);for(let p=1;p<16;p++)if(f[p]!==this.current[p]){this.current=f,this.gl.uniformMatrix4fv(this.location,!1,f);break}}}},s.UnwrappedTileID=UG,s.ValidationError=Sn,s.VectorTileFeature=j2,s.VectorTileWorkerSource=class extends Ke{constructor(c,l,f,p,A){super(),this.actor=c,this.layerIndex=l,this.availableImages=f,this.loadVectorData=A||Yj,this.loading={},this.loaded={},this.deduped=new Zj(c.scheduler),this.isSpriteLoaded=p,this.scheduler=c.scheduler}loadTile(c,l){const f=c.uid,p=c&&c.request,A=p&&p.collectResourceTiming,b=this.loading[f]=new Ope(c);b.abort=this.loadVectorData(c,(C,M)=>{const N=!this.loading[f];if(delete this.loading[f],N||C||!M)return b.status="done",N||(this.loaded[f]=b),l(C);const U=M.rawData,W={};M.expires&&(W.expires=M.expires),M.cacheControl&&(W.cacheControl=M.cacheControl),b.vectorTile=M.vectorTile||new M3(new X2(U));const K=()=>{b.parse(b.vectorTile,this.layerIndex,this.availableImages,this.actor,(ee,oe)=>{if(ee||!oe)return l(ee);const le={};if(A){const de=ro(p);de.length>0&&(le.resourceTiming=JSON.parse(JSON.stringify(de)))}l(null,Ct({rawTileData:U.slice(0)},oe,W,le))})};this.isSpriteLoaded?K():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(K,{type:"parseTile",isSymbolTile:c.isSymbolTile,zoom:c.tileZoom}):K()}),this.loaded=this.loaded||{},this.loaded[f]=b})}reloadTile(c,l){const f=this.loaded,p=c.uid,A=this;if(f&&f[p]){const b=f[p];b.showCollisionBoxes=c.showCollisionBoxes,b.enableTerrain=!!c.enableTerrain,b.projection=c.projection,b.tileTransform=r0(c.tileID.canonical,c.projection);const C=(M,N)=>{const U=b.reloadCallback;U&&(delete b.reloadCallback,b.parse(b.vectorTile,A.layerIndex,this.availableImages,A.actor,U)),l(M,N)};b.status==="parsing"?b.reloadCallback=C:b.status==="done"&&(b.vectorTile?b.parse(b.vectorTile,this.layerIndex,this.availableImages,this.actor,C):C())}}abortTile(c,l){const f=c.uid,p=this.loading[f];p&&(p.abort&&p.abort(),delete this.loading[f]),l()}removeTile(c,l){const f=this.loaded,p=c.uid;f&&f[p]&&delete f[p],l()}},s.WritingMode=ec,s.ZoomDependentExpression=Ep,s.add=Lp,s.addDynamicAttributes=iS,s.adjoint=function(c,l){var f=l[0],p=l[1],A=l[2],b=l[3],C=l[4],M=l[5],N=l[6],U=l[7],W=l[8];return c[0]=C*W-M*U,c[1]=A*U-p*W,c[2]=p*M-A*C,c[3]=M*N-b*W,c[4]=f*W-A*N,c[5]=A*b-f*M,c[6]=b*U-C*N,c[7]=p*N-f*U,c[8]=f*C-p*b,c},s.asyncAll=qe,s.bezier=at,s.bindAll=Zt,s.boundsAttributes=Rj,s.bufferConvexPolygon=function(c,l){const f=[];for(let p=0;p<c.length;p++){const A=Re(p-1,-1,c.length-1),b=Re(p+1,-1,c.length-1),C=c[p],M=c[b],N=c[A].sub(C).unit(),U=M.sub(C).unit(),W=U.angleWithSep(N.x,N.y),K=N.add(U).unit().mult(-1*l/Math.sin(W/2));f.push(C.add(K))}return f},s.cacheEntryPossiblyAdded=function(c){au++,au>Nl&&(c.getActor().send("enforceCacheSizeLimit",Fa),au=0)},s.calculateGlobeLabelMatrix=function(c,l){const{x:f,y:p}=c.point,A=rG(f,p,c.worldSize/c._pixelsPerMercatorPixel,0,0);return ZA(A,A,f3(id(l)))},s.calculateGlobeMatrix=function(c){const{x:l,y:f}=c.point,{lng:p,lat:A}=c._center;return rG(l,f,c.worldSize,p,A)},s.calculateGlobeMercatorMatrix=function(c){const l=c.pixelsPerMeter,f=l/Kf(1,c.center.lat),p=Yf(new Float64Array(16));return yx(p,p,[c.point.x,c.point.y,0]),YA(p,p,[f,f,l]),Float32Array.from(p)},s.circumferenceAtLatitude=d3,s.clamp=be,s.clearTileCache=function(c){if(!Fl())return;const l=u.caches.delete(Do);c&&l.catch(c).then(()=>c())},s.clipLine=pj,s.clone=function(c){var l=new gu(16);return l[0]=c[0],l[1]=c[1],l[2]=c[2],l[3]=c[3],l[4]=c[4],l[5]=c[5],l[6]=c[6],l[7]=c[7],l[8]=c[8],l[9]=c[9],l[10]=c[10],l[11]=c[11],l[12]=c[12],l[13]=c[13],l[14]=c[14],l[15]=c[15],l},s.clone$1=It,s.collisionCircleLayout=Ide,s.config=_,s.conjugate=function(c,l){return c[0]=-l[0],c[1]=-l[1],c[2]=-l[2],c[3]=l[3],c},s.create=function(){var c=new gu(16);return gu!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=0,c[12]=0,c[13]=0,c[14]=0),c[0]=1,c[5]=1,c[10]=1,c[15]=1,c},s.create$1=F8,s.createExpression=Qh,s.createLayout=st,s.createStyleLayer=function(c){return c.type==="custom"?new vpe(c):new bpe[c.type](c)},s.cross=i3,s.degToRad=me,s.distance=function(c,l){return Math.hypot(l[0]-c[0],l[1]-c[1],l[2]-c[2])},s.div=function(c,l,f){return c[0]=l[0]/f[0],c[1]=l[1]/f[1],c[2]=l[2]/f[2],c},s.dot=qc,s.earthRadius=Ix,s.ease=yt,s.easeCubicInOut=Ye,s.ecefToLatLng=function([c,l,f]){const p=Math.hypot(c,l,f),A=Math.atan2(c,f),b=.5*Math.PI-Math.acos(-l/p);return new Ti(Ce(A),Ce(b))},s.emitValidationErrors=Rt,s.endsWith=Wt,s.enforceCacheSizeLimit=function(c){su(),_s&&_s.then(l=>{l.keys().then(f=>{for(let p=0;p<f.length-c;p++)l.delete(f[p])})})},s.evaluateSizeForFeature=W2,s.evaluateSizeForZoom=ny,s.evaluateVariableOffset=yj,s.evented=I,s.exactEquals=function(c,l){return c[0]===l[0]&&c[1]===l[1]&&c[2]===l[2]&&c[3]===l[3]},s.exactEquals$1=function(c,l){return c[0]===l[0]&&c[1]===l[1]&&c[2]===l[2]},s.exported=Vo,s.exported$1=E,s.extend=Ct,s.extend$1=za,s.fillExtrusionHeightLift=FG,s.filterObject=lr,s.fromMat4=function(c,l){return c[0]=l[0],c[1]=l[1],c[2]=l[2],c[3]=l[4],c[4]=l[5],c[5]=l[6],c[6]=l[8],c[7]=l[9],c[8]=l[10],c},s.fromQuat=function(c,l){var f=l[0],p=l[1],A=l[2],b=l[3],C=f+f,M=p+p,N=A+A,U=f*C,W=p*C,K=p*M,ee=A*C,oe=A*M,le=A*N,de=b*C,xe=b*M,Be=b*N;return c[0]=1-K-le,c[1]=W+Be,c[2]=ee-xe,c[3]=0,c[4]=W-Be,c[5]=1-U-le,c[6]=oe+de,c[7]=0,c[8]=ee+xe,c[9]=oe-de,c[10]=1-U-K,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,c},s.fromRotation=function(c,l){var f=Math.sin(l),p=Math.cos(l);return c[0]=p,c[1]=f,c[2]=0,c[3]=-f,c[4]=p,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},s.fromScaling=z8,s.furthestTileCorner=function(c){const l=Math.round((c+45+360)%360/90)%4;return we[l]},s.getAABBPointSquareDist=function(c,l,f){let p=0;for(let A=0;A<2;++A){const b=f?f[A]:0;c[A]>b&&(p+=(c[A]-b)*(c[A]-b)),l[A]<b&&(p+=(b-l[A])*(b-l[A]))}return p},s.getAnchorAlignment=F3,s.getAnchorJustification=U3,s.getBounds=function(c){let l=1/0,f=1/0,p=-1/0,A=-1/0;for(const b of c)l=Math.min(l,b.x),f=Math.min(f,b.y),p=Math.max(p,b.x),A=Math.max(A,b.y);return{min:new ie(l,f),max:new ie(p,A)}},s.getColumn=Ri,s.getDefaultExportFromCjs=z,s.getGridMatrix=function(c,l,f,p){const A=l.getNorth(),b=l.getSouth(),C=l.getWest(),M=l.getEast(),N=1<<c.z,U=M-C,W=A-b,K=U/KA,ee=-W/Tx[f],oe=[0,K,0,ee,0,0,A,C,0];if(c.z>0){const le=180/p;k8(oe,oe,[le/U+1,0,0,0,le/W+1,0,-.5*le/K,.5*le/ee,1])}return oe[2]=N,oe[5]=c.x,oe[8]=c.y,oe},s.getImage=ze,s.getJSON=function(c,l){return uu(Ct(c,{type:"json"}),l)},s.getLatitudinalLod=function(c){const l=va-5;c=be(c,-l,l)/l*90;const f=Math.pow(Math.abs(Math.sin(me(c))),3);return Math.round(f*(Tx.length-1))},s.getMapSessionAPI=fr,s.getPerformanceMeasurement=ro,s.getProjection=Cj,s.getRTLTextPluginStatus=L,s.getReferrer=Hu,s.getTilePoint=function(c,{x:l,y:f},p=0){return new ie(((l-p)*c.scale-c.x)*Kn,(f*c.scale-c.y)*Kn)},s.getTileVec3=function(c,l,f=0){return q_(((l.x-f)*c.scale-c.x)*Kn,(l.y*c.scale-c.y)*Kn,aG(l.z,l.y))},s.getVideo=function(c,l){const f=u.document.createElement("video");f.muted=!0,f.onloadstart=function(){l(null,f)};for(let p=0;p<c.length;p++){const A=u.document.createElement("source");Wu(c[p])||(f.crossOrigin="Anonymous"),A.src=c[p],f.appendChild(A)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(c){const l=[0,0,0],f=Yf(new Float64Array(16));return ZA(f,c.pixelMatrix,c.globeMatrix),Fo(l,l,f),new ie(l[0],l[1])},s.globeDenormalizeECEF=f3,s.globeECEFOrigin=function(c,l){const f=[0,0,0];return Fo(f,f,Px(id(l.canonical))),Fo(f,f,c),f},s.globeMetersToEcef=M2,s.globeNormalizeECEF=Px,s.globePixelsToTileUnits=function(c,l){return Kn/(512*Math.pow(2,c))*R2(id(l))},s.globePoleMatrixForTile=function(c,l,f){const p=Yf(new Float64Array(16)),A=(l/(1<<c)-.5)*Math.PI*2;return I2(p,f.globeMatrix,A),Float32Array.from(p)},s.globeTileBounds=id,s.globeTiltAtLngLat=iG,s.globeToMercatorTransition=Y_,s.globeUseCustomAntiAliasing=function(c,l,f){const p=Y_(f.zoom),A=c.style.map._antialias,b=!!l.extStandardDerivatives,C=l.extStandardDerivativesForceOff||c.terrain&&c.terrain.exaggeration()>0;return p===0&&!A&&!C&&b},s.identity=Yf,s.identity$1=q8,s.invert=e3,s.isFullscreen=function(){return!!u.document.fullscreenElement||!!u.document.webkitFullscreenElement},s.isLngLatBehindGlobe=h3,s.isMapAuthenticated=function(c){return rr.has(c)},s.isMapboxURL=rt,s.isSafariWithAntialiasingBug=function(c){const l=c.navigator?c.navigator.userAgent:null;return!!cr(c)&&l&&(l.match("Version/15.4")||l.match("Version/15.5")||l.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=ya,s.latLngToECEF=Z_,s.len=Ahe,s.length=vx,s.length$1=function(c){return Math.hypot(c[0],c[1],c[2],c[3])},s.lngFromMercatorX=Ju,s.loadVectorTile=Yj,s.makeRequest=uu,s.mapValue=function(c,l,f,p,A){return be((c-l)/(f-l)*(A-p)+p,p,A)},s.mercatorScale=lG,s.mercatorXfromLng=od,s.mercatorYfromLat=sd,s.mercatorZfromAltitude=Kf,s.mul=ghe,s.mul$1=mhe,s.multiply=ZA,s.multiply$1=k8,s.multiply$2=j8,s.nextPowerOfTwo=Tn,s.normalize=ul,s.normalize$1=_he,s.normalize$2=H8,s.number=jr,s.ortho=function(c,l,f,p,A,b,C){var M=1/(l-f),N=1/(p-A),U=1/(b-C);return c[0]=-2*M,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=-2*N,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[10]=2*U,c[11]=0,c[12]=(l+f)*M,c[13]=(A+p)*N,c[14]=(C+b)*U,c[15]=1,c},s.pbf=qG,s.perspective=function(c,l,f,p,A){var b,C=1/Math.tan(l/2);return c[0]=C/f,c[1]=0,c[2]=0,c[3]=0,c[4]=0,c[5]=C,c[6]=0,c[7]=0,c[8]=0,c[9]=0,c[11]=-1,c[12]=0,c[13]=0,c[15]=0,A!=null&&A!==1/0?(c[10]=(A+p)*(b=1/(p-A)),c[14]=2*A*p*b):(c[10]=-1,c[14]=-2*p),c},s.pick=function(c,l){const f={};for(let p=0;p<l.length;p++){const A=l[p];A in c&&(f[A]=c[A])}return f},s.plugin=H,s.pointGeometry=re,s.polesInViewport=function(c){const l=Yf(new Float64Array(16));ZA(l,c.pixelMatrix,c.globeMatrix);const f=[0,Xc,0],p=[0,Zc,0];return Fo(f,f,l),Fo(p,p,l),[f[0]>0&&f[0]<=c.width&&f[1]>0&&f[1]<=c.height&&!h3(c,new Ti(c.center.lat,90)),p[0]>0&&p[0]<=c.width&&p[1]>0&&p[1]<=c.height&&!h3(c,new Ti(c.center.lat,-90))]},s.polygonContainsPoint=t0,s.polygonIntersectsBox=gG,s.polygonIntersectsPolygon=fG,s.polygonizeBounds=function(c,l,f=0,p=!0){const A=new ie(f,f),b=c.sub(A),C=l.add(A),M=[b,new ie(C.x,b.y),C,new ie(b.x,C.y)];return p&&M.push(b.clone()),M},s.posAttributes=Sx,s.postMapLoadEvent=Gn,s.postPerformanceEvent=Ue,s.postTurnstileEvent=Pt,s.potpack=D3,s.prevPowerOfTwo=function(c){return c<=1?1:Math.pow(2,Math.floor(Math.log(c)/Math.LN2))},s.radToDeg=Ce,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(c){return c({pluginStatus:v,pluginURL:h}),I.on("pluginStateChange",c),c},s.removeAuthState=function(c){rr.delete(c)},s.renderColorRamp=x3,s.resample=uG,s.rotateX=t3,s.rotateX$1=X8,s.rotateY=I2,s.rotateY$1=Z8,s.rotateZ=function(c,l,f){var p=Math.sin(f),A=Math.cos(f),b=l[0],C=l[1],M=l[2],N=l[3],U=l[4],W=l[5],K=l[6],ee=l[7];return l!==c&&(c[8]=l[8],c[9]=l[9],c[10]=l[10],c[11]=l[11],c[12]=l[12],c[13]=l[13],c[14]=l[14],c[15]=l[15]),c[0]=b*A+U*p,c[1]=C*A+W*p,c[2]=M*A+K*p,c[3]=N*A+ee*p,c[4]=U*A-b*p,c[5]=W*A-C*p,c[6]=K*A-M*p,c[7]=ee*A-N*p,c},s.rotateZ$1=function(c,l,f){f*=.5;var p=l[0],A=l[1],b=l[2],C=l[3],M=Math.sin(f),N=Math.cos(f);return c[0]=p*N+A*M,c[1]=A*N-p*M,c[2]=b*N+C*M,c[3]=C*N-b*M,c},s.scale=YA,s.scale$1=$8,s.scale$2=Ku,s.scaleAndAdd=wx,s.set=function(c,l,f,p){return c[0]=l,c[1]=f,c[2]=p,c},s.setCacheLimits=function(c,l){Fa=c,Nl=l},s.setColumn=function(c,l,f){c[4*l+0]=f[0],c[4*l+1]=f[1],c[4*l+2]=f[2],c[4*l+3]=f[3]},s.setRTLTextPlugin=function(c,l,f=!1){if(v===px||v===gx||v===mx)throw new Error("setRTLTextPlugin cannot be called multiple times.");h=Vo.resolveURL(c),v=px,Zg=l,S(),f||$()},s.smoothstep=De,s.spec=pt,s.squaredLength=function(c){var l=c[0],f=c[1],p=c[2];return l*l+f*f+p*p},s.storeAuthState=function(c,l){l?rr.add(c):rr.delete(c)},s.sub=Qf,s.subtract=r3,s.symbolSize=Mde,s.tileAABB=function(c,l,f,p,A,b,C,M,N){if(N.name==="globe")return whe(c,l,new $2(f,p,A));const U=r0({z:f,x:p,y:A},N);return new cl([(b+U.x/U.scale)*l,l*(U.y/U.scale),C],[(b+U.x2/U.scale)*l,l*(U.y2/U.scale),M])},s.tileCornersToBounds=O2,s.tileTransform=r0,s.transformMat3=function(c,l,f){var p=l[0],A=l[1],b=l[2];return c[0]=p*f[0]+A*f[3]+b*f[6],c[1]=p*f[1]+A*f[4]+b*f[7],c[2]=p*f[2]+A*f[5]+b*f[8],c},s.transformMat4=Fo,s.transformMat4$1=QA,s.transformQuat=V8,s.transitionTileAABBinECEF=eG,s.translate=yx,s.transpose=function(c,l){if(c===l){var f=l[1],p=l[2],A=l[5];c[1]=l[3],c[2]=l[6],c[3]=f,c[5]=l[7],c[6]=p,c[7]=A}else c[0]=l[0],c[1]=l[3],c[2]=l[6],c[3]=l[1],c[4]=l[4],c[5]=l[7],c[6]=l[2],c[7]=l[5],c[8]=l[8];return c},s.triggerPluginCompletionEvent=m,s.uniqueId=In,s.updateGlobeVertexNormal=function(c,l,f,p,A){const b=5*l+2;c.float32[b+0]=f,c.float32[b+1]=p,c.float32[b+2]=A},s.validateCustomStyleLayer=function(c){const l=[],f=c.id;return f===void 0&&l.push({message:`layers.${f}: missing required property "id"`}),c.render===void 0&&l.push({message:`layers.${f}: missing required method "render"`}),c.renderingMode&&c.renderingMode!=="2d"&&c.renderingMode!=="3d"&&l.push({message:`layers.${f}: property "renderingMode" must be either "2d" or "3d"`}),l},s.validateFilter=c=>Cn(td(c)),s.validateFog=c=>Cn(_e(c)),s.validateLayer=c=>Cn(R(c)),s.validateLight=c=>Cn(ae(c)),s.validateSource=c=>Cn(G(c)),s.validateStyle=kt,s.validateTerrain=c=>Cn(pe(c)),s.values=ct,s.vectorTile=G2,s.version=d,s.warnOnce=$t,s.window=u,s.wrap=Re}),o(["./shared"],function(s){function u(Ge){if(typeof Ge=="number"||typeof Ge=="boolean"||typeof Ge=="string"||Ge==null)return JSON.stringify(Ge);if(Array.isArray(Ge)){let Ae="[";for(const ze of Ge)Ae+=`${u(ze)},`;return`${Ae}]`}let ge="{";for(const Ae of Object.keys(Ge).sort())ge+=`${Ae}:${u(Ge[Ae])},`;return`${ge}}`}function d(Ge){let ge="";for(const Ae of s.refProperties)ge+=`/${u(Ge[Ae])}`;return ge}class g{constructor(ge){this.keyCache={},ge&&this.replace(ge)}replace(ge){this._layerConfigs={},this._layers={},this.update(ge,[])}update(ge,Ae){for(const Me of ge)this._layerConfigs[Me.id]=Me,(this._layers[Me.id]=s.createStyleLayer(Me)).compileFilter(),this.keyCache[Me.id]&&delete this.keyCache[Me.id];for(const Me of Ae)delete this.keyCache[Me],delete this._layerConfigs[Me],delete this._layers[Me];this.familiesBySource={};const ze=function(Me,rt){const ht={};for(let nt=0;nt<Me.length;nt++){const wt=rt&&rt[Me[nt].id]||d(Me[nt]);rt&&(rt[Me[nt].id]=wt);let sn=ht[wt];sn||(sn=ht[wt]=[]),sn.push(Me[nt])}const ft=[];for(const nt in ht)ft.push(ht[nt]);return ft}(s.values(this._layerConfigs),this.keyCache);for(const Me of ze){const rt=Me.map(dn=>this._layers[dn.id]),ht=rt[0];if(ht.visibility==="none")continue;const ft=ht.source||"";let nt=this.familiesBySource[ft];nt||(nt=this.familiesBySource[ft]={});const wt=ht.sourceLayer||"_geojsonTileLayer";let sn=nt[wt];sn||(sn=nt[wt]=[]),sn.push(rt)}}}class _{loadTile(ge,Ae){const{uid:ze,encoding:Me,rawImageData:rt,padding:ht,buildQuadTree:ft}=ge,nt=s.window.ImageBitmap&&rt instanceof s.window.ImageBitmap?this.getImageData(rt,ht):rt;Ae(null,new s.DEMData(ze,nt,Me,ht<1,ft))}getImageData(ge,Ae){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ge.width,ge.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ge.width,this.offscreenCanvas.height=ge.height,this.offscreenCanvasContext.drawImage(ge,0,0,ge.width,ge.height);const ze=this.offscreenCanvasContext.getImageData(-Ae,-Ae,ge.width+2*Ae,ge.height+2*Ae);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ze}}function E(Ge,ge){if(Ge.length!==0){P(Ge[0],ge);for(var Ae=1;Ae<Ge.length;Ae++)P(Ge[Ae],!ge)}}function P(Ge,ge){for(var Ae=0,ze=0,Me=0,rt=Ge.length,ht=rt-1;Me<rt;ht=Me++){var ft=(Ge[Me][0]-Ge[ht][0])*(Ge[ht][1]+Ge[Me][1]),nt=Ae+ft;ze+=Math.abs(Ae)>=Math.abs(ft)?Ae-nt+ft:ft-nt+Ae,Ae=nt}Ae+ze>=0!=!!ge&&Ge.reverse()}var O=s.getDefaultExportFromCjs(function Ge(ge,Ae){var ze,Me=ge&&ge.type;if(Me==="FeatureCollection")for(ze=0;ze<ge.features.length;ze++)Ge(ge.features[ze],Ae);else if(Me==="GeometryCollection")for(ze=0;ze<ge.geometries.length;ze++)Ge(ge.geometries[ze],Ae);else if(Me==="Feature")Ge(ge.geometry,Ae);else if(Me==="Polygon")E(ge.coordinates,Ae);else if(Me==="MultiPolygon")for(ze=0;ze<ge.coordinates.length;ze++)E(ge.coordinates[ze],Ae);return ge});const D=s.VectorTileFeature.prototype.toGeoJSON;var V={exports:{}},k=s.pointGeometry,F=s.vectorTile.VectorTileFeature,z=X;function X(Ge,ge){this.options=ge||{},this.features=Ge,this.length=Ge.length}function Y(Ge,ge){this.id=typeof Ge.id=="number"?Ge.id:void 0,this.type=Ge.type,this.rawGeometry=Ge.type===1?[Ge.geometry]:Ge.geometry,this.properties=Ge.tags,this.extent=ge||4096}X.prototype.feature=function(Ge){return new Y(this.features[Ge],this.options.extent)},Y.prototype.loadGeometry=function(){var Ge=this.rawGeometry;this.geometry=[];for(var ge=0;ge<Ge.length;ge++){for(var Ae=Ge[ge],ze=[],Me=0;Me<Ae.length;Me++)ze.push(new k(Ae[Me][0],Ae[Me][1]));this.geometry.push(ze)}return this.geometry},Y.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Ge=this.geometry,ge=1/0,Ae=-1/0,ze=1/0,Me=-1/0,rt=0;rt<Ge.length;rt++)for(var ht=Ge[rt],ft=0;ft<ht.length;ft++){var nt=ht[ft];ge=Math.min(ge,nt.x),Ae=Math.max(Ae,nt.x),ze=Math.min(ze,nt.y),Me=Math.max(Me,nt.y)}return[ge,ze,Ae,Me]},Y.prototype.toGeoJSON=F.prototype.toGeoJSON;var J=s.pbf,re=z;function ue(Ge){var ge=new J;return function(Ae,ze){for(var Me in Ae.layers)ze.writeMessage(3,ie,Ae.layers[Me])}(Ge,ge),ge.finish()}function ie(Ge,ge){var Ae;ge.writeVarintField(15,Ge.version||1),ge.writeStringField(1,Ge.name||""),ge.writeVarintField(5,Ge.extent||4096);var ze={keys:[],values:[],keycache:{},valuecache:{}};for(Ae=0;Ae<Ge.length;Ae++)ze.feature=Ge.feature(Ae),ge.writeMessage(2,ce,ze);var Me=ze.keys;for(Ae=0;Ae<Me.length;Ae++)ge.writeStringField(3,Me[Ae]);var rt=ze.values;for(Ae=0;Ae<rt.length;Ae++)ge.writeMessage(4,Ye,rt[Ae])}function ce(Ge,ge){var Ae=Ge.feature;Ae.id!==void 0&&ge.writeVarintField(1,Ae.id),ge.writeMessage(2,se,Ge),ge.writeVarintField(3,Ae.type),ge.writeMessage(4,we,Ae)}function se(Ge,ge){var Ae=Ge.feature,ze=Ge.keys,Me=Ge.values,rt=Ge.keycache,ht=Ge.valuecache;for(var ft in Ae.properties){var nt=Ae.properties[ft],wt=rt[ft];if(nt!==null){wt===void 0&&(ze.push(ft),rt[ft]=wt=ze.length-1),ge.writeVarint(wt);var sn=typeof nt;sn!=="string"&&sn!=="boolean"&&sn!=="number"&&(nt=JSON.stringify(nt));var dn=sn+":"+nt,Qt=ht[dn];Qt===void 0&&(Me.push(nt),ht[dn]=Qt=Me.length-1),ge.writeVarint(Qt)}}}function me(Ge,ge){return(ge<<3)+(7&Ge)}function Ce(Ge){return Ge<<1^Ge>>31}function we(Ge,ge){for(var Ae=Ge.loadGeometry(),ze=Ge.type,Me=0,rt=0,ht=Ae.length,ft=0;ft<ht;ft++){var nt=Ae[ft],wt=1;ze===1&&(wt=nt.length),ge.writeVarint(me(1,wt));for(var sn=ze===3?nt.length-1:nt.length,dn=0;dn<sn;dn++){dn===1&&ze!==1&&ge.writeVarint(me(2,sn-1));var Qt=nt[dn].x-Me,sr=nt[dn].y-rt;ge.writeVarint(Ce(Qt)),ge.writeVarint(Ce(sr)),Me+=Qt,rt+=sr}ze===3&&ge.writeVarint(me(7,1))}}function Ye(Ge,ge){var Ae=typeof Ge;Ae==="string"?ge.writeStringField(1,Ge):Ae==="boolean"?ge.writeBooleanField(7,Ge):Ae==="number"&&(Ge%1!=0?ge.writeDoubleField(3,Ge):Ge<0?ge.writeSVarintField(6,Ge):ge.writeVarintField(5,Ge))}V.exports=ue,V.exports.fromVectorTileJs=ue,V.exports.fromGeojsonVt=function(Ge,ge){ge=ge||{};var Ae={};for(var ze in Ge)Ae[ze]=new re(Ge[ze].features,ge),Ae[ze].name=ze,Ae[ze].version=ge.version,Ae[ze].extent=ge.extent;return ue({layers:Ae})},V.exports.GeoJSONWrapper=re;var at=s.getDefaultExportFromCjs(V.exports);const yt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Ge=>Ge},be=Math.fround||(De=new Float32Array(1),Ge=>(De[0]=+Ge,De[0]));var De;const Re=3,qe=5,ct=6;class Ct{constructor(ge){this.options=Object.assign(Object.create(yt),ge),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ge){const{log:Ae,minZoom:ze,maxZoom:Me}=this.options;Ae&&console.time("total time");const rt=`prepare ${ge.length} points`;Ae&&console.time(rt),this.points=ge;const ht=[];for(let nt=0;nt<ge.length;nt++){const wt=ge[nt];if(!wt.geometry)continue;const[sn,dn]=wt.geometry.coordinates,Qt=be(Mn(sn)),sr=be(Tn(dn));ht.push(Qt,sr,1/0,nt,-1,1),this.options.reduce&&ht.push(0)}let ft=this.trees[Me+1]=this._createTree(ht);Ae&&console.timeEnd(rt);for(let nt=Me;nt>=ze;nt--){const wt=+Date.now();ft=this.trees[nt]=this._createTree(this._cluster(ft,nt)),Ae&&console.log("z%d: %d clusters in %dms",nt,ft.numItems,+Date.now()-wt)}return Ae&&console.timeEnd("total time"),this}getClusters(ge,Ae){let ze=((ge[0]+180)%360+360)%360-180;const Me=Math.max(-90,Math.min(90,ge[1]));let rt=ge[2]===180?180:((ge[2]+180)%360+360)%360-180;const ht=Math.max(-90,Math.min(90,ge[3]));if(ge[2]-ge[0]>=360)ze=-180,rt=180;else if(ze>rt){const dn=this.getClusters([ze,Me,180,ht],Ae),Qt=this.getClusters([-180,Me,rt,ht],Ae);return dn.concat(Qt)}const ft=this.trees[this._limitZoom(Ae)],nt=ft.range(Mn(ze),Tn(ht),Mn(rt),Tn(Me)),wt=ft.data,sn=[];for(const dn of nt){const Qt=this.stride*dn;sn.push(wt[Qt+qe]>1?Dt(wt,Qt,this.clusterProps):this.points[wt[Qt+Re]])}return sn}getChildren(ge){const Ae=this._getOriginId(ge),ze=this._getOriginZoom(ge),Me="No cluster with the specified id.",rt=this.trees[ze];if(!rt)throw new Error(Me);const ht=rt.data;if(Ae*this.stride>=ht.length)throw new Error(Me);const ft=this.options.radius/(this.options.extent*Math.pow(2,ze-1)),nt=rt.within(ht[Ae*this.stride],ht[Ae*this.stride+1],ft),wt=[];for(const sn of nt){const dn=sn*this.stride;ht[dn+4]===ge&&wt.push(ht[dn+qe]>1?Dt(ht,dn,this.clusterProps):this.points[ht[dn+Re]])}if(wt.length===0)throw new Error(Me);return wt}getLeaves(ge,Ae,ze){const Me=[];return this._appendLeaves(Me,ge,Ae=Ae||10,ze=ze||0,0),Me}getTile(ge,Ae,ze){const Me=this.trees[this._limitZoom(ge)],rt=Math.pow(2,ge),{extent:ht,radius:ft}=this.options,nt=ft/ht,wt=(ze-nt)/rt,sn=(ze+1+nt)/rt,dn={features:[]};return this._addTileFeatures(Me.range((Ae-nt)/rt,wt,(Ae+1+nt)/rt,sn),Me.data,Ae,ze,rt,dn),Ae===0&&this._addTileFeatures(Me.range(1-nt/rt,wt,1,sn),Me.data,rt,ze,rt,dn),Ae===rt-1&&this._addTileFeatures(Me.range(0,wt,nt/rt,sn),Me.data,-1,ze,rt,dn),dn.features.length?dn:null}getClusterExpansionZoom(ge){let Ae=this._getOriginZoom(ge)-1;for(;Ae<=this.options.maxZoom;){const ze=this.getChildren(ge);if(Ae++,ze.length!==1)break;ge=ze[0].properties.cluster_id}return Ae}_appendLeaves(ge,Ae,ze,Me,rt){const ht=this.getChildren(Ae);for(const ft of ht){const nt=ft.properties;if(nt&&nt.cluster?rt+nt.point_count<=Me?rt+=nt.point_count:rt=this._appendLeaves(ge,nt.cluster_id,ze,Me,rt):rt<Me?rt++:ge.push(ft),ge.length===ze)break}return rt}_createTree(ge){const Ae=new s.KDBush(ge.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ze=0;ze<ge.length;ze+=this.stride)Ae.add(ge[ze],ge[ze+1]);return Ae.finish(),Ae.data=ge,Ae}_addTileFeatures(ge,Ae,ze,Me,rt,ht){for(const ft of ge){const nt=ft*this.stride,wt=Ae[nt+qe]>1;let sn,dn,Qt;if(wt)sn=In(Ae,nt,this.clusterProps),dn=Ae[nt],Qt=Ae[nt+1];else{const tr=this.points[Ae[nt+Re]];sn=tr.properties;const[ot,Pt]=tr.geometry.coordinates;dn=Mn(ot),Qt=Tn(Pt)}const sr={type:1,geometry:[[Math.round(this.options.extent*(dn*rt-ze)),Math.round(this.options.extent*(Qt*rt-Me))]],tags:sn};let pr;pr=wt||this.options.generateId?Ae[nt+Re]:this.points[Ae[nt+Re]].id,pr!==void 0&&(sr.id=pr),ht.features.push(sr)}}_limitZoom(ge){return Math.max(this.options.minZoom,Math.min(Math.floor(+ge),this.options.maxZoom+1))}_cluster(ge,Ae){const{radius:ze,extent:Me,reduce:rt,minPoints:ht}=this.options,ft=ze/(Me*Math.pow(2,Ae)),nt=ge.data,wt=[],sn=this.stride;for(let dn=0;dn<nt.length;dn+=sn){if(nt[dn+2]<=Ae)continue;nt[dn+2]=Ae;const Qt=nt[dn],sr=nt[dn+1],pr=ge.within(nt[dn],nt[dn+1],ft),tr=nt[dn+qe];let ot=tr;for(const Pt of pr){const rn=Pt*sn;nt[rn+2]>Ae&&(ot+=nt[rn+qe])}if(ot>tr&&ot>=ht){let Pt,rn=Qt*tr,Gn=sr*tr,w=-1;const Ue=((dn/sn|0)<<5)+(Ae+1)+this.points.length;for(const Ir of pr){const fr=Ir*sn;if(nt[fr+2]<=Ae)continue;nt[fr+2]=Ae;const rr=nt[fr+qe];rn+=nt[fr]*rr,Gn+=nt[fr+1]*rr,nt[fr+4]=Ue,rt&&(Pt||(Pt=this._map(nt,dn,!0),w=this.clusterProps.length,this.clusterProps.push(Pt)),rt(Pt,this._map(nt,fr)))}nt[dn+4]=Ue,wt.push(rn/ot,Gn/ot,1/0,Ue,-1,ot),rt&&wt.push(w)}else{for(let Pt=0;Pt<sn;Pt++)wt.push(nt[dn+Pt]);if(ot>1)for(const Pt of pr){const rn=Pt*sn;if(!(nt[rn+2]<=Ae)){nt[rn+2]=Ae;for(let Gn=0;Gn<sn;Gn++)wt.push(nt[rn+Gn])}}}}return wt}_getOriginId(ge){return ge-this.points.length>>5}_getOriginZoom(ge){return(ge-this.points.length)%32}_map(ge,Ae,ze){if(ge[Ae+qe]>1){const ht=this.clusterProps[ge[Ae+ct]];return ze?Object.assign({},ht):ht}const Me=this.points[ge[Ae+Re]].properties,rt=this.options.map(Me);return ze&&rt===Me?Object.assign({},rt):rt}}function Dt(Ge,ge,Ae){return{type:"Feature",id:Ge[ge+Re],properties:In(Ge,ge,Ae),geometry:{type:"Point",coordinates:[(ze=Ge[ge],360*(ze-.5)),Nt(Ge[ge+1])]}};var ze}function In(Ge,ge,Ae){const ze=Ge[ge+qe],Me=ze>=1e4?`${Math.round(ze/1e3)}k`:ze>=1e3?Math.round(ze/100)/10+"k":ze,rt=Ge[ge+ct],ht=rt===-1?{}:Object.assign({},Ae[rt]);return Object.assign(ht,{cluster:!0,cluster_id:Ge[ge+Re],point_count:ze,point_count_abbreviated:Me})}function Mn(Ge){return Ge/360+.5}function Tn(Ge){const ge=Math.sin(Ge*Math.PI/180),Ae=.5-.25*Math.log((1+ge)/(1-ge))/Math.PI;return Ae<0?0:Ae>1?1:Ae}function Nt(Ge){const ge=(180-360*Ge)*Math.PI/180;return 360*Math.atan(Math.exp(ge))/Math.PI-90}function Zt(Ge,ge,Ae,ze){for(var Me,rt=ze,ht=Ae-ge>>1,ft=Ae-ge,nt=Ge[ge],wt=Ge[ge+1],sn=Ge[Ae],dn=Ge[Ae+1],Qt=ge+3;Qt<Ae;Qt+=3){var sr=Wt(Ge[Qt],Ge[Qt+1],nt,wt,sn,dn);if(sr>rt)Me=Qt,rt=sr;else if(sr===rt){var pr=Math.abs(Qt-ht);pr<ft&&(Me=Qt,ft=pr)}}rt>ze&&(Me-ge>3&&Zt(Ge,ge,Me,ze),Ge[Me+2]=rt,Ae-Me>3&&Zt(Ge,Me,Ae,ze))}function Wt(Ge,ge,Ae,ze,Me,rt){var ht=Me-Ae,ft=rt-ze;if(ht!==0||ft!==0){var nt=((Ge-Ae)*ht+(ge-ze)*ft)/(ht*ht+ft*ft);nt>1?(Ae=Me,ze=rt):nt>0&&(Ae+=ht*nt,ze+=ft*nt)}return(ht=Ge-Ae)*ht+(ft=ge-ze)*ft}function hn(Ge,ge,Ae,ze){var Me={id:Ge===void 0?null:Ge,type:ge,geometry:Ae,tags:ze,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(rt){var ht=rt.geometry,ft=rt.type;if(ft==="Point"||ft==="MultiPoint"||ft==="LineString")lr(rt,ht);else if(ft==="Polygon"||ft==="MultiLineString")for(var nt=0;nt<ht.length;nt++)lr(rt,ht[nt]);else if(ft==="MultiPolygon")for(nt=0;nt<ht.length;nt++)for(var wt=0;wt<ht[nt].length;wt++)lr(rt,ht[nt][wt])}(Me),Me}function lr(Ge,ge){for(var Ae=0;Ae<ge.length;Ae+=3)Ge.minX=Math.min(Ge.minX,ge[Ae]),Ge.minY=Math.min(Ge.minY,ge[Ae+1]),Ge.maxX=Math.max(Ge.maxX,ge[Ae]),Ge.maxY=Math.max(Ge.maxY,ge[Ae+1])}function It(Ge,ge,Ae,ze){if(ge.geometry){var Me=ge.geometry.coordinates,rt=ge.geometry.type,ht=Math.pow(Ae.tolerance/((1<<Ae.maxZoom)*Ae.extent),2),ft=[],nt=ge.id;if(Ae.promoteId?nt=ge.properties[Ae.promoteId]:Ae.generateId&&(nt=ze||0),rt==="Point")Xt(Me,ft);else if(rt==="MultiPoint")for(var wt=0;wt<Me.length;wt++)Xt(Me[wt],ft);else if(rt==="LineString")$t(Me,ft,ht,!1);else if(rt==="MultiLineString"){if(Ae.lineMetrics){for(wt=0;wt<Me.length;wt++)$t(Me[wt],ft=[],ht,!1),Ge.push(hn(nt,"LineString",ft,ge.properties));return}cn(Me,ft,ht,!1)}else if(rt==="Polygon")cn(Me,ft,ht,!0);else{if(rt!=="MultiPolygon"){if(rt==="GeometryCollection"){for(wt=0;wt<ge.geometry.geometries.length;wt++)It(Ge,{id:nt,geometry:ge.geometry.geometries[wt],properties:ge.properties},Ae,ze);return}throw new Error("Input data is not a valid GeoJSON object.")}for(wt=0;wt<Me.length;wt++){var sn=[];cn(Me[wt],sn,ht,!0),ft.push(sn)}}Ge.push(hn(nt,rt,ft,ge.properties))}}function Xt(Ge,ge){ge.push(Jt(Ge[0])),ge.push(Ln(Ge[1])),ge.push(0)}function $t(Ge,ge,Ae,ze){for(var Me,rt,ht=0,ft=0;ft<Ge.length;ft++){var nt=Jt(Ge[ft][0]),wt=Ln(Ge[ft][1]);ge.push(nt),ge.push(wt),ge.push(0),ft>0&&(ht+=ze?(Me*wt-nt*rt)/2:Math.sqrt(Math.pow(nt-Me,2)+Math.pow(wt-rt,2))),Me=nt,rt=wt}var sn=ge.length-3;ge[2]=1,Zt(ge,0,sn,Ae),ge[sn+2]=1,ge.size=Math.abs(ht),ge.start=0,ge.end=ge.size}function cn(Ge,ge,Ae,ze){for(var Me=0;Me<Ge.length;Me++){var rt=[];$t(Ge[Me],rt,Ae,ze),ge.push(rt)}}function Jt(Ge){return Ge/360+.5}function Ln(Ge){var ge=Math.sin(Ge*Math.PI/180),Ae=.5-.25*Math.log((1+ge)/(1-ge))/Math.PI;return Ae<0?0:Ae>1?1:Ae}function qn(Ge,ge,Ae,ze,Me,rt,ht,ft){if(ze/=ge,rt>=(Ae/=ge)&&ht<ze)return Ge;if(ht<Ae||rt>=ze)return null;for(var nt=[],wt=0;wt<Ge.length;wt++){var sn=Ge[wt],dn=sn.geometry,Qt=sn.type,sr=Me===0?sn.minX:sn.minY,pr=Me===0?sn.maxX:sn.maxY;if(sr>=Ae&&pr<ze)nt.push(sn);else if(!(pr<Ae||sr>=ze)){var tr=[];if(Qt==="Point"||Qt==="MultiPoint")or(dn,tr,Ae,ze,Me);else if(Qt==="LineString")cr(dn,tr,Ae,ze,Me,!1,ft.lineMetrics);else if(Qt==="MultiLineString")Ri(dn,tr,Ae,ze,Me,!1);else if(Qt==="Polygon")Ri(dn,tr,Ae,ze,Me,!0);else if(Qt==="MultiPolygon")for(var ot=0;ot<dn.length;ot++){var Pt=[];Ri(dn[ot],Pt,Ae,ze,Me,!0),Pt.length&&tr.push(Pt)}if(tr.length){if(ft.lineMetrics&&Qt==="LineString"){for(ot=0;ot<tr.length;ot++)nt.push(hn(sn.id,Qt,tr[ot],sn.tags));continue}Qt!=="LineString"&&Qt!=="MultiLineString"||(tr.length===1?(Qt="LineString",tr=tr[0]):Qt="MultiLineString"),Qt!=="Point"&&Qt!=="MultiPoint"||(Qt=tr.length===3?"Point":"MultiPoint"),nt.push(hn(sn.id,Qt,tr,sn.tags))}}}return nt.length?nt:null}function or(Ge,ge,Ae,ze,Me){for(var rt=0;rt<Ge.length;rt+=3){var ht=Ge[rt+Me];ht>=Ae&&ht<=ze&&(ge.push(Ge[rt]),ge.push(Ge[rt+1]),ge.push(Ge[rt+2]))}}function cr(Ge,ge,Ae,ze,Me,rt,ht){for(var ft,nt,wt=cs(Ge),sn=Me===0?Fa:Nl,dn=Ge.start,Qt=0;Qt<Ge.length-3;Qt+=3){var sr=Ge[Qt],pr=Ge[Qt+1],tr=Ge[Qt+2],ot=Ge[Qt+3],Pt=Ge[Qt+4],rn=Me===0?sr:pr,Gn=Me===0?ot:Pt,w=!1;ht&&(ft=Math.sqrt(Math.pow(sr-ot,2)+Math.pow(pr-Pt,2))),rn<Ae?Gn>Ae&&(nt=sn(wt,sr,pr,ot,Pt,Ae),ht&&(wt.start=dn+ft*nt)):rn>ze?Gn<ze&&(nt=sn(wt,sr,pr,ot,Pt,ze),ht&&(wt.start=dn+ft*nt)):Do(wt,sr,pr,tr),Gn<Ae&&rn>=Ae&&(nt=sn(wt,sr,pr,ot,Pt,Ae),w=!0),Gn>ze&&rn<=ze&&(nt=sn(wt,sr,pr,ot,Pt,ze),w=!0),!rt&&w&&(ht&&(wt.end=dn+ft*nt),ge.push(wt),wt=cs(Ge)),ht&&(dn+=ft)}var Ue=Ge.length-3;sr=Ge[Ue],pr=Ge[Ue+1],tr=Ge[Ue+2],(rn=Me===0?sr:pr)>=Ae&&rn<=ze&&Do(wt,sr,pr,tr),Ue=wt.length-3,rt&&Ue>=3&&(wt[Ue]!==wt[0]||wt[Ue+1]!==wt[1])&&Do(wt,wt[0],wt[1],wt[2]),wt.length&&ge.push(wt)}function cs(Ge){var ge=[];return ge.size=Ge.size,ge.start=Ge.start,ge.end=Ge.end,ge}function Ri(Ge,ge,Ae,ze,Me,rt){for(var ht=0;ht<Ge.length;ht++)cr(Ge[ht],ge,Ae,ze,Me,rt,!1)}function Do(Ge,ge,Ae,ze){Ge.push(ge),Ge.push(Ae),Ge.push(ze)}function Fa(Ge,ge,Ae,ze,Me,rt){var ht=(rt-ge)/(ze-ge);return Ge.push(rt),Ge.push(Ae+(Me-Ae)*ht),Ge.push(1),ht}function Nl(Ge,ge,Ae,ze,Me,rt){var ht=(rt-Ae)/(Me-Ae);return Ge.push(ge+(ze-ge)*ht),Ge.push(rt),Ge.push(1),ht}function _s(Ge,ge){for(var Ae=[],ze=0;ze<Ge.length;ze++){var Me,rt=Ge[ze],ht=rt.type;if(ht==="Point"||ht==="MultiPoint"||ht==="LineString")Me=mo(rt.geometry,ge);else if(ht==="MultiLineString"||ht==="Polygon"){Me=[];for(var ft=0;ft<rt.geometry.length;ft++)Me.push(mo(rt.geometry[ft],ge))}else if(ht==="MultiPolygon")for(Me=[],ft=0;ft<rt.geometry.length;ft++){for(var nt=[],wt=0;wt<rt.geometry[ft].length;wt++)nt.push(mo(rt.geometry[ft][wt],ge));Me.push(nt)}Ae.push(hn(rt.id,ht,Me,rt.tags))}return Ae}function mo(Ge,ge){var Ae=[];Ae.size=Ge.size,Ge.start!==void 0&&(Ae.start=Ge.start,Ae.end=Ge.end);for(var ze=0;ze<Ge.length;ze+=3)Ae.push(Ge[ze]+ge,Ge[ze+1],Ge[ze+2]);return Ae}function Fl(Ge,ge){if(Ge.transformed)return Ge;var Ae,ze,Me,rt=1<<Ge.z,ht=Ge.x,ft=Ge.y;for(Ae=0;Ae<Ge.features.length;Ae++){var nt=Ge.features[Ae],wt=nt.geometry,sn=nt.type;if(nt.geometry=[],sn===1)for(ze=0;ze<wt.length;ze+=2)nt.geometry.push(su(wt[ze],wt[ze+1],ge,rt,ht,ft));else for(ze=0;ze<wt.length;ze++){var dn=[];for(Me=0;Me<wt[ze].length;Me+=2)dn.push(su(wt[ze][Me],wt[ze][Me+1],ge,rt,ht,ft));nt.geometry.push(dn)}}return Ge.transformed=!0,Ge}function su(Ge,ge,Ae,ze,Me,rt){return[Math.round(Ae*(Ge*ze-Me)),Math.round(Ae*(ge*ze-rt))]}function kl(Ge,ge,Ae,ze,Me){for(var rt=ge===Me.maxZoom?0:Me.tolerance/((1<<ge)*Me.extent),ht={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Ae,y:ze,z:ge,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},ft=0;ft<Ge.length;ft++){ht.numFeatures++,au(ht,Ge[ft],rt,Me);var nt=Ge[ft].minX,wt=Ge[ft].minY,sn=Ge[ft].maxX,dn=Ge[ft].maxY;nt<ht.minX&&(ht.minX=nt),wt<ht.minY&&(ht.minY=wt),sn>ht.maxX&&(ht.maxX=sn),dn>ht.maxY&&(ht.maxY=dn)}return ht}function au(Ge,ge,Ae,ze){var Me=ge.geometry,rt=ge.type,ht=[];if(rt==="Point"||rt==="MultiPoint")for(var ft=0;ft<Me.length;ft+=3)ht.push(Me[ft]),ht.push(Me[ft+1]),Ge.numPoints++,Ge.numSimplified++;else if(rt==="LineString")$u(ht,Me,Ge,Ae,!1,!1);else if(rt==="MultiLineString"||rt==="Polygon")for(ft=0;ft<Me.length;ft++)$u(ht,Me[ft],Ge,Ae,rt==="Polygon",ft===0);else if(rt==="MultiPolygon")for(var nt=0;nt<Me.length;nt++){var wt=Me[nt];for(ft=0;ft<wt.length;ft++)$u(ht,wt[ft],Ge,Ae,!0,ft===0)}if(ht.length){var sn=ge.tags||null;if(rt==="LineString"&&ze.lineMetrics){for(var dn in sn={},ge.tags)sn[dn]=ge.tags[dn];sn.mapbox_clip_start=Me.start/Me.size,sn.mapbox_clip_end=Me.end/Me.size}var Qt={geometry:ht,type:rt==="Polygon"||rt==="MultiPolygon"?3:rt==="LineString"||rt==="MultiLineString"?2:1,tags:sn};ge.id!==null&&(Qt.id=ge.id),Ge.features.push(Qt)}}function $u(Ge,ge,Ae,ze,Me,rt){var ht=ze*ze;if(ze>0&&ge.size<(Me?ht:ze))Ae.numPoints+=ge.length/3;else{for(var ft=[],nt=0;nt<ge.length;nt+=3)(ze===0||ge[nt+2]>ht)&&(Ae.numSimplified++,ft.push(ge[nt]),ft.push(ge[nt+1])),Ae.numPoints++;Me&&function(wt,sn){for(var dn=0,Qt=0,sr=wt.length,pr=sr-2;Qt<sr;pr=Qt,Qt+=2)dn+=(wt[Qt]-wt[pr])*(wt[Qt+1]+wt[pr+1]);if(dn>0===sn)for(Qt=0,sr=wt.length;Qt<sr/2;Qt+=2){var tr=wt[Qt],ot=wt[Qt+1];wt[Qt]=wt[sr-2-Qt],wt[Qt+1]=wt[sr-1-Qt],wt[sr-2-Qt]=tr,wt[sr-1-Qt]=ot}}(ft,rt),Ge.push(ft)}}function lu(Ge,ge){var Ae=(ge=this.options=function(Me,rt){for(var ht in rt)Me[ht]=rt[ht];return Me}(Object.create(this.options),ge)).debug;if(Ae&&console.time("preprocess data"),ge.maxZoom<0||ge.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ge.promoteId&&ge.generateId)throw new Error("promoteId and generateId cannot be used together.");var ze=function(Me,rt){var ht=[];if(Me.type==="FeatureCollection")for(var ft=0;ft<Me.features.length;ft++)It(ht,Me.features[ft],rt,ft);else It(ht,Me.type==="Feature"?Me:{geometry:Me},rt);return ht}(Ge,ge);this.tiles={},this.tileCoords=[],Ae&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ge.indexMaxZoom,ge.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ze=function(Me,rt){var ht=rt.buffer/rt.extent,ft=Me,nt=qn(Me,1,-1-ht,ht,0,-1,2,rt),wt=qn(Me,1,1-ht,2+ht,0,-1,2,rt);return(nt||wt)&&(ft=qn(Me,1,-ht,1+ht,0,-1,2,rt)||[],nt&&(ft=_s(nt,1).concat(ft)),wt&&(ft=ft.concat(_s(wt,-1)))),ft}(ze,ge),ze.length&&this.splitTile(ze,0,0,0),Ae&&(ze.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Hu(Ge,ge,Ae){return 32*((1<<Ge)*Ae+ge)+Ge}function uu(Ge,ge){const Ae=Ge.tileID.canonical;if(!this._geoJSONIndex)return ge(null,null);const ze=this._geoJSONIndex.getTile(Ae.z,Ae.x,Ae.y);if(!ze)return ge(null,null);const Me=new class{constructor(ht){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=ht.length,this._features=ht}feature(ht){return new class{constructor(ft){this._feature=ft,this.extent=s.EXTENT,this.type=ft.type,this.properties=ft.tags,"id"in ft&&!isNaN(ft.id)&&(this.id=parseInt(ft.id,10))}loadGeometry(){if(this._feature.type===1){const ft=[];for(const nt of this._feature.geometry)ft.push([new s.Point(nt[0],nt[1])]);return ft}{const ft=[];for(const nt of this._feature.geometry){const wt=[];for(const sn of nt)wt.push(new s.Point(sn[0],sn[1]));ft.push(wt)}return ft}}toGeoJSON(ft,nt,wt){return D.call(this,ft,nt,wt)}}(this._features[ht])}}(ze.features);let rt=at(Me);rt.byteOffset===0&&rt.byteLength===rt.buffer.byteLength||(rt=new Uint8Array(rt)),ge(null,{vectorTile:Me,rawData:rt.buffer})}lu.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},lu.prototype.splitTile=function(Ge,ge,Ae,ze,Me,rt,ht){for(var ft=[Ge,ge,Ae,ze],nt=this.options,wt=nt.debug;ft.length;){ze=ft.pop(),Ae=ft.pop(),ge=ft.pop(),Ge=ft.pop();var sn=1<<ge,dn=Hu(ge,Ae,ze),Qt=this.tiles[dn];if(!Qt&&(wt>1&&console.time("creation"),Qt=this.tiles[dn]=kl(Ge,ge,Ae,ze,nt),this.tileCoords.push({z:ge,x:Ae,y:ze}),wt)){wt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ge,Ae,ze,Qt.numFeatures,Qt.numPoints,Qt.numSimplified),console.timeEnd("creation"));var sr="z"+ge;this.stats[sr]=(this.stats[sr]||0)+1,this.total++}if(Qt.source=Ge,Me){if(ge===nt.maxZoom||ge===Me)continue;var pr=1<<Me-ge;if(Ae!==Math.floor(rt/pr)||ze!==Math.floor(ht/pr))continue}else if(ge===nt.indexMaxZoom||Qt.numPoints<=nt.indexMaxPoints)continue;if(Qt.source=null,Ge.length!==0){wt>1&&console.time("clipping");var tr,ot,Pt,rn,Gn,w,Ue=.5*nt.buffer/nt.extent,Ir=.5-Ue,fr=.5+Ue,rr=1+Ue;tr=ot=Pt=rn=null,Gn=qn(Ge,sn,Ae-Ue,Ae+fr,0,Qt.minX,Qt.maxX,nt),w=qn(Ge,sn,Ae+Ir,Ae+rr,0,Qt.minX,Qt.maxX,nt),Ge=null,Gn&&(tr=qn(Gn,sn,ze-Ue,ze+fr,1,Qt.minY,Qt.maxY,nt),ot=qn(Gn,sn,ze+Ir,ze+rr,1,Qt.minY,Qt.maxY,nt),Gn=null),w&&(Pt=qn(w,sn,ze-Ue,ze+fr,1,Qt.minY,Qt.maxY,nt),rn=qn(w,sn,ze+Ir,ze+rr,1,Qt.minY,Qt.maxY,nt),w=null),wt>1&&console.timeEnd("clipping"),ft.push(tr||[],ge+1,2*Ae,2*ze),ft.push(ot||[],ge+1,2*Ae,2*ze+1),ft.push(Pt||[],ge+1,2*Ae+1,2*ze),ft.push(rn||[],ge+1,2*Ae+1,2*ze+1)}}},lu.prototype.getTile=function(Ge,ge,Ae){var ze=this.options,Me=ze.extent,rt=ze.debug;if(Ge<0||Ge>24)return null;var ht=1<<Ge,ft=Hu(Ge,ge=(ge%ht+ht)%ht,Ae);if(this.tiles[ft])return Fl(this.tiles[ft],Me);rt>1&&console.log("drilling down to z%d-%d-%d",Ge,ge,Ae);for(var nt,wt=Ge,sn=ge,dn=Ae;!nt&&wt>0;)wt--,sn=Math.floor(sn/2),dn=Math.floor(dn/2),nt=this.tiles[Hu(wt,sn,dn)];return nt&&nt.source?(rt>1&&console.log("found parent tile z%d-%d-%d",wt,sn,dn),rt>1&&console.time("drilling down"),this.splitTile(nt.source,wt,sn,dn,Ge,ge,Ae),rt>1&&console.timeEnd("drilling down"),this.tiles[ft]?Fl(this.tiles[ft],Me):null):null};class Fc extends s.VectorTileWorkerSource{constructor(ge,Ae,ze,Me,rt){super(ge,Ae,ze,Me,uu),rt&&(this.loadGeoJSON=rt)}loadData(ge,Ae){const ze=ge&&ge.request,Me=ze&&ze.collectResourceTiming;this.loadGeoJSON(ge,(rt,ht)=>{if(rt||!ht)return Ae(rt);if(typeof ht!="object")return Ae(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));{O(ht,!0);try{if(ge.filter){const nt=s.createExpression(ge.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(nt.result==="error")throw new Error(nt.value.map(sn=>`${sn.key}: ${sn.message}`).join(", "));ht={type:"FeatureCollection",features:ht.features.filter(sn=>nt.value.evaluate({zoom:0},sn))}}this._geoJSONIndex=ge.cluster?new Ct(function({superclusterOptions:nt,clusterProperties:wt}){if(!wt||!nt)return nt;const sn={},dn={},Qt={accumulated:null,zoom:0},sr={properties:null},pr=Object.keys(wt);for(const tr of pr){const[ot,Pt]=wt[tr],rn=s.createExpression(Pt),Gn=s.createExpression(typeof ot=="string"?[ot,["accumulated"],["get",tr]]:ot);sn[tr]=rn.value,dn[tr]=Gn.value}return nt.map=tr=>{sr.properties=tr;const ot={};for(const Pt of pr)ot[Pt]=sn[Pt].evaluate(Qt,sr);return ot},nt.reduce=(tr,ot)=>{sr.properties=ot;for(const Pt of pr)Qt.accumulated=tr[Pt],tr[Pt]=dn[Pt].evaluate(Qt,sr)},nt}(ge)).load(ht.features):function(nt,wt){return new lu(nt,wt)}(ht,ge.geojsonVtOptions)}catch(nt){return Ae(nt)}this.loaded={};const ft={};if(Me){const nt=s.getPerformanceMeasurement(ze);nt&&(ft.resourceTiming={},ft.resourceTiming[ge.source]=JSON.parse(JSON.stringify(nt)))}Ae(null,ft)}})}reloadTile(ge,Ae){const ze=this.loaded;return ze&&ze[ge.uid]?super.reloadTile(ge,Ae):this.loadTile(ge,Ae)}loadGeoJSON(ge,Ae){if(ge.request)s.getJSON(ge.request,Ae);else{if(typeof ge.data!="string")return Ae(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`));try{return Ae(null,JSON.parse(ge.data))}catch{return Ae(new Error(`Input data given to '${ge.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ge,Ae){try{Ae(null,this._geoJSONIndex.getClusterExpansionZoom(ge.clusterId))}catch(ze){Ae(ze)}}getClusterChildren(ge,Ae){try{Ae(null,this._geoJSONIndex.getChildren(ge.clusterId))}catch(ze){Ae(ze)}}getClusterLeaves(ge,Ae){try{Ae(null,this._geoJSONIndex.getLeaves(ge.clusterId,ge.limit,ge.offset))}catch(ze){Ae(ze)}}}class Wu{constructor(ge){this.self=ge,this.actor=new s.Actor(ge,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:Fc},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(Ae,ze)=>{if(this.workerSourceTypes[Ae])throw new Error(`Worker source with name "${Ae}" already registered.`);this.workerSourceTypes[Ae]=ze},this.self.registerRTLTextPlugin=Ae=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=Ae.applyArabicShaping,s.plugin.processBidirectionalText=Ae.processBidirectionalText,s.plugin.processStyledBidirectionalText=Ae.processStyledBidirectionalText}}clearCaches(ge,Ae,ze){delete this.layerIndexes[ge],delete this.availableImages[ge],delete this.workerSources[ge],delete this.demWorkerSources[ge],ze()}checkIfReady(ge,Ae,ze){ze()}setReferrer(ge,Ae){this.referrer=Ae}spriteLoaded(ge,Ae){this.isSpriteLoaded[ge]=Ae;for(const ze in this.workerSources[ge]){const Me=this.workerSources[ge][ze];for(const rt in Me)Me[rt]instanceof s.VectorTileWorkerSource&&(Me[rt].isSpriteLoaded=Ae,Me[rt].fire(new s.Event("isSpriteLoaded")))}}setImages(ge,Ae,ze){this.availableImages[ge]=Ae;for(const Me in this.workerSources[ge]){const rt=this.workerSources[ge][Me];for(const ht in rt)rt[ht].availableImages=Ae}ze()}enableTerrain(ge,Ae,ze){this.terrain=Ae,ze()}setProjection(ge,Ae){this.projections[ge]=s.getProjection(Ae)}setLayers(ge,Ae,ze){this.getLayerIndex(ge).replace(Ae),ze()}updateLayers(ge,Ae,ze){this.getLayerIndex(ge).update(Ae.layers,Ae.removedIds),ze()}loadTile(ge,Ae,ze){const Me=this.enableTerrain?s.extend({enableTerrain:this.terrain},Ae):Ae;Me.projection=this.projections[ge]||this.defaultProjection,this.getWorkerSource(ge,Ae.type,Ae.source).loadTile(Me,ze)}loadDEMTile(ge,Ae,ze){const Me=this.enableTerrain?s.extend({buildQuadTree:this.terrain},Ae):Ae;this.getDEMWorkerSource(ge,Ae.source).loadTile(Me,ze)}reloadTile(ge,Ae,ze){const Me=this.enableTerrain?s.extend({enableTerrain:this.terrain},Ae):Ae;Me.projection=this.projections[ge]||this.defaultProjection,this.getWorkerSource(ge,Ae.type,Ae.source).reloadTile(Me,ze)}abortTile(ge,Ae,ze){this.getWorkerSource(ge,Ae.type,Ae.source).abortTile(Ae,ze)}removeTile(ge,Ae,ze){this.getWorkerSource(ge,Ae.type,Ae.source).removeTile(Ae,ze)}removeSource(ge,Ae,ze){if(!this.workerSources[ge]||!this.workerSources[ge][Ae.type]||!this.workerSources[ge][Ae.type][Ae.source])return;const Me=this.workerSources[ge][Ae.type][Ae.source];delete this.workerSources[ge][Ae.type][Ae.source],Me.removeSource!==void 0?Me.removeSource(Ae,ze):ze()}loadWorkerSource(ge,Ae,ze){try{this.self.importScripts(Ae.url),ze()}catch(Me){ze(Me.toString())}}syncRTLPluginState(ge,Ae,ze){try{s.plugin.setState(Ae);const Me=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&Me!=null){this.self.importScripts(Me);const rt=s.plugin.isParsed();ze(rt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Me}`),rt)}}catch(Me){ze(Me.toString())}}getAvailableImages(ge){let Ae=this.availableImages[ge];return Ae||(Ae=[]),Ae}getLayerIndex(ge){let Ae=this.layerIndexes[ge];return Ae||(Ae=this.layerIndexes[ge]=new g),Ae}getWorkerSource(ge,Ae,ze){if(this.workerSources[ge]||(this.workerSources[ge]={}),this.workerSources[ge][Ae]||(this.workerSources[ge][Ae]={}),!this.workerSources[ge][Ae][ze]){const Me={send:(rt,ht,ft,nt,wt,sn)=>{this.actor.send(rt,ht,ft,ge,wt,sn)},scheduler:this.actor.scheduler};this.workerSources[ge][Ae][ze]=new this.workerSourceTypes[Ae](Me,this.getLayerIndex(ge),this.getAvailableImages(ge),this.isSpriteLoaded[ge])}return this.workerSources[ge][Ae][ze]}getDEMWorkerSource(ge,Ae){return this.demWorkerSources[ge]||(this.demWorkerSources[ge]={}),this.demWorkerSources[ge][Ae]||(this.demWorkerSources[ge][Ae]=new _),this.demWorkerSources[ge][Ae]}enforceCacheSizeLimit(ge,Ae){s.enforceCacheSizeLimit(Ae)}getWorkerPerformanceMetrics(ge,Ae,ze){ze(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Wu(self)),Wu}),o(["./shared"],function(s){function u(v,h){if(Array.isArray(v)){if(!Array.isArray(h)||v.length!==h.length)return!1;for(let m=0;m<v.length;m++)if(!u(v[m],h[m]))return!1;return!0}if(typeof v=="object"&&v!==null&&h!==null){if(typeof h!="object"||Object.keys(v).length!==Object.keys(h).length)return!1;for(const m in v)if(!u(v[m],h[m]))return!1;return!0}return v===h}var d=g;function g(v){return!function(h){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,I,L=new Blob([""],{type:"text/javascript"}),$=URL.createObjectURL(L);try{I=new Worker($),S=!0}catch{S=!1}return I&&I.terminate(),URL.revokeObjectURL($),S}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var S=document.createElement("canvas");S.width=S.height=1;var I=S.getContext("2d");if(!I)return!1;var L=I.getImageData(0,0,1,1);return L&&L.width===S.width}()?(_[m=h&&h.failIfMajorPerformanceCaveat]===void 0&&(_[m]=function(S){var I,L=function($){var H=document.createElement("canvas"),Q=Object.create(g.webGLContextAttributes);return Q.failIfMajorPerformanceCaveat=$,H.getContext("webgl",Q)||H.getContext("experimental-webgl",Q)}(S);if(!L)return!1;try{I=L.createShader(L.VERTEX_SHADER)}catch{return!1}return!(!I||L.isContextLost())&&(L.shaderSource(I,"void main() {}"),L.compileShader(I),L.getShaderParameter(I,L.COMPILE_STATUS)===!0)}(m)),_[m]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var m}(v)}var _={};function E(v,h,m){const S=s.window.document.createElement(v);return h!==void 0&&(S.className=h),m&&m.appendChild(S),S}function P(v,h,m){const S=s.window.document.createElementNS("http://www.w3.org/2000/svg",v);for(const I of Object.keys(h))S.setAttributeNS(null,I,h[I]);return m&&m.appendChild(S),S}g.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const O=s.window.document&&s.window.document.documentElement.style,D=O&&O.userSelect!==void 0?"userSelect":"WebkitUserSelect";let V;function k(){O&&D&&(V=O[D],O[D]="none")}function F(){O&&D&&(O[D]=V)}function z(v){v.preventDefault(),v.stopPropagation(),s.window.removeEventListener("click",z,!0)}function X(){s.window.addEventListener("click",z,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",z,!0)},0)}function Y(v,h){const m=v.getBoundingClientRect();return ue(v,m,h)}function J(v,h){const m=v.getBoundingClientRect(),S=[];for(let I=0;I<h.length;I++)S.push(ue(v,m,h[I]));return S}function re(v){return s.window.InstallTrigger!==void 0&&v.button===2&&v.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:v.button}function ue(v,h,m){const S=v.offsetWidth===h.width?1:v.offsetWidth/h.width;return new s.Point((m.clientX-h.left)*S,(m.clientY-h.top)*S)}function ie(v,h){var m=h[0],S=h[1],I=h[2],L=h[3],$=m*L-I*S;return $?(v[0]=L*($=1/$),v[1]=-S*$,v[2]=-I*$,v[3]=m*$,v):null}function ce(v){const{userImage:h}=v;return!!(h&&h.render&&h.render())&&(v.data.replace(new Uint8Array(h.data.buffer)),!0)}class se extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(h){if(this.loaded!==h&&(this.loaded=h,h)){for(const{ids:m,callback:S}of this.requestors)this._notify(m,S);this.requestors=[]}}hasImage(h){return!!this.getImage(h)}getImage(h){return this.images[h]}addImage(h,m){this._validate(h,m)&&(this.images[h]=m)}_validate(h,m){let S=!0;return this._validateStretch(m.stretchX,m.data&&m.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${h}" has invalid "stretchX" value`))),S=!1),this._validateStretch(m.stretchY,m.data&&m.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${h}" has invalid "stretchY" value`))),S=!1),this._validateContent(m.content,m)||(this.fire(new s.ErrorEvent(new Error(`Image "${h}" has invalid "content" value`))),S=!1),S}_validateStretch(h,m){if(!h)return!0;let S=0;for(const I of h){if(I[0]<S||I[1]<I[0]||m<I[1])return!1;S=I[1]}return!0}_validateContent(h,m){return!(h&&(h.length!==4||h[0]<0||m.data.width<h[0]||h[1]<0||m.data.height<h[1]||h[2]<0||m.data.width<h[2]||h[3]<0||m.data.height<h[3]||h[2]<h[0]||h[3]<h[1]))}updateImage(h,m){m.version=this.images[h].version+1,this.images[h]=m,this.updatedImages[h]=!0}removeImage(h){const m=this.images[h];delete this.images[h],delete this.patterns[h],m.userImage&&m.userImage.onRemove&&m.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(h,m){let S=!0;if(!this.isLoaded())for(const I of h)this.images[I]||(S=!1);this.isLoaded()||S?this._notify(h,m):this.requestors.push({ids:h,callback:m})}_notify(h,m){const S={};for(const I of h){this.images[I]||this.fire(new s.Event("styleimagemissing",{id:I}));const L=this.images[I];L?S[I]={data:L.data.clone(),pixelRatio:L.pixelRatio,sdf:L.sdf,version:L.version,stretchX:L.stretchX,stretchY:L.stretchY,content:L.content,hasRenderCallback:!!(L.userImage&&L.userImage.render)}:s.warnOnce(`Image "${I}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}m(null,S)}getPixelSize(){const{width:h,height:m}=this.atlasImage;return{width:h,height:m}}getPattern(h){const m=this.patterns[h],S=this.getImage(h);if(!S)return null;if(m&&m.position.version===S.version)return m.position;if(m)m.position.version=S.version;else{const I={w:S.data.width+2,h:S.data.height+2,x:0,y:0},L=new s.ImagePosition(I,S);this.patterns[h]={bin:I,position:L}}return this._updatePatternAtlas(),this.patterns[h].position}bind(h){const m=h.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(h,this.atlasImage,m.RGBA),this.atlasTexture&&this.atlasTexture.bind(m.LINEAR,m.CLAMP_TO_EDGE)}_updatePatternAtlas(){const h=[];for(const L in this.patterns)h.push(this.patterns[L].bin);const{w:m,h:S}=s.potpack(h),I=this.atlasImage;I.resize({width:m||1,height:S||1});for(const L in this.patterns){const{bin:$}=this.patterns[L],H=$.x+1,Q=$.y+1,ne=this.images[L].data,te=ne.width,fe=ne.height;s.RGBAImage.copy(ne,I,{x:0,y:0},{x:H,y:Q},{width:te,height:fe}),s.RGBAImage.copy(ne,I,{x:0,y:fe-1},{x:H,y:Q-1},{width:te,height:1}),s.RGBAImage.copy(ne,I,{x:0,y:0},{x:H,y:Q+fe},{width:te,height:1}),s.RGBAImage.copy(ne,I,{x:te-1,y:0},{x:H-1,y:Q},{width:1,height:fe}),s.RGBAImage.copy(ne,I,{x:0,y:0},{x:H+te,y:Q},{width:1,height:fe})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(h){for(const m of h){if(this.callbackDispatchedThisFrame[m])continue;this.callbackDispatchedThisFrame[m]=!0;const S=this.images[m];ce(S)&&this.updateImage(m,S)}}}const me=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(v,h){return function([m,S,I]){const L=s.degToRad(S+90),$=s.degToRad(I);return{x:m*Math.cos(L)*Math.sin($),y:m*Math.sin(L)*Math.sin($),z:m*Math.cos($),azimuthal:S,polar:I}}(v.expression.evaluate(h))}interpolate(v,h,m){return{x:s.number(v.x,h.x,m),y:s.number(v.y,h.y,m),z:s.number(v.z,h.z,m),azimuthal:s.number(v.azimuthal,h.azimuthal,m),polar:s.number(v.polar,h.polar,m)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)});class Ce extends s.Evented{constructor(h){super(),this._transitionable=new s.Transitionable(me),this.setLight(h),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(h,m={}){if(!this._validate(s.validateLight,h,m))for(const S in h){const I=h[S];s.endsWith(S,"-transition")?this._transitionable.setTransition(S.slice(0,-11),I):this._transitionable.setValue(S,I)}}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,m,S){return(!S||S.validate!==!1)&&s.emitValidationErrors(this,h.call(s.validateStyle,s.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const we=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)});let Ye=class extends s.Evented{constructor(v,h){super(),this._transitionable=new s.Transitionable(we),this.set(v),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=h}get(){return this._transitionable.serialize()}set(v){for(const h in v){const m=v[h];s.endsWith(h,"-transition")?this._transitionable.setTransition(h.slice(0,-11),m):this._transitionable.setValue(h,m)}}updateTransitions(v){this._transitioning=this._transitionable.transitioned(v,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(v){this.properties=this._transitioning.possiblyEvaluate(v)}};function at(v,h,m,S){const I=s.smoothstep(45,65,m),[L,$]=yt(v,S),H=s.length(h);let Q=1-Math.min(1,Math.exp((H-L)/($-L)*-6));return Q*=Q*Q,Q=Math.min(1,1.00747*Q),Q*I*v.alpha}function yt(v,h){const m=.5/Math.tan(.5*h);return[v.range[0]+m,v.range[1]+m]}const be=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])});class De extends s.Evented{constructor(h,m){super(),this._transitionable=new s.Transitionable(be),this.set(h),this._transitioning=this._transitionable.untransitioned(),this._transform=m}get state(){const h=this._transform,m=h.projection.name==="globe",S=s.globeToMercatorTransition(h.zoom),I=this.properties.get("range"),L=[.5,3];return{range:m?[s.number(L[0],I[0],S),s.number(L[1],I[1],S)]:I,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(h,m={}){if(!this._validate(s.validateFog,h,m)){for(const S of Object.keys(s.spec.fog))h&&h[S]===void 0&&(h[S]=s.spec.fog[S].default);for(const S in h){const I=h[S];s.endsWith(S,"-transition")?this._transitionable.setTransition(S.slice(0,-11),I):this._transitionable.setValue(S,I)}}}getOpacity(h){if(!this._transform.projection.supportsFog)return 0;const m=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.smoothstep(45,65,h))*m.a}getOpacityAtLatLng(h,m){return this._transform.projection.supportsFog?function(S,I,L){const $=s.MercatorCoordinate.fromLngLat(I),H=L.elevation?L.elevation.getAtPointOrZero($):0,Q=[$.x,$.y,H];return s.transformMat4(Q,Q,L.mercatorFogMatrix),at(S,Q,L.pitch,L._fov)}(this.state,h,m):0}getFovAdjustedRange(h){return this._transform.projection.supportsFog?yt(this.state,h):[0,1]}updateTransitions(h){this._transitioning=this._transitionable.transitioned(h,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(h){this.properties=this._transitioning.possiblyEvaluate(h)}_validate(h,m,S){return(!S||S.validate!==!1)&&s.emitValidationErrors(this,h.call(s.validateStyle,s.extend({value:m,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class Re{constructor(h,m){this.workerPool=h,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const S=this.workerPool.acquire(this.id);for(let I=0;I<S.length;I++){const L=new Re.Actor(S[I],m,this.id);L.name=`Worker ${I}`,this.actors.push(L)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(h,m,S){s.asyncAll(this.actors,(I,L)=>{I.send(h,m,L)},S=S||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(h=>{h.remove()}),this.actors=[],this.workerPool.release(this.id)}}function qe(v,h,m){return h*(s.EXTENT/(v.tileSize*Math.pow(2,m-v.tileID.overscaledZ)))}Re.Actor=s.Actor;class ct{constructor(h,m,S,I){this.screenBounds=h,this.cameraPoint=m,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=S,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,I)}static createFromScreenPoints(h,m){let S,I;if(h instanceof s.Point||typeof h[0]=="number"){const L=s.Point.convert(h);S=[L],I=m.isPointAboveHorizon(L)}else{const L=s.Point.convert(h[0]),$=s.Point.convert(h[1]);S=[L,$],I=s.polygonizeBounds(L,$).every(H=>m.isPointAboveHorizon(H))}return new ct(S,m.getCameraPoint(),I,m)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(h){return s.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],h)}bufferedCameraGeometry(h){const m=this.screenBounds[0],S=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],I=s.polygonizeBounds(m,S,0,!1);return this.cameraPoint.y>S.y&&(this.cameraPoint.x>m.x&&this.cameraPoint.x<S.x?I.splice(3,0,this.cameraPoint):this.cameraPoint.x>=S.x?I[2]=this.cameraPoint:this.cameraPoint.x<=m.x&&(I[3]=this.cameraPoint)),s.bufferConvexPolygon(I,h)}bufferedCameraGeometryGlobe(h){const m=this.screenBounds[0],S=this.screenBounds.length===1?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],I=s.polygonizeBounds(m,S,h),L=this.cameraPoint.clone();switch(3*((L.y>m.y)+(L.y>S.y))+((L.x>m.x)+(L.x>S.x))){case 0:I[0]=L,I[4]=L.clone();break;case 1:I.splice(1,0,L);break;case 2:I[1]=L;break;case 3:I.splice(4,0,L);break;case 5:I.splice(2,0,L);break;case 6:I[3]=L;break;case 7:I.splice(3,0,L);break;case 8:I[2]=L}return I}containsTile(h,m,S,I=0){const L=h.queryPadding/m._pixelsPerMercatorPixel+1,$=S?this._bufferedCameraMercator(L,m):this._bufferedScreenMercator(L,m);let H=h.tileID.wrap+($.unwrapped?I:0);const Q=$.polygon.map(Le=>s.getTilePoint(h.tileTransform,Le,H));if(!s.polygonIntersectsBox(Q,0,0,s.EXTENT,s.EXTENT))return;H=h.tileID.wrap+(this.screenGeometryMercator.unwrapped?I:0);const ne=this.screenGeometryMercator.polygon.map(Le=>s.getTileVec3(h.tileTransform,Le,H)),te=ne.map(Le=>new s.Point(Le[0],Le[1])),fe=m.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),ve=s.getTileVec3(h.tileTransform,fe,H),Te=ne.map(Le=>{const he=s.sub(Le,Le,ve);return s.normalize(he,he),new s.Ray(ve,he)}),Ie=qe(h,1,m.zoom)*m._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:te,tilespaceRays:Te,bufferedTilespaceGeometry:Q,bufferedTilespaceBounds:(Pe=s.getBounds(Q),Pe.min.x=s.clamp(Pe.min.x,0,s.EXTENT),Pe.min.y=s.clamp(Pe.min.y,0,s.EXTENT),Pe.max.x=s.clamp(Pe.max.x,0,s.EXTENT),Pe.max.y=s.clamp(Pe.max.y,0,s.EXTENT),Pe),tile:h,tileID:h.tileID,pixelToTileUnitsFactor:Ie};var Pe}_bufferedScreenMercator(h,m){const S=In(h);if(this._screenRaycastCache[S])return this._screenRaycastCache[S];{let I;return I=m.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(h),m):{polygon:this.bufferedScreenGeometry(h).map(L=>m.pointCoordinate3D(L)),unwrapped:!0},this._screenRaycastCache[S]=I,I}}_bufferedCameraMercator(h,m){const S=In(h);if(this._cameraRaycastCache[S])return this._cameraRaycastCache[S];{let I;return I=m.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(h),m):{polygon:this.bufferedCameraGeometry(h).map(L=>m.pointCoordinate3D(L)),unwrapped:!0},this._cameraRaycastCache[S]=I,I}}_projectAndResample(h,m){const S=function(L,$){const H=s.multiply([],$.pixelMatrix,$.globeMatrix),Q=[0,-s.GLOBE_RADIUS,0,1],ne=[0,s.GLOBE_RADIUS,0,1],te=[0,0,0,1];s.transformMat4$1(Q,Q,H),s.transformMat4$1(ne,ne,H),s.transformMat4$1(te,te,H);const fe=new s.Point(Q[0]/Q[3],Q[1]/Q[3]),ve=new s.Point(ne[0]/ne[3],ne[1]/ne[3]),Te=s.polygonContainsPoint(L,fe)&&Q[3]<te[3],Ie=s.polygonContainsPoint(L,ve)&&ne[3]<te[3];if(!Te&&!Ie)return null;const Pe=function(Je,lt,st){for(let xt=1;xt<Je.length;xt++){const en=Dt(lt.pointCoordinate3D(Je[xt-1]).x),mt=Dt(lt.pointCoordinate3D(Je[xt]).x);if(st<0){if(en<mt)return{idx:xt,t:-en/(mt-1-en)}}else if(mt<en)return{idx:xt,t:(1-en)/(mt+1-en)}}return null}(L,$,Te?-1:1);if(!Pe)return null;const{idx:Le,t:he}=Pe;let Se=Le>1?Ct(L.slice(0,Le),$):[],Fe=Le<L.length?Ct(L.slice(Le),$):[];Se=Se.map(Je=>new s.Point(Dt(Je.x),Je.y)),Fe=Fe.map(Je=>new s.Point(Dt(Je.x),Je.y));const ke=[...Se];ke.length===0&&ke.push(Fe[Fe.length-1]);const Qe=s.number(ke[ke.length-1].y,(Fe.length===0?Se[0]:Fe[0]).y,he);let et;return et=Te?[new s.Point(0,Qe),new s.Point(0,0),new s.Point(1,0),new s.Point(1,Qe)]:[new s.Point(1,Qe),new s.Point(1,1),new s.Point(0,1),new s.Point(0,Qe)],ke.push(...et),Fe.length===0?ke.push(Se[0]):ke.push(...Fe),{polygon:ke.map(Je=>new s.MercatorCoordinate(Je.x,Je.y)),unwrapped:!1}}(h,m);if(S)return S;const I=function(L,$){let H=!1,Q=-1/0,ne=0;for(let fe=0;fe<L.length-1;fe++)L[fe].x>Q&&(Q=L[fe].x,ne=fe);for(let fe=0;fe<L.length-1;fe++){const ve=(ne+fe)%(L.length-1),Te=L[ve],Ie=L[ve+1];Math.abs(Te.x-Ie.x)>.5&&(Te.x<Ie.x?(Te.x+=1,ve===0&&(L[L.length-1].x+=1)):(Ie.x+=1,ve+1===L.length-1&&(L[0].x+=1)),H=!0)}const te=s.mercatorXfromLng($.center.lng);return H&&te<Math.abs(te-1)&&L.forEach(fe=>{fe.x-=1}),{polygon:L,unwrapped:H}}(Ct(h,m).map(L=>new s.Point(Dt(L.x),L.y)),m);return{polygon:I.polygon.map(L=>new s.MercatorCoordinate(L.x,L.y)),unwrapped:I.unwrapped}}}function Ct(v,h){return s.resample(v,m=>{const S=h.pointCoordinate3D(m);m.x=S.x,m.y=S.y},1/256)}function Dt(v){return v<0?1+v%1:v%1}function In(v){return 100*v|0}function Mn(v,h,m,S,I){const L=function($,H){if($)return I($);if(H){v.url&&H.tiles&&v.tiles&&delete v.tiles;const Q=s.pick(s.extend(H,v),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);H.vector_layers&&(Q.vectorLayers=H.vector_layers,Q.vectorLayerIds=Q.vectorLayers.map(ne=>ne.id)),Q.tiles=h.canonicalizeTileset(Q,v.url),I(null,Q)}};return v.url?s.getJSON(h.transformRequest(h.normalizeSourceURL(v.url,null,m,S),s.ResourceType.Source),L):s.exported.frame(()=>L(null,v))}class Tn{constructor(h,m,S){this.bounds=s.LngLatBounds.convert(this.validateBounds(h)),this.minzoom=m||0,this.maxzoom=S||24}validateBounds(h){return Array.isArray(h)&&h.length===4?[Math.max(-180,h[0]),Math.max(-90,h[1]),Math.min(180,h[2]),Math.min(90,h[3])]:[-180,-90,180,90]}contains(h){const m=Math.pow(2,h.z),S=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*m),I=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*m),L=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*m),$=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*m);return h.x>=S&&h.x<L&&h.y>=I&&h.y<$}}class Nt{constructor(h,m,S){this.context=h;const I=h.gl;this.buffer=I.createBuffer(),this.dynamicDraw=!!S,this.context.unbindVAO(),h.bindElementBuffer.set(this.buffer),I.bufferData(I.ELEMENT_ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?I.DYNAMIC_DRAW:I.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(h){const m=this.context.gl;this.context.unbindVAO(),this.bind(),m.bufferSubData(m.ELEMENT_ARRAY_BUFFER,0,h.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Zt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Wt{constructor(h,m,S,I){this.length=m.length,this.attributes=S,this.itemSize=m.bytesPerElement,this.dynamicDraw=I,this.context=h;const L=h.gl;this.buffer=L.createBuffer(),h.bindVertexBuffer.set(this.buffer),L.bufferData(L.ARRAY_BUFFER,m.arrayBuffer,this.dynamicDraw?L.DYNAMIC_DRAW:L.STATIC_DRAW),this.dynamicDraw||m.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(h){const m=this.context.gl;this.bind(),m.bufferSubData(m.ARRAY_BUFFER,0,h.arrayBuffer)}enableAttributes(h,m){for(let S=0;S<this.attributes.length;S++){const I=m.attributes[this.attributes[S].name];I!==void 0&&h.enableVertexAttribArray(I)}}setVertexAttribPointers(h,m,S){for(let I=0;I<this.attributes.length;I++){const L=this.attributes[I],$=m.attributes[L.name];$!==void 0&&h.vertexAttribPointer($,L.components,h[Zt[L.type]],!1,this.itemSize,L.offset+this.itemSize*(S||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class hn{constructor(h){this.gl=h.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(h){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class lr extends hn{getDefault(){return s.Color.transparent}set(h){const m=this.current;(h.r!==m.r||h.g!==m.g||h.b!==m.b||h.a!==m.a||this.dirty)&&(this.gl.clearColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class It extends hn{getDefault(){return 1}set(h){(h!==this.current||this.dirty)&&(this.gl.clearDepth(h),this.current=h,this.dirty=!1)}}class Xt extends hn{getDefault(){return 0}set(h){(h!==this.current||this.dirty)&&(this.gl.clearStencil(h),this.current=h,this.dirty=!1)}}class $t extends hn{getDefault(){return[!0,!0,!0,!0]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||h[3]!==m[3]||this.dirty)&&(this.gl.colorMask(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class cn extends hn{getDefault(){return!0}set(h){(h!==this.current||this.dirty)&&(this.gl.depthMask(h),this.current=h,this.dirty=!1)}}class Jt extends hn{getDefault(){return 255}set(h){(h!==this.current||this.dirty)&&(this.gl.stencilMask(h),this.current=h,this.dirty=!1)}}class Ln extends hn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(h){const m=this.current;(h.func!==m.func||h.ref!==m.ref||h.mask!==m.mask||this.dirty)&&(this.gl.stencilFunc(h.func,h.ref,h.mask),this.current=h,this.dirty=!1)}}class qn extends hn{getDefault(){const h=this.gl;return[h.KEEP,h.KEEP,h.KEEP]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||this.dirty)&&(this.gl.stencilOp(h[0],h[1],h[2]),this.current=h,this.dirty=!1)}}class or extends hn{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.STENCIL_TEST):m.disable(m.STENCIL_TEST),this.current=h,this.dirty=!1}}class cr extends hn{getDefault(){return[0,1]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||this.dirty)&&(this.gl.depthRange(h[0],h[1]),this.current=h,this.dirty=!1)}}class cs extends hn{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.DEPTH_TEST):m.disable(m.DEPTH_TEST),this.current=h,this.dirty=!1}}class Ri extends hn{getDefault(){return this.gl.LESS}set(h){(h!==this.current||this.dirty)&&(this.gl.depthFunc(h),this.current=h,this.dirty=!1)}}class Do extends hn{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.BLEND):m.disable(m.BLEND),this.current=h,this.dirty=!1}}class Fa extends hn{getDefault(){const h=this.gl;return[h.ONE,h.ZERO]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||this.dirty)&&(this.gl.blendFunc(h[0],h[1]),this.current=h,this.dirty=!1)}}class Nl extends hn{getDefault(){return s.Color.transparent}set(h){const m=this.current;(h.r!==m.r||h.g!==m.g||h.b!==m.b||h.a!==m.a||this.dirty)&&(this.gl.blendColor(h.r,h.g,h.b,h.a),this.current=h,this.dirty=!1)}}class _s extends hn{getDefault(){return this.gl.FUNC_ADD}set(h){(h!==this.current||this.dirty)&&(this.gl.blendEquation(h),this.current=h,this.dirty=!1)}}class mo extends hn{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;h?m.enable(m.CULL_FACE):m.disable(m.CULL_FACE),this.current=h,this.dirty=!1}}class Fl extends hn{getDefault(){return this.gl.BACK}set(h){(h!==this.current||this.dirty)&&(this.gl.cullFace(h),this.current=h,this.dirty=!1)}}class su extends hn{getDefault(){return this.gl.CCW}set(h){(h!==this.current||this.dirty)&&(this.gl.frontFace(h),this.current=h,this.dirty=!1)}}let kl,au=class extends hn{getDefault(){return null}set(v){(v!==this.current||this.dirty)&&(this.gl.useProgram(v),this.current=v,this.dirty=!1)}};class $u extends hn{getDefault(){return this.gl.TEXTURE0}set(h){(h!==this.current||this.dirty)&&(this.gl.activeTexture(h),this.current=h,this.dirty=!1)}}class lu extends hn{getDefault(){const h=this.gl;return[0,0,h.drawingBufferWidth,h.drawingBufferHeight]}set(h){const m=this.current;(h[0]!==m[0]||h[1]!==m[1]||h[2]!==m[2]||h[3]!==m[3]||this.dirty)&&(this.gl.viewport(h[0],h[1],h[2],h[3]),this.current=h,this.dirty=!1)}}class Hu extends hn{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindFramebuffer(m.FRAMEBUFFER,h),this.current=h,this.dirty=!1}}class uu extends hn{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindRenderbuffer(m.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class Fc extends hn{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindTexture(m.TEXTURE_2D,h),this.current=h,this.dirty=!1}}class Wu extends hn{getDefault(){return null}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.bindBuffer(m.ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class Ge extends hn{getDefault(){return null}set(h){const m=this.gl;m.bindBuffer(m.ELEMENT_ARRAY_BUFFER,h),this.current=h,this.dirty=!1}}class ge extends hn{constructor(h){super(h),this.vao=h.extVertexArrayObject}getDefault(){return null}set(h){this.vao&&(h!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(h),this.current=h,this.dirty=!1)}}class Ae extends hn{getDefault(){return 4}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_ALIGNMENT,h),this.current=h,this.dirty=!1}}class ze extends hn{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_PREMULTIPLY_ALPHA_WEBGL,h),this.current=h,this.dirty=!1}}class Me extends hn{getDefault(){return!1}set(h){if(h===this.current&&!this.dirty)return;const m=this.gl;m.pixelStorei(m.UNPACK_FLIP_Y_WEBGL,h),this.current=h,this.dirty=!1}}class rt extends hn{constructor(h,m){super(h),this.context=h,this.parent=m}getDefault(){return null}}class ht extends rt{setDirty(){this.dirty=!0}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,h,0),this.current=h,this.dirty=!1}}class ft extends rt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(h){if(h===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const m=this.gl;m.framebufferRenderbuffer(m.FRAMEBUFFER,this.attachment(),m.RENDERBUFFER,h),this.current=h,this.dirty=!1}}class nt extends ft{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class wt{constructor(h,m,S,I){this.context=h,this.width=m,this.height=S;const L=this.framebuffer=h.gl.createFramebuffer();this.colorAttachment=new ht(h,L),I&&(this.depthAttachment=new ft(h,L))}destroy(){const h=this.context.gl,m=this.colorAttachment.get();if(m&&h.deleteTexture(m),this.depthAttachment){const S=this.depthAttachment.get();S&&h.deleteRenderbuffer(S)}h.deleteFramebuffer(this.framebuffer)}}class sn{constructor(h,m=!1){if(this.gl=h,this.isWebGL2=m,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),m){const S=h;this.extVertexArrayObject={createVertexArrayOES:S.createVertexArray.bind(h),deleteVertexArrayOES:S.deleteVertexArray.bind(h),bindVertexArrayOES:S.bindVertexArray.bind(h)}}this.clearColor=new lr(this),this.clearDepth=new It(this),this.clearStencil=new Xt(this),this.colorMask=new $t(this),this.depthMask=new cn(this),this.stencilMask=new Jt(this),this.stencilFunc=new Ln(this),this.stencilOp=new qn(this),this.stencilTest=new or(this),this.depthRange=new cr(this),this.depthTest=new cs(this),this.depthFunc=new Ri(this),this.blend=new Do(this),this.blendFunc=new Fa(this),this.blendColor=new Nl(this),this.blendEquation=new _s(this),this.cullFace=new mo(this),this.cullFaceSide=new Fl(this),this.frontFace=new su(this),this.program=new au(this),this.activeTexture=new $u(this),this.viewport=new lu(this),this.bindFramebuffer=new Hu(this),this.bindRenderbuffer=new uu(this),this.bindTexture=new Fc(this),this.bindVertexBuffer=new Wu(this),this.bindElementBuffer=new Ge(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ge(this),this.pixelStoreUnpack=new Ae(this),this.pixelStoreUnpackPremultiplyAlpha=new ze(this),this.pixelStoreUnpackFlipY=new Me(this),this.extTextureFilterAnisotropic=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=h.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=h.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=h.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=h.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),m||(this.extTextureHalfFloat=h.getExtension("OES_texture_half_float")),(m||this.extTextureHalfFloat&&h.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=h.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=m||h.getExtension("OES_standard_derivatives"),this.extTimerQuery=h.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=h.getParameter(h.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(h,m){return new Nt(this,h,m)}createVertexBuffer(h,m,S){return new Wt(this,h,m,S)}createRenderbuffer(h,m,S){const I=this.gl,L=I.createRenderbuffer();return this.bindRenderbuffer.set(L),I.renderbufferStorage(I.RENDERBUFFER,h,m,S),this.bindRenderbuffer.set(null),L}createFramebuffer(h,m,S){return new wt(this,h,m,S)}clear({color:h,depth:m,stencil:S}){const I=this.gl;let L=0;h&&(L|=I.COLOR_BUFFER_BIT,this.clearColor.set(h),this.colorMask.set([!0,!0,!0,!0])),m!==void 0&&(L|=I.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(m),this.depthMask.set(!0)),S!==void 0&&(L|=I.STENCIL_BUFFER_BIT,this.clearStencil.set(S),this.stencilMask.set(255)),I.clear(L)}setCullFace(h){h.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(h.mode),this.frontFace.set(h.frontFace))}setDepthMode(h){h.func!==this.gl.ALWAYS||h.mask?(this.depthTest.set(!0),this.depthFunc.set(h.func),this.depthMask.set(h.mask),this.depthRange.set(h.range)):this.depthTest.set(!1)}setStencilMode(h){h.test.func!==this.gl.ALWAYS||h.mask?(this.stencilTest.set(!0),this.stencilMask.set(h.mask),this.stencilOp.set([h.fail,h.depthFail,h.pass]),this.stencilFunc.set({func:h.test.func,ref:h.ref,mask:h.test.mask})):this.stencilTest.set(!1)}setColorMode(h){u(h.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(h.blendFunction),this.blendColor.set(h.blendColor)),this.colorMask.set(h.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class dn extends s.Evented{constructor(h,m,S,I){if(super(),this.id=h,this.dispatcher=S,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(m,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},m),this._collectResourceTiming=m.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(I),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(h){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const m=Array.isArray(this.map._language)?this.map._language.join():this.map._language,S=this.map._worldview;this._tileJSONRequest=Mn(this._options,this.map._requestManager,m,S,(I,L)=>{this._tileJSONRequest=null,this._loaded=!0,I?(m&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${m}`),S&&S.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${S}`),this.fire(new s.ErrorEvent(I))):L&&(s.extend(this,L),L.bounds&&(this.tileBounds=new Tn(L.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(L.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(I)})}loaded(){return this._loaded}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(h,m){const S=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme)),I={request:this.map._requestManager.transformRequest(S,s.ResourceType.Tile),data:void 0,uid:h.uid,tileID:h.tileID,tileZoom:h.tileZoom,zoom:h.tileID.overscaledZ,tileSize:this.tileSize*h.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:h.isSymbolTile};if(I.request.collectResourceTiming=this._collectResourceTiming,h.actor&&h.state!=="expired")h.state==="loading"?h.reloadCallback=m:h.request=h.actor.send("reloadTile",I,L.bind(this));else if(h.actor=this._tileWorkers[S]=this._tileWorkers[S]||this.dispatcher.getActor(),this.dispatcher.ready)h.request=h.actor.send("loadTile",I,L.bind(this),void 0,!0);else{const $=s.loadVectorTile.call({deduped:this._deduped},I,(H,Q)=>{H||!Q?L.call(this,H):(I.data={cacheControl:Q.cacheControl,expires:Q.expires,rawData:Q.rawData.slice(0)},h.actor&&h.actor.send("loadTile",I,L.bind(this),void 0,!0))},!0);h.request={cancel:$}}function L($,H){return delete h.request,h.aborted?m(null):$&&$.status!==404?m($):(H&&H.resourceTiming&&(h.resourceTiming=H.resourceTiming),this.map._refreshExpiredTiles&&H&&h.setExpiryData(H),h.loadVectorData(H,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),m(null),void(h.reloadCallback&&(this.loadTile(h,h.reloadCallback),h.reloadCallback=null)))}}abortTile(h){h.request&&(h.request.cancel(),delete h.request),h.actor&&h.actor.send("abortTile",{uid:h.uid,type:this.type,source:this.id})}unloadTile(h){h.unloadVectorData(),h.actor&&h.actor.send("removeTile",{uid:h.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Qt extends s.Evented{constructor(h,m,S,I){super(),this.id=h,this.dispatcher=S,this.setEventedParent(I),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},m),s.extend(this,s.pick(m,["url","scheme","tileSize"]))}load(h){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Mn(this._options,this.map._requestManager,null,null,(m,S)=>{this._tileJSONRequest=null,this._loaded=!0,m?this.fire(new s.ErrorEvent(m)):S&&(s.extend(this,S),S.bounds&&(this.tileBounds=new Tn(S.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(S.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),h&&h(m)})}loaded(){return this._loaded}onAdd(h){this.map=h,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(h){return this._options.tiles=h,this.reload(),this}setUrl(h){return this.url=h,this._options.url=h,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(h){return!this.tileBounds||this.tileBounds.contains(h.canonical)}loadTile(h,m){const S=s.exported.devicePixelRatio>=2,I=this.map._requestManager.normalizeTileURL(h.tileID.canonical.url(this.tiles,this.scheme),S,this.tileSize);h.request=s.getImage(this.map._requestManager.transformRequest(I,s.ResourceType.Tile),(L,$,H,Q)=>(delete h.request,h.aborted?(h.state="unloaded",m(null)):L?(h.state="errored",m(L)):$?(this.map._refreshExpiredTiles&&h.setExpiryData({cacheControl:H,expires:Q}),h.setTexture($,this.map.painter),h.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void m(null)):m(null)))}static loadTileData(h,m,S){h.setTexture(m,S)}static unloadTileData(h,m){h.texture&&m.saveTileTexture(h.texture)}abortTile(h,m){h.request&&(h.request.cancel(),delete h.request),m()}unloadTile(h,m){h.texture&&this.map.painter.saveTileTexture(h.texture),m()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function sr(v,h,m,S,I,L,$,H){const Q=[v,m,I,h,S,L,1,1,1],ne=[$,H,1],te=s.adjoint([],Q),[fe,ve,Te]=s.transformMat3(ne,ne,s.transpose(te,te));return s.multiply$1(Q,[fe,0,0,0,ve,0,0,0,Te],Q)}class pr extends s.Evented{constructor(h,m,S,I){super(),this.id=h,this.dispatcher=S,this.coordinates=m.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(I),this.options=m,this._dirty=!1}load(h,m){this._loaded=m||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(S,I)=>{if(this._imageRequest=null,this._loaded=!0,S)this.fire(new s.ErrorEvent(S));else if(I){const{HTMLImageElement:L}=s.window;this.image=I instanceof L?s.exported.getImageData(I):I,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,h&&(this.coordinates=h),this._finishLoading()}})}loaded(){return this._loaded}updateImage(h){return this.image&&h.url?(this._imageRequest&&h.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=h.url,this.load(h.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(h){this.map=h,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(h){this.coordinates=h,this._boundsArray=void 0;const m=h.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(S){let I=1/0,L=1/0,$=-1/0,H=-1/0;for(const fe of S)I=Math.min(I,fe.x),L=Math.min(L,fe.y),$=Math.max($,fe.x),H=Math.max(H,fe.y);const Q=Math.max($-I,H-L),ne=Math.max(0,Math.floor(-Math.log(Q)/Math.LN2)),te=Math.pow(2,ne);return new s.CanonicalTileID(ne,Math.floor((I+$)/2*te),Math.floor((L+H)/2*te))}(m),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(h){for(const Q in this.tiles){const ne=this.tiles[Q];ne.state!=="loaded"&&(ne.state="loaded",ne.texture=this.texture)}if(this._boundsArray)return;const m=s.tileTransform(this.tileID,this.map.transform.projection),[S,I,L,$]=this.coordinates.map(Q=>{const ne=m.projection.project(Q[0],Q[1]);return s.getTilePoint(m,ne)._round()});this.perspectiveTransform=function(Q,ne,te,fe,ve,Te,Ie,Pe,Le,he){const Se=sr(0,0,Q,0,0,ne,Q,ne),Fe=sr(te,fe,ve,Te,Ie,Pe,Le,he);return s.multiply$1(Fe,s.adjoint(Se,Se),Fe),[Fe[6]/Fe[8]*Q/s.EXTENT,Fe[7]/Fe[8]*ne/s.EXTENT]}(this.width,this.height,S.x,S.y,I.x,I.y,$.x,$.y,L.x,L.y);const H=this._boundsArray=new s.StructArrayLayout4i8;H.emplaceBack(S.x,S.y,0,0),H.emplaceBack(I.x,I.y,s.EXTENT,0),H.emplaceBack($.x,$.y,0,s.EXTENT),H.emplaceBack(L.x,L.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=h.createVertexBuffer(H,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const h=this.map.painter.context,m=h.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(h,this.image,m.RGBA),this.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(h)}loadTile(h,m){this.tileID&&this.tileID.equals(h.tileID.canonical)?(this.tiles[String(h.tileID.wrap)]=h,h.buckets={},m(null)):(h.state="errored",m(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const tr={vector:dn,raster:Qt,"raster-dem":class extends Qt{constructor(v,h,m,S){super(v,h,m,S),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},h),this.encoding=h.encoding||"mapbox"}loadTile(v,h){const m=this.map._requestManager.normalizeTileURL(v.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function S(I,L){I&&(v.state="errored",h(I)),L&&(v.dem=L,v.dem.onDeserialize(),v.needsHillshadePrepare=!0,v.needsDEMTextureUpload=!0,v.state="loaded",h(null))}v.request=s.getImage(this.map._requestManager.transformRequest(m,s.ResourceType.Tile),(function(I,L,$,H){if(delete v.request,v.aborted)v.state="unloaded",h(null);else if(I)v.state="errored",h(I);else if(L){this.map._refreshExpiredTiles&&v.setExpiryData({cacheControl:$,expires:H});const Q=s.window.ImageBitmap&&L instanceof s.window.ImageBitmap&&(kl==null&&(kl=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&typeof s.window.createImageBitmap=="function"),kl),ne=1-(L.width-s.prevPowerOfTwo(L.width))/2;ne<1||v.neighboringTiles||(v.neighboringTiles=this._getNeighboringTiles(v.tileID));const te=Q?L:s.exported.getImageData(L,ne),fe={uid:v.uid,coord:v.tileID,source:this.id,rawImageData:te,encoding:this.encoding,padding:ne};v.actor&&v.state!=="expired"||(v.actor=this.dispatcher.getActor(),v.actor.send("loadDEMTile",fe,S.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(v){const h=v.canonical,m=Math.pow(2,h.z),S=(h.x-1+m)%m,I=h.x===0?v.wrap-1:v.wrap,L=(h.x+1+m)%m,$=h.x+1===m?v.wrap+1:v.wrap,H={};return H[new s.OverscaledTileID(v.overscaledZ,I,h.z,S,h.y).key]={backfilled:!1},H[new s.OverscaledTileID(v.overscaledZ,$,h.z,L,h.y).key]={backfilled:!1},h.y>0&&(H[new s.OverscaledTileID(v.overscaledZ,I,h.z,S,h.y-1).key]={backfilled:!1},H[new s.OverscaledTileID(v.overscaledZ,v.wrap,h.z,h.x,h.y-1).key]={backfilled:!1},H[new s.OverscaledTileID(v.overscaledZ,$,h.z,L,h.y-1).key]={backfilled:!1}),h.y+1<m&&(H[new s.OverscaledTileID(v.overscaledZ,I,h.z,S,h.y+1).key]={backfilled:!1},H[new s.OverscaledTileID(v.overscaledZ,v.wrap,h.z,h.x,h.y+1).key]={backfilled:!1},H[new s.OverscaledTileID(v.overscaledZ,$,h.z,L,h.y+1).key]={backfilled:!1}),H}unloadTile(v){v.demTexture&&this.map.painter.saveTileTexture(v.demTexture),v.fbo&&(v.fbo.destroy(),delete v.fbo),v.dem&&delete v.dem,delete v.neighboringTiles,v.state="unloaded"}},geojson:class extends s.Evented{constructor(v,h,m,S){super(),this.id=v,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=m.getActor(),this.setEventedParent(S),this._data=h.data,this._options=s.extend({},h),this._collectResourceTiming=h.collectResourceTiming,h.maxzoom!==void 0&&(this.maxzoom=h.maxzoom),h.type&&(this.type=h.type),h.attribution&&(this.attribution=h.attribution),this.promoteId=h.promoteId;const I=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:h.cluster||!1,geojsonVtOptions:{buffer:(h.buffer!==void 0?h.buffer:128)*I,tolerance:(h.tolerance!==void 0?h.tolerance:.375)*I,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:h.lineMetrics||!1,generateId:h.generateId||!1},superclusterOptions:{maxZoom:h.clusterMaxZoom!==void 0?h.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,h.clusterMinPoints||2),extent:s.EXTENT,radius:(h.clusterRadius!==void 0?h.clusterRadius:50)*I,log:!1,generateId:h.generateId||!1},clusterProperties:h.clusterProperties,filter:h.filter},h.workerOptions)}onAdd(v){this.map=v,this.setData(this._data)}setData(v){return this._data=v,this._updateWorkerData(),this}getClusterExpansionZoom(v,h){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:v,source:this.id},h),this}getClusterChildren(v,h){return this.actor.send("geojson.getClusterChildren",{clusterId:v,source:this.id},h),this}getClusterLeaves(v,h,m,S){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:v,limit:h,offset:m},S),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const v=s.extend({},this.workerOptions),h=this._data;typeof h=="string"?(v.request=this.map._requestManager.transformRequest(s.exported.resolveURL(h),s.ResourceType.Source),v.request.collectResourceTiming=this._collectResourceTiming):v.data=JSON.stringify(h),this._pendingLoad=this.actor.send(`${this.type}.loadData`,v,(m,S)=>{if(this._loaded=!0,this._pendingLoad=null,m)this.fire(new s.ErrorEvent(m));else{const I={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&S&&S.resourceTiming&&S.resourceTiming[this.id]&&(I.resourceTiming=S.resourceTiming[this.id]),this.fire(new s.Event("data",I)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(v,h){const m=v.actor?"reloadTile":"loadTile";v.actor=this.actor,v.request=this.actor.send(m,{type:this.type,uid:v.uid,tileID:v.tileID,tileZoom:v.tileZoom,zoom:v.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(S,I)=>(delete v.request,v.unloadVectorData(),v.aborted?h(null):S?h(S):(v.loadVectorData(I,this.map.painter,m==="reloadTile"),h(null))),void 0,m==="loadTile")}abortTile(v){v.request&&(v.request.cancel(),delete v.request),v.aborted=!0}unloadTile(v){v.unloadVectorData(),this.actor.send("removeTile",{uid:v.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends pr{constructor(v,h,m,S){super(v,h,m,S),this.roundZoom=!0,this.type="video",this.options=h}load(){this._loaded=!1;const v=this.options;this.urls=[];for(const h of v.urls)this.urls.push(this.map._requestManager.transformRequest(h,s.ResourceType.Source).url);s.getVideo(this.urls,(h,m)=>{this._loaded=!0,h?this.fire(new s.ErrorEvent(h)):m&&(this.video=m,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(v){if(this.video){const h=this.video.seekable;v<h.start(0)||v>h.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${h.start(0)} and ${h.end(0)}-second mark.`))):this.video.currentTime=v}}getVideo(){return this.video}onAdd(v){this.map||(this.map=v,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const v=this.map.painter.context,h=v.gl;this.texture?this.video.paused||(this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),h.texSubImage2D(h.TEXTURE_2D,0,0,0,h.RGBA,h.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(v,this.video,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(v)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:pr,canvas:class extends pr{constructor(v,h,m,S){super(v,h,m,S),h.coordinates?Array.isArray(h.coordinates)&&h.coordinates.length===4&&!h.coordinates.some(I=>!Array.isArray(I)||I.length!==2||I.some(L=>typeof L!="number"))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${v}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${v}`,null,'missing required property "coordinates"'))),h.animate&&typeof h.animate!="boolean"&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${v}`,null,'optional "animate" property must be a boolean value'))),h.canvas?typeof h.canvas=="string"||h.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${v}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${v}`,null,'missing required property "canvas"'))),this.options=h,this.animate=h.animate===void 0||h.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(v){this.map=v,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let v=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,v=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,v=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const h=this.map.painter.context;this.texture?(v||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(h,this.canvas,h.gl.RGBA,{premultiply:!0}),this._prepareData(h)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const v of[this.canvas.width,this.canvas.height])if(isNaN(v)||v<=0)return!0;return!1}},custom:class extends s.Evented{constructor(v,h,m,S){super(),this.id=v,this.type="custom",this._dataType="raster",this._dispatcher=m,this._implementation=h,this.setEventedParent(S),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Tn(this._implementation.bounds,this.minzoom,this.maxzoom)),h.update=this._update.bind(this),h.clearTiles=this._clearTiles.bind(this),h.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(h,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(v){this._map=v,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(v),this.load()}onRemove(v){this._implementation.onRemove&&this._implementation.onRemove(v)}hasTile(v){if(this._implementation.hasTile){const{x:h,y:m,z:S}=v.canonical;return this._implementation.hasTile({x:h,y:m,z:S})}return!this.tileBounds||this.tileBounds.contains(v.canonical)}loadTile(v,h){const{x:m,y:S,z:I}=v.tileID.canonical,L=new s.window.AbortController;v.request=Promise.resolve(this._implementation.loadTile({x:m,y:S,z:I},{signal:L.signal})).then((function($){return delete v.request,v.aborted?(v.state="unloaded",h(null)):$===void 0?(v.state="errored",h(null)):$===null?(this.loadTileData(v,{width:this.tileSize,height:this.tileSize,data:null}),v.state="loaded",h(null)):function(H){return H instanceof s.window.ImageData||H instanceof s.window.HTMLCanvasElement||H instanceof s.window.ImageBitmap||H instanceof s.window.HTMLImageElement}($)?(this.loadTileData(v,$),v.state="loaded",void h(null)):(v.state="errored",h(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch($=>{$.code!==20&&(v.state="errored",h($))}),v.request.cancel=()=>L.abort()}loadTileData(v,h){Qt.loadTileData(v,h,this._map.painter)}unloadTileData(v){Qt.unloadTileData(v,this._map.painter)}unloadTile(v,h){if(this.unloadTileData(v),this._implementation.unloadTile){const{x:m,y:S,z:I}=v.tileID.canonical;this._implementation.unloadTile({x:m,y:S,z:I})}h()}abortTile(v,h){v.request&&v.request.cancel&&(v.request.cancel(),delete v.request),h()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(v=>({x:v.canonical.x,y:v.canonical.y,z:v.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},ot=function(v,h,m,S){const I=new tr[h.type](v,h,m,S);if(I.id!==v)throw new Error(`Expected Source id to be ${v} instead of ${I.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],I),I};function Pt(v,h){const m=s.identity([]);return s.scale(m,m,[.5*v.width,.5*-v.height,1]),s.translate(m,m,[1,-1,0]),s.multiply(m,m,v.calculateProjMatrix(h.toUnwrapped())),Float32Array.from(m)}function rn(v,h,m,S,I,L,$,H=!1){const Q=v.tilesIn(S,$,H);Q.sort(w);const ne=[];for(const fe of Q)ne.push({wrappedTileID:fe.tile.tileID.wrapped().key,queryResults:fe.tile.queryRenderedFeatures(h,m,v._state,fe,I,L,Pt(v.transform,fe.tile.tileID),H)});const te=function(fe){const ve={},Te={};for(const Ie of fe){const Pe=Ie.queryResults,Le=Ie.wrappedTileID,he=Te[Le]=Te[Le]||{};for(const Se in Pe){const Fe=Pe[Se],ke=he[Se]=he[Se]||{},Qe=ve[Se]=ve[Se]||[];for(const et of Fe)ke[et.featureIndex]||(ke[et.featureIndex]=!0,Qe.push(et))}}return ve}(ne);for(const fe in te)te[fe].forEach(ve=>{const Te=ve.feature,Ie=Te.layer;Ie&&Ie.type!=="background"&&Ie.type!=="sky"&&(Te.source=Ie.source,Ie["source-layer"]&&(Te.sourceLayer=Ie["source-layer"]),Te.state=Te.id!==void 0?v.getFeatureState(Ie["source-layer"],Te.id):{})});return te}function Gn(v,h){const m=v.getRenderableIds().map(L=>v.getTileByID(L)),S=[],I={};for(let L=0;L<m.length;L++){const $=m[L],H=$.tileID.canonical.key;I[H]||(I[H]=!0,$.querySourceFeatures(S,h))}return S}function w(v,h){const m=v.tileID,S=h.tileID;return m.overscaledZ-S.overscaledZ||m.canonical.y-S.canonical.y||m.wrap-S.wrap||m.canonical.x-S.canonical.x}function Ue(){return Zg.workerClass!=null?new Zg.workerClass:new s.window.Worker(Zg.workerUrl)}const Ir="mapboxgl_preloaded_worker_pool";class fr{constructor(){this.active={}}acquire(h){if(!this.workers)for(this.workers=[];this.workers.length<fr.workerCount;)this.workers.push(new Ue);return this.active[h]=!0,this.workers.slice()}release(h){delete this.active[h],this.numActive()===0&&(this.workers.forEach(m=>{m.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Ir]}numActive(){return Object.keys(this.active).length}}let rr;function Tr(){return rr||(rr=new fr),rr}function qi(v,h){const m={};for(const S in v)S!=="ref"&&(m[S]=v[S]);return s.refProperties.forEach(S=>{S in h&&(m[S]=h[S])}),m}function qr(v){v=v.slice();const h=Object.create(null);for(let m=0;m<v.length;m++)h[v[m].id]=v[m];for(let m=0;m<v.length;m++)"ref"in v[m]&&(v[m]=qi(v[m],h[v[m].ref]));return v}fr.workerCount=2;const jn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function ro(v,h,m){m.push({command:jn.addSource,args:[v,h[v]]})}function ca(v,h,m){h.push({command:jn.removeSource,args:[v]}),m[v]=!0}function kc(v,h,m,S){ca(v,m,S),ro(v,h,m)}function zl(v,h,m){let S;for(S in v[m])if(v[m].hasOwnProperty(S)&&S!=="data"&&!u(v[m][S],h[m][S]))return!1;for(S in h[m])if(h[m].hasOwnProperty(S)&&S!=="data"&&!u(v[m][S],h[m][S]))return!1;return!0}function Qr(v,h,m,S,I,L){let $;for($ in h=h||{},v=v||{})v.hasOwnProperty($)&&(u(v[$],h[$])||m.push({command:L,args:[S,$,h[$],I]}));for($ in h)h.hasOwnProperty($)&&!v.hasOwnProperty($)&&(u(v[$],h[$])||m.push({command:L,args:[S,$,h[$],I]}))}function Vo(v){return v.id}function Bo(v,h){return v[h.id]=h,v}class ka{constructor(h,m){this.reset(h,m)}reset(h,m){this.points=h||[],this._distances=[0];for(let S=1;S<this.points.length;S++)this._distances[S]=this._distances[S-1]+this.points[S].dist(this.points[S-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(m||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(h){if(this.points.length===1)return this.points[0];h=s.clamp(h,0,1);let m=1,S=this._distances[m];const I=h*this.paddedLength+this.padding;for(;S<I&&m<this._distances.length;)S=this._distances[++m];const L=m-1,$=this._distances[L],H=S-$,Q=H>0?(I-$)/H:0;return this.points[L].mult(1-Q).add(this.points[m].mult(Q))}}class $o{constructor(h,m,S){const I=this.boxCells=[],L=this.circleCells=[];this.xCellCount=Math.ceil(h/S),this.yCellCount=Math.ceil(m/S);for(let $=0;$<this.xCellCount*this.yCellCount;$++)I.push([]),L.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=h,this.height=m,this.xScale=this.xCellCount/h,this.yScale=this.yCellCount/m,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(h,m,S,I,L){this._forEachCell(m,S,I,L,this._insertBoxCell,this.boxUid++),this.boxKeys.push(h),this.bboxes.push(m),this.bboxes.push(S),this.bboxes.push(I),this.bboxes.push(L)}insertCircle(h,m,S,I){this._forEachCell(m-I,S-I,m+I,S+I,this._insertCircleCell,this.circleUid++),this.circleKeys.push(h),this.circles.push(m),this.circles.push(S),this.circles.push(I)}_insertBoxCell(h,m,S,I,L,$){this.boxCells[L].push($)}_insertCircleCell(h,m,S,I,L,$){this.circleCells[L].push($)}_query(h,m,S,I,L,$){if(S<0||h>this.width||I<0||m>this.height)return!L&&[];const H=[];if(h<=0&&m<=0&&this.width<=S&&this.height<=I){if(L)return!0;for(let Q=0;Q<this.boxKeys.length;Q++)H.push({key:this.boxKeys[Q],x1:this.bboxes[4*Q],y1:this.bboxes[4*Q+1],x2:this.bboxes[4*Q+2],y2:this.bboxes[4*Q+3]});for(let Q=0;Q<this.circleKeys.length;Q++){const ne=this.circles[3*Q],te=this.circles[3*Q+1],fe=this.circles[3*Q+2];H.push({key:this.circleKeys[Q],x1:ne-fe,y1:te-fe,x2:ne+fe,y2:te+fe})}return $?H.filter($):H}return this._forEachCell(h,m,S,I,this._queryCell,H,{hitTest:L,seenUids:{box:{},circle:{}}},$),L?H.length>0:H}_queryCircle(h,m,S,I,L){const $=h-S,H=h+S,Q=m-S,ne=m+S;if(H<0||$>this.width||ne<0||Q>this.height)return!I&&[];const te=[];return this._forEachCell($,Q,H,ne,this._queryCellCircle,te,{hitTest:I,circle:{x:h,y:m,radius:S},seenUids:{box:{},circle:{}}},L),I?te.length>0:te}query(h,m,S,I,L){return this._query(h,m,S,I,!1,L)}hitTest(h,m,S,I,L){return this._query(h,m,S,I,!0,L)}hitTestCircle(h,m,S,I){return this._queryCircle(h,m,S,!0,I)}_queryCell(h,m,S,I,L,$,H,Q){const ne=H.seenUids,te=this.boxCells[L];if(te!==null){const ve=this.bboxes;for(const Te of te)if(!ne.box[Te]){ne.box[Te]=!0;const Ie=4*Te;if(h<=ve[Ie+2]&&m<=ve[Ie+3]&&S>=ve[Ie+0]&&I>=ve[Ie+1]&&(!Q||Q(this.boxKeys[Te]))){if(H.hitTest)return $.push(!0),!0;$.push({key:this.boxKeys[Te],x1:ve[Ie],y1:ve[Ie+1],x2:ve[Ie+2],y2:ve[Ie+3]})}}}const fe=this.circleCells[L];if(fe!==null){const ve=this.circles;for(const Te of fe)if(!ne.circle[Te]){ne.circle[Te]=!0;const Ie=3*Te;if(this._circleAndRectCollide(ve[Ie],ve[Ie+1],ve[Ie+2],h,m,S,I)&&(!Q||Q(this.circleKeys[Te]))){if(H.hitTest)return $.push(!0),!0;{const Pe=ve[Ie],Le=ve[Ie+1],he=ve[Ie+2];$.push({key:this.circleKeys[Te],x1:Pe-he,y1:Le-he,x2:Pe+he,y2:Le+he})}}}}}_queryCellCircle(h,m,S,I,L,$,H,Q){const ne=H.circle,te=H.seenUids,fe=this.boxCells[L];if(fe!==null){const Te=this.bboxes;for(const Ie of fe)if(!te.box[Ie]){te.box[Ie]=!0;const Pe=4*Ie;if(this._circleAndRectCollide(ne.x,ne.y,ne.radius,Te[Pe+0],Te[Pe+1],Te[Pe+2],Te[Pe+3])&&(!Q||Q(this.boxKeys[Ie])))return $.push(!0),!0}}const ve=this.circleCells[L];if(ve!==null){const Te=this.circles;for(const Ie of ve)if(!te.circle[Ie]){te.circle[Ie]=!0;const Pe=3*Ie;if(this._circlesCollide(Te[Pe],Te[Pe+1],Te[Pe+2],ne.x,ne.y,ne.radius)&&(!Q||Q(this.circleKeys[Ie])))return $.push(!0),!0}}}_forEachCell(h,m,S,I,L,$,H,Q){const ne=this._convertToXCellCoord(h),te=this._convertToYCellCoord(m),fe=this._convertToXCellCoord(S),ve=this._convertToYCellCoord(I);for(let Te=ne;Te<=fe;Te++)for(let Ie=te;Ie<=ve;Ie++)if(L.call(this,h,m,S,I,this.xCellCount*Ie+Te,$,H,Q))return}_convertToXCellCoord(h){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(h*this.xScale)))}_convertToYCellCoord(h){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(h*this.yScale)))}_circlesCollide(h,m,S,I,L,$){const H=I-h,Q=L-m,ne=S+$;return ne*ne>H*H+Q*Q}_circleAndRectCollide(h,m,S,I,L,$,H){const Q=($-I)/2,ne=Math.abs(h-(I+Q));if(ne>Q+S)return!1;const te=(H-L)/2,fe=Math.abs(m-(L+te));if(fe>te+S)return!1;if(ne<=Q||fe<=te)return!0;const ve=ne-Q,Te=fe-te;return ve*ve+Te*Te<=S*S}}const Hn={unknown:0,flipRequired:1,flipNotRequired:2},Ke=Math.tan(85*Math.PI/180);function pt(v,h,m,S,I,L,$){const H=s.create();if(m)if(L.name==="globe"){const Q=s.calculateGlobeLabelMatrix(I,h);s.multiply(H,H,Q)}else{const Q=ie([],$);H[0]=Q[0],H[1]=Q[1],H[4]=Q[2],H[5]=Q[3],S||s.rotateZ(H,H,I.angle)}else s.multiply(H,I.labelPlaneMatrix,v);return H}function za(v,h,m,S,I,L,$){const H=pt(v,h,m,S,I,L,$);return L.name==="globe"&&m||(H[2]=H[6]=H[10]=H[14]=0),H}function Vi(v,h,m,S,I,L,$){if(m){if(L.name==="globe"){const H=pt(v,h,m,S,I,L,$);return s.invert(H,H),s.multiply(H,v,H),H}{const H=s.clone(v),Q=s.identity([]);return Q[0]=$[0],Q[1]=$[1],Q[4]=$[2],Q[5]=$[3],s.multiply(H,H,Q),S||s.rotateZ(H,H,-I.angle),H}}return I.glCoordMatrix}function gi(v,h,m,S){const I=[v,h,m,1];m?s.transformMat4$1(I,I,S):xr(I,I,S);const L=I[3];return I[0]/=L,I[1]/=L,I[2]/=L,I}function Nf(v,h){return Math.min(.5+v/h*.5,1.5)}function fa(v,h){const m=v[0]/v[3],S=v[1]/v[3];return m>=-h[0]&&m<=h[0]&&S>=-h[1]&&S<=h[1]}function Ve(v,h,m,S,I,L,$,H,Q,ne){const te=m.transform,fe=S?v.textSizeData:v.iconSizeData,ve=s.evaluateSizeForZoom(fe,m.transform.zoom),Te=te.projection.name==="globe",Ie=[256/m.width*2+1,256/m.height*2+1],Pe=S?v.text.dynamicLayoutVertexArray:v.icon.dynamicLayoutVertexArray;Pe.clear();let Le=null;Te&&(Le=S?v.text.globeExtVertexArray:v.icon.globeExtVertexArray);const he=v.lineVertexArray,Se=S?v.text.placedSymbolArray:v.icon.placedSymbolArray,Fe=m.transform.width/m.transform.height;let ke,Qe=!1;for(let et=0;et<Se.length;et++){const Je=Se.get(et),{numGlyphs:lt,writingMode:st}=Je;if(st!==s.WritingMode.vertical||Qe||ke===s.WritingMode.horizontal||(Qe=!0),ke=st,(Je.hidden||st===s.WritingMode.vertical)&&!Qe){Rs(lt,Pe);continue}Qe=!1;const xt=new s.Point(Je.tileAnchorX,Je.tileAnchorY);let{x:en,y:mt,z:Ut}=te.projection.projectTilePoint(xt.x,xt.y,ne.canonical);if(Q){const[hr,kn,er]=Q(xt);en+=hr,mt+=kn,Ut+=er}const St=[en,mt,Ut,1];if(s.transformMat4$1(St,St,h),!fa(St,Ie)){Rs(lt,Pe);continue}const Kt=Nf(m.transform.cameraToCenterDistance,St[3]),vt=s.evaluateSizeForFeature(fe,ve,Je),zt=$?vt/Kt:vt*Kt,nn=gi(en,mt,Ut,I);if(nn[3]<=0){Rs(lt,Pe);continue}let Ht={};const an=$?null:Q,Wn=_n(Je,zt,!1,H,h,I,L,v.glyphOffsetArray,he,Pe,Le,nn,xt,Ht,Fe,an,te.projection,ne,$);Qe=Wn.useVertical,an&&Wn.needsFlipping&&(Ht={}),(Wn.notEnoughRoom||Qe||Wn.needsFlipping&&_n(Je,zt,!0,H,h,I,L,v.glyphOffsetArray,he,Pe,Le,nn,xt,Ht,Fe,an,te.projection,ne,$).notEnoughRoom)&&Rs(lt,Pe)}S?(v.text.dynamicLayoutVertexBuffer.updateData(Pe),Le&&v.text.globeExtVertexBuffer.updateData(Le)):(v.icon.dynamicLayoutVertexBuffer.updateData(Pe),Le&&v.icon.globeExtVertexBuffer.updateData(Le))}function $h(v,h,m,S,I,L,$,H,Q,ne,te,fe,ve,Te,Ie,Pe){const{lineStartIndex:Le,glyphStartIndex:he,segment:Se}=H,Fe=he+H.numGlyphs,ke=Le+H.lineLength,Qe=h.getoffsetX(he),et=h.getoffsetX(Fe-1),Je=Os(v*Qe,m,S,I,L,$,Se,Le,ke,Q,ne,te,fe,ve,!0,Te,Ie,Pe);if(!Je)return null;const lt=Os(v*et,m,S,I,L,$,Se,Le,ke,Q,ne,te,fe,ve,!0,Te,Ie,Pe);return lt?{first:Je,last:lt}:null}function cu(v,h,m,S){return v===s.WritingMode.horizontal&&Math.abs(S)>Math.abs(m)?{useVertical:!0}:v===s.WritingMode.vertical?S>0?{needsFlipping:!0}:null:h!==Hn.unknown&&function(I,L){return I===0||Math.abs(L/I)>Ke}(m,S)?h===Hn.flipRequired?{needsFlipping:!0}:null:m<0?{needsFlipping:!0}:null}function _n(v,h,m,S,I,L,$,H,Q,ne,te,fe,ve,Te,Ie,Pe,Le,he,Se){const Fe=h/24,ke=v.lineOffsetX*Fe,Qe=v.lineOffsetY*Fe,{lineStartIndex:et,glyphStartIndex:Je,numGlyphs:lt,segment:st,writingMode:xt,flipState:en}=v,mt=et+v.lineLength,Ut=St=>{if(te){const[nn,Ht,an]=St.up,Wn=ne.length;s.updateGlobeVertexNormal(te,Wn+0,nn,Ht,an),s.updateGlobeVertexNormal(te,Wn+1,nn,Ht,an),s.updateGlobeVertexNormal(te,Wn+2,nn,Ht,an),s.updateGlobeVertexNormal(te,Wn+3,nn,Ht,an)}const[Kt,vt,zt]=St.point;s.addDynamicAttributes(ne,Kt,vt,zt,St.angle)};if(lt>1){const St=$h(Fe,H,ke,Qe,m,fe,ve,v,Q,L,Te,Pe,!1,Le,he,Se);if(!St)return{notEnoughRoom:!0};if(S&&!m){let[Kt,vt,zt]=St.first.point,[nn,Ht,an]=St.last.point;[Kt,vt]=gi(Kt,vt,zt,$),[nn,Ht]=gi(nn,Ht,an,$);const Wn=cu(xt,en,(nn-Kt)*Ie,Ht-vt);if(v.flipState=Wn&&Wn.needsFlipping?Hn.flipRequired:Hn.flipNotRequired,Wn)return Wn}Ut(St.first);for(let Kt=Je+1;Kt<Je+lt-1;Kt++){const vt=Os(Fe*H.getoffsetX(Kt),ke,Qe,m,fe,ve,st,et,mt,Q,L,Te,Pe,!1,!1,Le,he,Se);if(!vt)return ne.length-=4*(Kt-Je),{notEnoughRoom:!0};Ut(vt)}Ut(St.last)}else{if(S&&!m){const Kt=gi(ve.x,ve.y,0,I),vt=et+st+1,zt=new s.Point(Q.getx(vt),Q.gety(vt)),nn=gi(zt.x,zt.y,0,I),Ht=nn[3]>0?nn:Cr(ve,zt,Kt,1,I,void 0,Le,he.canonical),an=cu(xt,en,(Ht[0]-Kt[0])*Ie,Ht[1]-Kt[1]);if(v.flipState=an&&an.needsFlipping?Hn.flipRequired:Hn.flipNotRequired,an)return an}const St=Os(Fe*H.getoffsetX(Je),ke,Qe,m,fe,ve,st,et,mt,Q,L,Te,Pe,!1,!1,Le,he,Se);if(!St)return{notEnoughRoom:!0};Ut(St)}return{}}function ur(v,h,m,S,I){const{x:L,y:$,z:H}=S.projectTilePoint(v.x,v.y,h);if(!I)return gi(L,$,H,m);const[Q,ne,te]=I(v);return gi(L+Q,$+ne,H+te,m)}function Cr(v,h,m,S,I,L,$,H){const Q=ur(v.sub(h)._unit()._add(v),H,I,$,L);return s.sub(Q,m,Q),s.normalize(Q,Q),s.scaleAndAdd(Q,m,Q,S)}function Os(v,h,m,S,I,L,$,H,Q,ne,te,fe,ve,Te,Ie,Pe,Le,he){const Se=S?v-h:v+h;let Fe=Se>0?1:-1,ke=0;S&&(Fe*=-1,ke=Math.PI),Fe<0&&(ke+=Math.PI);let Qe=H+$+(Fe>0?0:1)|0,et=I,Je=I,lt=0,st=0;const xt=Math.abs(Se),en=[],mt=[];let Ut=L,St=Ut;const Kt=()=>Cr(St,Ut,Je,xt-lt+1,te,ve,Pe,Le.canonical);for(;lt+st<=xt;){if(Qe+=Fe,Qe<H||Qe>=Q)return null;if(Je=et,St=Ut,en.push(Je),Te&&mt.push(St),Ut=new s.Point(ne.getx(Qe),ne.gety(Qe)),et=fe[Qe],!et){const er=ur(Ut,Le.canonical,te,Pe,ve);et=er[3]>0?fe[Qe]=er:Kt()}lt+=st,st=s.distance(Je,et)}Ie&&ve&&(fe[Qe]&&(et=Kt(),st=s.distance(Je,et)),fe[Qe]=et);const vt=(xt-lt)/st,zt=Ut.sub(St)._mult(vt)._add(St),nn=s.sub([],et,Je),Ht=s.scaleAndAdd([],Je,nn,vt);let an=[0,0,1],Wn=nn[0],hr=nn[1];if(he&&(an=Pe.upVector(Le.canonical,zt.x,zt.y),an[0]!==0||an[1]!==0||an[2]!==1)){const er=[an[2],0,-an[0]],Fr=s.cross([],an,er);s.normalize(er,er),s.normalize(Fr,Fr),Wn=s.dot(nn,er),hr=s.dot(nn,Fr)}if(m){const er=s.cross([],an,nn);s.normalize(er,er),s.scaleAndAdd(Ht,Ht,er,m*Fe)}const kn=ke+Math.atan2(hr,Wn);return en.push(Ht),Te&&mt.push(zt),{point:Ht,angle:kn,path:en,tilePath:mt,up:an}}function Rs(v,h){const m=h.length,S=m+4*v;h.resize(S),h.float32.fill(-1/0,4*m,4*S)}function xr(v,h,m){const S=h[0],I=h[1];return v[0]=m[0]*S+m[4]*I+m[12],v[1]=m[1]*S+m[5]*I+m[13],v[3]=m[3]*S+m[7]*I+m[15],v}const ys=100;class Ls{constructor(h,m,S=new $o(h.width+200,h.height+200,25),I=new $o(h.width+200,h.height+200,25)){this.transform=h,this.grid=S,this.ignoredGrid=I,this.pitchfactor=Math.cos(h._pitch)*h.cameraToCenterDistance,this.screenRightBoundary=h.width+ys,this.screenBottomBoundary=h.height+ys,this.gridRightBoundary=h.width+200,this.gridBottomBoundary=h.height+200,this.fogState=m}placeCollisionBox(h,m,S,I,L,$,H,Q){let ne=S.projectedAnchorX,te=S.projectedAnchorY,fe=S.projectedAnchorZ;const ve=S.elevation,Te=S.tileID,Ie=h.getProjection();if(ve&&Te){const[et,Je,lt]=Ie.upVector(Te.canonical,S.tileAnchorX,S.tileAnchorY),st=Ie.upVectorScale(Te.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;ne+=et*ve*st,te+=Je*ve*st,fe+=lt*ve*st}const Pe=this.projectAndGetPerspectiveRatio(H,ne,te,fe,S.tileID,Ie.name==="globe"||!!ve||this.transform.pitch>0,Ie),Le=$*Pe.perspectiveRatio,he=(S.x1*m+I.x-S.padding)*Le+Pe.point.x,Se=(S.y1*m+I.y-S.padding)*Le+Pe.point.y,Fe=(S.x2*m+I.x+S.padding)*Le+Pe.point.x,ke=(S.y2*m+I.y+S.padding)*Le+Pe.point.y,Qe=Pe.perspectiveRatio<=.55||Pe.occluded;return!this.isInsideGrid(he,Se,Fe,ke)||!L&&this.grid.hitTest(he,Se,Fe,ke,Q)||Qe?{box:[],offscreen:!1,occluded:Pe.occluded}:{box:[he,Se,Fe,ke],offscreen:this.isOffscreen(he,Se,Fe,ke),occluded:!1}}placeCollisionCircles(h,m,S,I,L,$,H,Q,ne,te,fe,ve,Te,Ie,Pe){const Le=[],he=this.transform.elevation,Se=h.getProjection(),Fe=he?he.getAtTileOffsetFunc(Pe,this.transform.center.lat,this.transform.worldSize,Se):null,ke=new s.Point(S.tileAnchorX,S.tileAnchorY);let{x:Qe,y:et,z:Je}=Se.projectTilePoint(ke.x,ke.y,Pe.canonical);if(Fe){const[zt,nn,Ht]=Fe(ke);Qe+=zt,et+=nn,Je+=Ht}const lt=Se.name==="globe",st=this.projectAndGetPerspectiveRatio(H,Qe,et,Je,Pe,lt||!!he||this.transform.pitch>0,Se),{perspectiveRatio:xt}=st,en=(fe?$/xt:$*xt)/s.ONE_EM,mt=gi(Qe,et,Je,Q),Ut=st.signedDistanceFromCamera>0?$h(en,L,S.lineOffsetX*en,S.lineOffsetY*en,!1,mt,ke,S,I,Q,{},he&&!fe?Fe:null,fe&&!!he,Se,Pe,fe):null;let St=!1,Kt=!1,vt=!0;if(Ut&&!st.occluded){const zt=.5*Te*xt+Ie,nn=new s.Point(-100,-100),Ht=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),an=new ka,{first:Wn,last:hr}=Ut,kn=Wn.path.length;let er=[];for(let Vn=kn-1;Vn>=1;Vn--)er.push(Wn.path[Vn]);for(let Vn=1;Vn<hr.path.length;Vn++)er.push(hr.path[Vn]);const Fr=2.5*zt;ne&&(er=er.map(([Vn,fi,bi],wi)=>(Fe&&!lt&&(bi=Fe(wi<kn-1?Wn.tilePath[kn-1-wi]:hr.tilePath[wi-kn+2])[2]),gi(Vn,fi,bi,ne))),er.some(Vn=>Vn[3]<=0)&&(er=[]));let Nr=[];if(er.length>0){let Vn=1/0,fi=-1/0,bi=1/0,wi=-1/0;for(const Ei of er)Vn=Math.min(Vn,Ei[0]),bi=Math.min(bi,Ei[1]),fi=Math.max(fi,Ei[0]),wi=Math.max(wi,Ei[1]);fi>=nn.x&&Vn<=Ht.x&&wi>=nn.y&&bi<=Ht.y&&(Nr=[er.map(Ei=>new s.Point(Ei[0],Ei[1]))],(Vn<nn.x||fi>Ht.x||bi<nn.y||wi>Ht.y)&&(Nr=s.clipLine(Nr,nn.x,nn.y,Ht.x,Ht.y)))}for(const Vn of Nr){an.reset(Vn,.25*zt);let fi=0;fi=an.length<=.5*zt?1:Math.ceil(an.paddedLength/Fr)+1;for(let bi=0;bi<fi;bi++){const wi=bi/Math.max(fi-1,1),Ei=an.lerp(wi),_a=Ei.x+ys,Ns=Ei.y+ys;Le.push(_a,Ns,zt,0);const pu=_a-zt,Wc=Ns-zt,io=_a+zt,Si=Ns+zt;if(vt=vt&&this.isOffscreen(pu,Wc,io,Si),Kt=Kt||this.isInsideGrid(pu,Wc,io,Si),!m&&this.grid.hitTestCircle(_a,Ns,zt,ve)&&(St=!0,!te))return{circles:[],offscreen:!1,collisionDetected:St,occluded:!1}}}}return{circles:!te&&St||!Kt?[]:Le,offscreen:vt,collisionDetected:St,occluded:st.occluded}}queryRenderedSymbols(h){if(h.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const m=[];let S=1/0,I=1/0,L=-1/0,$=-1/0;for(const te of h){const fe=new s.Point(te.x+ys,te.y+ys);S=Math.min(S,fe.x),I=Math.min(I,fe.y),L=Math.max(L,fe.x),$=Math.max($,fe.y),m.push(fe)}const H=this.grid.query(S,I,L,$).concat(this.ignoredGrid.query(S,I,L,$)),Q={},ne={};for(const te of H){const fe=te.key;if(Q[fe.bucketInstanceId]===void 0&&(Q[fe.bucketInstanceId]={}),Q[fe.bucketInstanceId][fe.featureIndex])continue;const ve=[new s.Point(te.x1,te.y1),new s.Point(te.x2,te.y1),new s.Point(te.x2,te.y2),new s.Point(te.x1,te.y2)];s.polygonIntersectsPolygon(m,ve)&&(Q[fe.bucketInstanceId][fe.featureIndex]=!0,ne[fe.bucketInstanceId]===void 0&&(ne[fe.bucketInstanceId]=[]),ne[fe.bucketInstanceId].push(fe.featureIndex))}return ne}insertCollisionBox(h,m,S,I,L){(m?this.ignoredGrid:this.grid).insert({bucketInstanceId:S,featureIndex:I,collisionGroupID:L},h[0],h[1],h[2],h[3])}insertCollisionCircles(h,m,S,I,L){const $=m?this.ignoredGrid:this.grid,H={bucketInstanceId:S,featureIndex:I,collisionGroupID:L};for(let Q=0;Q<h.length;Q+=4)$.insertCircle(H,h[Q],h[Q+1],h[Q+2])}projectAndGetPerspectiveRatio(h,m,S,I,L,$,H){const Q=[m,S,I,1];let ne=!1;I||this.transform.pitch>0?(s.transformMat4$1(Q,Q,h),this.fogState&&L&&H.name!=="globe"&&(ne=function(ve,Te,Ie,Pe,Le,he){const Se=he.calculateFogTileMatrix(Le),Fe=[Te,Ie,Pe];return s.transformMat4(Fe,Fe,Se),at(ve,Fe,he.pitch,he._fov)}(this.fogState,m,S,I,L.toUnwrapped(),this.transform)>.9)):xr(Q,Q,h);const te=Q[3];return{point:new s.Point((Q[0]/te+1)/2*this.transform.width+ys,(-Q[1]/te+1)/2*this.transform.height+ys),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(H)/te*.5,1.5),signedDistanceFromCamera:te,occluded:$&&Q[2]>te||ne}}isOffscreen(h,m,S,I){return S<ys||h>=this.screenRightBoundary||I<ys||m>this.screenBottomBoundary}isInsideGrid(h,m,S,I){return S>=0&&h<this.gridRightBoundary&&I>=0&&m<this.gridBottomBoundary}getViewportMatrix(){const h=s.identity([]);return s.translate(h,h,[-100,-100,0]),h}}function ye(v,h,m){const S=h.createTileMatrix(v,v.worldSize,m.toUnwrapped());return s.multiply(new Float32Array(16),v.projMatrix,S)}function Oe(v,h,m){if(h.projection.name===m.projection.name)return v.projMatrix;const S=m.clone();return S.setProjection(h.projection),ye(S,h.getProjection(),v)}function He(v,h,m){return h.name===m.projection.name?v.projMatrix:ye(m,h,v)}class Ot{constructor(h,m,S,I){this.opacity=h?Math.max(0,Math.min(1,h.opacity+(h.placed?m:-m))):I&&S?1:0,this.placed=S}isHidden(){return this.opacity===0&&!this.placed}}class on{constructor(h,m,S,I,L,$=!1){this.text=new Ot(h?h.text:null,m,S,L),this.icon=new Ot(h?h.icon:null,m,I,L),this.clipped=$}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Fn{constructor(h,m,S,I=!1){this.text=h,this.icon=m,this.skipFade=S,this.clipped=I}}class Rr{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Ao{constructor(h,m,S,I,L){this.bucketInstanceId=h,this.featureIndex=m,this.sourceLayerIndex=S,this.bucketIndex=I,this.tileID=L}}class Lr{constructor(h){this.crossSourceCollisions=h,this.maxGroupID=0,this.collisionGroups={}}get(h){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[h]){const m=++this.maxGroupID;this.collisionGroups[h]={ID:m,predicate:S=>S.collisionGroupID===m}}return this.collisionGroups[h]}}function ao(v,h,m,S,I){const{horizontalAlign:L,verticalAlign:$}=s.getAnchorAlignment(v),H=-(L-.5)*h,Q=-($-.5)*m,ne=s.evaluateVariableOffset(v,S);return new s.Point(H+ne[0]*I,Q+ne[1]*I)}function vs(v,h,m,S,I){const L=new s.Point(v,h);return m&&L._rotate(S?I:-I),L}class Ig{constructor(h,m,S,I,L){this.transform=h.clone(),this.projection=h.projection.name,this.collisionIndex=new Ls(this.transform,L),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=m,this.retainedQueryData={},this.collisionGroups=new Lr(S),this.collisionCircleArrays={},this.prevPlacement=I,I&&(I.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(h,m,S,I){const L=S.getBucket(m),$=S.latestFeatureIndex;if(!L||!$||m.id!==L.layerIds[0])return;const H=L.layers[0].layout,Q=S.collisionBoxArray,ne=Math.pow(2,this.transform.zoom-S.tileID.overscaledZ),te=S.tileSize/s.EXTENT,fe=S.tileID.toUnwrapped();this.transform.setProjection(L.projection);const ve=(Te=S.tileID,Ie=L.getProjection(),Pe=this.transform,Ie.name===this.projection?Pe.calculateProjMatrix(Te.toUnwrapped()):ye(Pe,Ie,Te));var Te,Ie,Pe;const Le=H.get("text-pitch-alignment")==="map",he=H.get("text-rotation-alignment")==="map";m.compileFilter();const Se=m.dynamicFilter(),Fe=m.dynamicFilterNeedsFeature(),ke=this.transform.calculatePixelsToTileUnitsMatrix(S),Qe=za(ve,S.tileID.canonical,Le,he,this.transform,L.getProjection(),ke);let et=null;if(Le){const st=Vi(ve,S.tileID.canonical,Le,he,this.transform,L.getProjection(),ke);et=s.multiply([],this.transform.labelPlaneMatrix,st)}let Je=null;Se&&S.latestFeatureIndex&&(Je={unwrappedTileID:fe,dynamicFilter:Se,dynamicFilterNeedsFeature:Fe,featureIndex:S.latestFeatureIndex}),this.retainedQueryData[L.bucketInstanceId]=new Ao(L.bucketInstanceId,$,L.sourceLayerIndex,L.index,S.tileID);const lt={bucket:L,layout:H,posMatrix:ve,textLabelPlaneMatrix:Qe,labelToScreenMatrix:et,clippingData:Je,scale:ne,textPixelRatio:te,holdingForFade:S.holdingForFade(),collisionBoxArray:Q,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(L.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(L.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(L.sourceID)};if(I)for(const st of L.sortKeyRanges){const{sortKey:xt,symbolInstanceStart:en,symbolInstanceEnd:mt}=st;h.push({sortKey:xt,symbolInstanceStart:en,symbolInstanceEnd:mt,parameters:lt})}else h.push({symbolInstanceStart:0,symbolInstanceEnd:L.symbolInstances.length,parameters:lt})}attemptAnchorPlacement(h,m,S,I,L,$,H,Q,ne,te,fe,ve,Te,Ie,Pe,Le,he,Se){const{textOffset0:Fe,textOffset1:ke,crossTileID:Qe}=ve,et=[Fe,ke],Je=ao(h,S,I,et,L),lt=this.collisionIndex.placeCollisionBox(Ie,L,m,vs(Je.x,Je.y,$,H,this.transform.angle),fe,Q,ne,te.predicate);if(Le){const st=Ie.getSymbolInstanceIconSize(Se,this.transform.zoom,ve.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(Ie,st,Le,vs(Je.x,Je.y,$,H,this.transform.angle),fe,Q,ne,te.predicate).box.length===0)return}if(lt.box.length>0){let st;return this.prevPlacement&&this.prevPlacement.variableOffsets[Qe]&&this.prevPlacement.placements[Qe]&&this.prevPlacement.placements[Qe].text&&(st=this.prevPlacement.variableOffsets[Qe].anchor),this.variableOffsets[Qe]={textOffset:et,width:S,height:I,anchor:h,textScale:L,prevAnchor:st},this.markUsedJustification(Ie,h,ve,Pe),Ie.allowVerticalPlacement&&(this.markUsedOrientation(Ie,Pe,ve),this.placedOrientations[Qe]=Pe),{shift:Je,placedGlyphBoxes:lt}}}placeLayerBucketPart(h,m,S,I){const{bucket:L,layout:$,posMatrix:H,textLabelPlaneMatrix:Q,labelToScreenMatrix:ne,clippingData:te,textPixelRatio:fe,holdingForFade:ve,collisionBoxArray:Te,partiallyEvaluatedTextSize:Ie,partiallyEvaluatedIconSize:Pe,collisionGroup:Le}=h.parameters,he=$.get("text-optional"),Se=$.get("icon-optional"),Fe=$.get("text-allow-overlap"),ke=$.get("icon-allow-overlap"),Qe=$.get("text-rotation-alignment")==="map",et=$.get("text-pitch-alignment")==="map",Je=$.get("icon-text-fit")!=="none",lt=$.get("symbol-z-order")==="viewport-y";this.transform.setProjection(L.projection);let st=Fe&&(ke||!L.hasIconData()||Se),xt=ke&&(Fe||!L.hasTextData()||he);!L.collisionArrays&&Te&&L.deserializeCollisionBoxes(Te),S&&I&&L.updateCollisionDebugBuffers(this.transform.zoom,Te);const en=(mt,Ut,St)=>{const{crossTileID:Kt,numVerticalGlyphVertices:vt}=mt;if(te){const io={zoom:this.transform.zoom,pitch:this.transform.pitch};let Si=null;if(te.dynamicFilterNeedsFeature){const ni=this.retainedQueryData[L.bucketInstanceId];Si=te.featureIndex.loadFeature({featureIndex:mt.featureIndex,bucketIndex:ni.bucketIndex,sourceLayerIndex:ni.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,te.dynamicFilter)(io,Si,this.retainedQueryData[L.bucketInstanceId].tileID.canonical,new s.Point(mt.tileAnchorX,mt.tileAnchorY),this.transform.calculateDistanceTileData(te.unwrappedTileID)))return this.placements[Kt]=new Fn(!1,!1,!1,!0),void m.add(Kt)}if(m.has(Kt))return;if(ve)return void(this.placements[Kt]=new Fn(!1,!1,!1));let zt=!1,nn=!1,Ht=!0,an=!1,Wn=!1,hr=null,kn={box:null,offscreen:null,occluded:null},er={box:null,offscreen:null,occluded:null},Fr=null,Nr=null,Vn=null,fi=0,bi=0,wi=0;St.textFeatureIndex?fi=St.textFeatureIndex:mt.useRuntimeCollisionCircles&&(fi=mt.featureIndex),St.verticalTextFeatureIndex&&(bi=St.verticalTextFeatureIndex);const Ei=io=>{io.tileID=this.retainedQueryData[L.bucketInstanceId].tileID;const Si=this.transform.elevation;(Si||io.elevation)&&(io.elevation=Si?Si.getAtTileOffset(io.tileID,io.tileAnchorX,io.tileAnchorY):0)},_a=St.textBox;if(_a){Ei(_a);const io=ni=>{let Ho=s.WritingMode.horizontal;if(L.allowVerticalPlacement&&!ni&&this.prevPlacement){const ja=this.prevPlacement.placedOrientations[Kt];ja&&(this.placedOrientations[Kt]=ja,Ho=ja,this.markUsedOrientation(L,Ho,mt))}return Ho},Si=(ni,Ho)=>{if(L.allowVerticalPlacement&&vt>0&&St.verticalTextBox){for(const ja of L.writingModes)if(ja===s.WritingMode.vertical?(kn=Ho(),er=kn):kn=ni(),kn&&kn.box&&kn.box.length)break}else kn=ni()};if($.get("text-variable-anchor")){let ni=$.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Kt]){const Yi=this.prevPlacement.variableOffsets[Kt];ni.indexOf(Yi.anchor)>0&&(ni=ni.filter(ll=>ll!==Yi.anchor),ni.unshift(Yi.anchor))}const Ho=(Yi,ll,$_)=>{const Ip=L.getSymbolInstanceTextSize(Ie,mt,this.transform.zoom,Ut),WA=(Yi.x2-Yi.x1)*Ip+2*Yi.padding,qf=(Yi.y2-Yi.y1)*Ip+2*Yi.padding,nd=Je&&!ke?ll:null;nd&&Ei(nd);let Mp={box:[],offscreen:!1,occluded:!1};const H_=Fe?2*ni.length:ni.length;for(let qA=0;qA<H_;++qA){const Ax=this.attemptAnchorPlacement(ni[qA%ni.length],Yi,WA,qf,Ip,Qe,et,fe,H,Le,qA>=ni.length,mt,Ut,L,$_,nd,Ie,Pe);if(Ax&&(Mp=Ax.placedGlyphBoxes,Mp&&Mp.box&&Mp.box.length)){zt=!0,hr=Ax.shift;break}}return Mp};Si(()=>Ho(_a,St.iconBox,s.WritingMode.horizontal),()=>{const Yi=St.verticalTextBox;return Yi&&Ei(Yi),L.allowVerticalPlacement&&!(kn&&kn.box&&kn.box.length)&&vt>0&&Yi?Ho(Yi,St.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),kn&&(zt=kn.box,Ht=kn.offscreen,an=kn.occluded);const ja=io(!(!kn||!kn.box));if(!zt&&this.prevPlacement){const Yi=this.prevPlacement.variableOffsets[Kt];Yi&&(this.variableOffsets[Kt]=Yi,this.markUsedJustification(L,Yi.anchor,mt,ja))}}else{const ni=(Ho,ja)=>{const Yi=L.getSymbolInstanceTextSize(Ie,mt,this.transform.zoom,Ut),ll=this.collisionIndex.placeCollisionBox(L,Yi,Ho,new s.Point(0,0),Fe,fe,H,Le.predicate);return ll&&ll.box&&ll.box.length&&(this.markUsedOrientation(L,ja,mt),this.placedOrientations[Kt]=ja),ll};Si(()=>ni(_a,s.WritingMode.horizontal),()=>{const Ho=St.verticalTextBox;return L.allowVerticalPlacement&&vt>0&&Ho?(Ei(Ho),ni(Ho,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),io(!!(kn&&kn.box&&kn.box.length))}}if(Fr=kn,zt=Fr&&Fr.box&&Fr.box.length>0,Ht=Fr&&Fr.offscreen,an=Fr&&Fr.occluded,mt.useRuntimeCollisionCircles){const io=L.text.placedSymbolArray.get(mt.centerJustifiedTextSymbolIndex>=0?mt.centerJustifiedTextSymbolIndex:mt.verticalPlacedTextSymbolIndex),Si=s.evaluateSizeForFeature(L.textSizeData,Ie,io),ni=$.get("text-padding");Nr=this.collisionIndex.placeCollisionCircles(L,Fe,io,L.lineVertexArray,L.glyphOffsetArray,Si,H,Q,ne,S,et,Le.predicate,mt.collisionCircleDiameter*Si/s.ONE_EM,ni,this.retainedQueryData[L.bucketInstanceId].tileID),zt=Fe||Nr.circles.length>0&&!Nr.collisionDetected,Ht=Ht&&Nr.offscreen,an=Nr.occluded}if(St.iconFeatureIndex&&(wi=St.iconFeatureIndex),St.iconBox){const io=Si=>{Ei(Si);const ni=Je&&hr?vs(hr.x,hr.y,Qe,et,this.transform.angle):new s.Point(0,0),Ho=L.getSymbolInstanceIconSize(Pe,this.transform.zoom,mt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(L,Ho,Si,ni,ke,fe,H,Le.predicate)};er&&er.box&&er.box.length&&St.verticalIconBox?(Vn=io(St.verticalIconBox),nn=Vn.box.length>0):(Vn=io(St.iconBox),nn=Vn.box.length>0),Ht=Ht&&Vn.offscreen,Wn=Vn.occluded}const Ns=he||mt.numHorizontalGlyphVertices===0&&vt===0,pu=Se||mt.numIconVertices===0;if(Ns||pu?pu?Ns||(nn=nn&&zt):zt=nn&&zt:nn=zt=nn&&zt,zt&&Fr&&Fr.box&&this.collisionIndex.insertCollisionBox(Fr.box,$.get("text-ignore-placement"),L.bucketInstanceId,er&&er.box&&bi?bi:fi,Le.ID),nn&&Vn&&this.collisionIndex.insertCollisionBox(Vn.box,$.get("icon-ignore-placement"),L.bucketInstanceId,wi,Le.ID),Nr&&(zt&&this.collisionIndex.insertCollisionCircles(Nr.circles,$.get("text-ignore-placement"),L.bucketInstanceId,fi,Le.ID),S)){const io=L.bucketInstanceId;let Si=this.collisionCircleArrays[io];Si===void 0&&(Si=this.collisionCircleArrays[io]=new Rr);for(let ni=0;ni<Nr.circles.length;ni+=4)Si.circles.push(Nr.circles[ni+0]),Si.circles.push(Nr.circles[ni+1]),Si.circles.push(Nr.circles[ni+2]),Si.circles.push(Nr.collisionDetected?1:0)}const Wc=L.projection.name!=="globe";st=st&&(Wc||!an),xt=xt&&(Wc||!Wn),this.placements[Kt]=new Fn(zt||st,nn||xt,Ht||L.justReloaded),m.add(Kt)};if(lt){const mt=L.getSortedSymbolIndexes(this.transform.angle);for(let Ut=mt.length-1;Ut>=0;--Ut){const St=mt[Ut];en(L.symbolInstances.get(St),St,L.collisionArrays[St])}}else for(let mt=h.symbolInstanceStart;mt<h.symbolInstanceEnd;mt++)en(L.symbolInstances.get(mt),mt,L.collisionArrays[mt]);if(S&&L.bucketInstanceId in this.collisionCircleArrays){const mt=this.collisionCircleArrays[L.bucketInstanceId];s.invert(mt.invProjMatrix,H),mt.viewportMatrix=this.collisionIndex.getViewportMatrix()}L.justReloaded=!1}markUsedJustification(h,m,S,I){const{leftJustifiedTextSymbolIndex:L,centerJustifiedTextSymbolIndex:$,rightJustifiedTextSymbolIndex:H,verticalPlacedTextSymbolIndex:Q,crossTileID:ne}=S,te=s.getAnchorJustification(m),fe=I===s.WritingMode.vertical?Q:te==="left"?L:te==="center"?$:te==="right"?H:-1;L>=0&&(h.text.placedSymbolArray.get(L).crossTileID=fe>=0&&L!==fe?0:ne),$>=0&&(h.text.placedSymbolArray.get($).crossTileID=fe>=0&&$!==fe?0:ne),H>=0&&(h.text.placedSymbolArray.get(H).crossTileID=fe>=0&&H!==fe?0:ne),Q>=0&&(h.text.placedSymbolArray.get(Q).crossTileID=fe>=0&&Q!==fe?0:ne)}markUsedOrientation(h,m,S){const I=m===s.WritingMode.horizontal||m===s.WritingMode.horizontalOnly?m:0,L=m===s.WritingMode.vertical?m:0,{leftJustifiedTextSymbolIndex:$,centerJustifiedTextSymbolIndex:H,rightJustifiedTextSymbolIndex:Q,verticalPlacedTextSymbolIndex:ne}=S,te=h.text.placedSymbolArray;$>=0&&(te.get($).placedOrientation=I),H>=0&&(te.get(H).placedOrientation=I),Q>=0&&(te.get(Q).placedOrientation=I),ne>=0&&(te.get(ne).placedOrientation=L)}commit(h){this.commitTime=h,this.zoomAtLastRecencyCheck=this.transform.zoom;const m=this.prevPlacement;let S=!1;this.prevZoomAdjustment=m?m.zoomAdjustment(this.transform.zoom):0;const I=m?m.symbolFadeChange(h):1,L=m?m.opacities:{},$=m?m.variableOffsets:{},H=m?m.placedOrientations:{};for(const Q in this.placements){const ne=this.placements[Q],te=L[Q];te?(this.opacities[Q]=new on(te,I,ne.text,ne.icon,null,ne.clipped),S=S||ne.text!==te.text.placed||ne.icon!==te.icon.placed):(this.opacities[Q]=new on(null,I,ne.text,ne.icon,ne.skipFade,ne.clipped),S=S||ne.text||ne.icon)}for(const Q in L){const ne=L[Q];if(!this.opacities[Q]){const te=new on(ne,I,!1,!1);te.isHidden()||(this.opacities[Q]=te,S=S||ne.text.placed||ne.icon.placed)}}for(const Q in $)this.variableOffsets[Q]||!this.opacities[Q]||this.opacities[Q].isHidden()||(this.variableOffsets[Q]=$[Q]);for(const Q in H)this.placedOrientations[Q]||!this.opacities[Q]||this.opacities[Q].isHidden()||(this.placedOrientations[Q]=H[Q]);S?this.lastPlacementChangeTime=h:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=m?m.lastPlacementChangeTime:h)}updateLayerOpacities(h,m){const S=new Set;for(const I of m){const L=I.getBucket(h);L&&I.latestFeatureIndex&&h.id===L.layerIds[0]&&this.updateBucketOpacities(L,S,I.collisionBoxArray)}}updateBucketOpacities(h,m,S){h.hasTextData()&&h.text.opacityVertexArray.clear(),h.hasIconData()&&h.icon.opacityVertexArray.clear(),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexArray.clear(),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexArray.clear();const I=h.layers[0].layout,L=!!h.layers[0].dynamicFilter(),$=new on(null,0,!1,!1,!0),H=I.get("text-allow-overlap"),Q=I.get("icon-allow-overlap"),ne=I.get("text-variable-anchor"),te=I.get("text-rotation-alignment")==="map",fe=I.get("text-pitch-alignment")==="map",ve=I.get("icon-text-fit")!=="none",Te=new on(null,0,H&&(Q||!h.hasIconData()||I.get("icon-optional")),Q&&(H||!h.hasTextData()||I.get("text-optional")),!0);!h.collisionArrays&&S&&(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData())&&h.deserializeCollisionBoxes(S);const Ie=(Le,he,Se)=>{for(let Fe=0;Fe<he/4;Fe++)Le.opacityVertexArray.emplaceBack(Se)};let Pe=0;for(let Le=0;Le<h.symbolInstances.length;Le++){const he=h.symbolInstances.get(Le),{numHorizontalGlyphVertices:Se,numVerticalGlyphVertices:Fe,crossTileID:ke,numIconVertices:Qe}=he,et=m.has(ke);let Je=this.opacities[ke];et?Je=$:Je||(Je=Te,this.opacities[ke]=Je),m.add(ke);const lt=Se>0||Fe>0,st=Qe>0,xt=this.placedOrientations[ke],en=xt===s.WritingMode.vertical,mt=xt===s.WritingMode.horizontal||xt===s.WritingMode.horizontalOnly;if(!lt&&!st||Je.isHidden()||Pe++,lt){const Ut=Wh(Je.text);Ie(h.text,Se,en?Xi:Ut),Ie(h.text,Fe,mt?Xi:Ut);const St=Je.text.isHidden(),{leftJustifiedTextSymbolIndex:Kt,centerJustifiedTextSymbolIndex:vt,rightJustifiedTextSymbolIndex:zt,verticalPlacedTextSymbolIndex:nn}=he,Ht=h.text.placedSymbolArray,an=St||en?1:0;Kt>=0&&(Ht.get(Kt).hidden=an),vt>=0&&(Ht.get(vt).hidden=an),zt>=0&&(Ht.get(zt).hidden=an),nn>=0&&(Ht.get(nn).hidden=St||mt?1:0);const Wn=this.variableOffsets[ke];Wn&&this.markUsedJustification(h,Wn.anchor,he,xt);const hr=this.placedOrientations[ke];hr&&(this.markUsedJustification(h,"left",he,hr),this.markUsedOrientation(h,hr,he))}if(st){const Ut=Wh(Je.icon),{placedIconSymbolIndex:St,verticalPlacedIconSymbolIndex:Kt}=he,vt=h.icon.placedSymbolArray,zt=Je.icon.isHidden()?1:0;St>=0&&(Ie(h.icon,Qe,en?Xi:Ut),vt.get(St).hidden=zt),Kt>=0&&(Ie(h.icon,he.numVerticalIconVertices,mt?Xi:Ut),vt.get(Kt).hidden=zt)}if(h.hasIconCollisionBoxData()||h.hasTextCollisionBoxData()){const Ut=h.collisionArrays[Le];if(Ut){let St=new s.Point(0,0),Kt=!0;if(Ut.textBox||Ut.verticalTextBox){if(ne){const zt=this.variableOffsets[ke];zt?(St=ao(zt.anchor,zt.width,zt.height,zt.textOffset,zt.textScale),te&&St._rotate(fe?this.transform.angle:-this.transform.angle)):Kt=!1}L&&(Kt=!Je.clipped),Ut.textBox&&Hh(h.textCollisionBox.collisionVertexArray,Je.text.placed,!Kt||en,St.x,St.y),Ut.verticalTextBox&&Hh(h.textCollisionBox.collisionVertexArray,Je.text.placed,!Kt||mt,St.x,St.y)}const vt=Kt&&!!(!mt&&Ut.verticalIconBox);Ut.iconBox&&Hh(h.iconCollisionBox.collisionVertexArray,Je.icon.placed,vt,ve?St.x:0,ve?St.y:0),Ut.verticalIconBox&&Hh(h.iconCollisionBox.collisionVertexArray,Je.icon.placed,!vt,ve?St.x:0,ve?St.y:0)}}}if(h.fullyClipped=Pe===0,h.sortFeatures(this.transform.angle),this.retainedQueryData[h.bucketInstanceId]&&(this.retainedQueryData[h.bucketInstanceId].featureSortOrder=h.featureSortOrder),h.hasTextData()&&h.text.opacityVertexBuffer&&h.text.opacityVertexBuffer.updateData(h.text.opacityVertexArray),h.hasIconData()&&h.icon.opacityVertexBuffer&&h.icon.opacityVertexBuffer.updateData(h.icon.opacityVertexArray),h.hasIconCollisionBoxData()&&h.iconCollisionBox.collisionVertexBuffer&&h.iconCollisionBox.collisionVertexBuffer.updateData(h.iconCollisionBox.collisionVertexArray),h.hasTextCollisionBoxData()&&h.textCollisionBox.collisionVertexBuffer&&h.textCollisionBox.collisionVertexBuffer.updateData(h.textCollisionBox.collisionVertexArray),h.bucketInstanceId in this.collisionCircleArrays){const Le=this.collisionCircleArrays[h.bucketInstanceId];h.placementInvProjMatrix=Le.invProjMatrix,h.placementViewportMatrix=Le.viewportMatrix,h.collisionCircleArray=Le.circles,delete this.collisionCircleArrays[h.bucketInstanceId]}}symbolFadeChange(h){return this.fadeDuration===0?1:(h-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(h){return Math.max(0,(this.transform.zoom-h)/1.5)}hasTransitions(h){return this.stale||h-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(h,m){const S=this.zoomAtLastRecencyCheck===m?1-this.zoomAdjustment(m):1;return this.zoomAtLastRecencyCheck=m,this.commitTime+this.fadeDuration*S>h}setStale(){this.stale=!0}}function Hh(v,h,m,S,I){v.emplaceBack(h?1:0,m?1:0,S||0,I||0),v.emplaceBack(h?1:0,m?1:0,S||0,I||0),v.emplaceBack(h?1:0,m?1:0,S||0,I||0),v.emplaceBack(h?1:0,m?1:0,S||0,I||0)}const ha=Math.pow(2,25),lo=Math.pow(2,24),op=Math.pow(2,17),sp=Math.pow(2,16),da=Math.pow(2,9),il=Math.pow(2,8),TA=Math.pow(2,1);function Wh(v){if(v.opacity===0&&!v.placed)return 0;if(v.opacity===1&&v.placed)return 4294967295;const h=v.placed?1:0,m=Math.floor(127*v.opacity);return m*ha+h*lo+m*op+h*sp+m*da+h*il+m*TA+h}const Xi=0;class ap{constructor(h){this._sortAcrossTiles=h.layout.get("symbol-z-order")!=="viewport-y"&&h.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(h,m,S,I,L){const $=this._bucketParts;for(;this._currentTileIndex<h.length;)if(m.getBucketParts($,I,h[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,L())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,$.sort((H,Q)=>H.sortKey-Q.sortKey));this._currentPartIndex<$.length;){const H=$[this._currentPartIndex];if(m.placeLayerBucketPart(H,this._seenCrossTileIDs,S,H.symbolInstanceStart===0),this._currentPartIndex++,L())return!0}return!1}}class CA{constructor(h,m,S,I,L,$,H,Q){this.placement=new Ig(h,L,$,H,Q),this._currentPlacementIndex=m.length-1,this._forceFullPlacement=S,this._showCollisionBoxes=I,this._done=!1}isDone(){return this._done}continuePlacement(h,m,S){const I=s.exported.now(),L=()=>{const $=s.exported.now()-I;return!this._forceFullPlacement&&$>2};for(;this._currentPlacementIndex>=0;){const $=m[h[this._currentPlacementIndex]],H=this.placement.collisionIndex.transform.zoom;if($.type==="symbol"&&(!$.minzoom||$.minzoom<=H)&&(!$.maxzoom||$.maxzoom>H)){if(this._inProgressLayer||(this._inProgressLayer=new ap($)),this._inProgressLayer.continuePlacement(S[$.source],this.placement,this._showCollisionBoxes,$,L))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(h){return this.placement.commit(h),this.placement}}const Ff=512/s.EXTENT/2;class li{constructor(h,m,S){this.tileID=h,this.bucketInstanceId=S,this.index=new s.KDBush(m.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const I=h.canonical.x*s.EXTENT,L=h.canonical.y*s.EXTENT;for(let $=0;$<m.length;$++){const{key:H,crossTileID:Q,tileAnchorX:ne,tileAnchorY:te}=m.get($),fe=Math.floor((I+ne)*Ff),ve=Math.floor((L+te)*Ff);this.index.add(fe,ve),this.keys.push(H),this.crossTileIDs.push(Q)}this.index.finish()}findMatches(h,m,S){const I=this.tileID.canonical.z<m.canonical.z?1:Math.pow(2,this.tileID.canonical.z-m.canonical.z),L=Ff/Math.pow(2,m.canonical.z-this.tileID.canonical.z),$=m.canonical.x*s.EXTENT,H=m.canonical.y*s.EXTENT;for(let Q=0;Q<h.length;Q++){const ne=h.get(Q);if(ne.crossTileID)continue;const{key:te,tileAnchorX:fe,tileAnchorY:ve}=ne,Te=Math.floor(($+fe)*L),Ie=Math.floor((H+ve)*L),Pe=this.index.range(Te-I,Ie-I,Te+I,Ie+I);for(const Le of Pe){const he=this.crossTileIDs[Le];if(this.keys[Le]===te&&!S.has(he)){S.add(he),ne.crossTileID=he;break}}}}}class qu{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class xs{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(h){const m=Math.round((h-this.lng)/360);if(m!==0)for(const S in this.indexes){const I=this.indexes[S],L={};for(const $ in I){const H=I[$];H.tileID=H.tileID.unwrapTo(H.tileID.wrap+m),L[H.tileID.key]=H}this.indexes[S]=L}this.lng=h}addBucket(h,m,S){if(this.indexes[h.overscaledZ]&&this.indexes[h.overscaledZ][h.key]){if(this.indexes[h.overscaledZ][h.key].bucketInstanceId===m.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(h.overscaledZ,this.indexes[h.overscaledZ][h.key])}for(let L=0;L<m.symbolInstances.length;L++)m.symbolInstances.get(L).crossTileID=0;this.usedCrossTileIDs[h.overscaledZ]||(this.usedCrossTileIDs[h.overscaledZ]=new Set);const I=this.usedCrossTileIDs[h.overscaledZ];for(const L in this.indexes){const $=this.indexes[L];if(Number(L)>h.overscaledZ)for(const H in $){const Q=$[H];Q.tileID.isChildOf(h)&&Q.findMatches(m.symbolInstances,h,I)}else{const H=$[h.scaledTo(Number(L)).key];H&&H.findMatches(m.symbolInstances,h,I)}}for(let L=0;L<m.symbolInstances.length;L++){const $=m.symbolInstances.get(L);$.crossTileID||($.crossTileID=S.generate(),I.add($.crossTileID))}return this.indexes[h.overscaledZ]===void 0&&(this.indexes[h.overscaledZ]={}),this.indexes[h.overscaledZ][h.key]=new li(h,m.symbolInstances,m.bucketInstanceId),!0}removeBucketCrossTileIDs(h,m){for(const S of m.crossTileIDs)this.usedCrossTileIDs[h].delete(S)}removeStaleBuckets(h){let m=!1;for(const S in this.indexes){const I=this.indexes[S];for(const L in I)h[I[L].bucketInstanceId]||(this.removeBucketCrossTileIDs(S,I[L]),delete I[L],m=!0)}return m}}class Ul{constructor(){this.layerIndexes={},this.crossTileIDs=new qu,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(h,m,S,I){let L=this.layerIndexes[h.id];L===void 0&&(L=this.layerIndexes[h.id]=new xs);let $=!1;const H={};I.name!=="globe"&&L.handleWrapJump(S);for(const Q of m){const ne=Q.getBucket(h);ne&&h.id===ne.layerIds[0]&&(ne.bucketInstanceId||(ne.bucketInstanceId=++this.maxBucketInstanceId),L.addBucket(Q.tileID,ne,this.crossTileIDs)&&($=!0),H[ne.bucketInstanceId]=!0)}return L.removeStaleBuckets(H)&&($=!0),$}pruneUnusedLayers(h){const m={};h.forEach(S=>{m[S]=!0});for(const S in this.layerIndexes)m[S]||delete this.layerIndexes[S]}}const Xu=(v,h)=>s.emitValidationErrors(v,h&&h.filter(m=>m.identifier!=="source.canvas")),kf=s.pick(jn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),I_=s.pick(jn,["setCenter","setZoom","setBearing","setPitch"]),lp={version:8,layers:[],sources:{}},Zu={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ds extends s.Evented{constructor(h,m={}){super(),this.map=h,this.dispatcher=new Re(Tr(),this),this.imageManager=new se,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(h._requestManager,m.localFontFamily?s.LocalGlyphMode.all:m.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,m.localFontFamily||m.localIdeographFontFamily),this.crossTileSymbolIndex=new Ul,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const S=this;this._rtlTextPluginCallback=Ds.registerForPluginStateChange(I=>{S.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:I.pluginStatus,pluginURL:I.pluginURL},(L,$)=>{if(s.triggerPluginCompletionEvent(L),$&&$.every(H=>H))for(const H in S._sourceCaches){const Q=S._sourceCaches[H],ne=Q.getSource().type;ne!=="vector"&&ne!=="geojson"||Q.reload()}})}),this.on("data",I=>{if(I.dataType!=="source"||I.sourceDataType!=="metadata")return;const L=this.getSource(I.sourceId);if(L&&L.vectorLayerIds)for(const $ in this._layers){const H=this._layers[$];H.source===L.id&&this._validateLayer(H)}})}loadURL(h,m={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const S=typeof m.validate=="boolean"?m.validate:!s.isMapboxURL(h);h=this.map._requestManager.normalizeStyleURL(h,m.accessToken);const I=this.map._requestManager.transformRequest(h,s.ResourceType.Style);this._request=s.getJSON(I,(L,$)=>{this._request=null,L?this.fire(new s.ErrorEvent(L)):$&&this._load($,S)})}loadJSON(h,m={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(h,m.validate!==!1)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(lp,!1)}_updateLayerCount(h,m){const S=m?1:-1;h.is3D()&&(this._num3DLayers+=S),h.type==="circle"&&(this._numCircleLayers+=S),h.type==="symbol"&&(this._numSymbolLayers+=S)}_load(h,m){if(m&&Xu(this,s.validateStyle(h)))return;this._loaded=!0,this.stylesheet=s.clone$1(h),this._updateMapProjection();for(const I in h.sources)this.addSource(I,h.sources[I],{validate:!1});this._changed=!1,h.sprite?this._loadSprite(h.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(h.glyphs);const S=qr(this.stylesheet.layers);this._order=S.map(I=>I.id),this._layers={},this._serializedLayers={};for(const I of S){const L=s.createStyleLayer(I);L.setEventedParent(this,{layer:{id:L.id}}),this._layers[L.id]=L,this._serializedLayers[L.id]=L.serialize(),this._updateLayerCount(L,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ce(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(h){h?this.stylesheet.projection=h:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(h){this._spriteRequest=function(m,S,I){let L,$,H;const Q=s.exported.devicePixelRatio>1?"@2x":"";let ne=s.getJSON(S.transformRequest(S.normalizeSpriteURL(m,Q,".json"),s.ResourceType.SpriteJSON),(ve,Te)=>{ne=null,H||(H=ve,L=Te,fe())}),te=s.getImage(S.transformRequest(S.normalizeSpriteURL(m,Q,".png"),s.ResourceType.SpriteImage),(ve,Te)=>{te=null,H||(H=ve,$=Te,fe())});function fe(){if(H)I(H);else if(L&&$){const ve=s.exported.getImageData($),Te={};for(const Ie in L){const{width:Pe,height:Le,x:he,y:Se,sdf:Fe,pixelRatio:ke,stretchX:Qe,stretchY:et,content:Je}=L[Ie],lt=new s.RGBAImage({width:Pe,height:Le});s.RGBAImage.copy(ve,lt,{x:he,y:Se},{x:0,y:0},{width:Pe,height:Le}),Te[Ie]={data:lt,pixelRatio:ke,sdf:Fe,stretchX:Qe,stretchY:et,content:Je}}I(null,Te)}}return{cancel(){ne&&(ne.cancel(),ne=null),te&&(te.cancel(),te=null)}}}(h,this.map._requestManager,(m,S)=>{if(this._spriteRequest=null,m)this.fire(new s.ErrorEvent(m));else if(S)for(const I in S)this.imageManager.addImage(I,S[I]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(h){const m=this.getSource(h.source);if(!m)return;const S=h.sourceLayer;S&&(m.type==="geojson"||m.vectorLayerIds&&m.vectorLayerIds.indexOf(S)===-1)&&this.fire(new s.ErrorEvent(new Error(`Source layer "${S}" does not exist on source "${m.id}" as specified by style layer "${h.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const h in this._sourceCaches)if(!this._sourceCaches[h].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(h){const m=[];for(const S of h){const I=this._layers[S];I.type!=="custom"&&m.push(I.serialize())}return m}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const h in this._sourceCaches)if(this._sourceCaches[h].hasTransition())return!0;for(const h in this._layers)if(this._layers[h].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(h){return!!this.terrain&&(typeof h.isLayerDraped=="function"?h.isLayerDraped():Zu[h.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(h){if(!this._loaded)return;const m=this._changed;if(this._changed){const I=Object.keys(this._updatedLayers),L=Object.keys(this._removedLayers);(I.length||L.length)&&this._updateWorkerLayers(I,L);for(const $ in this._updatedSources){const H=this._updatedSources[$];H==="reload"?this._reloadSource($):H==="clear"&&this._clearSource($)}this._updateTilesForChangedImages();for(const $ in this._updatedPaintProps)this._layers[$].updateTransitions(h);this.light.updateTransitions(h),this.fog&&this.fog.updateTransitions(h),this._resetUpdates()}const S={};for(const I in this._sourceCaches){const L=this._sourceCaches[I];S[I]=L.used,L.used=!1}for(const I of this._order){const L=this._layers[I];if(L.recalculate(h,this._availableImages),!L.isHidden(h.zoom)){const H=this._getLayerSourceCache(L);H&&(H.used=!0)}const $=this.map.painter;if($){const H=L.getProgramIds();if(!H)continue;const Q=L.getProgramConfiguration(h.zoom);for(const ne of H)$.useProgram(ne,Q)}}for(const I in S){const L=this._sourceCaches[I];S[I]!==L.used&&L.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:L.getSource().id}))}this.light.recalculate(h),this.terrain&&this.terrain.recalculate(h),this.fog&&this.fog.recalculate(h),this.z=h.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),m&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const h=Object.keys(this._changedImages);if(h.length){for(const m in this._sourceCaches)this._sourceCaches[m].reloadTilesForDependencies(["icons","patterns"],h);this._changedImages={}}}_updateWorkerLayers(h,m){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(h),removedIds:m})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(h){if(this._checkLoaded(),Xu(this,s.validateStyle(h)))return!1;(h=s.clone$1(h)).layers=qr(h.layers);const m=function(I,L){if(!I)return[{command:jn.setStyle,args:[L]}];let $=[];try{if(!u(I.version,L.version))return[{command:jn.setStyle,args:[L]}];u(I.center,L.center)||$.push({command:jn.setCenter,args:[L.center]}),u(I.zoom,L.zoom)||$.push({command:jn.setZoom,args:[L.zoom]}),u(I.bearing,L.bearing)||$.push({command:jn.setBearing,args:[L.bearing]}),u(I.pitch,L.pitch)||$.push({command:jn.setPitch,args:[L.pitch]}),u(I.sprite,L.sprite)||$.push({command:jn.setSprite,args:[L.sprite]}),u(I.glyphs,L.glyphs)||$.push({command:jn.setGlyphs,args:[L.glyphs]}),u(I.transition,L.transition)||$.push({command:jn.setTransition,args:[L.transition]}),u(I.light,L.light)||$.push({command:jn.setLight,args:[L.light]}),u(I.fog,L.fog)||$.push({command:jn.setFog,args:[L.fog]}),u(I.projection,L.projection)||$.push({command:jn.setProjection,args:[L.projection]});const H={},Q=[];(function(fe,ve,Te,Ie){let Pe;for(Pe in ve=ve||{},fe=fe||{})fe.hasOwnProperty(Pe)&&(ve.hasOwnProperty(Pe)||ca(Pe,Te,Ie));for(Pe in ve){if(!ve.hasOwnProperty(Pe))continue;const Le=ve[Pe];fe.hasOwnProperty(Pe)?u(fe[Pe],Le)||(fe[Pe].type==="geojson"&&Le.type==="geojson"&&zl(fe,ve,Pe)?Te.push({command:jn.setGeoJSONSourceData,args:[Pe,Le.data]}):kc(Pe,ve,Te,Ie)):ro(Pe,ve,Te)}})(I.sources,L.sources,Q,H);const ne=[];I.layers&&I.layers.forEach(fe=>{fe.source&&H[fe.source]?$.push({command:jn.removeLayer,args:[fe.id]}):ne.push(fe)});let te=I.terrain;te&&H[te.source]&&($.push({command:jn.setTerrain,args:[void 0]}),te=void 0),$=$.concat(Q),u(te,L.terrain)||$.push({command:jn.setTerrain,args:[L.terrain]}),function(fe,ve,Te){ve=ve||[];const Ie=(fe=fe||[]).map(Vo),Pe=ve.map(Vo),Le=fe.reduce(Bo,{}),he=ve.reduce(Bo,{}),Se=Ie.slice(),Fe=Object.create(null);let ke,Qe,et,Je,lt,st,xt;for(ke=0,Qe=0;ke<Ie.length;ke++)et=Ie[ke],he.hasOwnProperty(et)?Qe++:(Te.push({command:jn.removeLayer,args:[et]}),Se.splice(Se.indexOf(et,Qe),1));for(ke=0,Qe=0;ke<Pe.length;ke++)et=Pe[Pe.length-1-ke],Se[Se.length-1-ke]!==et&&(Le.hasOwnProperty(et)?(Te.push({command:jn.removeLayer,args:[et]}),Se.splice(Se.lastIndexOf(et,Se.length-Qe),1)):Qe++,st=Se[Se.length-ke],Te.push({command:jn.addLayer,args:[he[et],st]}),Se.splice(Se.length-ke,0,et),Fe[et]=!0);for(ke=0;ke<Pe.length;ke++)if(et=Pe[ke],Je=Le[et],lt=he[et],!Fe[et]&&!u(Je,lt))if(u(Je.source,lt.source)&&u(Je["source-layer"],lt["source-layer"])&&u(Je.type,lt.type)){for(xt in Qr(Je.layout,lt.layout,Te,et,null,jn.setLayoutProperty),Qr(Je.paint,lt.paint,Te,et,null,jn.setPaintProperty),u(Je.filter,lt.filter)||Te.push({command:jn.setFilter,args:[et,lt.filter]}),u(Je.minzoom,lt.minzoom)&&u(Je.maxzoom,lt.maxzoom)||Te.push({command:jn.setLayerZoomRange,args:[et,lt.minzoom,lt.maxzoom]}),Je)Je.hasOwnProperty(xt)&&xt!=="layout"&&xt!=="paint"&&xt!=="filter"&&xt!=="metadata"&&xt!=="minzoom"&&xt!=="maxzoom"&&(xt.indexOf("paint.")===0?Qr(Je[xt],lt[xt],Te,et,xt.slice(6),jn.setPaintProperty):u(Je[xt],lt[xt])||Te.push({command:jn.setLayerProperty,args:[et,xt,lt[xt]]}));for(xt in lt)lt.hasOwnProperty(xt)&&!Je.hasOwnProperty(xt)&&xt!=="layout"&&xt!=="paint"&&xt!=="filter"&&xt!=="metadata"&&xt!=="minzoom"&&xt!=="maxzoom"&&(xt.indexOf("paint.")===0?Qr(Je[xt],lt[xt],Te,et,xt.slice(6),jn.setPaintProperty):u(Je[xt],lt[xt])||Te.push({command:jn.setLayerProperty,args:[et,xt,lt[xt]]}))}else Te.push({command:jn.removeLayer,args:[et]}),st=Se[Se.lastIndexOf(et)+1],Te.push({command:jn.addLayer,args:[lt,st]})}(ne,L.layers,$)}catch(H){console.warn("Unable to compute style diff:",H),$=[{command:jn.setStyle,args:[L]}]}return $}(this.serialize(),h).filter(I=>!(I.command in I_));if(m.length===0)return!1;const S=m.filter(I=>!(I.command in kf));if(S.length>0)throw new Error(`Unimplemented: ${S.map(I=>I.command).join(", ")}.`);return m.forEach(I=>{I.command!=="setTransition"&&I.command!=="setProjection"&&this[I.command].apply(this,I.args)}),this.stylesheet=h,this._updateMapProjection(),!0}addImage(h,m){return this.getImage(h)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(h,m),this._afterImageUpdated(h),this)}updateImage(h,m){this.imageManager.updateImage(h,m)}getImage(h){return this.imageManager.getImage(h)}removeImage(h){return this.getImage(h)?(this.imageManager.removeImage(h),this._afterImageUpdated(h),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(h){this._availableImages=this.imageManager.listImages(),this._changedImages[h]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(h,m,S={}){if(this._checkLoaded(),this.getSource(h)!==void 0)throw new Error("There is already a source with this ID");if(!m.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(m).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(m.type)>=0&&this._validate(s.validateSource,`sources.${h}`,m,null,S))return;this.map&&this.map._collectResourceTiming&&(m.collectResourceTiming=!0);const I=ot(h,m,this.dispatcher,this);I.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(h),source:I.serialize(),sourceId:h}));const L=$=>{const H=($?"symbol:":"other:")+h,Q=this._sourceCaches[H]=new s.SourceCache(H,I,$);($?this._symbolSourceCaches:this._otherSourceCaches)[h]=Q,Q.style=this,Q.onAdd(this.map)};L(!1),m.type!=="vector"&&m.type!=="geojson"||L(!0),I.onAdd&&I.onAdd(this.map),this._changed=!0}removeSource(h){this._checkLoaded();const m=this.getSource(h);if(!m)throw new Error("There is no source with this ID");for(const I in this._layers)if(this._layers[I].source===h)return this.fire(new s.ErrorEvent(new Error(`Source "${h}" cannot be removed while layer "${I}" is using it.`)));if(this.terrain&&this.terrain.get().source===h)return this.fire(new s.ErrorEvent(new Error(`Source "${h}" cannot be removed while terrain is using it.`)));const S=this._getSourceCaches(h);for(const I of S)delete this._sourceCaches[I.id],delete this._updatedSources[I.id],I.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:I.getSource().id})),I.setEventedParent(null),I.clearTiles();return delete this._otherSourceCaches[h],delete this._symbolSourceCaches[h],m.setEventedParent(null),m.onRemove&&m.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(h,m){this._checkLoaded(),this.getSource(h).setData(m),this._changed=!0}getSource(h){const m=this._getSourceCache(h);return m&&m.getSource()}_getSources(){const h=[];for(const m in this._otherSourceCaches){const S=this._getSourceCache(m);S&&h.push(S.getSource())}return h}addLayer(h,m,S={}){this._checkLoaded();const I=h.id;if(this.getLayer(I))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${I}" already exists on this map`)));let L;if(h.type==="custom"){if(Xu(this,s.validateCustomStyleLayer(h)))return;L=s.createStyleLayer(h)}else{if(typeof h.source=="object"&&(this.addSource(I,h.source),h=s.clone$1(h),h=s.extend(h,{source:I})),this._validate(s.validateLayer,`layers.${I}`,h,{arrayIndex:-1},S))return;L=s.createStyleLayer(h),this._validateLayer(L),L.setEventedParent(this,{layer:{id:I}}),this._serializedLayers[L.id]=L.serialize(),this._updateLayerCount(L,!0)}const $=m?this._order.indexOf(m):this._order.length;if(m&&$===-1)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`)));this._order.splice($,0,I),this._layerOrderChanged=!0,this._layers[I]=L;const H=this._getLayerSourceCache(L);if(this._removedLayers[I]&&L.source&&H&&L.type!=="custom"){const Q=this._removedLayers[I];delete this._removedLayers[I],Q.type!==L.type?this._updatedSources[L.source]="clear":(this._updatedSources[L.source]="reload",H.pause())}this._updateLayer(L),L.onAdd&&L.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(h,m){if(this._checkLoaded(),this._changed=!0,!this._layers[h])return void this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be moved.`)));if(h===m)return;const S=this._order.indexOf(h);this._order.splice(S,1);const I=m?this._order.indexOf(m):this._order.length;m&&I===-1?this.fire(new s.ErrorEvent(new Error(`Layer with id "${m}" does not exist on this map.`))):(this._order.splice(I,0,h),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(h){this._checkLoaded();const m=this._layers[h];if(!m)return void this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be removed.`)));m.setEventedParent(null),this._updateLayerCount(m,!1);const S=this._order.indexOf(h);this._order.splice(S,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[h]=m,delete this._layers[h],delete this._serializedLayers[h],delete this._updatedLayers[h],delete this._updatedPaintProps[h],m.onRemove&&m.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(h){return this._layers[h]}hasLayer(h){return h in this._layers}hasLayerType(h){for(const m in this._layers)if(this._layers[m].type===h)return!0;return!1}setLayerZoomRange(h,m,S){this._checkLoaded();const I=this.getLayer(h);I?I.minzoom===m&&I.maxzoom===S||(m!=null&&(I.minzoom=m),S!=null&&(I.maxzoom=S),this._updateLayer(I)):this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(h,m,S={}){this._checkLoaded();const I=this.getLayer(h);if(I){if(!u(I.filter,m))return m==null?(I.filter=void 0,void this._updateLayer(I)):void(this._validate(s.validateFilter,`layers.${I.id}.filter`,m,{layerType:I.type},S)||(I.filter=s.clone$1(m),this._updateLayer(I)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be filtered.`)))}getFilter(h){const m=this.getLayer(h);return m&&s.clone$1(m.filter)}setLayoutProperty(h,m,S,I={}){this._checkLoaded();const L=this.getLayer(h);L?u(L.getLayoutProperty(m),S)||(L.setLayoutProperty(m,S,I),this._updateLayer(L)):this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(h,m){const S=this.getLayer(h);if(S)return S.getLayoutProperty(m);this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style.`)))}setPaintProperty(h,m,S,I={}){this._checkLoaded();const L=this.getLayer(h);L?u(L.getPaintProperty(m),S)||(L.setPaintProperty(m,S,I)&&this._updateLayer(L),this._changed=!0,this._updatedPaintProps[h]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${h}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(h,m){const S=this.getLayer(h);return S&&S.getPaintProperty(m)}setFeatureState(h,m){this._checkLoaded();const S=h.source,I=h.sourceLayer,L=this.getSource(S);if(!L)return void this.fire(new s.ErrorEvent(new Error(`The source '${S}' does not exist in the map's style.`)));const $=L.type;if($==="geojson"&&I)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if($==="vector"&&!I)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));h.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const H=this._getSourceCaches(S);for(const Q of H)Q.setFeatureState(I,h.id,m)}removeFeatureState(h,m){this._checkLoaded();const S=h.source,I=this.getSource(S);if(!I)return void this.fire(new s.ErrorEvent(new Error(`The source '${S}' does not exist in the map's style.`)));const L=I.type,$=L==="vector"?h.sourceLayer:void 0;if(L==="vector"&&!$)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(m&&typeof h.id!="string"&&typeof h.id!="number")return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const H=this._getSourceCaches(S);for(const Q of H)Q.removeFeatureState($,h.id,m)}getFeatureState(h){this._checkLoaded();const m=h.source,S=h.sourceLayer,I=this.getSource(m);if(I){if(I.type!=="vector"||S)return h.id===void 0&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(m)[0].getFeatureState(S,h.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const h={};for(const m in this._sourceCaches){const S=this._sourceCaches[m].getSource();h[S.id]||(h[S.id]=S.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:h,layers:this._serializeLayers(this._order)},m=>m!==void 0)}_updateLayer(h){this._updatedLayers[h.id]=!0;const m=this._getLayerSourceCache(h);h.source&&!this._updatedSources[h.source]&&m&&m.getSource().type!=="raster"&&(this._updatedSources[h.source]="reload",m.pause()),this._changed=!0,h.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(h){const m=$=>this._layers[$].type==="fill-extrusion",S={},I=[];for(let $=this._order.length-1;$>=0;$--){const H=this._order[$];if(m(H)){S[H]=$;for(const Q of h){const ne=Q[H];if(ne)for(const te of ne)I.push(te)}}}I.sort(($,H)=>H.intersectionZ-$.intersectionZ);const L=[];for(let $=this._order.length-1;$>=0;$--){const H=this._order[$];if(m(H))for(let Q=I.length-1;Q>=0;Q--){const ne=I[Q].feature;if(S[ne.layer.id]<$)break;L.push(ne),I.pop()}else for(const Q of h){const ne=Q[H];if(ne)for(const te of ne)L.push(te.feature)}}return L}queryRenderedFeatures(h,m,S){m&&m.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",m.filter,null,m);const I={};if(m&&m.layers){if(!Array.isArray(m.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const Q of m.layers){const ne=this._layers[Q];if(!ne)return this.fire(new s.ErrorEvent(new Error(`The layer '${Q}' does not exist in the map's style and cannot be queried for features.`))),[];I[ne.source]=!0}}const L=[];m.availableImages=this._availableImages;const $=m&&m.layers?m.layers.some(Q=>{const ne=this.getLayer(Q);return ne&&ne.is3D()}):this.has3DLayers(),H=ct.createFromScreenPoints(h,S);for(const Q in this._sourceCaches){const ne=this._sourceCaches[Q].getSource().id;m.layers&&!I[ne]||L.push(rn(this._sourceCaches[Q],this._layers,this._serializedLayers,H,m,S,$,!!this.map._showQueryGeometry))}return this.placement&&L.push(function(Q,ne,te,fe,ve,Te,Ie){const Pe={},Le=Te.queryRenderedSymbols(fe),he=[];for(const Se of Object.keys(Le).map(Number))he.push(Ie[Se]);he.sort(w);for(const Se of he){const Fe=Se.featureIndex.lookupSymbolFeatures(Le[Se.bucketInstanceId],ne,Se.bucketIndex,Se.sourceLayerIndex,ve.filter,ve.layers,ve.availableImages,Q);for(const ke in Fe){const Qe=Pe[ke]=Pe[ke]||[],et=Fe[ke];et.sort((Je,lt)=>{const st=Se.featureSortOrder;if(st){const xt=st.indexOf(Je.featureIndex);return st.indexOf(lt.featureIndex)-xt}return lt.featureIndex-Je.featureIndex});for(const Je of et)Qe.push(Je)}}for(const Se in Pe)Pe[Se].forEach(Fe=>{const ke=Fe.feature,Qe=te(Q[Se]);if(!Qe)return;const et=Qe.getFeatureState(ke.layer["source-layer"],ke.id);ke.source=ke.layer.source,ke.layer["source-layer"]&&(ke.sourceLayer=ke.layer["source-layer"]),ke.state=et});return Pe}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),H.screenGeometry,m,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(L)}querySourceFeatures(h,m){m&&m.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",m.filter,null,m);const S=this._getSourceCaches(h);let I=[];for(const L of S)I=I.concat(Gn(L,m));return I}addSourceType(h,m,S){return Ds.getSourceType(h)?S(new Error(`A source type called "${h}" already exists.`)):(Ds.setSourceType(h,m),m.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:h,url:m.workerSourceURL},S):S(null,null))}getLight(){return this.light.getLight()}setLight(h,m={}){this._checkLoaded();const S=this.light.getLight();let I=!1;for(const $ in h)if(!u(h[$],S[$])){I=!0;break}if(!I)return;const L=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(h,m),this.light.updateTransitions(L)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(h,m=1){if(this._checkLoaded(),!h)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let S=h;if(m===1){if(typeof S.source=="object"){const I="terrain-dem-src";this.addSource(I,S.source),S=s.clone$1(S),S=s.extend(S,{source:I})}if(this._validate(s.validateTerrain,"terrain",S))return}if(!this.terrain||this.terrain&&m!==this.terrain.drapeRenderMode){if(!S)return;this._createTerrain(S,m)}else{const I=this.terrain,L=I.get();for(const $ of Object.keys(s.spec.terrain))!S.hasOwnProperty($)&&s.spec.terrain[$].default&&(S[$]=s.spec.terrain[$].default);for(const $ in S)if(!u(S[$],L[$])){I.set(S),this.stylesheet.terrain=S;const H=this._setTransitionParameters({duration:0});I.updateTransitions(H);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(h){const m=this.fog=new De(h,this.map.transform);this.stylesheet.fog=h;const S=this._setTransitionParameters({duration:0});m.updateTransitions(S)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const h of this.map._markers)h._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(h){if(this._checkLoaded(),!h)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const m=this.fog,S=m.get();Object.keys(h).length===0&&m.set(h);for(const I in h)if(!u(h[I],S[I])){m.set(h),this.stylesheet.fog=h;const L=this._setTransitionParameters({duration:0});m.updateTransitions(L);break}}else this._createFog(h);this._markersNeedUpdate=!0}_setTransitionParameters(h){return{now:s.exported.now(),transition:s.extend(h,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const h=this._order.filter(S=>this.isLayerDraped(this._layers[S])),m=this._order.filter(S=>!this.isLayerDraped(this._layers[S]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...h),this._drapedFirstOrder.push(...m)}_createTerrain(h,m){const S=this.terrain=new Ye(h,m);this.stylesheet.terrain=h,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const I=this._setTransitionParameters({duration:0});S.updateTransitions(I)}_force3DLayerUpdate(){for(const h in this._layers){const m=this._layers[h];m.type==="fill-extrusion"&&this._updateLayer(m)}}_forceSymbolLayerUpdate(){for(const h in this._layers){const m=this._layers[h];m.type==="symbol"&&this._updateLayer(m)}}_validate(h,m,S,I,L={}){return(!L||L.validate!==!1)&&Xu(this,h.call(s.validateStyle,s.extend({key:m,style:this.serialize(),value:S,styleSpec:s.spec},I)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const h in this._layers)this._layers[h].setEventedParent(null);for(const h in this._sourceCaches)this._sourceCaches[h].clearTiles(),this._sourceCaches[h].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(h){const m=this._getSourceCaches(h);for(const S of m)S.clearTiles()}_reloadSource(h){const m=this._getSourceCaches(h);for(const S of m)S.resume(),S.reload()}_reloadSources(){for(const h of this._getSources())h.reload&&h.reload()}_updateSources(h){for(const m in this._sourceCaches)this._sourceCaches[m].update(h)}_generateCollisionBoxes(){for(const h in this._sourceCaches){const m=this._sourceCaches[h];m.resume(),m.reload()}}_updatePlacement(h,m,S,I,L=!1){let $=!1,H=!1;const Q={};for(const ne of this._order){const te=this._layers[ne];if(te.type!=="symbol")continue;if(!Q[te.source]){const ve=this._getLayerSourceCache(te);if(!ve)continue;Q[te.source]=ve.getRenderableIds(!0).map(Te=>ve.getTileByID(Te)).sort((Te,Ie)=>Ie.tileID.overscaledZ-Te.tileID.overscaledZ||(Te.tileID.isLessThan(Ie.tileID)?-1:1))}const fe=this.crossTileSymbolIndex.addLayer(te,Q[te.source],h.center.lng,h.projection);$=$||fe}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),L=L||this._layerOrderChanged||S===0,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(L||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),h.zoom))&&(this.pauseablePlacement=new CA(h,this._order,L,m,S,I,this.placement,this.fog&&h.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,Q),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),H=!0),$&&this.pauseablePlacement.placement.setStale()),H||$)for(const ne of this._order){const te=this._layers[ne];te.type==="symbol"&&this.placement.updateLayerOpacities(te,Q[te.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const h in this._sourceCaches)this._sourceCaches[h].releaseSymbolFadeTiles()}getImages(h,m,S){this.imageManager.getImages(m.icons,S),this._updateTilesForChangedImages();const I=L=>{L&&L.setDependencies(m.tileID.key,m.type,m.icons)};I(this._otherSourceCaches[m.source]),I(this._symbolSourceCaches[m.source])}getGlyphs(h,m,S){this.glyphManager.getGlyphs(m.stacks,S)}getResource(h,m,S){return s.makeRequest(m,S)}_getSourceCache(h){return this._otherSourceCaches[h]}_getLayerSourceCache(h){return h.type==="symbol"?this._symbolSourceCaches[h.source]:this._otherSourceCaches[h.source]}_getSourceCaches(h){const m=[];return this._otherSourceCaches[h]&&m.push(this._otherSourceCaches[h]),this._symbolSourceCaches[h]&&m.push(this._symbolSourceCaches[h]),m}_isSourceCacheLoaded(h){const m=this._getSourceCaches(h);return m.length===0?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${h}'`))),!1):m.every(S=>S.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ds.getSourceType=function(v){return tr[v]},Ds.setSourceType=function(v,h){tr[v]=h},Ds.registerForPluginStateChange=s.registerForPluginStateChange;var Mg=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,zc="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ol=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Gl=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Bs=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let up={},zf={};const Uf=[];qh(Mg,Uf),qh(ol,Uf),qh(Gl,Uf),qh(Bs,Uf),up=Kr("",ol),zf=Kr(Bs,Gl);const M_=Kr(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Og=Mg,Rg=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var PA={background:Kr(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Kr(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Kr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Kr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Kr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Kr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Kr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Kr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Kr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Kr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Kr(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Kr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Kr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Kr(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Kr(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Kr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Kr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Kr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Kr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Kr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Kr(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Kr(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Kr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Kr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Kr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Kr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,zc),skyboxGradient:Kr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,zc),skyboxCapture:Kr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Kr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Kr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function qh(v,h){const m=v.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let S of m)if(S=S.trim(),S[0]==="#"&&S.includes("if")&&!S.includes("endif")){S=S.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const I=S.split(" ");for(const L of I)h.includes(L)||h.push(L)}}function Kr(v,h){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,S=h.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),I={},L=[...Uf];return qh(v,L),qh(h,L),{fragmentSource:v=v.replace(m,($,H,Q,ne,te)=>(I[te]=!0,H==="define"?`
#ifndef HAS_UNIFORM_u_${te}
varying ${Q} ${ne} ${te};
#else
uniform ${Q} ${ne} u_${te};
#endif
`:`
#ifdef HAS_UNIFORM_u_${te}
    ${Q} ${ne} ${te} = u_${te};
#endif
`)),vertexSource:h=h.replace(m,($,H,Q,ne,te)=>{const fe=ne==="float"?"vec2":"vec4",ve=te.match(/color/)?"color":fe;return I[te]?H==="define"?`
#ifndef HAS_UNIFORM_u_${te}
uniform lowp float u_${te}_t;
attribute ${Q} ${fe} a_${te};
varying ${Q} ${ne} ${te};
#else
uniform ${Q} ${ne} u_${te};
#endif
`:ve==="vec4"?`
#ifndef HAS_UNIFORM_u_${te}
    ${te} = a_${te};
#else
    ${Q} ${ne} ${te} = u_${te};
#endif
`:`
#ifndef HAS_UNIFORM_u_${te}
    ${te} = unpack_mix_${ve}(a_${te}, u_${te}_t);
#else
    ${Q} ${ne} ${te} = u_${te};
#endif
`:H==="define"?`
#ifndef HAS_UNIFORM_u_${te}
uniform lowp float u_${te}_t;
attribute ${Q} ${fe} a_${te};
#else
uniform ${Q} ${ne} u_${te};
#endif
`:ve==="vec4"?`
#ifndef HAS_UNIFORM_u_${te}
    ${Q} ${ne} ${te} = a_${te};
#else
    ${Q} ${ne} ${te} = u_${te};
#endif
`:`
#ifndef HAS_UNIFORM_u_${te}
    ${Q} ${ne} ${te} = unpack_mix_${ve}(a_${te}, u_${te}_t);
#else
    ${Q} ${ne} ${te} = u_${te};
#endif
`}),staticAttributes:S,usedDefines:L}}class cp{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(h,m,S,I,L,$,H){this.context=h;let Q=this.boundPaintVertexBuffers.length!==I.length;for(let te=0;!Q&&te<I.length;te++)this.boundPaintVertexBuffers[te]!==I[te]&&(Q=!0);let ne=this.boundDynamicVertexBuffers.length!==H.length;for(let te=0;!ne&&te<H.length;te++)this.boundDynamicVertexBuffers[te]!==H[te]&&(ne=!0);if(!h.extVertexArrayObject||!this.vao||this.boundProgram!==m||this.boundLayoutVertexBuffer!==S||Q||ne||this.boundIndexBuffer!==L||this.boundVertexOffset!==$)this.freshBind(m,S,I,L,$,H);else{h.bindVertexArrayOES.set(this.vao);for(const te of H)te&&te.bind();L&&L.dynamicDraw&&L.bind()}}freshBind(h,m,S,I,L,$){let H;const Q=h.numAttributes,ne=this.context,te=ne.gl;if(ne.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ne.extVertexArrayObject.createVertexArrayOES(),ne.bindVertexArrayOES.set(this.vao),H=0,this.boundProgram=h,this.boundLayoutVertexBuffer=m,this.boundPaintVertexBuffers=S,this.boundIndexBuffer=I,this.boundVertexOffset=L,this.boundDynamicVertexBuffers=$;else{H=ne.currentNumAttributes||0;for(let fe=Q;fe<H;fe++)te.disableVertexAttribArray(fe)}m.enableAttributes(te,h),m.bind(),m.setVertexAttribPointers(te,h,L);for(const fe of S)fe.enableAttributes(te,h),fe.bind(),fe.setVertexAttribPointers(te,h,L);for(const fe of $)fe&&(fe.enableAttributes(te,h),fe.bind(),fe.setVertexAttribPointers(te,h,L));I&&I.bind(),ne.currentNumAttributes=Q}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function IA(v,h){const m=Math.pow(2,h.canonical.z),S=h.canonical.y;return[new s.MercatorCoordinate(0,S/m).toLngLat().lat,new s.MercatorCoordinate(0,(S+1)/m).toLngLat().lat]}function MA(v,h,m,S,I,L,$){const H=v.context,Q=H.gl,ne=m.fbo;if(!ne)return;v.prepareDrawTile();const te=v.useProgram("hillshade");H.activeTexture.set(Q.TEXTURE0),Q.bindTexture(Q.TEXTURE_2D,ne.colorAttachment.get());const fe=((Pe,Le,he,Se)=>{const Fe=he.paint.get("hillshade-shadow-color"),ke=he.paint.get("hillshade-highlight-color"),Qe=he.paint.get("hillshade-accent-color");let et=he.paint.get("hillshade-illumination-direction")*(Math.PI/180);he.paint.get("hillshade-illumination-anchor")==="viewport"&&(et-=Pe.transform.angle);const Je=!Pe.options.moving;return{u_matrix:Se||Pe.transform.calculateProjMatrix(Le.tileID.toUnwrapped(),Je),u_image:0,u_latrange:IA(0,Le.tileID),u_light:[he.paint.get("hillshade-exaggeration"),et],u_shadow:Fe,u_highlight:ke,u_accent:Qe}})(v,m,S,v.terrain?h.projMatrix:null);v.prepareDrawProgram(H,te,h.toUnwrapped());const{tileBoundsBuffer:ve,tileBoundsIndexBuffer:Te,tileBoundsSegments:Ie}=v.getTileBoundsBuffers(m);te.draw(H,Q.TRIANGLES,I,L,$,s.CullFaceMode.disabled,fe,S.id,ve,Te,Ie)}function Lg(v,h,m){if(!h.needsDEMTextureUpload)return;const S=v.context,I=S.gl;S.pixelStoreUnpackPremultiplyAlpha.set(!1),h.demTexture=h.demTexture||v.getTileTexture(m.stride);const L=m.getPixels();h.demTexture?h.demTexture.update(L,{premultiply:!1}):h.demTexture=new s.Texture(S,L,I.RGBA,{premultiply:!1}),h.needsDEMTextureUpload=!1}function Gf(v,h,m,S,I,L){const $=v.context,H=$.gl;if(!h.dem)return;const Q=h.dem;if($.activeTexture.set(H.TEXTURE1),Lg(v,h,Q),!h.demTexture)return;h.demTexture.bind(H.NEAREST,H.CLAMP_TO_EDGE);const ne=Q.dim;$.activeTexture.set(H.TEXTURE0);let te=h.fbo;if(!te){const Ie=new s.Texture($,{width:ne,height:ne,data:null},H.RGBA);Ie.bind(H.LINEAR,H.CLAMP_TO_EDGE),te=h.fbo=$.createFramebuffer(ne,ne,!0),te.colorAttachment.set(Ie.texture)}$.bindFramebuffer.set(te.framebuffer),$.viewport.set([0,0,ne,ne]);const{tileBoundsBuffer:fe,tileBoundsIndexBuffer:ve,tileBoundsSegments:Te}=v.getMercatorTileBoundsBuffers();v.useProgram("hillshadePrepare").draw($,H.TRIANGLES,S,I,L,s.CullFaceMode.disabled,((Ie,Pe)=>{const Le=Pe.stride,he=s.create();return s.ortho(he,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(he,he,[0,-s.EXTENT,0]),{u_matrix:he,u_image:1,u_dimension:[Le,Le],u_zoom:Ie.overscaledZ,u_unpack:Pe.unpackVector}})(h.tileID,Q),m.id,fe,ve,Te),h.needsHillshadePrepare=!1}const OA=v=>({u_matrix:new s.UniformMatrix4f(v),u_image0:new s.Uniform1i(v),u_skirt_height:new s.Uniform1f(v)}),jf=(v,h)=>({u_matrix:v,u_image0:0,u_skirt_height:h}),fp=(v,h,m,S,I,L,$,H,Q,ne,te,fe,ve,Te,Ie)=>({u_proj_matrix:Float32Array.from(v),u_globe_matrix:h,u_normalize_matrix:Float32Array.from(S),u_merc_matrix:m,u_zoom_transition:I,u_merc_center:L,u_image0:0,u_frustum_tl:$,u_frustum_tr:H,u_frustum_br:Q,u_frustum_bl:ne,u_globe_pos:te,u_globe_radius:fe,u_viewport:ve,u_grid_matrix:Ie?Float32Array.from(Ie):new Float32Array(9),u_skirt_height:Te});function fu(v,h){return v!=null&&h!=null&&!(!v.hasData()||!h.hasData())&&v.demTexture!=null&&h.demTexture!=null&&v.tileID.key!==h.tileID.key}const pa=new class{constructor(){this.operations={}}newMorphing(v,h,m,S,I){if(v in this.operations){const L=this.operations[v];L.to.tileID.key!==m.tileID.key&&(L.queued=m)}else this.operations[v]={startTime:S,phase:0,duration:I,from:h,to:m,queued:null}}getMorphValuesForProxy(v){if(!(v in this.operations))return null;const h=this.operations[v];return{from:h.from,to:h.to,phase:h.phase}}update(v){for(const h in this.operations){const m=this.operations[h];for(m.phase=(v-m.startTime)/m.duration;m.phase>=1||!this._validOp(m);)if(!this._nextOp(m,v)){delete this.operations[h];break}}}_nextOp(v,h){return!!v.queued&&(v.from=v.to,v.to=v.queued,v.queued=null,v.phase=0,v.startTime=h,!0)}_validOp(v){return v.from.hasData()&&v.to.hasData()}},Vf={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Uc(v){return 6*Math.pow(1.5,22-v)}function O_(v,h){const m=1<<v.z;return!h&&(v.x===0||v.x===m-1)||v.y===0||v.y===m-1}const hp=v=>({u_matrix:v});function RA(v,h,m,S,I){if(I>0){const L=s.exported.now(),$=(L-v.timeAdded)/I,H=h?(L-h.timeAdded)/I:-1,Q=m.getSource(),ne=S.coveringZoomLevel({tileSize:Q.tileSize,roundZoom:Q.roundZoom}),te=!h||Math.abs(h.tileID.overscaledZ-ne)>Math.abs(v.tileID.overscaledZ-ne),fe=te&&v.refreshedUponExpiration?1:s.clamp(te?$:1-H,0,1);return v.refreshedUponExpiration&&$>=1&&(v.refreshedUponExpiration=!1),h?{opacity:1,mix:1-fe}:{opacity:fe,mix:0}}return{opacity:1,mix:0}}class LA extends s.SourceCache{constructor(h){const m={type:"raster-dem",maxzoom:h.transform.maxZoom},S=new Re(Tr(),null),I=ot("mock-dem",m,S,h.style);super("mock-dem",I,!1),I.setEventedParent(this),this._sourceLoaded=!0}_loadTile(h,m){h.state="loaded",m(null)}}class Dg extends s.SourceCache{constructor(h){const m=ot("proxy",{type:"geojson",maxzoom:h.transform.maxZoom},new Re(Tr(),null),h.style);super("proxy",m,!1),m.setEventedParent(this),this.map=this.getSource().map=h,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(h,m,S){if(h.freezeTileCoverage)return;this.transform=h;const I=h.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((L,$)=>{if(L[$.key]="",!this._tiles[$.key]){const H=new s.Tile($,this._source.tileSize*$.overscaleFactor(),h.tileZoom);H.state="loaded",this._tiles[$.key]=H}return L},{});for(const L in this._tiles)L in I||(this.freeFBO(L),this._tiles[L].unloadVectorData(),delete this._tiles[L])}freeFBO(h){const m=this.proxyCachedFBO[h];if(m!==void 0){const S=Object.values(m);this.renderCachePool.push(...S),delete this.proxyCachedFBO[h]}}deallocRenderCache(){this.renderCache.forEach(h=>h.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Bg extends s.OverscaledTileID{constructor(h,m,S){super(h.overscaledZ,h.wrap,h.canonical.z,h.canonical.x,h.canonical.y),this.proxyTileKey=m,this.projMatrix=S}}class DA extends s.Elevation{constructor(h,m){super(),this.painter=h,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[S,I,L]=function(Q){const ne=new s.StructArrayLayout2i4,te=new s.StructArrayLayout3ui6,fe=131;ne.reserve(17161),te.reserve(33800);const ve=s.EXTENT/128,Te=s.EXTENT+ve/2,Ie=Te+ve;for(let Le=-ve;Le<Ie;Le+=ve)for(let he=-ve;he<Ie;he+=ve){const Se=he<0||he>Te||Le<0||Le>Te?24575:0,Fe=s.clamp(Math.round(he),0,s.EXTENT),ke=s.clamp(Math.round(Le),0,s.EXTENT);ne.emplaceBack(Fe+Se,ke)}const Pe=(Le,he)=>{const Se=he*fe+Le;te.emplaceBack(Se+1,Se,Se+fe),te.emplaceBack(Se+fe,Se+fe+1,Se+1)};for(let Le=1;Le<129;Le++)for(let he=1;he<129;he++)Pe(he,Le);return[0,129].forEach(Le=>{for(let he=0;he<130;he++)Pe(he,Le),Pe(Le,he)}),[ne,te,32768]}(),$=h.context;this.gridBuffer=$.createVertexBuffer(S,s.posAttributes.members),this.gridIndexBuffer=$.createIndexBuffer(I),this.gridSegments=s.SegmentVector.simpleSegment(0,0,S.length,I.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,S.length,L),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Dg(m.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.EXTENT,0,s.EXTENT,0,1);const H=$.gl;this._overlapStencilMode=new s.StencilMode({func:H.GEQUAL,mask:255},0,255,H.KEEP,H.KEEP,H.REPLACE),this._previousZoom=h.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=m,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new LA(m.map)}set style(h){h.on("data",this._onStyleDataEvent.bind(this)),h.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=h,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(h,m,S){if(h&&h.terrain){this._style!==h&&(this.style=h),this.enabled=!0;const I=h.terrain.properties;this.sourceCache=h.terrain.drapeRenderMode===0?this._mockSourceCache:h._getSourceCache(I.get("source")),this._exaggeration=I.get("exaggeration");const L=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const $=this.getScaledDemTileSize();this.sourceCache.update(m,$,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,L(),this._initializing=!0),L(),m.updateElevation(!0,S),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(m),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(h){this._findCoveringTileCache[h]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const h=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||h.efficiency!==100&&s.warnOnce(`Terrain render cache efficiency is not optimal (${h.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${h.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(h){h.coord&&h.dataType==="source"?this._clearRenderCacheForTile(h.sourceCacheId,h.coord):h.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const h in this._style._sourceCaches)this._style._sourceCaches[h].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(h=>h.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const h=2*this.proxySourceCache.getSource().tileSize;return[h,h]}set useVertexMorphing(h){this._useVertexMorphing=h}updateTileBinding(h){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const m=this.proxySourceCache,S=this.painter.transform;this._initializing&&(this._initializing=S._centerAltitude===0&&this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(S.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const I=this.proxyCoords=m.getIds().map(Q=>{const ne=m.getTileByID(Q).tileID;return ne.projMatrix=S.calculateProjMatrix(ne.toUnwrapped()),ne});(function(Q,ne){const te=ne.transform.pointCoordinate(ne.transform.getCameraPoint()),fe=new s.Point(te.x,te.y);Q.sort((ve,Te)=>{if(Te.overscaledZ-ve.overscaledZ)return Te.overscaledZ-ve.overscaledZ;const Ie=new s.Point(ve.canonical.x+(1<<ve.canonical.z)*ve.wrap,ve.canonical.y),Pe=new s.Point(Te.canonical.x+(1<<Te.canonical.z)*Te.wrap,Te.canonical.y),Le=fe.mult(1<<ve.canonical.z);return Le.x-=.5,Le.y-=.5,Le.distSqr(Ie)-Le.distSqr(Pe)})})(I,this.painter),this._previousZoom=S.zoom;const L=this.proxyToSource||{};this.proxyToSource={},I.forEach(Q=>{this.proxyToSource[Q.key]={}}),this.terrainTileForTile={};const $=this._style._sourceCaches;for(const Q in $){const ne=$[Q];if(!ne.used||(ne!==this.sourceCache&&this.resetTileLookupCache(ne.id),this._setupProxiedCoordsForOrtho(ne,h[Q],L),ne.usedForTerrain))continue;const te=h[Q];ne.getSource().reparseOverscaled&&this._assignTerrainTiles(te)}this.proxiedCoords[m.id]=I.map(Q=>new Bg(Q,Q.key,this.orthoMatrix)),this._assignTerrainTiles(I),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(L),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const H={};this._visibleDemTiles=[];for(const Q of this.proxyCoords){const ne=this.terrainTileForTile[Q.key];if(!ne)continue;const te=ne.tileID.key;te in H||(this._visibleDemTiles.push(ne),H[te]=te)}}_assignTerrainTiles(h){this._initializing||h.forEach(m=>{if(this.terrainTileForTile[m.key])return;const S=this._findTileCoveringTileID(m,this.sourceCache);S&&(this.terrainTileForTile[m.key]=S)})}_prepareDEMTextures(){const h=this.painter.context,m=h.gl;for(const S in this.terrainTileForTile){const I=this.terrainTileForTile[S],L=I.dem;!L||I.demTexture&&!I.needsDEMTextureUpload||(h.activeTexture.set(m.TEXTURE1),Lg(this.painter,I,L))}}_prepareDemTileUniforms(h,m,S,I){if(!m||m.demTexture==null)return!1;const L=h.tileID.canonical,$=Math.pow(2,m.tileID.canonical.z-L.z),H=I||"";return S[`u_dem_tl${H}`]=[L.x*$%1,L.y*$%1],S[`u_dem_scale${H}`]=$,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const h=this.painter.context,m=h.gl;if(!this._emptyDepthBufferTexture){const S=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(h,S,m.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let h=0;const m=this._visibleDemTiles.reduce((S,I)=>{if(!I.dem)return S;const L=I.dem.tree.minimums[0];return L>0&&h++,S+L},0);return h?m/h:0}_updateEmptyDEMTexture(){const h=this.painter.context,m=h.gl;h.activeTexture.set(m.TEXTURE2);const S=this._getLoadedAreaMinimum(),I=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(S,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let L=this._emptyDEMTexture;return L?L.update(I,{premultiply:!1}):L=this._emptyDEMTexture=new s.Texture(h,I,m.RGBA,{premultiply:!1}),L}setupElevationDraw(h,m,S){const I=this.painter.context,L=I.gl,$=(H=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(H),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var H;$.u_dem_size=this.sourceCache.getSource().tileSize,$.u_exaggeration=this.exaggeration();let Q=null,ne=null,te=1;if(S&&S.morphing&&this._useVertexMorphing){const fe=S.morphing.srcDemTile,ve=S.morphing.dstDemTile;te=S.morphing.phase,fe&&ve&&(this._prepareDemTileUniforms(h,fe,$,"_prev")&&(ne=fe),this._prepareDemTileUniforms(h,ve,$)&&(Q=ve))}if(ne&&Q?(I.activeTexture.set(L.TEXTURE2),Q.demTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE,L.NEAREST),I.activeTexture.set(L.TEXTURE4),ne.demTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE,L.NEAREST),$.u_dem_lerp=te):(Q=this.terrainTileForTile[h.tileID.key],I.activeTexture.set(L.TEXTURE2),(this._prepareDemTileUniforms(h,Q,$)?Q.demTexture:this.emptyDEMTexture).bind(L.NEAREST,L.CLAMP_TO_EDGE)),I.activeTexture.set(L.TEXTURE3),S&&S.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE),this._depthFBO&&($.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(L.NEAREST,L.CLAMP_TO_EDGE),$.u_depth_size_inv=[1,1]),S&&S.useMeterToDem&&Q){const fe=(1<<Q.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;$.u_meter_to_dem=fe}if(S&&S.labelPlaneMatrixInv&&($.u_label_plane_matrix_inv=S.labelPlaneMatrixInv),m.setTerrainUniformValues(I,$),this.painter.transform.projection.name==="globe"){const fe=this.globeUniformValues(this.painter.transform,h.tileID.canonical,S&&S.useDenormalizedUpVectorScale);m.setGlobeUniformValues(I,fe)}}globeUniformValues(h,m,S){const I=h.projection;return{u_tile_tl_up:I.upVector(m,0,0),u_tile_tr_up:I.upVector(m,s.EXTENT,0),u_tile_br_up:I.upVector(m,s.EXTENT,s.EXTENT),u_tile_bl_up:I.upVector(m,0,s.EXTENT),u_tile_up_scale:S?s.globeMetersToEcef(1):I.upVectorScale(m,h.center.lat,h.worldSize).metersToTile}}renderToBackBuffer(h){const m=this.painter,S=this.painter.context;h.length!==0&&(S.bindFramebuffer.set(null),S.viewport.set([0,0,m.width,m.height]),m.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(I,L,$,H,Q){if(I.transform.projection.name==="globe")(function(ne,te,fe,ve,Te){const Ie=ne.context,Pe=Ie.gl;let Le,he;const Se=ne.options.showTerrainWireframe?2:0,Fe=ne.transform,ke=s.globeUseCustomAntiAliasing(ne,Ie,Fe),Qe=(Kt,vt)=>{if(he===Kt)return;const zt=[Vf[Kt],"PROJECTION_GLOBE_VIEW"];ke&&zt.push("CUSTOM_ANTIALIASING"),vt&&zt.push(Vf[Se]),Le=ne.useProgram("globeRaster",null,zt),he=Kt},et=ne.colorModeForRenderPass(),Je=new s.DepthMode(Pe.LEQUAL,s.DepthMode.ReadWrite,ne.depthRangeFor3D);pa.update(Te);const lt=s.calculateGlobeMercatorMatrix(Fe),st=[s.mercatorXfromLng(Fe.center.lng),s.mercatorYfromLat(Fe.center.lat)],xt=Se?[!1,!0]:[!1],en=ne.globeSharedBuffers,mt=[Fe.width*s.exported.devicePixelRatio,Fe.height*s.exported.devicePixelRatio],Ut=Float32Array.from(Fe.globeMatrix),St={useDenormalizedUpVectorScale:!0};if(xt.forEach(Kt=>{const vt=ne.transform,zt=Uc(vt.zoom)*te.exaggeration();he=-1;const nn=Kt?Pe.LINES:Pe.TRIANGLES;for(const Ht of ve){const an=fe.getTile(Ht),Wn=s.StencilMode.disabled,hr=te.prevTerrainTileForTile[Ht.key],kn=te.terrainTileForTile[Ht.key];fu(hr,kn)&&pa.newMorphing(Ht.key,hr,kn,Te,250),Ie.activeTexture.set(Pe.TEXTURE0),an.texture.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE);const er=pa.getMorphValuesForProxy(Ht.key),Fr=er?1:0;er&&s.extend$1(St,{morphing:{srcDemTile:er.from,dstDemTile:er.to,phase:s.easeCubicInOut(er.phase)}});const Nr=s.tileCornersToBounds(Ht.canonical),Vn=s.getLatitudinalLod(Nr.getCenter().lat),fi=s.getGridMatrix(Ht.canonical,Nr,Vn,vt.worldSize/vt._pixelsPerMercatorPixel),bi=s.globeNormalizeECEF(s.globeTileBounds(Ht.canonical)),wi=fp(vt.projMatrix,Ut,lt,bi,s.globeToMercatorTransition(vt.zoom),st,vt.frustumCorners.TL,vt.frustumCorners.TR,vt.frustumCorners.BR,vt.frustumCorners.BL,vt.globeCenterInViewSpace,vt.globeRadius,mt,zt,fi);if(Qe(Fr,Kt),te.setupElevationDraw(an,Le,St),ne.prepareDrawProgram(Ie,Le,Ht.toUnwrapped()),en){const[Ei,_a,Ns]=Kt?en.getWirefameBuffers(ne.context,Vn):en.getGridBuffers(Vn,zt!==0);Le.draw(Ie,nn,Je,Wn,et,s.CullFaceMode.backCCW,wi,"globe_raster",Ei,_a,Ns)}}}),en){const Kt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ke&&Kt.push("CUSTOM_ANTIALIASING"),Le=ne.useProgram("globeRaster",null,Kt);for(const vt of ve){const{x:zt,y:nn,z:Ht}=vt.canonical,an=nn===0,Wn=nn===(1<<Ht)-1,[hr,kn,er,Fr]=en.getPoleBuffers(Ht);if(Fr&&(an||Wn)){const Nr=fe.getTile(vt);Ie.activeTexture.set(Pe.TEXTURE0),Nr.texture.bind(Pe.LINEAR,Pe.CLAMP_TO_EDGE);let Vn=s.globePoleMatrixForTile(Ht,zt,Fe);const fi=s.globeNormalizeECEF(s.globeTileBounds(vt.canonical)),bi=(wi,Ei)=>wi.draw(Ie,Pe.TRIANGLES,Je,s.StencilMode.disabled,et,s.CullFaceMode.disabled,fp(Fe.projMatrix,Vn,Vn,fi,0,st,Fe.frustumCorners.TL,Fe.frustumCorners.TR,Fe.frustumCorners.BR,Fe.frustumCorners.BL,Fe.globeCenterInViewSpace,Fe.globeRadius,mt,0),"globe_pole_raster",Ei,er,Fr);te.setupElevationDraw(Nr,Le,St),ne.prepareDrawProgram(Ie,Le,vt.toUnwrapped()),an&&bi(Le,hr),Wn&&(Vn=s.scale(s.create(),Vn,[1,-1,1]),bi(Le,kn))}}}})(I,L,$,H,Q);else{const ne=I.context,te=ne.gl;let fe,ve;const Te=I.options.showTerrainWireframe?2:0,Ie=(Fe,ke)=>{if(ve===Fe)return;const Qe=[Vf[Fe]];ke&&Qe.push(Vf[Te]),fe=I.useProgram("terrainRaster",null,Qe),ve=Fe},Pe=I.colorModeForRenderPass(),Le=new s.DepthMode(te.LEQUAL,s.DepthMode.ReadWrite,I.depthRangeFor3D);pa.update(Q);const he=I.transform,Se=Uc(he.zoom)*L.exaggeration();(Te?[!1,!0]:[!1]).forEach(Fe=>{ve=-1;const ke=Fe?te.LINES:te.TRIANGLES,[Qe,et]=Fe?L.getWirefameBuffer():[L.gridIndexBuffer,L.gridSegments];for(const Je of H){const lt=$.getTile(Je),st=s.StencilMode.disabled,xt=L.prevTerrainTileForTile[Je.key],en=L.terrainTileForTile[Je.key];fu(xt,en)&&pa.newMorphing(Je.key,xt,en,Q,250),ne.activeTexture.set(te.TEXTURE0),lt.texture.bind(te.LINEAR,te.CLAMP_TO_EDGE,te.LINEAR_MIPMAP_NEAREST);const mt=pa.getMorphValuesForProxy(Je.key),Ut=mt?1:0;let St;mt&&(St={morphing:{srcDemTile:mt.from,dstDemTile:mt.to,phase:s.easeCubicInOut(mt.phase)}});const Kt=jf(Je.projMatrix,O_(Je.canonical,he.renderWorldCopies)?Se/10:Se);Ie(Ut,Fe),L.setupElevationDraw(lt,fe,St),I.prepareDrawProgram(ne,fe,Je.toUnwrapped()),fe.draw(ne,ke,Le,st,Pe,s.CullFaceMode.backCCW,Kt,"terrain_raster",L.gridBuffer,Qe,et)}})}}(m,this,this.proxySourceCache,h,this._updateTimestamp),this.renderingToTexture=!0,m.gpuTimingDeferredRenderEnd(),h.splice(0,h.length))}renderBatch(h){if(this._drapedRenderBatches.length===0)return h+1;this.renderingToTexture=!0;const m=this.painter,S=this.painter.context,I=this.proxySourceCache,L=this.proxiedCoords[I.id],$=this._drapedRenderBatches.shift(),H=[],Q=m.style.order;let ne=0;for(const te of L){const fe=I.getTileByID(te.proxyTileKey),ve=I.proxyCachedFBO[te.key]?I.proxyCachedFBO[te.key][h]:void 0,Te=ve!==void 0?I.renderCache[ve]:this.pool[ne++],Ie=ve!==void 0;if(fe.texture=Te.tex,Ie&&!Te.dirty){H.push(fe.tileID);continue}let Pe;S.bindFramebuffer.set(Te.fb.framebuffer),this.renderedToTile=!1,Te.dirty&&(S.clear({color:s.Color.transparent,stencil:0}),Te.dirty=!1);for(let Le=$.start;Le<=$.end;++Le){const he=m.style._layers[Q[Le]];if(he.isHidden(m.transform.zoom))continue;const Se=m.style._getLayerSourceCache(he),Fe=Se?this.proxyToSource[te.key][Se.id]:[te];if(!Fe)continue;const ke=Fe;S.viewport.set([0,0,Te.fb.width,Te.fb.height]),Pe!==(Se?Se.id:null)&&(this._setupStencil(Te,Fe,he,Se),Pe=Se?Se.id:null),m.renderLayer(m,Se,he,ke)}this.renderedToTile?(Te.dirty=!0,H.push(fe.tileID)):Ie||--ne,ne===5&&(ne=0,this.renderToBackBuffer(H))}return this.renderToBackBuffer(H),this.renderingToTexture=!1,S.bindFramebuffer.set(null),S.viewport.set([0,0,m.width,m.height]),$.end+1}postRender(){}renderCacheEfficiency(h){const m=h.order.length;if(m===0)return{efficiency:100};let S,I=0,L=0,$=!1;for(let H=0;H<m;++H){const Q=h._layers[h.order[H]];this._style.isLayerDraped(Q)?($&&++I,++L):$||($=!0,S=Q.id)}return L===0?{efficiency:100}:{efficiency:100*(1-I/L),firstUndrapedLayer:S}}getMinElevationBelowMSL(){let h=0;return this._visibleDemTiles.filter(m=>m.dem).forEach(m=>{h=Math.min(h,m.dem.tree.minimums[0])}),h===0?h:(h-30)*this._exaggeration}raycast(h,m,S){if(!this._visibleDemTiles)return null;const I=this._visibleDemTiles.filter(L=>L.dem).map(L=>{const $=L.tileID,H=1<<$.overscaledZ,{x:Q,y:ne}=$.canonical,te=Q/H,fe=(Q+1)/H,ve=ne/H,Te=(ne+1)/H;return{minx:te,miny:ve,maxx:fe,maxy:Te,t:L.dem.tree.raycastRoot(te,ve,fe,Te,h,m,S),tile:L}});I.sort((L,$)=>(L.t!==null?L.t:Number.MAX_VALUE)-($.t!==null?$.t:Number.MAX_VALUE));for(const L of I){if(L.t==null)return null;const $=L.tile.dem.tree.raycast(L.minx,L.miny,L.maxx,L.maxy,h,m,S);if($!=null)return $}return null}_createFBO(){const h=this.painter.context,m=h.gl,S=this.drapeBufferSize;h.activeTexture.set(m.TEXTURE0);const I=new s.Texture(h,{width:S[0],height:S[1],data:null},m.RGBA);I.bind(m.LINEAR,m.CLAMP_TO_EDGE);const L=h.createFramebuffer(S[0],S[1],!1);return L.colorAttachment.set(I.texture),L.depthAttachment=new nt(h,L.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=h.createRenderbuffer(h.gl.DEPTH_STENCIL,S[0],S[1]),this._stencilRef=0,L.depthAttachment.set(this._sharedDepthStencil),h.clear({stencil:0})):L.depthAttachment.set(this._sharedDepthStencil),h.extTextureFilterAnisotropic&&!h.extTextureFilterAnisotropicForceOff&&m.texParameterf(m.TEXTURE_2D,h.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h.extTextureFilterAnisotropicMax),{fb:L,tex:I,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const h in this._style._sourceCaches)if(this._style._sourceCaches[h].hasTransition())return!0;return this._style.order.some(h=>{const m=this._style._layers[h],S=m.isHidden(this.painter.transform.zoom);return m.type==="custom"?!S&&m.shouldRedrape():!S&&m.hasTransition()})}_clearLineLayersFromRenderCache(){let h=!1;for(const S of this._style._getSources())if(S instanceof dn){h=!0;break}if(!h)return;const m={};for(let S=0;S<this._style.order.length;++S){const I=this._style._layers[this._style.order[S]],L=this._style._getLayerSourceCache(I);if(L&&!m[L.id]&&!I.isHidden(this.painter.transform.zoom)&&I.type==="line"&&I.widthExpression()instanceof s.ZoomDependentExpression){m[L.id]=!0;for(const $ of this.proxyCoords){const H=this.proxyToSource[$.key][L.id];if(H)for(const Q of H)this._clearRenderCacheForTile(L.id,Q)}}}}_clearRasterLayersFromRenderCache(){let h=!1;for(const S in this._style._sourceCaches)if(this._style._sourceCaches[S]._source instanceof Qt){h=!0;break}if(!h)return;const m={};for(let S=0;S<this._style.order.length;++S){const I=this._style._layers[this._style.order[S]],L=this._style._getLayerSourceCache(I);if(!L||m[L.id]||I.isHidden(this.painter.transform.zoom)||I.type!=="raster")continue;const $=I.paint.get("raster-fade-duration");for(const H of this.proxyCoords){const Q=this.proxyToSource[H.key][L.id];if(Q)for(const ne of Q){const te=RA(L.getTile(ne),L.findLoadedParent(ne,0),L,this.painter.transform,$);(te.opacity!==1||te.mix!==0)&&this._clearRenderCacheForTile(L.id,ne)}}}}_setupDrapedRenderBatches(){const h=this._style.order,m=h.length;if(m===0)return;const S=[];let I,L=0,$=this._style._layers[h[L]];for(;!this._style.isLayerDraped($)&&$.isHidden(this.painter.transform.zoom)&&++L<m;)$=this._style._layers[h[L]];for(;L<m;++L){const H=this._style._layers[h[L]];H.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(H)?I===void 0&&(I=L):I!==void 0&&(S.push({start:I,end:L-1}),I=void 0))}I!==void 0&&S.push({start:I,end:L-1}),this._drapedRenderBatches=S}_setupRenderCache(h){const m=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,m.renderCache.length>m.renderCachePool.length){const $=Object.values(m.proxyCachedFBO);m.proxyCachedFBO={};for(let H=0;H<$.length;++H){const Q=Object.values($[H]);m.renderCachePool.push(...Q)}}return}this._clearRasterLayersFromRenderCache();const S=this.proxyCoords,I=this._tilesDirty;for(let $=S.length-1;$>=0;$--){const H=S[$];if(m.getTileByID(H.key),m.proxyCachedFBO[H.key]!==void 0){const Q=h[H.key],ne=this.proxyToSource[H.key];let te=0;for(const fe in ne){const ve=ne[fe],Te=Q[fe];if(!Te||Te.length!==ve.length||ve.some((Ie,Pe)=>Ie!==Te[Pe]||I[fe]&&I[fe].hasOwnProperty(Ie.key))){te=-1;break}++te}for(const fe in m.proxyCachedFBO[H.key])m.renderCache[m.proxyCachedFBO[H.key][fe]].dirty=te<0||te!==Object.values(Q).length}}const L=[...this._drapedRenderBatches];L.sort(($,H)=>H.end-H.start-($.end-$.start));for(const $ of L)for(const H of S){if(m.proxyCachedFBO[H.key])continue;let Q=m.renderCachePool.pop();Q===void 0&&m.renderCache.length<50&&(Q=m.renderCache.length,m.renderCache.push(this._createFBO())),Q!==void 0&&(m.proxyCachedFBO[H.key]={},m.proxyCachedFBO[H.key][$.start]=Q,m.renderCache[Q].dirty=!0)}this._tilesDirty={}}_setupStencil(h,m,S,I){if(!I||!this._sourceTilesOverlap[I.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const L=this.painter.context,$=L.gl;if(m.length<=1)return void(this._overlapStencilType=!1);let H;if(S.isTileClipped())H=m.length,this._overlapStencilMode.test={func:$.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(m[0].overscaledZ>m[m.length-1].overscaledZ))return void(this._overlapStencilType=!1);H=1,this._overlapStencilMode.test={func:$.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+H>255&&(L.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=H,this._overlapStencilMode.ref=this._stencilRef,S.isTileClipped()&&this._renderTileClippingMasks(m,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(h){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[h.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(h,m){const S=this.painter,I=this.painter.context,L=I.gl;S._tileClippingMaskIDs={},I.setColorMode(s.ColorMode.disabled),I.setDepthMode(s.DepthMode.disabled);const $=S.useProgram("clippingMask");for(const H of h){const Q=S._tileClippingMaskIDs[H.key]=--m;$.draw(I,L.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:L.ALWAYS,mask:0},Q,255,L.KEEP,L.KEEP,L.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,hp(H.projMatrix),"$clipping",S.tileExtentBuffer,S.quadTriangleIndexBuffer,S.tileExtentSegments)}}pointCoordinate(h){const m=this.painter.transform;if(h.x<0||h.x>m.width||h.y<0||h.y>m.height)return null;const S=[h.x,h.y,1,1];s.transformMat4$1(S,S,m.pixelMatrixInverse),s.scale$1(S,S,1/S[3]),S[0]/=m.worldSize,S[1]/=m.worldSize;const I=m._camera.position,L=s.mercatorZfromAltitude(1,m.center.lat),$=[I[0],I[1],I[2]/L,0],H=s.subtract([],S.slice(0,3),$);s.normalize(H,H);const Q=this.raycast($,H,this._exaggeration);return Q!==null&&Q?(s.scaleAndAdd($,$,H,Q),$[3]=$[2],$[2]*=L,$):null}drawDepth(){const h=this.painter,m=h.context,S=this.proxySourceCache,I=Math.ceil(h.width),L=Math.ceil(h.height);if(!this._depthFBO||this._depthFBO.width===I&&this._depthFBO.height===L||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const $=m.gl,H=m.createFramebuffer(I,L,!0);m.activeTexture.set($.TEXTURE0);const Q=new s.Texture(m,{width:I,height:L,data:null},$.RGBA);Q.bind($.NEAREST,$.CLAMP_TO_EDGE),H.colorAttachment.set(Q.texture);const ne=m.createRenderbuffer(m.gl.DEPTH_COMPONENT16,I,L);H.depthAttachment.set(ne),this._depthFBO=H,this._depthTexture=Q}m.bindFramebuffer.set(this._depthFBO.framebuffer),m.viewport.set([0,0,I,L]),function($,H,Q,ne){if($.transform.projection.name==="globe")return;const te=$.context,fe=te.gl;te.clear({depth:1});const ve=$.useProgram("terrainDepth"),Te=new s.DepthMode(fe.LESS,s.DepthMode.ReadWrite,$.depthRangeFor3D);for(const Ie of ne){const Pe=Q.getTile(Ie),Le=jf(Ie.projMatrix,0);H.setupElevationDraw(Pe,ve),ve.draw(te,fe.TRIANGLES,Te,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,Le,"terrain_depth",H.gridBuffer,H.gridIndexBuffer,H.gridNoSkirtSegments)}}(h,this,S,this.proxyCoords)}_setupProxiedCoordsForOrtho(h,m,S){if(h.getSource()instanceof pr)return this._setupProxiedCoordsForImageSource(h,m,S);this._findCoveringTileCache[h.id]=this._findCoveringTileCache[h.id]||{};const I=this.proxiedCoords[h.id]=[],L=this.proxyCoords;for(let H=0;H<L.length;H++){const Q=L[H],ne=this._findTileCoveringTileID(Q,h);if(ne){const te=this._createProxiedId(Q,ne,S[Q.key]&&S[Q.key][h.id]);I.push(te),this.proxyToSource[Q.key][h.id]=[te]}}let $=!1;for(let H=0;H<m.length;H++){const Q=h.getTile(m[H]);if(!Q||!Q.hasData())continue;const ne=this._findTileCoveringTileID(Q.tileID,this.proxySourceCache);if(ne&&ne.tileID.canonical.z!==Q.tileID.canonical.z){const te=this.proxyToSource[ne.tileID.key][h.id],fe=this._createProxiedId(ne.tileID,Q,S[ne.tileID.key]&&S[ne.tileID.key][h.id]);te?te.splice(te.length-1,0,fe):this.proxyToSource[ne.tileID.key][h.id]=[fe],I.push(fe),$=!0}}this._sourceTilesOverlap[h.id]=$}_setupProxiedCoordsForImageSource(h,m,S){if(!h.getSource().loaded())return;const I=this.proxiedCoords[h.id]=[],L=this.proxyCoords,$=h.getSource(),H=new s.Point($.tileID.x,$.tileID.y)._div(1<<$.tileID.z),Q=$.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce((te,fe)=>(te.min.x=Math.min(te.min.x,fe.x-H.x),te.min.y=Math.min(te.min.y,fe.y-H.y),te.max.x=Math.max(te.max.x,fe.x-H.x),te.max.y=Math.max(te.max.y,fe.y-H.y),te),{min:new s.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),ne=(te,fe)=>{const ve=te.wrap+te.canonical.x/(1<<te.canonical.z),Te=te.canonical.y/(1<<te.canonical.z),Ie=s.EXTENT/(1<<te.canonical.z),Pe=fe.wrap+fe.canonical.x/(1<<fe.canonical.z),Le=fe.canonical.y/(1<<fe.canonical.z);return ve+Ie<Pe+Q.min.x||ve>Pe+Q.max.x||Te+Ie<Le+Q.min.y||Te>Le+Q.max.y};for(let te=0;te<L.length;te++){const fe=L[te];for(let ve=0;ve<m.length;ve++){const Te=h.getTile(m[ve]);if(!Te||!Te.hasData()||ne(fe,Te.tileID))continue;const Ie=this._createProxiedId(fe,Te,S[fe.key]&&S[fe.key][h.id]),Pe=this.proxyToSource[fe.key][h.id];Pe?Pe.push(Ie):this.proxyToSource[fe.key][h.id]=[Ie],I.push(Ie)}}}_createProxiedId(h,m,S){let I=this.orthoMatrix;if(S){const L=S.find($=>$.key===m.tileID.key);if(L)return L}if(m.tileID.key!==h.key){const L=h.canonical.z-m.tileID.canonical.z;let $,H,Q;I=s.create();const ne=m.tileID.wrap-h.wrap<<h.overscaledZ;L>0?($=s.EXTENT>>L,H=$*((m.tileID.canonical.x<<L)-h.canonical.x+ne),Q=$*((m.tileID.canonical.y<<L)-h.canonical.y)):($=s.EXTENT<<-L,H=s.EXTENT*(m.tileID.canonical.x-(h.canonical.x+ne<<-L)),Q=s.EXTENT*(m.tileID.canonical.y-(h.canonical.y<<-L))),s.ortho(I,0,$,0,$,0,1),s.translate(I,I,[H,Q,0])}return new Bg(m.tileID,h.key,I)}_findTileCoveringTileID(h,m){let S=m.getTile(h);if(S&&S.hasData())return S;const I=this._findCoveringTileCache[m.id],L=I[h.key];if(S=L?m.getTileByID(L):null,S&&S.hasData()||L===null)return S;let $=S?S.tileID:h,H=$.overscaledZ;const Q=m.getSource().minzoom,ne=[];if(!L){const fe=m.getSource().maxzoom;if(h.canonical.z>=fe){const ve=h.canonical.z-fe;m.getSource().reparseOverscaled?(H=Math.max(h.canonical.z+2,m.transform.tileZoom),$=new s.OverscaledTileID(H,h.wrap,fe,h.canonical.x>>ve,h.canonical.y>>ve)):ve!==0&&(H=fe,$=new s.OverscaledTileID(H,h.wrap,fe,h.canonical.x>>ve,h.canonical.y>>ve))}$.key!==h.key&&(ne.push($.key),S=m.getTile($))}const te=fe=>{ne.forEach(ve=>{I[ve]=fe}),ne.length=0};for(H-=1;H>=Q&&(!S||!S.hasData());H--){S&&te(S.tileID.key);const fe=$.calculateScaledKey(H);if(S=m.getTileByID(fe),S&&S.hasData())break;const ve=I[fe];if(ve===null)break;ve===void 0?ne.push(fe):S=m.getTileByID(ve)}return te(S?S.tileID.key:null),S&&S.hasData()?S:null}findDEMTileFor(h){return this.enabled?this._findTileCoveringTileID(h,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(h,m){let S=this._tilesDirty[h];S||(S=this._tilesDirty[h]={}),S[m.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const h=function(m){let S=0;const I=new s.StructArrayLayout2ui4,L=131;for(let $=1;$<129;$++){for(let H=1;H<129;H++)S=$*L+H,I.emplaceBack(S,S+1),I.emplaceBack(S,S+L),I.emplaceBack(S+1,S+L),$===128&&I.emplaceBack(S+L,S+L+1);I.emplaceBack(S+1,S+1+L)}return I}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(h),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,h.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class jr{static cacheKey(h,m,S,I){let L=`${m}${I?I.cacheKey:""}`;for(const $ of S)h.usedDefines.includes($)&&(L+=`/${$}`);return L}constructor(h,m,S,I,L,$){const H=h.gl;this.program=H.createProgram();const Q=function(he){const Se=[];for(let Fe=0;Fe<he.length;Fe++){if(he[Fe]===null)continue;const ke=he[Fe].split(" ");Se.push(ke.pop())}return Se}(S.staticAttributes),ne=I?I.getBinderAttributes():[],te=Q.concat(ne);let fe=I?I.defines():[];fe=fe.concat($.map(he=>`#define ${he}`));const ve=h.isWebGL2?`#version 300 es
`:"",Te=ve+fe.concat(h.extStandardDerivatives&&ve.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Rg):Rg,Rg,Og,M_.fragmentSource,zf.fragmentSource,S.fragmentSource).join(`
`),Ie=ve+fe.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Og,M_.vertexSource,zf.vertexSource,up.vertexSource,S.vertexSource).join(`
`),Pe=H.createShader(H.FRAGMENT_SHADER);if(H.isContextLost())return void(this.failedToCreate=!0);H.shaderSource(Pe,Te),H.compileShader(Pe),H.attachShader(this.program,Pe);const Le=H.createShader(H.VERTEX_SHADER);if(H.isContextLost())this.failedToCreate=!0;else{H.shaderSource(Le,Ie),H.compileShader(Le),H.attachShader(this.program,Le),this.attributes={},this.numAttributes=te.length;for(let he=0;he<this.numAttributes;he++)te[he]&&(H.bindAttribLocation(this.program,he,te[he]),this.attributes[te[he]]=he);H.linkProgram(this.program),H.deleteShader(Le),H.deleteShader(Pe),this.fixedUniforms=L(h),this.binderUniforms=I?I.getUniforms(h):[],$.includes("TERRAIN")&&(this.terrainUniforms=(he=>({u_dem:new s.Uniform1i(he),u_dem_prev:new s.Uniform1i(he),u_dem_unpack:new s.Uniform4f(he),u_dem_tl:new s.Uniform2f(he),u_dem_scale:new s.Uniform1f(he),u_dem_tl_prev:new s.Uniform2f(he),u_dem_scale_prev:new s.Uniform1f(he),u_dem_size:new s.Uniform1f(he),u_dem_lerp:new s.Uniform1f(he),u_exaggeration:new s.Uniform1f(he),u_depth:new s.Uniform1i(he),u_depth_size_inv:new s.Uniform2f(he),u_meter_to_dem:new s.Uniform1f(he),u_label_plane_matrix_inv:new s.UniformMatrix4f(he)}))(h)),$.includes("GLOBE")&&(this.globeUniforms=(he=>({u_tile_tl_up:new s.Uniform3f(he),u_tile_tr_up:new s.Uniform3f(he),u_tile_br_up:new s.Uniform3f(he),u_tile_bl_up:new s.Uniform3f(he),u_tile_up_scale:new s.Uniform1f(he)}))(h)),$.includes("FOG")&&(this.fogUniforms=(he=>({u_fog_matrix:new s.UniformMatrix4f(he),u_fog_range:new s.Uniform2f(he),u_fog_color:new s.Uniform4f(he),u_fog_horizon_blend:new s.Uniform1f(he),u_fog_temporal_offset:new s.Uniform1f(he),u_frustum_tl:new s.Uniform3f(he),u_frustum_tr:new s.Uniform3f(he),u_frustum_br:new s.Uniform3f(he),u_frustum_bl:new s.Uniform3f(he),u_globe_pos:new s.Uniform3f(he),u_globe_radius:new s.Uniform1f(he),u_globe_transition:new s.Uniform1f(he),u_is_globe:new s.Uniform1i(he),u_viewport:new s.Uniform2f(he)}))(h))}}setTerrainUniformValues(h,m){if(!this.terrainUniforms)return;const S=this.terrainUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const I in m)S[I]&&S[I].set(this.program,I,m[I])}}setGlobeUniformValues(h,m){if(!this.globeUniforms)return;const S=this.globeUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const I in m)S[I]&&S[I].set(this.program,I,m[I])}}setFogUniformValues(h,m){if(!this.fogUniforms)return;const S=this.fogUniforms;if(!this.failedToCreate){h.program.set(this.program);for(const I in m)S[I].set(this.program,I,m[I])}}draw(h,m,S,I,L,$,H,Q,ne,te,fe,ve,Te,Ie,Pe){const Le=h.gl;if(this.failedToCreate)return;h.program.set(this.program),h.setDepthMode(S),h.setStencilMode(I),h.setColorMode(L),h.setCullFace($);for(const Se of Object.keys(this.fixedUniforms))this.fixedUniforms[Se].set(this.program,Se,H[Se]);Ie&&Ie.setUniforms(this.program,h,this.binderUniforms,ve,{zoom:Te});const he={[Le.LINES]:2,[Le.TRIANGLES]:3,[Le.LINE_STRIP]:1}[m];for(const Se of fe.get()){const Fe=Se.vaos||(Se.vaos={});(Fe[Q]||(Fe[Q]=new cp)).bind(h,this,ne,Ie?Ie.getPaintVertexBuffers():[],te,Se.vertexOffset,Pe||[]),Le.drawElements(m,Se.primitiveLength*he,Le.UNSIGNED_SHORT,Se.primitiveOffset*he*2)}}}function hu(v,h){const m=Math.pow(2,h.tileID.overscaledZ),S=h.tileSize*Math.pow(2,v.transform.tileZoom)/m,I=S*(h.tileID.canonical.x+h.tileID.wrap*m),L=S*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_tile_units_to_pixels:1/qe(h,1,v.transform.tileZoom),u_pixel_coord_upper:[I>>16,L>>16],u_pixel_coord_lower:[65535&I,65535&L]}}const R_=s.create(),BA=(v,h,m,S,I,L,$,H,Q,ne,te)=>{const fe=h.style.light,ve=fe.properties.get("position"),Te=[ve.x,ve.y,ve.z],Ie=s.create$1();fe.properties.get("anchor")==="viewport"&&(s.fromRotation(Ie,-h.transform.angle),s.transformMat3(Te,Te,Ie));const Pe=fe.properties.get("color"),Le=h.transform,he={u_matrix:v,u_lightpos:Te,u_lightintensity:fe.properties.get("intensity"),u_lightcolor:[Pe.r,Pe.g,Pe.b],u_vertical_gradient:+m,u_opacity:S,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:R_,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:I,u_edge_radius:L};return Le.projection.name==="globe"&&(he.u_tile_id=[$.canonical.x,$.canonical.y,1<<$.canonical.z],he.u_zoom_transition=Q,he.u_inv_rot_matrix=te,he.u_merc_center=ne,he.u_up_dir=Le.projection.upVector(new s.CanonicalTileID(0,0,0),ne[0]*s.EXTENT,ne[1]*s.EXTENT),he.u_height_lift=H),he},L_=(v,h,m,S,I,L,$,H,Q,ne,te,fe)=>{const ve=BA(v,h,m,S,I,L,$,Q,ne,te,fe),Te={u_height_factor:-Math.pow(2,$.overscaledZ)/H.tileSize/8};return s.extend(ve,hu(h,H),Te)},$f=v=>({u_matrix:v}),NA=(v,h,m)=>s.extend($f(v),hu(h,m)),ox=(v,h)=>({u_matrix:v,u_world:h}),sx=(v,h,m,S)=>s.extend(NA(v,h,m),{u_world:S}),D_=s.create(),Ng=(v,h,m,S,I,L)=>{const $=v.transform,H=$.projection.name==="globe";let Q;if(L.paint.get("circle-pitch-alignment")==="map")if(H){const te=s.globePixelsToTileUnits($.zoom,h.canonical)*$._pixelsPerMercatorPixel;Q=Float32Array.from([te,0,0,te])}else Q=$.calculatePixelsToTileUnitsMatrix(m);else Q=new Float32Array([$.pixelsToGLUnits[0],0,0,$.pixelsToGLUnits[1]]);const ne={u_camera_to_center_distance:$.cameraToCenterDistance,u_matrix:v.translatePosMatrix(h.projMatrix,m,L.paint.get("circle-translate"),L.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:Q,u_inv_rot_matrix:D_,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(H){ne.u_inv_rot_matrix=S,ne.u_merc_center=I,ne.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],ne.u_zoom_transition=s.globeToMercatorTransition($.zoom);const te=I[0]*s.EXTENT,fe=I[1]*s.EXTENT;ne.u_up_dir=$.projection.upVector(new s.CanonicalTileID(0,0,0),te,fe)}return ne},dp=v=>{const h=[];return v.paint.get("circle-pitch-alignment")==="map"&&h.push("PITCH_WITH_MAP"),v.paint.get("circle-pitch-scale")==="map"&&h.push("SCALE_WITH_MAP"),h},FA=(v,h,m,S)=>{const I=s.EXTENT/m.tileSize;return{u_matrix:v,u_camera_to_center_distance:h.getCameraToCenterDistance(S),u_extrude_scale:[h.pixelsToGLUnits[0]/I,h.pixelsToGLUnits[1]/I]}},bs=(v,h,m=1)=>({u_matrix:v,u_color:h,u_overlay:0,u_overlay_scale:m}),No=s.create(),B_=(v,h,m,S,I,L,$)=>{const H=v.transform,Q=H.projection.name==="globe",ne=Q?s.globePixelsToTileUnits(H.zoom,h.canonical)*H._pixelsPerMercatorPixel:qe(m,1,L),te={u_matrix:h.projMatrix,u_extrude_scale:ne,u_intensity:$,u_inv_rot_matrix:No,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(Q){te.u_inv_rot_matrix=S,te.u_merc_center=I,te.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],te.u_zoom_transition=s.globeToMercatorTransition(H.zoom);const fe=I[0]*s.EXTENT,ve=I[1]*s.EXTENT;te.u_up_dir=H.projection.upVector(new s.CanonicalTileID(0,0,0),fe,ve)}return te},ax=(v,h,m,S,I,L,$)=>{const H=v.transform,Q=H.calculatePixelsToTileUnitsMatrix(h);return{u_matrix:kA(v,h,m,S),u_pixels_to_tile_units:Q,u_device_pixel_ratio:L,u_units_to_pixels:[1/H.pixelsToGLUnits[0],1/H.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:I,u_texsize:fs(m)?h.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Xh(h,v.transform),u_alpha_discard_threshold:0,u_trim_offset:$}},pp=(v,h,m,S,I)=>{const L=v.transform;return{u_matrix:kA(v,h,m,S),u_texsize:h.imageAtlasTexture.size,u_pixels_to_tile_units:L.calculatePixelsToTileUnitsMatrix(h),u_device_pixel_ratio:I,u_image:0,u_tile_units_to_pixels:Xh(h,L),u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Xh(v,h){return 1/qe(v,1,h.tileZoom)}function kA(v,h,m,S){return v.translatePosMatrix(S||h.tileID.projMatrix,h,m.paint.get("line-translate"),m.paint.get("line-translate-anchor"))}function fs(v){const h=v.paint.get("line-dasharray").value;return h.value||h.kind!=="constant"}const gp=(v,h,m,S,I,L)=>{return{u_matrix:v,u_tl_parent:h,u_scale_parent:m,u_fade_t:S.mix,u_opacity:S.opacity*I.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:I.paint.get("raster-brightness-min"),u_brightness_high:I.paint.get("raster-brightness-max"),u_saturation_factor:(H=I.paint.get("raster-saturation"),H>0?1-1/(1.001-H):-H),u_contrast_factor:($=I.paint.get("raster-contrast"),$>0?1/(1-$):1+$),u_spin_weights:ws(I.paint.get("raster-hue-rotate")),u_perspective_transform:L};var $,H};function ws(v){v*=Math.PI/180;const h=Math.sin(v),m=Math.cos(v);return[(2*m+1)/3,(-Math.sqrt(3)*h-m+1)/3,(Math.sqrt(3)*h-m+1)/3]}const Fg=s.create(),mp=(v,h,m,S,I,L,$,H,Q,ne,te,fe,ve,Te,Ie,Pe)=>{const Le=I.transform,he={u_is_size_zoom_constant:+(v==="constant"||v==="source"),u_is_size_feature_constant:+(v==="constant"||v==="camera"),u_size_t:h?h.uSizeT:0,u_size:h?h.uSize:0,u_camera_to_center_distance:Le.cameraToCenterDistance,u_rotate_symbol:+m,u_aspect_ratio:Le.width/Le.height,u_fade_change:I.options.fadeDuration?I.symbolFadeChange:1,u_matrix:L,u_label_plane_matrix:$,u_coord_matrix:H,u_is_text:+Q,u_pitch_with_map:+S,u_texsize:ne,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Fg,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Fg,u_up_vector:[0,-1,0]};return Pe.name==="globe"&&(he.u_tile_id=[te.canonical.x,te.canonical.y,1<<te.canonical.z],he.u_zoom_transition=fe,he.u_inv_rot_matrix=Te,he.u_merc_center=ve,he.u_camera_forward=Le._camera.forward(),he.u_ecef_origin=s.globeECEFOrigin(Le.globeMatrix,te.toUnwrapped()),he.u_tile_matrix=Float32Array.from(Le.globeMatrix),he.u_up_vector=Ie),he},kg=(v,h,m,S,I,L,$,H,Q,ne,te,fe,ve,Te,Ie,Pe,Le)=>s.extend(mp(v,h,m,S,I,L,$,H,Q,ne,fe,ve,Te,Ie,Pe,Le),{u_gamma_scale:S?I.transform.cameraToCenterDistance*Math.cos(I.terrain?0:I.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+te}),Ua=(v,h,m,S,I,L,$,H,Q,ne,te,fe,ve,Te,Ie,Pe)=>s.extend(kg(v,h,m,S,I,L,$,H,!0,Q,!0,te,fe,ve,Te,Ie,Pe),{u_texsize_icon:ne,u_texture_icon:1}),zg=(v,h,m)=>({u_matrix:v,u_opacity:h,u_color:m}),zA=(v,h,m,S,I)=>s.extend(function(L,$,H){const Q=$.imageManager.getPattern(L.toString()),{width:ne,height:te}=$.imageManager.getPixelSize(),fe=Math.pow(2,H.tileID.overscaledZ),ve=H.tileSize*Math.pow(2,$.transform.tileZoom)/fe,Te=ve*(H.tileID.canonical.x+H.tileID.wrap*fe),Ie=ve*H.tileID.canonical.y;return{u_image:0,u_pattern_tl:Q.tl,u_pattern_br:Q.br,u_texsize:[ne,te],u_pattern_size:Q.displaySize,u_tile_units_to_pixels:1/qe(H,1,$.transform.tileZoom),u_pixel_coord_upper:[Te>>16,Ie>>16],u_pixel_coord_lower:[65535&Te,65535&Ie]}}(S,m,I),{u_matrix:v,u_opacity:h}),Hf={fillExtrusion:v=>({u_matrix:new s.UniformMatrix4f(v),u_lightpos:new s.Uniform3f(v),u_lightintensity:new s.Uniform1f(v),u_lightcolor:new s.Uniform3f(v),u_vertical_gradient:new s.Uniform1f(v),u_opacity:new s.Uniform1f(v),u_edge_radius:new s.Uniform1f(v),u_ao:new s.Uniform2f(v),u_tile_id:new s.Uniform3f(v),u_zoom_transition:new s.Uniform1f(v),u_inv_rot_matrix:new s.UniformMatrix4f(v),u_merc_center:new s.Uniform2f(v),u_up_dir:new s.Uniform3f(v),u_height_lift:new s.Uniform1f(v)}),fillExtrusionPattern:v=>({u_matrix:new s.UniformMatrix4f(v),u_lightpos:new s.Uniform3f(v),u_lightintensity:new s.Uniform1f(v),u_lightcolor:new s.Uniform3f(v),u_vertical_gradient:new s.Uniform1f(v),u_height_factor:new s.Uniform1f(v),u_edge_radius:new s.Uniform1f(v),u_ao:new s.Uniform2f(v),u_tile_id:new s.Uniform3f(v),u_zoom_transition:new s.Uniform1f(v),u_inv_rot_matrix:new s.UniformMatrix4f(v),u_merc_center:new s.Uniform2f(v),u_up_dir:new s.Uniform3f(v),u_height_lift:new s.Uniform1f(v),u_image:new s.Uniform1i(v),u_texsize:new s.Uniform2f(v),u_pixel_coord_upper:new s.Uniform2f(v),u_pixel_coord_lower:new s.Uniform2f(v),u_tile_units_to_pixels:new s.Uniform1f(v),u_opacity:new s.Uniform1f(v)}),fill:v=>({u_matrix:new s.UniformMatrix4f(v)}),fillPattern:v=>({u_matrix:new s.UniformMatrix4f(v),u_image:new s.Uniform1i(v),u_texsize:new s.Uniform2f(v),u_pixel_coord_upper:new s.Uniform2f(v),u_pixel_coord_lower:new s.Uniform2f(v),u_tile_units_to_pixels:new s.Uniform1f(v)}),fillOutline:v=>({u_matrix:new s.UniformMatrix4f(v),u_world:new s.Uniform2f(v)}),fillOutlinePattern:v=>({u_matrix:new s.UniformMatrix4f(v),u_world:new s.Uniform2f(v),u_image:new s.Uniform1i(v),u_texsize:new s.Uniform2f(v),u_pixel_coord_upper:new s.Uniform2f(v),u_pixel_coord_lower:new s.Uniform2f(v),u_tile_units_to_pixels:new s.Uniform1f(v)}),circle:v=>({u_camera_to_center_distance:new s.Uniform1f(v),u_extrude_scale:new s.UniformMatrix2f(v),u_device_pixel_ratio:new s.Uniform1f(v),u_matrix:new s.UniformMatrix4f(v),u_inv_rot_matrix:new s.UniformMatrix4f(v),u_merc_center:new s.Uniform2f(v),u_tile_id:new s.Uniform3f(v),u_zoom_transition:new s.Uniform1f(v),u_up_dir:new s.Uniform3f(v)}),collisionBox:v=>({u_matrix:new s.UniformMatrix4f(v),u_camera_to_center_distance:new s.Uniform1f(v),u_extrude_scale:new s.Uniform2f(v)}),collisionCircle:v=>({u_matrix:new s.UniformMatrix4f(v),u_inv_matrix:new s.UniformMatrix4f(v),u_camera_to_center_distance:new s.Uniform1f(v),u_viewport_size:new s.Uniform2f(v)}),debug:v=>({u_color:new s.UniformColor(v),u_matrix:new s.UniformMatrix4f(v),u_overlay:new s.Uniform1i(v),u_overlay_scale:new s.Uniform1f(v)}),clippingMask:v=>({u_matrix:new s.UniformMatrix4f(v)}),heatmap:v=>({u_extrude_scale:new s.Uniform1f(v),u_intensity:new s.Uniform1f(v),u_matrix:new s.UniformMatrix4f(v),u_inv_rot_matrix:new s.UniformMatrix4f(v),u_merc_center:new s.Uniform2f(v),u_tile_id:new s.Uniform3f(v),u_zoom_transition:new s.Uniform1f(v),u_up_dir:new s.Uniform3f(v)}),heatmapTexture:v=>({u_image:new s.Uniform1i(v),u_color_ramp:new s.Uniform1i(v),u_opacity:new s.Uniform1f(v)}),hillshade:v=>({u_matrix:new s.UniformMatrix4f(v),u_image:new s.Uniform1i(v),u_latrange:new s.Uniform2f(v),u_light:new s.Uniform2f(v),u_shadow:new s.UniformColor(v),u_highlight:new s.UniformColor(v),u_accent:new s.UniformColor(v)}),hillshadePrepare:v=>({u_matrix:new s.UniformMatrix4f(v),u_image:new s.Uniform1i(v),u_dimension:new s.Uniform2f(v),u_zoom:new s.Uniform1f(v),u_unpack:new s.Uniform4f(v)}),line:v=>({u_matrix:new s.UniformMatrix4f(v),u_pixels_to_tile_units:new s.UniformMatrix2f(v),u_device_pixel_ratio:new s.Uniform1f(v),u_units_to_pixels:new s.Uniform2f(v),u_dash_image:new s.Uniform1i(v),u_gradient_image:new s.Uniform1i(v),u_image_height:new s.Uniform1f(v),u_texsize:new s.Uniform2f(v),u_tile_units_to_pixels:new s.Uniform1f(v),u_alpha_discard_threshold:new s.Uniform1f(v),u_trim_offset:new s.Uniform2f(v)}),linePattern:v=>({u_matrix:new s.UniformMatrix4f(v),u_texsize:new s.Uniform2f(v),u_pixels_to_tile_units:new s.UniformMatrix2f(v),u_device_pixel_ratio:new s.Uniform1f(v),u_image:new s.Uniform1i(v),u_units_to_pixels:new s.Uniform2f(v),u_tile_units_to_pixels:new s.Uniform1f(v),u_alpha_discard_threshold:new s.Uniform1f(v)}),raster:v=>({u_matrix:new s.UniformMatrix4f(v),u_tl_parent:new s.Uniform2f(v),u_scale_parent:new s.Uniform1f(v),u_fade_t:new s.Uniform1f(v),u_opacity:new s.Uniform1f(v),u_image0:new s.Uniform1i(v),u_image1:new s.Uniform1i(v),u_brightness_low:new s.Uniform1f(v),u_brightness_high:new s.Uniform1f(v),u_saturation_factor:new s.Uniform1f(v),u_contrast_factor:new s.Uniform1f(v),u_spin_weights:new s.Uniform3f(v),u_perspective_transform:new s.Uniform2f(v)}),symbolIcon:v=>({u_is_size_zoom_constant:new s.Uniform1i(v),u_is_size_feature_constant:new s.Uniform1i(v),u_size_t:new s.Uniform1f(v),u_size:new s.Uniform1f(v),u_camera_to_center_distance:new s.Uniform1f(v),u_rotate_symbol:new s.Uniform1i(v),u_aspect_ratio:new s.Uniform1f(v),u_fade_change:new s.Uniform1f(v),u_matrix:new s.UniformMatrix4f(v),u_label_plane_matrix:new s.UniformMatrix4f(v),u_coord_matrix:new s.UniformMatrix4f(v),u_is_text:new s.Uniform1i(v),u_pitch_with_map:new s.Uniform1i(v),u_texsize:new s.Uniform2f(v),u_tile_id:new s.Uniform3f(v),u_zoom_transition:new s.Uniform1f(v),u_inv_rot_matrix:new s.UniformMatrix4f(v),u_merc_center:new s.Uniform2f(v),u_camera_forward:new s.Uniform3f(v),u_tile_matrix:new s.UniformMatrix4f(v),u_up_vector:new s.Uniform3f(v),u_ecef_origin:new s.Uniform3f(v),u_texture:new s.Uniform1i(v)}),symbolSDF:v=>({u_is_size_zoom_constant:new s.Uniform1i(v),u_is_size_feature_constant:new s.Uniform1i(v),u_size_t:new s.Uniform1f(v),u_size:new s.Uniform1f(v),u_camera_to_center_distance:new s.Uniform1f(v),u_rotate_symbol:new s.Uniform1i(v),u_aspect_ratio:new s.Uniform1f(v),u_fade_change:new s.Uniform1f(v),u_matrix:new s.UniformMatrix4f(v),u_label_plane_matrix:new s.UniformMatrix4f(v),u_coord_matrix:new s.UniformMatrix4f(v),u_is_text:new s.Uniform1i(v),u_pitch_with_map:new s.Uniform1i(v),u_texsize:new s.Uniform2f(v),u_texture:new s.Uniform1i(v),u_gamma_scale:new s.Uniform1f(v),u_device_pixel_ratio:new s.Uniform1f(v),u_tile_id:new s.Uniform3f(v),u_zoom_transition:new s.Uniform1f(v),u_inv_rot_matrix:new s.UniformMatrix4f(v),u_merc_center:new s.Uniform2f(v),u_camera_forward:new s.Uniform3f(v),u_tile_matrix:new s.UniformMatrix4f(v),u_up_vector:new s.Uniform3f(v),u_ecef_origin:new s.Uniform3f(v),u_is_halo:new s.Uniform1i(v)}),symbolTextAndIcon:v=>({u_is_size_zoom_constant:new s.Uniform1i(v),u_is_size_feature_constant:new s.Uniform1i(v),u_size_t:new s.Uniform1f(v),u_size:new s.Uniform1f(v),u_camera_to_center_distance:new s.Uniform1f(v),u_rotate_symbol:new s.Uniform1i(v),u_aspect_ratio:new s.Uniform1f(v),u_fade_change:new s.Uniform1f(v),u_matrix:new s.UniformMatrix4f(v),u_label_plane_matrix:new s.UniformMatrix4f(v),u_coord_matrix:new s.UniformMatrix4f(v),u_is_text:new s.Uniform1i(v),u_pitch_with_map:new s.Uniform1i(v),u_texsize:new s.Uniform2f(v),u_texsize_icon:new s.Uniform2f(v),u_texture:new s.Uniform1i(v),u_texture_icon:new s.Uniform1i(v),u_gamma_scale:new s.Uniform1f(v),u_device_pixel_ratio:new s.Uniform1f(v),u_is_halo:new s.Uniform1i(v)}),background:v=>({u_matrix:new s.UniformMatrix4f(v),u_opacity:new s.Uniform1f(v),u_color:new s.UniformColor(v)}),backgroundPattern:v=>({u_matrix:new s.UniformMatrix4f(v),u_opacity:new s.Uniform1f(v),u_image:new s.Uniform1i(v),u_pattern_tl:new s.Uniform2f(v),u_pattern_br:new s.Uniform2f(v),u_texsize:new s.Uniform2f(v),u_pattern_size:new s.Uniform2f(v),u_pixel_coord_upper:new s.Uniform2f(v),u_pixel_coord_lower:new s.Uniform2f(v),u_tile_units_to_pixels:new s.Uniform1f(v)}),terrainRaster:OA,terrainDepth:OA,skybox:v=>({u_matrix:new s.UniformMatrix4f(v),u_sun_direction:new s.Uniform3f(v),u_cubemap:new s.Uniform1i(v),u_opacity:new s.Uniform1f(v),u_temporal_offset:new s.Uniform1f(v)}),skyboxGradient:v=>({u_matrix:new s.UniformMatrix4f(v),u_color_ramp:new s.Uniform1i(v),u_center_direction:new s.Uniform3f(v),u_radius:new s.Uniform1f(v),u_opacity:new s.Uniform1f(v),u_temporal_offset:new s.Uniform1f(v)}),skyboxCapture:v=>({u_matrix_3f:new s.UniformMatrix3f(v),u_sun_direction:new s.Uniform3f(v),u_sun_intensity:new s.Uniform1f(v),u_color_tint_r:new s.Uniform4f(v),u_color_tint_m:new s.Uniform4f(v),u_luminance:new s.Uniform1f(v)}),globeRaster:v=>({u_proj_matrix:new s.UniformMatrix4f(v),u_globe_matrix:new s.UniformMatrix4f(v),u_normalize_matrix:new s.UniformMatrix4f(v),u_merc_matrix:new s.UniformMatrix4f(v),u_zoom_transition:new s.Uniform1f(v),u_merc_center:new s.Uniform2f(v),u_image0:new s.Uniform1i(v),u_grid_matrix:new s.UniformMatrix3f(v),u_skirt_height:new s.Uniform1f(v),u_frustum_tl:new s.Uniform3f(v),u_frustum_tr:new s.Uniform3f(v),u_frustum_br:new s.Uniform3f(v),u_frustum_bl:new s.Uniform3f(v),u_globe_pos:new s.Uniform3f(v),u_globe_radius:new s.Uniform1f(v),u_viewport:new s.Uniform2f(v)}),globeAtmosphere:v=>({u_frustum_tl:new s.Uniform3f(v),u_frustum_tr:new s.Uniform3f(v),u_frustum_br:new s.Uniform3f(v),u_frustum_bl:new s.Uniform3f(v),u_horizon:new s.Uniform1f(v),u_transition:new s.Uniform1f(v),u_fadeout_range:new s.Uniform1f(v),u_color:new s.Uniform4f(v),u_high_color:new s.Uniform4f(v),u_space_color:new s.Uniform4f(v),u_star_intensity:new s.Uniform1f(v),u_star_density:new s.Uniform1f(v),u_star_size:new s.Uniform1f(v),u_temporal_offset:new s.Uniform1f(v),u_horizon_angle:new s.Uniform1f(v),u_rotation_matrix:new s.UniformMatrix4f(v)})};let du;function jl(v,h,m,S,I,L,$){const H=v.context,Q=H.gl,ne=v.transform,te=v.useProgram("collisionBox"),fe=[];let ve=0,Te=0;for(let ke=0;ke<S.length;ke++){const Qe=S[ke],et=h.getTile(Qe),Je=et.getBucket(m);if(!Je)continue;const lt=Oe(Qe,Je,ne);let st=lt;I[0]===0&&I[1]===0||(st=v.translatePosMatrix(lt,et,I,L));const xt=$?Je.textCollisionBox:Je.iconCollisionBox,en=Je.collisionCircleArray;if(en.length>0){const mt=s.create(),Ut=st;s.mul(mt,Je.placementInvProjMatrix,ne.glCoordMatrix),s.mul(mt,mt,Je.placementViewportMatrix),fe.push({circleArray:en,circleOffset:Te,transform:Ut,invTransform:mt,projection:Je.getProjection()}),ve+=en.length/4,Te=ve}xt&&(v.terrain&&v.terrain.setupElevationDraw(et,te),te.draw(H,Q.LINES,s.DepthMode.disabled,s.StencilMode.disabled,v.colorModeForRenderPass(),s.CullFaceMode.disabled,FA(st,ne,et,Je.getProjection()),m.id,xt.layoutVertexBuffer,xt.indexBuffer,xt.segments,null,ne.zoom,null,[xt.collisionVertexBuffer,xt.collisionVertexBufferExt]))}if(!$||!fe.length)return;const Ie=v.useProgram("collisionCircle"),Pe=new s.StructArrayLayout2f1f2i16;Pe.resize(4*ve),Pe._trim();let Le=0;for(const ke of fe)for(let Qe=0;Qe<ke.circleArray.length/4;Qe++){const et=4*Qe,Je=ke.circleArray[et+0],lt=ke.circleArray[et+1],st=ke.circleArray[et+2],xt=ke.circleArray[et+3];Pe.emplace(Le++,Je,lt,st,xt,0),Pe.emplace(Le++,Je,lt,st,xt,1),Pe.emplace(Le++,Je,lt,st,xt,2),Pe.emplace(Le++,Je,lt,st,xt,3)}(!du||du.length<2*ve)&&(du=function(ke){const Qe=2*ke,et=new s.StructArrayLayout3ui6;et.resize(Qe),et._trim();for(let Je=0;Je<Qe;Je++){const lt=6*Je;et.uint16[lt+0]=4*Je+0,et.uint16[lt+1]=4*Je+1,et.uint16[lt+2]=4*Je+2,et.uint16[lt+3]=4*Je+2,et.uint16[lt+4]=4*Je+3,et.uint16[lt+5]=4*Je+0}return et}(ve));const he=H.createIndexBuffer(du,!0),Se=H.createVertexBuffer(Pe,s.collisionCircleLayout.members,!0);for(const ke of fe){const Qe={u_matrix:ke.transform,u_inv_matrix:ke.invTransform,u_camera_to_center_distance:(Fe=ne).getCameraToCenterDistance(ke.projection),u_viewport_size:[Fe.width,Fe.height]};Ie.draw(H,Q.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,v.colorModeForRenderPass(),s.CullFaceMode.disabled,Qe,m.id,Se,he,s.SegmentVector.simpleSegment(0,2*ke.circleOffset,ke.circleArray.length,ke.circleArray.length/2),null,ne.zoom)}var Fe;Se.destroy(),he.destroy()}const N_=s.create();function Ug({width:v,height:h,anchor:m,textOffset:S,textScale:I},L){const{horizontalAlign:$,verticalAlign:H}=s.getAnchorAlignment(m),Q=-($-.5)*v,ne=-(H-.5)*h,te=s.evaluateVariableOffset(m,S);return new s.Point((Q/I+te[0])*L,(ne/I+te[1])*L)}function lx(v,h,m,S,I,L,$,H,Q,ne,te){const fe=v.text.placedSymbolArray,ve=v.text.dynamicLayoutVertexArray,Te=v.icon.dynamicLayoutVertexArray,Ie={},Pe=v.getProjection(),Le=He(H,Pe,L),he=L.elevation,Se=Pe.upVectorScale(H.canonical,L.center.lat,L.worldSize).metersToTile;ve.clear();for(let Fe=0;Fe<fe.length;Fe++){const ke=fe.get(Fe),{tileAnchorX:Qe,tileAnchorY:et,numGlyphs:Je}=ke,lt=ke.hidden||!ke.crossTileID||v.allowVerticalPlacement&&!ke.placedOrientation?null:S[ke.crossTileID];if(lt){let st=0,xt=0,en=0;if(he){const an=he?he.getAtTileOffset(H,Qe,et):0,[Wn,hr,kn]=Pe.upVector(H.canonical,Qe,et);st=an*Wn*Se,xt=an*hr*Se,en=an*kn*Se}let[mt,Ut,St,Kt]=gi(ke.projectedAnchorX+st,ke.projectedAnchorY+xt,ke.projectedAnchorZ+en,m?Le:$);const vt=Nf(L.getCameraToCenterDistance(Pe),Kt);let zt=I.evaluateSizeForFeature(v.textSizeData,ne,ke)*vt/s.ONE_EM;m&&(zt*=v.tilePixelRatio/Q);const nn=Ug(lt,zt);m?({x:mt,y:Ut,z:St}=Pe.projectTilePoint(Qe+nn.x,et+nn.y,H.canonical),[mt,Ut,St]=gi(mt+st,Ut+xt,St+en,$)):(h&&nn._rotate(-L.angle),mt+=nn.x,Ut+=nn.y,St=0);const Ht=v.allowVerticalPlacement&&ke.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let an=0;an<Je;an++)s.addDynamicAttributes(ve,mt,Ut,St,Ht);te&&ke.associatedIconIndex>=0&&(Ie[ke.associatedIconIndex]={x:mt,y:Ut,z:St,angle:Ht})}else Rs(Je,ve)}if(te){Te.clear();const Fe=v.icon.placedSymbolArray;for(let ke=0;ke<Fe.length;ke++){const Qe=Fe.get(ke),{numGlyphs:et}=Qe,Je=Ie[ke];if(Qe.hidden||!Je)Rs(et,Te);else{const{x:lt,y:st,z:xt,angle:en}=Je;for(let mt=0;mt<et;mt++)s.addDynamicAttributes(Te,lt,st,xt,en)}}v.icon.dynamicLayoutVertexBuffer.updateData(Te)}v.text.dynamicLayoutVertexBuffer.updateData(ve)}function Ap(v,h,m){return m.iconsInText&&h?"symbolTextAndIcon":v?"symbolSDF":"symbolIcon"}function UA(v,h,m,S,I,L,$,H,Q,ne,te,fe){const ve=v.context,Te=ve.gl,Ie=v.transform,Pe=H==="map",Le=Q==="map",he=Pe&&m.layout.get("symbol-placement")!=="point",Se=Pe&&!Le&&!he,Fe=m.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ke=!1;const Qe=v.depthModeForSublayer(0,s.DepthMode.ReadOnly),et=[s.mercatorXfromLng(Ie.center.lng),s.mercatorYfromLat(Ie.center.lat)],Je=m.layout.get("text-variable-anchor"),lt=Ie.projection.name==="globe",st=[],xt=[0,-1,0];let en=xt;!lt&&!Ie.mercatorFromTransition||Pe||(en=function(mt){const Ut=mt._camera.getWorldToCamera(mt.worldSize,1),St=s.multiply([],Ut,mt.globeMatrix);s.invert(St,St);const Kt=[0,0,0],vt=[0,1,0,0];return s.transformMat4$1(vt,vt,St),Kt[0]=vt[0],Kt[1]=vt[1],Kt[2]=vt[2],s.normalize(Kt,Kt),Kt}(Ie));for(const mt of S){const Ut=h.getTile(mt),St=Ut.getBucket(m);if(!St||St.projection.name==="mercator"&&lt)continue;const Kt=I?St.text:St.icon;if(!Kt||St.fullyClipped||!Kt.segments.get().length)continue;const vt=Kt.programConfigurations.get(m.id),zt=I||St.sdfIcons,nn=I?St.textSizeData:St.iconSizeData,Ht=Le||Ie.pitch!==0,an=s.evaluateSizeForZoom(nn,Ie.zoom);let Wn,hr,kn,er,Fr=[0,0],Nr=null;if(I)hr=Ut.glyphAtlasTexture,kn=Te.LINEAR,Wn=Ut.glyphAtlasTexture.size,St.iconsInText&&(Fr=Ut.imageAtlasTexture.size,Nr=Ut.imageAtlasTexture,er=Ht||v.options.rotating||v.options.zooming||nn.kind==="composite"||nn.kind==="camera"?Te.LINEAR:Te.NEAREST);else{const qf=m.layout.get("icon-size").constantOr(0)!==1||St.iconsNeedLinear;hr=Ut.imageAtlasTexture,kn=zt||v.options.rotating||v.options.zooming||qf||Ht?Te.LINEAR:Te.NEAREST,Wn=Ut.imageAtlasTexture.size}const Vn=St.projection.name==="globe",fi=Vn?en:xt,bi=Vn?s.globeToMercatorTransition(Ie.zoom):0,wi=He(mt,St.getProjection(),Ie),Ei=Ie.calculatePixelsToTileUnitsMatrix(Ut),_a=pt(wi,Ut.tileID.canonical,Le,Pe,Ie,St.getProjection(),Ei),Ns=v.terrain&&Le&&he?s.invert(s.create(),_a):N_,pu=Vi(wi,Ut.tileID.canonical,Le,Pe,Ie,St.getProjection(),Ei),Wc=Je&&St.hasTextData(),io=m.layout.get("icon-text-fit")!=="none"&&Wc&&St.hasIconData();if(he){const qf=Ie.elevation,nd=qf?qf.getAtTileOffsetFunc(mt,Ie.center.lat,Ie.worldSize,St.getProjection()):null,Mp=za(wi,Ut.tileID.canonical,Le,Pe,Ie,St.getProjection(),Ei);Ve(St,wi,v,I,Mp,pu,Le,ne,nd,mt)}const Si=he||I&&Je||io,ni=v.translatePosMatrix(wi,Ut,L,$),Ho=Si?N_:_a,ja=v.translatePosMatrix(pu,Ut,L,$,!0),Yi=St.getProjection().createInversionMatrix(Ie,mt.canonical),ll=[];v.terrainRenderModeElevated()&&Le&&ll.push("PITCH_WITH_MAP_TERRAIN"),Vn&&ll.push("PROJECTION_GLOBE_VIEW"),Si&&ll.push("PROJECTED_POS_ON_VIEWPORT");const $_=zt&&m.paint.get(I?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Ip;Ip=zt?St.iconsInText?Ua(nn.kind,an,Se,Le,v,ni,Ho,ja,Wn,Fr,mt,bi,et,Yi,fi,St.getProjection()):kg(nn.kind,an,Se,Le,v,ni,Ho,ja,I,Wn,!0,mt,bi,et,Yi,fi,St.getProjection()):mp(nn.kind,an,Se,Le,v,ni,Ho,ja,I,Wn,mt,bi,et,Yi,fi,St.getProjection());const WA={program:v.useProgram(Ap(zt,I,St),vt,ll),buffers:Kt,uniformValues:Ip,atlasTexture:hr,atlasTextureIcon:Nr,atlasInterpolation:kn,atlasInterpolationIcon:er,isSDF:zt,hasHalo:$_,tile:Ut,labelPlaneMatrixInv:Ns};if(Fe&&St.canOverlap){ke=!0;const qf=Kt.segments.get();for(const nd of qf)st.push({segments:new s.SegmentVector([nd]),sortKey:nd.sortKey,state:WA})}else st.push({segments:Kt.segments,sortKey:0,state:WA})}ke&&st.sort((mt,Ut)=>mt.sortKey-Ut.sortKey);for(const mt of st){const Ut=mt.state;if(v.terrain&&v.terrain.setupElevationDraw(Ut.tile,Ut.program,{useDepthForOcclusion:!lt,labelPlaneMatrixInv:Ut.labelPlaneMatrixInv}),ve.activeTexture.set(Te.TEXTURE0),Ut.atlasTexture.bind(Ut.atlasInterpolation,Te.CLAMP_TO_EDGE),Ut.atlasTextureIcon&&(ve.activeTexture.set(Te.TEXTURE1),Ut.atlasTextureIcon&&Ut.atlasTextureIcon.bind(Ut.atlasInterpolationIcon,Te.CLAMP_TO_EDGE)),Ut.isSDF){const St=Ut.uniformValues;Ut.hasHalo&&(St.u_is_halo=1,_p(Ut.buffers,mt.segments,m,v,Ut.program,Qe,te,fe,St)),St.u_is_halo=0}_p(Ut.buffers,mt.segments,m,v,Ut.program,Qe,te,fe,Ut.uniformValues)}}function _p(v,h,m,S,I,L,$,H,Q){const ne=S.context,te=[v.dynamicLayoutVertexBuffer,v.opacityVertexBuffer,v.globeExtVertexBuffer];I.draw(ne,ne.gl.TRIANGLES,L,$,H,s.CullFaceMode.disabled,Q,m.id,v.layoutVertexBuffer,v.indexBuffer,h,m.paint,S.transform.zoom,v.programConfigurations.get(m.id),te)}function F_(v,h,m,S,I,L,$){const H=v.context.gl,Q=m.paint.get("fill-pattern"),ne=Q&&Q.constantOr(1);let te,fe,ve,Te,Ie;$?(fe=ne&&!m.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",te=H.LINES):(fe=ne?"fillPattern":"fill",te=H.TRIANGLES);for(const Pe of S){const Le=h.getTile(Pe);if(ne&&!Le.patternsLoaded())continue;const he=Le.getBucket(m);if(!he)continue;v.prepareDrawTile();const Se=he.programConfigurations.get(m.id),Fe=v.useProgram(fe,Se);ne&&(v.context.activeTexture.set(H.TEXTURE0),Le.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),Se.updatePaintBuffers());const ke=Q.constantOr(null);if(ke&&Le.imageAtlas){const et=Le.imageAtlas.patternPositions[ke.toString()];et&&Se.setConstantPatternPositions(et)}const Qe=v.translatePosMatrix(Pe.projMatrix,Le,m.paint.get("fill-translate"),m.paint.get("fill-translate-anchor"));if($){Te=he.indexBuffer2,Ie=he.segments2;const et=v.terrain&&v.terrain.renderingToTexture?v.terrain.drapeBufferSize:[H.drawingBufferWidth,H.drawingBufferHeight];ve=fe==="fillOutlinePattern"&&ne?sx(Qe,v,Le,et):ox(Qe,et)}else Te=he.indexBuffer,Ie=he.segments,ve=ne?NA(Qe,v,Le):$f(Qe);v.prepareDrawProgram(v.context,Fe,Pe.toUnwrapped()),Fe.draw(v.context,te,I,v.stencilModeForClipping(Pe),L,s.CullFaceMode.disabled,ve,m.id,he.layoutVertexBuffer,Te,Ie,m.paint,v.transform.zoom,Se)}}function Gg(v,h,m,S,I,L,$){const H=v.context,Q=H.gl,ne=v.transform,te=m.paint.get("fill-extrusion-pattern"),fe=te.constantOr(1),ve=m.paint.get("fill-extrusion-opacity"),Te=[m.paint.get("fill-extrusion-ambient-occlusion-intensity"),m.paint.get("fill-extrusion-ambient-occlusion-radius")],Ie=m.layout.get("fill-extrusion-edge-radius"),Pe=Ie>0&&!m.paint.get("fill-extrusion-rounded-roof"),Le=Pe?0:Ie,he=ne.projection.name==="globe"?s.fillExtrusionHeightLift():0,Se=ne.projection.name==="globe",Fe=Se?s.globeToMercatorTransition(ne.zoom):0,ke=[s.mercatorXfromLng(ne.center.lng),s.mercatorYfromLat(ne.center.lat)],Qe=[];Se&&Qe.push("PROJECTION_GLOBE_VIEW"),Te[0]>0&&Qe.push("FAUX_AO"),Pe&&Qe.push("ZERO_ROOF_RADIUS");for(const et of S){const Je=h.getTile(et),lt=Je.getBucket(m);if(!lt||lt.projection.name!==ne.projection.name)continue;const st=lt.programConfigurations.get(m.id),xt=v.useProgram(fe?"fillExtrusionPattern":"fillExtrusion",st,Qe);if(v.terrain){const zt=v.terrain;if(v.style.terrainSetForDrapingOnly())zt.setupElevationDraw(Je,xt,{useMeterToDem:!0});else{if(!lt.enableTerrain)continue;if(zt.setupElevationDraw(Je,xt,{useMeterToDem:!0}),k_(H,h,et,lt,m,zt),!lt.centroidVertexBuffer){const nn=xt.attributes.a_centroid_pos;nn!==void 0&&Q.vertexAttrib2f(nn,0,0)}}}fe&&(v.context.activeTexture.set(Q.TEXTURE0),Je.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),st.updatePaintBuffers());const en=te.constantOr(null);if(en&&Je.imageAtlas){const zt=Je.imageAtlas.patternPositions[en.toString()];zt&&st.setConstantPatternPositions(zt)}const mt=v.translatePosMatrix(et.projMatrix,Je,m.paint.get("fill-extrusion-translate"),m.paint.get("fill-extrusion-translate-anchor")),Ut=ne.projection.createInversionMatrix(ne,et.canonical),St=m.paint.get("fill-extrusion-vertical-gradient"),Kt=fe?L_(mt,v,St,ve,Te,Le,et,Je,he,Fe,ke,Ut):BA(mt,v,St,ve,Te,Le,et,he,Fe,ke,Ut);v.prepareDrawProgram(H,xt,et.toUnwrapped());const vt=[];v.terrain&&vt.push(lt.centroidVertexBuffer),Se&&vt.push(lt.layoutVertexExtBuffer),xt.draw(H,H.gl.TRIANGLES,I,L,$,s.CullFaceMode.backCCW,Kt,m.id,lt.layoutVertexBuffer,lt.indexBuffer,lt.segments,m.paint,v.transform.zoom,st,vt)}}function k_(v,h,m,S,I,L){const $=[he=>{let Se=he.canonical.x-1,Fe=he.wrap;return Se<0&&(Se=(1<<he.canonical.z)-1,Fe--),new s.OverscaledTileID(he.overscaledZ,Fe,he.canonical.z,Se,he.canonical.y)},he=>{let Se=he.canonical.x+1,Fe=he.wrap;return Se===1<<he.canonical.z&&(Se=0,Fe++),new s.OverscaledTileID(he.overscaledZ,Fe,he.canonical.z,Se,he.canonical.y)},he=>new s.OverscaledTileID(he.overscaledZ,he.wrap,he.canonical.z,he.canonical.x,(he.canonical.y===0?1<<he.canonical.z:he.canonical.y)-1),he=>new s.OverscaledTileID(he.overscaledZ,he.wrap,he.canonical.z,he.canonical.x,he.canonical.y===(1<<he.canonical.z)-1?0:he.canonical.y+1)],H=he=>{const Se=h.getSource().minzoom,Fe=Qe=>{const et=h.getTileByID(Qe);if(et&&et.hasData())return et.getBucket(I)},ke=[0,-1,1];for(const Qe of ke){if(he.overscaledZ+Qe<Se)continue;const et=Fe(he.calculateScaledKey(he.overscaledZ+Qe));if(et)return et}},Q=[0,0,0],ne=(he,Se)=>(Q[0]=Math.min(he.min.y,Se.min.y),Q[1]=Math.max(he.max.y,Se.max.y),Q[2]=s.EXTENT-Se.min.x>he.max.x?Se.min.x-s.EXTENT:he.max.x,Q),te=(he,Se)=>(Q[0]=Math.min(he.min.x,Se.min.x),Q[1]=Math.max(he.max.x,Se.max.x),Q[2]=s.EXTENT-Se.min.y>he.max.y?Se.min.y-s.EXTENT:he.max.y,Q),fe=[(he,Se)=>ne(he,Se),(he,Se)=>ne(Se,he),(he,Se)=>te(he,Se),(he,Se)=>te(Se,he)],ve=new s.Point(0,0);let Te,Ie,Pe;const Le=(he,Se,Fe,ke,Qe)=>{const et=[[ke?Fe:he,ke?he:Fe,0],[ke?Fe:Se,ke?Se:Fe,0]],Je=Qe<0?s.EXTENT+Qe:Qe,lt=[ke?Je:(he+Se)/2,ke?(he+Se)/2:Je,0];return Fe===0&&Qe<0||Fe!==0&&Qe>0?L.getForTilePoints(Pe,[lt],!0,Ie):et.push(lt),L.getForTilePoints(m,et,!0,Te),Math.max(et[0][2],et[1][2],lt[2])/L.exaggeration()};for(let he=0;he<4;he++){const Se=(he<2?1:5)-he,Fe=S.borders[he];if(Fe.length===0)continue;const ke=Pe=$[he](m),Qe=H(ke);if(!(Qe&&Qe instanceof s.FillExtrusionBucket&&Qe.enableTerrain)||S.borderDoneWithNeighborZ[he]===Qe.canonical.z&&Qe.borderDoneWithNeighborZ[Se]===S.canonical.z||(Ie=L.findDEMTileFor(ke),!Ie||!Ie.dem))continue;if(!Te){const st=L.findDEMTileFor(m);if(!st||!st.dem)return;Te=st}const et=Qe.borders[Se];let Je=0;const lt=Qe.borderDoneWithNeighborZ[Se]!==S.canonical.z;if(S.canonical.z===Qe.canonical.z){for(let st=0;st<Fe.length;st++){const xt=S.featuresOnBorder[Fe[st]],en=xt.borders[he];let mt;for(;Je<et.length&&(mt=Qe.featuresOnBorder[et[Je]],!(mt.borders[Se][1]>en[0]+3));)lt&&Qe.encodeCentroid(void 0,mt,!1),Je++;if(mt&&Je<et.length){const Ut=Je;let St=0;for(;!(mt.borders[Se][0]>en[1]-3)&&(St++,++Je!==et.length);)mt=Qe.featuresOnBorder[et[Je]];if(mt=Qe.featuresOnBorder[et[Ut]],xt.intersectsCount()>1||mt.intersectsCount()>1||St!==1){St!==1&&(Je=Ut),S.encodeCentroid(void 0,xt,!1),lt&&Qe.encodeCentroid(void 0,mt,!1);continue}const Kt=fe[he](xt,mt),vt=he%2?s.EXTENT-1:0;ve.x=Le(Kt[0],Math.min(s.EXTENT-1,Kt[1]),vt,he<2,Kt[2]),ve.y=0,S.encodeCentroid(ve,xt,!1),lt&&Qe.encodeCentroid(ve,mt,!1)}else S.encodeCentroid(void 0,xt,!1)}S.borderDoneWithNeighborZ[he]=Qe.canonical.z,S.needsCentroidUpdate=!0,lt&&(Qe.borderDoneWithNeighborZ[Se]=S.canonical.z,Qe.needsCentroidUpdate=!0)}else{for(const st of Fe)S.encodeCentroid(void 0,S.featuresOnBorder[st],!1);if(lt){for(const st of et)Qe.encodeCentroid(void 0,Qe.featuresOnBorder[st],!1);Qe.borderDoneWithNeighborZ[Se]=S.canonical.z,Qe.needsCentroidUpdate=!0}S.borderDoneWithNeighborZ[he]=Qe.canonical.z,S.needsCentroidUpdate=!0}}(S.needsCentroidUpdate||!S.centroidVertexBuffer&&S.centroidVertexArray.length!==0)&&S.uploadCentroid(v)}const Zh=new s.Color(1,0,0,1),ux=new s.Color(0,1,0,1),jg=new s.Color(0,0,1,1),cx=new s.Color(1,0,1,1),fx=new s.Color(0,1,1,1);function hx(v,h,m){const S=v.context,I=v.transform,L=S.gl,$=I.projection.name==="globe",H=$?["PROJECTION_GLOBE_VIEW"]:null;let Q=m.projMatrix;if($&&s.globeToMercatorTransition(I.zoom)>0){const xt=s.transitionTileAABBinECEF(m.canonical,I),en=s.globeDenormalizeECEF(xt);Q=s.multiply(new Float32Array(16),I.globeMatrix,en),s.multiply(Q,I.projMatrix,Q)}const ne=v.useProgram("debug",null,H),te=h.getTileByID(m.key);v.terrain&&v.terrain.setupElevationDraw(te,ne);const fe=s.DepthMode.disabled,ve=s.StencilMode.disabled,Te=v.colorModeForRenderPass(),Ie="$debug";S.activeTexture.set(L.TEXTURE0),v.emptyTexture.bind(L.LINEAR,L.CLAMP_TO_EDGE),$?te._makeGlobeTileDebugBuffers(v.context,I):te._makeDebugTileBoundsBuffers(v.context,I.projection);const Pe=te._tileDebugBuffer||v.debugBuffer,Le=te._tileDebugIndexBuffer||v.debugIndexBuffer,he=te._tileDebugSegments||v.debugSegments;ne.draw(S,L.LINE_STRIP,fe,ve,Te,s.CullFaceMode.disabled,bs(Q,s.Color.red),Ie,Pe,Le,he,null,null,null,[te._globeTileDebugBorderBuffer]);const Se=te.latestRawTileData,Fe=Math.floor((Se&&Se.byteLength||0)/1024),ke=h.getTile(m).tileSize,Qe=512/Math.min(ke,512)*(m.overscaledZ/I.zoom)*.5;let et=m.canonical.toString();m.overscaledZ!==m.canonical.z&&(et+=` => ${m.overscaledZ}`),et+=` ${Fe}kb`,function(xt,en){xt.initDebugOverlayCanvas();const mt=xt.debugOverlayCanvas,Ut=xt.context.gl,St=xt.debugOverlayCanvas.getContext("2d");St.clearRect(0,0,mt.width,mt.height),St.shadowColor="white",St.shadowBlur=2,St.lineWidth=1.5,St.strokeStyle="white",St.textBaseline="top",St.font="bold 36px Open Sans, sans-serif",St.fillText(en,5,5),St.strokeText(en,5,5),xt.debugOverlayTexture.update(mt),xt.debugOverlayTexture.bind(Ut.LINEAR,Ut.CLAMP_TO_EDGE)}(v,et);const Je=te._tileDebugTextBuffer||v.debugBuffer,lt=te._tileDebugTextIndexBuffer||v.quadTriangleIndexBuffer,st=te._tileDebugTextSegments||v.debugSegments;ne.draw(S,L.TRIANGLES,fe,ve,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,bs(Q,s.Color.transparent,Qe),Ie,Je,lt,st,null,null,null,[te._globeTileDebugTextBuffer])}function GA(v,h,m,S){ga(v,0,h+m/2,v.transform.width,m,S)}function yp(v,h,m,S){ga(v,h-m/2,0,m,v.transform.height,S)}function ga(v,h,m,S,I,L){const $=v.context,H=$.gl;H.enable(H.SCISSOR_TEST),H.scissor(h*s.exported.devicePixelRatio,m*s.exported.devicePixelRatio,S*s.exported.devicePixelRatio,I*s.exported.devicePixelRatio),$.clear({color:L}),H.disable(H.SCISSOR_TEST)}const jA=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:z_}=jA;function Yu(v,h,m,S){v.emplaceBack(h,m,S)}class Vg{constructor(h){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,Yu(this.vertexArray,-1,-1,1),Yu(this.vertexArray,1,-1,1),Yu(this.vertexArray,-1,1,1),Yu(this.vertexArray,1,1,1),Yu(this.vertexArray,-1,-1,-1),Yu(this.vertexArray,1,-1,-1),Yu(this.vertexArray,-1,1,-1),Yu(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=h.createVertexBuffer(this.vertexArray,z_),this.indexBuffer=h.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function sl(v,h,m,S,I,L){const $=v.gl,H=h.paint.get("sky-atmosphere-color"),Q=h.paint.get("sky-atmosphere-halo-color"),ne=h.paint.get("sky-atmosphere-sun-intensity"),te=((fe,ve,Te,Ie,Pe)=>({u_matrix_3f:fe,u_sun_direction:ve,u_sun_intensity:Te,u_color_tint_r:[Ie.r,Ie.g,Ie.b,Ie.a],u_color_tint_m:[Pe.r,Pe.g,Pe.b,Pe.a],u_luminance:5e-5}))(s.fromMat4(s.create$1(),S),I,ne,H,Q);$.framebufferTexture2D($.FRAMEBUFFER,$.COLOR_ATTACHMENT0,$.TEXTURE_CUBE_MAP_POSITIVE_X+L,h.skyboxTexture,0),m.draw(v,$.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,te,"skyboxCapture",h.skyboxGeometry.vertexBuffer,h.skyboxGeometry.indexBuffer,h.skyboxGeometry.segment)}const vp=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class xp{constructor(h){const m=new s.StructArrayLayout5f20;m.emplaceBack(-1,1,1,0,0),m.emplaceBack(1,1,1,1,0),m.emplaceBack(1,-1,1,1,1),m.emplaceBack(-1,-1,1,0,1);const S=new s.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,3,0),this.vertexBuffer=h.createVertexBuffer(m,vp.members),this.indexBuffer=h.createIndexBuffer(S),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Gc={symbol:function(v,h,m,S,I){if(v.renderPass!=="translucent")return;const L=s.StencilMode.disabled,$=v.colorModeForRenderPass();m.layout.get("text-variable-anchor")&&function(H,Q,ne,te,fe,ve,Te){const Ie=Q.transform,Pe=fe==="map",Le=ve==="map";for(const he of H){const Se=te.getTile(he),Fe=Se.getBucket(ne);if(!Fe||!Fe.text||!Fe.text.segments.get().length)continue;const ke=s.evaluateSizeForZoom(Fe.textSizeData,Ie.zoom),Qe=He(he,Fe.getProjection(),Ie),et=Ie.calculatePixelsToTileUnitsMatrix(Se),Je=pt(Qe,Se.tileID.canonical,Le,Pe,Ie,Fe.getProjection(),et),lt=ne.layout.get("icon-text-fit")!=="none"&&Fe.hasIconData();if(ke){const st=Math.pow(2,Ie.zoom-Se.tileID.overscaledZ);lx(Fe,Pe,Le,Te,s.symbolSize,Ie,Je,he,st,ke,lt)}}}(S,v,m,h,m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),I),m.paint.get("icon-opacity").constantOr(1)!==0&&UA(v,h,m,S,!1,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),m.layout.get("icon-rotation-alignment"),m.layout.get("icon-pitch-alignment"),m.layout.get("icon-keep-upright"),L,$),m.paint.get("text-opacity").constantOr(1)!==0&&UA(v,h,m,S,!0,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),m.layout.get("text-rotation-alignment"),m.layout.get("text-pitch-alignment"),m.layout.get("text-keep-upright"),L,$),h.map.showCollisionBoxes&&(jl(v,h,m,S,m.paint.get("text-translate"),m.paint.get("text-translate-anchor"),!0),jl(v,h,m,S,m.paint.get("icon-translate"),m.paint.get("icon-translate-anchor"),!1))},circle:function(v,h,m,S){if(v.renderPass!=="translucent")return;const I=m.paint.get("circle-opacity"),L=m.paint.get("circle-stroke-width"),$=m.paint.get("circle-stroke-opacity"),H=m.layout.get("circle-sort-key").constantOr(1)!==void 0;if(I.constantOr(1)===0&&(L.constantOr(1)===0||$.constantOr(1)===0))return;const Q=v.context,ne=Q.gl,te=v.transform,fe=v.depthModeForSublayer(0,s.DepthMode.ReadOnly),ve=s.StencilMode.disabled,Te=v.colorModeForRenderPass(),Ie=te.projection.name==="globe",Pe=[s.mercatorXfromLng(te.center.lng),s.mercatorYfromLat(te.center.lat)],Le=[];for(let Se=0;Se<S.length;Se++){const Fe=S[Se],ke=h.getTile(Fe),Qe=ke.getBucket(m);if(!Qe||Qe.projection.name!==te.projection.name)continue;const et=Qe.programConfigurations.get(m.id),Je=dp(m);Ie&&Je.push("PROJECTION_GLOBE_VIEW");const lt=v.useProgram("circle",et,Je),st=Qe.layoutVertexBuffer,xt=Qe.globeExtVertexBuffer,en=Qe.indexBuffer,mt=te.projection.createInversionMatrix(te,Fe.canonical),Ut={programConfiguration:et,program:lt,layoutVertexBuffer:st,globeExtVertexBuffer:xt,indexBuffer:en,uniformValues:Ng(v,Fe,ke,mt,Pe,m),tile:ke};if(H){const St=Qe.segments.get();for(const Kt of St)Le.push({segments:new s.SegmentVector([Kt]),sortKey:Kt.sortKey,state:Ut})}else Le.push({segments:Qe.segments,sortKey:0,state:Ut})}H&&Le.sort((Se,Fe)=>Se.sortKey-Fe.sortKey);const he={useDepthForOcclusion:!Ie};for(const Se of Le){const{programConfiguration:Fe,program:ke,layoutVertexBuffer:Qe,globeExtVertexBuffer:et,indexBuffer:Je,uniformValues:lt,tile:st}=Se.state,xt=Se.segments;v.terrain&&v.terrain.setupElevationDraw(st,ke,he),v.prepareDrawProgram(Q,ke,st.tileID.toUnwrapped()),ke.draw(Q,ne.TRIANGLES,fe,ve,Te,s.CullFaceMode.disabled,lt,m.id,Qe,Je,xt,m.paint,te.zoom,Fe,[et])}},heatmap:function(v,h,m,S){if(m.paint.get("heatmap-opacity")!==0)if(v.renderPass==="offscreen"){const I=v.context,L=I.gl,$=s.StencilMode.disabled,H=new s.ColorMode([L.ONE,L.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function(Te,Ie,Pe,Le){const he=Te.gl,Se=Ie.width*Le,Fe=Ie.height*Le;Te.activeTexture.set(he.TEXTURE1),Te.viewport.set([0,0,Se,Fe]);let ke=Pe.heatmapFbo;if(!ke||ke&&(ke.width!==Se||ke.height!==Fe)){ke&&ke.destroy();const Qe=he.createTexture();he.bindTexture(he.TEXTURE_2D,Qe),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_S,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_WRAP_T,he.CLAMP_TO_EDGE),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_MIN_FILTER,he.LINEAR),he.texParameteri(he.TEXTURE_2D,he.TEXTURE_MAG_FILTER,he.LINEAR),ke=Pe.heatmapFbo=Te.createFramebuffer(Se,Fe,!1),function(et,Je,lt,st,xt,en){const mt=et.gl;mt.texImage2D(mt.TEXTURE_2D,0,et.isWebGL2&&et.extRenderToTextureHalfFloat?mt.RGBA16F:mt.RGBA,xt,en,0,mt.RGBA,et.extRenderToTextureHalfFloat?et.isWebGL2?mt.HALF_FLOAT:et.extTextureHalfFloat.HALF_FLOAT_OES:mt.UNSIGNED_BYTE,null),st.colorAttachment.set(lt)}(Te,0,Qe,ke,Se,Fe)}else he.bindTexture(he.TEXTURE_2D,ke.colorAttachment.get()),Te.bindFramebuffer.set(ke.framebuffer)})(I,v,m,v.transform.projection.name==="globe"?.5:.25),I.clear({color:s.Color.transparent});const Q=v.transform,ne=Q.projection.name==="globe",te=ne?["PROJECTION_GLOBE_VIEW"]:null,fe=ne?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,ve=[s.mercatorXfromLng(Q.center.lng),s.mercatorYfromLat(Q.center.lat)];for(let Te=0;Te<S.length;Te++){const Ie=S[Te];if(h.hasRenderableParent(Ie))continue;const Pe=h.getTile(Ie),Le=Pe.getBucket(m);if(!Le||Le.projection.name!==Q.projection.name)continue;const he=Le.programConfigurations.get(m.id),Se=v.useProgram("heatmap",he,te),{zoom:Fe}=v.transform;v.terrain&&v.terrain.setupElevationDraw(Pe,Se),v.prepareDrawProgram(I,Se,Ie.toUnwrapped());const ke=Q.projection.createInversionMatrix(Q,Ie.canonical);Se.draw(I,L.TRIANGLES,s.DepthMode.disabled,$,H,fe,B_(v,Ie,Pe,ke,ve,Fe,m.paint.get("heatmap-intensity")),m.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,m.paint,v.transform.zoom,he,ne?[Le.globeExtVertexBuffer]:null)}I.viewport.set([0,0,v.width,v.height])}else v.renderPass==="translucent"&&(v.context.setColorMode(v.colorModeForRenderPass()),function(I,L){const $=I.context,H=$.gl,Q=L.heatmapFbo;if(!Q)return;$.activeTexture.set(H.TEXTURE0),H.bindTexture(H.TEXTURE_2D,Q.colorAttachment.get()),$.activeTexture.set(H.TEXTURE1);let ne=L.colorRampTexture;ne||(ne=L.colorRampTexture=new s.Texture($,L.colorRamp,H.RGBA)),ne.bind(H.LINEAR,H.CLAMP_TO_EDGE),I.useProgram("heatmapTexture").draw($,H.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,I.colorModeForRenderPass(),s.CullFaceMode.disabled,((te,fe,ve,Te)=>({u_image:0,u_color_ramp:1,u_opacity:fe.paint.get("heatmap-opacity")}))(0,L),L.id,I.viewportBuffer,I.quadTriangleIndexBuffer,I.viewportSegments,L.paint,I.transform.zoom)}(v,m))},line:function(v,h,m,S){if(v.renderPass!=="translucent")return;const I=m.paint.get("line-opacity"),L=m.paint.get("line-width");if(I.constantOr(1)===0||L.constantOr(1)===0)return;const $=v.depthModeForSublayer(0,s.DepthMode.ReadOnly),H=v.colorModeForRenderPass(),Q=v.terrain&&v.terrain.renderingToTexture?1:s.exported.devicePixelRatio,ne=m.paint.get("line-dasharray"),te=ne.constantOr(1),fe=m.layout.get("line-cap"),ve=m.paint.get("line-pattern"),Te=ve.constantOr(1),Ie=m.paint.get("line-gradient"),Pe=Te?"linePattern":"line",Le=v.context,he=Le.gl,Se=(ke=>{const Qe=[];fs(ke)&&Qe.push("RENDER_LINE_DASH"),ke.paint.get("line-gradient")&&Qe.push("RENDER_LINE_GRADIENT");const et=ke.paint.get("line-trim-offset");et[0]===0&&et[1]===0||Qe.push("RENDER_LINE_TRIM_OFFSET");const Je=ke.paint.get("line-pattern").constantOr(1),lt=ke.paint.get("line-opacity").constantOr(1)!==1;return!Je&&lt&&Qe.push("RENDER_LINE_ALPHA_DISCARD"),Qe})(m);let Fe=Se.includes("RENDER_LINE_ALPHA_DISCARD");v.terrain&&v.terrain.clipOrMaskOverlapStencilType()&&(Fe=!1);for(const ke of S){const Qe=h.getTile(ke);if(Te&&!Qe.patternsLoaded())continue;const et=Qe.getBucket(m);if(!et)continue;v.prepareDrawTile();const Je=et.programConfigurations.get(m.id),lt=v.useProgram(Pe,Je,Se),st=ve.constantOr(null);if(st&&Qe.imageAtlas){const zt=Qe.imageAtlas.patternPositions[st.toString()];zt&&Je.setConstantPatternPositions(zt)}const xt=ne.constantOr(null),en=fe.constantOr(null);if(!Te&&xt&&en&&Qe.lineAtlas){const zt=Qe.lineAtlas.getDash(xt,en);zt&&Je.setConstantPatternPositions(zt)}let[mt,Ut]=m.paint.get("line-trim-offset");(en==="round"||en==="square")&&mt!==Ut&&(mt===0&&(mt-=1),Ut===1&&(Ut+=1));const St=v.terrain?ke.projMatrix:null,Kt=Te?pp(v,Qe,m,St,Q):ax(v,Qe,m,St,et.lineClipsArray.length,Q,[mt,Ut]);if(Ie){const zt=et.gradients[m.id];let nn=zt.texture;if(m.gradientVersion!==zt.version){let Ht=256;if(m.stepInterpolant){const an=h.getSource().maxzoom,Wn=ke.canonical.z===an?Math.ceil(1<<v.transform.maxZoom-ke.canonical.z):1;Ht=s.clamp(s.nextPowerOfTwo(et.maxLineLength/s.EXTENT*1024*Wn),256,Le.maxTextureSize)}zt.gradient=s.renderColorRamp({expression:m.gradientExpression(),evaluationKey:"lineProgress",resolution:Ht,image:zt.gradient||void 0,clips:et.lineClipsArray}),zt.texture?zt.texture.update(zt.gradient):zt.texture=new s.Texture(Le,zt.gradient,he.RGBA),zt.version=m.gradientVersion,nn=zt.texture}Le.activeTexture.set(he.TEXTURE1),nn.bind(m.stepInterpolant?he.NEAREST:he.LINEAR,he.CLAMP_TO_EDGE)}te&&(Le.activeTexture.set(he.TEXTURE0),Qe.lineAtlasTexture.bind(he.LINEAR,he.REPEAT),Je.updatePaintBuffers()),Te&&(Le.activeTexture.set(he.TEXTURE0),Qe.imageAtlasTexture.bind(he.LINEAR,he.CLAMP_TO_EDGE),Je.updatePaintBuffers()),v.prepareDrawProgram(Le,lt,ke.toUnwrapped());const vt=zt=>{lt.draw(Le,he.TRIANGLES,$,zt,H,s.CullFaceMode.disabled,Kt,m.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,m.paint,v.transform.zoom,Je,[et.layoutVertexBuffer2])};if(Fe){const zt=v.stencilModeForClipping(ke).ref;zt===0&&v.terrain&&Le.clear({stencil:0});const nn={func:he.EQUAL,mask:255};Kt.u_alpha_discard_threshold=.8,vt(new s.StencilMode(nn,zt,255,he.KEEP,he.KEEP,he.INVERT)),Kt.u_alpha_discard_threshold=0,vt(new s.StencilMode(nn,zt,255,he.KEEP,he.KEEP,he.KEEP))}else vt(v.stencilModeForClipping(ke))}Fe&&(v.resetStencilClippingMasks(),v.terrain&&Le.clear({stencil:0}))},fill:function(v,h,m,S){const I=m.paint.get("fill-color"),L=m.paint.get("fill-opacity");if(L.constantOr(1)===0)return;const $=v.colorModeForRenderPass(),H=m.paint.get("fill-pattern"),Q=v.opaquePassEnabledForLayer()&&!H.constantOr(1)&&I.constantOr(s.Color.transparent).a===1&&L.constantOr(0)===1?"opaque":"translucent";if(v.renderPass===Q){const ne=v.depthModeForSublayer(1,v.renderPass==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);F_(v,h,m,S,ne,$,!1)}if(v.renderPass==="translucent"&&m.paint.get("fill-antialias")){const ne=v.depthModeForSublayer(m.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);F_(v,h,m,S,ne,$,!0)}},"fill-extrusion":function(v,h,m,S){const I=m.paint.get("fill-extrusion-opacity");if(I!==0&&v.renderPass==="translucent"){const L=new s.DepthMode(v.context.gl.LEQUAL,s.DepthMode.ReadWrite,v.depthRangeFor3D);if(I!==1||m.paint.get("fill-extrusion-pattern").constantOr(1))Gg(v,h,m,S,L,s.StencilMode.disabled,s.ColorMode.disabled),Gg(v,h,m,S,L,v.stencilModeFor3D(),v.colorModeForRenderPass()),v.resetStencilClippingMasks();else{const $=v.colorModeForRenderPass();Gg(v,h,m,S,L,s.StencilMode.disabled,$)}}},hillshade:function(v,h,m,S){if(v.renderPass!=="offscreen"&&v.renderPass!=="translucent")return;const I=v.context,L=v.depthModeForSublayer(0,s.DepthMode.ReadOnly),$=v.colorModeForRenderPass(),H=v.terrain&&v.terrain.renderingToTexture,[Q,ne]=v.renderPass!=="translucent"||H?[{},S]:v.stencilConfigForOverlap(S);for(const te of ne){const fe=h.getTile(te);if(fe.needsHillshadePrepare&&v.renderPass==="offscreen")Gf(v,fe,m,L,s.StencilMode.disabled,$);else if(v.renderPass==="translucent"){const ve=H&&v.terrain?v.terrain.stencilModeForRTTOverlap(te):Q[te.overscaledZ];MA(v,te,fe,m,L,ve,$)}}I.viewport.set([0,0,v.width,v.height]),v.resetStencilClippingMasks()},raster:function(v,h,m,S,I,L){if(v.renderPass!=="translucent"||m.paint.get("raster-opacity")===0||!S.length)return;const $=v.context,H=$.gl,Q=h.getSource(),ne=v.useProgram("raster"),te=v.colorModeForRenderPass(),fe=v.terrain&&v.terrain.renderingToTexture,[ve,Te]=Q instanceof pr||fe?[{},S]:v.stencilConfigForOverlap(S),Ie=Te[Te.length-1].overscaledZ,Pe=!v.options.moving;for(const Le of Te){const he=fe?s.DepthMode.disabled:v.depthModeForSublayer(Le.overscaledZ-Ie,m.paint.get("raster-opacity")===1?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,H.LESS),Se=Le.toUnwrapped(),Fe=h.getTile(Le);if(fe&&(!Fe||!Fe.hasData()))continue;const ke=fe?Le.projMatrix:v.transform.calculateProjMatrix(Se,Pe),Qe=v.terrain&&fe?v.terrain.stencilModeForRTTOverlap(Le):ve[Le.overscaledZ],et=L?0:m.paint.get("raster-fade-duration");Fe.registerFadeDuration(et);const Je=h.findLoadedParent(Le,0),lt=RA(Fe,Je,h,v.transform,et);let st,xt;v.terrain&&v.terrain.prepareDrawTile();const en=m.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR;$.activeTexture.set(H.TEXTURE0),Fe.texture.bind(en,H.CLAMP_TO_EDGE),$.activeTexture.set(H.TEXTURE1),Je?(Je.texture.bind(en,H.CLAMP_TO_EDGE),st=Math.pow(2,Je.tileID.overscaledZ-Fe.tileID.overscaledZ),xt=[Fe.tileID.canonical.x*st%1,Fe.tileID.canonical.y*st%1]):Fe.texture.bind(en,H.CLAMP_TO_EDGE),Fe.texture.useMipmap&&$.extTextureFilterAnisotropic&&v.transform.pitch>20&&H.texParameterf(H.TEXTURE_2D,$.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,$.extTextureFilterAnisotropicMax);const mt=gp(ke,xt||[0,0],st||1,lt,m,Q instanceof pr?Q.perspectiveTransform:[0,0]);if(v.prepareDrawProgram($,ne,Se),Q instanceof pr)Q.boundsBuffer&&Q.boundsSegments&&ne.draw($,H.TRIANGLES,he,s.StencilMode.disabled,te,s.CullFaceMode.disabled,mt,m.id,Q.boundsBuffer,v.quadTriangleIndexBuffer,Q.boundsSegments);else{const{tileBoundsBuffer:Ut,tileBoundsIndexBuffer:St,tileBoundsSegments:Kt}=v.getTileBoundsBuffers(Fe);ne.draw($,H.TRIANGLES,he,Qe,te,s.CullFaceMode.disabled,mt,m.id,Ut,St,Kt)}}v.resetStencilClippingMasks()},background:function(v,h,m,S){const I=m.paint.get("background-color"),L=m.paint.get("background-opacity");if(L===0)return;const $=v.context,H=$.gl,Q=v.transform,ne=Q.tileSize,te=m.paint.get("background-pattern");if(v.isPatternMissing(te))return;const fe=!te&&I.a===1&&L===1&&v.opaquePassEnabledForLayer()?"opaque":"translucent";if(v.renderPass!==fe)return;const ve=s.StencilMode.disabled,Te=v.depthModeForSublayer(0,fe==="opaque"?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),Ie=v.colorModeForRenderPass(),Pe=v.useProgram(te?"backgroundPattern":"background");let Le,he=S;he||(Le=v.getBackgroundTiles(),he=Object.values(Le).map(Se=>Se.tileID)),te&&($.activeTexture.set(H.TEXTURE0),v.imageManager.bind(v.context));for(const Se of he){const Fe=Se.toUnwrapped(),ke=S?Se.projMatrix:v.transform.calculateProjMatrix(Fe);v.prepareDrawTile();const Qe=h?h.getTile(Se):Le?Le[Se.key]:new s.Tile(Se,ne,Q.zoom,v),et=te?zA(ke,L,v,te,{tileID:Se,tileSize:ne}):zg(ke,L,I);v.prepareDrawProgram($,Pe,Fe);const{tileBoundsBuffer:Je,tileBoundsIndexBuffer:lt,tileBoundsSegments:st}=v.getTileBoundsBuffers(Qe);Pe.draw($,H.TRIANGLES,Te,ve,Ie,s.CullFaceMode.disabled,et,m.id,Je,lt,st)}},sky:function(v,h,m){const S=v.transform,I=S.projection.name==="mercator"||S.projection.name==="globe"?1:s.smoothstep(7,8,S.zoom),L=m.paint.get("sky-opacity")*I;if(L===0)return;const $=v.context,H=m.paint.get("sky-type"),Q=new s.DepthMode($.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),ne=v.frameCounter/1e3%1;H==="atmosphere"?v.renderPass==="offscreen"?m.needsSkyboxCapture(v)&&(function(te,fe,ve,Te){const Ie=te.context,Pe=Ie.gl;let Le=fe.skyboxFbo;if(!Le){Le=fe.skyboxFbo=Ie.createFramebuffer(32,32,!1),fe.skyboxGeometry=new Vg(Ie),fe.skyboxTexture=Ie.gl.createTexture(),Pe.bindTexture(Pe.TEXTURE_CUBE_MAP,fe.skyboxTexture),Pe.texParameteri(Pe.TEXTURE_CUBE_MAP,Pe.TEXTURE_WRAP_S,Pe.CLAMP_TO_EDGE),Pe.texParameteri(Pe.TEXTURE_CUBE_MAP,Pe.TEXTURE_WRAP_T,Pe.CLAMP_TO_EDGE),Pe.texParameteri(Pe.TEXTURE_CUBE_MAP,Pe.TEXTURE_MIN_FILTER,Pe.LINEAR),Pe.texParameteri(Pe.TEXTURE_CUBE_MAP,Pe.TEXTURE_MAG_FILTER,Pe.LINEAR);for(let ke=0;ke<6;++ke)Pe.texImage2D(Pe.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0,Pe.RGBA,32,32,0,Pe.RGBA,Pe.UNSIGNED_BYTE,null)}Ie.bindFramebuffer.set(Le.framebuffer),Ie.viewport.set([0,0,32,32]);const he=fe.getCenter(te,!0),Se=te.useProgram("skyboxCapture"),Fe=new Float64Array(16);s.identity(Fe),s.rotateY(Fe,Fe,.5*-Math.PI),sl(Ie,fe,Se,Fe,he,0),s.identity(Fe),s.rotateY(Fe,Fe,.5*Math.PI),sl(Ie,fe,Se,Fe,he,1),s.identity(Fe),s.rotateX(Fe,Fe,.5*-Math.PI),sl(Ie,fe,Se,Fe,he,2),s.identity(Fe),s.rotateX(Fe,Fe,.5*Math.PI),sl(Ie,fe,Se,Fe,he,3),s.identity(Fe),sl(Ie,fe,Se,Fe,he,4),s.identity(Fe),s.rotateY(Fe,Fe,Math.PI),sl(Ie,fe,Se,Fe,he,5),Ie.viewport.set([0,0,te.width,te.height])}(v,m),m.markSkyboxValid(v)):v.renderPass==="sky"&&function(te,fe,ve,Te,Ie){const Pe=te.context,Le=Pe.gl,he=te.transform,Se=te.useProgram("skybox");Pe.activeTexture.set(Le.TEXTURE0),Le.bindTexture(Le.TEXTURE_CUBE_MAP,fe.skyboxTexture);const Fe=((ke,Qe,et,Je,lt)=>({u_matrix:ke,u_sun_direction:Qe,u_cubemap:0,u_opacity:Je,u_temporal_offset:lt}))(he.skyboxMatrix,fe.getCenter(te,!1),0,Te,Ie);te.prepareDrawProgram(Pe,Se),Se.draw(Pe,Le.TRIANGLES,ve,s.StencilMode.disabled,te.colorModeForRenderPass(),s.CullFaceMode.backCW,Fe,"skybox",fe.skyboxGeometry.vertexBuffer,fe.skyboxGeometry.indexBuffer,fe.skyboxGeometry.segment)}(v,m,Q,L,ne):H==="gradient"&&v.renderPass==="sky"&&function(te,fe,ve,Te,Ie){const Pe=te.context,Le=Pe.gl,he=te.transform,Se=te.useProgram("skyboxGradient");fe.skyboxGeometry||(fe.skyboxGeometry=new Vg(Pe)),Pe.activeTexture.set(Le.TEXTURE0);let Fe=fe.colorRampTexture;Fe||(Fe=fe.colorRampTexture=new s.Texture(Pe,fe.colorRamp,Le.RGBA)),Fe.bind(Le.LINEAR,Le.CLAMP_TO_EDGE);const ke=((Qe,et,Je,lt,st)=>({u_matrix:Qe,u_color_ramp:0,u_center_direction:et,u_radius:s.degToRad(Je),u_opacity:lt,u_temporal_offset:st}))(he.skyboxMatrix,fe.getCenter(te,!1),fe.paint.get("sky-gradient-radius"),Te,Ie);te.prepareDrawProgram(Pe,Se),Se.draw(Pe,Le.TRIANGLES,ve,s.StencilMode.disabled,te.colorModeForRenderPass(),s.CullFaceMode.backCW,ke,"skyboxGradient",fe.skyboxGeometry.vertexBuffer,fe.skyboxGeometry.indexBuffer,fe.skyboxGeometry.segment)}(v,m,Q,L,ne)},debug:function(v,h,m){for(let S=0;S<m.length;S++)hx(v,h,m[S])},custom:function(v,h,m,S){const I=v.context,L=m.implementation;if(!v.transform.projection.unsupportedLayers||!v.transform.projection.unsupportedLayers.includes("custom")||v.terrain&&(v.terrain.renderingToTexture||v.renderPass==="offscreen")&&m.isLayerDraped()){if(v.renderPass==="offscreen"){const $=L.prerender;if($){if(v.setCustomLayerDefaults(),I.setColorMode(v.colorModeForRenderPass()),v.transform.projection.name==="globe"){const H=v.transform.pointMerc;$.call(L,I.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(v.transform.zoom),[H.x,H.y],v.transform.pixelsPerMeterRatio)}else $.call(L,I.gl,v.transform.customLayerMatrix());I.setDirty(),v.setBaseState()}}else if(v.renderPass==="translucent"){if(v.terrain&&v.terrain.renderingToTexture){const H=L.renderToTile;if(H){const Q=S[0].canonical,ne=new s.MercatorCoordinate(Q.x+S[0].wrap*(1<<Q.z),Q.y,Q.z);I.setDepthMode(s.DepthMode.disabled),I.setStencilMode(s.StencilMode.disabled),I.setColorMode(v.colorModeForRenderPass()),v.setCustomLayerDefaults(),H.call(L,I.gl,ne),I.setDirty(),v.setBaseState()}return}v.setCustomLayerDefaults(),I.setColorMode(v.colorModeForRenderPass()),I.setStencilMode(s.StencilMode.disabled);const $=L.renderingMode==="3d"?new s.DepthMode(v.context.gl.LEQUAL,s.DepthMode.ReadWrite,v.depthRangeFor3D):v.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(I.setDepthMode($),v.transform.projection.name==="globe"){const H=v.transform.pointMerc;L.render(I.gl,v.transform.customLayerMatrix(),v.transform.getProjection(),v.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(v.transform.zoom),[H.x,H.y],v.transform.pixelsPerMeterRatio)}else L.render(I.gl,v.transform.customLayerMatrix());I.setDirty(),v.setBaseState(),I.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class jc{constructor(h,m,S=!1){this.context=new sn(h,S),this.transform=m,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(h,m){const S=!!h&&!!h.terrain&&this.transform.projection.supportsTerrain;if(!(S||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new DA(this,h));const I=this._terrain;this.transform.elevation=S?I:null,I.update(h,this.transform,m)}_updateFog(h){const m=h.fog;if(!m||this.transform.projection.name==="globe"||m.getOpacity(this.transform.pitch)<1||m.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[S,I]=m.getFovAdjustedRange(this.transform._fov);if(S>I)return void(this.transform.fogCullDistSq=null);const L=S+.78*(I-S);this.transform.fogCullDistSq=L*L}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(h,m){if(this.width=h*s.exported.devicePixelRatio,this.height=m*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const S of this.style.order)this.style._layers[S].resize()}setup(){const h=this.context,m=new s.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(s.EXTENT,0),m.emplaceBack(0,s.EXTENT),m.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=h.createVertexBuffer(m,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const S=new s.StructArrayLayout2i4;S.emplaceBack(0,0),S.emplaceBack(s.EXTENT,0),S.emplaceBack(0,s.EXTENT),S.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=h.createVertexBuffer(S,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const I=new s.StructArrayLayout2i4;I.emplaceBack(-1,-1),I.emplaceBack(1,-1),I.emplaceBack(-1,1),I.emplaceBack(1,1),this.viewportBuffer=h.createVertexBuffer(I,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const L=new s.StructArrayLayout4i8;L.emplaceBack(0,0,0,0),L.emplaceBack(s.EXTENT,0,s.EXTENT,0),L.emplaceBack(0,s.EXTENT,0,s.EXTENT),L.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=h.createVertexBuffer(L,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const $=new s.StructArrayLayout3ui6;$.emplaceBack(0,1,2),$.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=h.createIndexBuffer($);const H=new s.StructArrayLayout1ui2;for(const ne of[0,1,3,2,0])H.emplaceBack(ne);this.debugIndexBuffer=h.createIndexBuffer(H),this.emptyTexture=new s.Texture(h,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),h.gl.RGBA),this.identityMat=s.create();const Q=this.context.gl;this.stencilClearMode=new s.StencilMode({func:Q.ALWAYS,mask:0},0,255,Q.ZERO,Q.ZERO,Q.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new xp(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(h){return h._makeTileBoundsBuffers(this.context,this.transform.projection),h._tileBoundsBuffer?{tileBoundsBuffer:h._tileBoundsBuffer,tileBoundsIndexBuffer:h._tileBoundsIndexBuffer,tileBoundsSegments:h._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const h=this.context,m=h.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(h,m.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,hp(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(h,m,S){if(!m||this.currentStencilSource===m.id||!h.isTileClipped()||!S||S.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let H=!1;for(const Q of S)if(this._tileClippingMaskIDs[Q.key]===void 0){H=!0;break}if(!H)return}this.currentStencilSource=m.id;const I=this.context,L=I.gl;this.nextStencilID+S.length>256&&this.clearStencil(),I.setColorMode(s.ColorMode.disabled),I.setDepthMode(s.DepthMode.disabled);const $=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const H of S){const Q=m.getTile(H),ne=this._tileClippingMaskIDs[H.key]=this.nextStencilID++,{tileBoundsBuffer:te,tileBoundsIndexBuffer:fe,tileBoundsSegments:ve}=this.getTileBoundsBuffers(Q);$.draw(I,L.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:L.ALWAYS,mask:0},ne,255,L.KEEP,L.KEEP,L.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,hp(H.projMatrix),"$clipping",te,fe,ve)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const h=this.nextStencilID++,m=this.context.gl;return new s.StencilMode({func:m.NOTEQUAL,mask:255},h,255,m.KEEP,m.KEEP,m.REPLACE)}stencilModeForClipping(h){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(h);const m=this.context.gl;return new s.StencilMode({func:m.EQUAL,mask:255},this._tileClippingMaskIDs[h.key],0,m.KEEP,m.KEEP,m.REPLACE)}stencilConfigForOverlap(h){const m=this.context.gl,S=h.sort(($,H)=>H.overscaledZ-$.overscaledZ),I=S[S.length-1].overscaledZ,L=S[0].overscaledZ-I+1;if(L>1){this.currentStencilSource=void 0,this.nextStencilID+L>256&&this.clearStencil();const $={};for(let H=0;H<L;H++)$[H+I]=new s.StencilMode({func:m.GEQUAL,mask:255},H+this.nextStencilID,255,m.KEEP,m.KEEP,m.REPLACE);return this.nextStencilID+=L,[$,S]}return[{[I]:s.StencilMode.disabled},S]}colorModeForRenderPass(){const h=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([h.CONSTANT_COLOR,h.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(h,m,S){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const I=1-((1+this.currentLayer)*this.numSublayers+h)*this.depthEpsilon;return new s.DepthMode(S||this.context.gl.LEQUAL,m,[I,I])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(h,m){this.style=h,this.options=m,this.imageManager=h.imageManager,this.glyphManager=h.glyphManager,this.symbolFadeChange=h.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const S=this.style.order,I=this.style._sourceCaches;for(const ne in I){const te=I[ne];te.used&&te.prepare(this.context)}const L={},$={},H={};for(const ne in I){const te=I[ne];L[ne]=te.getVisibleCoordinates(),$[ne]=L[ne].slice().reverse(),H[ne]=te.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let ne=0;ne<S.length;ne++)if(this.style._layers[S[ne]].is3D()){this.opaquePassCutoff=ne;break}if(this.terrain&&(this.terrain.updateTileBinding(H),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),!s.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const ne of S){const te=this.style._layers[ne],fe=h._getLayerSourceCache(te);if(!te.hasOffscreenPass()||te.isHidden(this.transform.zoom))continue;const ve=fe?$[fe.id]:void 0;(te.type==="custom"||te.isSky()||ve&&ve.length)&&this.renderLayer(this,fe,te,ve)}this.depthRangeFor3D=[0,1-(h.order.length+2)*this.numSublayers*this.depthEpsilon];const Q=this.terrain;if(Q&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&Q.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:m.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=m.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=S.length-1;this.currentLayer>=0;this.currentLayer--){const ne=this.style._layers[S[this.currentLayer]],te=h._getLayerSourceCache(ne);if(ne.isSky())continue;const fe=te?$[te.id]:void 0;this._renderTileClippingMasks(ne,te,fe),this.renderLayer(this,te,ne,fe)}if(this.style.fog&&this.transform.projection.supportsFog&&function(ne,te){const fe=ne.context,ve=fe.gl,Te=ne.transform,Ie=new s.DepthMode(ve.LEQUAL,s.DepthMode.ReadOnly,[0,1]),Pe=ne.useProgram("globeAtmosphere",null,Te.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Le=s.globeToMercatorTransition(Te.zoom),he=te.properties.get("color").toArray01(),Se=te.properties.get("high-color").toArray01(),Fe=te.properties.get("space-color").toArray01PremultipliedAlpha(),ke=s.identity$1([]);s.rotateY$1(ke,ke,-s.degToRad(Te._center.lng)),s.rotateX$1(ke,ke,s.degToRad(Te._center.lat)),s.rotateZ$1(ke,ke,Te.angle),s.rotateX$1(ke,ke,-Te._pitch);const Qe=s.fromQuat(new Float32Array(16),ke),et=s.mapValue(te.properties.get("star-intensity"),0,1,0,.25),Je=5e-4,lt=s.mapValue(te.properties.get("horizon-blend"),0,1,Je,.25),st=s.globeUseCustomAntiAliasing(ne,fe,Te)&&lt===Je?Te.worldSize/(2*Math.PI*1.025)-1:Te.globeRadius,xt=ne.frameCounter/1e3%1,en=s.length(Te.globeCenterInViewSpace),mt=Math.sqrt(Math.pow(en,2)-Math.pow(st,2)),Ut=Math.acos(mt/en),St=((vt,zt,nn,Ht,an,Wn,hr,kn,er,Fr,Nr,Vn,fi,bi)=>({u_frustum_tl:vt,u_frustum_tr:zt,u_frustum_br:nn,u_frustum_bl:Ht,u_horizon:an,u_transition:Wn,u_fadeout_range:hr,u_color:kn,u_high_color:er,u_space_color:Fr,u_star_intensity:Nr,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Vn,u_horizon_angle:fi,u_rotation_matrix:bi}))(Te.frustumCorners.TL,Te.frustumCorners.TR,Te.frustumCorners.BR,Te.frustumCorners.BL,Te.frustumCorners.horizon,Le,lt,he,Se,Fe,et,xt,Ut,Qe);ne.prepareDrawProgram(fe,Pe);const Kt=ne.atmosphereBuffer;Kt&&Pe.draw(fe,ve.TRIANGLES,Ie,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,St,"skybox",Kt.vertexBuffer,Kt.indexBuffer,Kt.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<S.length;this.currentLayer++){const ne=this.style._layers[S[this.currentLayer]],te=h._getLayerSourceCache(ne);ne.isSky()&&this.renderLayer(this,te,ne,te?$[te.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<S.length;){const ne=this.style._layers[S[this.currentLayer]],te=h._getLayerSourceCache(ne);if(ne.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(ne)){if(ne.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const fe=te?(ne.type==="symbol"?H:$)[te.id]:void 0;this._renderTileClippingMasks(ne,te,te?L[te.id]:void 0),this.renderLayer(this,te,ne,fe),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ne=null;s.values(this.style._layers).forEach(te=>{const fe=h._getLayerSourceCache(te);fe&&!te.isHidden(this.transform.zoom)&&(!ne||ne.getSource().maxzoom<fe.getSource().maxzoom)&&(ne=fe)}),ne&&this.options.showTileBoundaries&&Gc.debug(this,ne,ne.getVisibleCoordinates())}this.options.showPadding&&function(ne){const te=ne.transform.padding;GA(ne,ne.transform.height-(te.top||0),3,Zh),GA(ne,te.bottom||0,3,ux),yp(ne,te.left||0,3,jg),yp(ne,ne.transform.width-(te.right||0),3,cx);const fe=ne.transform.centerPoint;(function(ve,Te,Ie,Pe){ga(ve,Te-1,Ie-10,2,20,Pe),ga(ve,Te-10,Ie-1,20,2,Pe)})(ne,fe.x,ne.transform.height-fe.y,fx)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}renderLayer(h,m,S,I){S.isHidden(this.transform.zoom)||(S.type==="background"||S.type==="sky"||S.type==="custom"||I&&I.length)&&(this.id=S.id,this.gpuTimingStart(S),(!h.transform.projection.unsupportedLayers||!h.transform.projection.unsupportedLayers.includes(S.type)||h.terrain&&S.type==="custom")&&Gc[S.type](h,m,S,I,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(h){if(!this.options.gpuTiming)return;const m=this.context.extTimerQuery;let S=this.gpuTimers[h.id];S||(S=this.gpuTimers[h.id]={calls:0,cpuTime:0,query:m.createQueryEXT()}),S.calls++,m.beginQueryEXT(m.TIME_ELAPSED_EXT,S.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const h=this.context.extTimerQuery,m=h.createQueryEXT();this.deferredRenderGpuTimeQueries.push(m),h.beginQueryEXT(h.TIME_ELAPSED_EXT,m)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;h.endQueryEXT(h.TIME_ELAPSED_EXT)}collectGpuTimers(){const h=this.gpuTimers;return this.gpuTimers={},h}collectDeferredRenderGpuQueries(){const h=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],h}queryGpuTimers(h){const m={};for(const S in h){const I=h[S],L=this.context.extTimerQuery,$=L.getQueryObjectEXT(I.query,L.QUERY_RESULT_EXT)/1e6;L.deleteQueryEXT(I.query),m[S]=$}return m}queryGpuTimeDeferredRender(h){if(!this.options.gpuTimingDeferredRender)return 0;const m=this.context.extTimerQuery;let S=0;for(const I of h)S+=m.getQueryObjectEXT(I,m.QUERY_RESULT_EXT)/1e6,m.deleteQueryEXT(I);return S}translatePosMatrix(h,m,S,I,L){if(!S[0]&&!S[1])return h;const $=L?I==="map"?this.transform.angle:0:I==="viewport"?-this.transform.angle:0;if($){const ne=Math.sin($),te=Math.cos($);S=[S[0]*te-S[1]*ne,S[0]*ne+S[1]*te]}const H=[L?S[0]:qe(m,S[0],this.transform.zoom),L?S[1]:qe(m,S[1],this.transform.zoom),0],Q=new Float32Array(16);return s.translate(Q,h,H),Q}saveTileTexture(h){const m=this._tileTextures[h.size[0]];m?m.push(h):this._tileTextures[h.size[0]]=[h]}getTileTexture(h){const m=this._tileTextures[h];return m&&m.length>0?m.pop():null}isPatternMissing(h){return h===null||h!==void 0&&!this.imageManager.getPattern(h.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const h=this.terrain&&this.terrain.renderingToTexture,m=this.terrain&&this.terrain.exaggeration()===0,S=this.style&&this.style.fog,I=[];return this.terrainRenderModeElevated()&&I.push("TERRAIN"),this.transform.projection.name==="globe"&&I.push("GLOBE"),m&&I.push("ZERO_EXAGGERATION"),S&&!h&&S.getOpacity(this.transform.pitch)!==0&&I.push("FOG"),h&&I.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&I.push("OVERDRAW_INSPECTOR"),I}useProgram(h,m,S){this.cache=this.cache||{};const I=S||[],L=this.currentGlobalDefines().concat(I),$=jr.cacheKey(PA[h],h,L,m);return this.cache[$]||(this.cache[$]=new jr(this.context,h,PA[h],m,Hf[h],L)),this.cache[$]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const h=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(h.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(h,m,S){if(this.terrain&&this.terrain.renderingToTexture)return;const I=this.style.fog;if(I){const L=I.getOpacity(this.transform.pitch),$=((H,Q,ne,te,fe,ve,Te,Ie,Pe,Le,he)=>{const Se=H.transform,Fe=Q.properties.get("color").toArray01();Fe[3]=te;const ke=H.frameCounter/1e3%1;return{u_fog_matrix:ne?Se.calculateFogTileMatrix(ne):H.identityMat,u_fog_range:Q.getFovAdjustedRange(Se._fov),u_fog_color:Fe,u_fog_horizon_blend:Q.properties.get("horizon-blend"),u_fog_temporal_offset:ke,u_frustum_tl:fe,u_frustum_tr:ve,u_frustum_br:Te,u_frustum_bl:Ie,u_globe_pos:Pe,u_globe_radius:Le,u_viewport:he,u_globe_transition:s.globeToMercatorTransition(Se.zoom),u_is_globe:+(Se.projection.name==="globe")}})(this,I,S,L,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);m.setFogUniformValues(h,$)}}setTileLoadedFlag(h){this.tileLoaded=h}saveCanvasCopy(){const h=this.canvasCopy();h&&(this.frameCopies.push(h),this.tileLoaded=!1)}canvasCopy(){const h=this.context.gl,m=h.createTexture();return h.bindTexture(h.TEXTURE_2D,m),h.copyTexImage2D(h.TEXTURE_2D,0,h.RGBA,0,0,h.drawingBufferWidth,h.drawingBufferHeight,0),m}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const h=this.style&&this.style.fog;return!!h&&h.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const h=this._backgroundTiles,m=this._backgroundTiles={},S=this.transform.coveringTiles({tileSize:512});for(const I of S)m[I.key]=h[I.key]||new s.Tile(I,512,this.transform.tileZoom,this);return m}clearBackgroundTiles(){this._backgroundTiles={}}}class $g{constructor(h=0,m=0,S=0,I=0){if(isNaN(h)||h<0||isNaN(m)||m<0||isNaN(S)||S<0||isNaN(I)||I<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=h,this.bottom=m,this.left=S,this.right=I}interpolate(h,m,S){return m.top!=null&&h.top!=null&&(this.top=s.number(h.top,m.top,S)),m.bottom!=null&&h.bottom!=null&&(this.bottom=s.number(h.bottom,m.bottom,S)),m.left!=null&&h.left!=null&&(this.left=s.number(h.left,m.left,S)),m.right!=null&&h.right!=null&&(this.right=s.number(h.right,m.right,S)),this}getCenter(h,m){const S=s.clamp((this.left+h-this.right)/2,0,h),I=s.clamp((this.top+m-this.bottom)/2,0,m);return new s.Point(S,I)}equals(h){return this.top===h.top&&this.bottom===h.bottom&&this.left===h.left&&this.right===h.right}clone(){return new $g(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Hg(v,h){const m=s.getColumn(v,3);s.fromQuat(v,h),s.setColumn(v,3,m)}function Xr(v,h){const m=s.identity$1([]);return s.rotateZ$1(m,m,-h),s.rotateX$1(m,m,-v),m}function bp(v,h){const m=[v[0],v[1],0],S=[h[0],h[1],0];if(s.length(m)>=1e-15){const $=s.normalize([],m);s.scale$2(S,$,s.dot(S,$)),h[0]=S[0],h[1]=S[1]}const I=s.cross([],h,v);if(s.len(I)<1e-15)return null;const L=Math.atan2(-I[1],I[0]);return Xr(Math.atan2(Math.sqrt(v[0]*v[0]+v[1]*v[1]),-v[2]),L)}class U_{constructor(h,m){this.position=h,this.orientation=m}get position(){return this._position}set position(h){if(h){const m=h instanceof s.MercatorCoordinate?h:new s.MercatorCoordinate(h[0],h[1],h[2]);this._renderWorldCopies&&(m.x=s.wrap(m.x,0,1)),this._position=m}else this._position=null}lookAtPoint(h,m){if(this.orientation=null,!this.position)return;const S=this.position,I=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(h)):0,L=s.MercatorCoordinate.fromLngLat(h,I),$=[L.x-S.x,L.y-S.y,L.z-S.z];m||(m=[0,0,1]),m[2]=Math.abs(m[2]),this.orientation=bp($,m)}setPitchBearing(h,m){this.orientation=Xr(s.degToRad(h),s.degToRad(-m))}}class Wg{constructor(h,m){this._transform=s.identity([]),this.orientation=m,this.position=h}get mercatorPosition(){const h=this.position;return new s.MercatorCoordinate(h[0],h[1],h[2])}get position(){const h=s.getColumn(this._transform,3);return[h[0],h[1],h[2]]}set position(h){var m;h&&s.setColumn(this._transform,3,[(m=h)[0],m[1],m[2],1])}get orientation(){return this._orientation}set orientation(h){this._orientation=h||s.identity$1([]),h&&Hg(this._transform,this._orientation)}getPitchBearing(){const h=this.forward(),m=this.right();return{bearing:Math.atan2(-m[1],m[0]),pitch:Math.atan2(Math.sqrt(h[0]*h[0]+h[1]*h[1]),-h[2])}}setPitchBearing(h,m){this._orientation=Xr(h,m),Hg(this._transform,this._orientation)}forward(){const h=s.getColumn(this._transform,2);return[-h[0],-h[1],-h[2]]}up(){const h=s.getColumn(this._transform,1);return[-h[0],-h[1],-h[2]]}right(){const h=s.getColumn(this._transform,0);return[h[0],h[1],h[2]]}getCameraToWorld(h,m){const S=new Float64Array(16);return s.invert(S,this.getWorldToCamera(h,m)),S}getWorldToCameraPosition(h,m,S){const I=this.position;s.scale$2(I,I,-h);const L=new Float64Array(16);return s.fromScaling(L,[S,S,S]),s.translate(L,L,I),L[10]*=m,L}getWorldToCamera(h,m){const S=new Float64Array(16),I=new Float64Array(4),L=this.position;return s.conjugate(I,this._orientation),s.scale$2(L,L,-h),s.fromQuat(S,I),s.translate(S,S,L),S[1]*=-1,S[5]*=-1,S[9]*=-1,S[13]*=-1,S[8]*=m,S[9]*=m,S[10]*=m,S[11]*=m,S}getCameraToClipPerspective(h,m,S,I){const L=new Float64Array(16);return s.perspective(L,h,m,S,I),L}getDistanceToElevation(h,m=!1){const S=h===0?0:s.mercatorZfromAltitude(h,m?s.latFromMercatorY(this.position[1]):this.position[1]),I=this.forward();return(S-this.position[2])/I[2]}clone(){return new Wg([...this.position],[...this.orientation])}}function Yh(v,h){const m=qg(v.projection,v.zoom,v.width,v.height),S=function(L,$,H,Q,ne){const te=new s.LngLat(H.lng-180*Qu,H.lat),fe=new s.LngLat(H.lng+180*Qu,H.lat),ve=L.project(te.lng,te.lat),Te=L.project(fe.lng,fe.lat),Ie=-Math.atan2(Te.y-ve.y,Te.x-ve.x),Pe=s.MercatorCoordinate.fromLngLat(H);Pe.y=s.clamp(Pe.y,-1+Qu,1-Qu);const Le=Pe.toLngLat(),he=L.project(Le.lng,Le.lat),Se=s.MercatorCoordinate.fromLngLat(Le);Se.x+=Qu;const Fe=Se.toLngLat(),ke=L.project(Fe.lng,Fe.lat),Qe=wp(ke.x-he.x,ke.y-he.y,Ie),et=s.MercatorCoordinate.fromLngLat(Le);et.y+=Qu;const Je=et.toLngLat(),lt=L.project(Je.lng,Je.lat),st=wp(lt.x-he.x,lt.y-he.y,Ie),xt=Math.abs(Qe.x)/Math.abs(st.y),en=s.identity([]);s.rotateZ(en,en,-Ie*(1-(ne?0:Q)));const mt=s.identity([]);return s.scale(mt,mt,[1,1-(1-xt)*Q,1]),mt[4]=-st.x/st.y*Q,s.rotateZ(mt,mt,Ie),s.multiply(mt,en,mt),mt}(v.projection,0,v.center,m,h),I=G_(v);return s.scale(S,S,[I,I,1]),S}function G_(v){const h=v.projection,m=qg(v.projection,v.zoom,v.width,v.height),S=VA(h,v.center),I=VA(h,s.LngLat.convert(h.center));return Math.pow(2,S*m+(1-m)*I)}function qg(v,h,m,S,I=1/0){const L=v.range;if(!L)return 0;const $=Math.min(I,Math.max(m,S)),H=Math.log($/1024)/Math.LN2;return s.smoothstep(L[0]+H,L[1]+H,h)}const Qu=1/4e4;function VA(v,h){const m=s.clamp(h.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),S=new s.LngLat(h.lng-180*Qu,m),I=new s.LngLat(h.lng+180*Qu,m),L=v.project(S.lng,m),$=v.project(I.lng,m),H=s.MercatorCoordinate.fromLngLat(S),Q=s.MercatorCoordinate.fromLngLat(I),ne=$.x-L.x,te=$.y-L.y,fe=Q.x-H.x,ve=Q.y-H.y,Te=Math.sqrt((fe*fe+ve*ve)/(ne*ne+te*te));return Math.log(Te)/Math.LN2}function wp(v,h,m){const S=Math.cos(m),I=Math.sin(m);return{x:v*S-h*I,y:v*I+h*S}}class Zi{constructor(h,m,S,I,L,$,H){this.tileSize=512,this._renderWorldCopies=L===void 0||L,this._minZoom=h||0,this._maxZoom=m||22,this._minPitch=S??0,this._maxPitch=I??60,this.setProjection($),this.setMaxBounds(H),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new $g,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Wg,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const h=new Zi(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return h._elevation=this._elevation,h._centerAltitude=this._centerAltitude,h._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,h.tileSize=this.tileSize,h.mercatorFromTransition=this.mercatorFromTransition,h.width=this.width,h.height=this.height,h.cameraElevationReference=this.cameraElevationReference,h._center=this._center,h._setZoom(this.zoom),h._seaLevelZoom=this._seaLevelZoom,h.angle=this.angle,h._fov=this._fov,h._pitch=this._pitch,h._nearZ=this._nearZ,h._farZ=this._farZ,h._averageElevation=this._averageElevation,h._unmodified=this._unmodified,h._edgeInsets=this._edgeInsets.clone(),h._camera=this._camera.clone(),h._calcMatrices(),h.freezeTileCoverage=this.freezeTileCoverage,h.frustumCorners=this.frustumCorners,h}get elevation(){return this._elevation}set elevation(h){this._elevation!==h&&(this._elevation=h,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(h,m=!1){const S=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||S)&&this._updateCameraOnTerrain(),(h||S)&&this._constrainCamera(m),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(h){this.projectionOptions=h||{name:"mercator"};const m=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const S=!u(m,this.getProjection());return S&&this._calcMatrices(),this.mercatorFromTransition=!1,S}setMercatorFromTransition(){const h=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const m=h!==this.projection.name;return m&&this._calcMatrices(),m}get minZoom(){return this._minZoom}set minZoom(h){this._minZoom!==h&&(this._minZoom=h,this.zoom=Math.max(this.zoom,h))}get maxZoom(){return this._maxZoom}set maxZoom(h){this._maxZoom!==h&&(this._maxZoom=h,this.zoom=Math.min(this.zoom,h))}get minPitch(){return this._minPitch}set minPitch(h){this._minPitch!==h&&(this._minPitch=h,this.pitch=Math.max(this.pitch,h))}get maxPitch(){return this._maxPitch}set maxPitch(h){this._maxPitch!==h&&(this._maxPitch=h,this.pitch=Math.min(this.pitch,h))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(h){h===void 0?h=!0:h===null&&(h=!1),this._renderWorldCopies=h}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get cameraWorldSize(){const h=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(h))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.Point(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(h){this.rotation=h}get rotation(){return-this.angle/Math.PI*180}set rotation(h){const m=-h*Math.PI/180;var S;this.angle!==m&&(this._unmodified=!1,this.angle=m,this._calcMatrices(),this.rotationMatrix=(S=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(S[1]=0,S[2]=0),S[0]=1,S[3]=1,S),function(I,L,$){var H=L[0],Q=L[1],ne=L[2],te=L[3],fe=Math.sin($),ve=Math.cos($);I[0]=H*ve+ne*fe,I[1]=Q*ve+te*fe,I[2]=H*-fe+ne*ve,I[3]=Q*-fe+te*ve}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(h){const m=s.clamp(h,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==m&&(this._unmodified=!1,this._pitch=m,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const h=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/h)}set fov(h){h=Math.max(.01,Math.min(60,h)),this._fov!==h&&(this._unmodified=!1,this._fov=s.degToRad(h),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(h){this._averageElevation=h,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(h){const m=Math.min(Math.max(h,this.minZoom),this.maxZoom);this._zoom!==m&&(this._unmodified=!1,this._setZoom(m),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(h){this._zoom=h,this.scale=this.zoomScale(h),this.tileZoom=Math.floor(h),this.zoomFraction=h-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const h=this._elevation;this._centerAltitude=h.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=h.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const h=this._elevation,m=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],S=this.horizonLineFromTop();let I=0,L=0;for(let $=0;$<m.length;$++){const H=new s.Point(m[$][0]*this.width,S+m[$][1]*(this.height-S)),Q=h.pointCoordinate(H);if(!Q)continue;const ne=1/Math.hypot(Q[0]-this._camera.position[0],Q[1]-this._camera.position[1]);I+=Q[3]*ne,L+=ne}return L===0?NaN:I/L}get center(){return this._center}set center(h){h.lat===this._center.lat&&h.lng===this._center.lng||(this._unmodified=!1,this._center=h,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const h=this._seaLevelZoom,m=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),S=this.pixelsPerMeter/this.worldSize*m,I=this._mercatorZfromZoom(h),L=this._mercatorZfromZoom(this._maxZoom),$=Math.max(I-S,L);this._setZoom(this._zoomFromMercatorZ($))}get padding(){return this._edgeInsets.toJSON()}set padding(h){this._edgeInsets.equals(h)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,h,1),this._calcMatrices())}computeZoomRelativeTo(h){const m=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,h.toAltitude()));let S;S=h.z<this._camera.position[2]?[m.x,m.y,m.z]:[h.x,h.y,h.z];const I=s.length(s.sub([],this._camera.position,S));return s.clamp(this._zoomFromMercatorZ(I),this._minZoom,this._maxZoom)}setFreeCameraOptions(h){if(!this.height||!h.position&&!h.orientation)return;this._updateCameraState();let m=!1;if(h.orientation&&!s.exactEquals(h.orientation,this._camera.orientation)&&(m=this._setCameraOrientation(h.orientation)),h.position){const S=[h.position.x,h.position.y,h.position.z];s.exactEquals$1(S,this._camera.position)||(this._setCameraPosition(S),m=!0)}m&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const h=this._camera.position,m=new U_;return m.position=new s.MercatorCoordinate(h[0],h[1],h[2]),m.orientation=this._camera.orientation,m._elevation=this.elevation,m._renderWorldCopies=this.renderWorldCopies,m}_setCameraOrientation(h){if(!s.length$1(h))return!1;s.normalize$1(h,h);const m=s.transformQuat([],[0,0,-1],h),S=s.transformQuat([],[0,-1,0],h);if(S[2]<0)return!1;const I=bp(m,S);return!!I&&(this._camera.orientation=I,!0)}_setCameraPosition(h){const m=this.zoomScale(this.minZoom)*this.tileSize,S=this.zoomScale(this.maxZoom)*this.tileSize,I=this.cameraToCenterDistance;h[2]=s.clamp(h[2],I/S,I/m),this._camera.position=h}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(h){return this._edgeInsets.equals(h)}interpolatePadding(h,m,S){this._unmodified=!1,this._edgeInsets.interpolate(h,m,S),this._constrain(),this._calcMatrices()}coveringZoomLevel(h){const m=(h.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/h.tileSize));return Math.max(0,m)}getVisibleUnwrappedCoordinates(h){const m=[new s.UnwrappedTileID(0,h)];if(this.renderWorldCopies){const S=this.pointCoordinate(new s.Point(0,0)),I=this.pointCoordinate(new s.Point(this.width,0)),L=this.pointCoordinate(new s.Point(this.width,this.height)),$=this.pointCoordinate(new s.Point(0,this.height)),H=Math.floor(Math.min(S.x,I.x,L.x,$.x)),Q=Math.floor(Math.max(S.x,I.x,L.x,$.x)),ne=1;for(let te=H-ne;te<=Q+ne;te++)te!==0&&m.push(new s.UnwrappedTileID(te,h))}return m}coveringTiles(h){let m=this.coveringZoomLevel(h);const S=m,I=this.elevation&&!h.isTerrainDEM,L=this.projection.name==="mercator";if(h.minzoom!==void 0&&m<h.minzoom)return[];h.maxzoom!==void 0&&m>h.maxzoom&&(m=h.maxzoom);const $=this.locationCoordinate(this.center),H=this.center.lat,Q=1<<m,ne=[Q*$.x,Q*$.y,0],te=this.projection.name==="globe",fe=!te,ve=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,m,fe),Te=te?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Ie=Q*s.mercatorZfromAltitude(1,this.center.lat),Pe=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),Le=[Q*Te.x,Q*Te.y,Pe*(fe?1:Ie)],he=this.cameraToCenterDistance/h.tileSize*(h.roundZoom?1:.502),Se=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?m:0,Fe=h.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ke=h.isTerrainDEM?-Fe:this._elevation?this._elevation.getMinElevationBelowMSL():0,Qe=this.projection.isReprojectedInTileSpace?G_(this):1,et=vt=>{const nn=new s.MercatorCoordinate(vt.x+25e-6,vt.y,vt.z),Ht=new s.MercatorCoordinate(vt.x,vt.y+25e-6,vt.z),an=vt.toLngLat(),Wn=nn.toLngLat(),hr=Ht.toLngLat(),kn=this.locationCoordinate(an),er=this.locationCoordinate(Wn),Fr=this.locationCoordinate(hr),Nr=Math.hypot(er.x-kn.x,er.y-kn.y),Vn=Math.hypot(Fr.x-kn.x,Fr.y-kn.y);return Math.sqrt(Nr*Vn)*Qe/25e-6},Je=vt=>{const zt=Fe,nn=ke;return{aabb:s.tileAABB(this,Q,0,0,0,vt,nn,zt,this.projection),zoom:0,x:0,y:0,minZ:nn,maxZ:zt,wrap:vt,fullyVisible:!1}},lt=[];let st=[];const xt=m,en=h.reparseOverscaled?S:m,mt=vt=>vt*vt,Ut=mt((Pe-this._centerAltitude)*Ie),St=vt=>{if(!this._elevation||!vt.tileID||!L)return;const zt=this._elevation.getMinMaxForTile(vt.tileID),nn=vt.aabb;zt?(nn.min[2]=zt.min,nn.max[2]=zt.max,nn.center[2]=(nn.min[2]+nn.max[2])/2):(vt.shouldSplit=Kt(vt),vt.shouldSplit||(nn.min[2]=nn.max[2]=nn.center[2]=this._centerAltitude))},Kt=vt=>{if(vt.zoom<Se)return!0;if(vt.zoom===xt)return!1;if(vt.shouldSplit!=null)return vt.shouldSplit;const zt=vt.aabb.distanceX(Le),nn=vt.aabb.distanceY(Le);let Ht=Ut,an=1;if(te){Ht=mt(vt.aabb.distanceZ(Le));const kn=Math.pow(2,vt.zoom),er=s.latFromMercatorY((vt.y+1)/kn),Fr=s.latFromMercatorY(vt.y/kn),Nr=Math.min(Math.max(H,er),Fr),Vn=s.circumferenceAtLatitude(Nr)/s.circumferenceAtLatitude(H);if(an=Nr===H?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Vn/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&vt.zoom===xt-1&&Vn>=.9)return!0}else if(I&&(Ht=mt(vt.aabb.distanceZ(Le)*Ie)),this.projection.isReprojectedInTileSpace&&S<=5){const kn=Math.pow(2,vt.zoom),er=et(new s.MercatorCoordinate((vt.x+.5)/kn,(vt.y+.5)/kn));an=er>.85?1:er}const Wn=zt*zt+nn*nn+Ht,hr=mt((1<<xt-vt.zoom)*he*an*((kn,er)=>{if(er*mt(.707)<kn)return 1;const Fr=Math.sqrt(er/kn);return Fr/(1.4144271570014144+(Math.pow(1.1,Fr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Ht,Ut),Wn));return Wn<hr};if(this.renderWorldCopies)for(let vt=1;vt<=3;vt++)lt.push(Je(-vt)),lt.push(Je(vt));for(lt.push(Je(0));lt.length>0;){const vt=lt.pop(),zt=vt.x,nn=vt.y;let Ht=vt.fullyVisible;if(!Ht){const an=vt.aabb.intersects(ve);if(an===0)continue;Ht=an===2}if(vt.zoom!==xt&&Kt(vt))for(let an=0;an<4;an++){const Wn=(zt<<1)+an%2,hr=(nn<<1)+(an>>1),kn={aabb:L?vt.aabb.quadrant(an):s.tileAABB(this,Q,vt.zoom+1,Wn,hr,vt.wrap,vt.minZ,vt.maxZ,this.projection),zoom:vt.zoom+1,x:Wn,y:hr,wrap:vt.wrap,fullyVisible:Ht,tileID:void 0,shouldSplit:void 0,minZ:vt.minZ,maxZ:vt.maxZ};I&&!te&&(kn.tileID=new s.OverscaledTileID(vt.zoom+1===xt?en:vt.zoom+1,vt.wrap,vt.zoom+1,Wn,hr),St(kn)),lt.push(kn)}else{const an=vt.zoom===xt?en:vt.zoom;if(h.minzoom&&h.minzoom>an)continue;const Wn=ne[0]-(.5+zt+(vt.wrap<<vt.zoom))*(1<<m-vt.zoom),hr=ne[1]-.5-nn,kn=vt.tileID?vt.tileID:new s.OverscaledTileID(an,vt.wrap,vt.zoom,zt,nn);st.push({tileID:kn,distanceSq:Wn*Wn+hr*hr})}}if(this.fogCullDistSq){const vt=this.fogCullDistSq,zt=this.horizonLineFromTop();st=st.filter(nn=>{const Ht=[0,0,0,1],an=[s.EXTENT,s.EXTENT,0,1],Wn=this.calculateFogTileMatrix(nn.tileID.toUnwrapped());s.transformMat4$1(Ht,Ht,Wn),s.transformMat4$1(an,an,Wn);const hr=s.getAABBPointSquareDist(Ht,an);if(hr===0)return!0;let kn=!1;const er=this._elevation;if(er&&hr>vt&&zt!==0){const Fr=this.calculateProjMatrix(nn.tileID.toUnwrapped());let Nr;h.isTerrainDEM||(Nr=er.getMinMaxForTile(nn.tileID)),Nr||(Nr={min:ke,max:Fe});const Vn=s.furthestTileCorner(this.rotation),fi=[Vn[0]*s.EXTENT,Vn[1]*s.EXTENT,Nr.max];s.transformMat4(fi,fi,Fr),kn=(1-fi[1])*this.height*.5<zt}return hr<vt||kn})}return st.sort((vt,zt)=>vt.distanceSq-zt.distanceSq).map(vt=>vt.tileID)}resize(h,m){this.width=h,this.height=m,this.pixelsToGLUnits=[2/h,-2/m],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(h){return Math.pow(2,h)}scaleZoom(h){return Math.log(h)/Math.LN2}project(h){const m=s.clamp(h.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),S=this.projection.project(h.lng,m);return new s.Point(S.x*this.worldSize,S.y*this.worldSize)}unproject(h){return this.projection.unproject(h.x/this.worldSize,h.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(h,m){let S,I;const L=this.centerPoint;if(this.projection.name==="globe"){const H=this.worldSize;S=(m.x-L.x)/H,I=(m.y-L.y)/H}else{const H=this.pointCoordinate(m),Q=this.pointCoordinate(L);S=H.x-Q.x,I=H.y-Q.y}const $=this.locationCoordinate(h);this.setLocation(new s.MercatorCoordinate($.x-S,$.y-I))}setLocation(h){this.center=this.coordinateLocation(h),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(h){return this.projection.locationPoint(this,h)}locationPoint3D(h){return this.projection.locationPoint(this,h,!0)}pointLocation(h){return this.coordinateLocation(this.pointCoordinate(h))}pointLocation3D(h){return this.coordinateLocation(this.pointCoordinate3D(h))}locationCoordinate(h,m){const S=m?s.mercatorZfromAltitude(m,h.lat):void 0,I=this.projection.project(h.lng,h.lat);return new s.MercatorCoordinate(I.x,I.y,S)}coordinateLocation(h){return this.projection.unproject(h.x,h.y)}pointRayIntersection(h,m){const S=m??this._centerAltitude,I=[h.x,h.y,0,1],L=[h.x,h.y,1,1];s.transformMat4$1(I,I,this.pixelMatrixInverse),s.transformMat4$1(L,L,this.pixelMatrixInverse);const $=L[3];s.scale$1(I,I,1/I[3]),s.scale$1(L,L,1/$);const H=I[2],Q=L[2];return{p0:I,p1:L,t:H===Q?0:(S-H)/(Q-H)}}screenPointToMercatorRay(h){const m=[h.x,h.y,0,1],S=[h.x,h.y,1,1];return s.transformMat4$1(m,m,this.pixelMatrixInverse),s.transformMat4$1(S,S,this.pixelMatrixInverse),s.scale$1(m,m,1/m[3]),s.scale$1(S,S,1/S[3]),m[2]=s.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,S[2]=s.mercatorZfromAltitude(S[2],this._center.lat)*this.worldSize,s.scale$1(m,m,1/this.worldSize),s.scale$1(S,S,1/this.worldSize),new s.Ray([m[0],m[1],m[2]],s.normalize([],s.sub([],S,m)))}rayIntersectionCoordinate(h){const{p0:m,p1:S,t:I}=h,L=s.mercatorZfromAltitude(m[2],this._center.lat),$=s.mercatorZfromAltitude(S[2],this._center.lat);return new s.MercatorCoordinate(s.number(m[0],S[0],I)/this.worldSize,s.number(m[1],S[1],I)/this.worldSize,s.number(L,$,I))}pointCoordinate(h,m=this._centerAltitude){return this.projection.pointCoordinate(this,h.x,h.y,m)}pointCoordinate3D(h){if(!this.elevation)return this.pointCoordinate(h);let m=this.projection.pointCoordinate3D(this,h.x,h.y);if(m)return new s.MercatorCoordinate(m[0],m[1],m[2]);let S=0,I=this.horizonLineFromTop();if(h.y>I)return this.pointCoordinate(h);const L=.02*I,$=h.clone();for(let H=0;H<10&&I-S>L;H++){$.y=s.number(S,I,.66);const Q=this.projection.pointCoordinate3D(this,$.x,$.y);Q?(I=$.y,m=Q):S=$.y}return m?new s.MercatorCoordinate(m[0],m[1],m[2]):this.pointCoordinate(h)}isPointAboveHorizon(h){return this.projection.isPointAboveHorizon(this,h)}isPointOnSurface(h){if(h.y<0||h.y>this.height||h.x<0||h.x>this.width)return!1;if(this.elevation||this.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(h);const m=this.pointCoordinate(h);return m.y>=0&&m.y<=1}_coordinatePoint(h,m){const S=m&&this.elevation?this.elevation.getAtPointOrZero(h,this._centerAltitude):this._centerAltitude,I=[h.x*this.worldSize,h.y*this.worldSize,S+h.toAltitude(),1];return s.transformMat4$1(I,I,this.pixelMatrix),I[3]>0?new s.Point(I[0]/I[3],I[1]/I[3]):new s.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:h,left:m}=this._edgeInsets,S=this.height-this._edgeInsets.bottom,I=this.width-this._edgeInsets.right,L=this.pointLocation3D(new s.Point(m,h)),$=this.pointLocation3D(new s.Point(I,h)),H=this.pointLocation3D(new s.Point(I,S)),Q=this.pointLocation3D(new s.Point(m,S));let ne=Math.min(L.lng,$.lng,H.lng,Q.lng),te=Math.max(L.lng,$.lng,H.lng,Q.lng),fe=Math.min(L.lat,$.lat,H.lat,Q.lat),ve=Math.max(L.lat,$.lat,H.lat,Q.lat);const Te=Math.pow(2,-this.zoom)/16*270,Ie=this.projection.name==="globe"?1:4,Pe=(Le,he,Se,Fe,ke)=>{const Qe=(Le+Se)/2,et=(he+Fe)/2,Je=new s.Point(Qe,et),{lng:lt,lat:st}=this.pointLocation3D(Je),xt=Math.max(0,ne-lt,fe-st,lt-te,st-ve);ne=Math.min(ne,lt),te=Math.max(te,lt),fe=Math.min(fe,st),ve=Math.max(ve,st),(ke<Ie||xt>Te)&&(Pe(Le,he,Qe,et,ke+1),Pe(Qe,et,Se,Fe,ke+1))};if(Pe(m,h,I,h,1),Pe(I,h,I,S,1),Pe(I,S,m,S,1),Pe(m,S,m,h,1),this.projection.name==="globe"){const[Le,he]=s.polesInViewport(this);Le?(ve=90,te=180,ne=-180):he&&(fe=-90,te=180,ne=-180)}return new s.LngLatBounds(new s.LngLat(ne,fe),new s.LngLat(te,ve))}_getBoundsRectangular(h,m){const{top:S,left:I}=this._edgeInsets,L=this.height-this._edgeInsets.bottom,$=this.width-this._edgeInsets.right,H=new s.Point(I,S),Q=new s.Point($,S),ne=new s.Point($,L),te=new s.Point(I,L);let fe=this.pointCoordinate(H,h),ve=this.pointCoordinate(Q,h);const Te=this.pointCoordinate(ne,m),Ie=this.pointCoordinate(te,m),Pe=(Le,he)=>(he.y-Le.y)/(he.x-Le.x);return fe.y>1&&ve.y>=0?fe=new s.MercatorCoordinate((1-Ie.y)/Pe(Ie,fe)+Ie.x,1):fe.y<0&&ve.y<=1&&(fe=new s.MercatorCoordinate(-Ie.y/Pe(Ie,fe)+Ie.x,0)),ve.y>1&&fe.y>=0?ve=new s.MercatorCoordinate((1-Te.y)/Pe(Te,ve)+Te.x,1):ve.y<0&&fe.y<=1&&(ve=new s.MercatorCoordinate(-Te.y/Pe(Te,ve)+Te.x,0)),new s.LngLatBounds().extend(this.coordinateLocation(fe)).extend(this.coordinateLocation(ve)).extend(this.coordinateLocation(Ie)).extend(this.coordinateLocation(Te))}_getBoundsRectangularTerrain(){const h=this.elevation;if(!h.visibleDemTiles.length||h.isUsingMockSource())return this._getBoundsRectangular(0,0);const m=h.visibleDemTiles.reduce((S,I)=>{if(I.dem){const L=I.dem.tree;S.min=Math.min(S.min,L.minimums[0]),S.max=Math.max(S.max,L.maximums[0])}return S},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(m.min*h.exaggeration(),m.max*h.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(h=!0){const m=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,S=this.height/2-m*(1-this._horizonShift);return h?Math.max(0,S):S}getMaxBounds(){return this.maxBounds}setMaxBounds(h){this.maxBounds=h,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,h&&(this.minLat=h.getSouth(),this.maxLat=h.getNorth(),this.minLng=h.getWest(),this.maxLng=h.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(h,m){return this.projection.createTileMatrix(this,m,h)}calculateDistanceTileData(h){const m=h.key,S=this._distanceTileDataCache;if(S[m])return S[m];const I=h.canonical,L=1/this.height,$=this.cameraWorldSize,H=$/this.zoomScale(I.z),Q=(I.x+Math.pow(2,I.z)*h.wrap)*H,ne=I.y*H,te=this.point;te.x*=$/this.worldSize,te.y*=$/this.worldSize;const fe=this.angle,ve=Math.sin(-fe),Te=-Math.cos(-fe);return S[m]={bearing:[ve,Te],center:[(te.x-Q)*L,(te.y-ne)*L],scale:H/s.EXTENT*L},S[m]}calculateFogTileMatrix(h){const m=h.key,S=this._fogTileMatrixCache;if(S[m])return S[m];const I=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,h);return s.multiply(I,this.worldToFogMatrix,I),S[m]=new Float32Array(I),S[m]}calculateProjMatrix(h,m=!1){const S=h.key,I=m?this._alignedProjMatrixCache:this._projMatrixCache;if(I[S])return I[S];const L=this.calculatePosMatrix(h,this.worldSize);return s.multiply(L,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:m?this.alignedProjMatrix:this.projMatrix,L),I[S]=new Float32Array(L),I[S]}calculatePixelsToTileUnitsMatrix(h){const m=h.tileID.key,S=this._pixelsToTileUnitsCache;if(S[m])return S[m];const I=function(L,$){const{scale:H}=L.tileTransform,Q=H*s.EXTENT/(L.tileSize*Math.pow(2,$.zoom-L.tileID.overscaledZ+L.tileID.canonical.z));return ne=new Float32Array(4),ve=(te=$.inverseAdjustmentMatrix)[1],Te=te[2],Ie=te[3],Le=(fe=[Q,Q])[1],ne[0]=te[0]*(Pe=fe[0]),ne[1]=ve*Pe,ne[2]=Te*Le,ne[3]=Ie*Le,ne;var ne,te,fe,ve,Te,Ie,Pe,Le}(h,this);return S[m]=I,S[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const h=1/this.worldSize,m=s.fromScaling([],[h,h,h]);return s.multiply(m,m,this.globeMatrix),m}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const h=this._elevation;this._updateCameraState();const m=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,S=this._computeCameraPosition(m),I=this._camera.forward(),L=s.mercatorZfromAltitude(1,this._center.lat);S[2]/=L,I[2]/=L,s.normalize(I,I);const $=h.raycast(S,I,h.exaggeration());if($){const H=s.scaleAndAdd([],S,I,$),Q=new s.MercatorCoordinate(H[0],H[1],s.mercatorZfromAltitude(H[2],s.latFromMercatorY(H[1]))),ne=(Q.z+s.length([Q.x-S[0],Q.y-S[1],Q.z-S[2]*L]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(ne),this._centerAltitude=Q.toAltitude(),this._center=this.coordinateLocation(Q),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(h=!1){if(!this._elevation)return;const m=this._elevation,S=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,I=this._computeCameraPosition(S),L=m.getAtPointOrZero(new s.MercatorCoordinate(...I)),$=this.pixelsPerMeter/this.worldSize*L,H=this._minimumHeightOverTerrain(),Q=I[2]-$;if(Q<=H)if(Q<0||h){const ne=this.locationCoordinate(this._center,this._centerAltitude),te=[I[0],I[1],ne.z-I[2]],fe=s.length(te);te[2]-=(H-Q)/this._pixelsPerMercatorPixel;const ve=s.length(te);if(ve===0)return;s.scale$2(te,te,fe/ve*this._pixelsPerMercatorPixel),this._camera.position=[I[0],I[1],ne.z*this._pixelsPerMercatorPixel-te[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const h=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||h){const ve=this.center;return ve.lat=s.clamp(ve.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!h)&&(ve.lng=s.clamp(ve.lng,this.minLng,this.maxLng)),this.center=ve,void(this._constraining=!1)}const m=this._unmodified,{x:S,y:I}=this.point;let L=0,$=S,H=I;const Q=this.width/2,ne=this.height/2,te=this.worldMinY*this.scale,fe=this.worldMaxY*this.scale;if(I-ne<te&&(H=te+ne),I+ne>fe&&(H=fe-ne),fe-te<this.height&&(L=Math.max(L,this.height/(fe-te)),H=(fe+te)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ve=this.worldMinX*this.scale,Te=this.worldMaxX*this.scale,Ie=this.worldSize/2-(ve+Te)/2;$=(S+Ie+this.worldSize)%this.worldSize-Ie,$-Q<ve&&($=ve+Q),$+Q>Te&&($=Te-Q),Te-ve<this.width&&(L=Math.max(L,this.width/(Te-ve)),$=(Te+ve)/2)}$===S&&H===I||(this.center=this.unproject(new s.Point($,H))),L&&(this.zoom+=this.scaleZoom(L)),this._constrainCamera(),this._unmodified=m,this._constraining=!1}_minZoomForBounds(){let h=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(h=Math.max(h,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),h}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const h=this.centerOffset,m=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const S=qg(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,S),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const I=this.projection.zAxisUnit==="meters"?m:1,L=this._camera.getWorldToCamera(this.worldSize,I),$=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);$[8]=2*-h.x/this.width,$[9]=2*h.y/this.height;let H=s.mul([],$,L);if(this.projection.isReprojectedInTileSpace){const et=this.locationCoordinate(this.center),Je=s.identity([]);s.translate(Je,Je,[et.x*this.worldSize,et.y*this.worldSize,0]),s.multiply(Je,Je,Yh(this)),s.translate(Je,Je,[-et.x*this.worldSize,-et.y*this.worldSize,0]),s.multiply(H,H,Je),this.inverseAdjustmentMatrix=function(lt){const st=Yh(lt,!0);return ie([],[st[0],st[1],st[4],st[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],H,[this.worldSize,this.worldSize,this.worldSize/I,1]),this.projMatrix=H,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const Q=s.invert([],$);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(Q,this.horizonLineFromTop(),this.height);const ne=new Float32Array(16);s.identity(ne),s.scale(ne,ne,[1,-1,1]),s.rotateX(ne,ne,this._pitch),s.rotateZ(ne,ne,this.angle);const te=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),fe=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;te[8]=2*-h.x/this.width,te[9]=2*(h.y+fe)/this.height,this.skyboxMatrix=s.multiply(ne,te,ne);const ve=this.point,Te=ve.x,Ie=ve.y,Pe=this.width%2/2,Le=this.height%2/2,he=Math.cos(this.angle),Se=Math.sin(this.angle),Fe=Te-Math.round(Te)+he*Pe+Se*Le,ke=Ie-Math.round(Ie)+he*Le+Se*Pe,Qe=new Float64Array(H);if(s.translate(Qe,Qe,[Fe>.5?Fe-1:Fe,ke>.5?ke-1:ke,0]),this.alignedProjMatrix=Qe,H=s.create(),s.scale(H,H,[this.width/2,-this.height/2,1]),s.translate(H,H,[1,-1,0]),this.labelPlaneMatrix=H,H=s.create(),s.scale(H,H,[1,-1,1]),s.translate(H,H,[-1,-1,0]),s.scale(H,H,[2/this.width,2/this.height,1]),this.glCoordMatrix=H,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},H=s.invert(new Float64Array(16),this.pixelMatrix),!H)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=H,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const et=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(et,et,L),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=H;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const h=this.cameraWorldSizeForFog,m=this.cameraPixelsPerMeter,S=this._camera.position,I=1/this.height/this._pixelsPerMercatorPixel,L=[h,h,m];s.scale$2(L,L,I),s.scale$2(S,S,-1),s.multiply$2(S,S,L);const $=s.create();s.translate($,$,S),s.scale($,$,L),this.mercatorFogMatrix=$,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(h,m,I)}_computeCameraPosition(h){const m=(h=h||this.pixelsPerMeter)/this.pixelsPerMeter,S=this._camera.forward(),I=this.point,L=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*m-h/this.worldSize*this._centerAltitude;return[I.x/this.worldSize-S[0]*L,I.y/this.worldSize-S[1]*L,h/this.worldSize*this._centerAltitude-S[2]*L]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(h){const m=this._maxCameraBoundsDistance()*Math.cos(this._pitch),S=this._camera.position[2],I=h[2];let L=1;this.projection.wrap&&(this.center=this.center.wrap()),I>0&&(L=Math.min((m-S)/I,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,h,L),this._updateStateFromCamera()}_updateStateFromCamera(){const h=this._camera.position,m=this._camera.forward(),{pitch:S,bearing:I}=this._camera.getPitchBearing(),L=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,$=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),H=Math.max((h[2]-L)/Math.cos(S),$),Q=this._zoomFromMercatorZ(H);s.scaleAndAdd(h,h,m,H),this._pitch=s.clamp(S,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(I,-Math.PI,Math.PI),this._setZoom(s.clamp(Q,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(h[0],h[1],h[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(h){return Math.pow(2,h)*this.tileSize}_mercatorZfromZoom(h){return this.cameraToCenterDistance/this._worldSizeFromZoom(h)}_minimumHeightOverTerrain(){const h=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(h)}_zoomFromMercatorZ(h){return this.scaleZoom(this.cameraToCenterDistance/(h*this.tileSize))}zoomFromMercatorZAdjusted(h){let m=0,S=s.GLOBE_ZOOM_THRESHOLD_MAX,I=0,L=1/0;for(;S-m>1e-6&&S>m;){const $=m+.5*(S-m),H=this.tileSize*Math.pow(2,$),Q=this.getCameraToCenterDistance(this.projection,$,H),ne=this.scaleZoom(Q/(h*this.tileSize)),te=Math.abs($-ne);te<L&&(L=te,I=$),$<ne?m=$:S=$}return I}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(h,m){const S=Math.min(h.x,m.x),I=Math.max(h.x,m.x),L=Math.min(h.y,m.y),$=Math.max(h.y,m.y);if(L<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const H=[new s.Point(S,L),new s.Point(I,$),new s.Point(S,$),new s.Point(I,L)],Q=this.renderWorldCopies?-3:0,ne=this.renderWorldCopies?4:1;for(const te of H){const fe=this.pointRayIntersection(te);if(fe.t<0)return!0;const ve=this.rayIntersectionCoordinate(fe);if(ve.x<Q||ve.y<0||ve.x>ne||ve.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.Point(0,0),new s.Point(this.width,this.height))}zoomDeltaToMovement(h,m){const S=s.length(s.sub([],this._camera.position,h)),I=this._zoomFromMercatorZ(S)+m;return S-this._mercatorZfromZoom(I)}getCameraPoint(){if(this.projection.name==="globe"){const h=function([m,S,I],L){const $=[m,S,I,1];s.transformMat4$1($,$,L);const H=$[3]=Math.max($[3],1e-6);return $[0]/=H,$[1]/=H,$[2]/=H,$}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.Point(h[0],h[1])}{const h=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,h))}}getCameraToCenterDistance(h,m=this.zoom,S=this.worldSize){const I=qg(h,m,this.width,this.height,1024),L=h.pixelSpaceConversion(this.center.lat,S,I);return .5/Math.tan(.5*this._fov)*this.height*L}getWorldToCameraMatrix(){const h=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.multiply(h,h,this.globeMatrix),h}}function Qh(v,h){let m=!1,S=null;const I=()=>{S=null,m&&(v(),S=setTimeout(I,h),m=!1)};return()=>(m=!0,S||I(),S)}class $A{constructor(h){this._hashName=h&&encodeURIComponent(h),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Qh(this._updateHashUnthrottled.bind(this),300)}addTo(h){return this._map=h,s.window.addEventListener("hashchange",this._onHashChange,!1),h.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const h=this._map;if(!h)return"";const m=Ep(h);if(this._hashName){const S=this._hashName;let I=!1;const L=s.window.location.hash.slice(1).split("&").map($=>{const H=$.split("=")[0];return H===S?(I=!0,`${H}=${m}`):$}).filter($=>$);return I||L.push(`${S}=${m}`),`#${L.join("&")}`}return`#${m}`}_getCurrentHash(){const h=s.window.location.hash.replace("#","");if(this._hashName){let m;return h.split("&").map(S=>S.split("=")).forEach(S=>{S[0]===this._hashName&&(m=S)}),(m&&m[1]||"").split("/")}return h.split("/")}_onHashChange(){const h=this._map;if(!h)return!1;const m=this._getCurrentHash();if(m.length>=3&&!m.some(S=>isNaN(S))){const S=h.dragRotate.isEnabled()&&h.touchZoomRotate.isEnabled()?+(m[3]||0):h.getBearing();return h.jumpTo({center:[+m[2],+m[1]],zoom:+m[0],bearing:S,pitch:+(m[4]||0)}),!0}return!1}_updateHashUnthrottled(){const h=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,h)}}function Ep(v,h){const m=v.getCenter(),S=Math.round(100*v.getZoom())/100,I=Math.ceil((S*Math.LN2+Math.log(512/360/.5))/Math.LN10),L=Math.pow(10,I),$=Math.round(m.lng*L)/L,H=Math.round(m.lat*L)/L,Q=v.getBearing(),ne=v.getPitch();let te=h?`/${$}/${H}/${S}`:`${S}/${H}/${$}`;return(Q||ne)&&(te+="/"+Math.round(10*Q)/10),ne&&(te+=`/${Math.round(ne)}`),te}const Kh={linearity:.3,easing:s.bezier(0,0,.3,1)},Sp=s.extend({deceleration:2500,maxSpeed:1400},Kh),Tp=s.extend({deceleration:20,maxSpeed:1400},Kh),Sn=s.extend({deceleration:1e3,maxSpeed:360},Kh),Vl=s.extend({deceleration:1e3,maxSpeed:90},Kh);class j_{constructor(h){this._map=h,this.clear()}clear(){this._inertiaBuffer=[]}record(h){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:h})}_drainInertiaBuffer(){const h=this._inertiaBuffer,m=s.exported.now();for(;h.length>0&&m-h[0].time>160;)h.shift()}_onMoveEnd(h){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const m={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:L}of this._inertiaBuffer)m.zoom+=L.zoomDelta||0,m.bearing+=L.bearingDelta||0,m.pitch+=L.pitchDelta||0,L.panDelta&&m.pan._add(L.panDelta),L.around&&(m.around=L.around),L.pinchAround&&(m.pinchAround=L.pinchAround);const S=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,I={};if(m.pan.mag()){const L=Pp(m.pan.mag(),S,s.extend({},Sp,h||{}));I.offset=m.pan.mult(L.amount/m.pan.mag()),I.center=this._map.transform.center,Cp(I,L)}if(m.zoom){const L=Pp(m.zoom,S,Tp);I.zoom=this._map.transform.zoom+L.amount,Cp(I,L)}if(m.bearing){const L=Pp(m.bearing,S,Sn);I.bearing=this._map.transform.bearing+s.clamp(L.amount,-179,179),Cp(I,L)}if(m.pitch){const L=Pp(m.pitch,S,Vl);I.pitch=this._map.transform.pitch+L.amount,Cp(I,L)}if(I.zoom||I.bearing){const L=m.pinchAround===void 0?m.around:m.pinchAround;I.around=L?this._map.unproject(L):this._map.getCenter()}return this.clear(),I.noMoveStart=!0,I}}function Cp(v,h){(!v.duration||v.duration<h.duration)&&(v.duration=h.duration,v.easing=h.easing)}function Pp(v,h,m){const{maxSpeed:S,linearity:I,deceleration:L}=m,$=s.clamp(v*I/(h/1e3),-S,S),H=Math.abs($)/(L*I);return{easing:m.easing,duration:1e3*H,amount:$*(H/2)}}class hs extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,m,S,I={}){const L=Y(m.getCanvasContainer(),S),$=m.unproject(L);super(h,s.extend({point:L,lngLat:$,originalEvent:S},I)),this._defaultPrevented=!1,this.target=m}}class Vc extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,m,S){const I=h==="touchend"?S.changedTouches:S.touches,L=J(m.getCanvasContainer(),I),$=L.map(Q=>m.unproject(Q)),H=L.reduce((Q,ne,te,fe)=>Q.add(ne.div(fe.length)),new s.Point(0,0));super(h,{points:L,point:H,lngLats:$,lngLat:m.unproject(H),originalEvent:S}),this._defaultPrevented=!1}}class Ga extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(h,m,S){super(h,{originalEvent:S}),this._defaultPrevented=!1}}class Mr{constructor(h,m){this._map=h,this._clickTolerance=m.clickTolerance}reset(){this._mousedownPos=void 0}wheel(h){return this._firePreventable(new Ga(h.type,this._map,h))}mousedown(h,m){return this._mousedownPos=m,this._firePreventable(new hs(h.type,this._map,h))}mouseup(h){this._map.fire(new hs(h.type,this._map,h))}preclick(h){const m=s.extend({},h);m.type="preclick",this._map.fire(new hs(m.type,this._map,m))}click(h,m){this._mousedownPos&&this._mousedownPos.dist(m)>=this._clickTolerance||(this.preclick(h),this._map.fire(new hs(h.type,this._map,h)))}dblclick(h){return this._firePreventable(new hs(h.type,this._map,h))}mouseover(h){this._map.fire(new hs(h.type,this._map,h))}mouseout(h){this._map.fire(new hs(h.type,this._map,h))}touchstart(h){return this._firePreventable(new Vc(h.type,this._map,h))}touchmove(h){this._map.fire(new Vc(h.type,this._map,h))}touchend(h){this._map.fire(new Vc(h.type,this._map,h))}touchcancel(h){this._map.fire(new Vc(h.type,this._map,h))}_firePreventable(h){if(this._map.fire(h),h.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ma{constructor(h){this._map=h}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(h){this._map.fire(new hs(h.type,this._map,h))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new hs("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(h){this._delayContextMenu?this._contextMenuEvent=h:this._map.fire(new hs(h.type,this._map,h)),this._map.listens("contextmenu")&&h.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class V_{constructor(h,m){this._map=h,this._el=h.getCanvasContainer(),this._container=h.getContainer(),this._clickTolerance=m.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(h,m){this.isEnabled()&&h.shiftKey&&h.button===0&&(k(),this._startPos=this._lastPos=m,this._active=!0)}mousemoveWindow(h,m){if(!this._active)return;const S=m,I=this._startPos,L=this._lastPos;if(!I||!L||L.equals(S)||!this._box&&S.dist(I)<this._clickTolerance)return;this._lastPos=S,this._box||(this._box=E("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",h));const $=Math.min(I.x,S.x),H=Math.max(I.x,S.x),Q=Math.min(I.y,S.y),ne=Math.max(I.y,S.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${$}px,${Q}px)`,this._box.style.width=H-$+"px",this._box.style.height=ne-Q+"px")})}mouseupWindow(h,m){if(!this._active)return;const S=this._startPos,I=m;if(S&&h.button===0){if(this.reset(),X(),S.x!==I.x||S.y!==I.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:h})),{cameraAnimation:L=>L.fitScreenCoordinates(S,I,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",h)}}keydown(h){this._active&&h.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",h))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),F(),delete this._startPos,delete this._lastPos}_fireEvent(h,m){return this._map.fire(new s.Event(h,{originalEvent:m}))}}function $c(v,h){const m={};for(let S=0;S<v.length;S++)m[v[S].identifier]=h[S];return m}class Wf{constructor(h){this.reset(),this.numTouches=h.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(h,m,S){(this.centroid||S.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=h.timeStamp),S.length===this.numTouches&&(this.centroid=function(I){const L=new s.Point(0,0);for(const $ of I)L._add($);return L.div(I.length)}(m),this.touches=$c(S,m)))}touchmove(h,m,S){if(this.aborted||!this.centroid)return;const I=$c(S,m);for(const L in this.touches){const $=I[L];(!$||$.dist(this.touches[L])>30)&&(this.aborted=!0)}}touchend(h,m,S){if((!this.centroid||h.timeStamp-this.startTime>500)&&(this.aborted=!0),S.length===0){const I=!this.aborted&&this.centroid;if(this.reset(),I)return I}}}class HA{constructor(h){this.singleTap=new Wf(h),this.numTaps=h.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(h,m,S){this.singleTap.touchstart(h,m,S)}touchmove(h,m,S){this.singleTap.touchmove(h,m,S)}touchend(h,m,S){const I=this.singleTap.touchend(h,m,S);if(I){const L=h.timeStamp-this.lastTime<500,$=!this.lastTap||this.lastTap.dist(I)<30;if(L&&$||this.reset(),this.count++,this.lastTime=h.timeStamp,this.lastTap=I,this.count===this.numTaps)return this.reset(),I}}}class Hc{constructor(){this._zoomIn=new HA({numTouches:1,numTaps:2}),this._zoomOut=new HA({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(h,m,S){this._zoomIn.touchstart(h,m,S),this._zoomOut.touchstart(h,m,S)}touchmove(h,m,S){this._zoomIn.touchmove(h,m,S),this._zoomOut.touchmove(h,m,S)}touchend(h,m,S){const I=this._zoomIn.touchend(h,m,S),L=this._zoomOut.touchend(h,m,S);return I?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:$=>$.easeTo({duration:300,zoom:$.getZoom()+1,around:$.unproject(I)},{originalEvent:h})}):L?(this._active=!0,h.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:$=>$.easeTo({duration:300,zoom:$.getZoom()-1,around:$.unproject(L)},{originalEvent:h})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const An={0:1,2:2};class Dn{constructor(h){this.reset(),this._clickTolerance=h.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(h,m){return!1}_move(h,m){return{}}mousedown(h,m){if(this._lastPoint)return;const S=re(h);this._correctButton(h,S)&&(this._lastPoint=m,this._eventButton=S)}mousemoveWindow(h,m){const S=this._lastPoint;if(S){if(h.preventDefault(),this._eventButton!=null&&function(I,L){const $=An[L];return I.buttons===void 0||(I.buttons&$)!==$}(h,this._eventButton))this.reset();else if(this._moved||!(m.dist(S)<this._clickTolerance))return this._moved=!0,this._lastPoint=m,this._move(S,m)}}mouseupWindow(h){this._lastPoint&&re(h)===this._eventButton&&(this._moved&&X(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xg extends Dn{mousedown(h,m){super.mousedown(h,m),this._lastPoint&&(this._active=!0)}_correctButton(h,m){return m===0&&!h.ctrlKey}_move(h,m){return{around:m,panDelta:m.sub(h)}}}class Jh extends Dn{_correctButton(h,m){return m===0&&h.ctrlKey||m===2}_move(h,m){const S=.8*(m.x-h.x);if(S)return this._active=!0,{bearingDelta:S}}contextmenu(h){h.preventDefault()}}class ed extends Dn{_correctButton(h,m){return m===0&&h.ctrlKey||m===2}_move(h,m){const S=-.5*(m.y-h.y);if(S)return this._active=!0,{pitchDelta:S}}contextmenu(h){h.preventDefault()}}class Aa{constructor(h,m){this._map=h,this._el=h.getCanvasContainer(),this._minTouches=1,this._clickTolerance=m.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)}touchstart(h,m,S){return this._calculateTransform(h,m,S)}touchmove(h,m,S){if(this._active&&!(S.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(S.length===1&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return h.cancelable&&h.preventDefault(),this._calculateTransform(h,m,S)}}touchend(h,m,S){this._calculateTransform(h,m,S),this._active&&S.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(h,m,S){S.length>0&&(this._active=!0);const I=$c(S,m),L=new s.Point(0,0),$=new s.Point(0,0);let H=0;for(const ne in I){const te=I[ne],fe=this._touches[ne];fe&&(L._add(te),$._add(te.sub(fe)),H++,I[ne]=te)}if(this._touches=I,H<this._minTouches||!$.mag())return;const Q=$.div(H);return this._sum._add(Q),this._sum.mag()<this._clickTolerance?void 0:{around:L.div(H),panDelta:Q}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=E("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class td{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(h){}_move(h,m,S){return{}}touchstart(h,m,S){this._firstTwoTouches||S.length<2||(this._firstTwoTouches=[S[0].identifier,S[1].identifier],this._start([m[0],m[1]]))}touchmove(h,m,S){const I=this._firstTwoTouches;if(!I)return;h.preventDefault();const[L,$]=I,H=al(S,m,L),Q=al(S,m,$);if(!H||!Q)return;const ne=this._aroundCenter?null:H.add(Q).div(2);return this._move([H,Q],ne,h)}touchend(h,m,S){if(!this._firstTwoTouches)return;const[I,L]=this._firstTwoTouches,$=al(S,m,I),H=al(S,m,L);$&&H||(this._active&&X(),this.reset())}touchcancel(){this.reset()}enable(h){this._enabled=!0,this._aroundCenter=!!h&&h.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function al(v,h,m){for(let S=0;S<v.length;S++)if(v[S].identifier===m)return h[S]}function y(v,h){return Math.log(v/h)/Math.LN2}class x extends td{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(h){this._startDistance=this._distance=h[0].dist(h[1])}_move(h,m){const S=this._distance;if(this._distance=h[0].dist(h[1]),this._active||!(Math.abs(y(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:y(this._distance,S),pinchAround:m}}}function T(v,h){return 180*v.angleWith(h)/Math.PI}class R extends td{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(h){this._startVector=this._vector=h[0].sub(h[1]),this._minDiameter=h[0].dist(h[1])}_move(h,m){const S=this._vector;if(this._vector=h[0].sub(h[1]),S&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:T(this._vector,S),pinchAround:m}}_isBelowThreshold(h){this._minDiameter=Math.min(this._minDiameter,h.mag());const m=25/(Math.PI*this._minDiameter)*360,S=this._startVector;if(!S)return!1;const I=T(h,S);return Math.abs(I)<m}}function B(v){return Math.abs(v.y)>Math.abs(v.x)}class j extends td{constructor(h){super(),this._map=h}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(h){this._lastPoints=h,B(h[0].sub(h[1]))&&(this._valid=!1)}_move(h,m,S){const I=this._lastPoints;if(!I)return;const L=h[0].sub(I[0]),$=h[1].sub(I[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&S.touches.length<3||(this._valid=this.gestureBeginsVertically(L,$,S.timeStamp),!this._valid)?void 0:(this._lastPoints=h,this._active=!0,{pitchDelta:(L.y+$.y)/2*-.5})}gestureBeginsVertically(h,m,S){if(this._valid!==void 0)return this._valid;const I=h.mag()>=2,L=m.mag()>=2;if(!I&&!L)return;if(!I||!L)return this._firstMove==null&&(this._firstMove=S),S-this._firstMove<100&&void 0;const $=h.y>0==m.y>0;return B(h)&&B(m)&&$}}const G={panStep:100,bearingStep:15,pitchStep:10};class Z{constructor(){const h=G;this._panStep=h.panStep,this._bearingStep=h.bearingStep,this._pitchStep=h.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(h){if(h.altKey||h.ctrlKey||h.metaKey)return;let m=0,S=0,I=0,L=0,$=0;switch(h.keyCode){case 61:case 107:case 171:case 187:m=1;break;case 189:case 109:case 173:m=-1;break;case 37:h.shiftKey?S=-1:(h.preventDefault(),L=-1);break;case 39:h.shiftKey?S=1:(h.preventDefault(),L=1);break;case 38:h.shiftKey?I=1:(h.preventDefault(),$=-1);break;case 40:h.shiftKey?I=-1:(h.preventDefault(),$=1);break;default:return}return this._rotationDisabled&&(S=0,I=0),{cameraAnimation:H=>{const Q=H.getZoom();H.easeTo({duration:300,easeId:"keyboardHandler",easing:ae,zoom:m?Math.round(Q)+m*(h.shiftKey?2:1):Q,bearing:H.getBearing()+S*this._bearingStep,pitch:H.getPitch()+I*this._pitchStep,offset:[-L*this._panStep,-$*this._panStep],center:H.getCenter()},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ae(v){return v*(2-v)}const pe=4.000244140625;class _e{constructor(h,m){this._map=h,this._el=h.getCanvasContainer(),this._handler=m,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(h){this._defaultZoomRate=h}setWheelZoomRate(h){this._wheelZoomRate=h}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(h){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!h&&h.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(h){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(h.ctrlKey||h.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let m=h.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*h.deltaY:h.deltaY;const S=s.exported.now(),I=S-(this._lastWheelEventTime||0);this._lastWheelEventTime=S,m!==0&&m%pe==0?this._type="wheel":m!==0&&Math.abs(m)<4?this._type="trackpad":I>400?(this._type=null,this._lastValue=m,this._timeout=setTimeout(this._onTimeout,40,h)):this._type||(this._type=Math.abs(I*m)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,m+=this._lastValue)),h.shiftKey&&m&&(m/=4),this._type&&(this._lastWheelEvent=h,this._delta-=m,this._active||this._start(h)),h.preventDefault()}_onTimeout(h){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(h)}_start(h){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const m=Y(this._el,h);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:m,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const h=this._map.transform;this._type==="wheel"&&h.projection.wrap&&(h._center.lng>=180||h._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const m=()=>h._terrainEnabled()&&this._aroundCoord?h.computeZoomRelativeTo(this._aroundCoord):h.zoom;if(this._delta!==0){const Q=this._type==="wheel"&&Math.abs(this._delta)>pe?this._wheelZoomRate:this._defaultZoomRate;let ne=2/(1+Math.exp(-Math.abs(this._delta*Q)));this._delta<0&&ne!==0&&(ne=1/ne);const te=m(),fe=Math.pow(2,te),ve=typeof this._targetZoom=="number"?h.zoomScale(this._targetZoom):fe;this._targetZoom=Math.min(h.maxZoom,Math.max(h.minZoom,h.scaleZoom(ve*ne))),this._type==="wheel"&&(this._startZoom=te,this._easing=this._smoothOutEasing(200)),this._delta=0}const S=typeof this._targetZoom=="number"?this._targetZoom:m(),I=this._startZoom,L=this._easing;let $,H=!1;if(this._type==="wheel"&&I&&L){const Q=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),ne=L(Q);$=s.number(I,S,ne),Q<1?this._frameId||(this._frameId=!0):H=!0}else $=S,H=!0;return this._active=!0,H&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!H,zoomDelta:$-m(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(h){let m=s.ease;if(this._prevEase){const S=this._prevEase,I=(s.exported.now()-S.start)/S.duration,L=S.easing(I+.01)-S.easing(I),$=.27/Math.sqrt(L*L+1e-4)*.01,H=Math.sqrt(.0729-$*$);m=s.bezier($,H,.25,1)}return this._prevEase={start:s.exported.now(),duration:h,easing:m},m}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=E("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Xe{constructor(h,m){this._clickZoom=h,this._tapZoom=m}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class tt{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(h,m){return h.preventDefault(),{cameraAnimation:S=>{S.easeTo({duration:300,zoom:S.getZoom()+(h.shiftKey?-1:1),around:S.unproject(m)},{originalEvent:h})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gt{constructor(){this._tap=new HA({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(h,m,S){this._swipePoint||(this._tapTime&&h.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?S.length>0&&(this._swipePoint=m[0],this._swipeTouch=S[0].identifier):this._tap.touchstart(h,m,S))}touchmove(h,m,S){if(this._tapTime){if(this._swipePoint){if(S[0].identifier!==this._swipeTouch)return;const I=m[0],L=I.y-this._swipePoint.y;return this._swipePoint=I,h.preventDefault(),this._active=!0,{zoomDelta:L/128}}}else this._tap.touchmove(h,m,S)}touchend(h,m,S){this._tapTime?this._swipePoint&&S.length===0&&this.reset():this._tap.touchend(h,m,S)&&(this._tapTime=h.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class kt{constructor(h,m,S){this._el=h,this._mousePan=m,this._touchPan=S}enable(h){this._inertiaOptions=h||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Vt{constructor(h,m,S){this._pitchWithRotate=h.pitchWithRotate,this._mouseRotate=m,this._mousePitch=S}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class yn{constructor(h,m,S,I){this._el=h,this._touchZoom=m,this._touchRotate=S,this._tapDragZoom=I,this._rotationDisabled=!1,this._enabled=!0}enable(h){this._touchZoom.enable(h),this._rotationDisabled||this._touchRotate.enable(h),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Cn=v=>v.zoom||v.drag||v.pitch||v.rotate;class Rt extends s.Event{}class fn{constructor(){this.constants=[1,1,.01],this.radius=0}setup(h,m){const S=s.sub([],m,h);this.radius=s.length(S[2]<0?s.div([],S,this.constants):[S[0],S[1],0])}projectRay(h){s.div(h,h,this.constants),s.normalize(h,h),s.mul$1(h,h,this.constants);const m=s.scale$2([],h,this.radius);if(m[2]>0){const S=s.scale$2([],[0,0,1],s.dot(m,[0,0,1])),I=s.scale$2([],s.normalize([],[m[0],m[1],0]),this.radius),L=s.add([],m,s.scale$2([],s.sub([],s.add([],I,S),m),2));m[0]=L[0],m[1]=L[1]}return m}}function it(v){return v.panDelta&&v.panDelta.mag()||v.zoomDelta||v.bearingDelta||v.pitchDelta}class On{constructor(h,m){this._map=h,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new j_(h),this._bearingSnap=m.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new fn,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(m),s.bindAll(["handleEvent","handleWindowEvent"],this);const S=this._el;this._listeners=[[S,"touchstart",{passive:!0}],[S,"touchmove",{passive:!1}],[S,"touchend",void 0],[S,"touchcancel",void 0],[S,"mousedown",void 0],[S,"mousemove",void 0],[S,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[S,"mouseover",void 0],[S,"mouseout",void 0],[S,"dblclick",void 0],[S,"click",void 0],[S,"keydown",{capture:!1}],[S,"keyup",void 0],[S,"wheel",{passive:!1}],[S,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[I,L,$]of this._listeners)I.addEventListener(L,I===s.window.document?this.handleWindowEvent:this.handleEvent,$)}destroy(){for(const[h,m,S]of this._listeners)h.removeEventListener(m,h===s.window.document?this.handleWindowEvent:this.handleEvent,S)}_addDefaultHandlers(h){const m=this._map,S=m.getCanvasContainer();this._add("mapEvent",new Mr(m,h));const I=m.boxZoom=new V_(m,h);this._add("boxZoom",I);const L=new Hc,$=new tt;m.doubleClickZoom=new Xe($,L),this._add("tapZoom",L),this._add("clickZoom",$);const H=new gt;this._add("tapDragZoom",H);const Q=m.touchPitch=new j(m);this._add("touchPitch",Q);const ne=new Jh(h),te=new ed(h);m.dragRotate=new Vt(h,ne,te),this._add("mouseRotate",ne,["mousePitch"]),this._add("mousePitch",te,["mouseRotate"]);const fe=new Xg(h),ve=new Aa(m,h);m.dragPan=new kt(S,fe,ve),this._add("mousePan",fe),this._add("touchPan",ve,["touchZoom","touchRotate"]);const Te=new R,Ie=new x;m.touchZoomRotate=new yn(S,Ie,Te,H),this._add("touchRotate",Te,["touchPan","touchZoom"]),this._add("touchZoom",Ie,["touchPan","touchRotate"]),this._add("blockableMapEvent",new ma(m));const Pe=m.scrollZoom=new _e(m,this);this._add("scrollZoom",Pe,["mousePan"]);const Le=m.keyboard=new Z;this._add("keyboard",Le);for(const he of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])h.interactive&&h[he]&&m[he].enable(h[he])}_add(h,m,S){this._handlers.push({handlerName:h,handler:m,allowed:S}),this._handlersById[h]=m}stop(h){if(!this._updatingCamera){for(const{handler:m}of this._handlers)m.reset();this._inertia.clear(),this._fireEvents({},{},h),this._changes=[]}}isActive(){for(const{handler:h}of this._handlers)if(h.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Cn(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(h,m,S){for(const I in h)if(I!==S&&(!m||m.indexOf(I)<0))return!0;return!1}handleWindowEvent(h){this.handleEvent(h,`${h.type}Window`)}_getMapTouches(h){const m=[];for(const S of h)this._el.contains(S.target)&&m.push(S);return m}handleEvent(h,m){this._updatingCamera=!0;const S=h.type==="renderFrame",I=S?void 0:h,L={needsRenderFrame:!1},$={},H={},Q=h.touches?this._getMapTouches(h.touches):void 0,ne=Q?J(this._el,Q):S?void 0:Y(this._el,h);for(const{handlerName:ve,handler:Te,allowed:Ie}of this._handlers){if(!Te.isEnabled())continue;let Pe;this._blockedByActive(H,Ie,ve)?Te.reset():Te[m||h.type]&&(Pe=Te[m||h.type](h,ne,Q),this.mergeHandlerResult(L,$,Pe,ve,I),Pe&&Pe.needsRenderFrame&&this._triggerRenderFrame()),(Pe||Te.isActive())&&(H[ve]=Te)}const te={};for(const ve in this._previousActiveHandlers)H[ve]||(te[ve]=I);this._previousActiveHandlers=H,(Object.keys(te).length||it(L))&&(this._changes.push([L,$,te]),this._triggerRenderFrame()),(Object.keys(H).length||it(L))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:fe}=L;fe&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],fe(this._map))}mergeHandlerResult(h,m,S,I,L){if(!S)return;s.extend(h,S);const $={handlerName:I,originalEvent:S.originalEvent||L};S.zoomDelta!==void 0&&(m.zoom=$),S.panDelta!==void 0&&(m.drag=$),S.pitchDelta!==void 0&&(m.pitch=$),S.bearingDelta!==void 0&&(m.rotate=$)}_applyChanges(){const h={},m={},S={};for(const[I,L,$]of this._changes)I.panDelta&&(h.panDelta=(h.panDelta||new s.Point(0,0))._add(I.panDelta)),I.zoomDelta&&(h.zoomDelta=(h.zoomDelta||0)+I.zoomDelta),I.bearingDelta&&(h.bearingDelta=(h.bearingDelta||0)+I.bearingDelta),I.pitchDelta&&(h.pitchDelta=(h.pitchDelta||0)+I.pitchDelta),I.around!==void 0&&(h.around=I.around),I.aroundCoord!==void 0&&(h.aroundCoord=I.aroundCoord),I.pinchAround!==void 0&&(h.pinchAround=I.pinchAround),I.noInertia&&(h.noInertia=I.noInertia),s.extend(m,L),s.extend(S,$);this._updateMapTransform(h,m,S),this._changes=[]}_updateMapTransform(h,m,S){const I=this._map,L=I.transform,$=Se=>[Se.x,Se.y,Se.z];if((Se=>{const Fe=this._eventsInProgress.drag;return Fe&&!this._handlersById[Fe.handlerName].isActive()})()&&!it(h)){const Se=L.zoom;L.cameraElevationReference="sea",L.recenterOnTerrain(),L.cameraElevationReference="ground",Se!==L.zoom&&this._map._update(!0)}if(L._isCameraConstrained&&I._stop(!0),!it(h))return void this._fireEvents(m,S,!0);let{panDelta:H,zoomDelta:Q,bearingDelta:ne,pitchDelta:te,around:fe,aroundCoord:ve,pinchAround:Te}=h;L._isCameraConstrained&&(Q>0&&(Q=0),L._isCameraConstrained=!1),Te!==void 0&&(fe=Te),(Q||(Se=>m[Se]&&!this._eventsInProgress[Se])("drag"))&&fe&&(this._dragOrigin=$(L.pointCoordinate3D(fe)),this._trackingEllipsoid.setup(L._camera.position,this._dragOrigin)),L.cameraElevationReference="sea",I._stop(!0),fe=fe||I.transform.centerPoint,ne&&(L.bearing+=ne),te&&(L.pitch+=te),L._updateCameraState();const Ie=[0,0,0];if(H)if(L.projection.name==="mercator"){const Se=this._trackingEllipsoid.projectRay(L.screenPointToMercatorRay(fe).dir),Fe=this._trackingEllipsoid.projectRay(L.screenPointToMercatorRay(fe.sub(H)).dir);Ie[0]=Fe[0]-Se[0],Ie[1]=Fe[1]-Se[1]}else{const Se=L.pointCoordinate(fe);if(L.projection.name==="globe"){H=H.rotate(-L.angle);const Fe=L._pixelsPerMercatorPixel/L.worldSize;Ie[0]=-H.x*s.mercatorScale(s.latFromMercatorY(Se.y))*Fe,Ie[1]=-H.y*s.mercatorScale(L.center.lat)*Fe}else{const Fe=L.pointCoordinate(fe.sub(H));Se&&Fe&&(Ie[0]=Fe.x-Se.x,Ie[1]=Fe.y-Se.y)}}const Pe=L.zoom,Le=[0,0,0];if(Q){const Se=$(ve||L.pointCoordinate3D(fe)),Fe={dir:s.normalize([],s.sub([],Se,L._camera.position))};if(Fe.dir[2]<0){const ke=L.zoomDeltaToMovement(Se,Q);s.scale$2(Le,Fe.dir,ke)}}const he=s.add(Ie,Ie,Le);L._translateCameraConstrained(he),Q&&Math.abs(L.zoom-Pe)>1e-4&&L.recenterOnTerrain(),L.cameraElevationReference="ground",this._map._update(),h.noInertia||this._inertia.record(h),this._fireEvents(m,S,!0)}_fireEvents(h,m,S){const I=Cn(this._eventsInProgress),L=Cn(h),$={};for(const te in h){const{originalEvent:fe}=h[te];this._eventsInProgress[te]||($[`${te}start`]=fe),this._eventsInProgress[te]=h[te]}!I&&L&&this._fireEvent("movestart",L.originalEvent);for(const te in $)this._fireEvent(te,$[te]);L&&this._fireEvent("move",L.originalEvent);for(const te in h){const{originalEvent:fe}=h[te];this._fireEvent(te,fe)}const H={};let Q;for(const te in this._eventsInProgress){const{handlerName:fe,originalEvent:ve}=this._eventsInProgress[te];this._handlersById[fe].isActive()||(delete this._eventsInProgress[te],Q=m[fe]||ve,H[`${te}end`]=Q)}for(const te in H)this._fireEvent(te,H[te]);const ne=Cn(this._eventsInProgress);if(S&&(I||L)&&!ne){this._updatingCamera=!0;const te=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),fe=ve=>ve!==0&&-this._bearingSnap<ve&&ve<this._bearingSnap;te?(fe(te.bearing||this._map.getBearing())&&(te.bearing=0),this._map.easeTo(te,{originalEvent:Q})):(this._map.fire(new s.Event("moveend",{originalEvent:Q})),fe(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(h,m){this._map.fire(new s.Event(h,m?{originalEvent:m}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(h=>{this._frameId=void 0,this.handleEvent(new Rt("renderFrame",{timeStamp:h})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Bn="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Pn extends s.Evented{constructor(h,m){super(),this._moving=!1,this._zooming=!1,this.transform=h,this._bearingSnap=m.bearingSnap,this._respectPrefersReducedMotion=m.respectPrefersReducedMotion!==!1,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(h,m){return this.jumpTo({center:h},m)}panBy(h,m,S){return h=s.Point.convert(h).mult(-1),this.panTo(this.transform.center,s.extend({offset:h},m),S)}panTo(h,m,S){return this.easeTo(s.extend({center:h},m),S)}getZoom(){return this.transform.zoom}setZoom(h,m){return this.jumpTo({zoom:h},m),this}zoomTo(h,m,S){return this.easeTo(s.extend({zoom:h},m),S)}zoomIn(h,m){return this.zoomTo(this.getZoom()+1,h,m),this}zoomOut(h,m){return this.zoomTo(this.getZoom()-1,h,m),this}getBearing(){return this.transform.bearing}setBearing(h,m){return this.jumpTo({bearing:h},m),this}getPadding(){return this.transform.padding}setPadding(h,m){return this.jumpTo({padding:h},m),this}rotateTo(h,m,S){return this.easeTo(s.extend({bearing:h},m),S)}resetNorth(h,m){return this.rotateTo(0,s.extend({duration:1e3},h),m),this}resetNorthPitch(h,m){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},h),m),this}snapToNorth(h,m){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(h,m):this}getPitch(){return this.transform.pitch}setPitch(h,m){return this.jumpTo({pitch:h},m),this}cameraForBounds(h,m){h=s.LngLatBounds.convert(h);const S=m&&m.bearing||0,I=m&&m.pitch||0,L=h.getNorthWest(),$=h.getSouthEast();return this._cameraForBounds(this.transform,L,$,S,I,m)}_extendCameraOptions(h){const m={top:0,bottom:0,right:0,left:0};if(typeof(h=s.extend({padding:m,offset:[0,0],maxZoom:this.transform.maxZoom},h)).padding=="number"){const S=h.padding;h.padding={top:S,bottom:S,right:S,left:S}}return h.padding=s.extend(m,h.padding),h}_minimumAABBFrustumDistance(h,m){const S=m.max[0]-m.min[0],I=m.max[1]-m.min[1];return S/I>h.aspect?S/(2*Math.tan(.5*h.fovX)*h.aspect):I/(2*Math.tan(.5*h.fovY)*h.aspect)}_cameraForBoundsOnGlobe(h,m,S,I,L,$){const H=h.clone(),Q=this._extendCameraOptions($);H.bearing=I,H.pitch=L;const ne=s.LngLat.convert(m),te=s.LngLat.convert(S),fe=.5*(ne.lat+te.lat),ve=.5*(ne.lng+te.lng),Te=s.latLngToECEF(fe,ve),Ie=s.normalize([],Te),Pe=s.normalize([],s.cross([],Ie,[0,1,0])),Le=s.cross([],Pe,Ie),he=[Pe[0],Pe[1],Pe[2],0,Le[0],Le[1],Le[2],0,Ie[0],Ie[1],Ie[2],0,0,0,0,1],Se=[Te,s.latLngToECEF(ne.lat,ne.lng),s.latLngToECEF(te.lat,ne.lng),s.latLngToECEF(te.lat,te.lng),s.latLngToECEF(ne.lat,te.lng),s.latLngToECEF(fe,ne.lng),s.latLngToECEF(fe,te.lng),s.latLngToECEF(ne.lat,ve),s.latLngToECEF(te.lat,ve)];let Fe=s.Aabb.fromPoints(Se.map(Ht=>[s.dot(Pe,Ht),s.dot(Le,Ht),s.dot(Ie,Ht)]));const ke=s.transformMat4([],Fe.center,he);s.squaredLength(ke)===0&&s.set(ke,0,0,1),s.normalize(ke,ke),s.scale$2(ke,ke,s.GLOBE_RADIUS),H.center=s.ecefToLatLng(ke);const Qe=H.getWorldToCameraMatrix(),et=s.invert(new Float64Array(16),Qe);Fe=s.Aabb.applyTransform(Fe,s.multiply([],Qe,he)),s.transformMat4(ke,ke,Qe);const Je=.5*(Fe.max[2]-Fe.min[2]),lt=this._minimumAABBFrustumDistance(H,Fe),st=s.scale$2([],[0,0,1],Je),xt=s.add(st,ke,st),en=lt+(H.pitch===0?0:s.distance(ke,xt)),mt=H.globeCenterInViewSpace,Ut=s.sub([],ke,[mt[0],mt[1],mt[2]]);s.normalize(Ut,Ut),s.scale$2(Ut,Ut,en);const St=s.add([],ke,Ut);s.transformMat4(St,St,et);const Kt=s.earthRadius/s.GLOBE_RADIUS,vt=s.length(St),zt=s.mercatorZfromAltitude(Math.max(vt*Kt-s.earthRadius,Number.EPSILON),0),nn=Math.min(H.zoomFromMercatorZAdjusted(zt),Q.maxZoom);return nn>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(H.setProjection({name:"mercator"}),H.zoom=nn,this._cameraForBounds(H,m,S,I,L,$)):{center:H.center,zoom:nn,bearing:I,pitch:L}}queryTerrainElevation(h,m){const S=this.transform.elevation;return S?(m=s.extend({},{exaggerated:!0},m),S.getAtPoint(s.MercatorCoordinate.fromLngLat(h),null,m.exaggerated)):null}_cameraForBounds(h,m,S,I,L,$){if(h.projection.name==="globe")return this._cameraForBoundsOnGlobe(h,m,S,I,L,$);const H=h.clone(),Q=this._extendCameraOptions($),ne=H.padding;H.bearing=I,H.pitch=L;const te=s.LngLat.convert(m),fe=s.LngLat.convert(S),ve=new s.LngLat(te.lng,fe.lat),Te=new s.LngLat(fe.lng,te.lat),Ie=H.project(te),Pe=H.project(fe),Le=this.queryTerrainElevation(te),he=this.queryTerrainElevation(fe),Se=this.queryTerrainElevation(ve),Fe=this.queryTerrainElevation(Te),ke=[[Ie.x,Ie.y,Math.min(Le||0,he||0,Se||0,Fe||0)],[Pe.x,Pe.y,Math.max(Le||0,he||0,Se||0,Fe||0)]];let Qe=s.Aabb.fromPoints(ke);const et=H.getWorldToCameraMatrix(),Je=s.invert(new Float64Array(16),et);Qe=s.Aabb.applyTransform(Qe,et);const lt=s.sub([],Qe.max,Qe.min),st=ne.left||0,xt=ne.right||0,en=ne.bottom||0,mt=ne.top||0,{left:Ut,right:St,top:Kt,bottom:vt}=Q.padding,zt=.5*(st+xt),nn=.5*(mt+en),Ht=Math.min(H.scaleZoom(H.scale*Math.min((H.width-(st+xt+Ut+St))/lt[0],(H.height-(en+mt+vt+Kt))/lt[1])),Q.maxZoom),an=H.scale/H.zoomScale(Ht);Qe=new s.Aabb([Qe.min[0]-(Ut+zt)*an,Qe.min[1]-(vt+nn)*an,Qe.min[2]],[Qe.max[0]+(St+zt)*an,Qe.max[1]+(Kt+nn)*an,Qe.max[2]]);const Wn=.5*lt[2],hr=this._minimumAABBFrustumDistance(H,Qe),kn=[0,0,1,0];s.transformMat4$1(kn,kn,et),s.normalize$2(kn,kn);const er=s.scale$2([],kn,hr+Wn),Fr=s.add([],Qe.center,er),Nr=(typeof Q.offset.x=="number"&&typeof Q.offset.y=="number"?new s.Point(Q.offset.x,Q.offset.y):s.Point.convert(Q.offset)).rotate(-s.degToRad(I));Qe.center[0]-=Nr.x*an,Qe.center[1]+=Nr.y*an,s.transformMat4(Qe.center,Qe.center,Je),s.transformMat4(Fr,Fr,Je);const Vn=[Qe.center[0],Qe.center[1],Fr[2]*H.pixelsPerMeter];s.scale$2(Vn,Vn,1/H.worldSize);const fi=s.lngFromMercatorX(Vn[0]),bi=s.latFromMercatorY(Vn[1]),wi=Math.min(H._zoomFromMercatorZ(Vn[2]),Q.maxZoom),Ei=new s.LngLat(fi,bi);return H.mercatorFromTransition&&wi<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(H.setProjection({name:"globe"}),H.zoom=wi,this._cameraForBounds(H,m,S,I,L,$)):{center:Ei,zoom:wi,bearing:I,pitch:L}}fitBounds(h,m,S){const I=this.cameraForBounds(h,m);return this._fitInternal(I,m,S)}fitScreenCoordinates(h,m,S,I,L){const $=s.Point.convert(h),H=s.Point.convert(m),Q=new s.Point(Math.min($.x,H.x),Math.min($.y,H.y)),ne=new s.Point(Math.max($.x,H.x),Math.max($.y,H.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge($,H))return this;const te=this.transform.pointLocation3D(Q),fe=this.transform.pointLocation3D(ne),ve=this.transform.pointLocation3D(new s.Point(Q.x,ne.y)),Te=this.transform.pointLocation3D(new s.Point(ne.x,Q.y)),Ie=[Math.min(te.lng,fe.lng,ve.lng,Te.lng),Math.min(te.lat,fe.lat,ve.lat,Te.lat)],Pe=[Math.max(te.lng,fe.lng,ve.lng,Te.lng),Math.max(te.lat,fe.lat,ve.lat,Te.lat)],Le=I&&I.pitch?I.pitch:this.getPitch(),he=this._cameraForBounds(this.transform,Ie,Pe,S,Le,I);return this._fitInternal(he,I,L)}_fitInternal(h,m,S){return h?(delete(m=s.extend(h,m)).padding,m.linear?this.easeTo(m,S):this.flyTo(m,S)):this}jumpTo(h,m){this.stop();const S=h.preloadOnly?this.transform.clone():this.transform;let I=!1,L=!1,$=!1;return"zoom"in h&&S.zoom!==+h.zoom&&(I=!0,S.zoom=+h.zoom),h.center!==void 0&&(S.center=s.LngLat.convert(h.center)),"bearing"in h&&S.bearing!==+h.bearing&&(L=!0,S.bearing=+h.bearing),"pitch"in h&&S.pitch!==+h.pitch&&($=!0,S.pitch=+h.pitch),h.padding==null||S.isPaddingEqual(h.padding)||(S.padding=h.padding),h.preloadOnly?(this._preloadTiles(S),this):(this.fire(new s.Event("movestart",m)).fire(new s.Event("move",m)),I&&this.fire(new s.Event("zoomstart",m)).fire(new s.Event("zoom",m)).fire(new s.Event("zoomend",m)),L&&this.fire(new s.Event("rotatestart",m)).fire(new s.Event("rotate",m)).fire(new s.Event("rotateend",m)),$&&this.fire(new s.Event("pitchstart",m)).fire(new s.Event("pitch",m)).fire(new s.Event("pitchend",m)),this.fire(new s.Event("moveend",m)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(Bn),this.transform.getFreeCameraOptions()}setFreeCameraOptions(h,m){const S=this.transform;if(!S.projection.supportsFreeCamera)return s.warnOnce(Bn),this;this.stop();const I=S.zoom,L=S.pitch,$=S.bearing;S.setFreeCameraOptions(h);const H=I!==S.zoom,Q=L!==S.pitch,ne=$!==S.bearing;return this.fire(new s.Event("movestart",m)).fire(new s.Event("move",m)),H&&this.fire(new s.Event("zoomstart",m)).fire(new s.Event("zoom",m)).fire(new s.Event("zoomend",m)),ne&&this.fire(new s.Event("rotatestart",m)).fire(new s.Event("rotate",m)).fire(new s.Event("rotateend",m)),Q&&this.fire(new s.Event("pitchstart",m)).fire(new s.Event("pitch",m)).fire(new s.Event("pitchend",m)),this.fire(new s.Event("moveend",m)),this}easeTo(h,m){this._stop(!1,h.easeId),((h=s.extend({offset:[0,0],duration:500,easing:s.ease},h)).animate===!1||this._prefersReducedMotion(h))&&(h.duration=0);const S=this.transform,I=this.getZoom(),L=this.getBearing(),$=this.getPitch(),H=this.getPadding(),Q="zoom"in h?+h.zoom:I,ne="bearing"in h?this._normalizeBearing(h.bearing,L):L,te="pitch"in h?+h.pitch:$,fe="padding"in h?h.padding:S.padding,ve=s.Point.convert(h.offset);let Te,Ie,Pe;if(S.projection.name==="globe"){const st=s.MercatorCoordinate.fromLngLat(S.center),xt=ve.rotate(-S.angle);st.x+=xt.x/S.worldSize,st.y+=xt.y/S.worldSize;const en=st.toLngLat(),mt=s.LngLat.convert(h.center||en);this._normalizeCenter(mt),Te=S.centerPoint.add(xt),Ie=new s.Point(st.x,st.y).mult(S.worldSize),Pe=new s.Point(s.mercatorXfromLng(mt.lng),s.mercatorYfromLat(mt.lat)).mult(S.worldSize).sub(Ie)}else{Te=S.centerPoint.add(ve);const st=S.pointLocation(Te),xt=s.LngLat.convert(h.center||st);this._normalizeCenter(xt),Ie=S.project(st),Pe=S.project(xt).sub(Ie)}const Le=S.zoomScale(Q-I);let he,Se;h.around&&(he=s.LngLat.convert(h.around),Se=S.locationPoint(he));const Fe=this._zooming||Q!==I,ke=this._rotating||L!==ne,Qe=this._pitching||te!==$,et=!S.isPaddingEqual(fe),Je=st=>xt=>{if(Fe&&(st.zoom=s.number(I,Q,xt)),ke&&(st.bearing=s.number(L,ne,xt)),Qe&&(st.pitch=s.number($,te,xt)),et&&(st.interpolatePadding(H,fe,xt),Te=st.centerPoint.add(ve)),he)st.setLocationAtPoint(he,Se);else{const en=st.zoomScale(st.zoom-I),mt=Q>I?Math.min(2,Le):Math.max(.5,Le),Ut=Math.pow(mt,1-xt),St=st.unproject(Ie.add(Pe.mult(xt*Ut)).mult(en));st.setLocationAtPoint(st.renderWorldCopies?St.wrap():St,Te)}return h.preloadOnly||this._fireMoveEvents(m),st};if(h.preloadOnly){const st=this._emulate(Je,h.duration,S);return this._preloadTiles(st),this}const lt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Fe,this._rotating=ke,this._pitching=Qe,this._padding=et,this._easeId=h.easeId,this._prepareEase(m,h.noMoveStart,lt),this._ease(Je(S),st=>{S.recenterOnTerrain(),this._afterEase(m,st)},h),this}_prepareEase(h,m,S={}){this._moving=!0,this.transform.cameraElevationReference="sea",m||S.moving||this.fire(new s.Event("movestart",h)),this._zooming&&!S.zooming&&this.fire(new s.Event("zoomstart",h)),this._rotating&&!S.rotating&&this.fire(new s.Event("rotatestart",h)),this._pitching&&!S.pitching&&this.fire(new s.Event("pitchstart",h))}_fireMoveEvents(h){this.fire(new s.Event("move",h)),this._zooming&&this.fire(new s.Event("zoom",h)),this._rotating&&this.fire(new s.Event("rotate",h)),this._pitching&&this.fire(new s.Event("pitch",h))}_afterEase(h,m){if(this._easeId&&m&&this._easeId===m)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const S=this._zooming,I=this._rotating,L=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,S&&this.fire(new s.Event("zoomend",h)),I&&this.fire(new s.Event("rotateend",h)),L&&this.fire(new s.Event("pitchend",h)),this.fire(new s.Event("moveend",h))}flyTo(h,m){if(this._prefersReducedMotion(h)){const Ht=s.pick(h,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Ht,m)}this.stop(),h=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},h);const S=this.transform,I=this.getZoom(),L=this.getBearing(),$=this.getPitch(),H=this.getPadding(),Q="zoom"in h?s.clamp(+h.zoom,S.minZoom,S.maxZoom):I,ne="bearing"in h?this._normalizeBearing(h.bearing,L):L,te="pitch"in h?+h.pitch:$,fe="padding"in h?h.padding:S.padding,ve=S.zoomScale(Q-I),Te=s.Point.convert(h.offset);let Ie=S.centerPoint.add(Te);const Pe=S.pointLocation(Ie),Le=s.LngLat.convert(h.center||Pe);this._normalizeCenter(Le);const he=S.project(Pe),Se=S.project(Le).sub(he);let Fe=h.curve;const ke=Math.max(S.width,S.height),Qe=ke/ve,et=Se.mag();if("minZoom"in h){const Ht=s.clamp(Math.min(h.minZoom,I,Q),S.minZoom,S.maxZoom),an=ke/S.zoomScale(Ht-I);Fe=Math.sqrt(an/et*2)}const Je=Fe*Fe;function lt(Ht){const an=(Qe*Qe-ke*ke+(Ht?-1:1)*Je*Je*et*et)/(2*(Ht?Qe:ke)*Je*et);return Math.log(Math.sqrt(an*an+1)-an)}function st(Ht){return(Math.exp(Ht)-Math.exp(-Ht))/2}function xt(Ht){return(Math.exp(Ht)+Math.exp(-Ht))/2}const en=lt(0);let mt=function(Ht){return xt(en)/xt(en+Fe*Ht)},Ut=function(Ht){return ke*((xt(en)*(st(an=en+Fe*Ht)/xt(an))-st(en))/Je)/et;var an},St=(lt(1)-en)/Fe;if(Math.abs(et)<1e-6||!isFinite(St)){if(Math.abs(ke-Qe)<1e-6)return this.easeTo(h,m);const Ht=Qe<ke?-1:1;St=Math.abs(Math.log(Qe/ke))/Fe,Ut=function(){return 0},mt=function(an){return Math.exp(Ht*Fe*an)}}h.duration="duration"in h?+h.duration:1e3*St/("screenSpeed"in h?+h.screenSpeed/Fe:+h.speed),h.maxDuration&&h.duration>h.maxDuration&&(h.duration=0);const Kt=L!==ne,vt=te!==$,zt=!S.isPaddingEqual(fe),nn=Ht=>an=>{const Wn=an*St,hr=1/mt(Wn);Ht.zoom=an===1?Q:I+Ht.scaleZoom(hr),Kt&&(Ht.bearing=s.number(L,ne,an)),vt&&(Ht.pitch=s.number($,te,an)),zt&&(Ht.interpolatePadding(H,fe,an),Ie=Ht.centerPoint.add(Te));const kn=an===1?Le:Ht.unproject(he.add(Se.mult(Ut(Wn))).mult(hr));return Ht.setLocationAtPoint(Ht.renderWorldCopies?kn.wrap():kn,Ie),Ht._updateCameraOnTerrain(),h.preloadOnly||this._fireMoveEvents(m),Ht};if(h.preloadOnly){const Ht=this._emulate(nn,h.duration,S);return this._preloadTiles(Ht),this}return this._zooming=!0,this._rotating=Kt,this._pitching=vt,this._padding=zt,this._prepareEase(m,!1),this._ease(nn(S),()=>this._afterEase(m),h),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(h,m){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const S=this._onEaseEnd;this._onEaseEnd=void 0,S.call(this,m)}if(!h){const S=this.handlers;S&&S.stop(!1)}return this}_ease(h,m,S){S.animate===!1||S.duration===0?(h(1),m()):(this._easeStart=s.exported.now(),this._easeOptions=S,this._onEaseFrame=h,this._onEaseEnd=m,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const h=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),m=this._onEaseFrame;m&&m(this._easeOptions.easing(h)),h<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(h,m){h=s.wrap(h,-180,180);const S=Math.abs(h-m);return Math.abs(h-360-m)<S&&(h-=360),Math.abs(h+360-m)<S&&(h+=360),h}_normalizeCenter(h){const m=this.transform;if(!m.renderWorldCopies||m.maxBounds)return;const S=h.lng-m.center.lng;h.lng+=S>180?-360:S<-180?360:0}_prefersReducedMotion(h){return this._respectPrefersReducedMotion&&s.exported.prefersReducedMotion&&!(h&&h.essential)}_emulate(h,m,S){const I=Math.ceil(15*m/1e3),L=[],$=h(S.clone());for(let H=0;H<=I;H++){const Q=$(H/I);L.push(Q.clone())}return L}}class Mt{constructor(h={}){this.options=h,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(h){const m=this.options&&this.options.compact;return this._map=h,this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=E("button","mapboxgl-ctrl-attrib-button",this._container),E("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=E("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),m&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),m===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(h,m){const S=this._map._getUIString(`AttributionControl.${m}`);h.setAttribute("aria-label",S),h.removeAttribute("title"),h.firstElementChild&&h.firstElementChild.setAttribute("title",S)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let h=this._editLink;h||(h=this._editLink=this._container.querySelector(".mapbox-improve-map"));const m=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(h){const S=m.reduce((I,L,$)=>(L.value&&(I+=`${L.key}=${L.value}${$<m.length-1?"&":""}`),I),"?");h.href=`${s.config.FEEDBACK_URL}/${S}#${Ep(this._map,!0)}`,h.rel="noopener nofollow",this._setElementTitle(h,"MapFeedback")}}_updateData(h){!h||h.sourceDataType!=="metadata"&&h.sourceDataType!=="visibility"&&h.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let h=[];if(this._map.style.stylesheet){const I=this._map.style.stylesheet;this.styleOwner=I.owner,this.styleId=I.id}const m=this._map.style._sourceCaches;for(const I in m){const L=m[I];if(L.used){const $=L.getSource();$.attribution&&h.indexOf($.attribution)<0&&h.push($.attribution)}}h.sort((I,L)=>I.length-L.length),h=h.filter((I,L)=>{for(let $=L+1;$<h.length;$++)if(h[$].indexOf(I)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?h=[...this.options.customAttribution,...h]:h.unshift(this.options.customAttribution));const S=h.join(" | ");S!==this._attribHTML&&(this._attribHTML=S,h.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class br{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(h){this._map=h,this._container=E("div","mapboxgl-ctrl");const m=E("a","mapboxgl-ctrl-logo");return m.target="_blank",m.rel="noopener nofollow",m.href="https://www.mapbox.com/",m.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),m.setAttribute("rel","noopener nofollow"),this._container.appendChild(m),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(h){h&&h.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const h=this._map.style._sourceCaches;if(Object.entries(h).length===0)return!0;for(const m in h){const S=h[m].getSource();if(S.hasOwnProperty("mapbox_logo")&&!S.mapbox_logo)return!1}return!0}_updateCompact(){const h=this._container.children;if(h.length){const m=h[0];this._map.getCanvasContainer().offsetWidth<250?m.classList.add("mapboxgl-compact"):m.classList.remove("mapboxgl-compact")}}}class ui{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(h){const m=++this._id;return this._queue.push({callback:h,id:m,cancelled:!1}),m}remove(h){const m=this._currentlyRunning,S=m?this._queue.concat(m):this._queue;for(const I of S)if(I.id===h)return void(I.cancelled=!0)}run(h=0){const m=this._currentlyRunning=this._queue;this._queue=[];for(const S of m)if(!S.cancelled&&(S.callback(h),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Vr(v,h,m){if(v=new s.LngLat(v.lng,v.lat),h){const S=new s.LngLat(v.lng-360,v.lat),I=new s.LngLat(v.lng+360,v.lat),L=360*Math.ceil(Math.abs(v.lng-m.center.lng)/360),$=m.locationPoint(v).distSqr(h),H=h.x<0||h.y<0||h.x>m.width||h.y>m.height;m.locationPoint(S).distSqr(h)<$&&(H||Math.abs(S.lng-m.center.lng)<L)?v=S:m.locationPoint(I).distSqr(h)<$&&(H||Math.abs(I.lng-m.center.lng)<L)&&(v=I)}for(;Math.abs(v.lng-m.center.lng)>180;){const S=m.locationPoint(v);if(S.x>=0&&S.y>=0&&S.x<=m.width&&S.y<=m.height)break;v.lng>m.center.lng?v.lng-=360:v.lng+=360}return v}const Jr={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class qt extends s.Evented{constructor(h,m){if(super(),(h instanceof s.window.HTMLElement||m)&&(h=s.extend({element:h},m)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=h&&h.anchor||"center",this._color=h&&h.color||"#3FB1CE",this._scale=h&&h.scale||1,this._draggable=h&&h.draggable||!1,this._clickTolerance=h&&h.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=h&&h.rotation||0,this._rotationAlignment=h&&h.rotationAlignment||"auto",this._pitchAlignment=h&&h.pitchAlignment&&h.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=h&&h.occludedOpacity||.2,h&&h.element)this._element=h.element,this._offset=s.Point.convert(h&&h.offset||[0,0]);else{this._defaultMarker=!0,this._element=E("div");const I=41,L=27,$=P("svg",{display:"block",height:I*this._scale+"px",width:L*this._scale+"px",viewBox:`0 0 ${L} ${I}`},this._element),H=P("radialGradient",{id:"shadowGradient"},P("defs",{},$));P("stop",{offset:"10%","stop-opacity":.4},H),P("stop",{offset:"100%","stop-opacity":.05},H),P("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},$),P("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},$),P("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},$),P("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},$),this._offset=s.Point.convert(h&&h.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",I=>{I.preventDefault()}),this._element.addEventListener("mousedown",I=>{I.preventDefault()});const S=this._element.classList;for(const I in Jr)S.remove(`mapboxgl-marker-anchor-${I}`);S.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(h){return h===this._map||(this.remove(),this._map=h,h.getCanvasContainer().appendChild(this._element),h.on("move",this._updateMoving),h.on("moveend",this._update),h.on("remove",this._clearFadeTimer),h._addMarker(this),this.setDraggable(this._draggable),this._update(),h.on("click",this._onMapClick)),this}remove(){const h=this._map;return h&&(h.off("click",this._onMapClick),h.off("move",this._updateMoving),h.off("moveend",this._update),h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler),h.off("mouseup",this._onUp),h.off("touchend",this._onUp),h.off("mousemove",this._onMove),h.off("touchmove",this._onMove),h.off("remove",this._clearFadeTimer),h._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(h){return this._lngLat=s.LngLat.convert(h),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(h){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),h){if(!("offset"in h.options)){const I=Math.sqrt(Math.pow(13.5,2)/2);h.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[I,-1*(38.1-13.5+I)],"bottom-right":[-I,-1*(38.1-13.5+I)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=h,h._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(h){const m=h.code,S=h.charCode||h.keyCode;m!=="Space"&&m!=="Enter"&&S!==32&&S!==13||this.togglePopup()}_onMapClick(h){const m=h.originalEvent.target,S=this._element;this._popup&&(m===S||S.contains(m))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const h=this._popup;return h?(h.isOpen()?(h.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(h.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const h=this._map,m=this._pos;if(!h||!m)return!1;const S=h.unproject(m),I=h.getFreeCameraOptions();if(!I.position)return!1;const L=I.position.toLngLat();return L.distanceTo(S)<.9*L.distanceTo(this._lngLat)}_evaluateOpacity(){const h=this._map;if(!h)return;const m=this._pos;if(!m||m.x<0||m.x>h.transform.width||m.y<0||m.y>h.transform.height)return void this._clearFadeTimer();const S=h.unproject(m);let I;h._showingGlobe()&&s.isLngLatBehindGlobe(h.transform,this._lngLat)?I=0:(I=1-h._queryFogOpacity(S),h.transform._terrainEnabled()&&h.getTerrain()&&this._behindTerrain()&&(I*=this._occludedOpacity)),this._element.style.opacity=`${I}`,this._element.style.pointerEvents=I>0?"auto":"none",this._popup&&this._popup._setOpacity(I),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const h=this._pos;if(!h||!this._map)return;const m=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${h.x}px,${h.y}px)
            ${Jr[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${m.x}px,${m.y}px)
        `}_calculateXYTransform(){const h=this._pos,m=this._map,S=this.getPitchAlignment();if(!m||!h||S!=="map")return"";if(!m._showingGlobe()){const Q=m.getPitch();return Q?`rotateX(${Q}deg)`:""}const I=s.radToDeg(s.globeTiltAtLngLat(m.transform,this._lngLat)),L=h.sub(s.globeCenterToScreenPoint(m.transform)),$=Math.abs(L.x)+Math.abs(L.y);if($===0)return"";const H=I/$;return`rotateX(${-L.y*H}deg) rotateY(${L.x*H}deg)`}_calculateZTransform(){const h=this._pos,m=this._map;if(!m||!h)return"";let S=0;const I=this.getRotationAlignment();if(I==="map")if(m._showingGlobe()){const L=m.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),$=m.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(L);S=s.radToDeg(Math.atan2($.y,$.x))-90}else S=-m.getBearing();else if(I==="horizon"){const L=s.smoothstep(4,6,m.getZoom()),$=s.globeCenterToScreenPoint(m.transform);$.y+=L*m.transform.height;const H=h.sub($),Q=s.radToDeg(Math.atan2(H.y,H.x));S=(Q>90?Q-270:Q+90)*(1-L)}return S+=this._rotation,S?`rotateZ(${S}deg)`:""}_update(h){s.window.cancelAnimationFrame(this._updateFrameId);const m=this._map;m&&(m.transform.renderWorldCopies&&(this._lngLat=Vr(this._lngLat,this._pos,m.transform)),this._pos=m.project(this._lngLat),h===!0?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),m._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(m._showingGlobe()||m.getTerrain()||m.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(h){return this._offset=s.Point.convert(h),this._update(),this}_onMove(h){const m=this._map;if(!m)return;const S=this._pointerdownPos,I=this._positionDelta;if(S&&I){if(!this._isDragging){const L=this._clickTolerance||m._clickTolerance;if(h.point.dist(S)<L)return;this._isDragging=!0}this._pos=h.point.sub(I),this._lngLat=m.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const h=this._map;h&&(h.off("mousemove",this._onMove),h.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(h){const m=this._map,S=this._pos;m&&S&&this._element.contains(h.originalEvent.target)&&(h.preventDefault(),this._positionDelta=h.point.sub(S),this._pointerdownPos=h.point,this._state="pending",m.on("mousemove",this._onMove),m.on("touchmove",this._onMove),m.once("mouseup",this._onUp),m.once("touchend",this._onUp))}setDraggable(h){this._draggable=!!h;const m=this._map;return m&&(h?(m.on("mousedown",this._addDragHandler),m.on("touchstart",this._addDragHandler)):(m.off("mousedown",this._addDragHandler),m.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(h){return this._rotation=h||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(h){return this._rotationAlignment=h||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(h){return this._pitchAlignment=h||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(h){return this._occludedOpacity=h||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const xi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},$i=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function gr(v=new s.Point(0,0),h="bottom"){if(typeof v=="number"){const m=Math.round(Math.sqrt(.5*Math.pow(v,2)));switch(h){case"top":return new s.Point(0,v);case"top-left":return new s.Point(m,m);case"top-right":return new s.Point(-m,m);case"bottom":return new s.Point(0,-v);case"bottom-left":return new s.Point(m,-m);case"bottom-right":return new s.Point(-m,-m);case"left":return new s.Point(v,0);case"right":return new s.Point(-v,0)}return new s.Point(0,0)}return v instanceof s.Point||Array.isArray(v)?s.Point.convert(v):s.Point.convert(v[h]||[0,0])}class dx{constructor(h){this.jumpTo(h)}getValue(h){if(h<=this._startTime)return this._start;if(h>=this._endTime)return this._end;const m=s.easeCubicInOut((h-this._startTime)/(this._endTime-this._startTime));return this._start*(1-m)+this._end*m}isEasing(h){return h>=this._startTime&&h<=this._endTime}jumpTo(h){this._startTime=-1/0,this._endTime=-1/0,this._start=h,this._end=h}easeTo(h,m,S){this._start=this.getValue(m),this._end=h,this._startTime=m,this._endTime=m+S}}const w2={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},E2={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},ZL={showCompass:!0,showZoom:!0,visualizePitch:!1};class YL{constructor(h,m,S=!1){this._clickTolerance=10,this.element=m,this.mouseRotate=new Jh({clickTolerance:h.dragRotate._mouseRotate._clickTolerance}),this.map=h,S&&(this.mousePitch=new ed({clickTolerance:h.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),m.addEventListener("mousedown",this.mousedown),m.addEventListener("touchstart",this.touchstart,{passive:!1}),m.addEventListener("touchmove",this.touchmove),m.addEventListener("touchend",this.touchend),m.addEventListener("touchcancel",this.reset)}down(h,m){this.mouseRotate.mousedown(h,m),this.mousePitch&&this.mousePitch.mousedown(h,m),k()}move(h,m){const S=this.map,I=this.mouseRotate.mousemoveWindow(h,m),L=I&&I.bearingDelta;if(L&&S.setBearing(S.getBearing()+L),this.mousePitch){const $=this.mousePitch.mousemoveWindow(h,m),H=$&&$.pitchDelta;H&&S.setPitch(S.getPitch()+H)}}off(){const h=this.element;h.removeEventListener("mousedown",this.mousedown),h.removeEventListener("touchstart",this.touchstart,{passive:!1}),h.removeEventListener("touchmove",this.touchmove),h.removeEventListener("touchend",this.touchend),h.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){F(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(h){this.down(s.extend({},h,{ctrlKey:!0,preventDefault:()=>h.preventDefault()}),Y(this.element,h)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(h){this.move(h,Y(this.element,h))}mouseup(h){this.mouseRotate.mouseupWindow(h),this.mousePitch&&this.mousePitch.mouseupWindow(h),this.offTemp()}touchstart(h){h.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=J(this.element,h.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>h.preventDefault()},this._startPos))}touchmove(h){h.targetTouches.length!==1?this.reset():(this._lastPos=J(this.element,h.targetTouches)[0],this.move({preventDefault:()=>h.preventDefault()},this._lastPos))}touchend(h){h.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const px={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},gx={maxWidth:100,unit:"metric"},mx={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Zg={version:s.version,supported:d,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends Pn{constructor(v){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),(v=s.extend({},E2,v)).minZoom!=null&&v.maxZoom!=null&&v.minZoom>v.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(v.minPitch!=null&&v.maxPitch!=null&&v.minPitch>v.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(v.minPitch!=null&&v.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(v.maxPitch!=null&&v.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(v.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(v.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Zi(v.minZoom,v.maxZoom,v.minPitch,v.maxPitch,v.renderWorldCopies),v),this._interactive=v.interactive,this._minTileCacheSize=v.minTileCacheSize,this._maxTileCacheSize=v.maxTileCacheSize,this._failIfMajorPerformanceCaveat=v.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=v.preserveDrawingBuffer,this._antialias=v.antialias,this._useWebGL2=v.useWebGL2,this._trackResize=v.trackResize,this._bearingSnap=v.bearingSnap,this._refreshExpiredTiles=v.refreshExpiredTiles,this._fadeDuration=v.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=v.crossSourceCollisions,this._collectResourceTiming=v.collectResourceTiming,this._optimizeForTerrain=v.optimizeForTerrain,this._language=this._parseLanguage(v.language),this._worldview=v.worldview,this._renderTaskQueue=new ui,this._domRenderTaskQueue=new ui,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},w2,v.locale),this._clickTolerance=v.clickTolerance,this._cooperativeGestures=v.cooperativeGestures,this._performanceMetricsCollection=v.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new dx(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(v.transformRequest,v.accessToken,v.testMode),this._silenceAuthErrors=!!v.testMode,typeof v.container=="string"){if(this._container=s.window.document.getElementById(v.container),!this._container)throw new Error(`Container '${v.container}' not found.`)}else{if(!(v.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=v.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),v.maxBounds&&this.setMaxBounds(v.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),s.window!==void 0&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new On(this,v),this._localFontFamily=v.localFontFamily,this._localIdeographFontFamily=v.localIdeographFontFamily,v.style&&this.setStyle(v.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),v.projection&&this.setProjection(v.projection),this._hash=v.hash&&new $A(typeof v.hash=="string"&&v.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:v.center,zoom:v.zoom,bearing:v.bearing,pitch:v.pitch}),v.bounds&&(this.resize(),this.fitBounds(v.bounds,s.extend({},v.fitBoundsOptions,{duration:0})))),this.resize(),v.attributionControl&&this.addControl(new Mt({customAttribution:v.customAttribution})),this._logoControl=new br,this.addControl(this._logoControl,v.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",h=>{this._update(h.dataType==="style"),this.fire(new s.Event(`${h.dataType}data`,h))}),this.on("dataloading",h=>{this.fire(new s.Event(`${h.dataType}dataloading`,h))})}_getMapId(){return this._mapId}addControl(v,h){if(h===void 0&&(h=v.getDefaultPosition?v.getDefaultPosition():"top-right"),!v||!v.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const m=v.onAdd(this);this._controls.push(v);const S=this._controlPositions[h];return h.indexOf("bottom")!==-1?S.insertBefore(m,S.firstChild):S.appendChild(m),this}removeControl(v){if(!v||!v.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const h=this._controls.indexOf(v);return h>-1&&this._controls.splice(h,1),v.onRemove(this),this}hasControl(v){return this._controls.indexOf(v)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(v){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const h=!this._moving;return h&&this.fire(new s.Event("movestart",v)).fire(new s.Event("move",v)),this.fire(new s.Event("resize",v)),h&&this.fire(new s.Event("moveend",v)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(v){return this.transform.setMaxBounds(s.LngLatBounds.convert(v)),this._update()}setMinZoom(v){if((v=v??-2)>=-2&&v<=this.transform.maxZoom)return this.transform.minZoom=v,this._update(),this.getZoom()<v?this.setZoom(v):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(v){if((v=v??22)>=this.transform.minZoom)return this.transform.maxZoom=v,this._update(),this.getZoom()>v?this.setZoom(v):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(v){if((v=v??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(v>=0&&v<=this.transform.maxPitch)return this.transform.minPitch=v,this._update(),this.getPitch()<v?this.setPitch(v):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(v){if((v=v??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(v>=this.transform.minPitch)return this.transform.maxPitch=v,this._update(),this.getPitch()>v?this.setPitch(v):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(v){return this.transform.renderWorldCopies=v,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(v){return v==="auto"?s.window.navigator.language:Array.isArray(v)?v.length===0?void 0:v.map(h=>h==="auto"?s.window.navigator.language:h):v}setLanguage(v){const h=this._parseLanguage(v);if(!this.style||h===this._language)return this;this._language=h,this.style._reloadSources();for(const m of this._controls)m._setLanguage&&m._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(v){return this.style&&v!==this._worldview?(this._worldview=v,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(v){return this._lazyInitEmptyStyle(),v?typeof v=="string"&&(v={name:v}):v=null,this._useExplicitProjection=!!v,this._prioritizeAndUpdateProjection(v,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const v=this.transform,h=v.projection.name;let m;h==="globe"&&v.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(v.setMercatorFromTransition(),m=!0):h==="mercator"&&v.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(v.setProjection({name:"globe"}),m=!0),m&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(v,h){return this._updateProjection(v||h||{name:"mercator"})}_updateProjection(v){let h;if(h=v.name==="globe"&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(v),this.style.applyProjectionUpdate(),h){this.painter.clearBackgroundTiles();for(const m in this.style._sourceCaches)this.style._sourceCaches[m].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(v){return this.transform.locationPoint3D(s.LngLat.convert(v))}unproject(v){return this.transform.pointLocation3D(s.Point.convert(v))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(v,h,m){if(v==="mouseenter"||v==="mouseover"){let S=!1;const I=$=>{const H=h.filter(ne=>this.getLayer(ne)),Q=H.length?this.queryRenderedFeatures($.point,{layers:H}):[];Q.length?S||(S=!0,m.call(this,new hs(v,this,$.originalEvent,{features:Q}))):S=!1},L=()=>{S=!1};return{layers:new Set(h),listener:m,delegates:{mousemove:I,mouseout:L}}}if(v==="mouseleave"||v==="mouseout"){let S=!1;const I=$=>{const H=h.filter(Q=>this.getLayer(Q));(H.length?this.queryRenderedFeatures($.point,{layers:H}):[]).length?S=!0:S&&(S=!1,m.call(this,new hs(v,this,$.originalEvent)))},L=$=>{S&&(S=!1,m.call(this,new hs(v,this,$.originalEvent)))};return{layers:new Set(h),listener:m,delegates:{mousemove:I,mouseout:L}}}{const S=I=>{const L=h.filter(H=>this.getLayer(H)),$=L.length?this.queryRenderedFeatures(I.point,{layers:L}):[];$.length&&(I.features=$,m.call(this,I),delete I.features)};return{layers:new Set(h),listener:m,delegates:{[v]:S}}}}on(v,h,m){if(m===void 0)return super.on(v,h);Array.isArray(h)||(h=[h]);const S=this._createDelegatedListener(v,h,m);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[v]=this._delegatedListeners[v]||[],this._delegatedListeners[v].push(S);for(const I in S.delegates)this.on(I,S.delegates[I]);return this}once(v,h,m){if(m===void 0)return super.once(v,h);Array.isArray(h)||(h=[h]);const S=this._createDelegatedListener(v,h,m);for(const I in S.delegates)this.once(I,S.delegates[I]);return this}off(v,h,m){if(m===void 0)return super.off(v,h);h=new Set(Array.isArray(h)?h:[h]);const S=(L,$)=>{if(L.size!==$.size)return!1;for(const H of L)if(!$.has(H))return!1;return!0},I=this._delegatedListeners?this._delegatedListeners[v]:void 0;return I&&(L=>{for(let $=0;$<L.length;$++){const H=L[$];if(H.listener===m&&S(H.layers,h)){for(const Q in H.delegates)this.off(Q,H.delegates[Q]);return L.splice($,1),this}}})(I),this}queryRenderedFeatures(v,h){return this.style?(h!==void 0||v===void 0||v instanceof s.Point||Array.isArray(v)||(h=v,v=void 0),this.style.queryRenderedFeatures(v=v||[[0,0],[this.transform.width,this.transform.height]],h=h||{},this.transform)):[]}querySourceFeatures(v,h){return this.style.querySourceFeatures(v,h)}isPointOnSurface(v){const{name:h}=this.transform.projection;return h!=="globe"&&h!=="mercator"&&s.warnOnce(`${h} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.Point.convert(v))}setStyle(v,h){return(h=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},h)).diff!==!1&&h.localIdeographFontFamily===this._localIdeographFontFamily&&h.localFontFamily===this._localFontFamily&&this.style&&v?(this._diffStyle(v,h),this):(this._localIdeographFontFamily=h.localIdeographFontFamily,this._localFontFamily=h.localFontFamily,this._updateStyle(v,h))}_getUIString(v){const h=this._locale[v];if(h==null)throw new Error(`Missing UI string '${v}'`);return h}_updateStyle(v,h){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),v&&(this.style=new Ds(this,h||{}),this.style.setEventedParent(this,{style:this.style}),typeof v=="string"?this.style.loadURL(v):this.style.loadJSON(v)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ds(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(v,h){if(typeof v=="string"){const m=this._requestManager.normalizeStyleURL(v),S=this._requestManager.transformRequest(m,s.ResourceType.Style);s.getJSON(S,(I,L)=>{I?this.fire(new s.ErrorEvent(I)):L&&this._updateDiff(L,h)})}else typeof v=="object"&&this._updateDiff(v,h)}_updateDiff(v,h){try{this.style.setState(v)&&this._update(!0)}catch(m){s.warnOnce(`Unable to perform style diff: ${m.message||m.error||m}.  Rebuilding the style from scratch.`),this._updateStyle(v,h)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(v,h){return this._lazyInitEmptyStyle(),this.style.addSource(v,h),this._update(!0)}isSourceLoaded(v){return!!this.style&&this.style._isSourceCacheLoaded(v)}areTilesLoaded(){const v=this.style&&this.style._sourceCaches;for(const h in v){const m=v[h]._tiles;for(const S in m){const I=m[S];if(I.state!=="loaded"&&I.state!=="errored")return!1}}return!0}addSourceType(v,h,m){this._lazyInitEmptyStyle(),this.style.addSourceType(v,h,m)}removeSource(v){return this.style.removeSource(v),this._updateTerrain(),this._update(!0)}getSource(v){return this.style.getSource(v)}addImage(v,h,{pixelRatio:m=1,sdf:S=!1,stretchX:I,stretchY:L,content:$}={}){if(this._lazyInitEmptyStyle(),h instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&h instanceof s.window.ImageBitmap){const{width:H,height:Q,data:ne}=s.exported.getImageData(h);this.style.addImage(v,{data:new s.RGBAImage({width:H,height:Q},ne),pixelRatio:m,stretchX:I,stretchY:L,content:$,sdf:S,version:0})}else if(h.width===void 0||h.height===void 0)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:H,height:Q}=h,ne=h;this.style.addImage(v,{data:new s.RGBAImage({width:H,height:Q},new Uint8Array(ne.data)),pixelRatio:m,stretchX:I,stretchY:L,content:$,sdf:S,version:0,userImage:ne}),ne.onAdd&&ne.onAdd(this,v)}}updateImage(v,h){const m=this.style.getImage(v);if(!m)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const S=h instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&h instanceof s.window.ImageBitmap?s.exported.getImageData(h):h,{width:I,height:L}=S;I!==void 0&&L!==void 0?I===m.data.width&&L===m.data.height?(m.data.replace(S.data,!(h instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&h instanceof s.window.ImageBitmap)),this.style.updateImage(v,m)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${I}, ${L})
                must be that same as the previous version of the image
                (${m.data.width}, ${m.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(v){return v?!!this.style.getImage(v):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(v){this.style.removeImage(v)}loadImage(v,h){s.getImage(this._requestManager.transformRequest(v,s.ResourceType.Image),(m,S)=>{h(m,S instanceof s.window.HTMLImageElement?s.exported.getImageData(S):S)})}listImages(){return this.style.listImages()}addLayer(v,h){return this._lazyInitEmptyStyle(),this.style.addLayer(v,h),this._update(!0)}moveLayer(v,h){return this.style.moveLayer(v,h),this._update(!0)}removeLayer(v){return this.style.removeLayer(v),this._update(!0)}getLayer(v){return this.style.getLayer(v)}setLayerZoomRange(v,h,m){return this.style.setLayerZoomRange(v,h,m),this._update(!0)}setFilter(v,h,m={}){return this.style.setFilter(v,h,m),this._update(!0)}getFilter(v){return this.style.getFilter(v)}setPaintProperty(v,h,m,S={}){return this.style.setPaintProperty(v,h,m,S),this._update(!0)}getPaintProperty(v,h){return this.style.getPaintProperty(v,h)}setLayoutProperty(v,h,m,S={}){return this.style.setLayoutProperty(v,h,m,S),this._update(!0)}getLayoutProperty(v,h){return this.style.getLayoutProperty(v,h)}setLight(v,h={}){return this._lazyInitEmptyStyle(),this.style.setLight(v,h),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(v){return this._lazyInitEmptyStyle(),!v&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(v),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(v){return this._lazyInitEmptyStyle(),this.style.setFog(v),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(v){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(v),this.transform):0}setFeatureState(v,h){return this.style.setFeatureState(v,h),this._update()}removeFeatureState(v,h){return this.style.removeFeatureState(v,h),this._update()}getFeatureState(v){return this.style.getFeatureState(v)}_updateContainerDimensions(){if(!this._container)return;const v=this._container.getBoundingClientRect().width||400,h=this._container.getBoundingClientRect().height||300;let m,S,I,L=this._container;for(;L&&(!S||!I);){const $=s.window.getComputedStyle(L).transform;$&&$!=="none"&&(m=$.match(/matrix.*\((.+)\)/)[1].split(", "),m[0]&&m[0]!=="0"&&m[0]!=="1"&&(S=m[0]),m[3]&&m[3]!=="0"&&m[3]!=="1"&&(I=m[3])),L=L.parentElement}this._containerWidth=S?Math.abs(v/S):v,this._containerHeight=I?Math.abs(h/I):h}_detectMissingCSS(){s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const v=this._container;v.classList.add("mapboxgl-map"),(this._missingCSSCanary=E("div","mapboxgl-canary",v)).style.visibility="hidden",this._detectMissingCSS();const h=this._canvasContainer=E("div","mapboxgl-canvas-container",v);this._interactive&&h.classList.add("mapboxgl-interactive"),this._canvas=E("canvas","mapboxgl-canvas",h),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const m=this._controlContainer=E("div","mapboxgl-control-container",v),S=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(I=>{S[I]=E("div",`mapboxgl-ctrl-${I}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(v,h){const m=s.exported.devicePixelRatio||1;this._canvas.width=m*Math.ceil(v),this._canvas.height=m*Math.ceil(h),this._canvas.style.width=`${v}px`,this._canvas.style.height=`${h}px`}_addMarker(v){this._markers.push(v)}_removeMarker(v){const h=this._markers.indexOf(v);h!==-1&&this._markers.splice(h,1)}_addPopup(v){this._popups.push(v)}_removePopup(v){const h=this._popups.indexOf(v);h!==-1&&this._popups.splice(h,1)}_setupPainter(){const v=s.extend({},d.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),h=this._useWebGL2&&this._canvas.getContext("webgl2",v),m=h||this._canvas.getContext("webgl",v)||this._canvas.getContext("experimental-webgl",v);m?(this._useWebGL2&&!h&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(m,!0),this.painter=new jc(m,this.transform,!!h),this.on("data",S=>{S.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(m)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(v){v.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:v}))}_contextRestored(v){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:v}))}_onMapScroll(v){if(v.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(v){return this.style?(this._styleDirty=this._styleDirty||v,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(v){return this._update(),this._renderTaskQueue.add(v)}_cancelRenderFrame(v){this._renderTaskQueue.remove(v)}_requestDomTask(v){!this.loaded()||this.loaded()&&!this.isMoving()?v():this._domRenderTaskQueue.add(v)}_render(v){let h;const m=this.painter.context.extTimerQuery,S=s.exported.now();if(this.listens("gpu-timing-frame")&&(h=m.createQueryEXT(),m.beginQueryEXT(m.TIME_ELAPSED_EXT,h)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(v),this._domRenderTaskQueue.run(v),this._removed)return;this._updateProjectionTransition();const I=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const H=this.transform.zoom,Q=this.transform.pitch,ne=s.exported.now(),te=new s.EvaluationParameters(H,{now:ne,fadeDuration:I,pitch:Q,transition:this.style.getTransition()});this.style.update(te)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let L=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),L=this._updateAverageElevation(S),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):L=this._updateAverageElevation(S),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,I,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:I,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),h){const H=s.exported.now()-S;m.endQueryEXT(m.TIME_ELAPSED_EXT,h),setTimeout(()=>{const Q=m.getQueryObjectEXT(h,m.QUERY_RESULT_EXT)/1e6;m.deleteQueryEXT(h),this.fire(new s.Event("gpu-timing-frame",{cpuTime:H,gpuTime:Q})),s.window.performance.mark("frame-gpu",{startTime:S,detail:{gpuTime:Q}})},50)}if(this.listens("gpu-timing-layer")){const H=this.painter.collectGpuTimers();setTimeout(()=>{const Q=this.painter.queryGpuTimers(H);this.fire(new s.Event("gpu-timing-layer",{layerTimes:Q}))},50)}if(this.listens("gpu-timing-deferred-render")){const H=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const Q=this.painter.queryGpuTimeDeferredRender(H);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:Q}))},50)}const $=this._sourcesDirty||this._styleDirty||this._placementDirty||L;if($||this._repaint)this.triggerRepaint();else{const H=!this.isMoving()&&this.loaded();if(H&&(L=this._updateAverageElevation(S,!0)),L)this.triggerRepaint();else if(this._triggerFrame(!1),H&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const Q=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:Q})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||$||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(v){for(const h of this._markers)v&&!this.getRenderWorldCopies()&&(h._lngLat=h._lngLat.wrap()),h._update();for(const h of this._popups)!v||this.getRenderWorldCopies()||h._trackPointer||(h._lngLat=h._lngLat.wrap()),h._update()}_updateAverageElevation(v,h=!1){const m=S=>(this.transform.averageElevation=S,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&m(0);if((h||v-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(v)){const S=this.transform.averageElevation;let I=this.transform.sampleAverageElevation(),L=!1;this.transform.elevation&&(L=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(I)?I=0:this._averageElevationLastSampledAt=v;const $=Math.abs(S-I);if($>1){if(this._isInitialLoad||L)return this._averageElevation.jumpTo(I),m(I);this._averageElevation.easeTo(I,v,300)}else if($>1e-4)return this._averageElevation.jumpTo(I),m(I)}return!!this._averageElevation.isEasing(v)&&m(this._averageElevation.getValue(v))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,v=>{if(v&&(v.message===s.AUTH_ERR_MSG||v.status===401)){const h=this.painter.context.gl;s.storeAuthState(h,!1),this._logoControl instanceof br&&this._logoControl._updateLogo(),h&&h.clear(h.DEPTH_BUFFER_BIT|h.COLOR_BUFFER_BIT|h.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const v=this._isDragging();this.painter.updateTerrain(this.style,v)}_calculateSpeedIndex(){const v=this.painter.canvasCopy(),h=this.painter.getCanvasCopiesAndTimestamps();h.timeStamps.push(performance.now());const m=this.painter.context.gl,S=m.createFramebuffer();function I(L){m.framebufferTexture2D(m.FRAMEBUFFER,m.COLOR_ATTACHMENT0,m.TEXTURE_2D,L,0);const $=new Uint8Array(m.drawingBufferWidth*m.drawingBufferHeight*4);return m.readPixels(0,0,m.drawingBufferWidth,m.drawingBufferHeight,m.RGBA,m.UNSIGNED_BYTE,$),$}return m.bindFramebuffer(m.FRAMEBUFFER,S),this._canvasPixelComparison(I(v),h.canvasCopies.map(I),h.timeStamps)}_canvasPixelComparison(v,h,m){let S=m[1]-m[0];const I=v.length/4;for(let L=0;L<h.length;L++){const $=h[L];let H=0;for(let Q=0;Q<$.length;Q+=4)$[Q]===v[Q]&&$[Q+1]===v[Q+1]&&$[Q+2]===v[Q+2]&&$[Q+3]===v[Q+3]&&(H+=1);S+=(m[L+2]-m[L+1])*(1-H/I)}return S}remove(){this._hash&&this._hash.remove();for(const h of this._controls)h.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),s.window!==void 0&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const v=this.painter.context.gl.getExtension("WEBGL_lose_context");v&&v.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(v){this._renderNextFrame=this._renderNextFrame||v,this.style&&!this._frame&&(this._frame=s.exported.frame(h=>{const m=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,m&&this._render(h)}))}_preloadTiles(v){const h=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(h,(m,S)=>m._preloadTiles(v,S),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(v){this._trackResize&&this.resize({originalEvent:v})._update()}_onVisibilityChange(){s.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(v){this._showTileBoundaries!==v&&(this._showTileBoundaries=v,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(v){this._showTerrainWireframe!==v&&(this._showTerrainWireframe=v,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(v){this._speedIndexTiming!==v&&(this._speedIndexTiming=v,this._update())}get showPadding(){return!!this._showPadding}set showPadding(v){this._showPadding!==v&&(this._showPadding=v,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(v){this._showCollisionBoxes!==v&&(this._showCollisionBoxes=v,v?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(v){this._showOverdrawInspector!==v&&(this._showOverdrawInspector=v,this._update())}get repaint(){return!!this._repaint}set repaint(v){this._repaint!==v&&(this._repaint=v,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(v){this._vertices=v,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(v){this._showTileAABBs!==v&&(this._showTileAABBs=v,v&&this._update())}_setCacheLimits(v,h){s.setCacheLimits(v,h)}get version(){return s.version}},NavigationControl:class{constructor(v){this.options=s.extend({},ZL,v),this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",h=>h.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",h=>{this._map&&this._map.zoomIn({},{originalEvent:h})}),E("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",h=>{this._map&&this._map.zoomOut({},{originalEvent:h})}),E("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",h=>{const m=this._map;m&&(this.options.visualizePitch?m.resetNorthPitch({},{originalEvent:h}):m.resetNorth({},{originalEvent:h}))}),this._compassIcon=E("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const v=this._map;if(!v)return;const h=v.getZoom(),m=h===v.getMaxZoom(),S=h===v.getMinZoom();this._zoomInButton.disabled=m,this._zoomOutButton.disabled=S,this._zoomInButton.setAttribute("aria-disabled",m.toString()),this._zoomOutButton.setAttribute("aria-disabled",S.toString())}_rotateCompassArrow(){const v=this._map;if(!v)return;const h=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(v.transform.pitch*(Math.PI/180)),.5)}) rotateX(${v.transform.pitch}deg) rotateZ(${v.transform.angle*(180/Math.PI)}deg)`:`rotate(${v.transform.angle*(180/Math.PI)}deg)`;v._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=h)})}onAdd(v){return this._map=v,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),v.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&v.on("pitch",this._rotateCompassArrow),v.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new YL(v,this._compass,this.options.visualizePitch)),this._container}onRemove(){const v=this._map;v&&(this._container.remove(),this.options.showZoom&&v.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&v.off("pitch",this._rotateCompassArrow),v.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(v,h){const m=E("button",v,this._container);return m.type="button",m.addEventListener("click",h),m}_setButtonTitle(v,h){if(!this._map)return;const m=this._map._getUIString(`NavigationControl.${h}`);v.setAttribute("aria-label",m),v.firstElementChild&&v.firstElementChild.setAttribute("title",m)}},GeolocateControl:class extends s.Evented{constructor(v){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},px,v),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Qh(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(v){return this._map=v,this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(v){const h=(m=!!this.options.geolocation)=>{this._supportsGeolocation=m,v(m)};this._supportsGeolocation!==void 0?v(this._supportsGeolocation):s.window.navigator.permissions!==void 0?s.window.navigator.permissions.query({name:"geolocation"}).then(m=>h(m.state!=="denied")).catch(()=>h()):h()}_isOutOfMapMaxBounds(v){const h=this._map.getMaxBounds(),m=v.coords;return!!h&&(m.longitude<h.getWest()||m.longitude>h.getEast()||m.latitude<h.getSouth()||m.latitude>h.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(v){if(this._map){if(this._isOutOfMapMaxBounds(v))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",v)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=v,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(v),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(v),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",v)),this._finish()}}_updateCamera(v){const h=new s.LngLat(v.coords.longitude,v.coords.latitude),m=v.coords.accuracy,S=this._map.getBearing(),I=s.extend({bearing:S},this.options.fitBoundsOptions);this._map.fitBounds(h.toBounds(m),I,{geolocateSource:!0})}_updateMarker(v){if(v){const h=new s.LngLat(v.coords.longitude,v.coords.latitude);this._accuracyCircleMarker.setLngLat(h).addTo(this._map),this._userLocationDotMarker.setLngLat(h).addTo(this._map),this._accuracy=v.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const v=this._map.transform,h=s.mercatorZfromAltitude(1,v._center.lat)*v.worldSize,m=Math.ceil(2*this._accuracy*h);this._circleElement.style.width=`${m}px`,this._circleElement.style.height=`${m}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(v){if(this._map){if(this.options.trackUserLocation)if(v.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(v.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",v)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(v){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",h=>h.preventDefault()),this._geolocateButton=E("button","mapboxgl-ctrl-geolocate",this._container),E("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",v===!1){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const h=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}else{const h=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",h),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",h)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=E("div","mapboxgl-user-location"),this._dotElement.appendChild(E("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(E("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new qt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=E("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new qt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",h=>{h.geolocateSource||this._watchState!=="ACTIVE_LOCK"||h.originalEvent&&h.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(v){this._userLocationDotMarker&&(v.webkitCompassHeading?this._heading=v.webkitCompassHeading:v.absolute===!0&&(this._heading=-1*v.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let v;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(v={maximumAge:6e5,timeout:0},this._noTimeout=!0):(v=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,v),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const v=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};s.window.DeviceMotionEvent!==void 0&&typeof s.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(h=>{h==="granted"&&v()}).catch(console.error):v()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Mt,ScaleControl:class{constructor(v){this.options=s.extend({},gx,v),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const v=this.options.maxWidth||100,h=this._map,m=h._containerHeight/2,S=h._containerWidth/2-v/2,I=h.unproject([S,m]),L=h.unproject([S+v,m]),$=I.distanceTo(L);if(this.options.unit==="imperial"){const H=3.2808*$;H>5280?this._setScale(v,H/5280,"mile"):this._setScale(v,H,"foot")}else this.options.unit==="nautical"?this._setScale(v,$/1852,"nautical-mile"):$>=1e3?this._setScale(v,$/1e3,"kilometer"):this._setScale(v,$,"meter")}_setScale(v,h,m){this._map._requestDomTask(()=>{const S=function(L){const $=Math.pow(10,`${Math.floor(L)}`.length-1);let H=L/$;return H=H>=10?10:H>=5?5:H>=3?3:H>=2?2:H>=1?1:function(Q){const ne=Math.pow(10,Math.ceil(-Math.log(Q)/Math.LN10));return Math.round(Q*ne)/ne}(H),$*H}(h),I=S/h;this._container.innerHTML=this._isNumberFormatSupported&&m!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:m}).format(S):`${S}&nbsp;${mx[m]}`,this._container.style.width=v*I+"px"})}onAdd(v){return this._map=v,this._language=v.getLanguage(),this._container=E("div","mapboxgl-ctrl mapboxgl-ctrl-scale",v.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(v){this._language=v,this._update()}setUnit(v){this.options.unit=v,this._update()}},FullscreenControl:class{constructor(v){this._fullscreen=!1,v&&v.container&&(v.container instanceof s.window.HTMLElement?this._container=v.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(v){return this._map=v,this._container||(this._container=this._map.getContainer()),this._controlContainer=E("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const v=this._fullscreenButton=E("button","mapboxgl-ctrl-fullscreen",this._controlContainer);E("span","mapboxgl-ctrl-icon",v).setAttribute("aria-hidden","true"),v.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const v=this._getTitle();this._fullscreenButton.setAttribute("aria-label",v),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",v)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(v){super(),this.options=s.extend(Object.create(xi),v),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(v&&v.className?v.className.trim().split(/\s+/):[])}addTo(v){return this._map&&this.remove(),this._map=v,this.options.closeOnClick&&v.on("preclick",this._onClose),this.options.closeOnMove&&v.on("move",this._onClose),v.on("remove",this.remove),this._update(),v._addPopup(this),this._focusFirstElement(),this._trackPointer?(v.on("mousemove",this._onMouseEvent),v.on("mouseup",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")):v.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const v=this._map;return v&&(v.off("move",this._update),v.off("move",this._onClose),v.off("preclick",this._onClose),v.off("click",this._onClose),v.off("remove",this.remove),v.off("mousemove",this._onMouseEvent),v.off("mouseup",this._onMouseEvent),v.off("drag",this._onMouseEvent),v._canvasContainer&&v._canvasContainer.classList.remove("mapboxgl-track-pointer"),v._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(v){this._lngLat=s.LngLat.convert(v),this._pos=null,this._trackPointer=!1,this._update();const h=this._map;return h&&(h.on("move",this._update),h.off("mousemove",this._onMouseEvent),h._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const v=this._map;return v&&(v.off("move",this._update),v.on("mousemove",this._onMouseEvent),v.on("drag",this._onMouseEvent),v._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(v){return this.setDOMContent(s.window.document.createTextNode(v))}setHTML(v){const h=s.window.document.createDocumentFragment(),m=s.window.document.createElement("body");let S;for(m.innerHTML=v;S=m.firstChild,S;)h.appendChild(S);return this.setDOMContent(h)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(v){return this.options.maxWidth=v,this._update(),this}setDOMContent(v){let h=this._content;if(h)for(;h.hasChildNodes();)h.firstChild&&h.removeChild(h.firstChild);else h=this._content=E("div","mapboxgl-popup-content",this._container||void 0);if(h.appendChild(v),this.options.closeButton){const m=this._closeButton=E("button","mapboxgl-popup-close-button",h);m.type="button",m.setAttribute("aria-label","Close popup"),m.setAttribute("aria-hidden","true"),m.innerHTML="&#215;",m.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(v){return this._classList.add(v),this._updateClassList(),this}removeClassName(v){return this._classList.delete(v),this._updateClassList(),this}setOffset(v){return this.options.offset=v,this._update(),this}toggleClassName(v){let h;return this._classList.delete(v)?h=!1:(this._classList.add(v),h=!0),this._updateClassList(),h}_onMouseEvent(v){this._update(v.point)}_getAnchor(v){if(this.options.anchor)return this.options.anchor;const h=this._map,m=this._container,S=this._pos;if(!h||!m||!S)return"bottom";const I=m.offsetWidth,L=m.offsetHeight,$=S.x<I/2,H=S.x>h.transform.width-I/2;if(S.y+v<L)return $?"top-left":H?"top-right":"top";if(S.y>h.transform.height-L){if($)return"bottom-left";if(H)return"bottom-right"}return $?"left":H?"right":"bottom"}_updateClassList(){const v=this._container;if(!v)return;const h=[...this._classList];h.push("mapboxgl-popup"),this._anchor&&h.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&h.push("mapboxgl-popup-track-pointer"),v.className=h.join(" ")}_update(v){const h=this._map,m=this._content;if(!h||!this._lngLat&&!this._trackPointer||!m)return;let S=this._container;if(S||(S=this._container=E("div","mapboxgl-popup",h.getContainer()),this._tip=E("div","mapboxgl-popup-tip",S),S.appendChild(m)),this.options.maxWidth&&S.style.maxWidth!==this.options.maxWidth&&(S.style.maxWidth=this.options.maxWidth),h.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Vr(this._lngLat,this._pos,h.transform)),!this._trackPointer||v){const I=this._pos=this._trackPointer&&v?v:h.project(this._lngLat),L=gr(this.options.offset),$=this._anchor=this._getAnchor(L.y),H=gr(this.options.offset,$),Q=I.add(H).round();h._requestDomTask(()=>{this._container&&$&&(this._container.style.transform=`${Jr[$]} translate(${Q.x}px,${Q.y}px)`)})}if(!this._marker&&h._showingGlobe()){const I=s.isLngLatBehindGlobe(h.transform,this._lngLat)?0:1;this._setOpacity(I)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const v=this._container.querySelector($i);v&&v.focus()}_onClose(){this.remove()}_setOpacity(v){this._container&&(this._container.style.opacity=`${v}`),this._content&&(this._content.style.pointerEvents=v?"auto":"none")}},Marker:qt,Style:Ds,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:U_,Evented:s.Evented,config:s.config,prewarm:function(){Tr().acquire(Ir)},clearPrewarmedResources:function(){const v=rr;v&&(v.isPreloaded()&&v.numActive()===1?(v.release(Ir),rr=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(v){s.config.ACCESS_TOKEN=v},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(v){s.config.API_URL=v},get workerCount(){return fr.workerCount},set workerCount(v){fr.workerCount=v},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(v){s.config.MAX_PARALLEL_IMAGE_REQUESTS=v},clearStorage(v){s.clearTileCache(v)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return Zg});var a=i;return a})})(_fe);var vfe=_fe.exports;const E8=_A(vfe),eat=lz({__proto__:null,default:E8},[vfe]);var ix=nat,tat=Object.prototype.hasOwnProperty;function nat(){for(var t={},e=0;e<arguments.length;e++){var n=arguments[e];for(var r in n)tat.call(n,r)&&(t[r]=n[r])}return t}var xfe={exports:{}};(function(t,e){(function(){var n={};t.exports=n,n.simpleFilter=function(r,i){return i.filter(function(o){return n.test(r,o)})},n.test=function(r,i){return n.match(r,i)!==null},n.match=function(r,i,o){o=o||{};var a=0,s=[],u=i.length,d=0,g=0,_=o.pre||"",E=o.post||"",P=o.caseSensitive&&i||i.toLowerCase(),O;r=o.caseSensitive&&r||r.toLowerCase();for(var D=0;D<u;D++)O=i[D],P[D]===r[a]?(O=_+O+E,a+=1,g+=1+g):g=0,d+=g,s[s.length]=O;return a===r.length?(d=P===r?1/0:d,{rendered:s.join(""),score:d}):null},n.filter=function(r,i,o){return!i||i.length===0?[]:typeof r!="string"?i:(o=o||{},i.reduce(function(a,s,u,d){var g=s;o.extract&&(g=o.extract(s));var _=n.match(r,g,o);return _!=null&&(a[a.length]={string:_.rendered,score:_.score,index:u,original:s}),a},[]).sort(function(a,s){var u=s.score-a.score;return u||a.index-s.index}))}})()})(xfe);var rat=xfe.exports,Vu=function(t){return this.component=t,this.items=[],this.active=0,this.wrapper=document.createElement("div"),this.wrapper.className="suggestions-wrapper",this.element=document.createElement("ul"),this.element.className="suggestions",this.wrapper.appendChild(this.element),this.selectingListItem=!1,t.el.parentNode.insertBefore(this.wrapper,t.el.nextSibling),this};Vu.prototype.show=function(){this.element.style.display="block"};Vu.prototype.hide=function(){this.element.style.display="none"};Vu.prototype.add=function(t){this.items.push(t)};Vu.prototype.clear=function(){this.items=[],this.active=0};Vu.prototype.isEmpty=function(){return!this.items.length};Vu.prototype.isVisible=function(){return this.element.style.display==="block"};Vu.prototype.draw=function(){if(this.element.innerHTML="",this.items.length===0){this.hide();return}for(var t=0;t<this.items.length;t++)this.drawItem(this.items[t],this.active===t);this.show()};Vu.prototype.drawItem=function(t,e){var n=document.createElement("li"),r=document.createElement("a");e&&(n.className+=" active"),r.innerHTML=t.string,n.appendChild(r),this.element.appendChild(n),n.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),n.addEventListener("mouseup",(function(){this.handleMouseUp.call(this,t)}).bind(this))};Vu.prototype.handleMouseUp=function(t){this.selectingListItem=!1,this.component.value(t.original),this.clear(),this.draw()};Vu.prototype.move=function(t){this.active=t,this.draw()};Vu.prototype.previous=function(){this.move(this.active===0?this.items.length-1:this.active-1)};Vu.prototype.next=function(){this.move(this.active===this.items.length-1?0:this.active+1)};Vu.prototype.drawError=function(t){var e=document.createElement("li");e.innerHTML=t,this.element.appendChild(e),this.show()};var iat=Vu,oat=ix,sat=rat,aat=iat,Bl=function(t,e,n){return n=n||{},this.options=oat({minLength:2,limit:5,filter:!0,hideOnBlur:!0},n),this.el=t,this.data=e||[],this.list=new aat(this),this.query="",this.selected=null,this.list.draw(),this.el.addEventListener("keyup",(function(r){this.handleKeyUp(r.keyCode)}).bind(this),!1),this.el.addEventListener("keydown",(function(r){this.handleKeyDown(r)}).bind(this)),this.el.addEventListener("focus",(function(){this.handleFocus()}).bind(this)),this.el.addEventListener("blur",(function(){this.handleBlur()}).bind(this)),this.el.addEventListener("paste",(function(r){this.handlePaste(r)}).bind(this)),this.render=this.options.render?this.options.render.bind(this):this.render.bind(this),this.getItemValue=this.options.getItemValue?this.options.getItemValue.bind(this):this.getItemValue.bind(this),this};Bl.prototype.handleKeyUp=function(t){t===40||t===38||t===27||t===13||t===9||this.handleInputChange(this.el.value)};Bl.prototype.handleKeyDown=function(t){switch(t.keyCode){case 13:case 9:this.list.isEmpty()||(this.list.isVisible()&&t.preventDefault(),this.value(this.list.items[this.list.active].original),this.list.hide());break;case 27:this.list.isEmpty()||this.list.hide();break;case 38:this.list.previous();break;case 40:this.list.next();break}};Bl.prototype.handleBlur=function(){!this.list.selectingListItem&&this.options.hideOnBlur&&this.list.hide()};Bl.prototype.handlePaste=function(t){if(t.clipboardData)this.handleInputChange(t.clipboardData.getData("Text"));else{var e=this;setTimeout(function(){e.handleInputChange(t.target.value)},100)}};Bl.prototype.handleInputChange=function(t){if(this.query=this.normalize(t),this.list.clear(),this.query.length<this.options.minLength){this.list.draw();return}this.getCandidates((function(e){for(var n=0;n<e.length&&(this.list.add(e[n]),n!==this.options.limit-1);n++);this.list.draw()}).bind(this))};Bl.prototype.handleFocus=function(){this.list.isEmpty()||this.list.show(),this.list.selectingListItem=!1};Bl.prototype.update=function(t){this.data=t,this.handleKeyUp()};Bl.prototype.clear=function(){this.data=[],this.list.clear()};Bl.prototype.normalize=function(t){return t=t.toLowerCase(),t};Bl.prototype.match=function(t,e){return t.indexOf(e)>-1};Bl.prototype.value=function(t){if(this.selected=t,this.el.value=this.getItemValue(t),document.createEvent){var e=document.createEvent("HTMLEvents");e.initEvent("change",!0,!1),this.el.dispatchEvent(e)}else this.el.fireEvent("onchange")};Bl.prototype.getCandidates=function(t){var e={pre:"<strong>",post:"</strong>",extract:(function(r){return this.getItemValue(r)}).bind(this)},n;this.options.filter?(n=sat.filter(this.query,this.data,e),n=n.map((function(r){return{original:r.original,string:this.render(r.original,r.string)}}).bind(this))):n=this.data.map((function(r){var i=this.render(r);return{original:r,string:i}}).bind(this)),t(n)};Bl.prototype.getItemValue=function(t){return t};Bl.prototype.render=function(t,e){if(e)return e;for(var n=t.original?this.getItemValue(t.original):this.getItemValue(t),r=this.normalize(n),i=r.lastIndexOf(this.query);i>-1;){var o=i+this.query.length;n=n.slice(0,i)+"<strong>"+n.slice(i,o)+"</strong>"+n.slice(o),i=r.slice(0,i).lastIndexOf(this.query)}return n};Bl.prototype.renderError=function(t){this.list.drawError(t)};var lat=Bl,bfe=lat,uat=bfe;typeof window<"u"&&(window.Suggestions=bfe);var cat="Expected a function",iK=0/0,fat="[object Symbol]",hat=/^\s+|\s+$/g,dat=/^[-+]0x[0-9a-f]+$/i,pat=/^0b[01]+$/i,gat=/^0o[0-7]+$/i,mat=parseInt,Aat=typeof Ya=="object"&&Ya&&Ya.Object===Object&&Ya,_at=typeof self=="object"&&self&&self.Object===Object&&self,yat=Aat||_at||Function("return this")(),vat=Object.prototype,xat=vat.toString,bat=Math.max,wat=Math.min,PN=function(){return yat.Date.now()};function Eat(t,e,n){var r,i,o,a,s,u,d=0,g=!1,_=!1,E=!0;if(typeof t!="function")throw new TypeError(cat);e=oK(e)||0,sz(n)&&(g=!!n.leading,_="maxWait"in n,o=_?bat(oK(n.maxWait)||0,e):o,E="trailing"in n?!!n.trailing:E);function P(J){var re=r,ue=i;return r=i=void 0,d=J,a=t.apply(ue,re),a}function O(J){return d=J,s=setTimeout(k,e),g?P(J):a}function D(J){var re=J-u,ue=J-d,ie=e-re;return _?wat(ie,o-ue):ie}function V(J){var re=J-u,ue=J-d;return u===void 0||re>=e||re<0||_&&ue>=o}function k(){var J=PN();if(V(J))return F(J);s=setTimeout(k,D(J))}function F(J){return s=void 0,E&&r?P(J):(r=i=void 0,a)}function z(){s!==void 0&&clearTimeout(s),d=0,r=u=i=s=void 0}function X(){return s===void 0?a:F(PN())}function Y(){var J=PN(),re=V(J);if(r=arguments,i=this,u=J,re){if(s===void 0)return O(u);if(_)return s=setTimeout(k,e),P(u)}return s===void 0&&(s=setTimeout(k,e)),a}return Y.cancel=z,Y.flush=X,Y}function sz(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function Sat(t){return!!t&&typeof t=="object"}function Tat(t){return typeof t=="symbol"||Sat(t)&&xat.call(t)==fat}function oK(t){if(typeof t=="number")return t;if(Tat(t))return iK;if(sz(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=sz(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(hat,"");var n=pat.test(t);return n||gat.test(t)?mat(t.slice(2),n?2:8):dat.test(t)?iK:+t}var Cat=Eat,S8={exports:{}},Pv=typeof Reflect=="object"?Reflect:null,sK=Pv&&typeof Pv.apply=="function"?Pv.apply:function(e,n,r){return Function.prototype.apply.call(e,n,r)},IP;Pv&&typeof Pv.ownKeys=="function"?IP=Pv.ownKeys:Object.getOwnPropertySymbols?IP=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:IP=function(e){return Object.getOwnPropertyNames(e)};function Pat(t){console&&console.warn&&console.warn(t)}var wfe=Number.isNaN||function(e){return e!==e};function so(){so.init.call(this)}S8.exports=so;S8.exports.once=Rat;so.EventEmitter=so;so.prototype._events=void 0;so.prototype._eventsCount=0;so.prototype._maxListeners=void 0;var aK=10;function WL(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(so,"defaultMaxListeners",{enumerable:!0,get:function(){return aK},set:function(t){if(typeof t!="number"||t<0||wfe(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");aK=t}});so.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};so.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||wfe(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Efe(t){return t._maxListeners===void 0?so.defaultMaxListeners:t._maxListeners}so.prototype.getMaxListeners=function(){return Efe(this)};so.prototype.emit=function(e){for(var n=[],r=1;r<arguments.length;r++)n.push(arguments[r]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var a;if(n.length>0&&(a=n[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=o[e];if(u===void 0)return!1;if(typeof u=="function")sK(u,this,n);else for(var d=u.length,g=Ife(u,d),r=0;r<d;++r)sK(g[r],this,n);return!0};function Sfe(t,e,n,r){var i,o,a;if(WL(n),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),o=t._events),a=o[e]),a===void 0)a=o[e]=n,++t._eventsCount;else if(typeof a=="function"?a=o[e]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),i=Efe(t),i>0&&a.length>i&&!a.warned){a.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=t,s.type=e,s.count=a.length,Pat(s)}return t}so.prototype.addListener=function(e,n){return Sfe(this,e,n,!1)};so.prototype.on=so.prototype.addListener;so.prototype.prependListener=function(e,n){return Sfe(this,e,n,!0)};function Iat(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Tfe(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},i=Iat.bind(r);return i.listener=n,r.wrapFn=i,i}so.prototype.once=function(e,n){return WL(n),this.on(e,Tfe(this,e,n)),this};so.prototype.prependOnceListener=function(e,n){return WL(n),this.prependListener(e,Tfe(this,e,n)),this};so.prototype.removeListener=function(e,n){var r,i,o,a,s;if(WL(n),i=this._events,i===void 0)return this;if(r=i[e],r===void 0)return this;if(r===n||r.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||n));else if(typeof r!="function"){for(o=-1,a=r.length-1;a>=0;a--)if(r[a]===n||r[a].listener===n){s=r[a].listener,o=a;break}if(o<0)return this;o===0?r.shift():Mat(r,o),r.length===1&&(i[e]=r[0]),i.removeListener!==void 0&&this.emit("removeListener",e,s||n)}return this};so.prototype.off=so.prototype.removeListener;so.prototype.removeAllListeners=function(e){var n,r,i;if(r=this._events,r===void 0)return this;if(r.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):r[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete r[e]),this;if(arguments.length===0){var o=Object.keys(r),a;for(i=0;i<o.length;++i)a=o[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=r[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(i=n.length-1;i>=0;i--)this.removeListener(e,n[i]);return this};function Cfe(t,e,n){var r=t._events;if(r===void 0)return[];var i=r[e];return i===void 0?[]:typeof i=="function"?n?[i.listener||i]:[i]:n?Oat(i):Ife(i,i.length)}so.prototype.listeners=function(e){return Cfe(this,e,!0)};so.prototype.rawListeners=function(e){return Cfe(this,e,!1)};so.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Pfe.call(t,e)};so.prototype.listenerCount=Pfe;function Pfe(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}so.prototype.eventNames=function(){return this._eventsCount>0?IP(this._events):[]};function Ife(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function Mat(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function Oat(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function Rat(t,e){return new Promise(function(n,r){function i(a){t.removeListener(e,o),r(a)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",i),n([].slice.call(arguments))}Mfe(t,e,o,{once:!0}),e!=="error"&&Lat(t,i,{once:!0})})}function Lat(t,e,n){typeof t.on=="function"&&Mfe(t,"error",e,n)}function Mfe(t,e,n,r){if(typeof t.on=="function")r.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(o){r.once&&t.removeEventListener(e,i),n(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Dat=S8.exports,Bat={fr:{name:"France",bbox:[[-4.59235,41.380007],[9.560016,51.148506]]},us:{name:"United States",bbox:[[-171.791111,18.91619],[-66.96466,71.357764]]},ru:{name:"Russia",bbox:[[19.66064,41.151416],[190.10042,81.2504]]},ca:{name:"Canada",bbox:[[-140.99778,41.675105],[-52.648099,83.23324]]}};function Nat(t){var e=t.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return e?{key:e[1],value:e[2]}:null}function Fat(t){var e=t.match(/<?([^>]*)>(.*)/);if(!e)return null;var n=e[1],r=e[2].split(";"),i=null,o=r.reduce(function(a,s){var u=Nat(s);return u?u.key==="rel"?(i||(i=u.value),a):(a[u.key]=u.value,a):a},{});return i?{url:n,rel:i,params:o}:null}function kat(t){return t?t.split(/,\s*</).reduce(function(e,n){var r=Fat(n);if(!r)return e;var i=r.rel.split(/\s+/);return i.forEach(function(o){e[o]||(e[o]={url:r.url,params:r.params})}),e},{}):{}}var zat=kat,Uat=zat;function T8(t,e){this.request=t,this.headers=e.headers,this.rawBody=e.body,this.statusCode=e.statusCode;try{this.body=JSON.parse(e.body||"{}")}catch{this.body=e.body}this.links=Uat(this.headers.link)}T8.prototype.hasNextPage=function(){return!!this.links.next};T8.prototype.nextPage=function(){return this.hasNextPage()?this.request._extend({path:this.links.next.url}):null};var Gat=T8,qL={API_ORIGIN:"https://api.mapbox.com",EVENT_PROGRESS_DOWNLOAD:"downloadProgress",EVENT_PROGRESS_UPLOAD:"uploadProgress",EVENT_ERROR:"error",EVENT_RESPONSE:"response",ERROR_HTTP:"HttpError",ERROR_REQUEST_ABORTED:"RequestAbortedError"},lK=qL;function jat(t){var e=t.type||lK.ERROR_HTTP,n;if(t.body)try{n=JSON.parse(t.body)}catch{n=t.body}else n=null;var r=t.message||null;r||(typeof n=="string"?r=n:n&&typeof n.message=="string"?r=n.message:e===lK.ERROR_REQUEST_ABORTED&&(r="Request aborted")),this.message=r,this.type=e,this.statusCode=t.statusCode||null,this.request=t.request,this.body=n}var Vat=jat;function $at(t){var e=t.indexOf(":"),n=t.substring(0,e).trim().toLowerCase(),r=t.substring(e+1).trim();return{name:n,value:r}}function Hat(t){var e={};return t&&t.trim().split(/[\r|\n]+/).forEach(function(n){var r=$at(n);e[r.name]=r.value}),e}var Wat=Hat,qat=Gat,uK=Vat,IN=qL,Xat=Wat,AO={};function Zat(t){var e=AO[t.id];e&&(e.abort(),delete AO[t.id])}function Yat(t,e){return new qat(t,{body:e.response,headers:Xat(e.getAllResponseHeaders()),statusCode:e.status})}function cK(t){var e=t.total,n=t.loaded,r=100*n/e;return{total:e,transferred:n,percent:r}}function Ofe(t,e){return new Promise(function(n,r){e.onprogress=function(a){t.emitter.emit(IN.EVENT_PROGRESS_DOWNLOAD,cK(a))};var i=t.file;i&&(e.upload.onprogress=function(a){t.emitter.emit(IN.EVENT_PROGRESS_UPLOAD,cK(a))}),e.onerror=function(a){r(a)},e.onabort=function(){var a=new uK({request:t,type:IN.ERROR_REQUEST_ABORTED});r(a)},e.onload=function(){if(delete AO[t.id],e.status<200||e.status>=400){var a=new uK({request:t,body:e.response,statusCode:e.status});r(a);return}n(e)};var o=t.body;typeof o=="string"?e.send(o):o?e.send(JSON.stringify(o)):i?e.send(i):e.send(),AO[t.id]=e}).then(function(n){return Yat(t,n)})}function Rfe(t,e){var n=t.url(e),r=new window.XMLHttpRequest;return r.open(t.method,n),Object.keys(t.headers).forEach(function(i){r.setRequestHeader(i,t.headers[i])}),r}function Qat(t){return Promise.resolve().then(function(){var e=Rfe(t,t.client.accessToken);return Ofe(t,e)})}var Kat={browserAbort:Zat,sendRequestXhr:Ofe,browserSend:Qat,createRequestXhr:Rfe},_O={exports:{}};/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */_O.exports;(function(t,e){(function(n){var r=e,i=t&&t.exports==r&&t,o=typeof Ya=="object"&&Ya;(o.global===o||o.window===o)&&(n=o);var a=function(O){this.message=O};a.prototype=new Error,a.prototype.name="InvalidCharacterError";var s=function(O){throw new a(O)},u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=/[\t\n\f\r ]/g,g=function(O){O=String(O).replace(d,"");var D=O.length;D%4==0&&(O=O.replace(/==?$/,""),D=O.length),(D%4==1||/[^+a-zA-Z0-9/]/.test(O))&&s("Invalid character: the string to be decoded is not correctly encoded.");for(var V=0,k,F,z="",X=-1;++X<D;)F=u.indexOf(O.charAt(X)),k=V%4?k*64+F:F,V++%4&&(z+=String.fromCharCode(255&k>>(-2*V&6)));return z},_=function(O){O=String(O),/[^\0-\xFF]/.test(O)&&s("The string to be encoded contains characters outside of the Latin1 range.");for(var D=O.length%3,V="",k=-1,F,z,X,Y,J=O.length-D;++k<J;)F=O.charCodeAt(k)<<16,z=O.charCodeAt(++k)<<8,X=O.charCodeAt(++k),Y=F+z+X,V+=u.charAt(Y>>18&63)+u.charAt(Y>>12&63)+u.charAt(Y>>6&63)+u.charAt(Y&63);return D==2?(F=O.charCodeAt(k)<<8,z=O.charCodeAt(++k),Y=F+z,V+=u.charAt(Y>>10)+u.charAt(Y>>4&63)+u.charAt(Y<<2&63)+"="):D==1&&(Y=O.charCodeAt(k),V+=u.charAt(Y>>2)+u.charAt(Y<<4&63)+"=="),V},E={encode:_,decode:g,version:"0.1.0"};if(r&&!r.nodeType)if(i)i.exports=E;else for(var P in E)E.hasOwnProperty(P)&&(r[P]=E[P]);else n.base64=E})(Ya)})(_O,_O.exports);var Jat=_O.exports,elt=Jat,MN={};function tlt(t){if(MN[t])return MN[t];var e=t.split("."),n=e[0],r=e[1];if(!r)throw new Error("Invalid token");var i=nlt(r),o={usage:n,user:i.u};return m0(i,"a")&&(o.authorization=i.a),m0(i,"exp")&&(o.expires=i.exp*1e3),m0(i,"iat")&&(o.created=i.iat*1e3),m0(i,"scopes")&&(o.scopes=i.scopes),m0(i,"client")&&(o.client=i.client),m0(i,"ll")&&(o.lastLogin=i.ll),m0(i,"iu")&&(o.impersonator=i.iu),MN[t]=o,o}function nlt(t){try{return JSON.parse(elt.decode(t))}catch{throw new Error("Invalid token")}}function m0(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var Lfe=tlt,Dfe={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(u,d,g){this.fn=u,this.context=d,this.once=g||!1}function o(u,d,g,_,E){if(typeof g!="function")throw new TypeError("The listener must be a function");var P=new i(g,_||u,E),O=n?n+d:d;return u._events[O]?u._events[O].fn?u._events[O]=[u._events[O],P]:u._events[O].push(P):(u._events[O]=P,u._eventsCount++),u}function a(u,d){--u._eventsCount===0?u._events=new r:delete u._events[d]}function s(){this._events=new r,this._eventsCount=0}s.prototype.eventNames=function(){var d=[],g,_;if(this._eventsCount===0)return d;for(_ in g=this._events)e.call(g,_)&&d.push(n?_.slice(1):_);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(g)):d},s.prototype.listeners=function(d){var g=n?n+d:d,_=this._events[g];if(!_)return[];if(_.fn)return[_.fn];for(var E=0,P=_.length,O=new Array(P);E<P;E++)O[E]=_[E].fn;return O},s.prototype.listenerCount=function(d){var g=n?n+d:d,_=this._events[g];return _?_.fn?1:_.length:0},s.prototype.emit=function(d,g,_,E,P,O){var D=n?n+d:d;if(!this._events[D])return!1;var V=this._events[D],k=arguments.length,F,z;if(V.fn){switch(V.once&&this.removeListener(d,V.fn,void 0,!0),k){case 1:return V.fn.call(V.context),!0;case 2:return V.fn.call(V.context,g),!0;case 3:return V.fn.call(V.context,g,_),!0;case 4:return V.fn.call(V.context,g,_,E),!0;case 5:return V.fn.call(V.context,g,_,E,P),!0;case 6:return V.fn.call(V.context,g,_,E,P,O),!0}for(z=1,F=new Array(k-1);z<k;z++)F[z-1]=arguments[z];V.fn.apply(V.context,F)}else{var X=V.length,Y;for(z=0;z<X;z++)switch(V[z].once&&this.removeListener(d,V[z].fn,void 0,!0),k){case 1:V[z].fn.call(V[z].context);break;case 2:V[z].fn.call(V[z].context,g);break;case 3:V[z].fn.call(V[z].context,g,_);break;case 4:V[z].fn.call(V[z].context,g,_,E);break;default:if(!F)for(Y=1,F=new Array(k-1);Y<k;Y++)F[Y-1]=arguments[Y];V[z].fn.apply(V[z].context,F)}}return!0},s.prototype.on=function(d,g,_){return o(this,d,g,_,!1)},s.prototype.once=function(d,g,_){return o(this,d,g,_,!0)},s.prototype.removeListener=function(d,g,_,E){var P=n?n+d:d;if(!this._events[P])return this;if(!g)return a(this,P),this;var O=this._events[P];if(O.fn)O.fn===g&&(!E||O.once)&&(!_||O.context===_)&&a(this,P);else{for(var D=0,V=[],k=O.length;D<k;D++)(O[D].fn!==g||E&&!O[D].once||_&&O[D].context!==_)&&V.push(O[D]);V.length?this._events[P]=V.length===1?V[0]:V:a(this,P)}return this},s.prototype.removeAllListeners=function(d){var g;return d?(g=n?n+d:d,this._events[g]&&a(this,g)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,s.EventEmitter=s,t.exports=s})(Dfe);var rlt=Dfe.exports;function ilt(t){return t.map(encodeURIComponent).join(",")}function Bfe(t){return Array.isArray(t)?ilt(t):encodeURIComponent(String(t))}function Nfe(t,e,n){if(n===!1||n===null)return t;var r=/\?/.test(t)?"&":"?",i=encodeURIComponent(e);return n!==void 0&&n!==""&&n!==!0&&(i+="="+Bfe(n)),""+t+r+i}function olt(t,e){if(!e)return t;var n=t;return Object.keys(e).forEach(function(r){var i=e[r];i!==void 0&&(Array.isArray(i)&&(i=i.filter(function(o){return o!=null}).join(",")),n=Nfe(n,r,i))}),n}function slt(t,e){if(!e||t.slice(0,4)==="http")return t;var n=t[0]==="/"?"":"/";return""+e.replace(/\/$/,"")+n+t}function alt(t,e){return e?t.replace(/\/:([a-zA-Z0-9]+)/g,function(n,r){var i=e[r];if(i===void 0)throw new Error("Unspecified route parameter "+r);var o=Bfe(i);return"/"+o}):t}var llt={appendQueryObject:olt,appendQueryParam:Nfe,prependOrigin:slt,interpolateRouteParams:alt},ult=Lfe,C8=ix,clt=rlt,HT=llt,fK=qL,flt=1;function mA(t,e){if(!t)throw new Error("MapiRequest requires a client");if(!e||!e.path||!e.method)throw new Error("MapiRequest requires an options object with path and method properties");var n={};e.body&&(n["content-type"]="application/json");var r=C8(n,e.headers),i=Object.keys(r).reduce(function(o,a){return o[a.toLowerCase()]=r[a],o},{});this.id=flt++,this._options=e,this.emitter=new clt,this.client=t,this.response=null,this.error=null,this.sent=!1,this.aborted=!1,this.path=e.path,this.method=e.method,this.origin=e.origin||t.origin,this.query=e.query||{},this.params=e.params||{},this.body=e.body||null,this.file=e.file||null,this.encoding=e.encoding||"utf8",this.sendFileAs=e.sendFileAs||null,this.headers=i}mA.prototype.url=function(e){var n=HT.prependOrigin(this.path,this.origin);n=HT.appendQueryObject(n,this.query);var r=this.params,i=e??this.client.accessToken;if(i){n=HT.appendQueryParam(n,"access_token",i);var o=ult(i).user;r=C8({ownerId:o},r)}return n=HT.interpolateRouteParams(n,r),n};mA.prototype.send=function(){var e=this;if(e.sent)throw new Error("This request has already been sent. Check the response and error properties. Create a new request with clone().");return e.sent=!0,e.client.sendRequest(e).then(function(n){return e.response=n,e.emitter.emit(fK.EVENT_RESPONSE,n),n},function(n){throw e.error=n,e.emitter.emit(fK.EVENT_ERROR,n),n})};mA.prototype.abort=function(){this._nextPageRequest&&(this._nextPageRequest.abort(),delete this._nextPageRequest),!(this.response||this.error||this.aborted)&&(this.aborted=!0,this.client.abortRequest(this))};mA.prototype.eachPage=function(e){var n=this;function r(a){function s(){delete n._nextPageRequest;var u=a.nextPage();u&&(n._nextPageRequest=u,o(u))}e(null,a,s)}function i(a){e(a,null,function(){})}function o(a){a.send().then(r,i)}o(this)};mA.prototype.clone=function(){return this._extend()};mA.prototype._extend=function(e){var n=C8(this._options,e);return new mA(this.client,n)};var hlt=mA,dlt=Lfe,plt=hlt,glt=qL;function Ffe(t){if(!t||!t.accessToken)throw new Error("Cannot create a client without an access token");dlt(t.accessToken),this.accessToken=t.accessToken,this.origin=t.origin||glt.API_ORIGIN}Ffe.prototype.createRequest=function(e){return new plt(this,e)};var kfe=Ffe,zfe=Kat,Ufe=kfe;function M1(t){Ufe.call(this,t)}M1.prototype=Object.create(Ufe.prototype);M1.prototype.constructor=M1;M1.prototype.sendRequest=zfe.browserSend;M1.prototype.abortRequest=zfe.browserAbort;function mlt(t){return new M1(t)}var Gfe=mlt,Alt=Gfe,_lt=Alt,ylt=Object.prototype.toString,vlt=function(t){var e;return ylt.call(t)==="[object Object]"&&(e=Object.getPrototypeOf(t),e===null||e===Object.getPrototypeOf({}))},xlt=vlt,blt=ix,jfe="value",ON=`
  `,wo={};wo.assert=function(t,e){return e=e||{},function(n){var r=AA(t,n);if(r){var i=P8(r,e);throw e.apiName&&(i=e.apiName+": "+i),new Error(i)}}};wo.shape=function(e){var n=Tlt(e);return function(i){var o=AA(wo.plainObject,i);if(o)return o;for(var a,s,u=[],d=0;d<n.length;d++)a=n[d].key,s=n[d].value,o=AA(s,i[a]),o&&u.push([a].concat(o));return u.length<2?u[0]:function(g){u=u.map(function(P){var O=P[0],D=P8(P,g).split(`
`).join(ON);return"- "+O+": "+D});var _=g.path.join("."),E=_===jfe?"":" of "+_;return"The following properties"+E+" have invalid values:"+ON+u.join(ON)}}};wo.strictShape=function(e){var n=wo.shape(e);return function(i){var o=n(i);if(o)return o;var a=Object.keys(i).reduce(function(s,u){return e[u]===void 0&&s.push(u),s},[]);if(a.length!==0)return function(){return"The following keys are invalid: "+a.join(", ")}}};wo.arrayOf=function(e){return Vfe(e)};wo.tuple=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return Vfe(e)};function Vfe(t){var e=Array.isArray(t),n=function(r){return e?t[r]:t};return function(i){var o=AA(wo.plainArray,i);if(o)return o;if(e&&i.length!==t.length)return"an array with "+t.length+" items";for(var a=0;a<i.length;a++)if(o=AA(n(a),i[a]),o)return[a].concat(o)}}wo.required=function(e){function n(r){return r==null?function(i){return $fe(i,Hfe(i.path)?"cannot be undefined/null.":"is required.")}:e.apply(this,arguments)}return n.__required=!0,n};wo.oneOfType=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments);return function(r){var i=e.map(function(o){return AA(o,r)}).filter(Boolean);if(i.length===e.length)return i.every(function(o){return o.length===1&&typeof o[0]=="string"})?wlt(i.map(function(o){return o[0]})):i.reduce(function(o,a){return a.length>o.length?a:o})}};wo.equal=function(e){return function(r){if(r!==e)return JSON.stringify(e)}};wo.oneOf=function(){var e=Array.isArray(arguments[0])?arguments[0]:Array.prototype.slice.call(arguments),n=e.map(function(r){return wo.equal(r)});return wo.oneOfType.apply(this,n)};wo.range=function(e){var n=e[0],r=e[1];return function(o){var a=AA(wo.number,o);if(a||o<n||o>r)return"number between "+n+" & "+r+" (inclusive)"}};wo.any=function(){};wo.boolean=function(e){if(typeof e!="boolean")return"boolean"};wo.number=function(e){if(typeof e!="number")return"number"};wo.plainArray=function(e){if(!Array.isArray(e))return"array"};wo.plainObject=function(e){if(!xlt(e))return"object"};wo.string=function(e){if(typeof e!="string")return"string"};wo.func=function(e){if(typeof e!="function")return"function"};function AA(t,e){if(!(e==null&&!t.hasOwnProperty("__required"))){var n=t(e);if(n)return Array.isArray(n)?n:[n]}}function P8(t,e){var n=t.length,r=t[n-1],i=t.slice(0,n-1);return i.length===0&&(i=[jfe]),e=blt(e,{path:i}),typeof r=="function"?r(e):$fe(e,Elt(r))}function wlt(t){return t.length<2?t[0]:t.length===2?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t.slice(-1)}function Elt(t){return"must be "+Slt(t)+"."}function Slt(t){return/^an? /.test(t)?t:/^[aeiou]/i.test(t)?"an "+t:/^[a-z]/i.test(t)?"a "+t:t}function $fe(t,e){var n=Hfe(t.path),r=t.path.join(".")+" "+e,i=n?"Item at position ":"";return i+r}function Hfe(t){return typeof t[t.length-1]=="number"||typeof t[0]=="number"}function Tlt(t){return Object.keys(t||{}).map(function(e){return{key:e,value:t[e]}})}wo.validate=AA;wo.processMessage=P8;var Clt=wo,Plt=ix,Iv=Clt;function Ilt(t){if(typeof window<"u")return t instanceof Ya.Blob||t instanceof Ya.ArrayBuffer?void 0:"Blob or ArrayBuffer";if(!(typeof t=="string"||t.pipe!==void 0))return"Filename or Readable stream"}function Mlt(t,e){return Iv.assert(Iv.strictShape(t),e)}function Olt(t){var e="date";if(typeof t=="boolean")return e;try{var n=new Date(t);if(n.getTime&&isNaN(n.getTime()))return e}catch{return e}}function Rlt(t){return Iv.tuple(Iv.number,Iv.number)(t)}var Llt=Plt(Iv,{file:Ilt,date:Olt,coordinates:Rlt,assertShape:Mlt});function Dlt(t,e){var n=function(r,i){return e.indexOf(r)!==-1&&i!==void 0};return typeof e=="function"&&(n=e),Object.keys(t).filter(function(r){return n(r,t[r])}).reduce(function(r,i){return r[i]=t[i],r},{})}var Blt=Dlt;function Nlt(t,e){return Object.keys(t).reduce(function(n,r){return n[r]=e(r,t[r]),n},{})}var Flt=Nlt,klt=Flt;function zlt(t){return klt(t,function(e,n){return typeof n=="boolean"?JSON.stringify(n):n})}var Ult=zlt,Glt=kfe,jlt=Gfe;function Vlt(t){return function(e){var n;Glt.prototype.isPrototypeOf(e)?n=e:n=jlt(e);var r=Object.create(t);return r.client=n,r}}var $lt=Vlt,Wfe=ix,hi=Llt,yO=Blt,qfe=Ult,Hlt=$lt,I8={},Xfe=["country","region","postcode","district","place","locality","neighborhood","address","poi","poi.landmark"];I8.forwardGeocode=function(t){hi.assertShape({query:hi.required(hi.string),mode:hi.oneOf("mapbox.places","mapbox.places-permanent"),countries:hi.arrayOf(hi.string),proximity:hi.oneOf(hi.coordinates,"ip"),types:hi.arrayOf(hi.oneOf(Xfe)),autocomplete:hi.boolean,bbox:hi.arrayOf(hi.number),limit:hi.number,language:hi.arrayOf(hi.string),routing:hi.boolean,fuzzyMatch:hi.boolean,worldview:hi.string})(t),t.mode=t.mode||"mapbox.places";var e=qfe(Wfe({country:t.countries},yO(t,["proximity","types","autocomplete","bbox","limit","language","routing","fuzzyMatch","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:yO(t,["mode","query"]),query:e})};I8.reverseGeocode=function(t){hi.assertShape({query:hi.required(hi.coordinates),mode:hi.oneOf("mapbox.places","mapbox.places-permanent"),countries:hi.arrayOf(hi.string),types:hi.arrayOf(hi.oneOf(Xfe)),bbox:hi.arrayOf(hi.number),limit:hi.number,language:hi.arrayOf(hi.string),reverseMode:hi.oneOf("distance","score"),routing:hi.boolean,worldview:hi.string})(t),t.mode=t.mode||"mapbox.places";var e=qfe(Wfe({country:t.countries},yO(t,["country","types","bbox","limit","language","reverseMode","routing","worldview"])));return this.client.createRequest({method:"GET",path:"/geocoding/v5/:mode/:query.json",params:yO(t,["mode","query"]),query:e})};var Wlt=Hlt(I8);let qlt="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Zfe=t=>crypto.getRandomValues(new Uint8Array(t)),Yfe=(t,e,n)=>{let r=(2<<Math.log(t.length-1)/Math.LN2)-1,i=-~(1.6*r*e/t.length);return(o=e)=>{let a="";for(;;){let s=n(i),u=i;for(;u--;)if(a+=t[s[u]&r]||"",a.length===o)return a}}},Xlt=(t,e=21)=>Yfe(t,e,Zfe),Zlt=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");const Ylt=Object.freeze(Object.defineProperty({__proto__:null,customAlphabet:Xlt,customRandom:Yfe,nanoid:Zlt,random:Zfe,urlAlphabet:qlt},Symbol.toStringTag,{value:"Module"})),Qlt=ti(Ylt);var Klt=Qlt.nanoid;function Qfe(t){this.origin=t.origin||"https://api.mapbox.com",this.endpoint="events/v2",this.access_token=t.accessToken,this.version="0.2.0",this.sessionID=this.generateSessionID(),this.userAgent=this.getUserAgent(),this.options=t,this.send=this.send.bind(this),this.countries=t.countries?t.countries.split(","):null,this.types=t.types?t.types.split(","):null,this.bbox=t.bbox?t.bbox:null,this.language=t.language?t.language.split(","):null,this.limit=t.limit?+t.limit:null,this.locale=navigator.language||null,this.enableEventLogging=this.shouldEnableLogging(t),this.eventQueue=new Array,this.flushInterval=t.flushInterval||1e3,this.maxQueueSize=t.maxQueueSize||100,this.timer=this.flushInterval?setTimeout(this.flush.bind(this),this.flushInterval):null,this.lastSentInput="",this.lastSentIndex=0}Qfe.prototype={select:function(t,e){var n=this.getSelectedIndex(t,e),r=this.getEventPayload("search.select",e);if(r.resultIndex=n,r.resultPlaceName=t.place_name,r.resultId=t.id,!(n===this.lastSentIndex&&r.queryString===this.lastSentInput||n==-1)&&(this.lastSentIndex=n,this.lastSentInput=r.queryString,!!r.queryString))return this.push(r)},start:function(t){var e=this.getEventPayload("search.start",t);if(e.queryString)return this.push(e)},keyevent:function(t,e){if(t.key&&!(t.metaKey||[9,27,37,39,13,38,40].indexOf(t.keyCode)!==-1)){var n=this.getEventPayload("search.keystroke",e);if(n.lastAction=t.key,!!n.queryString)return this.push(n)}},send:function(t,e){if(!this.enableEventLogging)return e?e():void 0;var n=this.getRequestOptions(t);this.request(n,(function(r){if(r)return this.handleError(r,e);if(e)return e()}).bind(this))},getRequestOptions:function(t){Array.isArray(t)||(t=[t]);var e={method:"POST",host:this.origin,path:this.endpoint+"?access_token="+this.access_token,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)};return e},getEventPayload:function(t,e){var n;e.options.proximity?typeof e.options.proximity=="object"?n=[e.options.proximity.longitude,e.options.proximity.latitude]:e.options.proximity==="ip"?n=[999,999]:n=e.options.proximity:n=null;var r=e._map?e._map.getZoom():void 0,i={event:t,created:+new Date,sessionIdentifier:this.sessionID,country:this.countries,userAgent:this.userAgent,language:this.language,bbox:this.bbox,types:this.types,endpoint:"mapbox.places",autocomplete:e.options.autocomplete,fuzzyMatch:e.options.fuzzyMatch,proximity:n,limit:e.options.limit,routing:e.options.routing,worldview:e.options.worldview,mapZoom:r,keyboardLocale:this.locale};return t==="search.select"?i.queryString=e.inputString:t!="search.select"&&e._inputEl?i.queryString=e._inputEl.value:i.queryString=e.inputString,i},request:function(t,e){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(this.readyState==4)return this.status==204?e(null):e(this.statusText)},n.open(t.method,t.host+"/"+t.path,!0);for(var r in t.headers){var i=t.headers[r];n.setRequestHeader(r,i)}n.send(t.body)},handleError:function(t,e){if(e)return e(t)},generateSessionID:function(){return Klt()},getUserAgent:function(){return"mapbox-gl-geocoder."+this.version+"."+navigator.userAgent},getSelectedIndex:function(t,e){if(e._typeahead){var n=e._typeahead.data,r=t.id,i=n.map(function(a){return a.id}),o=i.indexOf(r);return o}},shouldEnableLogging:function(t){return!(t.enableEventLogging===!1||t.origin&&t.origin!=="https://api.mapbox.com"||t.localGeocoder||t.filter)},flush:function(){this.eventQueue.length>0&&(this.send(this.eventQueue),this.eventQueue=new Array),this.timer&&clearTimeout(this.timer),this.flushInterval&&(this.timer=setTimeout(this.flush.bind(this),this.flushInterval))},push:function(t,e){this.eventQueue.push(t),(this.eventQueue.length>=this.maxQueueSize||e)&&this.flush()},remove:function(){this.flush()}};var Jlt=Qfe,eut={de:"Suche",it:"Ricerca",en:"Search",nl:"Zoeken",fr:"Chercher",ca:"Cerca",he:"",ja:"",lv:"Meklt",pt:"Procurar",sr:"",zh:"",cs:"Vyhledvn",hu:"Keress",ka:"",nb:"Ske",sk:"Vyhadvanie",th:"",fi:"Hae",is:"Leita",ko:"",pl:"Szukaj",sl:"Iskanje",fa:"",ru:""},tut={placeholder:eut},Kfe={exports:{}};(function(t){(function(e,n,r){t.exports?t.exports=r():e[n]=r()})(Ya,"subtag",function(){var e="",n=/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/;function r(u){return u.match(n)||[]}function i(u){return r(u).filter(function(d,g){return d&&g})}function o(u){return u=r(u),{language:u[1]||e,extlang:u[2]||e,script:u[3]||e,region:u[4]||e}}function a(u,d,g){Object.defineProperty(u,d,{value:g,enumerable:!0})}function s(u,d,g){function _(E){return r(E)[u]||e}a(_,"pattern",d),a(o,g,_)}return s(1,/^[a-zA-Z]{2,3}$/,"language"),s(2,/^[a-zA-Z]{3}$/,"extlang"),s(3,/^[a-zA-Z]{4}$/,"script"),s(4,/^[a-zA-Z]{2}$|^[0-9]{3}$/,"region"),a(o,"split",i),o})})(Kfe);var nut=Kfe.exports;function Jfe(){}Jfe.prototype={isSupport:function(){return!!window.navigator.geolocation},getCurrentPosition:function(){const t={enableHighAccuracy:!0};return new Promise(function(e,n){window.navigator.geolocation.getCurrentPosition(e,n,t)})}};var rut=Jfe;function iut(t,e){const n=ehe(t),r=["address","street","place","country"];var i;if(typeof e=="function")return e(n);const o=r.indexOf(e);return o===-1?i=r:i=r.slice(o),i.reduce(function(a,s){return n[s]?(a!==""&&(a=a+", "),a+n[s]):a},"")}function ehe(t){const e=t.address||"",n=t.text||"",r=t.place_name||"",o={address:r.split(",")[0],houseNumber:e,street:n,placeName:r};return t.context.forEach(function(a){const s=a.id.split(".")[0];o[s]=a.text}),o}const out=/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/;var sut={transformFeatureToGeolocationText:iut,getAddressInfo:ehe,REVERSE_GEOCODE_COORD_RGX:out},aut=uat,lut=Cat,v0=ix,uut=Dat.EventEmitter,hK=Bat,RN=_lt,LN=Wlt,cut=Jlt,fut=tut,hut=nut,dut=rut,dK=sut;const ym={FORWARD:0,LOCAL:1,REVERSE:2};function put(){var t=document.createElement("div");return t.className="mapboxgl-ctrl-geocoder--powered-by",t.innerHTML='<a href="https://www.mapbox.com/search-service" target="_blank">Powered by Mapbox</a>',t}function the(t){this._eventEmitter=new uut,this.options=v0({},this.options,t),this.inputString="",this.fresh=!0,this.lastSelected=null,this.geolocation=new dut}the.prototype={options:{zoom:16,flyTo:!0,trackProximity:!0,minLength:2,reverseGeocode:!1,flipCoordinates:!1,limit:5,origin:"https://api.mapbox.com",enableEventLogging:!0,marker:!0,mapboxgl:null,collapsed:!1,clearAndBlurOnEsc:!1,clearOnBlur:!1,enableGeolocation:!1,addressAccuracy:"street",getItemValue:function(t){return t.place_name},render:function(t){var e=t.place_name.split(",");return'<div class="mapboxgl-ctrl-geocoder--suggestion"><div class="mapboxgl-ctrl-geocoder--suggestion-title">'+e[0]+'</div><div class="mapboxgl-ctrl-geocoder--suggestion-address">'+e.splice(1,e.length).join(",")+"</div></div>"}},addTo:function(t){function e(n,r){if(!document.body.contains(r))throw new Error("Element provided to #addTo() exists, but is not in the DOM");const i=n.onAdd();r.appendChild(i)}if(t._controlContainer)t.addControl(this);else if(t instanceof HTMLElement)e(this,t);else if(typeof t=="string"){const n=document.querySelectorAll(t);if(n.length===0)throw new Error("Element ",t,"not found.");if(n.length>1)throw new Error("Geocoder can only be added to a single html element");e(this,n[0])}else throw new Error("Error: addTo must be a mapbox-gl-js map, an html element, or a CSS selector query for a single html element")},onAdd:function(t){if(t&&typeof t!="string"&&(this._map=t),this.setLanguage(),this.options.localGeocoderOnly||(this.geocoderService=LN(RN({accessToken:this.options.accessToken,origin:this.options.origin}))),this.options.localGeocoderOnly&&!this.options.localGeocoder)throw new Error("A localGeocoder function must be specified to use localGeocoderOnly mode");this.eventManager=new cut(this.options),this._onChange=this._onChange.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._onPaste=this._onPaste.bind(this),this._onBlur=this._onBlur.bind(this),this._showButton=this._showButton.bind(this),this._hideButton=this._hideButton.bind(this),this._onQueryResult=this._onQueryResult.bind(this),this.clear=this.clear.bind(this),this._updateProximity=this._updateProximity.bind(this),this._collapse=this._collapse.bind(this),this._unCollapse=this._unCollapse.bind(this),this._clear=this._clear.bind(this),this._clearOnBlur=this._clearOnBlur.bind(this),this._geolocateUser=this._geolocateUser.bind(this);var e=this.container=document.createElement("div");e.className="mapboxgl-ctrl-geocoder mapboxgl-ctrl";var n=this.createIcon("search",'<path d="M7.4 2.5c-2.7 0-4.9 2.2-4.9 4.9s2.2 4.9 4.9 4.9c1 0 1.8-.2 2.5-.8l3.7 3.7c.2.2.4.3.8.3.7 0 1.1-.4 1.1-1.1 0-.3-.1-.5-.3-.8L11.4 10c.4-.8.8-1.6.8-2.5.1-2.8-2.1-5-4.8-5zm0 1.6c1.8 0 3.2 1.4 3.2 3.2s-1.4 3.2-3.2 3.2-3.3-1.3-3.3-3.1 1.4-3.3 3.3-3.3z"/>');this._inputEl=document.createElement("input"),this._inputEl.type="text",this._inputEl.className="mapboxgl-ctrl-geocoder--input",this.setPlaceholder(),this.options.collapsed&&(this._collapse(),this.container.addEventListener("mouseenter",this._unCollapse),this.container.addEventListener("mouseleave",this._collapse),this._inputEl.addEventListener("focus",this._unCollapse)),(this.options.collapsed||this.options.clearOnBlur)&&this._inputEl.addEventListener("blur",this._onBlur),this._inputEl.addEventListener("keydown",lut(this._onKeyDown,200)),this._inputEl.addEventListener("paste",this._onPaste),this._inputEl.addEventListener("change",this._onChange),this.container.addEventListener("mouseenter",this._showButton),this.container.addEventListener("mouseleave",this._hideButton),this._inputEl.addEventListener("keyup",(function(d){this.eventManager.keyevent(d,this)}).bind(this));var r=document.createElement("div");r.classList.add("mapboxgl-ctrl-geocoder--pin-right"),this._clearEl=document.createElement("button"),this._clearEl.setAttribute("aria-label","Clear"),this._clearEl.addEventListener("click",this.clear),this._clearEl.className="mapboxgl-ctrl-geocoder--button";var i=this.createIcon("close",'<path d="M3.8 2.5c-.6 0-1.3.7-1.3 1.3 0 .3.2.7.5.8L7.2 9 3 13.2c-.3.3-.5.7-.5 1 0 .6.7 1.3 1.3 1.3.3 0 .7-.2 1-.5L9 10.8l4.2 4.2c.2.3.7.3 1 .3.6 0 1.3-.7 1.3-1.3 0-.3-.2-.7-.3-1l-4.4-4L15 4.6c.3-.2.5-.5.5-.8 0-.7-.7-1.3-1.3-1.3-.3 0-.7.2-1 .3L9 7.1 4.8 2.8c-.3-.1-.7-.3-1-.3z"/>');if(this._clearEl.appendChild(i),this._loadingEl=this.createIcon("loading",'<path fill="#333" d="M4.4 4.4l.8.8c2.1-2.1 5.5-2.1 7.6 0l.8-.8c-2.5-2.5-6.7-2.5-9.2 0z"/><path opacity=".1" d="M12.8 12.9c-2.1 2.1-5.5 2.1-7.6 0-2.1-2.1-2.1-5.5 0-7.7l-.8-.8c-2.5 2.5-2.5 6.7 0 9.2s6.6 2.5 9.2 0 2.5-6.6 0-9.2l-.8.8c2.2 2.1 2.2 5.6 0 7.7z"/>'),r.appendChild(this._clearEl),r.appendChild(this._loadingEl),e.appendChild(n),e.appendChild(this._inputEl),e.appendChild(r),this.options.enableGeolocation&&this.geolocation.isSupport()){this._geolocateEl=document.createElement("button"),this._geolocateEl.setAttribute("aria-label","Geolocate"),this._geolocateEl.addEventListener("click",this._geolocateUser),this._geolocateEl.className="mapboxgl-ctrl-geocoder--button";var o=this.createIcon("geolocate",'<path d="M12.999 3.677L2.042 8.269c-.962.403-.747 1.823.29 1.912l5.032.431.431 5.033c.089 1.037 1.509 1.252 1.912.29l4.592-10.957c.345-.822-.477-1.644-1.299-1.299z" fill="#4264fb"/>');this._geolocateEl.appendChild(o),r.appendChild(this._geolocateEl),this._showGeolocateButton()}var a=this._typeahead=new aut(this._inputEl,[],{filter:!1,minLength:this.options.minLength,limit:this.options.limit});this.setRenderFunction(this.options.render),a.getItemValue=this.options.getItemValue;var s=a.list.draw,u=this._footerNode=put();return a.list.draw=function(){s.call(this),u.addEventListener("mousedown",(function(){this.selectingListItem=!0}).bind(this)),u.addEventListener("mouseup",(function(){this.selectingListItem=!1}).bind(this)),this.element.appendChild(u)},this.mapMarker=null,this._handleMarker=this._handleMarker.bind(this),this._map&&(this.options.trackProximity&&(this._updateProximity(),this._map.on("moveend",this._updateProximity)),this._mapboxgl=this.options.mapboxgl,!this._mapboxgl&&this.options.marker&&(console.error("No mapboxgl detected in options. Map markers are disabled. Please set options.mapboxgl."),this.options.marker=!1)),e},_geolocateUser:function(){this._hideGeolocateButton(),this._showLoadingIcon(),this.geolocation.getCurrentPosition().then((function(t){this._hideLoadingIcon();const e={geometry:{type:"Point",coordinates:[t.coords.longitude,t.coords.latitude]}};this._handleMarker(e),this._fly(e),this._typeahead.clear(),this._typeahead.selected=!0,this.lastSelected=JSON.stringify(e),this._showClearButton(),this.fresh=!1;const n={limit:1,language:[this.options.language],query:e.geometry.coordinates,types:["address"]};if(this.options.localGeocoderOnly){const r=e.geometry.coordinates[0]+","+e.geometry.coordinates[1];this._setInputValue(r),this._eventEmitter.emit("result",{result:e})}else this.geocoderService.reverseGeocode(n).send().then((function(r){const i=r.body.features[0];if(i){const o=dK.transformFeatureToGeolocationText(i,this.options.addressAccuracy);this._setInputValue(o),i.user_coordinates=e.geometry.coordinates,this._eventEmitter.emit("result",{result:i})}else this._eventEmitter.emit("result",{result:{user_coordinates:e.geometry.coordinates}})}).bind(this))}).bind(this)).catch((function(t){t.code===1?this._renderUserDeniedGeolocationError():this._renderLocationError(),this._hideLoadingIcon(),this._showGeolocateButton(),this._hideAttribution()}).bind(this))},createIcon:function(t,e){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("class","mapboxgl-ctrl-geocoder--icon mapboxgl-ctrl-geocoder--icon-"+t),n.setAttribute("viewBox","0 0 18 18"),n.setAttribute("xml:space","preserve"),n.setAttribute("width",18),n.setAttribute("height",18),n.innerHTML=e,n},onRemove:function(){return this.container.parentNode.removeChild(this.container),this.options.trackProximity&&this._map&&this._map.off("moveend",this._updateProximity),this._removeMarker(),this._map=null,this},_setInputValue:function(t){this._inputEl.value=t,setTimeout((function(){this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0)}).bind(this),1)},_onPaste:function(t){var e=(t.clipboardData||window.clipboardData).getData("text");e.length>=this.options.minLength&&this._geocode(e)},_onKeyDown:function(t){var e=27,n=9;if(t.keyCode===e&&this.options.clearAndBlurOnEsc)return this._clear(t),this._inputEl.blur();var r=t.target&&t.target.shadowRoot?t.target.shadowRoot.activeElement:t.target,i=r?r.value:"";if(!i)return this.fresh=!0,t.keyCode!==n&&this.clear(t),this._showGeolocateButton(),this._hideClearButton();this._hideGeolocateButton(),!(t.metaKey||[n,e,37,39,13,38,40].indexOf(t.keyCode)!==-1)&&r.value.length>=this.options.minLength&&this._geocode(r.value)},_showButton:function(){this._typeahead.selected&&this._showClearButton()},_hideButton:function(){this._typeahead.selected&&this._hideClearButton()},_showClearButton:function(){this._clearEl.style.display="block"},_hideClearButton:function(){this._clearEl.style.display="none"},_showGeolocateButton:function(){this._geolocateEl&&this.geolocation.isSupport()&&(this._geolocateEl.style.display="block")},_hideGeolocateButton:function(){this._geolocateEl&&(this._geolocateEl.style.display="none")},_showLoadingIcon:function(){this._loadingEl.style.display="block"},_hideLoadingIcon:function(){this._loadingEl.style.display="none"},_showAttribution:function(){this._footerNode.style.display="block"},_hideAttribution:function(){this._footerNode.style.display="none"},_onBlur:function(t){this.options.clearOnBlur&&this._clearOnBlur(t),this.options.collapsed&&this._collapse()},_onChange:function(){var t=this._typeahead.selected;t&&JSON.stringify(t)!==this.lastSelected&&(this._hideClearButton(),this.options.flyTo&&this._fly(t),this.options.marker&&this._mapboxgl&&this._handleMarker(t),this._inputEl.focus(),this._inputEl.scrollLeft=0,this._inputEl.setSelectionRange(0,0),this.lastSelected=JSON.stringify(t),this._eventEmitter.emit("result",{result:t}),this.eventManager.select(t,this))},_fly:function(t){var e;if(t.properties&&hK[t.properties.short_code])e=v0({},this.options.flyTo),this._map&&this._map.fitBounds(hK[t.properties.short_code].bbox,e);else if(t.bbox){var n=t.bbox;e=v0({},this.options.flyTo),this._map&&this._map.fitBounds([[n[0],n[1]],[n[2],n[3]]],e)}else{var r={zoom:this.options.zoom};e=v0({},r,this.options.flyTo),t.center?e.center=t.center:t.geometry&&t.geometry.type&&t.geometry.type==="Point"&&t.geometry.coordinates&&(e.center=t.geometry.coordinates),this._map&&this._map.flyTo(e)}},_requestType:function(t,e){var n;return t.localGeocoderOnly?n=ym.LOCAL:t.reverseGeocode&&dK.REVERSE_GEOCODE_COORD_RGX.test(e)?n=ym.REVERSE:n=ym.FORWARD,n},_setupConfig:function(t,e){const n=["bbox","limit","proximity","countries","types","language","reverseMode","mode","autocomplete","fuzzyMatch","routing","worldview"],r=/[\s,]+/;var i=this,o=n.reduce(function(s,u){if(i.options[u]===void 0||i.options[u]===null)return s;["countries","types","language"].indexOf(u)>-1?s[u]=i.options[u].split(r):s[u]=i.options[u];const d=typeof i.options[u].longitude=="number"&&typeof i.options[u].latitude=="number";if(u==="proximity"&&d){const g=i.options[u].longitude,_=i.options[u].latitude;s[u]=[g,_]}return s},{});switch(t){case ym.REVERSE:{var a=e.split(r).map(function(s){return parseFloat(s,10)});i.options.flipCoordinates||a.reverse(),o.types&&o.types[0],o=v0(o,{query:a,limit:1}),["proximity","autocomplete","fuzzyMatch","bbox"].forEach(function(s){s in o&&delete o[s]})}break;case ym.FORWARD:{const s=e.trim();/^(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)?$/.test(s)&&(e=e.replace(/,/g," ")),o=v0(o,{query:e})}break}return o},_geocode:function(t){this.inputString=t,this._showLoadingIcon(),this._eventEmitter.emit("loading",{query:t});const e=this._requestType(this.options,t),n=this._setupConfig(e,t);var r;switch(e){case ym.LOCAL:r=Promise.resolve();break;case ym.FORWARD:r=this.geocoderService.forwardGeocode(n).send();break;case ym.REVERSE:r=this.geocoderService.reverseGeocode(n).send();break}var i=this.options.localGeocoder?this.options.localGeocoder(t)||[]:[],o=[],a=null;return r.catch((function(s){a=s}).bind(this)).then((function(s){this._hideLoadingIcon();var u={};return s?s.statusCode=="200"&&(u=s.body,u.request=s.request,u.headers=s.headers):u={type:"FeatureCollection",features:[]},u.config=n,this.fresh&&(this.eventManager.start(this),this.fresh=!1),u.features=u.features?i.concat(u.features):i,this.options.externalGeocoder?(o=this.options.externalGeocoder(t,u.features)||Promise.resolve([]),o.then(function(d){return u.features=u.features?d.concat(u.features):d,u},function(){return u})):u}).bind(this)).then((function(s){if(a)throw a;this.options.filter&&s.features.length&&(s.features=s.features.filter(this.options.filter)),s.features.length?(this._showClearButton(),this._hideGeolocateButton(),this._showAttribution(),this._eventEmitter.emit("results",s),this._typeahead.update(s.features)):(this._hideClearButton(),this._hideAttribution(),this._typeahead.selected=null,this._renderNoResults(),this._eventEmitter.emit("results",s))}).bind(this)).catch((function(s){this._hideLoadingIcon(),this._hideAttribution(),i.length&&this.options.localGeocoder||o.length&&this.options.externalGeocoder?(this._showClearButton(),this._hideGeolocateButton(),this._typeahead.update(i)):(this._hideClearButton(),this._typeahead.selected=null,this._renderError()),this._eventEmitter.emit("results",{features:i}),this._eventEmitter.emit("error",{error:s})}).bind(this)),r},_clear:function(t){t&&t.preventDefault(),this._inputEl.value="",this._typeahead.selected=null,this._typeahead.clear(),this._onChange(),this._hideClearButton(),this._showGeolocateButton(),this._removeMarker(),this.lastSelected=null,this._eventEmitter.emit("clear"),this.fresh=!0},clear:function(t){this._clear(t),this._inputEl.focus()},_clearOnBlur:function(t){var e=this;t.relatedTarget&&e._clear(t)},_onQueryResult:function(t){var e=t.body;if(e.features.length){var n=e.features[0];this._typeahead.selected=n,this._inputEl.value=n.place_name,this._onChange()}},_updateProximity:function(){if(!(!this._map||!this.options.trackProximity))if(this._map.getZoom()>9){var t=this._map.getCenter().wrap();this.setProximity({longitude:t.lng,latitude:t.lat},!1)}else this.setProximity(null,!1)},_collapse:function(){!this._inputEl.value&&this._inputEl!==document.activeElement&&this.container.classList.add("mapboxgl-ctrl-geocoder--collapsed")},_unCollapse:function(){this.container.classList.remove("mapboxgl-ctrl-geocoder--collapsed")},query:function(t){return this._geocode(t).then(this._onQueryResult),this},_renderError:function(){var t="<div class='mapbox-gl-geocoder--error'>There was an error reaching the server</div>";this._renderMessage(t)},_renderLocationError:function(){var t="<div class='mapbox-gl-geocoder--error'>A location error has occurred</div>";this._renderMessage(t)},_renderNoResults:function(){var t="<div class='mapbox-gl-geocoder--error mapbox-gl-geocoder--no-results'>No results found</div>";this._renderMessage(t)},_renderUserDeniedGeolocationError:function(){var t="<div class='mapbox-gl-geocoder--error'>Geolocation permission denied</div>";this._renderMessage(t)},_renderMessage:function(t){this._typeahead.update([]),this._typeahead.selected=null,this._typeahead.clear(),this._typeahead.renderError(t)},_getPlaceholderText:function(){if(this.options.placeholder)return this.options.placeholder;if(this.options.language){var t=this.options.language.split(",")[0],e=hut.language(t),n=fut.placeholder[e];if(n)return n}return"Search"},setInput:function(t){return this._inputEl.value=t,this._typeahead.selected=null,this._typeahead.clear(),t.length>=this.options.minLength&&this._geocode(t),this},setProximity:function(t,e=!0){return this.options.proximity=t,e&&(this.options.trackProximity=!1),this},getProximity:function(){return this.options.proximity},setRenderFunction:function(t){return t&&typeof t=="function"&&(this._typeahead.render=t),this},getRenderFunction:function(){return this._typeahead.render},setLanguage:function(t){var e=navigator.language||navigator.userLanguage||navigator.browserLanguage;return this.options.language=t||this.options.language||e,this},getLanguage:function(){return this.options.language},getZoom:function(){return this.options.zoom},setZoom:function(t){return this.options.zoom=t,this},getFlyTo:function(){return this.options.flyTo},setFlyTo:function(t){return this.options.flyTo=t,this},getPlaceholder:function(){return this.options.placeholder},setPlaceholder:function(t){return this.placeholder=t||this._getPlaceholderText(),this._inputEl.placeholder=this.placeholder,this._inputEl.setAttribute("aria-label",this.placeholder),this},getBbox:function(){return this.options.bbox},setBbox:function(t){return this.options.bbox=t,this},getCountries:function(){return this.options.countries},setCountries:function(t){return this.options.countries=t,this},getTypes:function(){return this.options.types},setTypes:function(t){return this.options.types=t,this},getMinLength:function(){return this.options.minLength},setMinLength:function(t){return this.options.minLength=t,this._typeahead&&(this._typeahead.options.minLength=t),this},getLimit:function(){return this.options.limit},setLimit:function(t){return this.options.limit=t,this._typeahead&&(this._typeahead.options.limit=t),this},getFilter:function(){return this.options.filter},setFilter:function(t){return this.options.filter=t,this},setOrigin:function(t){return this.options.origin=t,this.geocoderService=LN(RN({accessToken:this.options.accessToken,origin:this.options.origin})),this},getOrigin:function(){return this.options.origin},setAccessToken:function(t){return this.options.accessToken=t,this.geocoderService=LN(RN({accessToken:this.options.accessToken,origin:this.options.origin})),this},setAutocomplete:function(t){return this.options.autocomplete=t,this},getAutocomplete:function(){return this.options.autocomplete},setFuzzyMatch:function(t){return this.options.fuzzyMatch=t,this},getFuzzyMatch:function(){return this.options.fuzzyMatch},setRouting:function(t){return this.options.routing=t,this},getRouting:function(){return this.options.routing},setWorldview:function(t){return this.options.worldview=t,this},getWorldview:function(){return this.options.worldview},_handleMarker:function(t){if(this._map){this._removeMarker();var e={color:"#4668F2"},n=v0({},e,this.options.marker);return this.mapMarker=new this._mapboxgl.Marker(n),t.center?this.mapMarker.setLngLat(t.center).addTo(this._map):t.geometry&&t.geometry.type&&t.geometry.type==="Point"&&t.geometry.coordinates&&this.mapMarker.setLngLat(t.geometry.coordinates).addTo(this._map),this}},_removeMarker:function(){this.mapMarker&&(this.mapMarker.remove(),this.mapMarker=null)},on:function(t,e){return this._eventEmitter.on(t,e),this},off:function(t,e){return this._eventEmitter.removeListener(t,e),this.eventManager.remove(),this}};var gut=the;const mut=_A(gut);E8.accessToken="pk.eyJ1IjoicHY1NjY3IiwiYSI6ImNsZGFtOHVoejBiZ2Mzb3A2djgyaDl1OGEifQ.FSssERk7wLiG1fDpen0iXA";function Aut(){const t=Ee.useRef(null),[e,n]=Ee.useContext(rx);return Ee.useEffect(()=>{const r=new mut({accessToken:E8.accessToken,types:"country,region,place,postcode,locality,neighborhood,address,poi",placeholder:"Type in an area of interest to get started."});t.current&&r.addTo(t.current),r.on("result",i=>{n(i.result),console.log(i.result)}),r.on("clear",()=>{})},[]),Un.jsx("div",{children:Un.jsx("div",{ref:t})})}function _ut(){const e=Ee.useContext(rx)[0];return console.log("SelectionInterface location: ",e),Un.jsx("div",{children:Un.jsx(Jst,{})})}function XL(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(d){try{u(r.next(d))}catch(g){o(g)}}function s(d){try{u(r.throw(d))}catch(g){o(g)}}function u(d){var g;d.done?i(d.value):(g=d.value,g instanceof n?g:new n(function(_){_(g)})).then(a,s)}u((r=r.apply(t,e||[])).next())})}function Xm(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function s(u){return function(d){return function(g){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&g[0]?r.return:g[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,g[1])).done)return i;switch(r=0,i&&(g=[2&g[0],i.value]),g[0]){case 0:case 1:i=g;break;case 4:return a.label++,{value:g[1],done:!1};case 5:a.label++,r=g[1],g=[0];continue;case 7:g=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||g[0]!==6&&g[0]!==2)){a=0;continue}if(g[0]===3&&(!i||g[1]>i[0]&&g[1]<i[3])){a.label=g[1];break}if(g[0]===6&&a.label<i[1]){a.label=i[1],i=g;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(g);break}i[2]&&a.ops.pop(),a.trys.pop();continue}g=e.call(t,a)}catch(_){g=[6,_],r=0}finally{n=i=0}if(5&g[0])throw g[1];return{value:g[0]?g[1]:void 0,done:!0}}([u,d])}}}function az(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function fh(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(e===void 0||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function Rd(t,e,n){if(n||arguments.length===2)for(var r,i=0,o=e.length;i<o;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}function pK(t,e,n,r,i){for(var o=[],a=5;a<arguments.length;a++)o[a-5]=arguments[a];return XL(this,void 0,void 0,function(){var s,u,d,g,_,E;return Xm(this,function(P){switch(P.label){case 0:P.trys.push([0,12,13,14]),s=az(o),u=s.next(),P.label=1;case 1:if(u.done)return[3,11];switch(d=u.value,typeof d){case"string":return[3,2];case"number":return[3,4];case"function":return[3,6]}return[3,8];case 2:return[4,yut(t,e,d,n,r,i)];case 3:return P.sent(),[3,10];case 4:return[4,nhe(d)];case 5:return P.sent(),[3,10];case 6:return[4,d.apply(void 0,Rd([t,e,n,r,i],fh(o),!1))];case 7:return P.sent(),[3,10];case 8:return[4,d];case 9:P.sent(),P.label=10;case 10:return u=s.next(),[3,1];case 11:return[3,14];case 12:return g=P.sent(),_={error:g},[3,14];case 13:try{u&&!u.done&&(E=s.return)&&E.call(s)}finally{if(_)throw _.error}return[7];case 14:return[2]}})})}function yut(t,e,n,r,i,o){return XL(this,void 0,void 0,function(){var a,s;return Xm(this,function(u){switch(u.label){case 0:return a=t.textContent||"",s=function(d,g){var _=fh(g).slice(0);return Rd(Rd([],fh(d),!1),[NaN],!1).findIndex(function(E,P){return _[P]!==E})}(a,n),[4,vut(t,Rd(Rd([],fh(but(a,e,s)),!1),fh(xut(n,e,s)),!1),r,i,o)];case 1:return u.sent(),[2]}})})}function nhe(t){return XL(this,void 0,void 0,function(){return Xm(this,function(e){switch(e.label){case 0:return[4,new Promise(function(n){return setTimeout(n,t)})];case 1:return e.sent(),[2]}})})}function vut(t,e,n,r,i){return XL(this,void 0,void 0,function(){var o,a,s,u,d,g,_,E,P,O,D,V,k;return Xm(this,function(F){switch(F.label){case 0:if(o=e,i){for(a=0,s=1;s<e.length;s++)if(u=fh([e[s-1],e[s]],2),d=u[0],(g=u[1]).length>d.length||g===""){a=s;break}o=e.slice(a,e.length)}F.label=1;case 1:F.trys.push([1,6,7,8]),_=az(function(z){var X,Y,J,re,ue,ie,ce;return Xm(this,function(se){switch(se.label){case 0:X=function(me){return Xm(this,function(Ce){switch(Ce.label){case 0:return[4,{op:function(we){return requestAnimationFrame(function(){return we.textContent=me})},opCode:function(we){var Ye=we.textContent||"";return me===""||Ye.length>me.length?"DELETE":"WRITING"}}];case 1:return Ce.sent(),[2]}})},se.label=1;case 1:se.trys.push([1,6,7,8]),Y=az(z),J=Y.next(),se.label=2;case 2:return J.done?[3,5]:(re=J.value,[5,X(re)]);case 3:se.sent(),se.label=4;case 4:return J=Y.next(),[3,2];case 5:return[3,8];case 6:return ue=se.sent(),ie={error:ue},[3,8];case 7:try{J&&!J.done&&(ce=Y.return)&&ce.call(Y)}finally{if(ie)throw ie.error}return[7];case 8:return[2]}})}(o)),E=_.next(),F.label=2;case 2:return E.done?[3,5]:(P=E.value,O=P.opCode(t)==="WRITING"?n+n*(Math.random()-.5):r+r*(Math.random()-.5),P.op(t),[4,nhe(O)]);case 3:F.sent(),F.label=4;case 4:return E=_.next(),[3,2];case 5:return[3,8];case 6:return D=F.sent(),V={error:D},[3,8];case 7:try{E&&!E.done&&(k=_.return)&&k.call(_)}finally{if(V)throw V.error}return[7];case 8:return[2]}})})}function xut(t,e,n){var r,i;return n===void 0&&(n=0),Xm(this,function(o){switch(o.label){case 0:r=e(t),i=r.length,o.label=1;case 1:return n<i?[4,r.slice(0,++n).join("")]:[3,3];case 2:return o.sent(),[3,1];case 3:return[2]}})}function but(t,e,n){var r,i;return n===void 0&&(n=0),Xm(this,function(o){switch(o.label){case 0:r=e(t),i=r.length,o.label=1;case 1:return i>n?[4,r.slice(0,--i).join("")]:[3,3];case 2:return o.sent(),[3,1];case 3:return[2]}})}var wut="index-module_type__E-SaG";(function(t,e){e===void 0&&(e={});var n=e.insertAt;if(t&&typeof document<"u"){var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css",n==="top"&&r.firstChild?r.insertBefore(i,r.firstChild):r.appendChild(i),i.styleSheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))}})(`.index-module_type__E-SaG::after {
  content: '|';
  animation: index-module_cursor__PQg0P 1.1s infinite step-start;
}

@keyframes index-module_cursor__PQg0P {
  50% {
    opacity: 0;
  }
}
`);Ee.memo(Ee.forwardRef(function(t,e){var n=t.sequence,r=t.repeat,i=t.className,o=t.speed,a=o===void 0?40:o,s=t.deletionSpeed,u=t.omitDeletionAnimation,d=u!==void 0&&u,g=t.preRenderFirstString,_=g!==void 0&&g,E=t.wrapper,P=E===void 0?"span":E,O=t.splitter,D=O===void 0?function(Re){return Rd([],fh(Re),!1)}:O,V=t.cursor,k=V===void 0||V,F=t.style,z=function(Re,qe){var ct={};for(var Ct in Re)Object.prototype.hasOwnProperty.call(Re,Ct)&&qe.indexOf(Ct)<0&&(ct[Ct]=Re[Ct]);if(Re!=null&&typeof Object.getOwnPropertySymbols=="function"){var Dt=0;for(Ct=Object.getOwnPropertySymbols(Re);Dt<Ct.length;Dt++)qe.indexOf(Ct[Dt])<0&&Object.prototype.propertyIsEnumerable.call(Re,Ct[Dt])&&(ct[Ct[Dt]]=Re[Ct[Dt]])}return ct}(t,["sequence","repeat","className","speed","deletionSpeed","omitDeletionAnimation","preRenderFirstString","wrapper","splitter","cursor","style"]),X=z["aria-label"],Y=z["aria-hidden"],J=z.role;s||(s=a);var re=new Array(2).fill(40);[a,s].forEach(function(Re,qe){switch(typeof Re){case"number":re[qe]=Math.abs(Re-100);break;case"object":var ct=Re.type,Ct=Re.value;if(typeof Ct!="number")break;ct==="keyStrokeDelayInMs"&&(re[qe]=Ct)}});var ue,ie,ce,se,me,Ce,we=re[0],Ye=re[1],at=function(Re,qe){qe===void 0&&(qe=null);var ct=Ee.useRef(qe);return Ee.useEffect(function(){Re&&(typeof Re=="function"?Re(ct.current):Re.current=ct.current)},[Re]),ct}(e),yt=wut;ue=i?"".concat(k?yt+" ":"").concat(i):k?yt:"",ie=Ee.useRef(function(){var Re,qe=n;r===1/0?Re=pK:typeof r=="number"&&(qe=Array(1+r).fill(n).flat());var ct=Re?Rd(Rd([],fh(qe),!1),[Re],!1):Rd([],fh(qe),!1);return pK.apply(void 0,Rd([at.current,D,we,Ye,d],fh(ct),!1)),function(){at.current}}),ce=Ee.useRef(),se=Ee.useRef(!1),me=Ee.useRef(!1),Ce=fh(Ee.useState(0),2)[1],se.current&&(me.current=!0),Ee.useEffect(function(){return se.current||(ce.current=ie.current(),se.current=!0),Ce(function(Re){return Re+1}),function(){me.current&&ce.current&&ce.current()}},[]);var be=P,De=_?n.find(function(Re){return typeof Re=="string"})||"":null;return ut.createElement(be,{"aria-hidden":Y,"aria-label":X,role:J,style:F,className:ue,children:X?ut.createElement("span",{"aria-hidden":"true",ref:at,children:De}):De,ref:X?void 0:at})}),function(t,e){return!0});function Eut(){return Un.jsxs("div",{children:[Un.jsx("nav",{class:"rounded-xl px-4 lg:px-6 py-8",children:Un.jsx("a",{href:"/",children:Un.jsx(kce,{fit:"contain",height:60,src:"./SolarSense_Logo.png"})})}),Un.jsx("div",{class:"mx-auto max-w-2xl py-6 pt-2 space-y-4",children:Un.jsx(Nh,{style:{fontWeight:"bold",fontSize:"45px",display:"inline-block",color:"#e8caf1"},children:"Unlock Solar Panel Insights with Geospatial AI"})})]})}function gK({file:t}){return Un.jsx(y8,{inline:!0,sx:e=>({fontSize:e.fontSizes.sm,borderRadius:e.radius.sm,color:e.colors.gray[1]}),children:Un.jsx("span",{style:{whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",maxWidth:pn(200),display:"inline-block"},children:t.name})})}const Sut=({value:t})=>Array.isArray(t)?Un.jsx(Group,{spacing:"sm",py:"xs",children:t.map((e,n)=>Un.jsx(gK,{file:e},n))}):Un.jsx(gK,{file:t});function Tut(){const[t,e]=Ee.useContext(rx),[n,r]=Ee.useContext(HL),i=o=>{const a=new FileReader;a.onload=s=>{const u=JSON.parse(s.target.result),d={units:"kilometers",mask:u};r(pfe(j0(G6(u,.06)),.12,d));const g=lR(u.features[0].geometry);u.center=g.geometry.coordinates,e(u),console.log("Uploaded Location: ",u)},a.readAsText(o)};return Un.jsx(y8,{children:Un.jsx("div",{class:"text-white hover:outline-blue-400 focus:outline-none focus:ring focus:ring-violet-300",children:Un.jsx(mit,{sx:{color:"white"},placeholder:"Upload GeoJSON",onChange:i,icon:Un.jsx(qst,{size:pn(20),style:{color:"white"}}),accept:".geojson,application/json",valueComponent:Sut})})})}function Cut(){return Ee.useContext(rx),Ee.useContext(HL),Un.jsx("div",{class:"max-w-2xl mx-auto pb-8",children:Un.jsxs(x8,{children:[Un.jsx(Y4,{theme:{colorScheme:"dark"},children:Un.jsxs(Vp,{shadow:"md",closeDelay:250,children:[Un.jsx(Vp.Target,{children:Un.jsx("div",{class:"p-6 hover:outline-blue-400",children:Un.jsx(Aut,{})})}),Un.jsx(Vp.Dropdown,{children:Un.jsx(Nh,{size:"sm",children:'Then draw an area to be analyzed on the map and click "Submit Selection"!'})})]})}),Un.jsx(Jle,{size:"lg",my:"xs",label:"OR",labelPosition:"center"}),Un.jsxs(Vp,{shadow:"md",closeDelay:250,children:[Un.jsx(Vp.Target,{children:Un.jsx("div",{children:Un.jsx(Tut,{})})}),Un.jsx(Y4,{theme:{colorScheme:"dark"},children:Un.jsx(Vp.Dropdown,{children:Un.jsx(Nh,{size:"sm",children:'Then click "Submit Selection"!'})})})]})]})})}var Put="@vercel/analytics",Iut="1.1.1",Mut=()=>{window.va||(window.va=function(...e){(window.vaq=window.vaq||[]).push(e)})};function rhe(){return typeof window<"u"}function ihe(){try{const t="production"}catch{}return"production"}function Out(t="auto"){if(t==="auto"){window.vam=ihe();return}window.vam=t}function Rut(){return(rhe()?window.vam:ihe())||"production"}function DN(){return Rut()==="development"}function Lut(t={debug:!0}){var e;if(!rhe())return;Out(t.mode),Mut(),t.beforeSend&&((e=window.va)==null||e.call(window,"beforeSend",t.beforeSend));const n=DN()?"https://va.vercel-scripts.com/v1/script.debug.js":"/_vercel/insights/script.js";if(document.head.querySelector(`script[src*="${n}"]`))return;const r=document.createElement("script");r.src=n,r.defer=!0,r.setAttribute("data-sdkn",Put),r.setAttribute("data-sdkv",Iut),r.onerror=()=>{const i=DN()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log(`[Vercel Web Analytics] Failed to load script from ${n}. ${i}`)},DN()&&t.debug===!1&&r.setAttribute("data-debug","false"),document.head.appendChild(r)}function Dut({beforeSend:t,debug:e=!0,mode:n="auto"}){return Ee.useEffect(()=>{Lut({beforeSend:t,debug:e,mode:n})},[t,e,n]),null}function But(){return Un.jsx("div",{className:"App",children:Un.jsx(Ust,{children:Un.jsxs(zst,{children:[Un.jsx(Dut,{}),Un.jsx(Eut,{}),Un.jsx(Cut,{}),Un.jsx(_ut,{})]})})})}BN.createRoot(document.getElementById("root")).render(Un.jsx(But,{}));
